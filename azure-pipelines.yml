trigger: ["master", "server-prototype"]
pr: ["master", "server-prototype"]

variables:
  RUSTFLAGS: -Dwarnings

jobs:
  - template: ci/azure-test-stable.yml
    parameters:
      name: test_crates
      rust: 1.45.2
      displayName: Test all crates
      cross: eq(variables['Build.SourceBranch'], 'refs/heads/master')

  - template: ci/azure-clippy.yml
    parameters:
      rust: 1.45.2
      name: clippy

  - template: ci/azure-fmt.yml
    parameters:
      rust: 1.45.2
      name: rustfmt

  - template: ci/azure-check-docs.yml
    parameters:
      rust: 1.45.2
      name: docs
