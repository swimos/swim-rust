trigger: ["master", "router"]
pr: ["master"]

variables:
  RUSTFLAGS: -Dwarnings
  TEST_SERVER_VERSION: v1.1
  TEST_SERVER_IMAGE_NAME: "org.swimos/swim-test-server:1.1"

jobs:
  - template: ci/azure-test-stable.yml
    parameters:
      name: test_crates
      rust: 1.43.0
      displayName: Test all crates except client
      cross: true
      crates:
        - common
        - form
        - server
        - utilities

  - template: ci/azure-test-client.yml
    parameters:
      name: test_client
      rust: 1.43.0
      cross: true
      displayName: Test client

  - template: ci/azure-clippy.yml
    parameters:
      rust: stable
      name: clippy

  - template: ci/azure-check-docs.yml
    parameters:
      rust: stable
      name: docs
