// @swim/core v4.0.0-dev.20220527.3 (c) 2015-2023 Nstream, inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).swim=t.swim||{})}(this,(function(t){"use strict";function e(t,e,r,i,n,s){function o(t){if(void 0!==t&&"function"!=typeof t)throw new TypeError("Function expected");return t}for(var a,u=i.kind,h="getter"===u?"get":"setter"===u?"set":"value",l=!e&&t?i.static?t:t.prototype:null,c=e||(l?Object.getOwnPropertyDescriptor(l,i.name):{}),d=!1,f=r.length-1;f>=0;f--){var p={};for(var m in i)p[m]="access"===m?{}:i[m];for(var m in i.access)p.access[m]=i.access[m];p.addInitializer=function(t){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(t||null))};var y=(0,r[f])("accessor"===u?{get:c.get,set:c.set}:c[h],p);if("accessor"===u){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(a=o(y.get))&&(c.get=a),(a=o(y.set))&&(c.set=a),(a=o(y.init))&&n.unshift(a)}else(a=o(y))&&("field"===u?n.unshift(a):c[h]=a)}l&&Object.defineProperty(l,i.name,c),d=!0}function r(t,e,r){for(var i=arguments.length>2,n=0;n<e.length;n++)r=i?e[n].call(t,r):e[n].call(t);return i?r:void 0}"function"==typeof SuppressedError&&SuppressedError;const i={fillBytes:"undefined"!=typeof window&&void 0!==window.crypto?function(t){window.crypto.getRandomValues(t)}:"undefined"!=typeof window&&void 0!==window.msCrypto?function(t){window.msCrypto.getRandomValues(t)}:function(t){if(t instanceof Int8Array)for(let e=0;e<t.length;e+=1)t[e]=128-Math.round(256*Math.random());else if(t instanceof Uint8Array)for(let e=0;e<t.length;e+=1)t[e]=Math.round(256*Math.random());else if(t instanceof Int16Array)for(let e=0;e<t.length;e+=1)t[e]=32768-Math.round(65536*Math.random());else if(t instanceof Uint16Array)for(let e=0;e<t.length;e+=1)t[e]=Math.round(65536*Math.random());else if(t instanceof Int32Array)for(let e=0;e<t.length;e+=1)t[e]=2147483648-Math.round(4294967296*Math.random());else{if(!(t instanceof Uint32Array))throw new TypeError(""+t);for(let e=0;e<t.length;e+=1)t[e]=Math.round(4294967296*Math.random())}}},n={get BigEndian(){return"BE"},get LittleEndian(){return"LE"},NativeEndian:void 0,get NativeOrder(){if(void 0===this.NativeEndian){const t=new ArrayBuffer(2);new Uint16Array(t)[0]=65279;const e=new Uint8Array(t);if(254===e[0]&&255===e[1])this.NativeEndian=this.BigEndian;else{if(255!==e[0]||254!==e[1])throw new Error;this.NativeEndian=this.LittleEndian}}return this.NativeEndian}},s={mix(t,e){return e=3432918353*(65535&e)+((3432918353*(e>>>16)&65535)<<16)&4294967295,t^=e=461845907*(65535&(e=this.rotl(e,15)))+((461845907*(e>>>16)&65535)<<16)&4294967295,t=27492+(65535&(t=5*(65535&(t=this.rotl(t,13)))+((5*(t>>>16)&65535)<<16)&4294967295))+((58964+(t>>>16)&65535)<<16)},mixUint8Array(t,e){if(n.NativeOrder===n.BigEndian)return this.mixUint8ArrayBE(t,e);if(n.NativeOrder===n.LittleEndian)return this.mixUInt8ArrayLE(t,e);throw new Error},mixUint8ArrayBE(t,e){let r=0;const i=e.length;for(;r+3<i;){const i=(255&e[r])<<24|(255&e[r+1])<<16|(255&e[r+2])<<8|255&e[r+3];t=this.mix(t,i),r+=4}if(r<i){let n=(255&e[r])<<24;r+1<i&&(n|=(255&e[r+1])<<16,r+2<i&&(n|=(255&e[r+2])<<8)),n=3432918353*(65535&n)+((3432918353*(n>>>16)&65535)<<16)&4294967295,n=this.rotl(n,15),n=461845907*(65535&n)+((461845907*(n>>>16)&65535)<<16)&4294967295,t^=n}return t^i},mixUInt8ArrayLE(t,e){let r=0;const i=e.length;for(;r+3<i;){const i=255&e[r]|(255&e[r+1])<<8|(255&e[r+2])<<16|(255&e[r+3])<<24;t=this.mix(t,i),r+=4}if(r<i){let n=255&e[r];r+1<i&&(n|=(255&e[r+1])<<8,r+2<i&&(n|=(255&e[r+2])<<16)),n=3432918353*(65535&n)+((3432918353*(n>>>16)&65535)<<16)&4294967295,n=this.rotl(n,15),n=461845907*(65535&n)+((461845907*(n>>>16)&65535)<<16)&4294967295,t^=n}return t^i},mixString(t,e){if(n.NativeOrder===n.BigEndian)return this.mixStringBE(t,e);if(n.NativeOrder===n.LittleEndian)return this.mixStringLE(t,e);throw new Error},mixStringBE(t,e){let r=0,i=32,n=0;const s=e.length;let o=0;for(;n<s;){let s=e.codePointAt(n);void 0===s&&(s=e.charCodeAt(n)),s>=0&&s<=127?(i-=8,r|=s<<i,0===i&&(t=this.mix(t,r),r=0,i=32),o+=1):s>=128&&s<=2047?(i-=8,r|=(192|s>>>6)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=(128|63&s)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),o+=2):s>=2048&&s<=65535||s>=57344&&s<=65535?(i-=8,r|=(224|s>>>12)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=(128|s>>>6&63)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=(128|63&s)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),o+=3):s>=65536&&s<=1114111?(i-=8,r|=(240|s>>>18)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=(128|s>>>12&63)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=(128|s>>>6&63)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=(128|63&s)<<i,0===i&&(t=this.mix(t,r),r=0,i=32),o+=4):(i-=8,r|=239<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=191<<i,0===i&&(t=this.mix(t,r),r=0,i=32),i-=8,r|=189<<i,0===i&&(t=this.mix(t,r),r=0,i=32),o+=3),n=p.offsetByCodePoints(e,n,1)}return 32!==i&&(r=3432918353*(65535&r)+((3432918353*(r>>>16)&65535)<<16)&4294967295,r=this.rotl(r,15),r=461845907*(65535&r)+((461845907*(r>>>16)&65535)<<16)&4294967295,t^=r),t^o},mixStringLE(t,e){let r=0,i=0,n=0;const s=e.length;let o=0;for(;n<s;){let s=e.codePointAt(n);void 0===s&&(s=e.charCodeAt(n)),s>=0&&s<=127?(r|=s<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),o+=1):s>=128&&s<=2047?(r|=(192|s>>>6)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=(128|63&s)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),o+=2):s>=2048&&s<=65535||s>=57344&&s<=65535?(r|=(224|s>>>12)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=(128|s>>>6&63)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=(128|63&s)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),o+=3):s>=65536&&s<=1114111?(r|=(240|s>>>18)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=(128|s>>>12&63)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=(128|s>>>6&63)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=(128|63&s)<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),o+=4):(r|=239<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=191<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),r|=189<<i,i+=8,32===i&&(t=this.mix(t,r),r=0,i=0),o+=3),n=p.offsetByCodePoints(e,n,1)}return 32!==i&&(r=3432918353*(65535&r)+((3432918353*(r>>>16)&65535)<<16)&4294967295,r=this.rotl(r,15),r=461845907*(65535&r)+((461845907*(r>>>16)&65535)<<16)&4294967295,t^=r),t^o},mash:t=>(t=2246822507*(65535&(t^=t>>>16))+((2246822507*(t>>>16)&65535)<<16)&4294967295,t=3266489909*(65535&(t^=t>>>13))+((3266489909*(t>>>16)&65535)<<16)&4294967295,(t^=t>>>16)>>>0),rotl:(t,e)=>t<<e|t>>>32-e},o=function(t,e){let r,i=!1;return function(){return i||(i=!0,r=t.call(this)),r}},a=function(){const t=function(e,r){return t[Symbol.hasInstance](e)?e.equals(r):e===r};return Object.defineProperty(t,Symbol.hasInstance,{value:function(t){return null!==t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.equals},enumerable:!0,configurable:!0}),t}(),u=function(){const t=function(t){return void 0===t?0:null===t?1:t.hashCode()};return Object.defineProperty(t,Symbol.hasInstance,{value:function(t){return null!==t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.hashCode},enumerable:!0,configurable:!0}),t}(),h=function(){const t=function(e,r,i){return t[Symbol.hasInstance](e)?e.equivalentTo(r,i):e===r};return Object.defineProperty(t,Symbol.hasInstance,{value:function(t){return null!==t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.equivalentTo},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Epsilon",{value:1e-8,enumerable:!0,configurable:!0}),t}(),l=function(){const t=function(t,e){return void 0===t?void 0===e?0:1:null===t?void 0===e?-1:null===e?0:1:"function"==typeof t.compareTo?null==e?-1:t.compareTo(e):NaN};return Object.defineProperty(t,Symbol.hasInstance,{value:function(t){return null!==t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.compareTo},enumerable:!0,configurable:!0}),t}(),c={compare(t,e){if(null!==t&&"object"==typeof t){if(null!==e&&"object"==typeof e){const r=c.hash(t),i=c.hash(e);return r<i?-1:r>i?1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash:function(){let t=null,e=2;return function(r){if(null!==r&&"object"==typeof r){null===t&&(t=new WeakMap);let i=t.get(r);return void 0===i&&(i=~~e,t.set(r,i),e+=1),i}if(null===r)return 1;if(void 0===r)return 0;throw new TypeError(""+r)}}(),fromLike:t=>t},d={compare:(t,e)=>"boolean"==typeof t?"boolean"==typeof e?t&&!e?-1:!t&&e?1:0:-1:null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN,hash(t){if(!0===t)return 3;if(!1===t)return 2;if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)},fromLike:t=>null==t?t:Boolean(t)},f={equal:(t,e)=>t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e),equivalent:(t,e,r)=>t===e||"number"==typeof t&&"number"==typeof e&&(isNaN(t)&&isNaN(e)||Math.abs(e-t)<(void 0!==r?r:h.Epsilon)),compare:(t,e)=>"number"==typeof t?"number"==typeof e?t<e?-1:t>e?1:isNaN(e)?isNaN(t)?0:-1:isNaN(t)?1:0:-1:null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN,hash:function(){let t=null,e=null,r=null;return function(i){if("number"==typeof i)return i===~~i?~~i:(null===t&&(t=new ArrayBuffer(8),e=new Float64Array(t),r=new Int32Array(t)),e[0]=i,r[0]^r[1]);if(null===i)return 1;if(void 0===i)return 0;throw new TypeError(""+i)}}(),fromLike:t=>null==t?t:Number(t)},p={codePointAt(t,e){const r=t.length;if((e=e?Number(e):0)!=e&&(e=0),e>=0&&e<r){const i=t.charCodeAt(e);if(i<=55295||i>=57344)return i;if(i<=56319&&e+1<r){const r=t.charCodeAt(e+1);if(r>=56320&&r<=57343)return 65536+((1023&i)<<10+r&1023)}}},offsetByCodePoints(t,e,r){if(r>0){const i=t.length;for(;r>0&&e<i;){const n=t.charCodeAt(e);if(n<=55295||n>=57344)e+=1;else if(n<=56319&&e+1<i){const r=t.charCodeAt(e+1);e+=r>=56320&&r<=57343?2:1}else e+=1;r-=1}}else if(r<0)for(;r<0&&e>0;){const i=t.charCodeAt(e-1);if(i<=55295||i>=57344)e-=1;else if(i>=56320&&i<=57343&&e-1>0){const r=t.charCodeAt(e-2);e-=r>=55296&&r<=57343?2:1}else e-=1;r-=1}return e},compare:(t,e)=>"string"==typeof t?"string"==typeof e?t<e?-1:t>e?1:0:-1:null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN,hash(t){if("string"==typeof t)return s.mash(s.mixString(0,t));if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)},fromLike:t=>null==t?t:String(t)},m={isStartChar:t=>t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039,isPartChar:t=>45===t||t>=48&&t<=57||t>=65&&t<=90||95===t||t>=97&&t<=122||183===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039,isValid(t){let e;if(0===t.length||void 0===(e=t.codePointAt(0))||!this.isStartChar(e))return!1;let r=p.offsetByCodePoints(t,0,1);for(;r<t.length&&void 0!==(e=t.codePointAt(0))&&this.isPartChar(e);)r=p.offsetByCodePoints(t,r,1);return r===t.length&&!this.isReserved(t)},isReserved(t){switch(t){case"await":case"break":case"case":case"catch":case"class":case"const":case"continue":case"debugger":case"default":case"delete":case"do":case"else":case"enum":case"export":case"extends":case"false":case"finally":case"for":case"function":case"if":case"import":case"in":case"instanceof":case"new":case"null":case"return":case"super":case"switch":case"this":case"throw":case"true":case"try":case"typeof":case"var":case"void":case"while":case"with":case"yield":return!0;default:return!1}}},y={compare(t,e){if("function"==typeof t){if("function"==typeof e){const r=y.hash(t),i=y.hash(e);return r<i?-1:r>i?1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash:function(){let t=null,e=2;return function(r){if("function"==typeof r){null===t&&(t=new WeakMap);let i=t.get(r);return void 0===i&&(i=~~e,t.set(r,i),e+=1),i}if(null===r)return 1;if(void 0===r)return 0;throw new TypeError(""+r)}}()},g={compare(t,e){if("function"==typeof t){if("function"==typeof e){const r=g.hash(t),i=g.hash(e);return r<i?-1:r>i?1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash:function(){let t=null;return function(e){if("function"==typeof e){null===t&&(t=new WeakMap);let r=t.get(e);return void 0===r&&(r=s.mash(s.mixString(0,e.name)),t.set(e,r)),r}if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)}}()},w={empty:o((function(){return Object.freeze([])})),inserted(t,e){const r=null!=e?e.length:0,i=new Array(r+1);for(let n=0;n<r;n+=1){const r=e[n];if(r===t)return e;i[n]=r}return i[r]=t,i},removed(t,e){const r=null!=e?e.length:0;if(0===r)return null!=e?e:w.empty();if(1===r)return e[0]!==t?e:w.empty();const i=new Array(r-1);let n=0;for(;n<r;){const s=e[n];if(s===t){for(n+=1;n<r;)i[n-1]=e[n],n+=1;return i}i[n]=s,n+=1}return e},equal(t,e){if(t===e)return!0;if(null!==t&&"object"==typeof t&&null!==e&&"object"==typeof e){const r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;i+=1)if(!v.equal(t[i],e[i]))return!1;return!0}return!1},equivalent(t,e,r){if(t===e)return!0;if(null!==t&&"object"==typeof t&&null!==e&&"object"==typeof e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n+=1)if(!v.equivalent(t[n],e[n],r))return!1;return!0}return!1},compare(t,e){if(null!==t&&"object"==typeof t){if(null!==e&&"object"==typeof e){if(t===e)return 0;const r=t.length,i=e.length;let n=0;for(let s=0,o=Math.min(r,i);s<o&&0===n;s+=1)n=v.compare(t[s],e[s]);return 0!==n?n:r>i?1:r<i?-1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash(t){if("object"==typeof t&&null!==t){let e=0;for(let r=0;r<t.length;r+=1)e=s.mix(e,v.hash(t[r]));return s.mash(e)}if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)}},b={isEmpty(t){if(null!==t&&"object"==typeof t)for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},hasAnyKey(t,...e){if(null===t||"object"!=typeof t&&"function"!=typeof t)return!1;for(let r=0;r<e.length;r+=1)if(e[r]in t)return!0;return!1},hasAllKeys(t,...e){if(null===t||"object"!=typeof t&&"function"!=typeof t)return!1;for(let r=0;r<e.length;r+=1)if(!(e[r]in t))return!1;return!0},inserted(t,e,r,i){let n=!1;const s={};for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)){const a=t[o];n||a!==i||(s[e]=r,n=!0),s[o]=a}return n||(s[e]=r),s},getFirstKey(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return e},getFirstValue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},getNextKey(t,e){let r=!1;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(r)return i;i===e&&(r=!0)}},getNextValue(t,e){let r=!1;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(r)return t[i];i===e&&(r=!0)}},equal(t,e){if(t===e)return!0;if(null!==t&&"object"==typeof t&&null!==e&&"object"==typeof e){const r=Object.keys(t),i=Object.keys(e),n=r.length;if(n!==i.length)return!1;for(let s=0;s<n;s+=1){const n=r[s];if(n!==i[s]||!v.equal(t[n],e[n]))return!1}return!0}return!1},equivalent(t,e,r){if(t===e)return!0;if(null!==t&&"object"==typeof t&&null!==e&&"object"==typeof e){const i=Object.keys(t),n=Object.keys(e),s=i.length;if(s!==n.length)return!1;for(let o=0;o<s;o+=1){const s=i[o];if(s!==n[o]||!v.equivalent(t[s],e[s],r))return!1}return!0}return!1},compare(t,e){if(null!==t&&"object"==typeof t){if(null!==e&&"object"==typeof e){if(t===e)return 0;const r=Object.keys(t),i=Object.keys(e),n=r.length,s=i.length,o=Math.min(n,s);let a=0;for(let n=0;n<o&&0===a;n+=1){const s=r[n],o=i[n];a=p.compare(s,o),0===a&&(a=v.compare(t[s],e[o]))}return 0!==a?a:n>s?1:n<s?-1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash(t){if("object"==typeof t&&null!==t){let e=0;const r=Object.keys(t);for(let i=0;i<r.length;i+=1){const n=r[i];e=s.mix(s.mix(e,p.hash(n)),v.hash(t[n]))}return s.mash(e)}if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)}},v={equal(t,e){if(t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),t===e)return!0;if("number"==typeof t){if("number"==typeof e)return isNaN(t)&&isNaN(e)}else{if(a[Symbol.hasInstance](t))return t.equals(e);if(Array.isArray(t)){if(Array.isArray(e))return w.equal(t,e)}else if(null!==t&&"object"==typeof t&&null!==e&&"object"==typeof e)return b.equal(t,e)}return!1},equivalent(t,e,r=h.Epsilon){if(t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),t===e)return!0;if("number"==typeof t){if("number"==typeof e)return isNaN(t)&&isNaN(e)||Math.abs(e-t)<r}else{if(h[Symbol.hasInstance](t))return t.equivalentTo(e,r);if(Array.isArray(t)){if(Array.isArray(e))return w.equivalent(t,e,r)}else if("object"==typeof t&&null!==t&&"object"==typeof e&&null!==e)return b.equivalent(t,e,r)}return!1},compare:(t,e)=>(t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),void 0===t?void 0===e?0:1:null===t?void 0===e?-1:null===e?0:1:"boolean"==typeof t?null==e?-1:"boolean"==typeof e?t&&!e?-1:!t&&e?1:0:1:"number"==typeof t?null==e||"boolean"==typeof e?-1:"number"==typeof e?t<e?-1:t>e?1:isNaN(e)?isNaN(t)?0:-1:isNaN(t)?1:0:1:"string"==typeof t?null==e||"boolean"==typeof e||"number"==typeof e?-1:"string"==typeof e?t<e?-1:t>e?1:0:1:l[Symbol.hasInstance](t)?t.compareTo(e):"function"==typeof t?null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e?-1:"function"==typeof e?y.compare(t,e):1:Array.isArray(t)?null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"function"==typeof e?-1:Array.isArray(e)?w.compare(t,e):1:"object"==typeof t?null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"function"==typeof e||Array.isArray(e)?-1:"object"==typeof e?b.compare(t,e):1:NaN),hash(t){if(t instanceof Date&&(t=t.getTime()),void 0===t)return 0;if(null===t)return 1;if(!1===t)return 2;if(!0===t)return 3;if("number"==typeof t)return f.hash(t);if("string"==typeof t)return p.hash(t);if(u[Symbol.hasInstance](t))return t.hashCode();if("function"==typeof t)return y.hash(t);if(Array.isArray(t))return w.hash(t);if("object"==typeof t)return b.hash(t);throw new TypeError(""+t)}},x=function(){const t=function(e,r){let i;return i=t[Symbol.hasInstance](e)?e:e===String?p:e===Number?f:e===Boolean?d:c,arguments.length<2?i:i.fromLike(r)};return Object.defineProperty(t,Symbol.hasInstance,{value:function(t){return b.hasAllKeys(t,"fromLike")},enumerable:!0,configurable:!0}),t}(),S=function(){const t=function(e){return t[Symbol.hasInstance](e)?e.toLike():e};return Object.defineProperty(t,Symbol.hasInstance,{value:function(t){return b.hasAllKeys(t,"toLike")},enumerable:!0,configurable:!0}),t}(),C={[Symbol.hasInstance]:t=>null!==t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.create},k={[Symbol.hasInstance]:t=>null!==t&&("object"==typeof t||"function"==typeof t)&&("function"==typeof t.observe&&"function"==typeof t.unobserve)},M={[Symbol.hasInstance]:t=>null!==t&&("object"==typeof t||"function"==typeof t)&&("function"==typeof t.consume&&"function"==typeof t.unconsume)};let O=(()=>{var t;let i,n=[];return t=class{set(t){throw new Error("immutable")}delete(){throw new Error("immutable")}[Symbol.iterator](){return this}static empty(){return new E}static unary(t){return new T(t)}static array(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=t.length),new P(t,e,r)}static keys(t){return new I(t)}static values(t){return new D(t)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class E extends O{isEmpty(){return!0}head(){throw new Error("empty")}step(){throw new Error("empty")}skip(t){}hasNext(){return!1}nextIndex(){return 0}next(){return{done:!0,value:void 0}}hasPrevious(){return!1}previousIndex(){return-1}previous(){return{done:!0,value:void 0}}}class T extends O{constructor(t){super(),this.value=t,this.index=0}isEmpty(){return 0!==this.index}head(){if(0!==this.index)throw new Error("empty");return this.value}step(){if(0!==this.index)throw new Error("empty");this.index=1}skip(t){this.index=Math.min(Math.max(0,this.index+t),1)}hasNext(){return 0===this.index}nextIndex(){return this.index}next(){return 0!==this.index?{done:!0,value:void 0}:(this.index=1,{done:!0,value:this.value})}hasPrevious(){return 1===this.index}previousIndex(){return this.index-1}previous(){return 1!==this.index?{done:!0,value:void 0}:(this.index=0,{done:!0,value:this.value})}}class P extends O{constructor(t,e,r){super(),this.array=t,this.index=e,this.limit=r}isEmpty(){return this.index>=this.limit}head(){if(this.index>=this.limit)throw new Error("empty");return this.array[this.index]}step(){if(this.index>=this.limit)throw new Error("empty");this.index+=1}skip(t){this.index=Math.min(this.index+t,this.limit)}hasNext(){return this.index<this.limit}nextIndex(){return this.index}next(){const t=this.index;return t>=this.limit?(this.index=this.limit,{done:!0,value:void 0}):(this.index+=1,{done:this.index===this.limit,value:this.array[t]})}hasPrevious(){return this.index>0}previousIndex(){return this.index-1}previous(){const t=this.index-1;return t<0?(this.index=0,{done:!0,value:void 0}):(this.index=t,{done:0===t,value:this.array[t]})}}class I extends O{constructor(t){super(),this.cursor=t}isEmpty(){return this.cursor.isEmpty()}head(){return this.cursor.head()[0]}step(){this.cursor.step()}skip(t){this.cursor.skip(t)}hasNext(){return this.cursor.hasNext()}nextIndex(){return this.cursor.nextIndex()}next(){const t=this.cursor.next();return{done:t.done,value:void 0!==t.value?t.value[0]:void 0}}hasPrevious(){return this.cursor.hasPrevious()}previousIndex(){return this.cursor.previousIndex()}previous(){const t=this.cursor.previous();return{done:t.done,value:void 0!==t.value?t.value[0]:void 0}}delete(){this.cursor.delete()}}class D extends O{constructor(t){super(),this.cursor=t}isEmpty(){return this.cursor.isEmpty()}head(){return this.cursor.head()[1]}step(){this.cursor.step()}skip(t){this.cursor.skip(t)}hasNext(){return this.cursor.hasNext()}nextIndex(){return this.cursor.nextIndex()}next(){const t=this.cursor.next();return{done:t.done,value:void 0!==t.value?t.value[1]:void 0}}hasPrevious(){return this.cursor.hasPrevious()}previousIndex(){return this.cursor.previousIndex()}previous(){const t=this.cursor.previous();return{done:t.done,value:void 0!==t.value?t.value[1]:void 0}}delete(){this.cursor.delete()}}const L=function(t){const e=function(t,r){const i=function(t){return i.range(i.domain(t))};return Object.setPrototypeOf(i,e.prototype),i.domain=t,i.range=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this.domain.equals(t.domain)&&this.range.equals(t.range))},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.domain.equivalentTo(t.domain,r)&&this.range.equivalentTo(t.range,r))},e.prototype.toString=function(){return"Mapping("+this.domain+", "+this.range+")"},e}(Function),q=function(t){const e=function(...t){const r=function(t){return r.interval(t)(t)};Object.setPrototypeOf(r,e.prototype);const i=t.length;if(0===i)throw new Error("no piecewise intervals");let n=t[0],s=n.domain,o=n.range;for(let e=1;e<i;e+=1)n=t[e],s=s.union(n.domain),o=o.union(n.range);return r.intervals=t,r.domain=s,r.range=o,r};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.interval=function(t){const e=this.intervals;let r,i=0,n=e.length-1;for(;i<=n;){const s=i+n>>>1;r=e[s];const o=(0,r.domain)(t);if(o<0)n=s-1;else{if(!(o>=1))break;i=s+1}}return r},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this.domain.equals(t.domain)&&this.range.equals(t.range))},e.prototype.toString=function(){let t="Piecewise(";const e=this.intervals;for(let r=0;r<e.length;r+=1){0!==r&&(t+=", "),t+=e[r].toString()}return t+=")",t},e}(L),A=function(t){const e=function(t,r){const i=function(t){return v.equal(t,i[1])?1:0};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"domain",{get(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:()=>F.unit(),enumerable:!0,configurable:!0}),e.prototype.contains=function(t){return v.compare(this[0],t)<=0&&v.compare(t,this[1])<=0},e.prototype.union=function(t){const r=this[0],i=this[1],n=t[0],s=t[1],o=v.compare(r,n)<=0?r:n,a=v.compare(i,s)>=0?i:s;return e(o,a)},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&v.equal(this[0],t[0])&&v.equal(this[1],t[1]))},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(v.equivalent(this[0],t[0],r)&&v.equivalent(this[1],t[1],r))},e.prototype.toString=function(){return"Domain("+this[0]+", "+this[1]+")"},e.unit=o((function(){return Q(0,1)})),e}(L),F=function(t){const e=function(t,r){const i=function(t){return t<1?i[0]:i[1]};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"domain",{get:()=>A.unit(),enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get(){return this},enumerable:!0,configurable:!0}),e.prototype.union=function(t){const r=this[0],i=this[1],n=t[0],s=t[1],o=v.compare(r,i),a=v.compare(n,s);let u,h;return o<=0&&a<=0?(u=v.compare(r,n)<=0?r:n,h=v.compare(i,s)>=0?i:s):o>=0&&a>=0?(u=v.compare(r,n)>=0?r:n,h=v.compare(i,s)<=0?i:s):o<=0&&a>=0?(u=v.compare(r,s)<=0?r:s,h=v.compare(i,n)>=0?i:n):(u=v.compare(i,n)<=0?i:n,h=v.compare(r,s)>=0?r:s),e(u,h)},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&v.equal(this[0],t[0])&&v.equal(this[1],t[1]))},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(v.equivalent(this[0],t[0],r)&&v.equivalent(this[1],t[1],r))},e.prototype.toString=function(){return"Range("+this[0]+", "+this[1]+")"},e.unit=o((function(){return $(0,1)})),e}(L),V=function(t){const e=function(t){const r=function(t){return r.value};return Object.setPrototypeOf(r,e.prototype),r.value=t,r};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,1,{get(){return this.value},enumerable:!0,configurable:!0}),e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&v.equal(this.value,t.value))},e.prototype.toString=function(){return"Constant("+this.value+")"},e}(F),z=function(){const t=function(e,r){return t[Symbol.hasInstance](e)?e.interpolateTo(r):null};return Object.defineProperty(t,Symbol.hasInstance,{value:function(t){return null!==t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.interpolateTo},enumerable:!0,configurable:!0}),t}(),j=function(t){const e=function(t,e){let r;return t===e?r=U(t):"number"==typeof t&&"number"==typeof e?r=B(t,e):Array.isArray(t)&&Array.isArray(e)?r=Y(t,e):(r=z(t,e),null===r&&(r=R(t,e))),r};return(e.prototype=Object.create(t.prototype)).constructor=e,e.prototype.union=function(t){const r=this[0],i=this[1],n=t[0],s=t[1],o=v.compare(r,i),a=v.compare(n,s);let u,h;return o<=0&&a<=0?(u=v.compare(r,n)<=0?r:n,h=v.compare(i,s)>=0?i:s):o>=0&&a>=0?(u=v.compare(r,n)>=0?r:n,h=v.compare(i,s)<=0?i:s):o<=0&&a>=0?(u=v.compare(r,s)<=0?r:s,h=v.compare(i,n)>=0?i:n):(u=v.compare(i,n)<=0?i:n,h=v.compare(r,s)>=0?r:s),e(u,h)},e.prototype.map=function(t){return N(this,t)},e.prototype.interpolateTo=function(t){return t instanceof e?H(this,t):null},e.prototype.canEqual=function(t){return t instanceof this.constructor},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&v.equal(this[0],t[0])&&v.equal(this[1],t[1]))},e.prototype.toString=function(){return"Interpolator("+this[0]+", "+this[1]+")"},e}(F),N=function(t){const e=function(t,r){const i=function(t){return i.transform(i.interpolator(t))};return Object.setPrototypeOf(i,e.prototype),i.interpolator=t,i.transform=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){return this.transform(this.interpolator[0])},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){return this.transform(this.interpolator[1])},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.interpolator.equals(t.interpolator)&&this.transform===t.transform)},e}(j),U=function(t){const e=function(t){const r=function(t){return r.value};return Object.setPrototypeOf(r,e.prototype),r.value=t,r};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){return this.value},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){return this.value},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&this.value===t.value},e}(j),R=function(t){const e=function(t,r,i){const n=function(t){return t<n.phase?n[0]:n[1]};return Object.setPrototypeOf(n,e.prototype),void 0===i&&(i=1),n.phase=i,n[0]=t,n[1]=r,n};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this.phase===t.phase&&v.equal(this[0],t[0])&&v.equal(this[1],t[1]))},e}(j),B=function(t){const e=function(t,r){const i=function(t){const e=i[0];return e+t*(i[1]-e)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),Y=function(t){const e=function(t,r){const i=function(t){const e=i.interpolators,r=e.length,n=new Array(r);for(let i=0;i<r;i+=1)n[i]=e[i](t);return n};Object.setPrototypeOf(i,e.prototype);const n=Math.min(t.length,r.length),s=new Array(n);for(let e=0;e<n;e+=1)s[e]=j(t[e],r[e]);return i.interpolators=s,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.interpolators,e=t.length,r=new Array(e);for(let i=0;i<e;i+=1)r[i]=t[i][0];return r},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.interpolators,e=t.length,r=new Array(e);for(let i=0;i<e;i+=1)r[i]=t[i][1];return r},configurable:!0}),e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){const e=this.interpolators.length;if(e!==t.interpolators.length)return!1;for(let r=0;r<e;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}return!1},e}(j),H=function(t){const e=function(t,r){const i=function(t){return 0===t?i[0]:1===t?i[1]:j(i[0](t),i[1](t))};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),W=function(t){const e=function(t,r,i){const n=function(t){const e=n[0],r=n[1];return n.easing(Math.min(Math.max(0,(t-e)/(r-e)),1))};return Object.setPrototypeOf(n,e.prototype),n.easing=t,n[0]=r,n[1]=i,n};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"duration",{get(){return this[1]-this[0]},configurable:!0}),e.prototype.contains=function(t){return this[0]<=t&&t<=this[1]},e.prototype.withDomain=function(t,r){return e(this.easing,t,r)},e.prototype.withDuration=function(t){const r=this[0];return e(this.easing,r,r+t)},e.prototype.overRange=function(t,e){let r;return r=1===arguments.length?t:j(t,e),K(this,r)},e.prototype.union=function(t){return e(this.easing,Math.min(this[0],t[0]),Math.max(this[1],t[1]))},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this.easing.equals(t.easing)&&v.equal(this[0],t[0])&&v.equal(this[1],t[1]))},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.easing.equivalentTo(t.easing,r)&&v.equivalent(this[0],t[0],r)&&v.equivalent(this[1],t[1],r))},e.prototype.toString=function(){return"Timing("+this.easing+", "+this[0]+", "+this[1]+")"},e.fromLike=function(t){if(null==t||"boolean"==typeof t||t instanceof e)return t;if("object"==typeof t)return this.fromInit(t);throw new TypeError(""+t)},e.fromInit=function(t){let r=t.easing;void 0===r?r=X.linear:"string"==typeof r&&(r=X(r));let i=t.t0;void 0===i&&(i=0);let n=t.t1;if(void 0===n){const e=t.dt;n=void 0!==e?i+e:i}return e(r,i,n)},e}(A),X=function(t){const e=function(t){switch(t){case"linear":return e.linear;case"quad-in":return e.quadIn;case"quad-out":return e.quadOut;case"quad-in-out":return e.quadInOut;case"cubic-in":return e.cubicIn;case"cubic-out":return e.cubicOut;case"cubic-in-out":return e.cubicInOut;case"quart-in":return e.quartIn;case"quart-out":return e.quartOut;case"quart-in-out":return e.quartInOut;case"expo-in":return e.expoIn;case"expo-out":return e.expoOut;case"expo-in-out":return e.expoInOut;case"circ-in":return e.circIn;case"circ-out":return e.circOut;case"circ-in-out":return e.circInOut;case"back-in":return e.backIn;case"back-out":return e.backOut;case"back-in-out":return e.backInOut;case"elastic-in":return e.elasticIn;case"elastic-out":return e.elasticOut;case"elastic-in-out":return e.elasticInOut;case"bounce-in":return e.bounceIn;case"bounce-out":return e.bounceOut;case"bounce-in-out":return e.bounceInOut;default:throw new Error("unknown easing function: "+t)}};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{value:0}),Object.defineProperty(e.prototype,1,{value:1}),Object.defineProperty(e.prototype,"easing",{get(){return this}}),e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t},e.prototype.equivalentTo=function(t,e){return this===t},e.prototype.toString=function(){return'Easing("'+this.type+'")'},e.fromLike=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e(t);throw new TypeError(""+t)},e.linear=function(t){return t},Object.setPrototypeOf(e.linear,e.prototype),e.linear.type="linear",e.quadIn=function(t){return t*t},Object.setPrototypeOf(e.quadIn,e.prototype),e.quadIn.type="quad-in",e.quadOut=function(t){return t*(2-t)},Object.setPrototypeOf(e.quadOut,e.prototype),e.quadOut.type="quad-out",e.quadInOut=function(t){return(t*=2)<=1?t*=t:(t-=1,t*=2-t,t+=1),t/=2},Object.setPrototypeOf(e.quadInOut,e.prototype),e.quadInOut.type="quad-in-out",e.cubicIn=function(t){return t*t*t},Object.setPrototypeOf(e.cubicIn,e.prototype),e.cubicIn.type="cubic-in",e.cubicOut=function(t){return t-=1,t*=t*t,t+=1},Object.setPrototypeOf(e.cubicOut,e.prototype),e.cubicOut.type="cubic-out",e.cubicInOut=function(t){return(t*=2)<=1?t*=t*t:(t-=2,t*=t*t,t+=2),t/=2},Object.setPrototypeOf(e.cubicInOut,e.prototype),e.cubicInOut.type="cubic-in-out",e.quartIn=function(t){return t*t*t*t},Object.setPrototypeOf(e.quartIn,e.prototype),e.quartIn.type="quart-in",e.quartOut=function(t){return 1-(t-=1)*t*t*t},Object.setPrototypeOf(e.quartOut,e.prototype),e.quartOut.type="quart-out",e.quartInOut=function(t){const e=t-1;return t<.5?8*t*t*t*t:1-8*e*e*e*e},Object.setPrototypeOf(e.quartInOut,e.prototype),e.quartInOut.type="quart-in-out",e.expoIn=function(t){return 0===t?0:Math.pow(2,10*(t-1))},Object.setPrototypeOf(e.expoIn,e.prototype),e.expoIn.type="expo-in",e.expoOut=function(t){return 1===t?1:1-Math.pow(2,-10*t)},Object.setPrototypeOf(e.expoOut,e.prototype),e.expoOut.type="expo-out",e.expoInOut=function(t){return 1===t||0===t?t:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))},Object.setPrototypeOf(e.expoInOut,e.prototype),e.expoInOut.type="expo-in-out",e.circIn=function(t){return-1*(Math.sqrt(1-t/1*t)-1)},Object.setPrototypeOf(e.circIn,e.prototype),e.circIn.type="circ-in",e.circOut=function(t){return t-=1,Math.sqrt(1-t*t)},Object.setPrototypeOf(e.circOut,e.prototype),e.circOut.type="circ-out",e.circInOut=function(t){if((t*=2)<1)return-.5*(Math.sqrt(1-t*t)-1);const e=t-2;return.5*(Math.sqrt(1-e*e)+1)},Object.setPrototypeOf(e.circInOut,e.prototype),e.circInOut.type="circ-in-out",e.backIn=function(t){const e=1.70158;return t*t*((e+1)*t-e)},Object.setPrototypeOf(e.backIn,e.prototype),e.backIn.type="back-in",e.backOut=function(t){const e=1.70158,r=t/1-1;return r*r*((e+1)*e+e)+1},Object.setPrototypeOf(e.backOut,e.prototype),e.backOut.type="back-out",e.backInOut=function(t){const e=2.5949095;if((t*=2)<1)return.5*t*t*((e+1)*t-e);const r=t-2;return.5*(r*r*((e+1)*r+e)+2)},Object.setPrototypeOf(e.backInOut,e.prototype),e.backInOut.type="back-in-out",e.elasticIn=function(t){if(0===t||1===t)return t;const e=t/1-1,r=(1-.7)/2*Math.PI*Math.asin(1);return-Math.pow(2,10*e)*Math.sin(2*(e-r)*Math.PI/(1-.7))},Object.setPrototypeOf(e.elasticIn,e.prototype),e.elasticIn.type="elastic-in",e.elasticOut=function(t){if(0===t||1===t)return t;const e=(1-.7)/(2*Math.PI)*Math.asin(1);return t*=2,Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/(1-.7))+1},Object.setPrototypeOf(e.elasticOut,e.prototype),e.elasticOut.type="elastic-out",e.elasticInOut=function(t){if(0===t||1===t)return t;const e=.65,r=(1-e)/(2*Math.PI)*Math.asin(1),i=2*t,n=i-1;return i<1?Math.pow(2,10*n)*Math.sin(2*(n-r)*Math.PI/(1-e))*-.5:Math.pow(2,-10*n)*Math.sin(2*(n-r)*Math.PI/(1-e))*.5+1},Object.setPrototypeOf(e.elasticInOut,e.prototype),e.elasticInOut.type="elastic-in-out",e.bounceIn=function(t){const e=7.5625;return(t=1-t)<1/2.75?1-e*t*t:t<2/2.75?1-(e*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(e*(t-=2.25/2.75)*t+.9375):1-(e*(t-=2.625/2.75)*t+.984375)},Object.setPrototypeOf(e.bounceIn,e.prototype),e.bounceIn.type="bounce-in",e.bounceOut=function(t){const e=7.5625;return t<1/2.75?e*t*t:t<2/2.75?e*(t-=1.5/2.75)*t+.75:t<2.5/2.75?e*(t-=2.25/2.75)*t+.9375:e*(t-=2.625/2.75)*t+.984375},Object.setPrototypeOf(e.bounceOut,e.prototype),e.bounceOut.type="bounce-out",e.bounceInOut=function(t){const e=t<.5,r=7.5625;return(t=e?1-2*t:2*t-1)<1/2.75?t*=r*t:t=t<2/2.75?r*(t-=1.5/2.75)*t+.75:t<2.5/2.75?r*(t-=2.25/2.75)*t+.9375:r*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5},Object.setPrototypeOf(e.bounceInOut,e.prototype),e.bounceInOut.type="bounce-in-out",e}(W),K=function(t){const e=function(t,r){const i=function(t){return i.range(i.domain(t))};return Object.setPrototypeOf(i,e.prototype),i.domain=t,i.range=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.withDomain=function(t,e){return this.domain.withDomain(t,e).overRange(this.range)},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},e.prototype.toString=function(){return"Tweening("+this.domain+", "+this.range+")"},e}(L),G=function(t){const e=function(){throw new Error};return(e.prototype=Object.create(t.prototype)).constructor=e,e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},e.prototype.toString=function(){return"Scale("+this.domain+", "+this.range+")"},e}(L),Z=function(t){const e=function(){throw new Error};return(e.prototype=Object.create(t.prototype)).constructor=e,e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},e.prototype.toString=function(){return"ContinuousScale("+this.domain+", "+this.range+")"},e}(G),Q=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1]-e;return 0!==r?(t-e)/r:0};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"inverse",{get(){return $(this[0],this[1])},configurable:!0}),e.prototype.contains=function(t){return this[0]<=t&&t<=this[1]},e.prototype.union=function(t){return e(Math.min(this[0],t[0]),Math.max(this[1],t[1]))},e.prototype.interpolateTo=function(t){return t instanceof e?J(this,t):null},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this[0]===t[0]&&this[1]===t[1])},e.prototype.toString=function(){return"LinearDomain("+this[0]+", "+this[1]+")"},e}(A),J=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=e[0],n=e[1],s=i[1],o=s[0],a=s[1];return Q(r+t*(o-r),n+t*(a-n))};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),$=function(t){const e=function(t,r){const i=function(t){const e=i[0];return e+t*(i[1]-e)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"inverse",{get(){return Q(this[0],this[1])},configurable:!0}),e.prototype.union=function(t){const r=this[0],i=this[1],n=t[0],s=t[1];let o,a;return r<=i&&n<=s?(o=Math.min(r,n),a=Math.max(i,s)):r>=i&&n>=s?(o=Math.max(r,n),a=Math.min(i,s)):r<=i&&n>=s?(o=Math.min(r,s),a=Math.max(i,n)):(o=Math.min(i,n),a=Math.max(r,s)),e(o,a)},e.prototype.interpolateTo=function(t){return t instanceof e?_(this,t):null},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this[0]===t[0]&&this[1]===t[1])},e.prototype.toString=function(){return"LinearRange("+this[0]+", "+this[1]+")"},e}(F),_=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=e[0],n=e[1],s=i[1],o=s[0],a=s[1];return $(r+t*(o-r),n+t*(a-n))};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),tt=function(t){const e=function(t,r){const i=function(t){return i.range(i.domain(t))};return Object.setPrototypeOf(i,e.prototype),i.domain=t,i.range=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"inverse",{get(){return e(this.range.inverse,this.domain.inverse)},configurable:!0}),e.prototype.withDomain=function(t,r){let i;return i=1===arguments.length?t:Q(t,r),e(i,this.range)},e.prototype.overRange=function(t,r){let i;return i=1===arguments.length?t:$(t,r),e(this.domain,i)},e.prototype.clampDomain=function(t,r,i,n,s){void 0===s&&(s=h.Epsilon);let o=this.domain[0],a=this.domain[1];void 0!==t&&void 0!==r&&Math.abs(a-o)>r-t?o<a?(o=t,a=r):(a=t,o=r):(void 0!==t&&(o<a&&o<t?(a+=t-o,o=t):a<o&&a<t&&(o+=t-a,a=t)),void 0!==r&&(o<a&&a>r?(o-=a-r,a=r):a<o&&o>r&&(a-=o-r,o=r)));const u=this(o),l=this(a),c=u<l?l-u:u-l,d=Math.abs(c/(a-o));if(void 0!==i&&d<1/i){const t=c*i,e=o+a;o=(e-t)/2,a=(e+t)/2}else if(void 0!==n&&d>1/n){const t=c*n,e=o+a;o=(e-t)/2,a=(e+t)/2}return Math.abs(o-this.domain[0])<s&&Math.abs(a-this.domain[1])<s?this:e(Q(o,a),this.range)},e.prototype.solveDomain=function(t,r,i,n,s,o){void 0===o&&(o=h.Epsilon);const a=this.domain[1]-this.domain[0],u=this.range[0],l=this.range[1];let c;void 0===i||void 0===n||Math.abs(i-t)<o||Math.abs(n-r)<o?c=(l-u)/(0!==a?a:o):(c=(n-r)/(i-t),void 0!==s&&s||c<0==(l-u)/a<0||(c=-c));const d=r-c*t,f=(u-d)/c,p=(l-d)/c;return Math.abs(f-this.domain[0])<o&&Math.abs(p-this.domain[1])<o?this:e(Q(f,p),this.range)},e.prototype.interpolateTo=function(t){return t instanceof e?et(this,t):null},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},e.prototype.toString=function(){return"LinearScale("+this.domain+", "+this.range+")"},e}(Z),et=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.domain,s=n[0],o=n[1],a=r.domain,u=a[0],h=a[1],l=Q(s+t*(u-s),o+t*(h-o)),c=e.range,d=c[0],f=c[1],p=r.range,m=p[0],y=p[1],g=$(d+t*(m-d),f+t*(y-f));return tt(l,g)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class rt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,rt.prototype)}}const it=function(){const t=function(t,e){if(!t)throw new rt(e)};return t.ok=function(t,e){if(!t)throw new rt(e)},t.notOk=function(t,e){if(t)throw new rt(e)},t.equal=function(t,e,r){if(!v.equal(t,e))throw new rt(r)},t.notEqual=function(t,e,r){if(v.equal(t,e))throw new rt(r)},t.identical=function(t,e,r){if(t!==e)throw new rt(r)},t.notIdentical=function(t,e,r){if(t===e)throw new rt(r)},t.lessThan=function(t,e,r){if(!(t<e))throw new rt(r)},t.lessThanOrEqual=function(t,e,r){if(!(t<=e))throw new rt(r)},t.greaterThan=function(t,e,r){if(!(t>e))throw new rt(r)},t.greaterThanOrEqual=function(t,e,r){if(!(t>=e))throw new rt(r)},t.notLessThan=function(t,e,r){if(t<e)throw new rt(r)},t.notLessThanOrEqual=function(t,e,r){if(t<=e)throw new rt(r)},t.notGreaterThan=function(t,e,r){if(t>e)throw new rt(r)},t.notGreaterThanOrEqual=function(t,e,r){if(t>=e)throw new rt(r)},t.instanceOf=function(t,e,r){if(!(t instanceof e))throw new rt(r)},t.notInstanceOf=function(t,e,r){if(t instanceof e)throw new rt(r)},t.compareLessThan=function(t,e,r){if(!(v.compare(t,e)<0))throw new rt(r)},t.compareNotLessThan=function(t,e,r){if(v.compare(t,e)<0)throw new rt(r)},t.compareLessThanOrEqual=function(t,e,r){if(!(v.compare(t,e)<=0))throw new rt(r)},t.compareNotLessThanOrEqual=function(t,e,r){if(v.compare(t,e)<=0)throw new rt(r)},t.compareEqual=function(t,e,r){if(0!==v.compare(t,e))throw new rt(r)},t.compareNotEqual=function(t,e,r){if(0===v.compare(t,e))throw new rt(r)},t.compareGreaterThanOrEqual=function(t,e,r){if(!(v.compare(t,e)>=0))throw new rt(r)},t.compareNotGreaterThanOrEqual=function(t,e,r){if(v.compare(t,e)>=0)throw new rt(r)},t.compareGreaterThan=function(t,e,r){if(!(v.compare(t,e)>0))throw new rt(r)},t.compareNotGreaterThan=function(t,e,r){if(v.compare(t,e)>0)throw new rt(r)},t}();class nt{constructor(t,e){this.level=t,this.label=e}isTrace(){return this.level===nt.TraceLevel}isDebug(){return this.level===nt.DebugLevel}isInfo(){return this.level===nt.InfoLevel}isNote(){return this.level===nt.NoteLevel}isWarning(){return this.level===nt.WarningLevel}isError(){return this.level===nt.ErrorLevel}isAlert(){return this.level===nt.AlertLevel}isFatal(){return this.level===nt.FatalLevel}compareTo(t){return this===t?0:t instanceof nt?this.level<t.level?-1:this.level>t.level?1:this.label.localeCompare(t.label):NaN}equals(t){return this===t||t instanceof nt&&(this.level===t.level&&this.label===t.label)}hashCode(){return s.mash(s.mix(s.mix(g.hash(nt),f.hash(this.level)),p.hash(this.label)))}toString(){return this.label}static create(t,e){switch(t){case this.TraceLevel:return this.trace(e);case this.DebugLevel:return this.debug(e);case this.InfoLevel:return this.info(e);case this.NoteLevel:return this.note(e);case this.WarningLevel:return this.warning(e);case this.ErrorLevel:return this.error(e);case this.AlertLevel:return this.alert(e);case this.FatalLevel:return this.fatal(e);default:throw new Error(""+t)}}static trace(t){return void 0===t||t===this.TraceLabel?(null===this.Trace&&(this.Trace=new nt(this.TraceLevel,this.TraceLabel)),this.Trace):new nt(this.TraceLevel,t)}static debug(t){return void 0===t||t===this.DebugLabel?(null===this.Debug&&(this.Debug=new nt(this.DebugLevel,this.DebugLabel)),this.Debug):new nt(this.DebugLevel,t)}static info(t){return void 0===t||t===this.InfoLabel?(null===this.Info&&(this.Info=new nt(this.InfoLevel,this.InfoLabel)),this.Info):new nt(this.InfoLevel,t)}static note(t){return void 0===t||t===this.NoteLabel?(null===this.Note&&(this.Note=new nt(this.NoteLevel,this.NoteLabel)),this.Note):new nt(this.NoteLevel,t)}static warning(t){return void 0===t||t===this.WarningLabel?(null===this.Warning&&(this.Warning=new nt(this.WarningLevel,this.WarningLabel)),this.Warning):new nt(this.WarningLevel,t)}static error(t){return void 0===t||t===this.ErrorLabel?(null===this.Error&&(this.Error=new nt(this.ErrorLevel,this.ErrorLabel)),this.Error):new nt(this.ErrorLevel,t)}static alert(t){return void 0===t||t===this.AlertLabel?(null===this.Alert&&(this.Alert=new nt(this.AlertLevel,this.AlertLabel)),this.Alert):new nt(this.AlertLevel,t)}static fatal(t){return void 0===t||t===this.FatalLabel?(null===this.Fatal&&(this.Fatal=new nt(this.FatalLevel,this.FatalLabel)),this.Fatal):new nt(this.FatalLevel,t)}}nt.TraceLevel=0,nt.DebugLevel=1,nt.InfoLevel=2,nt.NoteLevel=3,nt.WarningLevel=4,nt.ErrorLevel=5,nt.AlertLevel=6,nt.FatalLevel=7,nt.TraceLabel="trace",nt.DebugLabel="debug",nt.InfoLabel="info",nt.NoteLabel="note",nt.WarningLabel="warning",nt.ErrorLabel="error",nt.AlertLabel="alert",nt.FatalLabel="fatal",nt.Trace=null,nt.Debug=null,nt.Info=null,nt.Note=null,nt.Warning=null,nt.Error=null,nt.Alert=null,nt.Fatal=null;Symbol.toStringTag;class st{}let ot=(()=>{var t;let i,n=st,a=[];return t=class extends n{constructor(t,e,r,i){super(),this.offset=t,this.line=e,this.column=r,this.note=i}withNote(e){return this.note!==e?t.at(this.offset,this.line,this.column,e):this}min(t){return this.offset<=t.offset?this:t}max(t){return this.offset>=t.offset?this:t}get start(){return this}get end(){return this}union(e){if(e instanceof t)return this.offset===e.offset&&this.line===e.line&&this.column===e.column?this:at.from(this,e);if(e instanceof at){const t=this.min(e.start),r=this.max(e.end);return t===e.start&&r===e.end?e:at.from(t,r)}throw new Error(e.toString())}shift(e){const r=this.offset+(this.offset-e.offset),i=this.line+(this.line-e.line);let n=this.column;return 1===i&&(n+=this.column-e.column),r===this.offset&&i===this.line&&n===this.column?this:t.at(r,i,n,this.note)}equals(e){return this===e||e instanceof t&&(this.offset===e.offset&&this.line===e.line&&this.column===e.column&&this.note===e.note)}hashCode(){return s.mash(s.mix(s.mix(s.mix(s.mix(g.hash(t),f.hash(this.offset)),f.hash(this.line)),f.hash(this.column)),p.hash(this.note)))}display(t){return t=(t=St.displayNumber(t,this.line)).write(58),t=St.displayNumber(t,this.column),void 0!==this.note&&(t=t.write(58).write(32).write(this.note)),t}debug(t){return t=t.write("Mark").write(".").write("at").write("("),t=(t=St.debugNumber(t,this.offset)).write(", "),t=(t=St.debugNumber(t,this.line)).write(", "),t=St.debugNumber(t,this.column),void 0!==this.note&&(t=t.write(", "),t=St.debugString(t,this.note)),t=t.write(")")}toString(){return St.display(this)}static get zero(){return new t(0,1,1,void 0)}static at(e,r,i,n){return new t(e,r,i,n)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"getter",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})();class at extends st{constructor(t,e){super(),this.start=t,this.end=e}union(t){if(t instanceof ot){const e=this.start.min(t),r=this.end.max(t);return e===this.start&&r===this.end?this:at.from(e,r)}if(t instanceof at){const e=this.start.min(t.start),r=this.end.max(t.end);return e===this.start&&r===this.end?this:at.from(e,r)}throw new Error(t.toString())}shift(t){const e=this.start.shift(t),r=this.end.shift(t);return e===this.start&&r===this.end?this:at.from(e,r)}equals(t){return this===t||t instanceof at&&(this.start.equals(t.start)&&this.end.equals(t.end))}hashCode(){return s.mash(s.mix(s.mix(g.hash(at),this.start.hashCode()),this.end.hashCode()))}display(t){return void 0!==this.start.note&&(t=t.write(this.start.note).write(58).write(32)),t=(t=St.displayNumber(t,this.start.line)).write(58),t=(t=St.displayNumber(t,this.start.column)).write(45),t=(t=St.displayNumber(t,this.end.line)).write(58),t=St.displayNumber(t,this.end.column),void 0!==this.end.note&&(t=t.write(58).write(32).write(this.end.note)),t}debug(t){return t=t.write("Span").write(".").write("from").write("("),t=(t=this.start.debug(t)).write(", "),t=(t=this.end.debug(t)).write(")")}toString(){return St.display(this)}static from(t,e){if(t.offset>e.offset){const r=t;t=e,e=r}return new at(t,e)}}const ut=function(){const t={reset:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(109)),t},bold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(109)),t},faint:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(50).write(109)),t},black:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(48).write(109)),t},red:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(49).write(109)),t},green:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(50).write(109)),t},yellow:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(51).write(109)),t},blue:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(52).write(109)),t},magenta:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(53).write(109)),t},cyan:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(54).write(109)),t},gray:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(55).write(109)),t},blackBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(48).write(109)),t},redBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(49).write(109)),t},greenBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(50).write(109)),t},yellowBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(51).write(109)),t},blueBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(52).write(109)),t},magentaBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(53).write(109)),t},cyanBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(54).write(109)),t},grayBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(55).write(109)),t}};return t}();let ht=(()=>{var t;let i,n,a,u,h=[];return t=class{constructor(t,e,r,i){Object.defineProperty(this,"lineSeparator",{value:t,enumerable:!0}),Object.defineProperty(this,"pretty",{value:e,enumerable:!0}),Object.defineProperty(this,"styled",{value:r,enumerable:!0}),Object.defineProperty(this,"precision",{value:i,enumerable:!0})}withLineSeparator(t){return this.copy(t,this.pretty,this.styled,this.precision)}isPretty(){return this.pretty}asPretty(t){return this.copy(this.lineSeparator,t,this.styled,this.precision)}isStyled(){return this.styled}asStyled(t){return this.copy(this.lineSeparator,this.pretty,t,this.precision)}withPrecision(t){return this.copy(this.lineSeparator,this.pretty,this.styled,t)}copy(e,r,i,n){return t.create(e,r,i,n)}canEqual(e){return e instanceof t}equals(e){return this===e||e instanceof t&&(e.canEqual(this)&&this.lineSeparator===e.lineSeparator&&this.pretty===e.pretty&&this.styled===e.styled&&this.precision===e.precision)}hashCode(){return s.mash(s.mix(s.mix(s.mix(s.mix(g.hash(t),p.hash(this.lineSeparator)),d.hash(this.pretty)),d.hash(this.styled)),f.hash(this.precision)))}debug(t){return t=t.write("OutputSettings").write(46),t=(t=this.pretty||this.styled?this.pretty&&!this.styled?t.write("pretty"):!this.pretty&&this.styled?t.write("styled"):t.write("prettyStyled"):t.write("standard")).write(40).write(41),this.lineSeparator!==St.lineSeparator&&(t=t.write(46).write("lineSeparator").write(40).display(this.lineSeparator).write(41)),-1!==this.precision&&(t=t.write(46).write("precision").write(40).display(this.precision).write(41)),t}toString(){return St.debug(this)}static standard(){return new t(St.lineSeparator,!1,!1,-1)}static pretty(){return new t(St.lineSeparator,!0,!1,-1)}static styled(){return new t(St.lineSeparator,!1,!0,-1)}static prettyStyled(){return new t(St.lineSeparator,!0,!0,-1)}static create(e,r,i,n){return"string"!=typeof e&&(e=St.lineSeparator),"boolean"!=typeof r&&(r=!1),"boolean"!=typeof i&&(i=!1),"number"!=typeof n&&(n=-1),e===St.lineSeparator&&-1===n?r||i?r&&!i?t.pretty():!r&&i?t.styled():t.prettyStyled():t.standard():new t(e,r,i,n)}static fromInit(e){return t.create(e.lineSeparator,e.isPretty,e.isStyled,e.precision)}static fromLike(e){return e instanceof t?e:"object"==typeof e&&null!==e?t.fromInit(e):t.standard()}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],a=[o],u=[o],e(t,null,i,{kind:"method",name:"standard",static:!0,private:!1,access:{has:t=>"standard"in t,get:t=>t.standard},metadata:s},null,h),e(t,null,n,{kind:"method",name:"pretty",static:!0,private:!1,access:{has:t=>"pretty"in t,get:t=>t.pretty},metadata:s},null,h),e(t,null,a,{kind:"method",name:"styled",static:!0,private:!1,access:{has:t=>"styled"in t,get:t=>t.styled},metadata:s},null,h),e(t,null,u,{kind:"method",name:"prettyStyled",static:!0,private:!1,access:{has:t=>"prettyStyled"in t,get:t=>t.prettyStyled},metadata:s},null,h),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,h)})(),t})();class lt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,lt.prototype)}}let ct=(()=>{var t;let i,n,a=[];return t=class{constructor(t){Object.defineProperty(this,"stripped",{value:t,enumerable:!0})}isStripped(){return this.stripped}asStripped(t){return this.copy(t)}copy(e){return t.create(e)}canEqual(e){return e instanceof t}equals(e){return this===e||e instanceof t&&(e.canEqual(this)&&this.stripped===e.stripped)}hashCode(){return s.mash(s.mix(g.hash(t),d.hash(this.stripped)))}debug(t){return t=t.write("InputSettings").write(46),t=(t=this.stripped?t.write("stripped"):t.write("standard")).write(40).write(41)}toString(){return St.debug(this)}static standard(){return new t(!1)}static stripped(){return new t(!0)}static create(e){return e?t.stripped():t.standard()}static fromLike(e){return e instanceof t?e:"object"==typeof e&&null!==e?t.create(e.isStripped):t.standard()}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"standard",static:!0,private:!1,access:{has:t=>"standard"in t,get:t=>t.standard},metadata:s},null,a),e(t,null,n,{kind:"method",name:"stripped",static:!0,private:!1,access:{has:t=>"stripped"in t,get:t=>t.stripped},metadata:s},null,a),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,a)})(),t})(),dt=(()=>{var t;let i,n,s=[];return t=class{trap(){throw new lt}static empty(){return new Mt(void 0,ot.zero,ct.standard())}static done(){return new Ot(void 0,ot.zero,ct.standard())}static error(t){return new ft(t,void 0,ot.zero,ct.standard())}},(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:a},null,s),e(t,null,n,{kind:"method",name:"done",static:!0,private:!1,access:{has:t=>"done"in t,get:t=>t.done},metadata:a},null,s),a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),r(t,s)})(),t})();class ft extends dt{constructor(t,e,r,i){super(),Object.defineProperty(this,"error",{value:t,enumerable:!0}),Object.defineProperty(this,"id",{value:e,enumerable:!0}),Object.defineProperty(this,"mark",{value:r,enumerable:!0}),Object.defineProperty(this,"settings",{value:i,enumerable:!0})}isCont(){return!1}isEmpty(){return!1}isDone(){return!1}isError(){return!0}isPart(){return!1}asPart(t){return this}head(){throw new lt}step(){const t=new lt("error step");return new ft(t,this.id,this.mark,this.settings)}trap(){return this.error}seek(t){const e=new lt("error seek");return new ft(e,this.id,this.mark,this.settings)}withId(t){return new ft(this.error,t,this.mark,this.settings)}withMark(t){return new ft(this.error,this.id,t,this.settings)}get offset(){return this.mark.offset}get line(){return this.mark.line}get column(){return this.mark.column}withSettings(t){return t=ct.fromLike(t),new ft(this.error,this.id,this.mark,t)}clone(){return this}}class pt extends dt{constructor(t,e,r,i,n,s,o,a){super(),this.string=t,this.index=o,this.part=a,this.id=e,this.offset=r,this.line=i,this.column=n,this.settings=s}isCont(){return this.index<this.string.length}isEmpty(){return this.part&&this.index>=this.string.length}isDone(){return!this.part&&this.index>=this.string.length}isError(){return!1}isPart(){return this.part}asPart(t){return this.part=t,this}head(){const t=this.string,e=this.index;if(e<t.length){const r=t.codePointAt(e);return void 0!==r?r:t.charCodeAt(e)}throw new lt}step(){const t=this.string,e=this.index;if(e<t.length){const r=t.codePointAt(e);return this.index=p.offsetByCodePoints(t,e,1),this.offset+=this.index-e,10===r?(this.line+=1,this.column=1):this.column+=1,this}{const t=new lt("invalid step");return new ft(t,this.id,this.mark,this.settings)}}seek(t){if(void 0!==t){const e=this.index+(t.offset-this.offset);if(0<=e&&e<=this.string.length)return this.index=e,this.offset=t.offset,this.line=t.line,this.column=t.column,this;{const e=new lt("invalid seek to "+t);return new ft(e,this.id,this.mark,this.settings)}}return this.index=0,this.offset=0,this.line=1,this.column=1,this}withId(t){return this.id=t,this}get mark(){return ot.at(this.offset,this.line,this.column)}withMark(t){return this.offset=t.offset,this.line=t.line,this.column=t.column,this}withSettings(t){return t=ct.fromLike(t),this.settings=t,this}clone(){return new pt(this.string,this.id,this.offset,this.line,this.column,this.settings,this.index,this.part)}static create(t){return new pt(t,void 0,0,1,1,ct.standard(),0,!1)}}class mt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,mt.prototype)}}let yt=(()=>{var t;let i,n,s=[];return t=class{writeln(t){return"string"==typeof t&&this.write(t),this.write(this.settings.lineSeparator)}display(t){return St.displayAny(this,t)}debug(t){return St.debugAny(this,t)}flush(){return this}push(...t){const e=t.length;for(let r=0;r<e;r+=1)this.write(t[r])}trap(){throw new mt}clone(){throw new Error}static full(){return new Dt(ht.standard())}static done(){return new Lt(ht.standard())}static error(t){return new qt(t,ht.standard())}},(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"full",static:!0,private:!1,access:{has:t=>"full"in t,get:t=>t.full},metadata:a},null,s),e(t,null,n,{kind:"method",name:"done",static:!0,private:!1,access:{has:t=>"done"in t,get:t=>t.done},metadata:a},null,s),a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),r(t,s)})(),t})();class gt extends yt{constructor(t,e){super(),this.string=t,this.settings=e}isCont(){return!0}isFull(){return!1}isDone(){return!1}isError(){return!1}isPart(){return!1}asPart(t){return this}write(t){if("number"==typeof t)if(t>=0&&t<=55295||t>=57344&&t<=65535)t=String.fromCharCode(t);else if(t>=65536&&t<=1114111){const e=t-65536;t=String.fromCharCode(55296|e>>>10,56320|1023&e)}else t="�";return this.string+=t,this}writeln(t){return void 0!==t&&(this.string=this.string.concat(t)),this.string=this.string.concat(this.settings.lineSeparator),this}withSettings(t){return t=ht.fromLike(t),this.settings=t,this}bind(){return this.string}clone(){return new gt(this.string,this.settings)}toString(){return this.string}}class wt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,wt.prototype)}}let bt=(()=>{var t;let i,n=[];return t=class{isCont(){return!0}isDone(){return!1}isError(){return!1}feed(t){throw new wt}fork(t){return this}bind(){throw new wt}trap(){throw new wt}asDone(){throw new wt}asError(){throw new wt}andThen(t){return new Wt(this,t)}static end(){return new Bt}static done(t){return new Yt(t)}static error(t){return new Ht(t)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"end",static:!0,private:!1,access:{has:t=>"end"in t,get:t=>t.end},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})(),vt=class t extends bt{constructor(t,e,r=0){super(),this.value=t,this.input=e,this.index=r}feed(e){return new t(e,""+e)}pull(e){return t.write(e,this.value,this.input,this.index)}static write(e,r,i,n=0){const s=i.length;for(;n<s&&e.isCont();){let t=i.codePointAt(n);void 0===t&&(t=i.charCodeAt(n)),e=e.write(t),n=p.offsetByCodePoints(i,n,1)}return n===s?bt.done(r):e.isDone()?bt.error(new wt("truncated")):e.isError()?bt.error(e.trap()):new t(r,i,n)}};const xt=function(){const t={stringInput:function(t){return pt.create(t)},stringOutput:function(t,e){return void 0===e&&"string"!=typeof t?(e=t,t=""):"string"!=typeof t&&(t=""),e=ht.fromLike(e),new gt(t,e)},stringWriter:function(t){return void 0===t?new vt(void 0,""):new vt(t,""+t)},writeString:function(t,e){return vt.write(t,void 0,""+e)},isAlpha:function(t){return t>=65&&t<=90||t>=97&&t<=122},isDigit:function(t){return t>=48&&t<=57},isSpace:function(t){return 32===t||9===t},isNewline:function(t){return 10===t||13===t},isWhitespace:function(e){return t.isSpace(e)||t.isNewline(e)}};return t}(),St=function(){const t={};return Object.defineProperty(t,"lineSeparator",{value:"\n",enumerable:!0,configurable:!0}),t.display=function(t,e){if(void 0===t)return"undefined";if(null===t)return"null";if("number"==typeof t)return""+t;if("string"==typeof t)return t;if("function"==typeof t.display){let r=xt.stringOutput(e);return r=t.display(r),r.bind()}return""+t},t.debug=function(e,r){if(void 0===e)return"undefined";if(null===e)return"null";if("number"==typeof e)return""+e;if("string"==typeof e){let i=xt.stringOutput(r);return i=t.debugString(i,e),i.bind()}if("function"==typeof e.debug){let t=xt.stringOutput(r);return t=e.debug(t),t.bind()}return""+e},t.displayAny=function(e,r){return e=void 0===r?e.write("undefined"):null===r?e.write("null"):"number"==typeof r?t.displayNumber(e,r):"string"==typeof r?e.write(r):"function"==typeof r.display?r.display(e):e.write(""+r)},t.debugAny=function(e,r){return e=void 0===r?e.write("undefined"):null===r?e.write("null"):"number"==typeof r?t.debugNumber(e,r):"string"==typeof r?t.debugString(e,r):"function"==typeof r.debug?r.debug(e):e.write(""+r)},t.displayNumber=function(e,r){if(isFinite(r)&&Math.floor(r)===r&&Math.abs(r)<2147483648)if(r<0&&(e=e.write(45)),r>-10&&r<10)e=e.write(48+Math.abs(r));else{const t=new Array(19);let i=r,n=18;for(;0!==i;)t[n]=Math.abs(i%10|0),i=i/10|0,n-=1;for(n+=1;n<19;)e=e.write(48+t[n]),n+=1}else e=e.write(t.decimal(r,e.settings.precision));return e},t.debugNumber=function(e,r){return t.displayNumber(e,r)},t.debugChar=function(e,r){switch(e=e.write(39),r){case 8:e.write(92).write(98);break;case 9:e.write(92).write(116);break;case 10:e.write(92).write(110);break;case 12:e.write(92).write(102);break;case 13:e.write(92).write(114);break;case 34:e.write(92).write(34);break;case 39:e.write(92).write(39);break;case 92:e.write(92).write(92);break;default:e=r>=0&&r<=31||r>=127&&r<=159?e.write(92).write(117).write(t.encodeHex(r>>>12&15)).write(t.encodeHex(r>>>8&15)).write(t.encodeHex(r>>>4&15)).write(t.encodeHex(15&r)):e.write(r)}return e=e.write(39)},t.debugString=function(e,r){e=e.write(34);let i=xt.stringInput(r);for(;i.isCont();){const r=i.head();switch(r){case 8:e.write(92).write(98);break;case 9:e.write(92).write(116);break;case 10:e.write(92).write(110);break;case 12:e.write(92).write(102);break;case 13:e.write(92).write(114);break;case 34:e.write(92).write(34);break;case 92:e.write(92).write(92);break;default:e=r>=0&&r<=31||r>=127&&r<=159?e.write(92).write(117).write(t.encodeHex(r>>>12&15)).write(t.encodeHex(r>>>8&15)).write(t.encodeHex(r>>>4&15)).write(t.encodeHex(15&r)):e.write(r)}i=i.step()}return e=e.write(34)},t.encodeHex=function(t){return t<10?48+t:t-10+65},t.prefix=function(){const e=["y","z","a","f","p","n",String.fromCharCode(956),"m","","k","M","G","T","P","E"," Z","Y"];return function(r,i=1){if(isFinite(r)){const n=Math.abs(r).toExponential(),s=n.indexOf("e"),o=s>=0?+n.slice(s+1):NaN,a=3*Math.min(Math.max(-8,Math.floor(o/3)),8),u=Math.pow(10,-a)*r;let h=t.trimTrailingZeros(Math.abs(u).toFixed(i));return u<0&&0!=+h&&(h="-"+h),h+=e[8+a/3],h}return""+r}}(),t.decimal=function(e,r=-1){if(r>=0){let i=t.trimTrailingZeros(Math.abs(e).toFixed(r));return e<0&&0!=+i&&(i="-"+i),i}return""+e},t.trimTrailingZeros=function(t){let e,r=-1;for(let i=1;i<t.length;i+=1){const n=t.charCodeAt(i);if(46===n)r=i,e=i;else if(48===n)0===r&&(r=i),e=i;else if(n>=49&&n<=57)r>0&&(r=0);else if(r>0)break}return r>0&&(t=t.slice(0,r)+t.slice(e+1)),t},t.duration=function(t,e=" "){if(isFinite(t)){const r=1e3,i=60*r,n=60*i,s=24*n,o=7*s;let a,u,h,l,c;t>o&&(a=Math.floor(t/o),t%=o),t>s&&(u=Math.floor(t/s),t%=s),t>n&&(h=Math.floor(t/n),t%=n),t>i&&(l=Math.floor(t/i),t%=i),t>r&&(c=Math.floor(t/r),t%=r);let d="";return void 0!==a&&(d+=a+"w"),void 0!==u&&(d+=(0!==d.length?e:"")+u+"d"),void 0!==h&&(d+=(0!==d.length?e:"")+h+"h"),void 0!==l&&(d+=(0!==d.length?e:"")+l+"m"),void 0===c&&0!==t||(d+=(0!==d.length?e:"")+(void 0!==c?c:0)+"s"),0!==t&&0===d.length&&(d+=t+"ms"),d}return""+t},t}(),Ct=function(){const t={isDigit:function(t){return t>=48&&t<=57},decodeDigit:function(t){if(t>=48&&t<=57)return t-48;{let e=xt.stringOutput();throw e=e.write("Invalid base-10 digit: "),e=St.debugChar(e,t),new Error(e.bind())}},encodeDigit:function(t){if(t>=0&&t<=9)return 48+t;throw new Error(""+t)},countDigits:function(t){let e=0;do{e+=1,t=t/10|0}while(0!==t);return e},integerParser:function(){return new ie(void 0,void 0,0)},parseInteger:function(t){return ie.parse(t,void 0,void 0,0)},decimalParser:function(){return new ie(void 0,void 0,1)},parseDecimal:function(t){return ie.parse(t,void 0,void 0,1)},numberParser:function(){return new ie},parseNumber:function(t){return ie.parse(t)},integerWriter:function(t){return new se(void 0,void 0===t?0:t)},writeInteger:function(t,e){return se.write(t,void 0,e)}};return t}();class kt{constructor(t,e,r,i,n,s){this.input=t,this.tag=e,this.severity=r,this.message=i,this.note=n,this.cause=s}lineDigits(){let t=Ct.countDigits(this.tag.end.line);return null!==this.cause&&(t=Math.max(t,this.cause.lineDigits())),t}display(t){const e=this.input.clone(),r=this.tag.start,i=this.tag.end,n=this.severity,s=this.message,o=this.note,a=this.cause,u=this.lineDigits();return t=kt.display(t,e,r,i,n,s,o,a,2,u)}static display(t,e,r,i,n,s,o,a,u,h){for(;;){void 0!==s&&(t=(t=kt.displayMessage(t,n,s)).writeln()),t=(t=kt.displayAnchor(t,e,r,h)).writeln();const l=kt.displayContext(t,e,r,i,n,o,a,u,h),c=l[0];if(t=l[1],null===c)break;t=t.writeln(),e=c.input.clone(),r=c.tag.start,i=c.tag.end,n=c.severity,s=c.message,o=c.note,a=c.cause}return t}static displayMessage(t,e,r){return t=(t=kt.formatSeverity(t,e)).write(e.label),t=ut.reset(t),t=(t=ut.bold(t)).write(58),void 0!==r&&(t=t.write(32).write(r)),t=ut.reset(t)}static displayAnchor(t,e,r,i){t=(t=kt.displayLineLeadArrow(t,i)).write(32);const n=e.id;return void 0!==n&&(t=St.displayAny(t,n)),t=t.write(58),t=(t=St.displayNumber(t,r.line)).write(58),t=(t=St.displayNumber(t,r.column)).writeln(),t=kt.displayLineLead(t,i)}static displayContext(t,e,r,i,n,s,o,a,u){let h=o;const l=null!==o&&void 0===o.message&&v.equal(e.id,o.input.id)?r.offset<=o.tag.start.offset?-1:1:0;if(1===l){const e=kt.displayContext(t,o.input.clone(),o.tag.start,o.tag.end,o.severity,o.note,o.cause,a,u);h=e[0],t=(t=e[1]).writeln(),t=(t=kt.displayLineLeadEllipsis(t,u)).writeln()}if(t=kt.displayLines(t,e,r,i,n,a,u),void 0!==s&&(t=kt.displayNote(t,s,u)),-1===l){t=t.writeln(),t=(t=kt.displayLineLeadEllipsis(t,u)).writeln();const e=kt.displayContext(t,o.input.clone(),o.tag.start,o.tag.end,o.severity,o.note,o.cause,a,u);h=e[0],t=e[1]}return[h,t]}static displayLines(t,e,r,i,n,s,o){const a=r.line,u=i.line;let h=e.line;for(;h<a;)kt.consumeLineText(e,h),h+=1;if(u-a>2*s+2){for(;h<=a+s;)t=kt.displayLine(t,e,r,i,n,h,o),h+=1;for(t=(t=kt.displayLineLeadEllipsis(t,o)).write(32),t=(t=kt.formatSeverity(t,n)).write(124),t=(t=ut.reset(t)).writeln();h<u-s;)kt.consumeLineText(e,h),h+=1}for(;h<=u;)t=kt.displayLine(t,e,r,i,n,h,o),h+=1;return t}static displayNote(t,e,r){return t=t.writeln(),t=(t=kt.displayLineLead(t,r)).writeln(),t=kt.displayLineComment(t,"note",e,r)}static displayLine(t,e,r,i,n,s,o){return t=r.line===s&&i.line===s?kt.displaySingleLine(t,e,r,i,n,s,o):r.line===s?kt.displayStartLine(t,e,r,n,s,o):i.line===s?kt.displayEndLine(t,e,i,n,s,o):kt.displayMidLine(t,e,n,s,o)}static displaySingleLine(t,e,r,i,n,s,o){t=(t=kt.displayLineLeadNumber(t,s,o)).write(32);for(let r=1;r<e.column;r+=1)t=t.write(32);t=kt.displayLineText(t,e,s),t=(t=kt.displayLineLead(t,o)).write(32);let a=1;for(;a<r.column;)t=t.write(32),a+=1;for(t=kt.formatSeverity(t,n);a<=i.column;)t=t.write(94),a+=1;return void 0!==i.note&&(t=t.write(32).write(i.note)),t=ut.reset(t)}static displayStartLine(t,e,r,i,n,s){t=(t=kt.displayLineLeadNumber(t,n,s)).write(32).write(32).write(32);for(let r=1;r<e.column;r+=1)t=t.write(32);t=kt.displayLineText(t,e,n),t=(t=kt.displayLineLead(t,s)).write(32).write(32),t=(t=kt.formatSeverity(t,i)).write(95);let o=1;for(;o<r.column;)t=t.write(95),o+=1;return t=t.write(94),void 0!==r.note&&(t=t.write(32).write(r.note)),t=(t=ut.reset(t)).writeln()}static displayEndLine(t,e,r,i,n,s){t=(t=kt.displayLineLeadNumber(t,n,s)).write(32),t=(t=kt.formatSeverity(t,i)).write(124),t=(t=ut.reset(t)).write(32),t=kt.displayLineText(t,e,n),t=(t=kt.displayLineLead(t,s)).write(32),t=(t=kt.formatSeverity(t,i)).write(124).write(95);let o=1;for(;o<r.column;)t=t.write(95),o+=1;return t=t.write(94),void 0!==r.note&&(t=t.write(32).write(r.note)),t=ut.reset(t)}static displayMidLine(t,e,r,i,n){return t=(t=kt.displayLineLeadNumber(t,i,n)).write(32),t=(t=kt.formatSeverity(t,r)).write(124),t=(t=ut.reset(t)).write(32),t=kt.displayLineText(t,e,i)}static displayLineComment(t,e,r,i){return t=(t=kt.displayLineLeadComment(t,i)).write(32),t=(t=ut.bold(t)).write(e).write(58),t=ut.reset(t),void 0!==r&&(t=t.write(32).write(r)),t}static displayLineLead(t,e){t=ut.blueBold(t);const r=1+e;for(let e=0;e<r;e+=1)t=t.write(32);return t=t.write(124),t=ut.reset(t)}static displayLineLeadComment(t,e){t=ut.blueBold(t);const r=1+e;for(let e=0;e<r;e+=1)t=t.write(32);return t=t.write(61),t=ut.reset(t)}static displayLineLeadArrow(t,e){for(let r=0;r<e;r+=1)t=t.write(32);return t=(t=ut.blueBold(t)).write(45).write(45).write(62),t=ut.reset(t)}static displayLineLeadEllipsis(t,e){t=ut.blueBold(t);for(let r=0;r<e;r+=1)t=t.write(46);return t=(t=ut.reset(t)).write(32).write(32)}static displayLineLeadNumber(t,e,r){const i=r-Ct.countDigits(e);for(let e=0;e<i;e+=1)t=t.write(32);return t=ut.blueBold(t),t=(t=St.displayNumber(t,e)).write(32).write(124),t=ut.reset(t)}static displayLineText(t,e,r){for(;e.isCont()&&e.line===r;)t=t.write(e.head()),e=e.step();return e.line===r&&(t=t.writeln()),t}static consumeLineText(t,e){for(;t.isCont()&&t.line===e;)t=t.step()}static formatSeverity(t,e){switch(e.level){case nt.FatalLevel:case nt.AlertLevel:case nt.ErrorLevel:t=ut.redBold(t);break;case nt.WarningLevel:t=ut.yellowBold(t);break;case nt.NoteLevel:t=ut.greenBold(t);break;case nt.InfoLevel:t=ut.cyanBold(t);break;case nt.DebugLevel:case nt.TraceLevel:default:t=ut.magentaBold(t)}return t}toString(t){return St.display(this,t)}static create(t,e,r,i,n,s){return 3===arguments.length?(s=null,n=void 0,i=void 0):4===arguments.length?null===i||i instanceof kt?(s=i,i=void 0):s=null:5===arguments.length?null===n||n instanceof kt?(s=n,n=void 0):s=null:void 0===s&&(s=null),new kt(t.clone(),e,r,i,n,s)}static message(t,e,r,i,n){2===arguments.length?(n=null,i=void 0,r=nt.error()):3===arguments.length?null===r||r instanceof kt?(n=r,r=nt.error()):"string"==typeof r?(n=null,i=r,r=nt.error()):n=null:4===arguments.length?"string"==typeof r?(n=i,i=r,r=nt.error()):null===i||i instanceof kt?(n=i,i=void 0):n=null:void 0===n&&(n=null);const s=e.mark,o=e.clone();return o.seek(),new kt(o,s,r,t,i,n)}static unexpected(t,e,r,i){let n;if(1===arguments.length?(i=null,e=nt.error()):2===arguments.length?null===e||e instanceof kt?(i=e,e=nt.error()):"string"==typeof e?(i=null,r=e,e=nt.error()):i=null:3===arguments.length?"string"==typeof e?(i=r,r=e,e=nt.error()):null===r||r instanceof kt?(i=r,r=void 0):i=null:void 0===i&&(i=null),t.isCont()){let e=xt.stringOutput().write("unexpected").write(32);e=St.debugChar(e,t.head()),n=e.bind()}else n="unexpected end of input";const s=t.mark,o=t.clone();return o.seek(),new kt(o,s,e,n,r,i)}static expected(t,e,r,i,n){2===arguments.length?(n=null,r=nt.error()):3===arguments.length?null===r||r instanceof kt?(n=r,r=nt.error()):"string"==typeof r?(n=null,i=r,r=nt.error()):n=null:4===arguments.length?"string"==typeof r?(n=i,i=r,r=nt.error()):null===i||i instanceof kt?(n=i,i=void 0):n=null:void 0===n&&(n=null);let s=xt.stringOutput().write("expected").write(32);s="number"==typeof t?St.debugChar(s,t):s.write(t),s=s.write(44).write(32).write("but found").write(32),s=e.isCont()?St.debugChar(s,e.head()):s.write("end of input");const o=s.bind(),a=e.mark,u=e.clone();return u.seek(),new kt(u,a,r,o,i,n)}}class Mt extends dt{constructor(t,e,r){super(),Object.defineProperty(this,"id",{value:t,enumerable:!0}),Object.defineProperty(this,"mark",{value:e,enumerable:!0}),Object.defineProperty(this,"settings",{value:r,enumerable:!0})}isCont(){return!1}isEmpty(){return!0}isDone(){return!1}isError(){return!1}isPart(){return!0}asPart(t){return t?this:new Ot(this.id,this.mark,this.settings)}head(){throw new lt}step(){const t=new lt("empty step");return new ft(t,this.id,this.mark,this.settings)}seek(t){const e=new lt("empty seek");return new ft(e,this.id,this.mark,this.settings)}withId(t){return new Mt(t,this.mark,this.settings)}withMark(t){return new Mt(this.id,t,this.settings)}get offset(){return this.mark.offset}get line(){return this.mark.line}get column(){return this.mark.column}withSettings(t){return t=ct.fromLike(t),new Mt(this.id,this.mark,t)}clone(){return this}}class Ot extends dt{constructor(t,e,r){super(),Object.defineProperty(this,"id",{value:t,enumerable:!0}),Object.defineProperty(this,"mark",{value:e,enumerable:!0}),Object.defineProperty(this,"settings",{value:r,enumerable:!0})}isCont(){return!1}isEmpty(){return!1}isDone(){return!0}isError(){return!1}isPart(){return!1}asPart(t){return t?new Mt(this.id,this.mark,this.settings):this}head(){throw new lt}step(){const t=new lt("done step");return new ft(t,this.id,this.mark,this.settings)}seek(t){const e=new lt("empty seek");return new ft(e,this.id,this.mark,this.settings)}withId(t){return new Ot(t,this.mark,this.settings)}withMark(t){return new Ot(this.id,t,this.settings)}get offset(){return this.mark.offset}get line(){return this.mark.line}get column(){return this.mark.column}withSettings(t){return t=ct.fromLike(t),new Ot(this.id,this.mark,t)}clone(){return this}}let Et=(()=>{var t;let i,n,s=dt,a=[];return t=class extends s{static empty(){return new Tt(void 0,ot.zero,ct.standard())}static done(){return new Pt(void 0,ot.zero,ct.standard())}static error(t){return new It(t,void 0,ot.zero,ct.standard())}},(()=>{var u;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=s[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:h},null,a),e(t,null,n,{kind:"method",name:"done",static:!0,private:!1,access:{has:t=>"done"in t,get:t=>t.done},metadata:h},null,a),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,a)})(),t})();class Tt extends Et{constructor(t,e,r){super(),Object.defineProperty(this,"id",{value:t,enumerable:!0}),Object.defineProperty(this,"mark",{value:e,enumerable:!0}),Object.defineProperty(this,"settings",{value:r,enumerable:!0})}isCont(){return!1}isEmpty(){return!0}isDone(){return!1}isError(){return!1}isPart(){return!0}asPart(t){return t?this:new Pt(this.id,this.mark,this.settings)}get index(){return 0}withIndex(t){if(0===t)return this;{const t=new lt("invalid index");return new It(t,this.id,this.mark,this.settings)}}get limit(){return 0}withLimit(t){if(0===t)return this;{const t=new lt("invalid limit");return new It(t,this.id,this.mark,this.settings)}}get capacity(){return 0}get remaining(){return 0}has(t){return!1}get(t){throw new lt}set(t,e){throw new lt}head(){throw new lt}step(t){const e=new lt("empty step");return new It(e,this.id,this.mark,this.settings)}seek(t){const e=new lt("empty seek");return new It(e,this.id,this.mark,this.settings)}withId(t){return new Tt(t,this.mark,this.settings)}withMark(t){return new Tt(this.id,t,this.settings)}get offset(){return this.mark.offset}get line(){return this.mark.line}get column(){return this.mark.column}withSettings(t){return t=ct.fromLike(t),new Tt(this.id,this.mark,t)}clone(){return this}}class Pt extends Et{constructor(t,e,r){super(),Object.defineProperty(this,"id",{value:t,enumerable:!0}),Object.defineProperty(this,"mark",{value:e,enumerable:!0}),Object.defineProperty(this,"settings",{value:r,enumerable:!0})}isCont(){return!1}isEmpty(){return!1}isDone(){return!0}isError(){return!1}isPart(){return!1}asPart(t){return t?new Tt(this.id,this.mark,this.settings):this}get index(){return 0}withIndex(t){if(0===t)return this;{const t=new lt("invalid index");return new It(t,this.id,this.mark,this.settings)}}get limit(){return 0}withLimit(t){if(0===t)return this;{const t=new lt("invalid limit");return new It(t,this.id,this.mark,this.settings)}}get capacity(){return 0}get remaining(){return 0}has(t){return!1}get(t){throw new lt}set(t,e){throw new lt}head(){throw new lt}step(t){const e=new lt("done step");return new It(e,this.id,this.mark,this.settings)}seek(t){const e=new lt("done seek");return new It(e,this.id,this.mark,this.settings)}withId(t){return new Pt(t,this.mark,this.settings)}withMark(t){return new Pt(this.id,t,this.settings)}get offset(){return this.mark.offset}get line(){return this.mark.line}get column(){return this.mark.column}withSettings(t){return t=ct.fromLike(t),new Pt(this.id,this.mark,t)}clone(){return this}}class It extends Et{constructor(t,e,r,i){super(),Object.defineProperty(this,"error",{value:t,enumerable:!0}),Object.defineProperty(this,"id",{value:e,enumerable:!0}),Object.defineProperty(this,"mark",{value:r,enumerable:!0}),Object.defineProperty(this,"settings",{value:i,enumerable:!0})}isCont(){return!1}isEmpty(){return!1}isDone(){return!1}isError(){return!0}isPart(){return!1}asPart(t){return this}get index(){return 0}withIndex(t){if(0===t)return this;{const t=new lt("invalid index");return new It(t,this.id,this.mark,this.settings)}}get limit(){return 0}withLimit(t){if(0===t)return this;{const t=new lt("invalid limit");return new It(t,this.id,this.mark,this.settings)}}get capacity(){return 0}get remaining(){return 0}has(t){return!1}get(t){throw new lt}set(t,e){throw new lt}head(){throw new lt}step(t){const e=new lt("error step");return new It(e,this.id,this.mark,this.settings)}trap(){return this.error}seek(t){const e=new lt("error seek");return new It(e,this.id,this.mark,this.settings)}withId(t){return new It(this.error,t,this.mark,this.settings)}withMark(t){return new It(this.error,this.id,t,this.settings)}get offset(){return this.mark.offset}get line(){return this.mark.line}get column(){return this.mark.column}withSettings(t){return t=ct.fromLike(t),new It(this.error,this.id,this.mark,t)}clone(){return this}}class Dt extends yt{constructor(t){super(),Object.defineProperty(this,"settings",{value:t,enumerable:!0})}isCont(){return!1}isFull(){return!0}isDone(){return!1}isError(){return!1}isPart(){return!0}asPart(t){return t?this:new Lt(this.settings)}write(t){return new qt(new mt("full"),this.settings)}writeln(t){return new qt(new mt("full"),this.settings)}bind(){throw new mt}withSettings(t){return t=ht.fromLike(t),new Dt(t)}clone(){return this}}class Lt extends yt{constructor(t){super(),Object.defineProperty(this,"settings",{value:t,enumerable:!0})}isCont(){return!1}isFull(){return!1}isDone(){return!0}isError(){return!1}isPart(){return!1}asPart(t){return t?new Dt(this.settings):this}write(t){return new qt(new mt("done"),this.settings)}writeln(t){return new qt(new mt("done"),this.settings)}bind(){throw new mt}withSettings(t){return t=ht.fromLike(t),new Lt(t)}clone(){return this}}class qt extends yt{constructor(t,e){super(),Object.defineProperty(this,"error",{value:t,enumerable:!0}),Object.defineProperty(this,"settings",{value:e,enumerable:!0})}isCont(){return!1}isFull(){return!1}isDone(){return!1}isError(){return!0}isPart(){return!1}asPart(t){return this}write(t){return this}writeln(t){return this}bind(){throw new mt}trap(){return this.error}withSettings(t){return t=ht.fromLike(t),new qt(this.error,t)}clone(){return this}}let At=(()=>{var t;let i,n,s=yt,a=[];return t=class extends s{writeln(t){return"string"==typeof t&&this.write(t),this.write(this.settings.lineSeparator)}flush(){return this}clone(){throw new Error}static full(){return new Ft(ht.standard())}static done(){return new Vt(ht.standard())}static error(t){return new zt(t,ht.standard())}},(()=>{var u;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=s[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"full",static:!0,private:!1,access:{has:t=>"full"in t,get:t=>t.full},metadata:h},null,a),e(t,null,n,{kind:"method",name:"done",static:!0,private:!1,access:{has:t=>"done"in t,get:t=>t.done},metadata:h},null,a),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,a)})(),t})();class Ft extends At{constructor(t){super(),Object.defineProperty(this,"settings",{value:t,enumerable:!0})}isCont(){return!1}isFull(){return!0}isDone(){return!1}isError(){return!1}isPart(){return!0}asPart(t){return t?this:new Vt(this.settings)}get index(){return 0}withIndex(t){return 0===t?this:new zt(new mt("invalid index"),this.settings)}get limit(){return 0}withLimit(t){return 0===t?this:new zt(new mt("invalid limit"),this.settings)}get capacity(){return 0}get remaining(){return 0}has(t){return!1}get(t){throw new mt}set(t,e){throw new mt}write(t){return new zt(new mt("full"),this.settings)}writeln(t){return new zt(new mt("full"),this.settings)}step(t=1){return 0===t?this:new zt(new mt("invalid step"),this.settings)}bind(){throw new mt}withSettings(t){return t=ht.fromLike(t),new Ft(t)}clone(){return this}}class Vt extends At{constructor(t){super(),Object.defineProperty(this,"settings",{value:t,enumerable:!0})}isCont(){return!1}isFull(){return!1}isDone(){return!0}isError(){return!1}isPart(){return!1}asPart(t){return t?new Ft(this.settings):this}get index(){return 0}withIndex(t){return 0===t?this:new zt(new mt("invalid index"),this.settings)}get limit(){return 0}withLimit(t){return 0===t?this:new zt(new mt("invalid limit"),this.settings)}get capacity(){return 0}get remaining(){return 0}has(t){return!1}get(t){throw new mt}set(t,e){throw new mt}write(t){return new zt(new mt("done"),this.settings)}writeln(t){return new zt(new mt("done"),this.settings)}step(t=1){return 0===t?this:new zt(new mt("invalid step"),this.settings)}bind(){throw new mt}withSettings(t){return t=ht.fromLike(t),new Vt(t)}clone(){return this}}class zt extends At{constructor(t,e){super(),Object.defineProperty(this,"error",{value:t,enumerable:!0}),Object.defineProperty(this,"settings",{value:e,enumerable:!0})}isCont(){return!1}isFull(){return!1}isDone(){return!1}isError(){return!0}isPart(){return!1}asPart(t){return this}get index(){return 0}withIndex(t){return 0===t?this:new zt(new mt("invalid index"),this.settings)}get limit(){return 0}withLimit(t){return 0===t?this:new zt(new mt("invalid limit"),this.settings)}get capacity(){return 0}get remaining(){return 0}has(t){return!1}get(t){throw new mt}set(t,e){throw new mt}write(t){return this}writeln(t){return this}step(t=1){return 0===t?this:new zt(new mt("invalid step"),this.settings)}bind(){throw new mt}trap(){return this.error}withSettings(t){return t=ht.fromLike(t),new zt(this.error,t)}clone(){return this}}class jt extends Error{constructor(t){super(t instanceof kt?t.message:t),Object.setPrototypeOf(this,jt.prototype),this.diagnostic=t instanceof kt?t:null}toString(){return null!==this.diagnostic?this.diagnostic.toString():super.toString()}}class Nt{isCont(){return!0}isDone(){return!1}isError(){return!1}fork(t){return this}bind(){throw new jt}trap(){throw new jt}asError(){throw new jt}static done(t){return new Ut(t)}static error(t){return t instanceof Error?new Rt(t):new Rt(new jt(t))}}class Ut extends Nt{constructor(t){super(),Object.defineProperty(this,"value",{value:t,enumerable:!0})}isCont(){return!1}isDone(){return!0}feed(t){return this}bind(){return this.value}}class Rt extends Nt{constructor(t){super(),Object.defineProperty(this,"error",{value:t,enumerable:!0})}isCont(){return!1}isError(){return!0}feed(t){return this}bind(){throw this.error}trap(){return this.error}asError(){return this}}class Bt extends bt{constructor(){super()}isCont(){return!1}isDone(){return!0}pull(t){return this}bind(){throw new wt}asDone(){return this}andThen(t){return t}}class Yt extends bt{constructor(t){super(),Object.defineProperty(this,"value",{value:t,enumerable:!0})}isCont(){return!1}isDone(){return!0}pull(t){return this}bind(){return this.value}asDone(){return this}andThen(t){return t}}class Ht extends bt{constructor(t){super(),Object.defineProperty(this,"error",{value:t,enumerable:!0})}isCont(){return!1}isError(){return!0}pull(t){return this}bind(){throw this.error}trap(){return this.error}asError(){return this}andThen(t){return this}}class Wt extends bt{constructor(t,e){super(),this.head=t,this.tail=e}pull(t){let e=this.head;return e.isCont()&&(e=e.pull(t)),e.isError()?e.asError():e.isDone()?this.tail.pull(t):new Wt(e,this.tail)}}class Xt extends yt{constructor(t,e,r){super(),this.array=t,this.size=e,this.settings=r}isCont(){return!0}isFull(){return!1}isDone(){return!1}isError(){return!1}isPart(){return!1}asPart(t){return this}write(t){if("number"==typeof t){const e=this.size,r=this.array;let i;return null===r||e+1>r.length?(i=new Uint8Array(Xt.expand(e+1)),null!==r&&i.set(r,0),this.array=i):i=r,i[e]=t,this.size=e+1,this}throw new TypeError(""+t)}writeln(t){throw new TypeError(""+t)}toUint8Array(){const t=this.size,e=this.array;if(null!==e&&t===e.length)return e;{const r=new Uint8Array(t);return null!==e&&r.set(e.slice(0,t),0),this.array=r,r}}cloneArray(){const t=this.array;return null!==t?t.slice(0,this.size):null}withSettings(t){return t=ht.fromLike(t),this.settings=t,this}static expand(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}}class Kt extends Xt{constructor(t,e,r){super(t,e,r)}bind(){return this.toUint8Array()}clone(){return new Kt(this.cloneArray(),this.size,this.settings)}}class Gt extends At{constructor(t,e,r,i,n){super(),this.array=t,this.index=e,this.limit=r,this.part=i,this.settings=n}isCont(){return this.index<this.limit}isFull(){return this.part&&this.index>=this.limit}isDone(){return!this.part&&this.index>=this.limit}isError(){return!1}isPart(){return this.part}asPart(t){return this.part=t,this}withIndex(t){return 0<=t&&t<=this.limit?(this.index=t,this):new zt(new mt("invalid index"),this.settings)}withLimit(t){return 0<=t&&t<=this.array.length?(this.limit=t,this):new zt(new mt("invalid limit"),this.settings)}get capacity(){return this.array.length}get remaining(){return this.limit-this.index}has(t){return 0<=t&&t<this.limit}get(t){if(0<=t&&t<this.limit)return this.array[t];throw new mt}set(t,e){if(!(0<=t&&t<this.limit))throw new mt;this.array[t]=e}write(t){if("number"==typeof t){const e=this.index;return e<this.limit?(this.array[e]=t,this.index+=1,this):new zt(new mt("full"),this.settings)}return new zt(new mt("binary output"),this.settings)}writeln(t){return new zt(new mt("binary output"),this.settings)}step(t){const e=this.index+t;return 0<=e&&e<=this.limit?(this.index=e,this):new zt(new mt("invalid step"),this.settings)}bind(){return new Uint8Array(this.array.buffer,0,this.index)}withSettings(t){return t=ht.fromLike(t),this.settings=t,this}clone(){return new Gt(this.array,this.index,this.limit,this.part,this.settings)}static create(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=t.length),new Gt(t,e,e+r,!1,ht.standard())}}const Zt=function(){const t={output:function(t,e){let r;return void 0===e&&"number"!=typeof t?(e=t,t=void 0):"number"!=typeof t&&(t=void 0),r="number"==typeof t?new Uint8Array(t):null,e=ht.fromLike(e),new Kt(r,0,e)},outputBuffer:function(t,e,r){return Gt.create(t,e,r)}};return t}();let Qt=(()=>{var t;let i,n,s,a,u=[];return t=class{isFatal(){return!1}isReplacement(){return!1}toString(){return St.debug(this)}static fatal(){return new Jt(!1)}static fatalNonZero(){return new Jt(!0)}static replacement(){return new $t(65533,!1)}static replacementNonZero(){return new $t(65533,!0)}},(()=>{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],s=[o],a=[o],e(t,null,i,{kind:"method",name:"fatal",static:!0,private:!1,access:{has:t=>"fatal"in t,get:t=>t.fatal},metadata:h},null,u),e(t,null,n,{kind:"method",name:"fatalNonZero",static:!0,private:!1,access:{has:t=>"fatalNonZero"in t,get:t=>t.fatalNonZero},metadata:h},null,u),e(t,null,s,{kind:"method",name:"replacement",static:!0,private:!1,access:{has:t=>"replacement"in t,get:t=>t.replacement},metadata:h},null,u),e(t,null,a,{kind:"method",name:"replacementNonZero",static:!0,private:!1,access:{has:t=>"replacementNonZero"in t,get:t=>t.replacementNonZero},metadata:h},null,u),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,u)})(),t})();class Jt extends Qt{constructor(t){super(),Object.defineProperty(this,"nonZero",{value:t,enumerable:!0})}isFatal(){return!0}get replacementChar(){return 65533}isNonZero(){return this.nonZero}asNonZero(t){return t?Qt.fatalNonZero():Qt.fatal()}equals(t){return this===t||t instanceof Jt&&this.nonZero===t.nonZero}hashCode(){return s.mash(s.mix(g.hash(Jt),d.hash(this.nonZero)))}debug(t){return t=t.write("UtfErrorMode").write(46).write(this.nonZero?"fatalNonZero":"fatal").write(40).write(41)}}class $t extends Qt{constructor(t,e){super(),Object.defineProperty(this,"replacementChar",{value:t,enumerable:!0}),Object.defineProperty(this,"nonZero",{value:e,enumerable:!0})}isReplacement(){return!0}isNonZero(){return this.nonZero}asNonZero(t){return 65533===this.replacementChar?t?Qt.replacementNonZero():Qt.replacement():new $t(this.replacementChar,t)}equals(t){return this===t||t instanceof $t&&(this.replacementChar===t.replacementChar&&this.nonZero===t.nonZero)}hashCode(){return s.mash(s.mix(s.mix(g.hash($t),f.hash(this.replacementChar)),d.hash(this.nonZero)))}debug(t){return t=t.write("UtfErrorMode").write(46).write(this.nonZero?"replacementNonZero":"replacement").write(40).write(41)}}let _t=(()=>{var t;let i,n,s=[];return t=class{constructor(t){Object.defineProperty(this,"alphabet",{value:t,enumerable:!0})}encodeDigit(t){return this.alphabet.charCodeAt(t)}uint8ArrayWriter(t){return void 0===t?new ae(this,void 0,null):new ae(this,t,t)}writeUint8Array(t,e){return ae.write(t,this,void 0,e)}writeInteger(t,e,r=0){return ue.write(t,this,void 0,e,r)}writeIntegerLiteral(t,e,r=0){return ue.writeLiteral(t,this,void 0,e,r)}static get lowercase(){return new t("0123456789abcdef")}static get uppercase(){return new t("0123456789ABCDEF")}static isDigit(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}static decodeDigit(t){if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-65+10;if(t>=97&&t<=102)return t-97+10;{let e=xt.stringOutput();throw e=e.write("Invalid base-16 digit: "),e=St.debugChar(e,t),new Error(e.bind())}}static writeQuantum(e,r,i){const n=t.decodeDigit(r),s=t.decodeDigit(i);return e=e.write(n<<4|s)}static parser(t){return new oe(t)}static parse(t,e){return oe.parse(t,e)}static parseUint8Array(t){return oe.parse(t,Zt.output())}},(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],e(t,null,i,{kind:"getter",name:"lowercase",static:!0,private:!1,access:{has:t=>"lowercase"in t,get:t=>t.lowercase},metadata:a},null,s),e(t,null,n,{kind:"getter",name:"uppercase",static:!0,private:!1,access:{has:t=>"uppercase"in t,get:t=>t.uppercase},metadata:a},null,s),a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),r(t,s)})(),t})();class te extends yt{constructor(t,e,r,i,n,s){super(),this.output=t,this.errorMode=e,this.c1=r,this.c2=i,this.c3=n,this.have=s}isCont(){return this.output.isCont()}isFull(){return this.output.isFull()}isDone(){return this.output.isDone()}isError(){return this.output.isError()}isPart(){return this.output.isPart()}asPart(t){return this.output=this.output.asPart(t),this}write(t){if("number"==typeof t){let e=this.c1,r=this.c2,i=this.c3,n=-1,s=this.have;if(t>=0)switch(s){case 0:e=255&t,s=1;break;case 1:r=255&t,s=2;break;case 2:i=255&t,s=3;break;case 3:n=255&t,s=4;break;default:throw new Error("unreachable")}if(0===e&&this.errorMode.isNonZero())return yt.error(new mt("unexpected NUL byte"));if(e>=0&&e<=127)this.output=this.output.write(e),this.have=0;else if(e>=194&&e<=244)if(e>=194&&e<=223&&r>=128&&r<=191)this.output=this.output.write((31&e)<<6|63&r),this.c1=-1,this.have=0;else if(224===e&&r>=160&&r<=191||e>=225&&e<=236&&r>=128&&r<=191||237===e&&r>=128&&r<=159||e>=238&&e<=239&&r>=128&&r<=191)if(i>=128&&i<=191)this.output=this.output.write((15&e)<<12|(63&r)<<6|63&i),this.c1=-1,this.c2=-1,this.have=0;else if(i>=0){if(this.errorMode.isFatal())return yt.error(new mt(te.invalid(e,r,i)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=i,this.c2=-1,this.have=1}else{if(t<0||this.output.isDone())return yt.error(new mt(te.invalid(e,r)));this.c2=r,this.have=2}else if(240===e&&r>=144&&r<=191||e>=241&&e<=243&&r>=128&&r<=191||244===e&&r>=128&&r<=143)if(i>=128&&i<=191)if(n>=128&&n<=191)this.have=4,this.output=this.output.write((7&e)<<18|(63&r)<<12|(63&i)<<6|63&n),this.c1=-1,this.c2=-1,this.c3=-1,this.have=0;else if(n>=0){if(this.errorMode.isFatal())return yt.error(new mt(te.invalid(e,r,i,n)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=n,this.c2=-1,this.c3=-1,this.have=1}else{if(t<0||this.output.isDone())return yt.error(new mt(te.invalid(e,r,i)));this.c3=i,this.have=3}else if(i>=0){if(this.errorMode.isFatal())return yt.error(new mt(te.invalid(e,r,i)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=i,this.c2=-1,this.have=1}else{if(t<0||this.output.isDone())return yt.error(new mt(te.invalid(e,r)));this.c2=r,this.have=2}else if(r>=0){if(this.errorMode.isFatal())return yt.error(new mt(te.invalid(e,r)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=r,this.have=1}else{if(t<0||this.output.isDone())return yt.error(new mt(te.invalid(e)));this.c1=e,this.have=1}else if(e>=0){if(this.errorMode.isFatal())return yt.error(new mt(te.invalid(e)));this.output=this.output.write(this.errorMode.replacementChar),this.have=0}return this.output.isError()?this.output:this}if("string"==typeof t)return this.output=this.output.write(t),this;throw new TypeError(""+t)}static invalid(t,e,r,i){let n=xt.stringOutput();n=n.write("invalid UTF-8 code unit sequence: ");const s=_t.uppercase;return s.writeIntegerLiteral(n,t,2),void 0!==e&&(n=n.write(" "),s.writeIntegerLiteral(n,e,2),void 0!==r&&(n=n.write(" "),s.writeIntegerLiteral(n,r,2),void 0!==i&&(n=n.write(" "),s.writeIntegerLiteral(n,i,2)))),n.bind()}get settings(){return this.output.settings}withSettings(t){return this.output=this.output.withSettings(t),this}bind(){return 0===this.have?this.output.bind():this.write(-1).bind()}trap(){return this.output.trap()}clone(){return new te(this.output.clone(),this.errorMode,this.c1,this.c2,this.c3,this.have)}static create(t,e){return void 0===e&&(e=Qt.fatal()),new te(t,e,-1,-1,-1,0)}}class ee extends yt{constructor(t,e,r,i,n,s){super(),this.output=t,this.errorMode=e,this.c2=r,this.c3=i,this.c4=n,this.index=s}isCont(){return this.output.isCont()}isFull(){return this.output.isFull()}isDone(){return this.output.isDone()}isError(){return!1}isPart(){return this.output.isPart()}asPart(t){return this.output=this.output.asPart(t),this}write(t){if("number"==typeof t){let e=0,r=this.c2,i=this.c3,n=this.c4,s=this.output,o=this.index;for(;o<4;){if(!s.isCont())return yt.error(new mt("unable to flush buffered code units"));switch(o){case 1:s=s.write(r),this.c2=0;break;case 2:s=s.write(i),this.c3=0;break;case 3:s=s.write(n),this.c4=0;break;default:throw new Error("unreachable")}o+=1}if(t>=0&&t<=127)n=t,o=3;else if(t>=128&&t<=2047)i=192|t>>>6,n=128|63&t,o=2;else if(t>=2048&&t<=65535||t>=57344&&t<=65535)r=224|t>>>12,i=128|t>>>6&63,n=128|63&t,o=1;else{if(!(t>=65536&&t<=1114111))return this.errorMode.isFatal()?yt.error(new mt("invalid code point: "+t)):this.write(this.errorMode.replacementChar);e=240|t>>>18,r=128|t>>>12&63,i=128|t>>>6&63,n=128|63&t,o=0}do{switch(o){case 0:s=s.write(e);break;case 1:s=s.write(r),this.c2=0;break;case 2:s=s.write(i),this.c3=0;break;case 3:s=s.write(n),this.c4=0;break;default:throw new Error("unreachable")}this.output=s,o+=1}while(o<4&&s.isCont());return o<4&&(o<3&&(o<2&&(this.c2=r),this.c3=i),this.c4=n),this.output=s,this.index=o,this}if("string"==typeof t)return this.output=this.output.write(t),this;throw new TypeError(""+t)}flush(){let t=this.output,e=this.index;for(;e<4;){if(!t.isCont())return yt.error(new mt("unable to flush buffered code units"));switch(e){case 1:t=t.write(this.c2),this.c2=0;break;case 2:t=t.write(this.c3),this.c3=0;break;case 3:t=t.write(this.c4),this.c4=0;break;default:throw new Error("unreachable")}e+=1}return this.output=t,this.index=e,this}get settings(){return this.output.settings}withSettings(t){return this.output=this.output.withSettings(t),this}bind(){return this.output.bind()}clone(){return new ee(this.output.clone(),this.errorMode,this.c2,this.c3,this.c4,this.index)}static create(t,e){return void 0===e&&(e=Qt.fatal()),new ee(t,e,0,0,0,4)}}const re=function(){const t={sizeOf:function(e,r){if("number"==typeof e||void 0===e){if("number"==typeof e){if(0===e&&void 0!==r&&r.isNonZero())return 2;if(e>=0&&e<=127)return 1;if(e>=128&&e<=2047)return 2;if(e>=2048&&e<=65535||e>=57344&&e<=65535)return 3;if(e>=65536&&e<=1114111)return 4}return void 0===r?3:r.isReplacement()?t.sizeOf(r.replacementChar):0}if("string"==typeof e){let i=0;for(let n=0;n<e.length;n=p.offsetByCodePoints(e,n,1))i+=t.sizeOf(e.charCodeAt(n),r);return i}throw new TypeError(""+e)},decodedOutput:function(t,e){return te.create(t,e)},encodedOutput:function(t,e){return ee.create(t,e)},decodedString:function(){return t.decodedOutput(xt.stringOutput())}};return t}();class ie extends Nt{constructor(t=1,e=0,r=2,i=1){super(),this.sign=t,this.value=e,this.mode=r,this.step=i}feed(t){return ie.parse(t,this.sign,this.value,this.mode,this.step)}static parse(t,e=1,r=0,i=2,n=1){let s=0;if(1===n)if(t.isCont())s=t.head(),45===s?(t=t.step(),e=-1):43===s&&(t=t.step(),e=1),n=2;else if(t.isDone())return Nt.error(kt.expected("number",t));if(2===n)if(t.isCont())if(s=t.head(),48===s)t=t.step(),n=4;else{if(!(s>=49&&s<=57)){if(i>0&&46===s){let r=xt.stringOutput();return e<0&&(r=r.write(45)),ne.parse(t,r,i)}return Nt.error(kt.expected("number",t))}t=t.step(),r=e*(s-48),n=3}else if(t.isDone())return Nt.error(kt.expected("number",t));if(3===n){for(;t.isCont()&&(s=t.head(),s>=48&&s<=57);){const i=10*r+e*(s-48);if(!(-9007199254740991<=i&&i<=9007199254740992))return Nt.error(kt.message("integer overflow",t));r=i,t=t.step()}if(t.isCont())n=4;else if(t.isDone())return Nt.done(r)}if(4===n){if(t.isCont()){if(s=t.head(),i>0&&46===s||i>1&&(69===s||101===s)){let n=xt.stringOutput();return n=e<0&&0===r?n.write(45).write(48):n.write(""+r),ne.parse(t,n,i)}return Nt.done(r)}if(t.isDone())return Nt.done(r)}return new ie(e,r,i,n)}}class ne extends Nt{constructor(t,e=2,r=1){super(),this.output=t,this.mode=e,this.step=r}feed(t){return ne.parse(t,this.output,this.mode,this.step)}static parse(t,e,r=2,i=1){let n=0;if(1===i)if(t.isCont())if(n=t.head(),46===n)t=t.step(),e=e.write(n),i=2;else{if(!(r>1)||69!==n&&101!==n)return Nt.error(kt.expected("decimal or exponent",t));t=t.step(),e=e.write(n),i=5}else if(t.isDone())return Nt.error(kt.expected("decimal or exponent",t));if(2===i)if(t.isCont()){if(n=t.head(),!(n>=48&&n<=57))return Nt.error(kt.expected("digit",t));t=t.step(),e=e.write(n),i=3}else if(t.isDone())return Nt.error(kt.expected("digit",t));if(3===i){for(;t.isCont()&&(n=t.head(),n>=48&&n<=57);)t=t.step(),e=e.write(n);if(t.isCont()){if(!(r>1))return Nt.done(+e.bind());i=4}else if(t.isDone())return Nt.done(+e.bind())}if(4===i){if(n=t.head(),69!==n&&101!==n)return Nt.done(+e.bind());t=t.step(),e=e.write(n),i=5}if(5===i)if(t.isCont())n=t.head(),43!==n&&45!==n||(t=t.step(),e=e.write(n)),i=6;else if(t.isDone())return Nt.error(kt.unexpected(t));if(6===i)if(t.isCont()){if(n=t.head(),!(n>=48&&n<=57))return Nt.error(kt.expected("digit",t));t=t.step(),e=e.write(n),i=7}else if(t.isDone())return Nt.error(kt.expected("digit",t));if(7===i){for(;t.isCont()&&(n=t.head(),n>=48&&n<=57);)t=t.step(),e=e.write(n);if(!t.isEmpty())return Nt.done(+e.bind())}return new ne(e,r,i)}}class se extends bt{constructor(t,e,r=0,i=1){super(),this.value=t,this.input=e,this.index=r,this.step=i}pull(t){return se.write(t,this.value,this.input,this.index,this.step)}static write(t,e,r,i=0,n=1){if(0===n)return bt.end();if(1===n&&(r<0?t.isCont()&&(t=t.write(45),n=2):n=2),2===n)if(r>-10&&r<10){if(t.isCont())return t=t.write(Ct.encodeDigit(Math.abs(0|r))),bt.done(e)}else{const n=new Array(19);let s=r,o=18;for(;0!==s;)n[o]=Math.abs(s%10|0),s=s/10|0,o-=1;for(o+=1+i;o<19&&t.isCont();)t=t.write(Ct.encodeDigit(n[o])),i+=1,o+=1;if(19===o)return bt.done(e)}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new se(e,r,i,n)}}class oe extends Nt{constructor(t,e=0,r=1){super(),this.output=t,this.p=e,this.step=r}feed(t){return oe.parse(t,this.output.clone(),this.p,this.step)}static parse(t,e,r=0,i=1){let n=0;for(;!t.isEmpty();){if(1===i)if(t.isCont()&&(n=t.head(),_t.isDigit(n)))t=t.step(),r=n,i=2;else if(!t.isEmpty())return Nt.done(e.bind());if(2===i)if(t.isCont()&&(n=t.head(),_t.isDigit(n)))t=t.step(),e=_t.writeQuantum(e,r,n),r=0,i=1;else if(!t.isEmpty())return Nt.error(kt.expected("base16 digit",t))}return new oe(e,r,i)}}class ae extends bt{constructor(t,e,r,i=0,n=1){super(),this.base16=t,this.value=e,this.input=r,this.index=i,this.step=n}feed(t){if(t instanceof Uint8Array)return new ae(this.base16,void 0,t);throw new TypeError(""+t)}pull(t){if(null===this.input)throw new wt;return ae.write(t,this.base16,this.value,this.input,this.index,this.step)}static write(t,e,r,i,n=0,s=1){for(;n<i.length;){const r=i[n];1===s&&t.isCont()&&(t=t.write(e.encodeDigit(r>>>4)),s=2),2===s&&t.isCont()&&(t=t.write(e.encodeDigit(15&r)),n+=1,s=1)}return n===i.length?bt.done(r):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new ae(e,r,i,n,s)}}class ue extends bt{constructor(t,e,r,i,n=0,s=3){super(),this.base16=t,this.value=e,this.input=r,this.width=i,this.index=n,this.step=s}pull(t){return ue.write(t,this.base16,this.value,this.input,this.width,this.index,this.step)}static write(t,e,r,i,n,s=0,o=3){if(o<=0)return bt.end();if(1===o&&t.isCont()&&(t=t.write(48),o=2),2===o&&t.isCont()&&(t=t.write(120),o=3),3===o)if(i>=0&&i<16&&n<=1){if(t.isCont())return t=t.write(e.encodeDigit(i)),bt.done(r)}else{let o=15;const a=new Array(16);let u=i;for(;0!==u||o>=16-n;)a[o]=15&u,u>>>=4,o-=1;for(o+=1+s;o<16&&t.isCont();)t=t.write(e.encodeDigit(a[o])),s+=1,o+=1;if(16===o)return bt.done(r)}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new ue(e,r,i,n,s,o)}static writeLiteral(t,e,r,i,n){return ue.write(t,e,r,i,n,0,1)}}let he=(()=>{var t;let i,n,s,a,u=[];return t=class{decodeDigit(t){if(t>=65&&t<=90)return t-65;if(t>=97&&t<=122)return t+-71;if(t>=48&&t<=57)return t+4;if(43===t||45===t)return 62;if(47===t||95===t)return 63;{let e=xt.stringOutput();throw e=e.write("Invalid base-64 digit: "),e=St.debugChar(e,t),new Error(e.bind())}}encodeDigit(t){return this.alphabet.charCodeAt(t)}writeQuantum(t,e,r,i,n){const s=this.decodeDigit(e),o=this.decodeDigit(r);if(61!==i){const e=this.decodeDigit(i);if(61!==n){const r=this.decodeDigit(n);t=(t=(t=t.write(s<<2|o>>>4)).write(o<<4|e>>>2)).write(e<<6|r)}else t=(t=t.write(s<<2|o>>>4)).write(o<<4|e>>>2)}else{if(61!==n)return yt.error(new Error("Improperly padded base-64"));t=t.write(s<<2|o>>>4)}return t}parser(t){return new de(this,t)}parse(t,e){return de.parse(t,this,e)}parseUint8Array(t){return de.parse(t,this,Zt.output())}uint8ArrayWriter(t){return void 0===t?new fe(this,void 0,null):new fe(this,t,t)}writeUint8Array(t,e){return fe.write(t,this,void 0,e)}static get standardPadded(){return new le(!0)}static get standardUnpadded(){return new le(!1)}static standard(e=!0){return e?t.standardPadded:t.standardUnpadded}static get urlPadded(){return new ce(!0)}static get urlUnpadded(){return new ce(!1)}static url(e=!0){return e?t.urlPadded:t.urlUnpadded}},(()=>{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],s=[o],a=[o],e(t,null,i,{kind:"getter",name:"standardPadded",static:!0,private:!1,access:{has:t=>"standardPadded"in t,get:t=>t.standardPadded},metadata:h},null,u),e(t,null,n,{kind:"getter",name:"standardUnpadded",static:!0,private:!1,access:{has:t=>"standardUnpadded"in t,get:t=>t.standardUnpadded},metadata:h},null,u),e(t,null,s,{kind:"getter",name:"urlPadded",static:!0,private:!1,access:{has:t=>"urlPadded"in t,get:t=>t.urlPadded},metadata:h},null,u),e(t,null,a,{kind:"getter",name:"urlUnpadded",static:!0,private:!1,access:{has:t=>"urlUnpadded"in t,get:t=>t.urlUnpadded},metadata:h},null,u),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,u)})(),t})();class le extends he{constructor(t){super(),Object.defineProperty(this,"padded",{value:t,enumerable:!0})}get alphabet(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}isPadded(){return this.padded}asPadded(t){return t===this.padded?this:he.standard(t)}isDigit(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||43===t||47===t}}class ce extends he{constructor(t){super(),Object.defineProperty(this,"padded",{value:t,enumerable:!0})}get alphabet(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}isPadded(){return this.padded}asPadded(t){return t===this.padded?this:he.url(t)}isDigit(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||45===t||95===t}}class de extends Nt{constructor(t,e,r=0,i=0,n=0,s=1){super(),this.base64=t,this.output=e,this.p=r,this.q=i,this.r=n,this.step=s}feed(t){return de.parse(t,this.base64,this.output.clone(),this.p,this.q,this.r,this.step)}static parse(t,e,r,i=0,n=0,s=0,o=1){let a=0;for(;!t.isEmpty();){if(1===o)if(t.isCont()&&(a=t.head(),e.isDigit(a)))t=t.step(),i=a,o=2;else if(!t.isEmpty())return Nt.done(r.bind());if(2===o)if(t.isCont()&&(a=t.head(),e.isDigit(a)))t=t.step(),n=a,o=3;else if(!t.isEmpty())return Nt.error(kt.expected("base64 digit",t));if(3===o)if(t.isCont()&&(a=t.head(),e.isDigit(a)||61===a))t=t.step(),s=a,o=61!==a?4:5;else if(!t.isEmpty())return e.isPadded()?Nt.error(kt.unexpected(t)):(r=e.writeQuantum(r,i,n,61,61),Nt.done(r.bind()));if(4===o){if(t.isCont()&&(a=t.head(),e.isDigit(a)||61===a)){if(t=t.step(),r=e.writeQuantum(r,i,n,s,a),s=0,n=0,i=0,61===a)return Nt.done(r.bind());o=1}else if(!t.isEmpty())return e.isPadded()?Nt.error(kt.unexpected(t)):(r=e.writeQuantum(r,i,n,s,61),Nt.done(r.bind()))}else if(5===o){if(t.isCont()&&(a=t.head(),61===a))return t=t.step(),r=e.writeQuantum(r,i,n,s,a),s=0,n=0,i=0,Nt.done(r.bind());if(!t.isEmpty())return Nt.error(kt.expected(61,t))}}return new de(e,r,i,n,s,o)}}class fe extends bt{constructor(t,e,r,i=0,n=1){super(),this.base64=t,this.value=e,this.input=r,this.index=i,this.step=n}feed(t){if(t instanceof Uint8Array)return new fe(this.base64,null,t);throw new TypeError(""+t)}pull(t){if(null===this.input)throw new wt;return fe.write(t,this.base64,this.value,this.input,this.index,this.step)}static write(t,e,r,i,n=0,s=1){for(;n+2<i.length&&t.isCont();){const r=i[n],o=i[n+1],a=i[n+2];1===s&&t.isCont()&&(t=t.write(e.encodeDigit(r>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(e.encodeDigit(63&(r<<4|o>>>4))),s=3),3===s&&t.isCont()&&(t=t.write(e.encodeDigit(63&(o<<2|a>>>6))),s=4),4===s&&t.isCont()&&(t=t.write(e.encodeDigit(63&a)),n+=3,s=1)}if(n+1<i.length&&t.isCont()){const r=i[n],o=i[n+1];1===s&&t.isCont()&&(t=t.write(e.encodeDigit(r>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(e.encodeDigit(63&(r<<4|o>>>4))),s=3),3===s&&t.isCont()&&(t=t.write(e.encodeDigit(o<<2&63)),s=4),4===s&&(e.isPadded()?t.isCont()&&(t=t.write(61),n+=2):n+=2)}else if(n<i.length&&t.isCont()){const r=i[n];1===s&&t.isCont()&&(t=t.write(e.encodeDigit(r>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(e.encodeDigit(r<<4&63)),s=3),3===s&&(e.isPadded()?t.isCont()&&(t=t.write(61),s=4):n+=1),4===s&&t.isCont()&&(t=t.write(61),n+=1)}return n===i.length?bt.done(r):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new fe(e,r,i,n,s)}}const pe=Object.freeze({Transient:0,Inherited:1,Intrinsic:2,Extrinsic:3,Reflexive:4,Shift:2,Mask:3});void 0===Symbol.metadata&&(Symbol.metadata=Symbol("Symbol.metadata"));const me={metaclass:Symbol("FastenerContext.metaclass"),getMetaclass(t){const e=t.constructor;if(void 0===e)return null;const r=e[Symbol.metadata];if(null==r)return null;const i=r[me.metaclass];return void 0===i?null:i}};class ye{constructor(){this.classMap={},this.slotMap={},this.slots=[]}getFastenerClass(t){const e=this.classMap[t];return void 0!==e?e:null}getFastenerSlot(t){return this.slotMap[t]}tryFastener(t,e){const r=this.slotMap[e],i=void 0!==r?t[r]:void 0;return void 0!==i?i:null}static get(t){return Object.hasOwnProperty.call(t,me.metaclass)?t[me.metaclass]:null}static getOrCreate(t){if(Object.hasOwnProperty.call(t,me.metaclass))return t[me.metaclass];const e=t[me.metaclass],r=new ye;if(t[me.metaclass]=r,void 0!==e){for(const t in e.classMap)r.classMap[t]=e.classMap[t];for(const t in e.slotMap)r.slotMap[t]=e.slotMap[t];r.slots.push(...e.slots)}return r}}const ge=function(t,e){const r=function(t){return r.decorate.bind(r,r,t)};return Object.setPrototypeOf(t,Object.prototype),r.prototype=t,r.prototype.constructor=r,Object.setPrototypeOf(e,r.prototype),Object.setPrototypeOf(r,e),r}({get fastenerType(){return ge},get name(){return"Fastener"},init(){},binds:!1,flagsInit:0,setFlags(t){this.flags=t},incrementVersion(){this.version+=1},setCoherentTime(t){this.coherentTime=t},get parentType(){},get parent(){const t=this.inheritName;return void 0!==t&&b.hasAllKeys(this.owner,"getParentFastener")?this.owner.getParentFastener(t,this.fastenerType,this.parentType):null},inheritInlet(){let t;0!=(this.flags&ge.InheritsFlag)&&null!==(t=this.parent)&&(this.willBindInlet(t),t.attachOutlet(this),this.inletVersion=-1,this.inlet=t,this.onBindInlet(t),this.didBindInlet(t))},bindInlet(t,e){this.setInherits(!1),this.willBindInlet(t),t.attachOutlet(this),this.inletVersion=-1,this.inlet=t,this.onBindInlet(t),this.didBindInlet(t)},willBindInlet(t){},onBindInlet(t){this.recohere(performance.now())},didBindInlet(t){},uninheritInlet(){if(0==(this.flags&ge.InheritsFlag))return;const t=this.inlet;t instanceof ge&&(this.willUnbindInlet(t),t.detachOutlet(this),this.inletVersion=-1,this.inlet=null,this.onUnbindInlet(t),this.didUnbindInlet(t))},unbindInlet(t){void 0===t&&this.inlet instanceof ge&&(t=this.inlet),t instanceof ge&&t===this.inlet?(this.willUnbindInlet(t),t.detachOutlet(this),this.inletVersion=-1,this.inlet=null,this.onUnbindInlet(t),this.didUnbindInlet(t)):void 0===t&&(this.inletVersion=-1,this.inlet=null)},willUnbindInlet(t){},onUnbindInlet(t){this.setDerived(!1)},didUnbindInlet(t){},attachOutlet(t){},detachOutlet(t){},get inheritName(){return 0!=(this.flags&ge.InheritsFlag)?this.name:void 0},get inherits(){return 0!=(this.flags&ge.InheritsFlag)},setInherits(t){let e;"string"!=typeof t&&"number"!=typeof t&&"symbol"!=typeof t||(t!==this.name&&(e=t),t=!0),t&&(0==(this.flags&ge.InheritsFlag)||void 0!==e&&e!==this.name)?(this.unbindInlet(),this.willSetInherits(!0,e),void 0!==e&&Object.defineProperty(this,"name",{value:e,enumerable:!0,configurable:!0}),this.setFlags(this.flags|ge.InheritsFlag),this.onSetInherits(!0,e),this.didSetInherits(!0,e),this.inheritInlet()):t||0==(this.flags&ge.InheritsFlag)||(this.unbindInlet(),this.willSetInherits(!1,e),this.setFlags(this.flags&~ge.InheritsFlag),this.onSetInherits(!1,e),this.didSetInherits(!1,e))},willSetInherits(t,e){},onSetInherits(t,e){},didSetInherits(t,e){},get derived(){return 0!=(this.flags&ge.DerivedFlag)},setDerived(t){t?this.setFlags(this.flags|ge.DerivedFlag):this.setFlags(this.flags&~ge.DerivedFlag)},get affinity(){return this.flags&pe.Mask},hasAffinity(t){return t>=(this.flags&pe.Mask)},initAffinity(t){this.flags=this.flags&~pe.Mask|t&pe.Mask},minAffinity(t){const e=this.flags&pe.Mask;if(t===pe.Reflexive)t=e;else if(0!=(t&~pe.Mask))throw new Error("invalid affinity: "+t);return t>e&&(this.willSetAffinity(t,e),this.setFlags(this.flags&~pe.Mask|t),this.onSetAffinity(t,e),this.didSetAffinity(t,e)),t>=e},setAffinity(t){if(0!=(t&~pe.Mask))throw new Error("invalid affinity: "+t);const e=this.flags&pe.Mask;t!==e&&(this.willSetAffinity(t,e),this.setFlags(this.flags&~pe.Mask|t),this.onSetAffinity(t,e),this.didSetAffinity(t,e))},willSetAffinity(t,e){},onSetAffinity(t,e){if(t>e&&0!=(this.flags&ge.DerivedFlag)){const e=this.inlet;e instanceof ge&&Math.min(e.flags&pe.Mask,pe.Intrinsic)<t&&this.setDerived(!1)}else if(t<e&&0!=(this.flags&ge.InheritsFlag)){const e=this.inlet;e instanceof ge&&Math.min(e.flags&pe.Mask,pe.Intrinsic)>=t&&this.decohere(e)}},didSetAffinity(t,e){},get(){},get coherent(){return 0==(this.flags&ge.DecoherentFlag)},setCoherent(t){t?this.setFlags(this.flags&~ge.DecoherentFlag):this.setFlags(this.flags|ge.DecoherentFlag)},decohere(t){void 0===t||t!==this.inlet||0!=(this.flags&ge.DerivedFlag)?0==(this.flags&ge.DecoherentFlag)&&this.requireRecohere():this.recohere(performance.now())},requireRecohere(){this.setCoherent(!1),b.hasAllKeys(this.owner,"decohereFastener")&&this.owner.decohereFastener(this)},recohere(t){this.setCoherentTime(t);const e=this.inlet;e instanceof ge?this.setDerived((this.flags&pe.Mask)<=Math.min(e.flags&pe.Mask,pe.Intrinsic)):Array.isArray(e)?this.setDerived(!0):this.setDerived(!1),this.setCoherent(!0)},inletKeys:void 0,resolveInlets(){const t=this.inletKeys;if(void 0===t||!b.hasAllKeys(this.owner,"getFastener"))return null;const e=new Array(t.length);for(let r=0;r<t.length;r+=1){const i=t[r],n=this.owner.getFastener(i);if(null===n)return null;e[r]=n}return e},attachInlets(){const t=this.resolveInlets();if(null!==t){this.setInherits(!1),this.setFlags(this.flags|ge.DerivedFlag);const e=new Array(t.length);for(let r=0;r<t.length;r+=1)e[r]=-1;this.inletVersion=e,this.inlet=t;for(let e=0;e<t.length;e+=1)t[e].attachOutlet(this)}else this.inheritInlet()},detachInlets(){const t=this.inlet;if(Array.isArray(t)){for(let e=0;e<t.length;e+=1)t[e].detachOutlet(this);this.inletVersion=-1,this.inlet=null,this.setFlags(this.flags&~ge.DerivedFlag)}else this.uninheritInlet()},getFastener(t,e,r){if(null!=r&&!(this instanceof r))return null;const i=this[t];return void 0!==i&&(null==e||i instanceof e)?i:null},getParentFastener:(t,e,r)=>null,attachFastener(t){this.mounted&&t.mount()},decohereFastener(t){b.hasAllKeys(this.owner,"decohereFastener")&&this.owner.decohereFastener(t)},requireUpdate(t){b.hasAllKeys(this.owner,"requireUpdate")&&this.owner.requireUpdate(t)},getTransition(t){return b.hasAllKeys(this.owner,"getTransition")?this.owner.getTransition(t):null},mountFasteners(){const t=me.getMetaclass(this);if(null===t)return;const e=t.slots;for(let t=0;t<e.length;t+=1){const r=this[e[t]];r instanceof ge&&r.mount()}},unmountFasteners(){const t=me.getMetaclass(this);if(null===t)return;const e=t.slots;for(let t=0;t<e.length;t+=1){const r=this[e[t]];r instanceof ge&&r.unmount()}},get mounted(){return 0!=(this.flags&ge.MountedFlag)},mount(){0==(this.flags&ge.MountedFlag)&&(this.willMount(),this.setFlags(this.flags|ge.MountedFlag),this.onMount(),this.didMount())},willMount(){},onMount(){this.attachInlets()},didMount(){this.mountFasteners()},unmount(){0!=(this.flags&ge.MountedFlag)&&(this.willUnmount(),this.setFlags(this.flags&~ge.MountedFlag),this.onUnmount(),this.didUnmount())},willUnmount(){this.unmountFasteners()},onUnmount(){this.detachInlets()},didUnmount(){},toString(){return this.name.toString()}},{create(t){const e=this.construct(null,t);return e.init(),e},construct(t,e){return null===t&&(t=Object.create(this.prototype)),t.owner=e,t.flags=t.flagsInit,t.coherentTime=0,t.version=0,t.inletVersion=-1,t.inlet=null,t},declare(t){if("string"==typeof t&&m.isValid(t)&&"Fastener"!==t&&"template"!==t)return new Function("Fastener","return function "+t+"(template) { return Fastener.decorate.bind(Fastener, "+t+", template); }")(ge);const e=function(t){return ge.decorate.bind(ge,ge,t)};return Object.defineProperty(e,"name",{value:t,enumerable:!0,configurable:!0}),e},implement(t,e,r){Object.defineProperty(e,"name",{value:t.name,enumerable:!0,configurable:!0}),"extends"in e&&delete e.extends,Object.setPrototypeOf(e,this.prototype),t.prototype=e,t.prototype.constructor=t,void 0!==r?(Object.setPrototypeOf(t,r),Object.setPrototypeOf(r,this)):Object.setPrototypeOf(t,this)},specialize(t){let e=t.extends;return null==e&&(e=this),e},refine(t){const e=t.prototype;let r=e.flagsInit;if(Object.prototype.hasOwnProperty.call(e,"affinity")&&(r=r&~pe.Mask|e.affinity&pe.Mask,delete e.affinity),Object.prototype.hasOwnProperty.call(e,"inherits")){let t=e.inherits;"string"!=typeof t&&"number"!=typeof t&&"symbol"!=typeof t||(Object.defineProperty(e,"name",{value:t,enumerable:!0,configurable:!0}),t=!0),t?r|=ge.InheritsFlag:r&=~ge.InheritsFlag,delete e.inherits}Object.defineProperty(e,"flagsInit",{value:r,enumerable:!0,configurable:!0})},extend(t,e,r){void 0!==e.name&&(t=e.name);const i=this.declare(t);return this.implement(i,e,r),this.refine(i),i},define(t,e,r){return"boolean"==typeof e.extends&&(!0===e.extends?Object.defineProperty(e,"extends",{value:r,enumerable:!0,configurable:!0}):!1===e.extends&&Object.defineProperty(e,"extends",{value:null,enumerable:!0,configurable:!0})),this.specialize(e).extend(t,e)},getter(){throw new Error("missing decorator")},decorate(t,e,r,i){if("field"===i.kind)return ge.decorateField(t,e,r,i);if("getter"===i.kind)return ge.decorateGetter(t,e,r,i);throw new Error("unsupported "+i.kind+" decorator")},decorateField(t,e,r,i){const n=ye.getOrCreate(i.metadata),s=i.name,o=s,a=n.classMap[s],u=t.define(s,e,a);return n.classMap[s]=u,n.slotMap[s]=o,void 0===a&&n.slots.push(o),function(t){return u.create(this)}},decorateGetter(t,e,r,i){const n=ye.getOrCreate(i.metadata),s=i.name,o=void 0!==n.slotMap[s]?n.slotMap[s]:Symbol(s.toString()),a=n.classMap[s],u=t.define(s,e,a);return n.classMap[s]=u,n.slotMap[s]=o,void 0===a&&n.slots.push(o),i.addInitializer((function(){this[o]=void 0})),function(){let t=this[o];return void 0===t&&(t=u.create(this),this[o]=t,void 0!==this.attachFastener&&this.attachFastener(t)),t}},initDecorators(){if(!Object.hasOwnProperty.call(this,Symbol.metadata)){const t=Object.getPrototypeOf(this)[Symbol.metadata];Object.defineProperty(this,Symbol.metadata,{value:Object.create(void 0!==t?t:null),writable:!0,enumerable:!0,configurable:!0})}Object.hasOwnProperty.call(this,"fieldInitializers")||Object.defineProperty(this,"fieldInitializers",{value:{},enumerable:!0,configurable:!0}),Object.hasOwnProperty.call(this,"instanceInitializers")||Object.defineProperty(this,"instanceInitializers",{value:[],enumerable:!0,configurable:!0})},defineField(t,r){this.initDecorators(),e(null,null,r,{kind:"field",name:t,static:!1,private:!1,access:{has:e=>t in e,get:e=>e[t],set(e,r){e[t]=r}},metadata:this[Symbol.metadata]},this.fieldInitializers[t]=[],this.instanceInitializers)},defineGetter(t,r){this.initDecorators(),Object.defineProperty(this.prototype,t,{get:ge.getter,enumerable:!0,configurable:!0}),e(this,null,r,{kind:"getter",name:t,static:!1,private:!1,access:{has:e=>t in e,get:e=>e[t],set(e,r){e[t]=r}},metadata:this[Symbol.metadata]},null,this.instanceInitializers)},initFasteners(t){if(Object.hasOwnProperty.call(this,"fieldInitializers")&&Object.hasOwnProperty.call(this,"instanceInitializers")){r(t,this.instanceInitializers);for(const e in this.fieldInitializers)t[e]=r(t,this.fieldInitializers[e],void 0)}},MountedFlag:1<<pe.Shift+0,InheritsFlag:1<<pe.Shift+1,DerivedFlag:1<<pe.Shift+2,DecoherentFlag:1<<pe.Shift+3,FlagShift:pe.Shift+4,FlagMask:(1<<pe.Shift+4)-1}),we=ge.extend("Property",{get fastenerType(){return we},get inletValue(){const t=this.inlet;return t instanceof we?t.getOutletValue(this):void 0},getInletValue(){const t=this.inletValue;if(null==t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="inlet value",new TypeError(e)}return t},getInletValueOr(t){const e=this.inletValue;return null==e?t:e},attachOutlet(t){let e=this.outlets;null===e&&(e=new Set,this.outlets=e),e.add(t)},detachOutlet(t){const e=this.outlets;null!==e&&e.delete(t)},decohereOutlets(){const t=this.outlets;if(null!==t)for(const e of t)e.decohere(this)},getOutletValue(t){return this.value},get(){return this.value},set(t){return t instanceof ge?this.bindInlet(t):this.setValue(t,pe.Extrinsic),this.owner},setIntrinsic(t){return t instanceof ge?this.bindInlet(t):this.setValue(t,pe.Intrinsic),this.owner},valueType:void 0,initValue(){return Object.getPrototypeOf(this).value},getValue(){const t=this.value;if(null==t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="value",new TypeError(e)}return t},getValueOr(t){const e=this.value;return null==e?t:e},transformValue:t=>t,setValue(t,e){if(void 0===e&&(e=pe.Extrinsic),!this.minAffinity(e))return;t=this.fromLike(t),t=this.transformValue(t);const r=this.value;this.equalValues(t,r)?this.setCoherent(!0):(this.willSetValue(t,r),this.incrementVersion(),this.value=t,this.onSetValue(t,r),this.didSetValue(t,r),this.setCoherent(!0),this.decohereOutlets())},willSetValue(t,e){},onSetValue(t,e){const r=this.updateFlags;void 0!==r&&b.hasAllKeys(this.owner,"requireUpdate")&&this.owner.requireUpdate(r)},didSetValue(t,e){},get transition(){return this.derived&&this.inlet instanceof we?this.inlet.transition:null},updateFlags:void 0,deriveValue:(...t)=>t[0],recohere(t){this.setCoherentTime(t);const e=this.inlet;if(e instanceof we)if(this.setDerived((this.flags&pe.Mask)<=Math.min(e.flags&pe.Mask,pe.Intrinsic)),0!=(this.flags&ge.DerivedFlag)){this.inletVersion=e.version;const t=this.deriveValue(e.getOutletValue(this));this.setValue(t,pe.Reflexive)}else this.setCoherent(!0);else if(Array.isArray(e)){this.setDerived(!0);const t=this.inletVersion,r=new Array(e.length);for(let i=0;i<e.length;i+=1){if(!(e[i]instanceof we))return this.setDerived(!1),void this.setCoherent(!0);t[i]=e[i].version,r[i]=e[i].getOutletValue(this)}const i=this.deriveValue(...r);this.setValue(i,pe.Reflexive)}else this.setDerived(!1),this.setCoherent(!0)},definedValue:t=>null!=t,equalValues:(t,e)=>a(t,e),fromLike(t){return x(this.valueType,t)}},{tryValue(t,e){const r=me.getMetaclass(t);if(null===r)return;const i=r.tryFastener(t,e);if(!(i instanceof we)){const t=r.getFastenerClass(e);if(null===t)return;return t.prototype.value}return i.value},tryValueOr(t,e,r){let i=this.tryValue(t,e);return null==i&&(i=r),i},construct(t,e){return(t=super.construct(t,e)).outlets=null,t.value=t.initValue(),t},refine(t){super.refine(t);const e=t.prototype,r=Object.getOwnPropertyDescriptor(e,"value");void 0!==r&&"value"in r&&(r.value=e.fromLike(r.value),Object.defineProperty(e,"value",r))}}),be=we.extend("Animator",{get inletState(){const t=this.inlet;return t instanceof be?t.getOutletState(this):void 0},getInletState(){const t=this.inletState;if(null==t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="inlet state",new TypeError(e)}return t},getInletStateOr(t){const e=this.inletState;return null==e?t:e},getOutletState(t){return this.state},set(t,e){return t instanceof ge?this.bindInlet(t):this.setState(t,e,pe.Extrinsic),this.owner},setIntrinsic(t,e){return t instanceof ge?this.bindInlet(t):this.setState(t,e,pe.Intrinsic),this.owner},setValue(t,e){if(void 0===e&&(e=pe.Extrinsic),!this.minAffinity(e))return;t=this.fromLike(t),t=this.transformValue(t);const r=this.value;this.equalValues(t,r)||(this.willSetValue(t,r),this.incrementVersion(),this.value=t,this.onSetValue(t,r),this.didSetValue(t,r),this.decohereOutlets())},getState(){const t=this.state;if(null==t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="state",new TypeError(e)}return t},getStateOr(t){const e=this.state;return null==e?t:e},transformState:t=>t,setState(t,e,r){if("number"==typeof e&&(r=e,e=void 0),void 0===r&&(r=pe.Extrinsic),!this.minAffinity(r))return;t=this.fromLike(t),t=this.transformState(t);const i=this.state;if(void 0===e&&this.equalValues(t,i))return;!0===(e=void 0===e?this.transition:W.fromLike(e))?e=b.hasAllKeys(this.owner,"getTransition")?this.owner.getTransition(this):this.timing:!1===e&&(e=null);const n=null!==e&&this.definedValue(i);this.willSetState(t,i),this.state=t,n?(this.timing=e,this.interpolator=j(this.value,t),0!=(this.flags&be.TweeningFlag)?this.setFlags(this.flags|be.DivergedFlag|be.InterruptFlag):this.setFlags(this.flags|be.DivergedFlag)):(this.timing=null,this.interpolator=null),this.onSetState(t,i),n||this.setValue(t,pe.Reflexive),this.didSetState(t,i),n?this.startTweening():0!=(this.flags&be.TweeningFlag)&&(this.didInterrupt(this.value),this.stopTweening())},willSetState(t,e){},onSetState(t,e){},didSetState(t,e){},setInterpolatedValue(t,e){const r=arguments.length>1?this.state:void 0,i=arguments.length>1&&!this.equalValues(e,r);i&&(this.willSetState(e,r),this.state=e,this.timing=null,this.interpolator=null,this.onSetState(e,r)),this.setValue(t,pe.Reflexive),i&&(this.didSetState(e,r),0!=(this.flags&be.TweeningFlag)&&(this.didInterrupt(this.value),this.stopTweening()))},decohere(t){void 0===t||t!==this.inlet||0!=(this.flags&ge.DerivedFlag)?(t instanceof be&&0!=(t.flags&be.TweeningFlag)&&this.startTweening(),0==(this.flags&ge.DecoherentFlag)&&this.requireRecohere()):this.recohere(performance.now())},recohere(t){this.setCoherentTime(t);const e=this.inlet;if(e instanceof be)this.setDerived((this.flags&pe.Mask)<=Math.min(e.flags&pe.Mask,pe.Intrinsic)),0!=(this.flags&ge.DerivedFlag)?this.tweenInherited(t):0!=(this.flags&be.TweeningFlag)?this.tween(t):this.setCoherent(!0);else if(e instanceof we)if(this.setDerived((this.flags&pe.Mask)<=Math.min(e.flags&pe.Mask,pe.Intrinsic)),0!=(this.flags&ge.DerivedFlag)&&this.inletVersion!==e.version){this.inletVersion=e.version;const r=this.deriveValue(e.getOutletValue(this));this.setState(r,pe.Reflexive),0!=(this.flags&be.TweeningFlag)?this.tween(t):this.setCoherent(!0)}else 0!=(this.flags&be.TweeningFlag)?this.tween(t):this.setCoherent(!0);else if(Array.isArray(e)){this.setDerived(!0);const r=this.inletVersion,i=new Array(e.length);for(let t=0;t<e.length;t+=1){if(!(e[t]instanceof we))return this.setDerived(!1),void this.setCoherent(!0);r[t]=e[t].version,i[t]=e[t].getOutletValue(this)}const n=this.deriveValue(...i);this.setState(n,pe.Reflexive),0!=(this.flags&be.TweeningFlag)?this.tween(t):this.setCoherent(!0)}else this.setDerived(!1),0!=(this.flags&be.TweeningFlag)?this.tween(t):this.setCoherent(!0)},tween(t){const e=this.value;let r=this.timing;null===r&&(r=X.linear.withDomain(t,t),this.timing=r);let i=this.interpolator;null===i&&(i=j(e,this.state),this.interpolator=i),0!=(this.flags&be.InterruptFlag)&&(this.setFlags(this.flags&~be.InterruptFlag),this.didInterrupt(e)),0!=(this.flags&be.DivergedFlag)&&(this.setFlags(this.flags&~be.DivergedFlag),r=this.equalValues(this.state,e)?r.withDomain(t-r.duration,t):r.withDomain(t,t+r.duration),this.timing=r,this.willTransition(e));const n=r(t),s=i(n);this.setValue(s,pe.Reflexive),n<1?this.requireRecohere():0!=(this.flags&be.TweeningFlag)?(this.stopTweening(),this.interpolator=null,this.didTransition(this.value)):this.setCoherent(!0)},tweenInherited(t){const e=this.inlet;if(!(e instanceof be))return void this.stopTweening();this.inletVersion=e.version;const r=this.deriveValue(e.getOutletValue(this)),i=this.deriveValue(e.getOutletState(this)),n=this.state,s=!this.equalValues(i,n);s&&(this.willSetState(i,n),this.state=i,this.timing=null,this.interpolator=null,this.onSetState(i,n)),this.setValue(r,pe.Reflexive),s&&(this.didSetState(i,n),0!=(this.flags&be.TweeningFlag)&&this.didInterrupt(this.value),this.willTransition(this.value)),0!=(e.flags&be.TweeningFlag)?this.requireRecohere():0!=(this.flags&be.TweeningFlag)?(this.stopTweening(),this.didTransition(this.value)):this.setCoherent(!0)},get tweening(){return 0!=(this.flags&be.TweeningFlag)},startTweening(){0==(this.flags&be.TweeningFlag)&&(this.willStartTweening(),this.setFlags(this.flags|be.TweeningFlag),this.onStartTweening(),this.didStartTweening())},willStartTweening(){},onStartTweening(){this.decohere(),this.decohereOutlets()},didStartTweening(){},stopTweening(){0!=(this.flags&be.TweeningFlag)&&(this.willStopTweening(),this.setFlags(this.flags&~be.TweeningFlag),this.onStopTweening(),this.didStopTweening())},willStopTweening(){},onStopTweening(){this.setCoherent(!0)},didStopTweening(){},willTransition(t){},didTransition(t){},didInterrupt(t){}},{construct(t,e){return(t=super.construct(t,e)).state=t.value,t.timing=null,t.interpolator=null,t},refine(t){super.refine(t);const e=t.prototype,r=Object.getOwnPropertyDescriptor(e,"transition");void 0!==r&&"value"in r&&(r.value=W.fromLike(r.value),Object.defineProperty(e,"transition",r))},TweeningFlag:1<<we.FlagShift+0,DivergedFlag:1<<we.FlagShift+1,InterruptFlag:1<<we.FlagShift+2,FlagShift:we.FlagShift+3,FlagMask:(1<<we.FlagShift+3)-1}),ve=ge.extend("Timer",{get fastenerType(){return ve},fire(){},delay:0,initDelay(){const t=Object.getPrototypeOf(this).delay;return Math.max(0,t)},setDelay(t){this.delay=Math.max(0,t)},get elapsed(){const t=this.deadline;if(void 0!==t)return Math.max(0,performance.now()-(t-this.delay))},get remaining(){const t=this.deadline;if(void 0!==t)return Math.max(0,t-performance.now())},get scheduled(){return void 0!==this.timeout},schedule(t){if(void 0!==this.timeout)throw new Error("timer already scheduled; call throttle or debounce to reschedule");void 0===t?t=this.delay:this.setDelay(t),this.willSchedule(t),this.deadline=performance.now()+t,this.timeout=this.setTimeout(this,t),this.onSchedule(t),this.didSchedule(t)},throttle(t){void 0===this.timeout&&(void 0===t?t=this.delay:this.setDelay(t),this.willSchedule(t),this.deadline=performance.now()+t,this.timeout=this.setTimeout(this,t),this.onSchedule(t),this.didSchedule(t))},debounce(t){const e=this.timeout;void 0!==e&&(this.willCancel(),this.timeout=void 0,this.deadline=void 0,this.clearTimeout(e),this.onCancel(),this.didCancel()),void 0===t?t=this.delay:this.setDelay(t),this.willSchedule(t),this.deadline=performance.now()+t,this.timeout=this.setTimeout(this,t),this.onSchedule(t),this.didSchedule(t)},willSchedule(t){},onSchedule(t){},didSchedule(t){},cancel(){const t=this.timeout;void 0!==t&&(this.willCancel(),this.timeout=void 0,this.deadline=void 0,this.clearTimeout(t),this.onCancel(),this.didCancel())},willCancel(){},onCancel(){},didCancel(){},expire(){this.timeout=void 0,this.deadline=void 0,this.willExpire(),this.fire(),this.onExpire(),this.didExpire()},willExpire(){},onExpire(){},didExpire(){},setTimeout:(t,e)=>setTimeout(t,e),clearTimeout(t){clearTimeout(t)},onUnmount(){super.onUnmount(),this.cancel()}},{construct(t,e){return null===t&&(t=function(){t.expire()},Object.defineProperty(t,"name",{value:this.prototype.name,enumerable:!0,configurable:!0}),Object.setPrototypeOf(t,this.prototype)),(t=super.construct(t,e)).delay=t.initDelay(),t.deadline=0,t.timeout=void 0,t}}),xe=ge.extend("EventHandler",{get fastenerType(){return xe},bindsOwner:!1,eventType:void 0,initEventType(){return Object.getPrototypeOf(this).eventType},target:null,initTarget(){let t=Object.getPrototypeOf(this).target;return null===t&&!0===this.bindsOwner&&(t=this.owner),t},getTarget(){const t=this.target;if(null===t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="event target",new TypeError(e)}return t},setTarget(t){const e=this.target;return e===t||(null!==e&&(this.target=null,this.willDetachTarget(e),this.onDetachTarget(e),this.didDetachTarget(e)),null!==t&&(this.target=t,this.willAttachTarget(t),this.onAttachTarget(t),this.didAttachTarget(t))),e},willAttachTarget(t){},onAttachTarget(t){(this.flags&(ge.MountedFlag|xe.EnabledFlag))==(ge.MountedFlag|xe.EnabledFlag)&&this.attachEvents(t)},didAttachTarget(t){},willDetachTarget(t){},onDetachTarget(t){(this.flags&(ge.MountedFlag|xe.EnabledFlag))==(ge.MountedFlag|xe.EnabledFlag)&&this.detachEvents(t)},didDetachTarget(t){},options:void 0,attachEvents(t){const e=this.eventType;if("string"==typeof e)this.attachEvent(t,e);else if(void 0!==e)for(let r=0;r<e.length;r+=1)this.attachEvent(t,e[r])},attachEvent(t,e){b.hasAllKeys(t,"addEventListener","removeEventListener")&&t.addEventListener(e,this,this.options)},detachEvents(t){const e=this.eventType;if("string"==typeof e)this.detachEvent(t,e);else if(void 0!==e)for(let r=0;r<e.length;r+=1)this.detachEvent(t,e[r])},detachEvent(t,e){b.hasAllKeys(t,"addEventListener","removeEventListener")&&t.removeEventListener(e,this,this.options)},handle(t){},flagsInit:1<<ge.FlagShift+0,get enabled(){return 0!=(this.flags&xe.EnabledFlag)},set enabled(t){t&&0==(this.flags&xe.EnabledFlag)?(this.willEnable(),this.setFlags(this.flags|xe.EnabledFlag),this.onEnable(),this.didEnable()):t||0==(this.flags&xe.EnabledFlag)||(this.willDisable(),this.setFlags(this.flags&~xe.EnabledFlag),this.onDisable(),this.didDisable())},willEnable(){},onEnable(){const t=this.target;null!==t&&0!=(this.flags&ge.MountedFlag)&&this.attachEvents(t)},didEnable(){},willDisable(){},onDisable(){const t=this.target;null!==t&&0!=(this.flags&ge.MountedFlag)&&this.detachEvents(t)},didDisable(){},bindComponent(t){if(!this.binds||null!==this.target)return;const e=this.detectComponent(t);null!==e&&this.setTarget(e)},unbindComponent(t){if(!this.binds)return;const e=this.detectComponent(t);null!==e&&e===this.target&&this.setTarget(null)},detectComponent:t=>null,onMount(){super.onMount();const t=this.target;null!==t&&0!=(this.flags&xe.EnabledFlag)&&this.attachEvents(t)},onUnmount(){super.onUnmount();const t=this.target;null!==t&&0!=(this.flags&xe.EnabledFlag)&&this.detachEvents(t)}},{construct(t,e){return null===t&&(t=function(e){t.handle(e)},Object.defineProperty(t,"name",{value:this.prototype.name,enumerable:!0,configurable:!0}),Object.setPrototypeOf(t,this.prototype)),(t=super.construct(t,e)).eventType=t.initEventType(),t.target=t.initTarget(),t},refine(t){super.refine(t);const e=t.prototype;let r=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"enabled")&&(e.enabled?r|=xe.EnabledFlag:r&=~xe.EnabledFlag,delete e.enabled),Object.defineProperty(e,"flagsInit",{value:r,enumerable:!0,configurable:!0});const i=Object.getOwnPropertyDescriptor(e,"target");void 0!==i&&"value"in i&&(void 0===i.value&&(i.value=null),Object.defineProperty(e,"target",i))},EnabledFlag:1<<ge.FlagShift+0,FlagShift:ge.FlagShift+1,FlagMask:(1<<ge.FlagShift+1)-1}),Se=xe.extend("EventTimer",{defer(t){this.throttle(t)},delay:0,initDelay(){const t=Object.getPrototypeOf(this).delay;return Math.max(0,t)},setDelay(t){this.delay=Math.max(0,t)},get elapsed(){const t=this.deadline;if(void 0!==t)return Math.max(0,performance.now()-(t-this.delay))},get remaining(){const t=this.deadline;if(void 0!==t)return Math.max(0,t-performance.now())},get scheduled(){return void 0!==this.timeout},schedule(t,e){if(void 0!==this.timeout)throw new Error("timer already scheduled; call throttle or debounce to reschedule");void 0===e?e=this.delay:this.setDelay(e),this.willSchedule(t,e),this.event=t,this.deadline=performance.now()+e,this.timeout=this.setTimeout(this,e),this.onSchedule(t,e),this.didSchedule(t,e)},throttle(t,e){void 0===this.timeout&&(void 0===e?e=this.delay:this.setDelay(e),this.willSchedule(t,e),this.event=t,this.deadline=performance.now()+e,this.timeout=this.setTimeout(this,e),this.onSchedule(t,e),this.didSchedule(t,e))},debounce(t,e){const r=this.timeout;if(void 0!==r){const t=this.event;this.willCancel(t),this.event=null,this.timeout=void 0,this.deadline=void 0,this.clearTimeout(r),this.onCancel(t),this.didCancel(t)}void 0===e?e=this.delay:this.setDelay(e),this.willSchedule(t,e),this.event=t,this.deadline=performance.now()+e,this.timeout=this.setTimeout(this,e),this.onSchedule(t,e),this.didSchedule(t,e)},willSchedule(t,e){},onSchedule(t,e){},didSchedule(t,e){},cancel(){const t=this.timeout;if(void 0===t)return;const e=this.event;this.willCancel(e),this.event=null,this.timeout=void 0,this.deadline=void 0,this.clearTimeout(t),this.onCancel(e),this.didCancel(e)},willCancel(t){},onCancel(t){},didCancel(t){},expire(){const t=this.event;this.event=null,this.timeout=void 0,this.deadline=void 0,this.willExpire(t),null!==t&&this.handle(t),this.onExpire(t),this.didExpire(t)},willExpire(t){},onExpire(t){},didExpire(t){},setTimeout:(t,e)=>setTimeout(t,e),clearTimeout(t){clearTimeout(t)},onUnmount(){super.onUnmount(),this.cancel()}},{construct(t,e){return null===t&&(t=function(e){void 0!==e?t.defer(e):t.expire()},Object.defineProperty(t,"name",{value:this.prototype.name,enumerable:!0,configurable:!0}),Object.setPrototypeOf(t,this.prototype)),(t=super.construct(t,e)).event=null,t.delay=t.initDelay(),t.deadline=0,t.timeout=void 0,t}}),Ce=ge.extend("Provider",{get fastenerType(){return Ce},serviceType:null,observes:!1,creates:!0,inherits:!0,affinity:pe.Inherited,onBindInlet(t){0!=(this.flags&ge.InheritsFlag)&&(this.flags&pe.Mask)===pe.Inherited&&this.initAffinity(pe.Transient),t instanceof Ce&&(this.setDerived(!0),this.setService(t.service))},onUnbindInlet(t){super.onUnbindInlet(t),0!=(this.flags&ge.InheritsFlag)&&(this.flags&pe.Mask)===pe.Transient&&this.initAffinity(pe.Inherited)},get inletService(){const t=this.inlet;return t instanceof Ce?t.service:null},getInletService(){const t=this.inletService;if(null==t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="inlet service",new TypeError(e)}return t},serviceKey:void 0,getService(){const t=this.service;if(null==t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="service",new TypeError(e)}return t},setService(t,e,r){const i=this.service;return i===t?(this.setCoherent(!0),i):(void 0===e&&(e=null),null!==i&&(this.service=null,this.willDetachService(i),0!=(this.flags&ge.MountedFlag)&&this.unmountService(i),this.onDetachService(i),this.deinitService(i),this.didDetachService(i)),null!==t&&(this.service=t,this.willAttachService(t,e),0!=(this.flags&ge.MountedFlag)&&this.mountService(t,e,r),this.onAttachService(t,e),this.initService(t),this.didAttachService(t,e)),this.setCoherent(!0),i)},initService(t){},willAttachService(t,e){},onAttachService(t,e){this.observes&&0!=(this.flags&ge.MountedFlag)&&t.observe(this)},didAttachService(t,e){},deinitService(t){},willDetachService(t){},onDetachService(t){this.observes&&0!=(this.flags&ge.MountedFlag)&&t.unobserve(this)},didDetachService(t){},get parentService(){const t=this.parent;return null!==t?t.service:null},insertChild(t,e,r,i){t.insertChild(e,r,i)},createService(){let t;const e=this.serviceType;if(null!==e&&(t=e.global()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="service",new Error(t)}return t},mountService(t,e,r){if(null===t.parent&&!t.mounted){let i=this.parentService;null===i?(i=Pe.global(),e=null,r=void 0):void 0===r&&(r=this.serviceKey),this.insertChild(i,t,e,r),this.setFlags(this.flags|Ce.ManagedFlag)}this.derived||this.mountRootService(t)},unmountService(t){this.derived||this.unmountRootService(t),0!=(this.flags&Ce.ManagedFlag)&&(this.setFlags(this.flags&~Ce.ManagedFlag),t.remove())},mountRootService(t){},unmountRootService(t){},onMount(){super.onMount();let t=this.service;null!==t?(this.mountService(t,null,void 0),this.observes&&t.observe(this)):this.creates&&(t=this.createService(),this.setService(t))},onUnmount(){const t=this.service;null!==t&&(this.observes&&t.unobserve(this),this.unmountService(t)),super.onUnmount()}},{tryService(t,e){const r=me.getMetaclass(t),i=null!==r?r.tryFastener(t,e):null;return i instanceof Ce?i.service:null},create(t){const e=super.create(t);if(null===e.service&&e.creates){const t=e.createService();e.setService(t)}return e},construct(t,e){return(t=super.construct(t,e)).service=null,t},refine(t){super.refine(t);const e=t.prototype,r=Object.getOwnPropertyDescriptor(e,"serviceKey");void 0!==r&&"value"in r&&(!0===r.value?(r.value=t.name,Object.defineProperty(e,"serviceKey",r)):!1===r.value&&(r.value=void 0,Object.defineProperty(e,"serviceKey",r)))},ManagedFlag:1<<ge.FlagShift+0,FlagShift:ge.FlagShift+1,FlagMask:(1<<ge.FlagShift+1)-1});var ke;class Me{constructor(){this.uid=this.constructor.uid(),this.key=void 0,this.flags=0,this.parent=null,this.nextSibling=null,this.previousSibling=null,this.firstChild=null,this.lastChild=null,this.childMap=null,this.coherentTime=0,this.decoherent=null,this.recohering=null,this.observers=null}get componentType(){return ke}setKey(t){this.key=t}setFlags(t){this.flags=t}attachParent(t,e){let r;this.willAttachParent(t),this.parent=t,null!==e?(r=e.previousSibling,this.setNextSibling(e),e.setPreviousSibling(this)):(r=t.lastChild,t.setLastChild(this)),null!==r?(r.setNextSibling(this),this.setPreviousSibling(r)):t.setFirstChild(this),t.mounted&&this.cascadeMount(),this.onAttachParent(t),this.didAttachParent(t)}willAttachParent(t){}onAttachParent(t){}didAttachParent(t){}detachParent(t){this.willDetachParent(t),this.mounted&&this.cascadeUnmount(),this.onDetachParent(t);const e=this.nextSibling,r=this.previousSibling;null!==e?(this.setNextSibling(null),e.setPreviousSibling(r)):t.setLastChild(r),null!==r?(r.setNextSibling(e),this.setPreviousSibling(null)):t.setFirstChild(e),this.parent=null,this.didDetachParent(t)}willDetachParent(t){}onDetachParent(t){}didDetachParent(t){}reattachParent(t){const e=this.parent;this.willDetachParent(e),this.onDetachParent(e);const r=this.nextSibling,i=this.previousSibling;let n;null!==r?(this.setNextSibling(null),r.setPreviousSibling(i)):e.setLastChild(i),null!==i?(i.setNextSibling(r),this.setPreviousSibling(null)):e.setFirstChild(r),this.didDetachParent(e),this.willAttachParent(e),null!==t?(n=t.previousSibling,this.setNextSibling(t),t.setPreviousSibling(this)):(n=e.lastChild,e.setLastChild(this)),null!==n?(n.setNextSibling(this),this.setPreviousSibling(n)):e.setFirstChild(this),this.onAttachParent(e),this.didAttachParent(e)}getNextSibling(t){let e=this.nextSibling;for(;;){if(null===e)return null;if(e instanceof t)return e;e=e.nextSibling}}setNextSibling(t){this.nextSibling=t}getPreviousSibling(t){let e=this.previousSibling;for(;;){if(null===e)return null;if(e instanceof t)return e;e=e.previousSibling}}setPreviousSibling(t){this.previousSibling=t}getFirstChild(t){let e=this.firstChild;for(;;){if(null===e)return null;if(e instanceof t)return e;e=e.nextSibling}}setFirstChild(t){this.firstChild=t}getLastChild(t){let e=this.lastChild;for(;;){if(null===e)return null;if(e instanceof t)return e;e=e.previousSibling}}setLastChild(t){this.lastChild=t}forEachChild(t,e){let r=this.firstChild;for(;null!==r;){const i=r.nextSibling;if(void 0!==t.call(e,r))break;r=null!==i&&i.parent===this?i:null}}insertChildMap(t){const e=t.key;if(void 0===e)return;let r=this.childMap;null===r&&(r={},this.childMap=r),r[e]=t}removeChildMap(t){const e=t.key;if(void 0===e)return;const r=this.childMap;null!==r&&delete r[e]}getChild(t,e){const r=this.childMap;if(null===r)return null;const i=r[t];return void 0!==i&&(void 0===e||i instanceof e)?i:null}setChild(t,e){null!==e&&(e=this.componentType.fromLike(e));const r=this.getChild(t);let i;return null!==r&&null!==e&&r!==e?(e.remove(),i=r.nextSibling,0==(r.flags&ke.RemovingFlag)&&(r.setFlags(r.flags|ke.RemovingFlag),this.willRemoveChild(r),r.detachParent(this),this.removeChildMap(r),this.onRemoveChild(r),this.didRemoveChild(r),r.setKey(void 0),r.setFlags(r.flags&~ke.RemovingFlag)),e.setFlags(e.flags|ke.InsertingFlag),e.setKey(r.key),this.willInsertChild(e,i),this.insertChildMap(e),e.attachParent(this,i),this.onInsertChild(e,i),this.didInsertChild(e,i),e.cascadeInsert(),e.setFlags(e.flags&~ke.InsertingFlag)):(e!==r||null!==e&&e.key!==t)&&(null!==r?(i=r.nextSibling,0==(r.flags&ke.RemovingFlag)&&(r.setFlags(r.flags|ke.RemovingFlag),this.willRemoveChild(r),r.detachParent(this),this.removeChildMap(r),this.onRemoveChild(r),this.didRemoveChild(r),r.setKey(void 0),r.setFlags(r.flags&~ke.RemovingFlag))):i=null,null!==e&&(e.remove(),e.setFlags(e.flags|ke.InsertingFlag),e.setKey(t),this.willInsertChild(e,i),this.insertChildMap(e),e.attachParent(this,i),this.onInsertChild(e,i),this.didInsertChild(e,i),e.cascadeInsert(),e.setFlags(e.flags&~ke.InsertingFlag))),r}appendChild(t,e){return(t=this.componentType.fromLike(t)).remove(),void 0!==e&&this.removeChild(e),t.setFlags(t.flags|ke.InsertingFlag),t.setKey(e),this.willInsertChild(t,null),this.insertChildMap(t),t.attachParent(this,null),this.onInsertChild(t,null),this.didInsertChild(t,null),t.cascadeInsert(),t.setFlags(t.flags&~ke.InsertingFlag),t}prependChild(t,e){(t=this.componentType.fromLike(t)).remove(),void 0!==e&&this.removeChild(e);const r=this.firstChild;return t.setFlags(t.flags|ke.InsertingFlag),t.setKey(e),this.willInsertChild(t,r),this.insertChildMap(t),t.attachParent(this,r),this.onInsertChild(t,r),this.didInsertChild(t,r),t.cascadeInsert(),t.setFlags(t.flags&~ke.InsertingFlag),t}insertChild(t,e,r){return t=this.componentType.fromLike(t),null!==e&&e.parent!==this&&(e=null),t.remove(),void 0!==r&&this.removeChild(r),t.setFlags(t.flags|ke.InsertingFlag),t.setKey(r),this.willInsertChild(t,e),this.insertChildMap(t),t.attachParent(this,e),this.onInsertChild(t,e),this.didInsertChild(t,e),t.cascadeInsert(),t.setFlags(t.flags&~ke.InsertingFlag),t}replaceChild(t,e){if(e.parent!==this)throw new Error("replacement target is not a child");if((t=this.componentType.fromLike(t))===e)return e;t.remove();const r=e.nextSibling;return 0==(e.flags&ke.RemovingFlag)&&(e.setFlags(e.flags|ke.RemovingFlag),this.willRemoveChild(e),e.detachParent(this),this.removeChildMap(e),this.onRemoveChild(e),this.didRemoveChild(e),e.setKey(void 0),e.setFlags(e.flags&~ke.RemovingFlag)),t.setFlags(t.flags|ke.InsertingFlag),t.setKey(e.key),this.willInsertChild(t,r),this.insertChildMap(t),t.attachParent(this,r),this.onInsertChild(t,r),this.didInsertChild(t,r),t.cascadeInsert(),t.setFlags(t.flags&~ke.InsertingFlag),e}get insertChildFlags(){return this.constructor.InsertChildFlags}get inserting(){return 0!=(this.flags&ke.InsertingFlag)}willInsertChild(t,e){}onInsertChild(t,e){this.requireUpdate(this.insertChildFlags),this.bindChildFasteners(t,e)}didInsertChild(t,e){}cascadeInsert(){}removeChild(t){let e;if("string"==typeof t){if(e=this.getChild(t),null===e)return null}else if(e=t,e.parent!==this)throw new Error("not a child");return 0==(e.flags&ke.RemovingFlag)&&(e.setFlags(e.flags|ke.RemovingFlag),this.willRemoveChild(e),e.detachParent(this),this.removeChildMap(e),this.onRemoveChild(e),this.didRemoveChild(e),e.setKey(void 0),e.setFlags(e.flags&~ke.RemovingFlag)),e}get removeChildFlags(){return this.constructor.RemoveChildFlags}get removing(){return 0!=(this.flags&ke.RemovingFlag)}willRemoveChild(t){}onRemoveChild(t){this.requireUpdate(this.removeChildFlags),this.unbindChildFasteners(t)}didRemoveChild(t){}removeChildren(){let t;for(;t=this.lastChild,null!==t;){if(0!=(t.flags&ke.RemovingFlag))throw new Error("inconsistent removeChildren");this.willRemoveChild(t),t.detachParent(this),this.removeChildMap(t),this.onRemoveChild(t),this.didRemoveChild(t),t.setKey(void 0),t.setFlags(t.flags&~ke.RemovingFlag)}}remove(){const t=this.parent;null!==t?t.removeChild(this):this.mounted&&this.unmount()}get reinsertChildFlags(){return this.constructor.ReinsertChildFlags}reinsertChild(t,e){if(t.parent!==this)throw new Error("not a child");if(null!==e&&e.parent!==this)throw new Error("reinsert target is not a child");t.nextSibling!==e&&(this.willReinsertChild(t,e),t.reattachParent(e),this.onReinsertChild(t,e),this.didReinsertChild(t,e))}willReinsertChild(t,e){}onReinsertChild(t,e){this.requireUpdate(this.reinsertChildFlags)}didReinsertChild(t,e){}sortChildren(t){let e=this.firstChild;if(null===e)return;const r=[];do{r.push(e),e=e.nextSibling}while(null!==e);r.sort(t),e=r[0],this.setFirstChild(e),e.setPreviousSibling(null);for(let t=1;t<r.length;t+=1){const i=r[t];e.setNextSibling(i),i.setPreviousSibling(e),e=i}e.setNextSibling(null),this.setLastChild(e)}getTargetChild(t,e){let r=this.lastChild;for(;null!==r;){if(r!==t&&e(t,r)>=0)return r=r.nextSibling,r===t&&(r=r.nextSibling),r;r=r.previousSibling}return r=this.firstChild,r===t&&(r=r.nextSibling),r}getAncestor(t){let e=this.parent;for(;null!==e;){if(e instanceof t)return e;e=e.parent}return null}getRoot(t){let e=null,r=this.parent;for(;null!==r;)r instanceof t&&(e=r),r=r.parent;return e}isAncestorOf(t){for(;null!==t;){if(t===this)return!0;t=t.parent}return!1}commonAncestor(t){for(;null!==t;){if(t.isAncestorOf(this))return t;t=t.parent}return null}get mounted(){return 0!=(this.flags&ke.MountedFlag)}get mountFlags(){return this.constructor.MountFlags}mount(){this.mounted||null!==this.parent||(this.setFlags(this.flags|ke.InsertingFlag),this.cascadeMount(),this.cascadeInsert(),this.setFlags(this.flags&~ke.InsertingFlag))}cascadeMount(){if(0!=(this.flags&ke.MountedFlag))throw new Error("already mounted");this.willMount(),this.setFlags(this.flags|ke.MountedFlag),this.onMount(),this.mountChildren(),this.didMount()}willMount(){}onMount(){}didMount(){this.requireUpdate(this.mountFlags),this.mountFasteners()}mountChildren(){let t=this.firstChild;for(;null!==t;){const e=t.nextSibling;if(t.cascadeMount(),null!==e&&e.parent!==this)throw new Error("inconsistent mount");t=e}}unmount(){this.mounted&&null===this.parent&&this.cascadeUnmount()}cascadeUnmount(){if(0==(this.flags&ke.MountedFlag))throw new Error("already unmounted");this.willUnmount(),this.setFlags(this.flags&~ke.MountedFlag),this.unmountChildren(),this.onUnmount(),this.didUnmount()}willUnmount(){this.unmountFasteners()}onUnmount(){}didUnmount(){}unmountChildren(){let t=this.lastChild;for(;null!==t;){const e=t.previousSibling;if(t.cascadeUnmount(),null!==e&&e.parent!==this)throw new Error("inconsistent unmount");t=e}}requireUpdate(t,e){}tryFastener(t){const e=me.getMetaclass(this);return null!==e?e.tryFastener(this,t):null}getFastener(t,e,r){if(null!=r&&!(this instanceof r))return null;const i=this[t];return void 0!==i&&(null==e||i instanceof e)?i:null}getParentFastener(t,e,r){let i=this.parent;for(;null!==i;){const n=i.getFastener(t,e,r);if(null!==n)return n;i=i.parent}return null}attachFastener(t){this.mounted&&t.mount(),this.bindFastener(t)}mountFasteners(){const t=me.getMetaclass(this);if(null===t)return;const e=t.slots;for(let t=0;t<e.length;t+=1){const r=this[e[t]];r instanceof ge&&r.mount()}}unmountFasteners(){const t=me.getMetaclass(this);if(null===t)return;const e=t.slots;for(let t=0;t<e.length;t+=1){const r=this[e[t]];r instanceof ge&&r.unmount()}}bindFastener(t){if(!t.binds)return;let e=this.firstChild;for(;null!==e;){const r=e.nextSibling;this.bindChildFastener(t,e,r),e=null!==r&&r.parent===this?r:null}}bindChildFasteners(t,e){const r=me.getMetaclass(this);if(null===r)return;const i=r.slots;for(let r=0;r<i.length;r+=1){const n=this[i[r]];n instanceof ge&&this.bindChildFastener(n,t,e)}}bindChildFastener(t,e,r){(t instanceof Oe||t instanceof xe)&&t.bindComponent(e,r)}unbindChildFasteners(t){const e=me.getMetaclass(this);if(null===e)return;const r=e.slots;for(let e=0;e<r.length;e+=1){const i=this[r[e]];i instanceof ge&&this.unbindChildFastener(i,t)}}unbindChildFastener(t,e){(t instanceof Oe||t instanceof xe)&&t.unbindComponent(e)}set(t,e){for(const r in t){const i=t[r],n=this[r];if(null==n)throw new Error("unknown property "+r);if(void 0===n.set)throw new Error("unsettable property "+r);n instanceof be?n.set(i,e):n.set(i)}return this}setIntrinsic(t,e){for(const r in t){const i=t[r],n=this[r];if(null==n)throw new Error("unknown property "+r);if(void 0===n.setIntrinsic)throw new Error("unsettable property "+r);n instanceof be?n.setIntrinsic(i,e):n.setIntrinsic(i)}return this}decohereFastener(t){const e=this.recohering;null===e||t.coherentTime===this.coherentTime?this.enqueueFastener(t):e.push(t)}enqueueFastener(t){let e=this.decoherent;null===e&&(e=[],this.decoherent=e),e.push(t)}recohereFasteners(t){const e=this.decoherent;if(null!==e&&0!==e.length){void 0===t&&(t=performance.now()),this.coherentTime=t,this.decoherent=null,this.recohering=e;try{for(let r=0;r<e.length;r+=1){e[r].recohere(t)}}finally{this.recohering=null}}}observe(t){let e=this.observers;if(null===e)e=new Set,this.observers=e;else if(e.has(t))return;this.willObserve(t),e.add(t),this.onObserve(t),this.didObserve(t)}willObserve(t){}onObserve(t){}didObserve(t){}unobserve(t){const e=this.observers;null!==e&&e.has(t)&&(this.willUnobserve(t),e.delete(t),this.onUnobserve(t),this.didUnobserve(t))}willUnobserve(t){}onUnobserve(t){}didUnobserve(t){}callObservers(t,...e){const r=this.observers;if(null!==r)for(const i of r){const r=i[t];"function"==typeof r&&r.call(i,...e)}}equals(t){return this===t}hashCode(){return s.mash(s.mixString(0,this.uid))}static create(){return new this}static fromLike(t){if(null==t)return t;if(t instanceof ke){if(!(t instanceof this))throw new TypeError(t+" not an instance of "+this);return t}if(C[Symbol.hasInstance](t))return t.create();throw new TypeError(""+t)}static initDecorators(){if(!Object.hasOwnProperty.call(this,Symbol.metadata)){const t=Object.getPrototypeOf(this)[Symbol.metadata];Object.defineProperty(this,Symbol.metadata,{value:Object.create(void 0!==t?t:null),writable:!0,enumerable:!0,configurable:!0})}Object.hasOwnProperty.call(this,"fieldInitializers")||Object.defineProperty(this,"fieldInitializers",{value:{},enumerable:!0,configurable:!0}),Object.hasOwnProperty.call(this,"instanceInitializers")||Object.defineProperty(this,"instanceInitializers",{value:[],enumerable:!0,configurable:!0})}static defineField(t,r){const i=this;i.initDecorators(),e(null,null,r,{kind:"field",name:t,static:!1,private:!1,access:{has:e=>t in e,get:e=>e[t],set(e,r){e[t]=r}},metadata:i[Symbol.metadata]},i.fieldInitializers[t]=[],i.instanceInitializers)}static defineGetter(t,r){const i=this;i.initDecorators(),Object.defineProperty(i.prototype,t,{get:ge.getter,enumerable:!0,configurable:!0}),e(i,null,r,{kind:"getter",name:t,static:!1,private:!1,access:{has:e=>t in e,get:e=>e[t],set(e,r){e[t]=r}},metadata:i[Symbol.metadata]},null,i.instanceInitializers)}static initFasteners(t){const e=this;if(Object.hasOwnProperty.call(e,"fieldInitializers")&&Object.hasOwnProperty.call(e,"instanceInitializers")){r(t,e.instanceInitializers);for(const i in e.fieldInitializers)t[i]=r(t,e.fieldInitializers[i],void 0)}}}ke=Me,Me.uid=function(){let t=1;return function(){const e=~~t;return t+=1,"component"+e}}(),Me.MountedFlag=1,Me.InsertingFlag=2,Me.RemovingFlag=4,Me.FlagShift=3,Me.FlagMask=(1<<ke.FlagShift)-1,Me.MountFlags=0,Me.InsertChildFlags=0,Me.RemoveChildFlags=0,Me.ReinsertChildFlags=0;const Oe=ge.extend("ComponentRelation",{get fastenerType(){return Oe},componentType:null,observes:!1,attachOutlet(t){let e=this.outlets;null===e&&(e=new Set,this.outlets=e),e.add(t)},detachOutlet(t){const e=this.outlets;null!==e&&e.delete(t)},decohereOutlets(){const t=this.outlets;if(null!==t)for(const e of t)e.decohere(this)},initComponent(t){},willAttachComponent(t,e){},onAttachComponent(t,e){this.observes&&t.observe(this)},didAttachComponent(t,e){},deinitComponent(t){},willDetachComponent(t){},onDetachComponent(t){this.observes&&t.unobserve(this)},didDetachComponent(t){},get parentComponent(){const t=this.owner;return t instanceof Me?t:null},insertChild(t,e,r,i){t.insertChild(e,r,i)},bindComponent(t,e){},unbindComponent(t){},detectComponent:t=>null,createComponent(){let t;const e=this.componentType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="component",new Error(t)}return t},fromLike(t){const e=this.componentType;return null!==e?e.fromLike(t):Me.fromLike(t)}},{construct(t,e){return(t=super.construct(t,e)).outlets=null,t}}),Ee=Oe.extend("ComponentRef",{get fastenerType(){return Ee},get inletComponent(){const t=this.inlet;return t instanceof Ee?t.component:null},getInletComponent(){const t=this.inletComponent;if(null==t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="inlet component",new TypeError(e)}return t},get(){return this.component},set(t){return t instanceof ge?this.bindInlet(t):this.setComponent(t),this.owner},setIntrinsic(t){return t instanceof ge?this.bindInlet(t):this.setComponent(t),this.owner},componentKey:void 0,getComponent(){const t=this.component;if(null===t){let e=t+" ";const r=this.name.toString();throw 0!==r.length&&(e+=r+" "),e+="component",new TypeError(e)}return t},setComponent(t,e,r){null!==t&&(t=this.fromLike(t));let i,n=this.component;return n===t?(this.setCoherent(!0),n):(void 0===e&&(e=null),this.binds&&(i=this.parentComponent,null!==i)&&(null!==n&&n.parent===i&&(null===e&&(e=n.nextSibling),n.remove()),null!==t&&(void 0===r&&(r=this.componentKey),this.insertChild(i,t,e,r)),n=this.component,n===t)||(null!==n&&(this.component=null,this.willDetachComponent(n),this.onDetachComponent(n),this.deinitComponent(n),this.didDetachComponent(n)),null!==t&&(this.component=t,this.willAttachComponent(t,e),this.onAttachComponent(t,e),this.initComponent(t),this.didAttachComponent(t,e)),this.setCoherent(!0),this.decohereOutlets()),n)},attachComponent(t,e){const r=this.component;return void 0===e&&(e=null),r===(t=null!=t?this.fromLike(t):null===r?this.createComponent():r)||(null!==r&&(this.component=null,this.willDetachComponent(r),this.onDetachComponent(r),this.deinitComponent(r),this.didDetachComponent(r)),this.component=t,this.willAttachComponent(t,e),this.onAttachComponent(t,e),this.initComponent(t),this.didAttachComponent(t,e),this.setCoherent(!0),this.decohereOutlets()),t},detachComponent(){const t=this.component;return null===t?null:(this.component=null,this.willDetachComponent(t),this.onDetachComponent(t),this.deinitComponent(t),this.didDetachComponent(t),this.setCoherent(!0),this.decohereOutlets(),t)},insertComponent(t,e,r,i){let n=this.component;return e=null!=e?this.fromLike(e):null===n?this.createComponent():n,void 0===t&&(t=null),this.binds||n!==e||null===e.parent||null!==t||void 0!==i?(null===t&&(t=this.parentComponent),void 0===r&&(r=null),void 0===i&&(i=this.componentKey),null===t||e.parent===t&&e.key===i||this.insertChild(t,e,r,i),n=this.component,n===e||(null!==n&&(this.component=null,this.willDetachComponent(n),this.onDetachComponent(n),this.deinitComponent(n),this.didDetachComponent(n),this.binds&&null!==t&&n.parent===t&&n.remove()),this.component=e,this.willAttachComponent(e,r),this.onAttachComponent(e,r),this.initComponent(e),this.didAttachComponent(e,r),this.setCoherent(!0),this.decohereOutlets()),e):e},removeComponent(){const t=this.component;return null===t?null:(t.remove(),t)},deleteComponent(){const t=this.detachComponent();return null===t?null:(t.remove(),t)},bindComponent(t,e){if(!this.binds||null!==this.component)return;const r=this.detectComponent(t);null!==r&&(this.component=r,this.willAttachComponent(r,e),this.onAttachComponent(r,e),this.initComponent(r),this.didAttachComponent(r,e),this.setCoherent(!0),this.decohereOutlets())},unbindComponent(t){if(!this.binds)return;const e=this.detectComponent(t);null!==e&&this.component===e&&(this.component=null,this.willDetachComponent(e),this.onDetachComponent(e),this.deinitComponent(e),this.didDetachComponent(e),this.setCoherent(!0),this.decohereOutlets())},detectComponent(t){const e=this.componentKey;return void 0!==e&&e===t.key?t:null},recohere(t){this.setCoherentTime(t);const e=this.inlet;e instanceof Ee?(this.setDerived((this.flags&pe.Mask)<=Math.min(e.flags&pe.Mask,pe.Intrinsic)),0!=(this.flags&ge.DerivedFlag)&&this.setComponent(e.component)):this.setDerived(!1)}},{tryComponent(t,e){const r=me.getMetaclass(t),i=null!==r?r.tryFastener(t,e):null;return i instanceof Ee?i.component:null},construct(t,e){return(t=super.construct(t,e)).component=null,t},refine(t){super.refine(t);const e=t.prototype,r=Object.getOwnPropertyDescriptor(e,"componentKey");void 0!==r&&"value"in r&&(!0===r.value?(r.value=t.name,Object.defineProperty(e,"componentKey",r)):!1===r.value&&(r.value=void 0,Object.defineProperty(e,"componentKey",r)))}}),Te=Oe.extend("ComponentSet",{get fastenerType(){return Te},componentKey(t){},insertComponentMap(t,e){const r=this.components;null!==e&&0!=(this.flags&Te.OrderedFlag)?this.components=b.inserted(r,t.uid,t,e):r[t.uid]=t},removeComponentMap(t){delete this.components[t.uid]},hasComponent(t){return void 0!==this.components[t.uid]},addComponent(t,e,r){let i;return t=null!=t?this.fromLike(t):this.createComponent(),void 0===e&&(e=null),this.binds&&(i=this.parentComponent,null!==i)&&(null===e&&(e=t.parent===i?t.nextSibling:this.getTargetChild(i,t)),void 0===r&&(r=this.componentKey(t)),t.parent===i&&t.nextSibling===e&&t.key===r||this.insertChild(i,t,e,r)),void 0!==this.components[t.uid]||(this.insertComponentMap(t,e),this.componentCount+=1,this.willAttachComponent(t,e),this.onAttachComponent(t,e),this.initComponent(t),this.didAttachComponent(t,e),this.setCoherent(!0),this.decohereOutlets()),t},addComponents(t,e){for(const r in t)this.addComponent(t[r],e)},setComponents(t,e){const r=this.binds,i=r?this.parentComponent:null,n=this.components;for(const e in n)if(void 0===t[e]){const t=this.detachComponent(n[e]);null!==t&&r&&null!==i&&t.parent===i&&t.remove()}if(0!=(this.flags&Te.OrderedFlag)){const r=new Array;for(const e in t)r.push(t[e]);for(let t=0,i=r.length;t<i;t+=1){const s=r[t];if(void 0===n[s.uid]){const n=t<i+1?r[t+1]:e;this.addComponent(s,n)}}}else for(const r in t)void 0===n[r]&&this.addComponent(t[r],e)},attachComponent(t,e){return t=null!=t?this.fromLike(t):this.createComponent(),void 0!==this.components[t.uid]||(void 0===e&&(e=null),this.insertComponentMap(t,e),this.componentCount+=1,this.willAttachComponent(t,e),this.onAttachComponent(t,e),this.initComponent(t),this.didAttachComponent(t,e),this.setCoherent(!0),this.decohereOutlets()),t},attachComponents(t,e){for(const r in t)this.attachComponent(t[r],e)},detachComponent(t){return void 0===this.components[t.uid]?null:(this.componentCount-=1,this.removeComponentMap(t),this.willDetachComponent(t),this.onDetachComponent(t),this.deinitComponent(t),this.didDetachComponent(t),this.setCoherent(!0),this.decohereOutlets(),t)},detachComponents(t){void 0===t&&(t=this.components);for(const e in t)this.detachComponent(t[e])},insertComponent(t,e,r,i){return e=null!=e?this.fromLike(e):this.createComponent(),void 0===t&&(t=null),this.binds||void 0===this.components[e.uid]||null===e.parent||null!==t||void 0!==i?(null===t&&(t=this.parentComponent),void 0===r&&(r=null),void 0===i&&(i=this.componentKey(e)),null===t||e.parent===t&&e.key===i||(null===r&&(r=this.getTargetChild(t,e)),this.insertChild(t,e,r,i)),void 0!==this.components[e.uid]||(this.insertComponentMap(e,r),this.componentCount+=1,this.willAttachComponent(e,r),this.onAttachComponent(e,r),this.initComponent(e),this.didAttachComponent(e,r),this.setCoherent(!0),this.decohereOutlets()),e):e},insertComponents(t,e,r){for(const i in e)this.insertComponent(t,e[i],r)},removeComponent(t){return this.hasComponent(t)?(t.remove(),t):null},removeComponents(t){void 0===t&&(t=this.components);for(const e in t)this.removeComponent(t[e])},deleteComponent(t){const e=this.detachComponent(t);return null===e?null:(e.remove(),e)},deleteComponents(t){void 0===t&&(t=this.components);for(const e in t)this.deleteComponent(t[e])},reinsertComponent(t,e){if(void 0===this.components[t.uid]||void 0===e&&0==(this.flags&Te.SortedFlag))return;const r=t.parent;null!==r&&(void 0===e&&(e=this.getTargetChild(r,t)),r.reinsertChild(t,e))},bindComponent(t,e){if(!this.binds)return;const r=this.detectComponent(t);null!==r&&void 0===this.components[r.uid]&&(this.insertComponentMap(r,e),this.componentCount+=1,this.willAttachComponent(r,e),this.onAttachComponent(r,e),this.initComponent(r),this.didAttachComponent(r,e),this.setCoherent(!0),this.decohereOutlets())},unbindComponent(t){if(!this.binds)return;const e=this.detectComponent(t);null!==e&&void 0!==this.components[e.uid]&&(this.componentCount-=1,this.removeComponentMap(e),this.willDetachComponent(e),this.onDetachComponent(e),this.deinitComponent(e),this.didDetachComponent(e),this.setCoherent(!0),this.decohereOutlets())},detectComponent(t){return"function"==typeof this.componentType&&t instanceof this.componentType?t:null},recohere(t){this.setCoherentTime(t);const e=this.inlet;e instanceof Te?(this.setDerived((this.flags&pe.Mask)<=Math.min(e.flags&pe.Mask,pe.Intrinsic)),0!=(this.flags&ge.DerivedFlag)&&this.setComponents(e.components)):this.setDerived(!1)},get ordered(){return 0!=(this.flags&Te.OrderedFlag)},order(t){return void 0===t&&(t=!0),t?this.setFlags(this.flags|Te.OrderedFlag):this.setFlags(this.flags&~Te.OrderedFlag),this},get sorted(){return 0!=(this.flags&Te.SortedFlag)},sort(t){if(void 0===t&&(t=!0),t){const t=this.parentComponent;this.willSort(t),this.setFlags(this.flags|Te.SortedFlag),this.onSort(t),this.didSort(t)}else this.setFlags(this.flags&~Te.SortedFlag);return this},willSort(t){},onSort(t){null!==t&&this.sortChildren(t)},didSort(t){},sortChildren(t,e){t.sortChildren(this.compareChildren.bind(this))},getTargetChild(t,e){return 0!=(this.flags&Te.SortedFlag)?t.getTargetChild(e,this.compareTargetChild.bind(this)):null},compareChildren(t,e){const r=this.components,i=r[t.uid],n=r[e.uid];return void 0!==i&&void 0!==n?this.compare(i,n):void 0!==i?1:void 0!==n?-1:0},compareTargetChild(t,e){const r=this.components[e.uid];return void 0!==r?this.compare(t,r):void 0!==r?-1:0},compare:(t,e)=>t.uid<e.uid?-1:t.uid>e.uid?1:0},{construct(t,e){return(t=super.construct(t,e)).components={},t.componentCount=0,t},refine(t){super.refine(t);const e=t.prototype;let r=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"ordered")&&(e.ordered?r|=Te.OrderedFlag:r&=~Te.OrderedFlag,delete e.ordered),Object.prototype.hasOwnProperty.call(e,"sorted")&&(e.sorted?r|=Te.SortedFlag:r&=~Te.SortedFlag,delete e.sorted),Object.defineProperty(e,"flagsInit",{value:r,enumerable:!0,configurable:!0})},OrderedFlag:1<<Oe.FlagShift+0,SortedFlag:1<<Oe.FlagShift+1,FlagShift:Oe.FlagShift+2,FlagMask:(1<<Oe.FlagShift+2)-1});class Pe extends Me{get componentType(){return Pe}willAttachParent(t){this.callObservers("serviceWillAttachParent",t,this)}onAttachParent(t){}didAttachParent(t){this.callObservers("serviceDidAttachParent",t,this)}willDetachParent(t){this.callObservers("serviceWillDetachParent",t,this)}onDetachParent(t){}didDetachParent(t){this.callObservers("serviceDidDetachParent",t,this)}willInsertChild(t,e){super.willInsertChild(t,e),this.callObservers("serviceWillInsertChild",t,e,this)}didInsertChild(t,e){this.callObservers("serviceDidInsertChild",t,e,this),super.didInsertChild(t,e)}willRemoveChild(t){super.willRemoveChild(t),this.callObservers("serviceWillRemoveChild",t,this)}didRemoveChild(t){this.callObservers("serviceDidRemoveChild",t,this),super.didRemoveChild(t)}willReinsertChild(t,e){super.willReinsertChild(t,e),this.callObservers("serviceWillReinsertChild",t,e,this)}didReinsertChild(t,e){this.callObservers("serviceDidReinsertChild",t,e,this),super.didReinsertChild(t,e)}willMount(){super.willMount(),this.callObservers("serviceWillMount",this)}didMount(){this.callObservers("serviceDidMount",this),super.didMount()}willUnmount(){super.willUnmount(),this.callObservers("serviceWillUnmount",this)}didUnmount(){this.callObservers("serviceDidUnmount",this),super.didUnmount()}static create(){return new this}static global(){let t;if(Object.hasOwnProperty.call(this,"Global")&&(t=this.Global),void 0===t)if(t=this.create(),Object.defineProperty(this,"Global",{value:t,configurable:!0}),this.prototype instanceof Pe){Object.getPrototypeOf(this).global().appendChild(t)}else t.mount();return t}}Pe.uid=function(){let t=1;return function(){const e=~~t;return t+=1,"service"+e}}();class Ie extends O{constructor(t,e,r,i){super(),this.pages=t,this.index=e,this.childIndex=r,this.childCursor=i}isEmpty(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return!1;this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,!0;this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}}head(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return this.childCursor.head();this.childCursor=null}else{if(!(this.childIndex<this.pages.length))throw this.childIndex=this.pages.length,new Error("empty");this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}}step(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return void(this.index+=1);this.childCursor=null}else{if(!(this.childIndex<this.pages.length))throw this.childIndex=this.pages.length,new Error("empty");this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}}skip(t){for(;t>0;)if(null!==this.childCursor)this.childCursor.hasNext()?(this.index+=1,t-=1,this.childCursor.next()):this.childCursor=null;else{if(!(this.childIndex<this.pages.length))break;{const e=this.pages[this.childIndex],r=this.pageSize(e);if(this.childIndex+=1,r<t){this.childCursor=this.pageCursor(e),t>0&&(this.index+=t,this.childCursor.skip(t),t=0);break}this.index+=r,t-=r}}}hasNext(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasNext())return!0;this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,!1;this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}}nextIndex(){return this.index}next(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasNext())return this.index+=1,this.childCursor.next();this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,{done:!0,value:void 0};this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}}hasPrevious(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasPrevious())return!0;this.childCursor=null}else{if(!(this.childIndex>0))return this.childIndex=0,!1;this.childCursor=this.reversePageCursor(this.pages[this.childIndex-1]),this.childIndex-=1}}previousIndex(){return this.index-1}previous(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasPrevious())return this.index-=1,this.childCursor.previous();this.childCursor=null}else{if(!(this.childIndex>0))return this.childIndex=0,{done:!0,value:void 0};this.childCursor=this.reversePageCursor(this.pages[this.childIndex-1]),this.childIndex-=1}}set(t){this.childCursor.set(t)}delete(){this.childCursor.delete()}}class De{constructor(){this.pageSplitSize=32}compare(t,e){return v.compare(t,e)}pageShouldSplit(t){return t.arity>this.pageSplitSize}pageShouldMerge(t){return t.arity<this.pageSplitSize>>>1}}class Le extends De{constructor(t){super(),void 0===t&&(t=qe.empty()),this.root=t}get size(){return this.root.size}isEmpty(){return this.root.isEmpty()}has(t){return this.root.has(t,this)}get(t){return this.root.get(t,this)}getEntry(t){return this.root.getEntry(t)}firstKey(){const t=this.root.firstEntry();return void 0!==t?t[0]:void 0}firstValue(){const t=this.root.firstEntry();return void 0!==t?t[1]:void 0}firstEntry(){return this.root.firstEntry()}lastKey(){const t=this.root.lastEntry();return void 0!==t?t[0]:void 0}lastValue(){const t=this.root.lastEntry();return void 0!==t?t[1]:void 0}lastEntry(){return this.root.lastEntry()}nextKey(t){const e=this.root.nextEntry(t,this);return void 0!==e?e[0]:void 0}nextValue(t){const e=this.root.nextEntry(t,this);return void 0!==e?e[1]:void 0}nextEntry(t){return this.root.nextEntry(t,this)}previousKey(t){const e=this.root.previousEntry(t,this);return void 0!==e?e[0]:void 0}previousValue(t){const e=this.root.previousEntry(t,this);return void 0!==e?e[1]:void 0}previousEntry(t){return this.root.previousEntry(t,this)}set(t,e){const r=this.root;let i=this.root.updated(t,e,this);return r===i||(i.size>r.size&&(i=i.balanced(this)),this.root=i),this}delete(t){const e=this.root,r=this.root.removed(t,this);return e!==r&&(this.root=r,!0)}drop(t){return t>0&&0!==this.root.size&&(t>=this.root.size?this.root=qe.empty():this.root=this.root.drop(t,this)),this}take(t){return t<this.root.size&&0!==this.root.size&&(this.root=t<=0?qe.empty():this.root.take(t,this)),this}clear(){this.root=qe.empty()}updated(t,e){const r=this.root;let i=r.updated(t,e,this);return r===i?this:(i.size>r.size&&(i=i.balanced(this)),this.copy(i))}removed(t){const e=this.root,r=e.removed(t,this);return e===r?this:this.copy(r)}cleared(){return this.root.isEmpty()?this:this.copy(qe.empty())}reduced(t,e,r){const i=this.root,n=i.reduced(t,e,r);return i!==n&&(this.root=n),n.fold}forEach(t,e){return this.root.forEach(t,e,this)}forEachKey(t,e){return this.root.forEachKey(t,e,this)}forEachValue(t,e){return this.root.forEachValue(t,e,this)}[Symbol.iterator](){return this.root.entries()}keys(){return this.root.keys()}values(){return this.root.values()}entries(){return this.root.entries()}reverseKeys(){return this.root.reverseKeys()}reverseValues(){return this.root.reverseValues()}reverseEntries(){return this.root.reverseEntries()}clone(){return this.copy(this.root)}copy(t){const e=new Le(t);return e.pageSplitSize!==this.pageSplitSize&&(e.pageSplitSize=this.pageSplitSize),e.compare!==this.compare&&(e.compare=this.compare),e}get[Symbol.toStringTag](){return"BTree"}}let qe=(()=>{var t;let i,n=[];return t=class{keys(){return O.keys(this.entries())}values(){return O.values(this.entries())}reverseKeys(){return O.keys(this.reverseEntries())}reverseValues(){return O.values(this.reverseEntries())}static empty(){return new Ae([],void 0)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class Ae extends qe{constructor(t,e){super(),this.slots=t,this.fold=e}get arity(){return this.slots.length}get size(){return this.slots.length}isEmpty(){return 0===this.slots.length}minKey(){return this.slots[0][0]}maxKey(){return this.slots[this.slots.length-1][0]}has(t,e){return this.lookup(t,e)>=0}get(t,e){const r=this.lookup(t,e);if(!(r<0))return this.slots[r][1]}getEntry(t){return this.slots[t]}firstEntry(){const t=this.slots;if(0!==t.length)return t[0]}lastEntry(){const t=this.slots;if(0!==t.length)return t[t.length-1]}nextEntry(t,e){let r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this.slots[r]}previousEntry(t,e){let r=this.lookup(t,e);return r>=0?r-=1:r=-(r+2),this.slots[r]}updated(t,e,r){let i=this.lookup(t,r);return i>=0?this.updatedSlot(i,t,e):(i=-(i+1),this.insertedSlot(i,t,e))}updatedSlot(t,e,r){const i=this.slots;if(r===i[t][1])return this;const n=i.slice(0);return n[t]=[e,r],new Ae(n,void 0)}insertedSlot(t,e,r){const i=this.slots,n=i.length+1,s=new Array(n);for(let e=0;e<t;e+=1)s[e]=i[e];s[t]=[e,r];for(let e=t;e<n-1;e+=1)s[e+1]=i[e];return new Ae(s,void 0)}removed(t,e){const r=this.lookup(t,e);return r<0?this:this.slots.length<=1?qe.empty():this.removedSlot(r)}removedSlot(t){const e=this.slots,r=new Array(e.length-1);for(let i=0;i<t;i+=1)r[i]=e[i];for(let i=t;i<r.length;i+=1)r[i]=e[i+1];return new Ae(r,void 0)}drop(t,e){const r=this.slots;if(t<=0)return this;if(t>=r.length)return qe.empty();const i=r.length-t,n=new Array(i);for(let e=0;e<i;e+=1)n[e]=r[e+t];return new Ae(n,void 0)}take(t,e){const r=this.slots;if(t>=r.length)return this;if(t<=0)return qe.empty();const i=new Array(t);for(let e=0;e<t;e+=1)i[e]=r[e];return new Ae(i,void 0)}balanced(t){const e=this.slots.length;return e<=1||!t.pageShouldSplit(this)?this:this.split(e>>>1)}split(t){const e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;const n=new Array(1);return n[0]=i.minKey(),new Fe(e,n,void 0,this.slots.length)}splitLeft(t){const e=this.slots,r=new Array(t);for(let i=0;i<t;i+=1)r[i]=e[i];return new Ae(r,void 0)}splitRight(t){const e=this.slots,r=e.length-t,i=new Array(r);for(let n=0;n<r;n+=1)i[n]=e[n+t];return new Ae(i,void 0)}reduced(t,e,r){if(void 0!==this.fold)return this;const i=this.slots;let n=t;for(let t=0;t<i.length;t+=1)n=e(n,i[t][1]);return new Ae(i,n)}forEach(t,e,r){const i=this.slots;for(let n=0;n<i.length;n+=1){const s=i[n],o=t.call(e,s[1],s[0],r);if(void 0!==o)return o}}forEachKey(t,e,r){const i=this.slots;for(let n=0;n<i.length;n+=1){const s=i[n],o=t.call(e,s[0],r);if(void 0!==o)return o}}forEachValue(t,e,r){const i=this.slots;for(let n=0;n<i.length;n+=1){const s=i[n],o=t.call(e,s[1],r);if(void 0!==o)return o}}entries(){return O.array(this.slots)}reverseEntries(){return O.array(this.slots,this.slots.length)}lookup(t,e){let r=0,i=this.slots.length-1;for(;r<=i;){const n=r+i>>>1,s=e.compare(t,this.slots[n][0]);if(s>0)r=n+1;else{if(!(s<0))return n;i=n-1}}return-(r+1)}}class Fe extends qe{constructor(t,e,r,i){super(),this.pages=t,this.knots=e,this.fold=r,this.size=i}get arity(){return this.pages.length}isEmpty(){return 0===this.size}minKey(){return this.pages[0].minKey()}maxKey(){return this.pages[this.pages.length-1].maxKey()}has(t,e){let r=this.lookup(t,e);return 0===r||(r>0?r+=1:r=-(r+1),this.pages[r].has(t,e))}get(t,e){let r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this.pages[r].get(t,e)}getEntry(t){const e=this.pages;for(let r=0;r<e.length;r+=1){const i=e[r];if(t<i.size)return i.getEntry(t);t-=i.size}}firstEntry(){const t=this.pages;if(0!==t.length)return t[0].firstEntry()}lastEntry(){const t=this.pages;if(0!==t.length)return t[t.length-1].lastEntry()}nextEntry(t,e){let r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);const i=this.pages;let n=i[r].nextEntry(t,e);return void 0===n&&r+1<i.length&&(n=i[r+1].nextEntry(t,e)),n}previousEntry(t,e){let r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);const i=this.pages;let n=i[r].previousEntry(t,e);return void 0===n&&r>0&&(n=i[r-1].previousEntry(t,e)),n}updated(t,e,r){let i=this.lookup(t,r);i>=0?i+=1:i=-(i+1);const n=this.pages[i],s=n.updated(t,e,r);return n===s?this:n.size!==s.size&&r.pageShouldSplit(s)?this.updatedPageSplit(i,s,n):this.updatedPage(i,s,n)}updatedPage(t,e,r){const i=this.pages.slice(0);i[t]=e;const n=this.knots;let s;0===n.length?s=[]:(s=n.slice(0),t>0&&(s[t-1]=e.minKey()));const o=this.size-r.size+e.size;return new Fe(i,s,void 0,o)}updatedPageSplit(t,e,r){const i=this.pages,n=new Array(i.length+1);for(let e=0;e<t;e+=1)n[e]=i[e];const s=e.splitLeft(e.arity>>>1),o=e.splitRight(e.arity>>>1);n[t]=s,n[t+1]=o;for(let e=t+1;e<i.length;e+=1)n[e+1]=i[e];const a=this.knots,u=new Array(i.length);if(t<=0){u[0]=o.minKey();for(let t=0;t<a.length;t+=1)u[t+1]=a[t]}else{for(let e=0;e<t-1;e+=1)u[e]=a[e];u[t-1]=s.minKey(),u[t]=o.minKey();for(let e=t;e<a.length;e+=1)u[e+1]=a[e]}const h=this.size-r.size+e.size;return new Fe(n,u,void 0,h)}updatedPageMerge(t,e,r){const i=this.pages,n=e.pages,s=new Array(i.length+n.length-1);for(let e=0;e<t;e+=1)s[e]=i[e];for(let e=0;e<n.length;e+=1)s[e+t]=n[e];for(let e=t+1;e<i.length;e+=1)s[e+n.length-1]=i[e];const o=this.knots,a=e.knots,u=new Array(s.length-1);if(t<=0){for(let t=0;t<a.length;t+=1)u[t]=a[t];u[a.length]=i[1].minKey();for(let t=1;t<o.length;t+=1)u[t+a.length]=o[t]}else{for(let e=0;e<t-1;e+=1)u[e]=o[e];u[t-1]=n[0].minKey();for(let e=0;e<a.length;e+=1)u[e+t]=a[e];for(let e=t;e<o.length;e+=1)u[e+a.length]=o[e]}const h=this.size-r.size+e.size;return new Fe(s,u,void 0,h)}removed(t,e){let r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);const i=this.pages[r],n=i.removed(t,e);return i===n?this:this.replacedPage(r,n,i,e)}replacedPage(t,e,r,i){return e.isEmpty()?this.pages.length>2?this.removedPage(t,e,r):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:qe.empty():e instanceof Fe&&i.pageShouldMerge(e)?this.updatedPageMerge(t,e,r):this.updatedPage(t,e,r)}removedPage(t,e,r){const i=this.pages,n=new Array(i.length-1);for(let e=0;e<t;e+=1)n[e]=i[e];for(let e=t+1;e<i.length;e+=1)n[e-1]=i[e];const s=this.knots,o=new Array(s.length-1);if(t<=0)for(let t=1;t<s.length;t+=1)o[t-1]=s[t];else{for(let e=0;e<t-1;e+=1)o[e]=s[e];for(let e=t;e<s.length;e+=1)o[e-1]=s[e]}const a=this.size-r.size;return new Fe(n,o,void 0,a)}drop(t,e){if(t<=0)return this;let r=this.size;if(t>=r)return qe.empty();const i=this.pages;let n=0;for(;n<i.length;){const e=i[n].size;if(e>t)break;r-=e,t-=e,n+=1}const s=i.length-n;if(s<=1)return i[n].drop(t,e);let o;if(n<=0)o=this;else{const t=new Array(s);for(let e=0;e<s;e+=1)t[e]=i[e+n];const e=new Array(s-1);for(let t=0;t<e.length;t+=1)e[t]=this.knots[t+n];o=new Fe(t,e,void 0,r)}if(t<=0)return o;const a=i[n],u=a.drop(t,e);return o.replacedPage(0,u,a,e)}take(t,e){if(t>=this.size)return this;if(t<=0)return qe.empty();const r=this.pages;let i=0,n=0;for(;i<r.length&&t>0;){const e=r[i].size;if(n+=e,i+=1,e>t)break;t-=e}const s=0===t?i:i+1;if(s<=1)return t>0?r[0].take(t,e):r[0];let o;if(i>=r.length)o=this;else{const t=new Array(s);for(let e=0;e<s;e+=1)t[e]=r[e];const e=new Array(s-1);for(let t=0;t<e.length;t+=1)e[t]=this.knots[t];o=new Fe(t,e,void 0,n)}if(t<=0)return o;const a=r[i-1],u=a.take(t,e);return o.replacedPage(i-1,u,a,e)}balanced(t){return this.pages.length<=1||!t.pageShouldSplit(this)?this:this.split(this.knots.length>>>1)}split(t){const e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;const n=new Array(1);return n[0]=i.minKey(),new Fe(e,n,void 0,this.size)}splitLeft(t){const e=this.pages,r=new Array(t+1);for(let i=0;i<t+1;i+=1)r[i]=e[i];const i=this.knots,n=new Array(t);for(let e=0;e<t;e+=1)n[e]=i[e];let s=0;for(let e=0;e<=t;e+=1)s+=r[e].size;return new Fe(r,n,void 0,s)}splitRight(t){const e=this.pages,r=e.length-(t+1),i=new Array(r);for(let n=0;n<r;n+=1)i[n]=e[n+(t+1)];const n=this.knots,s=new Array(r-1);for(let e=0;e<s.length;e+=1)s[e]=n[e+(t+1)];let o=0;for(let t=0;t<r;t+=1)o+=i[t].size;return new Fe(i,s,void 0,o)}reduced(t,e,r){if(void 0!==this.fold)return this;const i=this.pages,n=i.length,s=new Array(n);for(let o=0;o<n;o+=1)s[o]=i[o].reduced(t,e,r);let o=s[0].fold;for(let t=1;t<n;t+=1)o=r(o,s[t].fold);return new Fe(s,this.knots,o,this.size)}forEach(t,e,r){const i=this.pages;for(let n=0;n<i.length;n+=1){const s=i[n].forEach(t,e,r);if(void 0!==s)return s}}forEachKey(t,e,r){const i=this.pages;for(let n=0;n<i.length;n+=1){const s=i[n].forEachKey(t,e,r);if(void 0!==s)return s}}forEachValue(t,e,r){const i=this.pages;for(let n=0;n<i.length;n+=1){const s=i[n].forEachValue(t,e,r);if(void 0!==s)return s}}entries(){return new Ve(this.pages)}reverseEntries(){return new Ve(this.pages,this.size,this.pages.length)}lookup(t,e){let r=0,i=this.knots.length-1;for(;r<=i;){const n=r+i>>>1,s=e.compare(t,this.knots[n]);if(s>0)r=n+1;else{if(!(s<0))return n;i=n-1}}return-(r+1)}}class Ve extends Ie{constructor(t,e=0,r=0,i=null){super(t,e,r,i)}pageSize(t){return t.size}pageCursor(t){return t.entries()}reversePageCursor(t){return t.reverseEntries()}}class ze{constructor(){this.pageSplitSize=32}identify(t){const e=new Uint8Array(6);return i.fillBytes(e),e}compare(t,e){return v.compare(t,e)}pageShouldSplit(t){return t.arity>this.pageSplitSize}pageShouldMerge(t){return t.arity<this.pageSplitSize>>>1}}class je extends ze{constructor(t){super(),void 0===t&&(t=Ne.empty()),this.root=t}get length(){return this.root.size}isEmpty(){return this.root.isEmpty()}get(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.get(t)}getEntry(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.getEntry(t)}set(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);const i=this.root;if(t<0||t>=i.size)throw new RangeError(""+t);return this.root=i.updated(t,e,this),this}insert(t,e,r){const i=this.root;if(t<0||t>i.size)throw new RangeError(""+t);return this.root=i.inserted(t,e,r,this).balanced(this),this}remove(t,e){if(void 0!==e&&(t=this.lookup(e,t))<0)throw new RangeError(""+e);const r=this.root;if(t<0||t>r.size)throw new RangeError(""+t);return this.root=r.removed(t,this),this}push(...t){let e=this.root;for(let r=0;r<t.length;r+=1)e=e.inserted(e.size,t[r],void 0,this).balanced(this);return this.root=e,e.size}pop(){const t=this.root,e=t.size-1;if(e<0)return;const r=t.get(e);return this.root=t.removed(e,this),r}unshift(...t){let e=this.root;for(let r=t.length-1;r>=0;r-=1)e=e.inserted(0,t[r],void 0,this).balanced(this);return this.root=e,e.size}shift(){const t=this.root;if(0===t.size)return;const e=t.get(0);return this.root=t.removed(0,this),e}move(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);const i=this.root;if(t<0||t>=i.size)throw new RangeError(""+t);if(e<0||e>=i.size)throw new RangeError(""+e);if(t!==e){const r=i.getEntry(t);this.root=i.removed(t,this).inserted(e,r[1],r[0],this).balanced(this)}return this}splice(t,e,...r){let i=this.root;t<0&&(t=i.size+t),t=Math.min(Math.max(0,t),i.size),void 0===e&&(e=i.size-t);const n=[];for(let r=t,s=t+e;r<s;r+=1)n.push(i.get(t)),i=i.removed(t,this);for(let e=0;e<r.length;e+=1)i=i.inserted(t+e,r[e],void 0,this).balanced(this);return this.root=i,n}drop(t){const e=this.root;return t>0&&e.size>0&&(t>=e.size?this.root=Ne.empty():this.root=e.drop(t,this)),this}take(t){const e=this.root;return t<e.size&&e.size>0&&(this.root=t<=0?Ne.empty():e.take(t,this)),this}clear(){this.root=Ne.empty()}forEach(t,e){return this.root.forEach(t,e,0,this)}[Symbol.iterator](){return this.root.values()}keys(){return this.root.keys()}values(){return this.root.values()}entries(){return this.root.entries()}reverseKeys(){return this.root.reverseKeys()}reverseValues(){return this.root.reverseValues()}reverseEntries(){return this.root.reverseEntries()}clone(){return this.copy(this.root)}copy(t){const e=new je(t);return e.pageSplitSize!==this.pageSplitSize&&(e.pageSplitSize=this.pageSplitSize),e.identify!==this.identify&&(e.identify=this.identify),e.compare!==this.compare&&(e.compare=this.compare),e}lookup(t,e=0){const r=this.root;let i=e=Math.min(Math.max(0,e),r.size-1);do{const e=r.getEntry(i);if(void 0!==e&&0===this.compare(e[0],t))return i;i=(i+1)%r.size}while(isFinite(i)&&i!==e);return-1}}let Ne=(()=>{var t;let i,n=[];return t=class{keys(){return O.keys(this.entries())}values(){return O.values(this.entries())}reverseKeys(){return O.keys(this.reverseEntries())}reverseValues(){return O.values(this.reverseEntries())}static empty(){return new Ue([])}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class Ue extends Ne{constructor(t){super(),this.slots=t}get arity(){return this.slots.length}get size(){return this.slots.length}isEmpty(){return 0===this.slots.length}get(t){const e=this.slots[t];if(void 0!==e)return e[1]}getEntry(t){return this.slots[t]}updated(t,e,r){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.updatedItem(t,e)}updatedItem(t,e){const r=this.slots,i=r[t];if(void 0===i||e===i[1])return this;const n=r.slice(0);return n[t]=[i[0],e],new Ue(n)}inserted(t,e,r,i){if(t<0||t>this.slots.length)throw new RangeError(""+t);return this.insertedItem(t,e,r,i)}insertedItem(t,e,r,i){void 0===r&&(r=i.identify(e));const n=this.slots,s=new Array(n.length+1);for(let e=0;e<t;e+=1)s[e]=n[e];s[t]=[r,e];for(let e=t;e<n.length;e+=1)s[e+1]=n[e];return new Ue(s)}removed(t,e){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.slots.length<=1?Ne.empty():this.removedSlot(t)}removedSlot(t){const e=this.slots,r=new Array(e.length-1);for(let i=0;i<t;i+=1)r[i]=e[i];for(let i=t;i<r.length;i+=1)r[i]=e[i+1];return new Ue(r)}drop(t,e){const r=this.slots;if(t<=0||0===r.length)return this;if(t>=r.length)return Ne.empty();const i=r.length-t,n=new Array(i);for(let e=0;e<i;e+=1)n[e]=r[e+t];return new Ue(n)}take(t,e){const r=this.slots;if(t>=r.length||0===r.length)return this;if(t<=0)return Ne.empty();const i=new Array(t);for(let e=0;e<t;e+=1)i[e]=r[e];return new Ue(i)}balanced(t){const e=this.slots.length;return e<=1||!t.pageShouldSplit(this)?this:this.split(e>>>1)}split(t){const e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;const n=new Array(1);return n[0]=t,new Re(e,n,this.slots.length)}splitLeft(t){const e=this.slots,r=new Array(t);for(let i=0;i<t;i+=1)r[i]=e[i];return new Ue(r)}splitRight(t){const e=this.slots,r=e.length-t,i=new Array(r);for(let n=0;n<r;n+=1)i[n]=e[n+t];return new Ue(i)}forEach(t,e,r,i){for(let n=0;n<this.slots.length;n+=1){const s=this.slots[n],o=t.call(e,s[1],r+n,s[0],i);if(void 0!==o)return o}}entries(){return O.array(this.slots)}reverseEntries(){return O.array(this.slots,this.slots.length)}}class Re extends Ne{constructor(t,e,r){super(),this.pages=t,this.knots=e,this.size=r}get arity(){return this.pages.length}isEmpty(){return 0===this.size}get(t){let e=this.lookup(t);e>=0?e+=1:e=-(e+1);const r=0===e?t:t-this.knots[e-1];return this.pages[e].get(r)}getEntry(t){let e=this.lookup(t);e>=0?e+=1:e=-(e+1);const r=0===e?t:t-this.knots[e-1];return this.pages[e].getEntry(r)}updated(t,e,r){let i=this.lookup(t);i>=0?i+=1:i=-(i+1);const n=0===i?t:t-this.knots[i-1],s=this.pages[i],o=s.updated(n,e,r);return s===o?this:s.size!==o.size&&r.pageShouldSplit(o)?this.updatedPageSplit(i,o,s):this.updatedPage(i,o,s)}updatedPage(t,e,r){const i=this.pages,n=i.slice(0);n[t]=e;const s=this.knots;let o,a;if(i.length-1<=0)o=[],a=0;else{o=s.slice(0),a=t>0?s[t-1]:0;for(let e=t;e<o.length;e+=1)a+=n[e].size,o[e]=a;a+=n[o.length].size}return new Re(n,o,a)}updatedPageSplit(t,e,r){const i=this.pages,n=new Array(i.length+1);for(let e=0;e<t;e+=1)n[e]=i[e];const s=e.splitLeft(e.arity>>>1),o=e.splitRight(e.arity>>>1);n[t]=s,n[t+1]=o;for(let e=t+1;e<i.length;e+=1)n[e+1]=i[e];return Re.create(n)}updatedPageMerge(t,e,r){const i=this.pages,n=e.pages,s=new Array(i.length+n.length-1);for(let e=0;e<t;e+=1)s[e]=i[e];for(let e=0;e<n.length;e+=1)s[e+t]=n[e];for(let e=t+1;e<i.length;e+=1)s[e+n.length-1]=i[e];return Re.create(s)}inserted(t,e,r,i){let n=this.lookup(t);n>=0?n+=1:n=-(n+1);const s=0===n?t:t-this.knots[n-1],o=this.pages[n],a=o.inserted(s,e,r,i);return o===a?this:i.pageShouldSplit(a)?this.updatedPageSplit(n,a,o):this.updatedPage(n,a,o)}removed(t,e){let r=this.lookup(t);r>=0?r+=1:r=-(r+1);const i=0===r?t:t-this.knots[r-1],n=this.pages[r],s=n.removed(i,e);return n===s?this:this.replacedPage(r,s,n,e)}replacedPage(t,e,r,i){return e.isEmpty()?this.pages.length>2?this.removedPage(t,e,r):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:Ne.empty():e instanceof Re&&i.pageShouldMerge(e)?this.updatedPageMerge(t,e,r):this.updatedPage(t,e,r)}removedPage(t,e,r){const i=this.pages,n=new Array(i.length-1);for(let e=0;e<t;e+=1)n[e]=i[e];for(let e=t+1;e<i.length;e+=1)n[e-1]=i[e];const s=this.knots,o=new Array(s.length-1);let a;if(t<=0)a=0;else{for(let e=0;e<t;e+=1)o[e]=s[e];a=s[t-1]}for(let e=t;e<o.length;e+=1)a+=n[e].size,o[e]=a;return a+=n[o.length].size,new Re(n,o,a)}drop(t,e){if(t<=0)return this;if(t>=this.size)return Ne.empty();let r=this.lookup(t);r>=0?r+=1:r=-(r+1),t=0===r?t:t-this.knots[r-1];const i=this.pages,n=i.length-r;if(n<=1)return i[r].drop(t,e);let s;if(r<=0)s=this;else{const t=new Array(n);for(let e=0;e<n;e+=1)t[e]=i[e+r];s=Re.create(t)}if(t<=0)return s;const o=i[r],a=o.drop(t,e);return s.replacedPage(0,a,o,e)}take(t,e){if(t>=this.size)return this;if(t<=0)return Ne.empty();let r=this.lookup(t);r>=0?r+=1:r=-(r+1),t=0===r?t:t-this.knots[r-1];const i=this.pages,n=0===t?r:r+1;if(n<=1)return t>0?i[0].take(t,e):i[0];let s;if(r>=i.length)s=this;else{const t=new Array(n);for(let e=0;e<n;e+=1)t[e]=i[e];const e=new Array(n-1);for(let t=0;t<e.length;t+=1)e[t]=this.knots[t];const r=e[n-2]+t[n-1].size;s=new Re(t,e,r)}if(t<=0)return s;const o=i[r],a=o.take(t,e);return s.replacedPage(r,a,o,e)}balanced(t){return this.pages.length<=1||!t.pageShouldSplit(this)?this:this.split(this.knots.length>>>1)}split(t){const e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;const n=new Array(1);return n[0]=r.size,new Re(e,n,this.size)}splitLeft(t){const e=this.pages,r=new Array(t+1);for(let i=0;i<t+1;i+=1)r[i]=e[i];const i=this.knots,n=new Array(t);for(let e=0;e<t;e+=1)n[e]=i[e];let s=0;for(let e=0;e<=t;e+=1)s+=r[e].size;return new Re(r,n,s)}splitRight(t){const e=this.pages,r=e.length-(t+1),i=new Array(r);for(let n=0;n<r;n+=1)i[n]=e[n+(t+1)];const n=new Array(r-1);let s;if(r<=0)s=0;else{s=i[0].size;for(let t=1;t<r;t+=1)n[t-1]=s,s+=i[t].size}return new Re(i,n,s)}forEach(t,e,r,i){for(let n=0;n<this.pages.length;n+=1){const s=this.pages[n],o=s.forEach(t,e,r,i);if(void 0!==o)return o;r+=s.size}}entries(){return new Be(this.pages)}reverseEntries(){return new Be(this.pages,this.size,this.pages.length)}lookup(t){let e=0,r=this.knots.length-1;for(;e<=r;){const i=e+r>>>1;if(t>this.knots[i])e=i+1;else{if(!(t<this.knots[i]))return i;r=i-1}}return-(e+1)}static create(t){const e=new Array(t.length-1);let r=0;for(let i=0,n=e.length;i<n;i+=1)r+=t[i].size,e[i]=r;return r+=t[e.length].size,new Re(t,e,r)}}class Be extends Ie{constructor(t,e=0,r=0,i=null){super(t,e,r,i)}pageSize(t){return t.size}pageCursor(t){return t.entries()}reversePageCursor(t){return t.reverseEntries()}}const Ye={invalid:o((function(){return new Ke}))};class He{isExternal(){return!1}isDummy(){return!1}isInvalid(){return!1}addConstraintCondition(t,e){}removeConstraintCondition(t,e){}updateConstraintSolution(t){}}class We{isExternal(){return!1}isDummy(){return!0}isInvalid(){return!1}addConstraintCondition(t,e){}removeConstraintCondition(t,e){}updateConstraintSolution(t){}}class Xe{isExternal(){return!1}isDummy(){return!1}isInvalid(){return!1}addConstraintCondition(t,e){}removeConstraintCondition(t,e){}updateConstraintSolution(t){}}class Ke{isExternal(){return!1}isDummy(){return!1}isInvalid(){return!0}addConstraintCondition(t,e){}removeConstraintCondition(t,e){}updateConstraintSolution(t){}}const Ge={[Symbol.hasInstance]:t=>Ze[Symbol.hasInstance](t)||"number"==typeof t},Ze={zero:o((function(){return new _e(0)})),constant:t=>0===t?Ze.zero():new _e(t),sum(...t){const e=new Map;let r=0;for(let i=0;i<t.length;i+=1){const n=t[i];if("number"==typeof n)r+=n;else if(Je[Symbol.hasInstance](n)){const t=n.variable;if(null===t)r+=n.constant;else{let r=e.get(t);void 0===r&&(r=0),e.set(t,r+n.coefficient)}}else{for(const[t,r]of n.terms){let i=e.get(t);void 0===i&&(i=0),e.set(t,i+r)}r+=n.constant}}return new Qe(e,r)},product:(t,e)=>new $e(t,e),fromLike(t){if(null==t||null===t||Ze[Symbol.hasInstance](t))return t;if("number"==typeof t)return Ze.constant(t);throw new TypeError(""+t)},[Symbol.hasInstance]:t=>b.hasAllKeys(t,"terms","constant")};class Qe{constructor(t,e){this.terms=t,this.constant=e}isConstant(){return 0===this.terms.size}plus(t){return Ze.sum(this,t)}negative(){const t=new Map;for(const[e,r]of this.terms)t.set(e,-r);return new Qe(t,-this.constant)}minus(t){return t=Ze.fromLike(t).negative(),Ze.sum(this,t)}times(t){const e=new Map;for(const[r,i]of this.terms)e.set(r,i*t);return new Qe(e,this.constant*t)}divide(t){const e=new Map;for(const[r,i]of this.terms)e.set(r,i/t);return new Qe(e,this.constant/t)}debug(t){t=t.write("ConstraintExpression").write(46).write("sum").write(40);let e=0;for(const[r,i]of this.terms)e>0&&(t=t.write(", ")),t=1===i?t.debug(r):t.debug(Ze.product(i,r)),e+=1;return 0!==this.constant&&(0!==e&&(t=t.write(", ")),t=t.debug(this.constant)),t=t.write(41)}toString(){return St.debug(this)}}const Je={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"coefficient","variable")};class $e{constructor(t,e){this.coefficient=t,this.variable=e}isConstant(){return!1}get terms(){const t=new Map;return t.set(this.variable,this.coefficient),t}get constant(){return 0}plus(t){return(t=Ze.fromLike(t))instanceof $e&&this.variable===t.variable?Ze.product(this.coefficient+t.coefficient,this.variable):this.variable===t?Ze.product(this.coefficient+1,this.variable):Ze.sum(this,t)}negative(){return Ze.product(-this.coefficient,this.variable)}minus(t){return(t=Ze.fromLike(t))instanceof $e&&this.variable===t.variable?Ze.product(this.coefficient-t.coefficient,this.variable):this.variable===t?Ze.product(this.coefficient-1,this.variable):Ze.sum(this,t.negative())}times(t){return Ze.product(this.coefficient*t,this.variable)}divide(t){return Ze.product(this.coefficient/t,this.variable)}debug(t){return t=t.write("ConstraintExpression").write(46).write("product").write(40).debug(this.coefficient).write(", ").debug(this.variable).write(41)}toString(){return St.debug(this)}}class _e{constructor(t){this.constant=t}isConstant(){return!0}get coefficient(){return 0}get variable(){return null}get terms(){return new Map}plus(t){return(t=Ze.fromLike(t))instanceof _e?Ze.constant(this.constant+t.constant):Ze.sum(this,t)}negative(){return Ze.constant(-this.constant)}minus(t){return(t=Ze.fromLike(t))instanceof _e?Ze.constant(this.constant-t.constant):Ze.sum(this,t.negative())}times(t){return Ze.constant(this.constant*t)}divide(t){return Ze.constant(this.constant/t)}debug(t){return t=t.write("ConstraintExpression").write(46),t=0===this.constant?t.write("zero").write(40).write(41):t.write("constant").write(40).debug(this.constant).write(41)}toString(){return St.debug(this)}}const tr=we.extend("ConstraintProperty",{isExternal:()=>!0,isDummy:()=>!1,isInvalid:()=>!1,isConstant:()=>!1,evaluateConstraintVariable(){},updateConstraintSolution(t){this.constrained&&this.toNumber(this.value)!==t&&this.setValue(t,pe.Reflexive)},initStrength(){let t=Object.getPrototypeOf(this).strength;return void 0===t&&(t=rr.Strong),t},setStrength(t){this.strength=rr.fromLike(t)},get coefficient(){return 1},get variable(){return this},get terms(){const t=new Map;return t.set(this,1),t},get constant(){return 0},plus(t){return this===(t=Ze.fromLike(t))?Ze.product(2,this):Ze.sum(this,t)},negative(){return Ze.product(-1,this)},minus(t){return this===(t=Ze.fromLike(t))?Ze.zero():Ze.sum(this,t.negative())},times(t){return Ze.product(t,this)},divide(t){return Ze.product(1/t,this)},get constrained(){return 0!=(this.flags&tr.ConstrainedFlag)},constrain(t){void 0===t&&(t=!0);const e=this.flags;return t&&0==(e&tr.ConstrainedFlag)?(this.setFlags(e|tr.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&this.stopConstraining()):t||0==(e&tr.ConstrainedFlag)||(this.setFlags(e&~tr.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())),this},addConstraintCondition(t,e){this.conditionCount+=1,!this.constrained&&1===this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())},removeConstraintCondition(t,e){this.conditionCount-=1,!this.constrained&&0===this.conditionCount&&this.mounted&&this.stopConstraining()},get constraining(){return 0!=(this.flags&tr.ConstrainingFlag)},startConstraining(){0==(this.flags&tr.ConstrainingFlag)&&(this.willStartConstraining(),this.setFlags(this.flags|tr.ConstrainingFlag),this.onStartConstraining(),this.didStartConstraining())},willStartConstraining(){},onStartConstraining(){const t=this.owner;nr[Symbol.hasInstance](t)&&t.addConstraintVariable(this)},didStartConstraining(){},stopConstraining(){0!=(this.flags&tr.ConstrainingFlag)&&(this.willStopConstraining(),this.setFlags(this.flags&~tr.ConstrainingFlag),this.onStopConstraining(),this.didStopConstraining())},willStopConstraining(){},onStopConstraining(){const t=this.owner;nr[Symbol.hasInstance](t)&&t.removeConstraintVariable(this)},didStopConstraining(){},updateConstraintVariable(){const t=this.owner,e=this.value;void 0!==e&&nr[Symbol.hasInstance](t)&&t.setConstraintVariable(this,this.toNumber(e))},onSetValue(t,e){super.onSetValue(t,e);const r=this.owner;this.constraining&&nr[Symbol.hasInstance](r)&&r.setConstraintVariable(this,null!=t?this.toNumber(t):0)},onMount(){super.onMount(),this.constrained||0===this.conditionCount||this.startConstraining()},onUnmount(){this.constrained||0===this.conditionCount||this.stopConstraining(),super.onUnmount()},toNumber:t=>null!=t?+t:0},{construct(t,e){return(t=super.construct(t,e)).strength=t.initStrength(),t.conditionCount=0,t},refine(t){super.refine(t);const e=t.prototype;let r=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"constrained")&&(e.constrained?r|=tr.ConstrainedFlag:r&=~tr.ConstrainedFlag,delete e.constrained),Object.defineProperty(e,"flagsInit",{value:r,enumerable:!0,configurable:!0});const i=Object.getOwnPropertyDescriptor(e,"strength");void 0!==i&&"value"in i&&(i.value=rr.fromLike(i.value),Object.defineProperty(e,"strength",i))},ConstrainedFlag:1<<we.FlagShift+0,ConstrainingFlag:1<<we.FlagShift+1,FlagShift:we.FlagShift+2,FlagMask:(1<<we.FlagShift+2)-1}),er=be.extend("ConstraintAnimator",{isExternal:()=>!0,isDummy:()=>!1,isInvalid:()=>!1,isConstant:()=>!1,evaluateConstraintVariable(){},updateConstraintSolution(t){this.constrained&&this.toNumber(this.state)!==t&&this.setState(t,pe.Reflexive)},initStrength(){let t=Object.getPrototypeOf(this).strength;return void 0===t&&(t=rr.Strong),t},setStrength(t){this.strength=rr.fromLike(t)},get coefficient(){return 1},get variable(){return this},get terms(){const t=new Map;return t.set(this,1),t},get constant(){return 0},plus(t){return this===(t=Ze.fromLike(t))?Ze.product(2,this):Ze.sum(this,t)},negative(){return Ze.product(-1,this)},minus(t){return this===(t=Ze.fromLike(t))?Ze.zero():Ze.sum(this,t.negative())},times(t){return Ze.product(t,this)},divide(t){return Ze.product(1/t,this)},get constrained(){return 0!=(this.flags&er.ConstrainedFlag)},constrain(t){void 0===t&&(t=!0);const e=this.flags;return t&&0==(e&er.ConstrainedFlag)?(this.setFlags(e|er.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&this.stopConstraining()):t||0==(e&er.ConstrainedFlag)||(this.setFlags(e&~er.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())),this},addConstraintCondition(t,e){this.conditionCount+=1,!this.constrained&&1===this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())},removeConstraintCondition(t,e){this.conditionCount-=1,!this.constrained&&0===this.conditionCount&&this.mounted&&this.stopConstraining()},get constraining(){return 0!=(this.flags&er.ConstrainingFlag)},startConstraining(){0==(this.flags&er.ConstrainingFlag)&&(this.willStartConstraining(),this.setFlags(this.flags|er.ConstrainingFlag),this.onStartConstraining(),this.didStartConstraining())},willStartConstraining(){},onStartConstraining(){const t=this.owner;nr[Symbol.hasInstance](t)&&t.addConstraintVariable(this)},didStartConstraining(){},stopConstraining(){0!=(this.flags&er.ConstrainingFlag)&&(this.willStopConstraining(),this.setFlags(this.flags&~er.ConstrainingFlag),this.onStopConstraining(),this.didStopConstraining())},willStopConstraining(){},onStopConstraining(){const t=this.owner;nr[Symbol.hasInstance](t)&&t.removeConstraintVariable(this)},didStopConstraining(){},updateConstraintVariable(){const t=this.owner,e=this.value;void 0!==e&&nr[Symbol.hasInstance](t)&&t.setConstraintVariable(this,this.toNumber(e))},onSetValue(t,e){super.onSetValue(t,e);const r=this.owner;this.constraining&&nr[Symbol.hasInstance](r)&&r.setConstraintVariable(this,null!=t?this.toNumber(t):0)},onMount(){super.onMount(),this.constrained||0===this.conditionCount||this.startConstraining()},onUnmount(){this.constrained||0===this.conditionCount||this.stopConstraining(),super.onUnmount()},toNumber:t=>null!=t?+t:0},{construct(t,e){return(t=super.construct(t,e)).strength=t.initStrength(),t.conditionCount=0,t},refine(t){super.refine(t);const e=t.prototype;let r=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"constrained")&&(e.constrained?r|=er.ConstrainedFlag:r&=~er.ConstrainedFlag,delete e.constrained),Object.defineProperty(e,"flagsInit",{value:r,enumerable:!0,configurable:!0});const i=Object.getOwnPropertyDescriptor(e,"strength");void 0!==i&&"value"in i&&(i.value=rr.fromLike(i.value),Object.defineProperty(e,"strength",i))},ConstrainedFlag:1<<be.FlagShift+0,ConstrainingFlag:1<<be.FlagShift+1,FlagShift:be.FlagShift+2,FlagMask:(1<<be.FlagShift+2)-1}),rr={Required:1001001e3,Strong:1e6,Medium:1e3,Weak:1,Unbound:-1,clip:t=>Math.min(Math.max(0,t),rr.Required),fromLike(t){if(null==t)return t;if("number"==typeof t)return rr.clip(t);if("required"===t)return rr.Required;if("strong"===t)return rr.Strong;if("medium"===t)return rr.Medium;if("weak"===t)return rr.Weak;throw new TypeError(""+t)}};class ir{constructor(t,e,r,i){this.scope=t,this.expression=e,this.relation=r,this.strength=i}isConstrained(){return this.scope.hasConstraint(this)}constrain(t=!0){return t?this.scope.addConstraint(this):this.scope.removeConstraint(this),this}debug(t){return t=t.debug(this.scope).write(46).write("constraint").write(40).debug(this.expression).write(", ").debug(this.relation).write(", ").debug(void 0).write(", "),t=(t=this.strength===rr.Required?t.debug("required"):this.strength===rr.Strong?t.debug("strong"):this.strength===rr.Medium?t.debug("medium"):this.strength===rr.Weak?t.debug("weak"):t.debug(this.strength)).write(41)}toString(){return St.debug(this)}}const nr={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"constraint","constraintVariable")},sr={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"activateConstraint","deactivateConstraint","activateConstraintVariable","deactivateConstraintVariable","setConstraintVariable")};class or{constructor(t,e,r,i){this.solver=t,this.symbol=e,this.cells=r,this.constant=i}setSymbol(t){this.symbol=t,this.invalidate()}setConstant(t){this.constant!==t&&(this.constant=t,this.invalidate())}isConstant(){return 0===this.cells.size}isDummy(){for(const t of this.cells.keys())if(!(t instanceof We))return!1;return!0}clone(){return new or(this.solver,this.symbol,new Map(this.cells),this.constant)}add(t){const e=this.constant+t;return this.setConstant(e),e}insertSymbol(t,e=1){var r;e+=null!==(r=this.cells.get(t))&&void 0!==r?r:0,Math.abs(e)<h.Epsilon?this.cells.delete(t):this.cells.set(t,e)}insertRow(t,e){this.setConstant(this.constant+t.constant*e);for(const[r,i]of t.cells)this.insertSymbol(r,i*e)}removeSymbol(t){this.cells.delete(t)}negate(){this.setConstant(-this.constant);for(const[t,e]of this.cells)this.cells.set(t,-e)}solveFor(t){const e=this.cells.get(t);if(void 0===e)return;this.cells.delete(t);const r=-1/e;this.setConstant(this.constant*r);for(const[t,e]of this.cells)this.cells.set(t,e*r)}solveForEx(t,e){this.insertSymbol(t,-1),this.solveFor(e)}coefficientFor(t){const e=this.cells.get(t);return void 0!==e?e:0}substitute(t,e){const r=this.cells.get(t);void 0!==r&&(this.cells.delete(t),this.insertRow(e,r))}invalidate(){const t=this.symbol;null!==t&&this.solver.invalidate(t,this)}}let ar=(()=>{var t;let i,n=[];return t=class{constructor(){}updated(t,e){const r=gr.create(2);return r.push(this),r.set(t,e),r}updatedAttr(t,e){const r=gr.create(2);return r.push(this),r.setAttr(t,e),r}updatedSlot(t,e){const r=gr.create(2);return r.push(this),r.setSlot(t,e),r}appended(...t){const e=gr.create(1+arguments.length);return e.push(this),e.push(...t),e}prepended(...t){const e=gr.create(arguments.length+1);return e.push(...t),e.push(this),e}concat(...e){const r=gr.create();r.push(this);for(let i=0;i<e.length;i+=1)t.fromLike(e[i]).forEach((function(t){r.push(t)}));return r}lt(e){return e=t.fromLike(e),this.compareTo(e)<0?Tr.from(!0):t.absent()}le(e){return e=t.fromLike(e),this.compareTo(e)<=0?Tr.from(!0):t.absent()}eq(e){return e=t.fromLike(e),this.equals(e)?Tr.from(!0):t.absent()}ne(e){return e=t.fromLike(e),this.equals(e)?t.absent():Tr.from(!0)}ge(e){return e=t.fromLike(e),this.compareTo(e)>=0?Tr.from(!0):t.absent()}gt(e){return e=t.fromLike(e),this.compareTo(e)>0?Tr.from(!0):t.absent()}invoke(e){return t.absent()}filter(t){const e=li.literal(this);return 0===arguments.length?e.filter():e.filter(t)}max(t){return this.compareTo(t)>=0?this:t}min(t){return this.compareTo(t)<=0?this:t}evaluate(t){return this}substitute(t){return this}cast(t,e){let r=t.cast(this);return void 0===r&&(r=e),r}coerce(t,e){let r=t.cast(this);return void 0===r&&(r=t.unit),void 0===r&&(r=e),r}get precedence(){return 11}forEach(t,e){return t.call(e,this,0)}iterator(){return O.unary(this)}[Symbol.iterator](){return this.iterator()}interpolateTo(e){return e instanceof t?ur(this,e):null}display(t){return this.debug(t)}toString(){return St.debug(this)}static empty(){return gr.empty()}static extant(){return Pr.extant()}static absent(){return Ir.absent()}static fromLike(e){return e instanceof t?e:mr.fromLike(e)}static globalScope(){return gr.create(1).slot("math",ki.scope).commit()}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"globalScope",static:!0,private:!1,access:{has:t=>"globalScope"in t,get:t=>t.globalScope},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();const ur=function(t){const e=function(t,r){const i=function(t){return t<1?i[0]:i[1]};return Object.setPrototypeOf(i,e.prototype),i[0]=t.commit(),i[1]=r.commit(),i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class hr extends ar{constructor(){super()}isDefined(){return!0}isDistinct(){return!0}isDefinite(){return!0}toValue(){return this.value}get tag(){}get target(){return this.value}flattened(){return mr.absent()}unflattened(){return gr.of(this)}header(t){return mr.absent()}headers(t){}head(){return ar.absent()}tail(){return gr.empty()}body(){return mr.absent()}get length(){return 0}has(t){return!1}get(t){return mr.absent()}getAttr(t){return mr.absent()}getSlot(t){return mr.absent()}getField(t){}getItem(t){return ar.absent()}deleted(t){return this}conditional(t,e){return t=ar.fromLike(t)}or(t){return this}and(t){return t=ar.fromLike(t)}lambda(t){return mr.absent()}stringValue(t){return this.value.stringValue(t)}numberValue(t){return this.value.numberValue(t)}booleanValue(t){return this.value.booleanValue(t)}interpolateTo(t){return t instanceof hr?lr(this,t):super.interpolateTo(t)}static of(t,e){let r;return"string"==typeof t?r=t:t instanceof kr&&(r=t.value),void 0!==r&&64===r.charCodeAt(0)?(r=r.slice(1),1===arguments.length?cr.of(r):cr.of(r,e)):1===arguments.length?fr.of(t):fr.of(t,e)}static fromLike(t){if(t instanceof hr)return t;if("object"==typeof t&&null!==t){if(void 0!==t.$key)return hr.of(t.$key,t.$value);for(const e in t)return hr.of(e,t[e])}throw new TypeError(""+t)}}hr.ImmutableFlag=1;const lr=function(t){const e=function(t,r){const i=function(t){const e=i.keyInterpolator(t),r=i.valueInterpolator(t);return fr.of(e,r)};return Object.setPrototypeOf(i,e.prototype),i.keyInterpolator=t.key.interpolateTo(r.key),i.valueInterpolator=t.value.interpolateTo(r.value),i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){return fr.of(this.keyInterpolator[0],this.valueInterpolator[0])},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){return fr.of(this.keyInterpolator[1],this.valueInterpolator[1])},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(j);class cr extends hr{constructor(t,e,r){super(),this.key=t,this.value=e,this.flags=void 0!==r?r:0}isConstant(){return this.key.isConstant()&&this.value.isConstant()}get name(){return this.key.value}setValue(t){if(0!=(this.flags&hr.ImmutableFlag))throw new Error("immutable");const e=this.value;return this.value=t,e}updatedValue(t){return new cr(this.key,t)}bitwiseOr(t){if((t=ar.fromLike(t))instanceof Dr)return new Hr(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.bitwiseOr(t.value):t instanceof mr?this.value.bitwiseOr(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}bitwiseXor(t){if((t=ar.fromLike(t))instanceof Dr)return new Wr(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.bitwiseXor(t.value):t instanceof mr?this.value.bitwiseXor(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}bitwiseAnd(t){if((t=ar.fromLike(t))instanceof Dr)return new Xr(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.bitwiseAnd(t.value):t instanceof mr?this.value.bitwiseAnd(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}plus(t){if((t=ar.fromLike(t))instanceof Dr)return new _r(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.plus(t.value):t instanceof mr?this.value.plus(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}minus(t){if((t=ar.fromLike(t))instanceof Dr)return new ti(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.minus(t.value):t instanceof mr?this.value.minus(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}times(t){if((t=ar.fromLike(t))instanceof Dr)return new ei(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.times(t.value):t instanceof mr?this.value.times(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}divide(t){if((t=ar.fromLike(t))instanceof Dr)return new ri(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.divide(t.value):t instanceof mr?this.value.divide(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}modulo(t){if((t=ar.fromLike(t))instanceof Dr)return new ii(this,t);let e;return e=t instanceof cr&&this.key.equals(t.key)?this.value.modulo(t.value):t instanceof mr?this.value.modulo(t):mr.absent(),e.isDefined()?new cr(this.key,e):ar.absent()}not(){const t=this.value.not();return t.isDefined()?new cr(this.key,t):ar.absent()}bitwiseNot(){const t=this.value.bitwiseNot();return t.isDefined()?new cr(this.key,t):ar.absent()}negative(){const t=this.value.negative();return t.isDefined()?new cr(this.key,t):ar.absent()}positive(){const t=this.value.positive();return t.isDefined()?new cr(this.key,t):ar.absent()}inverse(){const t=this.value.inverse();return t.isDefined()?new cr(this.key,t):ar.absent()}evaluate(t){t=Rr.fromLike(t);const e=this.key.evaluate(t).toValue(),r=this.value.evaluate(t).toValue();return e===this.key&&r===this.value?this:e.isDefined()&&r.isDefined()?e instanceof kr?new cr(e,r):new fr(e,r):ar.absent()}substitute(t){t=Rr.fromLike(t);const e=this.key.substitute(t).toValue(),r=this.value.substitute(t).toValue();return e===this.key&&r===this.value?this:e.isDefined()&&r.isDefined()?e instanceof kr?new cr(e,r):new fr(e,r):ar.absent()}toLike(){const t={};return t["@"+this.key.value]=this.value.toLike(),t}isAliased(){return!1}isMutable(){return 0==(this.flags&hr.ImmutableFlag)}alias(){this.flags|=hr.ImmutableFlag}branch(){return 0==(this.flags&hr.ImmutableFlag)?this:new cr(this.key,this.value,this.flags&~hr.ImmutableFlag)}clone(){return new cr(this.key.clone(),this.value.clone())}commit(){return this.flags|=hr.ImmutableFlag,this.value.commit(),this}interpolateTo(t){return t instanceof cr?dr(this,t):super.interpolateTo(t)}get typeOrder(){return 1}compareTo(t){if(t instanceof cr){let e=this.key.compareTo(t.key);return 0===e&&(e=this.value.compareTo(t.value)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof cr&&(this.key.equals(t.key)&&this.value.equivalentTo(t.value,e))}keyEquals(t){return"string"==typeof t?this.key.value===t:t instanceof hr?this.key.equals(t.key):this.key.equals(t)}equals(t){return this===t||t instanceof cr&&(this.key.equals(t.key)&&this.value.equals(t.value))}hashCode(){return s.mash(s.mix(s.mix(g.hash(cr),this.key.hashCode()),this.value.hashCode()))}debug(t){return t=t.write("Attr").write(46).write("of").write(40).display(this.key),this.value instanceof Pr||(t=t.write(44).write(32).display(this.value)),t=t.write(41)}static of(t,e){return t=kr.fromLike(t),e=1===arguments.length?mr.extant():mr.fromLike(e),new cr(t,e)}}const dr=function(t){const e=function(t,r){const i=function(t){const e=i.keyInterpolator(t),r=i.valueInterpolator(t);return cr.of(e,r)};return Object.setPrototypeOf(i,e.prototype),i.keyInterpolator=t.key.interpolateTo(r.key),i.valueInterpolator=t.value.interpolateTo(r.value),i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){return cr.of(this.keyInterpolator[0],this.valueInterpolator[0])},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){return cr.of(this.keyInterpolator[1],this.valueInterpolator[1])},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(j);class fr extends hr{constructor(t,e,r){super(),this.key=t.commit(),this.value=e,this.flags=void 0!==r?r:0}isConstant(){return this.key.isConstant()&&this.value.isConstant()}setValue(t){if(0!=(this.flags&hr.ImmutableFlag))throw new Error("immutable");const e=this.value;return this.value=t,e}updatedValue(t){return new fr(this.key,t)}bitwiseOr(t){if((t=ar.fromLike(t))instanceof Dr)return new Hr(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.bitwiseOr(t.value):t instanceof mr?this.value.bitwiseOr(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}bitwiseXor(t){if((t=ar.fromLike(t))instanceof Dr)return new Wr(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.bitwiseXor(t.value):t instanceof mr?this.value.bitwiseXor(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}bitwiseAnd(t){if((t=ar.fromLike(t))instanceof Dr)return new Xr(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.bitwiseAnd(t.value):t instanceof mr?this.value.bitwiseAnd(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}plus(t){if((t=ar.fromLike(t))instanceof Dr)return new _r(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.plus(t.value):t instanceof mr?this.value.plus(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}minus(t){if((t=ar.fromLike(t))instanceof Dr)return new ti(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.minus(t.value):t instanceof mr?this.value.minus(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}times(t){if((t=ar.fromLike(t))instanceof Dr)return new ei(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.times(t.value):t instanceof mr?this.value.times(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}divide(t){if((t=ar.fromLike(t))instanceof Dr)return new ri(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.divide(t.value):t instanceof mr?this.value.divide(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}modulo(t){if((t=ar.fromLike(t))instanceof Dr)return new ii(this,t);let e;return e=t instanceof fr&&this.key.equals(t.key)?this.value.modulo(t.value):t instanceof mr?this.value.modulo(t):mr.absent(),e.isDefined()?new fr(this.key,e):ar.absent()}not(){const t=this.value.not();return t.isDefined()?new fr(this.key,t):ar.absent()}bitwiseNot(){const t=this.value.bitwiseNot();return t.isDefined()?new fr(this.key,t):ar.absent()}negative(){const t=this.value.negative();return t.isDefined()?new fr(this.key,t):ar.absent()}positive(){const t=this.value.positive();return t.isDefined()?new fr(this.key,t):ar.absent()}inverse(){const t=this.value.inverse();return t.isDefined()?new fr(this.key,t):ar.absent()}evaluate(t){t=Rr.fromLike(t);const e=this.key.evaluate(t).toValue(),r=this.value.evaluate(t).toValue();return e===this.key&&r===this.value?this:e.isDefined()&&r.isDefined()?new fr(e,r):ar.absent()}substitute(t){t=Rr.fromLike(t);const e=this.key.substitute(t).toValue(),r=this.value.substitute(t).toValue();return e===this.key&&r===this.value?this:e.isDefined()&&r.isDefined()?new fr(e,r):ar.absent()}toLike(){const t={};return this.key instanceof kr?t[this.key.value]=this.value.toLike():(t.$key=this.key.toLike(),t.$value=this.value.toLike()),t}isAliased(){return!1}isMutable(){return 0==(this.flags&hr.ImmutableFlag)}alias(){this.flags|=hr.ImmutableFlag}branch(){return 0==(this.flags&hr.ImmutableFlag)?this:new fr(this.key,this.value,this.flags&~hr.ImmutableFlag)}clone(){return new fr(this.key.clone(),this.value.clone())}commit(){return this.flags|=hr.ImmutableFlag,this.value.commit(),this}interpolateTo(t){return t instanceof fr?pr(this,t):super.interpolateTo(t)}get typeOrder(){return 2}compareTo(t){if(t instanceof fr){let e=this.key.compareTo(t.key);return 0===e&&(e=this.value.compareTo(t.value)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof fr&&(this.key.equals(t.key)&&this.value.equivalentTo(t.value,e))}keyEquals(t){return"string"==typeof t&&this.key instanceof kr?this.key.value===t:t instanceof hr?this.key.equals(t.key):this.key.equals(t)}equals(t){return this===t||t instanceof fr&&(this.key.equals(t.key)&&this.value.equals(t.value))}hashCode(){return s.mash(s.mix(s.mix(g.hash(fr),this.key.hashCode()),this.value.hashCode()))}debug(t){return t=t.write("Slot").write(46).write("of").write(40).display(this.key),this.value instanceof Pr||(t=t.write(44).write(32).display(this.value)),t=t.write(41)}static of(t,e){return t=mr.fromLike(t),e=1===arguments.length?mr.extant():mr.fromLike(e),new fr(t,e)}}const pr=function(t){const e=function(t,r){const i=function(t){const e=i.keyInterpolator(t),r=i.valueInterpolator(t);return fr.of(e,r)};return Object.setPrototypeOf(i,e.prototype),i.keyInterpolator=t.key.interpolateTo(r.key),i.valueInterpolator=t.value.interpolateTo(r.value),i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){return fr.of(this.keyInterpolator[0],this.valueInterpolator[0])},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){return fr.of(this.keyInterpolator[1],this.valueInterpolator[1])},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(j);class mr extends ar{constructor(){super()}isDefined(){return!0}isDistinct(){return!0}isDefinite(){return!0}get key(){return mr.absent()}toValue(){return this}get tag(){}get target(){return this}flattened(){return this}unflattened(){return gr.of(this)}header(t){return mr.absent()}headers(t){}head(){return ar.absent()}tail(){return gr.empty()}body(){return mr.extant()}get length(){return 0}has(t){return!1}get(t){return mr.absent()}getAttr(t){return mr.absent()}getSlot(t){return mr.absent()}getField(t){}getItem(t){return ar.absent()}deleted(t){return this}conditional(t,e){return t=ar.fromLike(t)}or(t){return this}and(t){return t=ar.fromLike(t)}bitwiseOr(t){if((t=ar.fromLike(t))instanceof Dr)return new Hr(this,t);if(t instanceof cr){const e=this.bitwiseOr(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.bitwiseOr(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}bitwiseXor(t){if((t=ar.fromLike(t))instanceof Dr)return new Wr(this,t);if(t instanceof cr){const e=this.bitwiseXor(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.bitwiseXor(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}bitwiseAnd(t){if((t=ar.fromLike(t))instanceof Dr)return new Xr(this,t);if(t instanceof cr){const e=this.bitwiseAnd(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.bitwiseAnd(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}lt(t){return(t=ar.fromLike(t))instanceof Dr?new Kr(this,t):super.lt(t)}le(t){return(t=ar.fromLike(t))instanceof Dr?new Gr(this,t):super.le(t)}eq(t){return(t=ar.fromLike(t))instanceof Dr?new Zr(this,t):super.eq(t)}ne(t){return(t=ar.fromLike(t))instanceof Dr?new Qr(this,t):super.ne(t)}ge(t){return(t=ar.fromLike(t))instanceof Dr?new Jr(this,t):super.ge(t)}gt(t){return(t=ar.fromLike(t))instanceof Dr?new $r(this,t):super.gt(t)}plus(t){if((t=ar.fromLike(t))instanceof Dr)return new _r(this,t);if(t instanceof cr){const e=this.plus(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.plus(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}minus(t){if((t=ar.fromLike(t))instanceof Dr)return new ti(this,t);if(t instanceof cr){const e=this.minus(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.minus(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}times(t){if((t=ar.fromLike(t))instanceof Dr)return new ei(this,t);if(t instanceof cr){const e=this.times(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.times(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}divide(t){if((t=ar.fromLike(t))instanceof Dr)return new ri(this,t);if(t instanceof cr){const e=this.divide(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.divide(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}modulo(t){if((t=ar.fromLike(t))instanceof Dr)return new ii(this,t);if(t instanceof cr){const e=this.modulo(t.value);if(e.isDefined())return new cr(t.key,e)}else if(t instanceof fr){const e=this.modulo(t.value);if(e.isDefined())return new fr(t.key,e)}return ar.absent()}not(){return mr.absent()}bitwiseNot(){return mr.absent()}negative(){return mr.absent()}positive(){return mr.absent()}inverse(){return mr.absent()}lambda(t){return new Si(this,t)}stringValue(t){return t}numberValue(t){return t}booleanValue(t){return t}isAliased(){return!1}isMutable(){return!1}alias(){}branch(){return this}clone(){return this}commit(){return this}interpolateTo(t){return super.interpolateTo(t)}keyEquals(t){return!1}static builder(){return new yr}static empty(){return gr.empty()}static extant(){return Pr.extant()}static absent(){return Ir.absent()}static fromLike(t){if(t instanceof mr)return t;if(t instanceof ar)return gr.create(1).item(t);if(void 0===t)return Ir.absent();if(null===t)return Pr.extant();if("boolean"==typeof t)return Tr.from(t);if("number"==typeof t)return Or.from(t);if("string"==typeof t)return kr.from(t);if(t instanceof Uint8Array)return Sr.wrap(t);if(Array.isArray(t))return gr.fromArray(t);if("object"==typeof t)return gr.fromObject(t);throw new TypeError(""+t)}}class yr{constructor(){this.record=null,this.value=null}push(...t){for(let e=0;e<t.length;e+=1){const r=t[e];if(r instanceof hr)return this.pushField(r);if(r instanceof mr)return this.pushValue(r);throw new TypeError(""+r)}}pushField(t){null===this.record&&(this.record=gr.create(),null!==this.value&&(this.record.push(this.value),this.value=null)),this.record.push(t)}pushValue(t){null!==this.record?this.record.push(t):null===this.value?this.value=t:(this.record=gr.create(),this.record.push(this.value),this.value=null,this.record.push(t))}build(){return null!==this.record?this.record:null!==this.value?this.value:mr.absent()}}class gr extends mr{constructor(){super()}isDefinite(){return!this.isEmpty()}isArray(){return 0===this.fieldCount}isObject(){return 0===this.valueCount}get valueCount(){let t=0;return this.forEach((function(e){e instanceof mr&&(t+=1)}),this),t}isConstant(){return void 0===this.forEach((function(t){return!!t.isConstant()&&void 0}),this)}get tag(){const t=this.head();if(t instanceof cr)return t.key.value}get target(){let t,e,r=!1;return this.forEach((function(i){i instanceof cr?r=!0:void 0===t&&i instanceof mr?t=i:(void 0===e&&(e=gr.create(),void 0!==t&&e.push(t)),e.push(i))}),this),void 0===t?mr.extant():void 0===e?t:r?e:this}flattened(){if(this.isEmpty())return mr.extant();const t=this.iterator(),e=t.head();return t.step(),t.isEmpty()&&e instanceof mr?e:this.branch()}unflattened(){return this}header(t){const e=this.head();return e instanceof cr&&e.key.value===t?e.value:mr.absent()}headers(t){const e=this.head();if(!(e instanceof cr)||e.key.value!==t)return;const r=e.value;return r instanceof gr?r:gr.of(r)}head(){return this.forEach((function(t){return t}),this)||ar.absent()}tail(){const t=gr.create();return this.forEach((function(e,r){r>0&&t.push(e)}),this),t}body(){const t=this.tail();return t.isEmpty()?mr.absent():t.flattened()}has(t){return t=mr.fromLike(t),this.forEach((function(e){return!!(e instanceof hr&&e.key.equals(t))||void 0}),this)||!1}indexOf(t,e=0){t=ar.fromLike(t),e<0&&(e=Math.max(0,this.length+e));const r=this.forEach((function(r,i){return i>=e&&t.equals(r)?i:void 0}),this);return void 0!==r?r:-1}lastIndexOf(t,e){t=ar.fromLike(t);const r=this.length;for(void 0===e?e=r-1:e<0&&(e=r+e),e=Math.min(e,r-1);e>=0;){if(t.equals(this.getItem(e)))return e;e-=1}return-1}get(t){return t=mr.fromLike(t),this.forEach((function(e){return e instanceof hr&&e.key.equals(t)?e.value:void 0}),this)||mr.absent()}getAttr(t){return t=kr.fromLike(t),this.forEach((function(e){return e instanceof cr&&e.key.equals(t)?e.value:void 0}),this)||mr.absent()}getSlot(t){return t=mr.fromLike(t),this.forEach((function(e){return e instanceof fr&&e.key.equals(t)?e.value:void 0}),this)||mr.absent()}getField(t){return t=mr.fromLike(t),this.forEach((function(e){return e instanceof hr&&e.key.equals(t)?e:void 0}),this)}set(t,e){t=mr.fromLike(t),e=mr.fromLike(e);const r=this.iterator();for(;!r.isEmpty();){const i=r.head();if(i instanceof hr&&i.key.equals(t))return i.isMutable()?i.setValue(e):r.set(i.updatedValue(e)),this;r.step()}return this.push(new fr(t,e)),this}setAttr(t,e){t=kr.fromLike(t),e=mr.fromLike(e);const r=this.iterator();for(;!r.isEmpty();){const i=r.head();if(i instanceof hr&&i.key.equals(t))return i instanceof cr&&i.isMutable()?i.setValue(e):r.set(new cr(t,e)),this;r.step()}return this.push(new cr(t,e)),this}setSlot(t,e){t=mr.fromLike(t),e=mr.fromLike(e);const r=this.iterator();for(;!r.isEmpty();){const i=r.head();if(i instanceof hr&&i.key.equals(t))return i instanceof fr&&i.isMutable()?i.setValue(e):r.set(new fr(t,e)),this;r.step()}return this.push(new fr(t,e)),this}updated(t,e){t=mr.fromLike(t),e=mr.fromLike(e);const r=this.isMutable()?this:this.branch(),i=r.iterator();for(;!i.isEmpty();){const n=i.head();if(n.key.equals(t))return n instanceof hr&&n.isMutable()?n.setValue(e):i.set(new fr(t,e)),r;i.step()}return r.push(new fr(t,e)),r}updatedAttr(t,e){t=kr.fromLike(t),e=mr.fromLike(e);const r=this.isMutable()?this:this.branch(),i=r.iterator();for(;!i.isEmpty();){const n=i.head();if(n.key.equals(t))return n instanceof cr&&n.isMutable()?n.setValue(e):i.set(new cr(t,e)),r;i.step()}return r.push(new cr(t,e)),r}updatedSlot(t,e){t=mr.fromLike(t),e=mr.fromLike(e);const r=this.isMutable()?this:this.branch(),i=r.iterator();for(;!i.isEmpty();){const n=i.head();if(n.key.equals(t))return n instanceof fr&&n.isMutable()?n.setValue(e):i.set(new fr(t,e)),r;i.step()}return r.push(new fr(t,e)),r}appended(...t){const e=this.isMutable()?this:this.branch();return e.push(...t),e}prepended(...t){const e=this.isMutable()?this:this.branch();return e.splice(0,0,...t),e}deleted(t){const e=this.isMutable()?this:this.branch();return e.delete(t),e}concat(...t){const e=this.isMutable()?this:this.branch();for(let r=0;r<t.length;r+=1)ar.fromLike(t[r]).forEach((function(t){e.push(t)}));return e}slice(t,e){return this.subRecord(t,e).branch()}attr(t,e){let r;return r=1===arguments.length?cr.of(t):cr.of(t,e),this.push(r),this}slot(t,e){let r;return r=1===arguments.length?fr.of(t):fr.of(t,e),this.push(r),this}item(t){return this.push(t),this}items(...t){return this.push(this,...t),this}evaluate(t){t=Rr.fromLike(t);const e=gr.create();t.pushScope(e);let r=!1;return this.forEach((function(i){const n=i.evaluate(t);n.isDefined()&&e.push(n),i!==n&&(r=!0)}),this),t.popScope(),r?e:this}substitute(t){t=Rr.fromLike(t);const e=gr.create();t.pushScope(e);let r=!1;return this.forEach((function(i){const n=i.substitute(t);n.isDefined()&&e.push(n),i!==n&&(r=!0)}),this),t.popScope(),r?e:this}stringValue(t){let e="";return void 0===this.forEach((function(t){if(t instanceof mr){const r=t.stringValue();if(void 0!==r)return void(e+=r)}return null}),this)?e:void 0}toLike(){return!this.isEmpty()&&this.isArray()?this.toArray():this.toObject()}toArray(){const t=new Array(this.length);return this.forEach((function(e,r){e instanceof mr?t[r]=e.toLike():e instanceof hr&&(t[r]={$key:e.key.toLike(),$value:e.value.toLike()})}),this),t}toObject(){const t={};return this.forEach((function(e,r){e instanceof cr?t["@"+e.key.value]=e.value.toLike():e instanceof fr?e.key instanceof kr?t[e.key.value]=e.value.toLike():t["$"+r]={$key:e.key.toLike(),$value:e.value.toLike()}:e instanceof mr&&(t["$"+r]=e.toLike())}),this),t}isAliased(){return!1}isMutable(){return!0}alias(){}branch(){const t=gr.create();return this.forEach((function(e){t.push(e)}),this),t}clone(){const t=gr.create();return this.forEach((function(e){t.push(e.clone())}),this),t}commit(){return this}build(){return this}subRecord(t,e){const r=this.length;void 0===t?t=0:t<0&&(t=r+t),t=Math.min(Math.max(0,t),r),void 0===e?e=r:e<0&&(e=r+e);const i=gr.create();return this.forEach((function(r,n){return n<t?void 0:n<e?void i.push(r):null}),this),i}iterator(){return new br(this)}interpolateTo(t){return t instanceof gr?wr(this,t):super.interpolateTo(t)}get typeOrder(){return 3}compareTo(t){if(t instanceof gr){const e=this.iterator(),r=t.iterator();let i=0;do{if(e.isEmpty()||r.isEmpty())break;i=e.head().compareTo(r.head()),e.step(),r.step()}while(0===i);return 0!==i?i:e.isEmpty()&&!r.isEmpty()?-1:!e.isEmpty()&&r.isEmpty()?1:0}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){if(this===t)return!0;if(t instanceof gr){const r=this.iterator(),i=t.iterator();for(;!r.isEmpty()&&!i.isEmpty();){if(!r.head().equivalentTo(i.head(),e))return!1;r.step(),i.step()}return r.isEmpty()&&i.isEmpty()}return!1}equals(t){if(this===t)return!0;if(t instanceof gr){const e=this.iterator(),r=t.iterator();for(;!e.isEmpty()&&!r.isEmpty();){if(!e.head().equals(r.head()))return!1;e.step(),r.step()}return e.isEmpty()&&r.isEmpty()}return!1}hashCode(){let t=g.hash(gr);return this.forEach((function(e){t=s.mix(t,e.hashCode())}),this),t}debug(t){return t=t.write("Record").write(46),this.isEmpty()?t=t.write("empty").write(40).write(41):(t=t.write("of").write(40),this.forEach((function(e,r){0!==r&&(t=t.write(44).write(32)),t=t.display(e)}),this),t=t.write(41)),t}static empty(){return vr.empty()}static create(t){return vr.create(t)}static of(...t){return vr.of(...t)}static fromLike(t){if(t instanceof gr)return t;if(Array.isArray(t))return gr.fromArray(t);if("object"==typeof t&&null!==t)return gr.fromObject(t);throw new TypeError(""+t)}static fromArray(t){const e=t.length||0,r=gr.create(e);for(let i=0;i<e;i+=1)r.push(ar.fromLike(t[i]));return r}static fromObject(t){const e=gr.create();for(const r in t){const i=t[r];36===r.charCodeAt(0)?i&&"object"==typeof i&&Object.prototype.hasOwnProperty.call(i,"$key")?e.push(hr.of(i.$key,i.$value)):e.push(mr.fromLike(i)):e.push(hr.of(r,i))}return e}static expand(t){return t=Math.max(8,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}}gr.AliasedFlag=1,gr.ImmutableFlag=2,Object.defineProperty(gr.prototype,"fieldCount",{get(){let t=0;return this.forEach((function(e){e instanceof hr&&(t+=1)}),this),t},configurable:!0});const wr=function(t){const e=function(t,r){const i=function(t){const e=i.interpolators,r=e.length,n=gr.create(r);for(let i=0;i<r;i+=1)n.push(e[i](t));return n};Object.setPrototypeOf(i,e.prototype);const n=Math.min(t.length,r.length),s=new Array(n);for(let e=0;e<n;e+=1)s[e]=t.getItem(e).interpolateTo(r.getItem(e));return i.interpolators=s,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.interpolators,e=t.length,r=gr.create(e);for(let i=0;i<e;i+=1)r.push(t[i][0]);return r},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.interpolators,e=t.length,r=gr.create(e);for(let i=0;i<e;i+=1)r.push(t[i][1]);return r},configurable:!0}),e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){const e=this.interpolators.length;if(e===t.interpolators.length){for(let r=0;r<e;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1},e}(j);class br extends O{constructor(t,e,r,i){super(),void 0===e&&(e=0),void 0===r&&(r=t.length),void 0===i&&(i=e),this.record=t,this.lower=e,this.upper=r,this.index=i,this.direction=0}isEmpty(){return this.index>=this.upper}head(){if(this.direction=0,this.index>=this.upper)throw new Error("empty");return this.record.getItem(this.index)}step(){this.direction=0;const t=this.index;if(t>=this.upper)throw new Error("empty");this.index=t+1}skip(t){this.index=Math.min(Math.max(this.lower,this.index+t,this.upper))}hasNext(){return this.index<this.upper}nextIndex(){return this.index-this.lower}next(){this.direction=1;const t=this.index;return t>=this.upper?(this.index=this.upper,{done:!0,value:void 0}):(this.index=t+1,{done:this.index===this.upper,value:this.record.getItem(t)})}hasPrevious(){return this.index>this.lower}previousIndex(){return this.index-this.lower-1}previous(){this.direction=-1;const t=this.index-1;return t<this.lower?(this.index=0,{done:!0,value:void 0}):(this.index=t,{done:t===this.lower,value:this.record.getItem(t)})}set(t){this.direction>0?this.record.setItem(this.index-1,t):this.record.setItem(this.index,t)}delete(){let t=this.index;this.direction>0&&(t-=1,this.index=t),this.record.splice(t,1),this.direction=0}}let vr=(()=>{var t;let i,n=gr,s=[];return t=class extends n{constructor(t,e,r,i,n){super(),this.array=t,this.table=e,Object.defineProperty(this,"length",{value:r,writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:i,writable:!0,enumerable:!0,configurable:!0}),this.flags=n}isEmpty(){return 0===this.length}get valueCount(){return this.length-this.fieldCount}isConstant(){const t=this.array;for(let e=0;e<this.length;e+=1)if(!t[e].isConstant())return!1;return!0}get tag(){if(0===this.fieldCount)return;const t=this.array[0];return t instanceof cr?t.key.value:void 0}get target(){let t,e,r=!1;const i=this.array;for(let n=0;n<this.length;n+=1){const s=i[n];s instanceof cr?r=!0:void 0===t&&s instanceof mr?t=s:(void 0===e&&(e=gr.create(),void 0!==t&&e.push(t)),e.push(s))}return void 0===t?mr.extant():void 0===e?t:r?e:this}head(){return 0===this.length?ar.absent():this.array[0]}tail(){const t=this.length;return 0===t?gr.empty():new xr(this,1,t)}body(){const t=this.length;if(0===t||1===t)return mr.absent();if(2===t){const t=this.array[1];return t instanceof mr?t:gr.of(t)}return new xr(this,1,t).branch()}has(t){if(0===this.fieldCount)return!1;t=mr.fromLike(t);const e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r);let n=i;do{const i=e[n];if(void 0===i)break;if(i.key.equals(t))return!0;n=(n+1)%r}while(n!==i);return!1}indexOf(t,e=0){t=ar.fromLike(t);const r=this.array,i=this.length;for(e<0&&(e=Math.max(0,i+e));e<i;){if(t.equals(r[e]))return e;e+=1}return-1}lastIndexOf(t,e){t=ar.fromLike(t);const r=this.array,i=this.length;for(void 0===e?e=i-1:e<0&&(e=i+e),e=Math.min(e,i-1);e>=0;){if(t.equals(r[e]))return e;e-=1}return-1}get(t){if(0===this.fieldCount)return mr.absent();t=mr.fromLike(t);const e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r);let n=i;do{const i=e[n];if(void 0===i)break;if(i.key.equals(t))return i.value;n=(n+1)%r}while(n!==i);return mr.absent()}getAttr(t){if(0===this.fieldCount)return mr.absent();t=kr.fromLike(t);const e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r);let n=i;do{const i=e[n];if(void 0===i)break;if(i instanceof cr&&i.key.equals(t))return i.value;n=(n+1)%r}while(n!==i);return mr.absent()}getSlot(t){if(0===this.fieldCount)return mr.absent();t=mr.fromLike(t);const e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r);let n=i;do{const i=e[n];if(void 0===i)break;if(i instanceof fr&&i.key.equals(t))return i.value;n=(n+1)%r}while(n!==i);return mr.absent()}getField(t){if(0===this.fieldCount)return;t=mr.fromLike(t);const e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r);let n=i;do{const i=e[n];if(void 0===i)break;if(i.key.equals(t))return i;n=(n+1)%r}while(n!==i)}getItem(t){t instanceof Or&&(t=t.value);const e=this.length;return t<0&&(t=e+t),t<0||t>=e?ar.absent():this.array[t]}set(t,e){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");return t=mr.fromLike(t),e=mr.fromLike(e),0!=(this.flags&gr.AliasedFlag)?this.fieldCount>0?this.setAliased(t,e):this.pushAliased(new fr(t,e)):this.fieldCount>0?null!==this.table?this.setMutable(t,e):this.updateMutable(t,e):this.pushMutable(new fr(t,e)),this}setAliased(t,e){const r=this.length,i=this.array,n=new Array(gr.expand(r+1));for(let s=0;s<r;s+=1){const o=i[s];if(o instanceof hr&&o.key.equals(t)){for(n[s]=o.updatedValue(e),s+=1;s<r;)n[s]=i[s],s+=1;return this.array=n,this.table=null,void(this.flags&=~gr.AliasedFlag)}n[s]=o}n[r]=new fr(t,e),this.array=n,this.table=null,this.length=r+1,this.fieldCount+=1,this.flags&=~gr.AliasedFlag}setMutable(e,r){const i=this.table,n=i.length,s=Math.abs(e.hashCode()%n);let o=s;do{const t=i[o];if(void 0===t)break;if(t.key.equals(e))return void(t.isMutable()?t.setValue(r):this.updateMutable(e,r));o=(o+1)%n}while(o!==s);const a=new fr(e,r);this.pushMutable(a),t.put(i,a)}updateMutable(e,r){const i=this.array;for(let t=0;t<this.length;t+=1){const n=i[t];if(n instanceof hr&&n.key.equals(e))return i[t]=n.updatedValue(r),void(this.table=null)}const n=new fr(e,r);this.pushMutable(n),t.put(this.table,n)}setAttr(t,e){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");return t=kr.fromLike(t),e=mr.fromLike(e),0!=(this.flags&gr.AliasedFlag)?this.fieldCount>0?this.setAttrAliased(t,e):this.pushAliased(new cr(t,e)):this.fieldCount>0?null!==this.table?this.setAttrMutable(t,e):this.updateAttrMutable(t,e):this.pushMutable(new cr(t,e)),this}setAttrAliased(t,e){const r=this.length,i=this.array,n=new Array(gr.expand(r+1));for(let s=0;s<r;s+=1){const o=i[s];if(o instanceof hr&&o.key.equals(t)){for(n[s]=new cr(t,e),s+=1;s<r;)n[s]=i[s],s+=1;return this.array=n,this.table=null,void(this.flags&=~gr.AliasedFlag)}n[s]=o}n[r]=new cr(t,e),this.array=n,this.table=null,this.length=r+1,this.fieldCount+=1,this.flags&=~gr.AliasedFlag}setAttrMutable(e,r){const i=this.table,n=i.length,s=Math.abs(e.hashCode()%n);let o=s;do{const t=i[o];if(void 0===t)break;if(t.key.equals(e))return void(t instanceof cr&&t.isMutable()?t.setValue(r):this.updateAttrMutable(e,r));o=(o+1)%n}while(o!==s);const a=new cr(e,r);this.push(a),t.put(i,a)}updateAttrMutable(e,r){const i=this.array;for(let t=0;t<this.length;t+=1){const n=i[t];if(n instanceof hr&&n.key.equals(e))return i[t]=new cr(e,r),void(this.table=null)}const n=new cr(e,r);this.push(n),t.put(this.table,n)}setSlot(t,e){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");return t=mr.fromLike(t),e=mr.fromLike(e),0!=(this.flags&gr.AliasedFlag)?this.fieldCount>0?this.setSlotAliased(t,e):this.pushAliased(new fr(t,e)):this.fieldCount>0?null!==this.table?this.setSlotMutable(t,e):this.updateSlotMutable(t,e):this.pushMutable(new fr(t,e)),this}setSlotAliased(t,e){const r=this.length,i=this.array,n=new Array(gr.expand(r+1));for(let s=0;s<r;s+=1){const o=i[s];if(o instanceof hr&&o.key.equals(t)){for(n[s]=new fr(t,e),s+=1;s<r;)n[s]=i[s],s+=1;return this.array=n,this.table=null,void(this.flags&=~gr.AliasedFlag)}n[s]=o}n[r]=new fr(t,e),this.array=n,this.table=null,this.length=r+1,this.fieldCount+=1,this.flags&=~gr.AliasedFlag}setSlotMutable(e,r){const i=this.table,n=i.length,s=Math.abs(e.hashCode()%n);let o=s;do{const t=i[o];if(void 0===t)break;if(t.key.equals(e))return void(t instanceof fr&&t.isMutable()?t.setValue(r):this.updateSlotMutable(e,r));o=(o+1)%n}while(o!==s);const a=new fr(e,r);this.push(a),t.put(i,a)}updateSlotMutable(e,r){const i=this.array;for(let t=0;t<this.length;t+=1){const n=i[t];if(n instanceof hr&&n.key.equals(e))return i[t]=new fr(e,r),void(this.table=null)}const n=new fr(e,r);this.push(n),t.put(this.table,n)}setItem(t,e){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");e=ar.fromLike(e);const r=this.length;if(t<0&&(t=r+t),t<0||t>r)throw new RangeError(""+t);return 0!=(this.flags&gr.AliasedFlag)?this.setItemAliased(t,e):this.setItemMutable(t,e),this}setItemAliased(t,e){const r=this.length,i=this.array,n=new Array(gr.expand(r));for(let t=0;t<r;t+=1)n[t]=i[t];const s=i[t];n[t]=e,this.array=n,this.table=null,e instanceof hr?s instanceof hr||(this.fieldCount+=1):s instanceof hr&&(this.fieldCount-=1),this.flags&=~gr.AliasedFlag}setItemMutable(t,e){const r=this.array,i=r[t];r[t]=e,e instanceof hr?(this.table=null,i instanceof hr||(this.fieldCount+=1)):i instanceof hr&&(this.table=null,this.fieldCount-=1)}updated(t,e){t=mr.fromLike(t),e=mr.fromLike(e);const r=0==(this.flags&gr.ImmutableFlag)?this:this.branch();return 0!=(r.flags&gr.AliasedFlag)?r.fieldCount>0?r.setAliased(t,e):r.pushAliased(new fr(t,e)):r.fieldCount>0?null!==r.table?r.setMutable(t,e):r.updateMutable(t,e):r.pushMutable(new fr(t,e)),r}updatedAttr(t,e){t=kr.fromLike(t),e=mr.fromLike(e);const r=0==(this.flags&gr.ImmutableFlag)?this:this.branch();return 0!=(r.flags&gr.AliasedFlag)?r.fieldCount>0?r.setAttrAliased(t,e):r.pushAliased(new cr(t,e)):r.fieldCount>0?null!==r.table?r.setAttrMutable(t,e):r.updateAttrMutable(t,e):r.pushMutable(new cr(t,e)),r}updatedSlot(t,e){t=mr.fromLike(t),e=mr.fromLike(e);const r=0==(this.flags&gr.ImmutableFlag)?this:this.branch();return 0!=(r.flags&gr.AliasedFlag)?r.fieldCount>0?r.setSlotAliased(t,e):r.pushAliased(new fr(t,e)):r.fieldCount>0?null!==r.table?r.setSlotMutable(t,e):r.updateSlotMutable(t,e):r.pushMutable(new fr(t,e)),r}push(...t){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");return 0!=(this.flags&gr.AliasedFlag)?this.pushAliased(...t):this.pushMutable(...t),this.length}pushAliased(...t){const e=t.length;let r=this.length,i=this.fieldCount;const n=this.array,s=new Array(gr.expand(r+e));if(null!==n)for(let t=0;t<r;t+=1)s[t]=n[t];for(let n=0;n<e;n+=1){const e=ar.fromLike(t[n]);s[r]=e,r+=1,e instanceof hr&&(i+=1)}this.array=s,this.table=null,this.length=r,this.fieldCount=i,this.flags&=~gr.AliasedFlag}pushMutable(...t){const e=t.length;let r=this.length,i=this.fieldCount;const n=this.array;let s;if(null===n||r+e>n.length){if(s=new Array(gr.expand(r+e)),null!==n)for(let t=0;t<r;t+=1)s[t]=n[t]}else s=n;for(let n=0;n<e;n+=1){const e=ar.fromLike(t[n]);s[r]=e,r+=1,e instanceof hr&&(i+=1,this.table=null)}this.array=s,this.length=r,this.fieldCount=i}splice(t,e=0,...r){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");const i=this.length;return t<0&&(t=i+t),t=Math.min(Math.max(0,t),i),e=Math.min(Math.max(0,e),i-t),0!=(this.flags&gr.AliasedFlag)?this.spliceAliased(t,e,...r):this.spliceMutable(t,e,...r)}spliceAliased(t,e,...r){const i=r.length;let n=this.length,s=this.fieldCount;const o=this.array,a=new Array(gr.expand(n-e+i));for(let e=0;e<t;e+=1)a[e]=o[e];const u=[];for(let r=t;r<t+e;r+=1){const t=o[r];u.push(t),n-=1,t instanceof hr&&(s-=1)}for(let r=t;r<n;r+=1)a[r+i]=o[r+e];for(let e=0;e<i;e+=1){const i=ar.fromLike(r[e]);a[e+t]=i,n+=1,i instanceof hr&&(s+=1)}return this.array=a,this.table=null,this.length=n,this.fieldCount=s,this.flags&=~gr.AliasedFlag,u}spliceMutable(t,e,...r){const i=r.length;let n=this.length,s=this.fieldCount;const o=this.array;let a;if(null===o||n-e+i>o.length){if(a=new Array(gr.expand(n-e+i)),null!==o)for(let e=0;e<t;e+=1)a[e]=o[e]}else a=o;const u=[];for(let r=t;r<t+e;r+=1){const t=o[r];u.push(t),n-=1,t instanceof hr&&(s-=1)}if(i>e)for(let r=n-1;r>=t;r-=1)a[r+i]=o[r+e];else for(let r=t;r<n;r+=1)a[r+i]=o[r+e];for(let e=0;e<i;e+=1){const i=ar.fromLike(r[e]);a[e+t]=i,n+=1,i instanceof hr&&(s+=1)}return this.array=a,this.length=n,this.fieldCount=s,u}delete(t){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");return t=mr.fromLike(t),0!=(this.flags&gr.AliasedFlag)?this.deleteAliased(t):this.deleteMutable(t)}deleteAliased(t){const e=this.length,r=this.array,i=new Array(gr.expand(e));for(let n=0;n<e;n+=1){const s=r[n];if(s instanceof hr&&s.key.equals(t)){for(let t=n+1;t<e;t+=1,n+=1)i[n]=r[t];return this.array=i,this.table=null,this.length=e-1,this.fieldCount-=1,this.flags&=~gr.AliasedFlag,s}i[n]=s}return ar.absent()}deleteMutable(t){const e=this.length,r=this.array;for(let i=0;i<e;i+=1){const n=r[i];if(n instanceof hr&&n.key.equals(t)){for(let t=i+1;t<e;t+=1,i+=1)r[i]=r[t];return r[e-1]=void 0,this.table=null,this.length=e-1,this.fieldCount-=1,n}}return ar.absent()}clear(){if(0!=(this.flags&gr.ImmutableFlag))throw new Error("immutable");this.array=null,this.table=null,this.length=0,this.fieldCount=0,this.flags=0}isAliased(){return 0!=(this.flags&gr.AliasedFlag)}isMutable(){return 0==(this.flags&gr.ImmutableFlag)}alias(){this.flags|=gr.AliasedFlag}branch(){if(0==(this.flags&(gr.AliasedFlag|gr.ImmutableFlag))){const t=this.array;for(let e=0;e<this.length;e+=1)t[e].alias()}return this.flags|=gr.AliasedFlag,new t(this.array,this.table,this.length,this.fieldCount,gr.AliasedFlag)}clone(){const e=this.length,r=this.array,i=new Array(e);for(let t=0;t<e;t+=1)i[t]=r[t].clone();return new t(i,null,e,this.fieldCount,0)}commit(){if(0!=(this.flags&gr.ImmutableFlag))return this;this.flags|=gr.ImmutableFlag;const t=this.array;for(let e=0;e<this.length;e+=1)t[e].commit();return this}hashTable(){const e=this.fieldCount;let r=this.table;if(0!==e&&null===r){r=new Array(gr.expand(Math.max(e,10*e/7)));const i=this.array;for(let e=0;e<this.length;e+=1){const n=i[e];n instanceof hr&&t.put(r,n)}this.table=r}return r}static put(t,e){if(null===t)return;const r=t.length,i=Math.abs(e.key.hashCode()%r);let n=i;do{const i=t[n];if(void 0===i||e.key.equals(i.key))return void(t[n]=e);n=(n+1)%r}while(n!==i);throw new Error}evaluate(t){t=Rr.fromLike(t);const e=this.array,r=this.length,i=gr.create(r);t.pushScope(i);let n=!1;for(let s=0;s<r;s+=1){const r=e[s],o=r.evaluate(t);o.isDefined()&&i.push(o),r!==o&&(n=!0)}return t.popScope(),n?i:this}substitute(t){t=Rr.fromLike(t);const e=this.array,r=this.length,i=gr.create(r);t.pushScope(i);let n=!1;for(let s=0;s<r;s+=1){const r=e[s],o=r.substitute(t);o.isDefined()&&i.push(o),r!==o&&(n=!0)}return t.popScope(),n?i:this}subRecord(t,e){const r=this.length;if(void 0===t?t=0:t<0&&(t=r+t),void 0===e?e=r:e<0&&(e=r+e),t<0||e>r||t>e)throw new RangeError(t+", "+e);return new xr(this,t,e)}forEach(t,e){const r=this.array;for(let i=0;i<this.length;i+=1){const n=t.call(e,r[i],i);if(void 0!==n)return n}}static empty(){return new t(null,null,0,0,gr.AliasedFlag|gr.ImmutableFlag)}static create(e){return void 0===e?new t(null,null,0,0,gr.AliasedFlag):new t(new Array(e),null,0,0,0)}static of(...e){const r=e.length;if(0===r)return new t(null,null,0,0,gr.AliasedFlag);const i=new Array(r);let n=0,s=0;for(let t=0;t<r;t+=1){const r=ar.fromLike(e[t]);i[t]=r,n+=1,r instanceof hr&&(s+=1)}return new t(i,null,n,s,0)}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class xr extends gr{constructor(t,e,r){super(),this.record=t,this.lower=e,this.upper=r}isEmpty(){return this.lower===this.upper}isArray(){const t=this.record.array;for(let e=this.lower;e<this.upper;e+=1)if(t[e]instanceof hr)return!1;return!0}isObject(){const t=this.record.array;for(let e=this.lower;e<this.upper;e+=1)if(t[e]instanceof mr)return!1;return!0}get length(){return this.upper-this.lower}get valueCount(){let t=0;const e=this.record.array;for(let r=this.lower;r<this.upper;r+=1)e[r]instanceof mr&&(t+=1);return t}isConstant(){const t=this.record.array;for(let e=this.lower;e<this.upper;e+=1)if(!t[e].isConstant())return!1;return!0}get tag(){if(0===this.length)return;const t=this.record.array[this.lower];return t instanceof cr?t.key.value:void 0}get target(){let t,e,r=!1;const i=this.record.array;for(let n=this.lower;n<this.upper;n+=1){const s=i[n];s instanceof cr?r=!0:void 0===t&&s instanceof mr?t=s:(void 0===e&&(e=gr.create(),void 0!==t&&e.push(t)),e.push(s))}return void 0===t?mr.extant():void 0===e?t:r?e:this}head(){return 0===this.length?ar.absent():this.record.array[this.lower]}tail(){return 0===this.length?gr.empty():new xr(this.record,this.lower+1,this.upper)}body(){const t=this.length;if(0===t||1===t)return mr.absent();if(2===t){const t=this.record.array[this.lower+1];return t instanceof mr?t:gr.of(t)}return new xr(this.record,this.lower+1,this.upper).branch()}indexOf(t,e=0){t=ar.fromLike(t);const r=this.record.array,i=this.length;for(e<0&&(e=Math.max(0,i+e)),e=this.lower+e;e<this.upper;){if(t.equals(r[e]))return e-this.lower;e+=1}return-1}lastIndexOf(t,e){t=ar.fromLike(t);const r=this.record.array,i=this.length;for(void 0===e?e=i-1:e<0&&(e=i+e),e=this.lower+Math.min(e,i-1);e>=this.lower;){if(t.equals(r[e]))return e-this.lower;e-=1}return-1}getItem(t){t instanceof Or&&(t=t.value);const e=this.length;return t<0&&(t=e+t),t<0||t>=e?ar.absent():this.record.array[this.lower+t]}setItem(t,e){if(0!=(this.record.flags&gr.ImmutableFlag))throw new Error("immutable");e=ar.fromLike(e);const r=this.length;if(t<0&&(t=r+t),t<0||t>r)throw new RangeError(""+t);return 0!=(this.record.flags&gr.AliasedFlag)?this.setItemAliased(t,e):this.setItemMutable(t,e),this}setItemAliased(t,e){const r=this.record,i=r.length,n=r.array,s=new Array(gr.expand(i));for(let t=0;t<i;t+=1)s[t]=n[t];const o=null!==n?n[this.lower+t]:null;s[this.lower+t]=e,r.array=s,r.table=null,e instanceof hr?o instanceof hr||(r.fieldCount+=1):o instanceof hr&&(r.fieldCount-=1),r.flags&=~gr.AliasedFlag}setItemMutable(t,e){const r=this.record,i=r.array,n=i[this.lower+t];i[this.lower+t]=e,e instanceof hr?(r.table=null,n instanceof hr||(r.fieldCount+=1)):n instanceof hr&&(r.table=null,r.fieldCount-=1)}push(...t){if(0!=(this.record.flags&gr.ImmutableFlag))throw new Error("immutable");return 0!=(this.record.flags&gr.AliasedFlag)?this.pushAliased(...t):this.pushMutable(...t),this.length}pushAliased(...t){const e=this.record,r=t.length;let i=e.length,n=e.fieldCount;const s=e.array,o=new Array(gr.expand(i+r));if(null!==s){for(let t=0;t<this.upper;t+=1)o[t]=s[t];for(let t=this.upper;t<i;t+=1)o[t+r]=s[t]}for(let e=0;e<r;e+=1){const r=ar.fromLike(t[e]);o[e+this.upper]=r,i+=1,r instanceof hr&&(n+=1)}e.array=o,e.table=null,e.length=i,e.fieldCount=n,e.flags&=~gr.AliasedFlag,this.upper+=r}pushMutable(...t){const e=this.record,r=t.length;let i=e.length,n=e.fieldCount;const s=e.array;let o;if(null===s||i+r>s.length){if(o=new Array(gr.expand(i+r)),null!==s)for(let t=0;t<this.upper;t+=1)o[t]=s[t]}else o=s;for(let t=i-1;t>=this.upper;t-=1)o[t+r]=s[t];for(let s=0;s<r;s+=1){const r=ar.fromLike(t[s]);o[s+this.upper]=r,i+=1,r instanceof hr&&(n+=1,e.table=null)}e.array=o,e.length=i,e.fieldCount=n,this.upper+=r}splice(t,e=0,...r){if(0!=(this.record.flags&gr.ImmutableFlag))throw new Error("immutable");const i=this.length;let n;return t<0&&(t=i+t),t=Math.min(Math.max(0,t),i),e=Math.min(Math.max(0,e),i-t),n=0!=(this.record.flags&gr.AliasedFlag)?this.record.spliceAliased(this.lower+t,e,...r):this.record.spliceMutable(this.lower+t,e,...r),this.upper+=r.length-n.length,n}delete(t){if(0!=(this.record.flags&gr.ImmutableFlag))throw new Error("immutable");return t=mr.fromLike(t),0!=(this.record.flags&gr.AliasedFlag)?this.deleteAliased(t):this.deleteMutable(t)}deleteAliased(t){const e=this.record,r=e.length,i=e.array,n=new Array(gr.expand(r));for(let s=this.lower;s<this.upper;s+=1){const o=i[s];if(o instanceof hr&&o.key.equals(t)){for(let t=s+1;t<r;t+=1,s+=1)n[s]=i[t];return e.array=n,e.table=null,e.length=r-1,e.fieldCount-=1,e.flags&=~gr.AliasedFlag,this.upper-=1,o}n[s]=o}return ar.absent()}deleteMutable(t){const e=this.record,r=e.length,i=e.array;for(let n=this.lower;n<this.upper;n+=1){const s=i[n];if(s instanceof hr&&s.key.equals(t)){for(let t=n+1;t<r;t+=1,n+=1)i[n]=i[t];return i[r-1]=void 0,e.table=null,e.length=r-1,e.fieldCount-=1,this.upper-=1,s}}return ar.absent()}clear(){if(0!=(this.record.flags&gr.ImmutableFlag))throw new Error("immutable");0!=(this.record.flags&gr.AliasedFlag)?this.clearAliased():this.clearMutable()}clearAliased(){const t=this.record,e=t.length;let r=t.fieldCount;const i=e-this.length,n=t.array,s=new Array(gr.expand(i));let o=0;for(;o<this.lower;)s[o]=n[o],o+=1;for(;o<this.upper;)n[o]instanceof hr&&(r-=1),o+=1;o=this.lower;let a=this.upper;for(;a<e;)s[o]=n[a],o+=1,a+=1;t.array=s,t.table=null,t.length=i,t.fieldCount=r,t.flags&=~gr.AliasedFlag,this.upper=this.lower}clearMutable(){const t=this.record,e=t.length;let r=t.fieldCount;const i=t.array;let n=this.lower;for(;n<this.upper;)i[n]instanceof hr&&(r-=1),n+=1;n=this.lower;let s=this.upper;for(;s<e;){const e=i[s];e instanceof hr&&(t.table=null),i[n]=e,n+=1,s+=1}for(t.length=n,t.fieldCount=r;n<e;)i[n]=void 0,n+=1;this.upper=this.lower}isAliased(){return 0!=(this.record.flags&gr.AliasedFlag)}isMutable(){return 0==(this.record.flags&gr.ImmutableFlag)}alias(){this.record.flags|=gr.AliasedFlag}branch(){const t=this.length;let e=0;const r=this.record.array,i=new Array(gr.expand(t));let n=this.lower,s=0;for(;s<t;){const t=r[n];i[s]=t,t instanceof hr&&(e+=1),n+=1,s+=1}return new vr(i,null,t,e,0)}clone(){const t=this.length;let e=0;const r=this.record.array,i=new Array(gr.expand(t));let n=this.lower,s=0;for(;s<t;){const t=r[n];i[s]=t.clone(),t instanceof hr&&(e+=1),n+=1,s+=1}return new vr(i,null,t,e,0)}commit(){return this.record.commit(),this}subRecord(t,e){const r=this.length;if(void 0===t?t=0:t<0&&(t=r+t),void 0===e?e=r:e<0&&(e=r+e),t<0||e>r||t>e)throw new RangeError(t+", "+e);return new xr(this.record,this.lower+t,this.upper+e)}forEach(t,e){const r=this.record.array;for(let i=this.lower;i<this.upper;i+=1){const n=t.call(e,r[i],i);if(void 0!==n)return n}}}Object.defineProperty(xr.prototype,"fieldCount",{get(){const t=this.record.array;let e=0;for(let r=this.lower;r<this.upper;r+=1)t[r]instanceof hr&&(e+=1);return e},configurable:!0});let Sr=(()=>{var t;let n,a=mr,u=[];return t=class extends a{constructor(t,e,r){super(),this.array=t,this.size=e,this.flags=r}isConstant(){return!0}getByte(t){if(t<0||t>=this.size)throw new RangeError(""+t);return this.array[t]}setByte(e,r){const i=this.flags;if(0!=(i&t.ImmutableFlag))throw new Error("immutable");if(e<0||e>=this.size)throw new RangeError(""+e);return 0!=(i&t.AliasedFlag)?this.setByteAliased(e,r):this.setByteMutable(e,r)}setByteAliased(e,r){const i=this.size,n=this.array,s=new Uint8Array(t.expand(i));return s.set(n,0),s[e]=r,this.array=s,this.flags&=~t.AliasedFlag,this}setByteMutable(t,e){return this.array[t]=e,this}addByte(e){const r=this.flags;if(0!=(r&t.ImmutableFlag))throw new Error("immutable");return 0!=(r&t.AliasedFlag)?this.addByteAliased(e):this.addByteMutable(e)}addByteAliased(e){const r=this.size,i=this.array,n=new Uint8Array(t.expand(r+1));return null!==i&&n.set(i,0),n[r]=e,this.array=n,this.size=r+1,this.flags&=~t.AliasedFlag,this}addByteMutable(e){const r=this.size,i=this.array;let n;return null===i||r+1>i.length?(n=new Uint8Array(t.expand(r+1)),null!==i&&n.set(i,0),this.array=n):n=i,n[r]=e,this.size=r+1,this}addData(t){let e=t.array;if(null===e)return this;const r=t.size;return e.length>r&&(e=e.slice(0,r)),this.addUint8Array(e)}addUint8Array(e){const r=this.flags;if(0!=(r&t.ImmutableFlag))throw new Error("immutable");return 0!=(r&t.AliasedFlag)?this.addUint8ArrayAliased(e):this.addUint8ArrayMutable(e)}addUint8ArrayAliased(e){const r=e.length;if(0===r)return this;const i=this.size,n=this.array,s=new Uint8Array(t.expand(i+r));return null!==n&&s.set(n,0),s.set(e,i),this.array=s,this.size=i+r,this.flags&=~t.AliasedFlag,this}addUint8ArrayMutable(e){const r=e.length;if(0===r)return this;const i=this.size,n=this.array;let s;return null===n||i+r>n.length?(s=new Uint8Array(t.expand(i+r)),null!==n&&s.set(n,0),this.array=s):s=n,s.set(e,i),this.size=i+r,this}clear(){if(0!=(this.flags&t.ImmutableFlag))throw new Error("immutable");this.array=null,this.size=0,this.flags=t.AliasedFlag}toUint8Array(){const e=this.array,r=this.flags;if(0!=(r&t.ImmutableFlag))return null!==e?e.slice(0):new Uint8Array(0);if(0!=(r&t.AliasedFlag)||this.size!==e.length){const r=null!==e?e.slice(0):new Uint8Array(0);return this.array=r,this.flags&=~t.AliasedFlag,r}return e}asUint8Array(){const t=this.array;if(null!==t&&0!==this.size)return t.length!==this.size?new Uint8Array(t.buffer,t.byteOffset,this.size):t}toLike(){return this.toUint8Array()}isAliased(){return 0!=(this.flags&t.AliasedFlag)}isMutable(){return 0==(this.flags&t.ImmutableFlag)}branch(){return this.flags|=t.AliasedFlag,new t(this.array,this.size,t.AliasedFlag)}clone(){return this.branch()}commit(){return this.flags|=t.ImmutableFlag,this}writeBase16(t,e=_t.uppercase){let r=this.array;const i=this.size;return null===r||0===i?bt.end():(r.length!==i&&(r=r.slice(0,i)),e.writeUint8Array(t,r))}toBase16(t=_t.uppercase){const e=xt.stringOutput();return this.writeBase16(e,t).bind(),e.bind()}writeBase64(t,e=he.standard()){let r=this.array;const i=this.size;return null===r||0===i?bt.end():(r.length!==i&&(r=r.slice(0,i)),e.writeUint8Array(t,r))}toBase64(t=he.standard()){const e=xt.stringOutput();return this.writeBase64(e,t),e.bind()}interpolateTo(t){return super.interpolateTo(t)}get typeOrder(){return 4}compareTo(e){if(e instanceof t){const t=this.array,r=e.array,i=this.size,n=e.size;let s=0,o=0;do{if(!(o<i&&o<n))break;s=t[o]-r[o],o+=1}while(0===s);return s>0?1:s<0?-1:i>n?1:i<n?-1:0}return e instanceof ar?f.compare(this.typeOrder,e.typeOrder):NaN}equivalentTo(t){return this.equals(t)}equals(e){if(this===e)return!0;if(e instanceof t){const t=this.array,r=e.array,i=this.size;if(i!==e.size)return!1;for(let e=0;e<i;e+=1)if(t[e]!==r[e])return!1;return!0}return!1}hashCode(){return s.mash(s.mixUint8Array(g.hash(t),null!==this.array?this.array:new Uint8Array(0)))}debug(t){if(t=t.write("Data").write(46),0===this.size)t=t.write("empty").write(40).write(41);else{t=t.write("base16").write(40).write(34);const e=this.writeBase16(t);if(!e.isDone())return yt.error(e.trap());t=t.write(34).write(41)}return t}static empty(){return new t(null,0,t.AliasedFlag|t.ImmutableFlag)}static create(e){return void 0===e?new t(null,0,t.AliasedFlag):new t(new Uint8Array(e),0,0)}static wrap(e){return new t(e,e.length,t.AliasedFlag)}static fromBase16(e){return"string"==typeof e&&(e=xt.stringInput(e)),_t.parse(e,t.output()).bind()}static fromBase64(e,r=he.standard()){return"string"==typeof e&&(e=xt.stringInput(e)),r.parse(e,t.output()).bind()}static fromLike(e){if(e instanceof t)return e;if(e instanceof Uint8Array)return t.wrap(e);throw new TypeError(""+e)}static random(e){const r=new Uint8Array(e);return i.fillBytes(r),t.wrap(r)}static output(e){return e instanceof t||(e=t.create(e)),new Cr(e,ht.standard())}static expand(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}},(()=>{var i;const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(i=a[Symbol.metadata])&&void 0!==i?i:null):void 0;n=[o],e(t,null,n,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,u),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,u)})(),t.AliasedFlag=1,t.ImmutableFlag=2,t})();class Cr extends yt{constructor(t,e){super(),this.data=t,this.settings=e}isCont(){return!0}isFull(){return!1}isDone(){return!1}isError(){return!1}isPart(){return!1}asPart(t){return this}write(t){if("number"!=typeof t)throw new TypeError(""+t);return this.data.addByte(t),this}writeln(t){throw new TypeError(""+t)}withSettings(t){return t=ht.fromLike(t),this.settings=t,this}bind(){return this.data}clone(){return new Cr(this.data.branch(),this.settings)}}let kr=(()=>{var t;let i,n=mr,s=[];return t=class extends n{constructor(t){super(),this.value=t,this.hashValue=void 0}isConstant(){return!0}get size(){return this.value.length}stringValue(t){return this.value}numberValue(t){try{return Or.parse(this.value).numberValue()}catch(e){return t}}booleanValue(t){return"true"===this.value||"false"!==this.value&&t}toLike(){return this.value}valueOf(){return this.value}plus(e){return(e=ar.fromLike(e))instanceof t?t.from(this.value+e.value):super.plus(e)}branch(){return this}clone(){return this}commit(){return this}interpolateTo(t){return super.interpolateTo(t)}get typeOrder(){return 5}compareTo(e){return e instanceof t?this.value.localeCompare(e.value):e instanceof ar?f.compare(this.typeOrder,e.typeOrder):NaN}equivalentTo(t){return this.equals(t)}equals(e){return this===e||e instanceof t&&this.value===e.value}hashCode(){let t=this.hashValue;return void 0===t&&(t=p.hash(this.value),this.hashValue=t),t}debug(t){return t=t.write("Text").write(46),t=0===this.value.length?t.write("empty").write(40).write(41):t.write("from").write(40).debug(this.value).write(41)}display(t){return St.debugAny(t,this.value)}toString(){return this.value}static empty(){return new t("")}static from(e){return 0===e.length?t.empty():new t(e)}static fromLike(e){if(e instanceof t)return e;if("string"==typeof e)return t.from(e);throw new TypeError(""+e)}static output(t){return void 0===t&&(t=ht.standard()),new Mr("",t)}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class Mr extends yt{constructor(t,e){super(),this.string=t,this.settings=e}isCont(){return!0}isFull(){return!1}isDone(){return!1}isError(){return!1}isPart(){return!1}asPart(t){return this}write(t){if("number"==typeof t)if(t>=0&&t<=55295||t>=57344&&t<=65535)t=String.fromCharCode(t);else if(t>=65536&&t<=1114111){const e=t-65536;t=String.fromCharCode(55296|e>>>10,56320|1023&e)}else t="�";return this.string+=t,this}withSettings(t){return t=ht.fromLike(t),this.settings=t,this}bind(){return kr.from(this.string)}clone(){return new Mr(this.string,this.settings)}toString(){return this.string}}let Or=(()=>{var t;let i,n,s,a,u,l=mr,c=[];return t=class extends l{constructor(t,e){super(),this.value=t,this.flags=void 0!==e?e:0}isConstant(){return!0}isNaN(){return isNaN(this.value)}isInfinite(){return!isNaN(this.value)&&!isFinite(this.value)}isUint32(){return 0!=(this.flags&t.Uint32Flag)}isUint64(){return 0!=(this.flags&t.Uint64Flag)}stringValue(t){return""+this.value}numberValue(t){return this.value}booleanValue(t){return!!this.value}toLike(){return this.value}valueOf(){return this.value}bitwiseOr(e){return(e=ar.fromLike(e))instanceof t?t.from((this.value|e.value)>>>0):super.bitwiseOr(e)}bitwiseXor(e){return(e=ar.fromLike(e))instanceof t?t.from((this.value^e.value)>>>0):super.bitwiseXor(e)}bitwiseAnd(e){return(e=ar.fromLike(e))instanceof t?t.from((this.value&e.value)>>>0):super.bitwiseAnd(e)}plus(e){return(e=ar.fromLike(e))instanceof t?t.from(this.value+e.value):super.plus(e)}minus(e){return(e=ar.fromLike(e))instanceof t?t.from(this.value-e.value):super.minus(e)}times(e){return(e=ar.fromLike(e))instanceof t?t.from(this.value*e.value):super.times(e)}divide(e){return(e=ar.fromLike(e))instanceof t?t.from(this.value/e.value):super.divide(e)}modulo(e){return(e=ar.fromLike(e))instanceof t?t.from(this.value%e.value):super.modulo(e)}bitwiseNot(){return t.from(~this.value>>>0)}negative(){return t.from(-this.value)}positive(){return this}inverse(){return t.from(1/this.value)}abs(){return t.from(Math.abs(this.value))}ceil(){return t.from(Math.ceil(this.value))}floor(){return t.from(Math.floor(this.value))}round(){return t.from(Math.round(this.value))}sqrt(){return t.from(Math.sqrt(this.value))}pow(e){return e=t.fromLike(e),t.from(Math.pow(this.value,e.value))}max(t){return this.compareTo(t)>=0?this:t}min(t){return this.compareTo(t)<=0?this:t}interpolateTo(e){return e instanceof t?Er(this,e):super.interpolateTo(e)}get typeOrder(){return 6}compareTo(e){if(e instanceof t){const t=this.value,r=e.value;return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return e instanceof ar?f.compare(this.typeOrder,e.typeOrder):NaN}equivalentTo(e,r){if(this===e)return!0;if(e instanceof t){const t=this.value,i=e.value;return t===i||isNaN(t)&&isNaN(i)||Math.abs(i-t)<(void 0!==r?r:h.Epsilon)}return!1}equals(e){if(this===e)return!0;if(e instanceof t){const t=this.value,r=e.value;return t===r||isNaN(t)&&isNaN(r)}return!1}hashCode(){return f.hash(this.value)}debug(t){return t=t.write("Num").write(46).write("from").write(40).display(this).write(41)}display(t){return St.displayNumber(t,this.value)}static zero(){return new t(0)}static negativeZero(){return new t(-0)}static one(){return new t(1)}static negativeOne(){return new t(-1)}static nan(){return new t(NaN)}static uint32(e){return new t(e,t.Uint32Flag)}static uint64(e){return new t(e,t.Uint64Flag)}static from(e){return 0===e?1/e==-1/0?t.negativeZero():t.zero():1===e?t.one():-1===e?t.negativeOne():isNaN(e)?t.nan():new t(e)}static fromLike(e){if(e instanceof t)return e;if("number"==typeof e)return t.from(e);throw new TypeError(""+e)}static parse(e){if("NaN"===e)return t.nan();const r=+e;if(!isFinite(r))throw new Error(e);return t.from(r)}},(()=>{var h;const d="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(h=l[Symbol.metadata])&&void 0!==h?h:null):void 0;i=[o],n=[o],s=[o],a=[o],u=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:d},null,c),e(t,null,n,{kind:"method",name:"negativeZero",static:!0,private:!1,access:{has:t=>"negativeZero"in t,get:t=>t.negativeZero},metadata:d},null,c),e(t,null,s,{kind:"method",name:"one",static:!0,private:!1,access:{has:t=>"one"in t,get:t=>t.one},metadata:d},null,c),e(t,null,a,{kind:"method",name:"negativeOne",static:!0,private:!1,access:{has:t=>"negativeOne"in t,get:t=>t.negativeOne},metadata:d},null,c),e(t,null,u,{kind:"method",name:"nan",static:!0,private:!1,access:{has:t=>"nan"in t,get:t=>t.nan},metadata:d},null,c),d&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),r(t,c)})(),t.Uint32Flag=1,t.Uint64Flag=2,t.TypeMask=3,t})();const Er=function(t){const e=function(t,r){const i=function(t){const e=i[0].value,r=i[1].value;return Or.from(e+t*(r-e))};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);let Tr=(()=>{var t;let i,n,s=mr,a=[];return t=class extends s{constructor(t){super(),Object.defineProperty(this,"value",{value:t,enumerable:!0}),Object.defineProperty(this,"hashValue",{value:p.hash(t?"true":"false")})}isDefinite(){return this.value}isConstant(){return!0}stringValue(t){return this.value?"true":"false"}booleanValue(t){return this.value}toLike(){return this.value}valueOf(){return this.value}conditional(t,e){return this.value?ar.fromLike(t):ar.fromLike(e)}or(t){return this.value?this:ar.fromLike(t)}and(t){return this.value?ar.fromLike(t):this}not(){return t.from(!this.value)}get typeOrder(){return 7}compareTo(e){return e instanceof t?this.value&&!e.value?-1:!this.value&&e.value?1:0:e instanceof ar?f.compare(this.typeOrder,e.typeOrder):NaN}equivalentTo(t){return this.equals(t)}equals(e){return this===e||e instanceof t&&this.value===e.value}hashCode(){return this.hashValue}debug(t){return t=t.write("Bool").write(46).write("from").write(40).write(this.value?"true":"false").write(41)}display(t){return t=t.write(this.value?"true":"false")}static true(){return new t(!0)}static false(){return new t(!1)}static from(e){return e?t.true():t.false()}static fromLike(e){if(e instanceof t)return e;if("boolean"==typeof e)return t.from(e);throw new TypeError(""+e)}},(()=>{var u;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=s[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"true",static:!0,private:!1,access:{has:t=>"true"in t,get:t=>t.true},metadata:h},null,a),e(t,null,n,{kind:"method",name:"false",static:!0,private:!1,access:{has:t=>"false"in t,get:t=>t.false},metadata:h},null,a),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,a)})(),t})(),Pr=(()=>{var t;let i,n=mr,s=[];return t=class extends n{constructor(){super()}isDefined(){return!0}isDistinct(){return!1}isDefinite(){return!1}isConstant(){return!0}unflattened(){return gr.empty()}not(){return mr.absent()}stringValue(t){return""}booleanValue(t){return!0}toLike(){return null}interpolateTo(t){return super.interpolateTo(t)}get typeOrder(){return 98}compareTo(t){return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t){return this===t}equals(t){return this===t}hashCode(){return g.hash(t)}debug(t){return t=t.write("Value").write(46).write("extant").write(40).write(41)}display(t){return t=t.write("null")}static extant(){return new t}static fromLike(e){if(e instanceof t)return e;if(null===e)return t.extant();throw new TypeError(""+e)}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"extant",static:!0,private:!1,access:{has:t=>"extant"in t,get:t=>t.extant},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})(),Ir=(()=>{var t;let i,n=mr,s=[];return t=class extends n{constructor(){super()}isDefined(){return!1}isDistinct(){return!1}isDefinite(){return!1}isConstant(){return!0}unflattened(){return gr.empty()}updated(t,e){return gr.of(fr.of(t,e))}updatedAttr(t,e){return gr.of(cr.of(t,e))}updatedSlot(t,e){return gr.of(fr.of(t,e))}appended(...t){return gr.of(t)}prepended(...t){return gr.of(t)}concat(...t){const e=gr.create();for(let r=0;r<t.length;r+=1)ar.fromLike(t[r]).forEach((function(t){e.push(t)}));return e}conditional(t,e){return ar.fromLike(e)}or(t){return ar.fromLike(t)}and(t){return this}not(){return mr.extant()}booleanValue(t){return!1}toLike(){}forEach(t,e){}iterator(){return O.empty()}interpolateTo(t){return super.interpolateTo(t)}get typeOrder(){return 99}compareTo(t){return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t){return this===t}equals(t){return this===t}hashCode(){return g.hash(t)}debug(t){return t=t.write("Value").write(46).write("absent").write(40).write(41)}display(t){return t=t.write("undefined")}static absent(){return new t}static fromLike(e){if(e instanceof t)return e;if(void 0===e)return t.absent();throw new TypeError(""+e)}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"absent",static:!0,private:!1,access:{has:t=>"absent"in t,get:t=>t.absent},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class Dr extends mr{constructor(){super()}conditional(t,e){return t=ar.fromLike(t),e=ar.fromLike(e),new zr(this,t,e)}or(t){return t=ar.fromLike(t),new Br(this,t)}and(t){return t=ar.fromLike(t),new Yr(this,t)}bitwiseOr(t){return t=ar.fromLike(t),new Hr(this,t)}bitwiseXor(t){return t=ar.fromLike(t),new Wr(this,t)}bitwiseAnd(t){return t=ar.fromLike(t),new Xr(this,t)}lt(t){return t=ar.fromLike(t),new Kr(this,t)}le(t){return t=ar.fromLike(t),new Gr(this,t)}eq(t){return t=ar.fromLike(t),new Zr(this,t)}ne(t){return t=ar.fromLike(t),new Qr(this,t)}ge(t){return t=ar.fromLike(t),new Jr(this,t)}gt(t){return t=ar.fromLike(t),new $r(this,t)}plus(t){return t=ar.fromLike(t),new _r(this,t)}minus(t){return t=ar.fromLike(t),new ti(this,t)}times(t){return t=ar.fromLike(t),new ei(this,t)}divide(t){return t=ar.fromLike(t),new ri(this,t)}modulo(t){return t=ar.fromLike(t),new ii(this,t)}not(){return new ni(this)}bitwiseNot(){return new si(this)}negative(){return new oi(this)}positive(){return new ai(this)}inverse(){return new ri(Or.one(),this)}toLike(){return this}}class Lr extends Dr{constructor(){super()}static binary(t,e,r){switch(e){case"||":return new Br(t,r);case"&&":return new Yr(t,r);case"|":return new Hr(t,r);case"^":return new Wr(t,r);case"&":return new Xr(t,r);case"<":return new Kr(t,r);case"<=":return new Gr(t,r);case"==":return new Zr(t,r);case"!=":return new Qr(t,r);case">=":return new Jr(t,r);case">":return new $r(t,r);case"+":return new _r(t,r);case"-":return new ti(t,r);case"*":return new ei(t,r);case"/":return new ri(t,r);case"%":return new ii(t,r);default:throw new Error(e)}}static unary(t,e){switch(t){case"!":return new ni(e);case"~":return new si(e);case"-":return new oi(e);case"+":return new ai(e);default:throw new Error(t)}}}class qr extends Lr{constructor(t,e){super(),this.operand1=t,this.operand2=e}isConstant(){return this.operand1.isConstant()&&this.operand2.isConstant()}interpolateTo(t){return t instanceof qr&&this.operator===t.operator?Ar(this,t):super.interpolateTo(t)}}const Ar=function(t){const e=function(t,r){const i=t.operator;if(i!==r.operator)throw new Error;const n=function(t){const e=n.operand1Interpolator(t),r=n.operand2Interpolator(t);return Lr.binary(e,n.operator,r)};return Object.setPrototypeOf(n,e.prototype),n.operand1Interpolator=t.operand1.interpolateTo(r.operand1),n.operator=i,n.operand2Interpolator=t.operand2.interpolateTo(r.operand2),n};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.operand1Interpolator[0],e=this.operand2Interpolator[0];return Lr.binary(t,this.operator,e)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.operand1Interpolator[1],e=this.operand2Interpolator[1];return Lr.binary(t,this.operator,e)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operator===t.operator&&this.operand1Interpolator.equals(t.operand1Interpolator)&&this.operand2Interpolator.equals(t.operand2Interpolator))},e}(j);class Fr extends Lr{constructor(t){super(),this.operand=t}isConstant(){return this.operand.isConstant()}interpolateTo(t){return t instanceof Fr&&this.operator===t.operator?Vr(this,t):super.interpolateTo(t)}}const Vr=function(t){const e=function(t,r){const i=t.operator;if(i!==r.operator)throw new Error;const n=function(t){const e=n.operandInterpolator(t);return Lr.unary(n.operator,e)};return Object.setPrototypeOf(n,e.prototype),n.operator=i,n.operandInterpolator=t.operand.interpolateTo(r.operand),n};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.operandInterpolator[0];return Lr.unary(this.operator,t)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.operandInterpolator[1];return Lr.unary(this.operator,t)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operator===t.operator&&this.operandInterpolator.equals(t.operandInterpolator))},e}(j);class zr extends Lr{constructor(t,e,r){super(),this.ifTerm=t.commit(),this.thenTerm=e.commit(),this.elseTerm=r.commit()}isConstant(){return this.ifTerm.isConstant()&&this.thenTerm.isConstant()&&this.elseTerm.isConstant()}get precedence(){return 2}evaluate(t){let e;(t=Rr.fromLike(t)).willOperate(this);if(this.ifTerm.evaluate(t).isDefinite()){e=this.thenTerm.evaluate(t)}else{e=this.elseTerm.evaluate(t)}return t.didOperate(this,e),e}substitute(t){t=Rr.fromLike(t);const e=this.ifTerm.substitute(t),r=this.thenTerm.substitute(t),i=this.elseTerm.substitute(t);return new zr(e,r,i)}interpolateTo(t){return t instanceof zr?jr(this,t):super.interpolateTo(t)}get typeOrder(){return 20}compareTo(t){if(t instanceof zr){let e=this.ifTerm.compareTo(t.ifTerm);return 0===e&&(e=this.thenTerm.compareTo(t.thenTerm),0===e&&(e=this.elseTerm.compareTo(t.elseTerm))),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof zr&&(this.ifTerm.equivalentTo(t.ifTerm,e)&&this.thenTerm.equivalentTo(t.thenTerm,e)&&this.elseTerm.equivalentTo(t.elseTerm,e))}equals(t){return this===t||t instanceof zr&&(this.ifTerm.equals(t.ifTerm)&&this.thenTerm.equals(t.thenTerm)&&this.elseTerm.equals(t.elseTerm))}hashCode(){return s.mash(s.mix(s.mix(s.mix(g.hash(zr),this.ifTerm.hashCode()),this.thenTerm.hashCode()),this.elseTerm.hashCode()))}debug(t){return t=t.debug(this.ifTerm).write(46).write("conditional").write(40).debug(this.thenTerm).write(44).write(32).debug(this.elseTerm).write(41)}clone(){return new zr(this.ifTerm.clone(),this.thenTerm.clone(),this.elseTerm.clone())}}const jr=function(t){const e=function(t,r){const i=function(t){const e=i.ifTermInterpolator(t),r=i.thenTermInterpolator(t),n=i.elseTermInterpolator(t);return new zr(e,r,n)};return Object.setPrototypeOf(i,e.prototype),i.ifTermInterpolator=t.ifTerm.interpolateTo(r.ifTerm),i.thenTermInterpolator=t.thenTerm.interpolateTo(r.thenTerm),i.elseTermInterpolator=t.elseTerm.interpolateTo(r.elseTerm),i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.ifTermInterpolator[0],e=this.thenTermInterpolator[0],r=this.elseTermInterpolator[0];return new zr(t,e,r)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.ifTermInterpolator[1],e=this.thenTermInterpolator[1],r=this.elseTermInterpolator[1];return new zr(t,e,r)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.ifTermInterpolator.equals(t.ifTermInterpolator)&&this.thenTermInterpolator.equals(t.thenTermInterpolator)&&this.elseTermInterpolator.equals(t.elseTermInterpolator))},e}(j);class Nr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Nr.prototype)}}let Ur=(()=>{var t;let i,n=[];return t=class{constructor(t){this.maxScopeDepth=t}withMaxScopeDepth(t){return this.copy(t)}copy(e){return new t(e)}canEqual(e){return e instanceof t}equals(e){return this===e||e instanceof t&&(e.canEqual(this)&&this.maxScopeDepth===e.maxScopeDepth)}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.maxScopeDepth)))}debug(t){return t=t.write("new").write(32).write("InterpreterSettings").write(40).debug(this.maxScopeDepth).write(41)}toString(){return St.debug(this)}static standard(){return new t(1024)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"standard",static:!0,private:!1,access:{has:t=>"standard"in t,get:t=>t.standard},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class Rr{constructor(t,e,r){this.settings=void 0!==t?t:Ur.standard(),this.scopeStack=void 0!==e?e:null,this.scopeDepth=void 0!==r?r:0}withSettings(t){return this.settings=t,this}peekScope(){const t=this.scopeDepth;if(t<=0)throw new Nr("scope stack empty");return this.scopeStack[t-1]}getScope(t){if(t<0||t>=this.scopeDepth)throw new RangeError(""+t);return this.scopeStack[t]}pushScope(t){const e=this.scopeDepth;if(e>=this.settings.maxScopeDepth)throw new Nr("scope stack overflow");const r=this.scopeStack;let i;if(null===r||e+1>r.length){if(i=new Array(Rr.expand(e+1)),null!==r)for(let t=0;t<e;t+=1)i[t]=r[t];this.scopeStack=i}else i=r;i[e]=t,this.scopeDepth+=1}popScope(){const t=this.scopeDepth;if(t<=0)throw new Nr("scope stack empty");const e=this.scopeStack,r=e[t-1];return e[t-1]=void 0,this.scopeDepth-=1,r}swapScope(t){const e=this.scopeDepth;if(e<=0)throw new Nr("scope stack empty");const r=this.scopeStack,i=r[e-1];return r[e-1]=t,i}willOperate(t){}didOperate(t,e){}willSelect(t){}didSelect(t,e){}willTransform(t){}didTransform(t,e){}static of(...t){const e=t.length,r=new Array(Rr.expand(e));for(let i=0;i<e;i+=1){const e=ar.fromLike(t[i]);r[i]=e}return new Rr(Ur.standard(),r,e)}static fromLike(t,e=ar.globalScope()){if(!(t instanceof Rr)){const r=t;t=new Rr,void 0!==e&&t.pushScope(e),void 0!==r&&t.pushScope(ar.fromLike(r))}return t}static expand(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}}class Br extends qr{constructor(t,e){super(t,e)}get operator(){return"||"}get precedence(){return 3}evaluate(t){let e;(t=Rr.fromLike(t)).willOperate(this);const r=this.operand1.evaluate(t);if(r.isDefinite())e=r;else{e=this.operand2.evaluate(t)}return t.didOperate(this,e),e}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.or(r)}get typeOrder(){return 21}compareTo(t){if(t instanceof Br){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Br&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Br&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Br),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("or").write(40).debug(this.operand2).write(41)}clone(){return new Br(this.operand1.clone(),this.operand2.clone())}}class Yr extends qr{constructor(t,e){super(t,e)}get operator(){return"&&"}get precedence(){return 4}evaluate(t){let e;(t=Rr.fromLike(t)).willOperate(this);const r=this.operand1.evaluate(t);if(r.isDefinite()){e=this.operand2.evaluate(t)}else e=r;return t.didOperate(this,e),e}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.and(r)}get typeOrder(){return 22}compareTo(t){if(t instanceof Yr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Yr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Yr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Yr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("and").write(40).debug(this.operand2).write(41)}clone(){return new Yr(this.operand1.clone(),this.operand2.clone())}}class Hr extends qr{constructor(t,e){super(t,e)}get operator(){return"|"}get precedence(){return 5}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.bitwiseOr(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.bitwiseOr(r)}get typeOrder(){return 23}compareTo(t){if(t instanceof Hr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Hr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Hr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Hr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("bitwiseOr").write(40).debug(this.operand2).write(41)}clone(){return new Hr(this.operand1.clone(),this.operand2.clone())}}class Wr extends qr{constructor(t,e){super(t,e)}get operator(){return"^"}get precedence(){return 6}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.bitwiseXor(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.bitwiseXor(r)}get typeOrder(){return 24}compareTo(t){if(t instanceof Wr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Wr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Wr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Wr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("bitwiseXor").write(40).debug(this.operand2).write(41)}clone(){return new Wr(this.operand1.clone(),this.operand2.clone())}}class Xr extends qr{constructor(t,e){super(t,e)}get operator(){return"&"}get precedence(){return 7}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.bitwiseAnd(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.bitwiseAnd(r)}get typeOrder(){return 25}compareTo(t){if(t instanceof Xr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Xr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Xr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Xr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("bitwiseAnd").write(40).debug(this.operand2).write(41)}clone(){return new Xr(this.operand1.clone(),this.operand2.clone())}}class Kr extends qr{constructor(t,e){super(t,e)}get operator(){return"<"}get precedence(){return 0}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.lt(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.lt(r)}get typeOrder(){return 26}compareTo(t){if(t instanceof Kr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Kr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Kr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Kr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t.debug(this.operand1).write(46).write("lt").write(40).debug(this.operand2).write(41)}clone(){return new Kr(this.operand1.clone(),this.operand2.clone())}}class Gr extends qr{constructor(t,e){super(t,e)}get operator(){return"<="}get precedence(){return 0}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.le(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.le(r)}get typeOrder(){return 27}compareTo(t){if(t instanceof Gr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Gr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Gr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Gr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t.debug(this.operand1).write(46).write("le").write(40).debug(this.operand2).write(41)}clone(){return new Gr(this.operand1.clone(),this.operand2.clone())}}class Zr extends qr{constructor(t,e){super(t,e)}get operator(){return"=="}get precedence(){return 0}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.eq(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.eq(r)}get typeOrder(){return 28}compareTo(t){if(t instanceof Zr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Zr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Zr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Zr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("eq").write(40).debug(this.operand2).write(41)}clone(){return new Zr(this.operand1.clone(),this.operand2.clone())}}class Qr extends qr{constructor(t,e){super(t,e)}get operator(){return"!="}get precedence(){return 0}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.ne(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.ne(r)}get typeOrder(){return 29}compareTo(t){if(t instanceof Qr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Qr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Qr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Qr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("ne").write(40).debug(this.operand2).write(41)}clone(){return new Qr(this.operand1.clone(),this.operand2.clone())}}class Jr extends qr{constructor(t,e){super(t,e)}get operator(){return">="}get precedence(){return 0}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.ge(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.ge(r)}get typeOrder(){return 30}compareTo(t){if(t instanceof Jr){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Jr&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof Jr&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Jr),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("ge").write(40).debug(this.operand2).write(41)}clone(){return new Jr(this.operand1.clone(),this.operand2.clone())}}class $r extends qr{constructor(t,e){super(t,e)}get operator(){return">"}get precedence(){return 0}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.gt(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.gt(r)}get typeOrder(){return 31}compareTo(t){if(t instanceof $r){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof $r&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof $r&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash($r),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("gt").write(40).debug(this.operand2).write(41)}clone(){return new $r(this.operand1.clone(),this.operand2.clone())}}class _r extends qr{constructor(t,e){super(t,e)}get operator(){return"+"}get precedence(){return 8}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.plus(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.plus(r)}get typeOrder(){return 32}compareTo(t){if(t instanceof _r){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof _r&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof _r&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(_r),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("plus").write(40).debug(this.operand2).write(41)}clone(){return new _r(this.operand1.clone(),this.operand2.clone())}}class ti extends qr{constructor(t,e){super(t,e)}get operator(){return"-"}get precedence(){return 8}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.minus(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.minus(r)}get typeOrder(){return 33}compareTo(t){if(t instanceof ti){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof ti&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof ti&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(ti),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("minus").write(40).debug(this.operand2).write(41)}clone(){return new ti(this.operand1.clone(),this.operand2.clone())}}class ei extends qr{constructor(t,e){super(t,e)}get operator(){return"*"}get precedence(){return 9}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.times(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.times(r)}get typeOrder(){return 34}compareTo(t){if(t instanceof ei){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof ei&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof ei&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(ei),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("times").write(40).debug(this.operand2).write(41)}clone(){return new ei(this.operand1.clone(),this.operand2.clone())}}class ri extends qr{constructor(t,e){super(t,e)}get operator(){return"/"}get precedence(){return 9}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.divide(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.divide(r)}get typeOrder(){return 35}compareTo(t){if(t instanceof ri){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof ri&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof ri&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(ri),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("divide").write(40).debug(this.operand2).write(41)}clone(){return new ri(this.operand1.clone(),this.operand2.clone())}}class ii extends qr{constructor(t,e){super(t,e)}get operator(){return"%"}get precedence(){return 9}evaluate(t){(t=Rr.fromLike(t)).willOperate(this);const e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),i=e.modulo(r);return t.didOperate(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.modulo(r)}get typeOrder(){return 36}compareTo(t){if(t instanceof ii){let e=this.operand1.compareTo(t.operand1);return 0===e&&(e=this.operand2.compareTo(t.operand2)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof ii&&(this.operand1.equivalentTo(t.operand1,e)&&this.operand2.equivalentTo(t.operand2,e))}equals(t){return this===t||t instanceof ii&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))}hashCode(){return s.mash(s.mix(s.mix(g.hash(ii),this.operand1.hashCode()),this.operand2.hashCode()))}debug(t){return t=t.debug(this.operand1).write(46).write("modulo").write(40).debug(this.operand2).write(41)}clone(){return new ii(this.operand1.clone(),this.operand2.clone())}}class ni extends Fr{constructor(t){super(t)}get operator(){return"!"}get precedence(){return 10}evaluate(t){t=Rr.fromLike(t);return this.operand.evaluate(t).not()}substitute(t){t=Rr.fromLike(t);return this.operand.substitute(t).not()}get typeOrder(){return 37}compareTo(t){return f.compare(this.typeOrder,t.typeOrder)}equivalentTo(t,e){return this===t||t instanceof ni&&this.operand.equivalentTo(t.operand,e)}equals(t){return this===t||t instanceof ni&&this.operand.equals(t.operand)}hashCode(){return s.mash(s.mix(g.hash(ni),this.operand.hashCode()))}debug(t){return t=t.debug(this.operand).write(46).write("not").write(40).write(41)}clone(){return new ni(this.operand.clone())}}class si extends Fr{constructor(t){super(t)}get operator(){return"~"}get precedence(){return 10}evaluate(t){t=Rr.fromLike(t);return this.operand.evaluate(t).bitwiseNot()}substitute(t){t=Rr.fromLike(t);return this.operand.substitute(t).bitwiseNot()}get typeOrder(){return 38}compareTo(t){return t instanceof si?this.operand.compareTo(t.operand):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof si&&this.operand.equivalentTo(t.operand,e)}equals(t){return this===t||t instanceof si&&this.operand.equals(t.operand)}hashCode(){return s.mash(s.mix(g.hash(si),this.operand.hashCode()))}debug(t){return t=t.debug(this.operand).write(46).write("bitwiseNot").write(40).write(41)}clone(){return new si(this.operand.clone())}}class oi extends Fr{constructor(t){super(t)}get operator(){return"-"}get precedence(){return 10}evaluate(t){t=Rr.fromLike(t);return this.operand.evaluate(t).negative()}substitute(t){t=Rr.fromLike(t);return this.operand.substitute(t).negative()}get typeOrder(){return 39}compareTo(t){return t instanceof oi?this.operand.compareTo(t.operand):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof oi&&this.operand.equivalentTo(t.operand,e)}equals(t){return this===t||t instanceof oi&&this.operand.equals(t.operand)}hashCode(){return s.mash(s.mix(g.hash(oi),this.operand.hashCode()))}debug(t){return t=t.debug(this.operand).write(46).write("negative").write(40).write(41)}clone(){return new oi(this.operand.clone())}}class ai extends Fr{constructor(t){super(t)}get operator(){return"+"}get precedence(){return 10}evaluate(t){t=Rr.fromLike(t);return this.operand.evaluate(t).positive()}substitute(t){t=Rr.fromLike(t);return this.operand.substitute(t).positive()}get typeOrder(){return 40}compareTo(t){return t instanceof ai?this.operand.compareTo(t.operand):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof ai&&this.operand.equivalentTo(t.operand,e)}equals(t){return this===t||t instanceof ai&&this.operand.equals(t.operand)}hashCode(){return s.mash(s.mix(g.hash(ai),this.operand.hashCode()))}debug(t){return t=t.debug(this.operand).write(46).write("positive").write(40).write(41)}clone(){return new ai(this.operand.clone())}}class ui extends Lr{constructor(t,e){super(),this.func=t,this.args=e.commit(),this.state=void 0}setState(t){this.state=t}isConstant(){return this.func.isConstant()&&this.args.isConstant()}get precedence(){return 11}evaluate(t){t=Rr.fromLike(t);const e=this.func.evaluate(t);return e instanceof xi?e.invoke(this.args,t,this):ar.absent()}substitute(t){t=Rr.fromLike(t);const e=this.func.evaluate(t);if(e instanceof xi){const r=e.expand(this.args,t,this);if(void 0!==r)return r}const r=this.args.substitute(t).toValue();return new ui(this.func,r)}interpolateTo(t){return t instanceof ui?hi(this,t):super.interpolateTo(t)}get typeOrder(){return 41}compareTo(t){if(t instanceof ui){let e=this.func.compareTo(t.func);return 0===e&&(e=this.args.compareTo(t.args)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof ui&&(this.func.equals(t.func)&&this.args.equivalentTo(t.args,e))}equals(t){return this===t||t instanceof ui&&(this.func.equals(t.func)&&this.args.equals(t.args))}hashCode(){return s.mash(s.mix(s.mix(g.hash(ui),this.func.hashCode()),this.args.hashCode()))}debug(t){return t=t.debug(this.func).write(46).write("invoke").write(40).debug(this.args).write(41)}clone(){return new ui(this.func.clone(),this.args.clone())}}const hi=function(t){const e=function(t,r){const i=function(t){const e=i.funcInterpolator(t),r=i.argsInterpolator(t);return new ui(e,r)};return Object.setPrototypeOf(i,e.prototype),i.funcInterpolator=t.func.interpolateTo(r.func),i.argsInterpolator=t.args.interpolateTo(r.args),i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.funcInterpolator[0],e=this.argsInterpolator[0];return new ui(t,e)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.funcInterpolator[1],e=this.argsInterpolator[1];return new ui(t,e)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.funcInterpolator.equals(t.funcInterpolator)&&this.argsInterpolator.equals(t.argsInterpolator))},e}(j);let li=(()=>{var t;let i,n,s,a,u,h=Dr,l=[];return t=class extends h{constructor(){super()}isConstant(){return!1}evaluate(t){t=Rr.fromLike(t);let e=ar.absent(),r=0;return this.forSelected(t,(function(t){const i=t.peekScope();if(void 0!==i){if(0===r)e=i;else{if(1===r){const t=gr.create();t.push(e),e=t}e.push(i)}r+=1}}),this),e}get(e){return e=mr.fromLike(e),this.andThen(new di(e,t.identity()))}getAttr(e){return e=kr.fromLike(e),this.andThen(new fi(e,t.identity()))}getItem(e){return e=Or.fromLike(e),this.andThen(new pi(e,t.identity()))}keys(){return this.andThen(t.keys())}values(){return this.andThen(t.values())}children(){return this.andThen(t.children())}descendants(){return this.andThen(t.descendants())}filter(e){return 0===arguments.length?new bi(this,t.identity()):(e=ar.fromLike(e),this.andThen(e.filter()))}invoke(t){return new ui(this,t)}get precedence(){return 11}debug(t){return t=t.write("Selector").write(46).write("identity").write(40).write(41),t=this.debugThen(t)}static identity(){return new ci}static get(e){return e=mr.fromLike(e),new di(e,t.identity())}static getAttr(e){return e=kr.fromLike(e),new fi(e,t.identity())}static getItem(e){return e=Or.fromLike(e),new pi(e,t.identity())}static keys(){return new mi(t.identity())}static values(){return new yi(t.identity())}static children(){return new gi(t.identity())}static descendants(){return new wi(t.identity())}static literal(e){return(e=ar.fromLike(e))instanceof t||(e=new vi(e,t.identity())),e}},(()=>{var c;const d="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(c=h[Symbol.metadata])&&void 0!==c?c:null):void 0;i=[o],n=[o],s=[o],a=[o],u=[o],e(t,null,i,{kind:"method",name:"identity",static:!0,private:!1,access:{has:t=>"identity"in t,get:t=>t.identity},metadata:d},null,l),e(t,null,n,{kind:"method",name:"keys",static:!0,private:!1,access:{has:t=>"keys"in t,get:t=>t.keys},metadata:d},null,l),e(t,null,s,{kind:"method",name:"values",static:!0,private:!1,access:{has:t=>"values"in t,get:t=>t.values},metadata:d},null,l),e(t,null,a,{kind:"method",name:"children",static:!0,private:!1,access:{has:t=>"children"in t,get:t=>t.children},metadata:d},null,l),e(t,null,u,{kind:"method",name:"descendants",static:!0,private:!1,access:{has:t=>"descendants"in t,get:t=>t.descendants},metadata:d},null,l),d&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),r(t,l)})(),t})();class ci extends li{get then(){return this}forSelected(t,e,r){let i;if(t.willSelect(this),0!==t.scopeDepth){const n=t.popScope(),s=n.evaluate(t);t.pushScope(s),i=e.call(r,t),t.swapScope(n)}return t.didSelect(this,i),i}mapSelected(t,e,r){return e.call(r,t)}substitute(t){return(t=Rr.fromLike(t)).peekScope().substitute(t)}get(t){return t=mr.fromLike(t),new di(t,this)}getAttr(t){return t=kr.fromLike(t),new fi(t,this)}getItem(t){return t=Or.fromLike(t),new pi(t,this)}andThen(t){return t}keys(){return li.keys()}values(){return li.values()}children(){return li.children()}descendants(){return li.descendants()}filter(t){return 0===arguments.length?new bi(this,this):(t=ar.fromLike(t)).filter()}get typeOrder(){return 10}compareTo(t){return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t){return this===t}equals(t){return this===t}hashCode(){return g.hash(ci)}debugThen(t){return t}clone(){return this}}class di extends li{constructor(t,e){super(),this.item=t.commit(),this.then=e}forSelected(t,e,r){t.willSelect(this);const i=this.item.evaluate(t).toValue(),n=di.forSelected(i,this.then,t,e,r);return t.didSelect(this,n),n}static forSelected(t,e,r,i,n){let s;if(0!==r.scopeDepth){const o=r.popScope().toValue();let a;o instanceof gr&&(a=o.getField(t),void 0!==a&&(r.pushScope(a.toValue()),s=e.forSelected(r,i,n),r.popScope())),void 0===a&&void 0===s&&(s=di.forSelected(t,e,r,i,n)),r.pushScope(o)}return s}mapSelected(t,e,r){let i;t.willTransform(this);const n=this.item.evaluate(t).toValue();if(0!==t.scopeDepth){const s=t.popScope().toValue();if(s instanceof gr){const i=s.getField(n);if(void 0!==i){t.pushScope(i.toValue());const o=this.then.mapSelected(t,e,r);t.popScope(),o instanceof hr?n.equals(o.key)?s.set(n,o.toValue()):(s.delete(n),s.push(o)):o.isDefined()?s.set(n,o.toValue()):s.delete(n)}}t.pushScope(s),i=s}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.item.evaluate(t).toValue(),r=di.substitute(e,this.then,t);if(void 0!==r)return r;let i=this.then.substitute(t);return i instanceof li||(i=this.then),new di(this.item,i)}static substitute(t,e,r){let i;if(0!==r.scopeDepth){const n=r.popScope().toValue();let s;n instanceof gr&&(s=n.getField(t),void 0!==s&&(i=s.toValue().substitute(r))),void 0===s&&void 0===i&&(i=di.substitute(t,e,r)),r.pushScope(n)}return i}andThen(t){return new di(this.item,this.then.andThen(t))}get typeOrder(){return 12}compareTo(t){if(t instanceof di){let e=this.item.compareTo(t.item);return 0===e&&(e=this.then.compareTo(t.then)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof di&&(this.item.equals(t.item)&&this.then.equivalentTo(t.then,e))}equals(t){return this===t||t instanceof di&&(this.item.equals(t.item)&&this.then.equals(t.then))}hashCode(){return s.mash(s.mix(s.mix(g.hash(di),this.item.hashCode()),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("get").write(40).debug(this.item).write(41),t=this.then.debugThen(t)}clone(){return new di(this.item.clone(),this.then.clone())}}class fi extends li{constructor(t,e){super(),this.item=t,this.then=e}forSelected(t,e,r){t.willSelect(this);const i=this.item,n=fi.forSelected(i,this.then,t,e);return t.didSelect(this,n),n}static forSelected(t,e,r,i,n){let s;if(0!==r.scopeDepth){const o=r.popScope().toValue();let a;o instanceof gr&&(a=o.getField(t),a instanceof cr&&(r.pushScope(a.toValue()),s=e.forSelected(r,i,n),r.popScope())),void 0===a&&void 0===s&&(s=fi.forSelected(t,e,r,i,n)),r.pushScope(o)}return s}mapSelected(t,e,r){let i;t.willTransform(this);const n=this.item;if(0!==t.scopeDepth){const s=t.popScope().toValue();if(s instanceof gr){const i=s.getField(n);if(i instanceof cr){t.pushScope(i.toValue());const o=this.then.mapSelected(t,e,r);t.popScope(),o instanceof hr?n.equals(o.key)?s.setAttr(n,o.toValue()):(s.delete(n),s.push(o)):o.isDefined()?s.setAttr(n,o.toValue()):s.delete(n)}}t.pushScope(s),i=s}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.item,r=fi.substitute(e,this.then,t);if(void 0!==r)return r;let i=this.then.substitute(t);return i instanceof li||(i=this.then),new fi(this.item,i)}static substitute(t,e,r){let i;if(0!==r.scopeDepth){const n=r.popScope().toValue();let s;n instanceof gr&&(s=n.getField(t),s instanceof cr&&(i=s.toValue().substitute(r))),void 0===s&&void 0===i&&(i=fi.substitute(t,e,r)),r.pushScope(n)}return i}andThen(t){return new fi(this.item,this.then.andThen(t))}get typeOrder(){return 13}compareTo(t){if(t instanceof fi){let e=this.item.compareTo(t.item);return 0===e&&(e=this.then.compareTo(t.then)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof fi&&(this.item.equals(t.item)&&this.then.equivalentTo(t.then,e))}equals(t){return this===t||t instanceof fi&&(this.item.equals(t.item)&&this.then.equals(t.then))}hashCode(){return s.mash(s.mix(s.mix(g.hash(fi),this.item.hashCode()),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("getAttr").write(40).debug(this.item).write(41),t=this.then.debugThen(t)}clone(){return new fi(this.item.clone(),this.then.clone())}}class pi extends li{constructor(t,e){super(),this.item=t,this.then=e}forSelected(t,e,r){let i;t.willSelect(this);const n=this.item.numberValue();if(0!==t.scopeDepth){const s=t.popScope().toValue();if(s instanceof gr&&n<s.length){const o=s.getItem(n);t.pushScope(o),i=this.then.forSelected(t,e,r),t.popScope()}t.pushScope(s)}return t.didSelect(this,i),i}mapSelected(t,e,r){let i;if(t.willTransform(this),0!==t.scopeDepth){const n=t.popScope().toValue(),s=this.item.numberValue();if(n instanceof gr&&s<n.length){const i=n.getItem(s);t.pushScope(i);const o=this.then.mapSelected(t,e,r);t.popScope(),o.isDefined()?n.setItem(s,o):n.splice(s,1)}t.pushScope(n),i=n}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.item.numberValue();if(0!==t.scopeDepth){const r=t.popScope().toValue();let i;if(r instanceof gr&&e<r.length){i=r.getItem(e).substitute(t)}if(t.pushScope(r),void 0!==i)return i}let r=this.then.substitute(t);return r instanceof li||(r=this.then),new pi(this.item,r)}andThen(t){return new pi(this.item,this.then.andThen(t))}get typeOrder(){return 14}compareTo(t){if(t instanceof pi){let e=this.item.compareTo(t.item);return 0===e&&(e=this.then.compareTo(t.then)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof pi&&(this.item.equals(t.item)&&this.then.equivalentTo(t.then,e))}equals(t){return this===t||t instanceof pi&&(this.item.equals(t.item)&&this.then.equals(t.then))}hashCode(){return s.mash(s.mix(s.mix(g.hash(pi),this.item.hashCode()),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("getItem").write(40).debug(this.item).write(41),t=this.then.debugThen(t)}clone(){return new pi(this.item,this.then.clone())}}class mi extends li{constructor(t){super(),this.then=t}forSelected(t,e,r){let i;if(t.willSelect(this),0!==t.scopeDepth){const n=t.popScope();if(n instanceof gr){const s=n.iterator();for(;void 0===i&&s.hasNext();){const n=s.next().value;n instanceof hr&&(t.pushScope(n.key),i=this.then.forSelected(t,e,r),t.popScope())}}else n instanceof hr&&(t.pushScope(n.key),i=this.then.forSelected(t,e,r),t.popScope());t.pushScope(n)}return t.didSelect(this,i),i}mapSelected(t,e,r){let i;if(t.willTransform(this),0!==t.scopeDepth){let n=t.popScope();if(n instanceof gr){const i=n.iterator();for(;i.hasNext();){const s=i.next().value;if(s instanceof hr){const o=s.key;t.pushScope(o);const a=this.then.mapSelected(t,e,r).toValue();t.popScope(),a.isDefined()?o!==a&&(n instanceof cr&&a instanceof kr?i.set(cr.of(a,n.toValue())):i.set(fr.of(a,n.toValue()))):i.delete()}}}else if(n instanceof hr){const i=n.key;t.pushScope(i);const s=this.then.mapSelected(t,e,r).toValue();t.popScope(),s.isDefined()?i!==s&&(n=n instanceof cr&&s instanceof kr?cr.of(s,n.toValue()):fr.of(s,n.toValue())):n=ar.absent()}t.pushScope(n),i=n}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);let e=this.then.substitute(t);return e instanceof li||(e=this.then),new mi(e)}andThen(t){return new mi(this.then.andThen(t))}get typeOrder(){return 15}compareTo(t){return t instanceof mi?this.then.compareTo(t.then):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof mi&&this.then.equivalentTo(t.then,e)}equals(t){return this===t||t instanceof mi&&this.then.equals(t.then)}hashCode(){return s.mash(s.mix(g.hash(mi),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("keys").write(40).write(41),t=this.then.debugThen(t)}clone(){return new mi(this.then.clone())}}class yi extends li{constructor(t){super(),this.then=t}forSelected(t,e,r){let i;if(t.willSelect(this),0!==t.scopeDepth){const n=t.popScope();if(n instanceof gr){const s=n.iterator();for(;void 0===i&&s.hasNext();){const n=s.next().value;t.pushScope(n.toValue()),i=this.then.forSelected(t,e,r),t.popScope()}}else t.pushScope(n.toValue()),i=this.then.forSelected(t,e,r),t.popScope();t.pushScope(n)}return t.didSelect(this,i),i}mapSelected(t,e,r){let i;if(t.willTransform(this),0!==t.scopeDepth){let n=t.popScope();if(n instanceof gr){const i=n.iterator();for(;i.hasNext();){const n=i.next().value;if(n instanceof hr){const s=n.toValue();t.pushScope(s);const o=this.then.mapSelected(t,e,r);t.popScope(),o.isDefined()?o instanceof hr?i.set(o):o!==s&&i.set(n.updatedValue(o.toValue())):i.delete()}else{t.pushScope(n.toValue());const s=this.then.mapSelected(t,e,r);t.popScope(),s.isDefined()?n!==s&&i.set(s):i.delete()}}}else if(n instanceof hr){const i=n.toValue();t.pushScope(i);const s=this.then.mapSelected(t,e,r);t.popScope(),s.isDefined()?s instanceof hr?n=s:s!==i&&(n=n.updatedValue(s.toValue())):n=ar.absent()}else t.pushScope(n),n=this.then.mapSelected(t,e,r),t.popScope();t.pushScope(n),i=n}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);let e=this.then.substitute(t);return e instanceof li||(e=this.then),new yi(e)}andThen(t){return new yi(this.then.andThen(t))}get typeOrder(){return 16}compareTo(t){return t instanceof yi?this.then.compareTo(t.then):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof yi&&this.then.equivalentTo(t.then,e)}equals(t){return this===t||t instanceof yi&&this.then.equals(t.then)}hashCode(){return s.mash(s.mix(g.hash(yi),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("values").write(40).write(41),t=this.then.debugThen(t)}clone(){return new yi(this.then.clone())}}class gi extends li{constructor(t){super(),this.then=t}forSelected(t,e,r){let i;if(t.willSelect(this),0!==t.scopeDepth){const n=t.popScope().toValue();if(n instanceof gr){const s=n.iterator();for(;void 0===i&&s.hasNext();){const n=s.next().value;t.pushScope(n),i=this.then.forSelected(t,e,r),t.popScope()}}t.pushScope(n)}return t.didSelect(this,i),i}mapSelected(t,e,r){let i;if(t.willTransform(this),0!==t.scopeDepth){const r=t.popScope().toValue();if(r instanceof gr){const i=r.iterator();for(;i.hasNext();){const r=i.next().value;t.pushScope(r);const n=this.then.mapSelected(t,e);t.popScope(),n.isDefined()?n!==r&&i.set(n):i.delete()}}t.pushScope(r),i=r}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);let e=this.then.substitute(t);return e instanceof li||(e=this.then),new gi(e)}andThen(t){return new gi(this.then.andThen(t))}get typeOrder(){return 17}compareTo(t){return t instanceof gi?this.then.compareTo(t.then):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof gi&&this.then.equivalentTo(t.then,e)}equals(t){return this===t||t instanceof gi&&this.then.equals(t.then)}hashCode(){return s.mash(s.mix(g.hash(gi),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("children").write(40).write(41),t=this.then.debugThen(t)}clone(){return new gi(this.then.clone())}}class wi extends li{constructor(t){super(),this.then=t}forSelected(t,e,r){let i;if(t.willSelect(this),0!==t.scopeDepth){const n=t.popScope().toValue();if(n instanceof gr){const s=n.iterator();for(;void 0===i&&s.hasNext();){const n=s.next().value;t.pushScope(n),i=this.then.forSelected(t,e,r),void 0===i&&this.forSelected(t,e,r),t.popScope()}}t.pushScope(n)}return t.didSelect(this,i),i}mapSelected(t,e,r){let i;if(t.willTransform(this),0!==t.scopeDepth){const n=t.popScope().toValue();if(n instanceof gr){const i=n.iterator();for(;i.hasNext();){const n=i.next().value;t.pushScope(n);let s=this.then.mapSelected(t,e,r);s.isDefined()&&(s=this.mapSelected(t,e,r)),t.popScope(),s.isDefined()?s!==n&&i.set(s):i.delete()}}t.pushScope(n),i=n}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);let e=this.then.substitute(t);return e instanceof li||(e=this.then),new wi(e)}andThen(t){return new wi(this.then.andThen(t))}get typeOrder(){return 18}compareTo(t){return t instanceof wi?this.then.compareTo(t.then):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof wi&&this.then.equivalentTo(t.then,e)}equals(t){return this===t||t instanceof wi&&this.then.equals(t.then)}hashCode(){return s.mash(s.mix(g.hash(wi),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("descendants").write(40).write(41),t=this.then.debugThen(t)}clone(){return new wi(this.then.clone())}}class bi extends li{constructor(t,e){super(),this.predicate=t,this.then=e}forSelected(t,e,r){let i;return t.willSelect(this),0!==t.scopeDepth&&this.filterSelected(t)&&(i=this.then.forSelected(t,e,r)),t.didSelect(this,i),i}mapSelected(t,e,r){let i;return t.willTransform(this),i=0!==t.scopeDepth?this.filterSelected(t)?this.then.mapSelected(t,e,r):t.peekScope().toValue():ar.absent(),t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);let e=this.predicate.substitute(t);e instanceof li||(e=this.predicate);let r=this.then.substitute(t);return r instanceof li||(r=this.then),new bi(e,r)}filterSelected(t){return void 0!==this.predicate.forSelected(t,this.selected,this)}selected(t){return null}andThen(t){return new bi(this.predicate,this.then.andThen(t))}filter(t){return 0===arguments.length?this:(t=ar.fromLike(t),this.andThen(t.filter()))}get typeOrder(){return 19}compareTo(t){if(t instanceof bi){let e=this.predicate.compareTo(t.predicate);return 0===e&&(e=this.then.compareTo(t.then)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof bi&&(this.predicate.equivalentTo(t.predicate,e)&&this.then.equivalentTo(t.then,e))}equals(t){return this===t||t instanceof bi&&(this.predicate.equals(t.predicate)&&this.then.equals(t.then))}hashCode(){return s.mash(s.mix(s.mix(g.hash(bi),this.predicate.hashCode()),this.then.hashCode()))}debugThen(t){return t=t.write(46).write("filter").write(40).debug(this.predicate).write(41),t=this.then.debugThen(t)}clone(){return new bi(this.predicate.clone(),this.then.clone())}}class vi extends li{constructor(t,e){super(),this.item=t.commit(),this.then=e}forSelected(t,e,r){let i;if(t.willSelect(this),0!==t.scopeDepth){const n=this.item.evaluate(t);n.isDefined()&&(t.pushScope(n),i=this.then.forSelected(t,e,r),t.popScope())}return t.didSelect(this,i),i}mapSelected(t,e,r){let i;if(t.willTransform(this),0!==t.scopeDepth){let n=this.item.evaluate(t);n.isDefined()&&(t.pushScope(n),n=this.then.mapSelected(t,e,r),t.popScope()),i=n}else i=ar.absent();return t.didTransform(this,i),i}substitute(t){t=Rr.fromLike(t);const e=this.item.substitute(t);let r=this.then.substitute(t);return r instanceof li||(r=this.then),new vi(e,r)}andThen(t){return new vi(this.item,this.then.andThen(t))}get precedence(){return this.item.precedence}get typeOrder(){return 11}compareTo(t){if(t instanceof vi){let e=this.item.compareTo(t.item);return 0===e&&(e=this.then.compareTo(t.then)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof vi&&(this.item.equivalentTo(t.item,e)&&this.then.equivalentTo(t.then,e))}equals(t){return this===t||t instanceof vi&&(this.item.equals(t.item)&&this.then.equals(t.then))}hashCode(){return s.mash(s.mix(s.mix(g.hash(vi),this.item.hashCode()),this.then.hashCode()))}debug(t){return t=t.write("Selector").write(46).write("literal").write(40).debug(this.item).write(41),t=this.then.debugThen(t)}debugThen(t){return t}clone(){return new vi(this.item.clone(),this.then.clone())}}class xi extends Dr{constructor(){super()}isConstant(){return!1}expand(t,e,r){}}class Si extends xi{constructor(t,e){super(),this.bindings=t,this.template=e}get precedence(){return 1}invoke(t,e,r){e=Rr.fromLike(e);const i=this.bindings,n=Math.max(1,i.length),s=gr.create(n);let o=0,a=0;for(;o<n;){const e=i instanceof gr?i.getItem(o):0===o?i:ar.absent(),r=t instanceof gr?t.getItem(a).toValue():0===a?t:mr.absent();e instanceof kr&&r.isDistinct()?(s.push(fr.of(e,r)),a+=1):e instanceof fr&&(r.isDistinct()?s.push(e.updatedValue(r)):s.push(e),a+=1),o+=1}e.pushScope(s);const u=this.template.evaluate(e);return e.popScope(),u}get typeOrder(){return 50}compareTo(t){if(t instanceof Si){let e=this.bindings.compareTo(t.bindings);return 0===e&&(e=this.template.compareTo(t.template)),e}return t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t,e){return this===t||t instanceof Si&&(this.bindings.equivalentTo(t.bindings,e)&&this.template.equivalentTo(t.template,e))}equals(t){return this===t||t instanceof Si&&(this.bindings.equals(t.bindings)&&this.template.equals(t.template))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Si),this.bindings.hashCode()),this.template.hashCode()))}debug(t){return t=t.debug(this.bindings).write(46).write("lambda").write(40).debug(this.template).write(41)}}class Ci extends xi{get typeOrder(){return 51}compareTo(t){return t instanceof Ci?g.compare(this.constructor,t.constructor):t instanceof ar?f.compare(this.typeOrder,t.typeOrder):NaN}equivalentTo(t){return this===t}equals(t){return this===t}hashCode(){return g.hash(this.constructor)}debug(t){return t=t.write(this.constructor.name)}}const ki=function(){const t={};Object.defineProperty(t,"max",{get(){const r=new e;return Object.defineProperty(t,"max",{value:r,enumerable:!0,configurable:!0}),r},enumerable:!0,configurable:!0}),Object.defineProperty(t,"min",{get(){const e=new r;return Object.defineProperty(t,"min",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"abs",{get(){const e=new i;return Object.defineProperty(t,"abs",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ceil",{get(){const e=new n;return Object.defineProperty(t,"ceil",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"floor",{get(){const e=new s;return Object.defineProperty(t,"floor",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"round",{get(){const e=new o;return Object.defineProperty(t,"round",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"sqrt",{get(){const e=new a;return Object.defineProperty(t,"sqrt",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pow",{get(){const e=new u;return Object.defineProperty(t,"pow",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"rate",{get(){const e=new h;return Object.defineProperty(t,"rate",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"random",{get(){const e=new l;return Object.defineProperty(t,"random",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"scope",{get(){const e=gr.create(10).slot("max",t.max).slot("min",t.min).slot("abs",t.abs).slot("ceil",t.ceil).slot("floor",t.floor).slot("round",t.round).slot("pow",t.pow).slot("sqrt",t.sqrt).slot("rate",t.rate).slot("random",t.random).commit();return Object.defineProperty(t,"scope",{value:e,configurable:!0,enumerable:!0}),e},enumerable:!0,configurable:!0});class e extends Ci{invoke(t,e,r){let i,n;if(e=Rr.fromLike(e),t.length>=2?(i=t.getItem(0).evaluate(e),n=t.getItem(1).evaluate(e)):i=t.evaluate(e),void 0!==n)return i.max(n);if(void 0!==r){n=r.state;const t=void 0!==n?i.max(n):i;return r.setState(t),t}return ar.absent()}expand(t,e,r){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,r)}}class r extends Ci{invoke(t,e,r){let i,n;if(e=Rr.fromLike(e),t.length>=2?(i=t.getItem(0).evaluate(e),n=t.getItem(1).evaluate(e)):i=t.evaluate(e),void 0!==n)return i.min(n);if(void 0!==r){n=r.state;const t=void 0!==n?i.min(n):i;return r.setState(t),t}return ar.absent()}expand(t,e,r){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,r)}}class i extends Ci{invoke(t,e,r){return(t=t.evaluate(e).toValue())instanceof Or?t.abs():ar.absent()}}class n extends Ci{invoke(t,e,r){return(t=t.evaluate(e).toValue())instanceof Or?t.ceil():ar.absent()}}class s extends Ci{invoke(t,e,r){return(t=t.evaluate(e).toValue())instanceof Or?t.floor():ar.absent()}}class o extends Ci{invoke(t,e,r){return(t=t.evaluate(e).toValue())instanceof Or?t.round():ar.absent()}}class a extends Ci{invoke(t,e,r){return(t=t.evaluate(e).toValue())instanceof Or?t.sqrt():ar.absent()}}class u extends Ci{invoke(t,e,r){e=Rr.fromLike(e);const i=t.getItem(0).evaluate(e),n=t.getItem(1).evaluate(e);return i instanceof Or&&n instanceof Or?i.pow(n):ar.absent()}}class h extends Ci{invoke(t,e,r){let i,n;if(e=Rr.fromLike(e),t.length>=2?(i=t.getItem(0).evaluate(e).numberValue(NaN),n=t.getItem(1).evaluate(e).numberValue(1e3)):(i=t.evaluate(e).numberValue(NaN),n=1e3),isFinite(i)&&void 0!==r){let t=r.state;if(void 0===t)t={v0:i,t0:Date.now(),dv:0,dt:0},r.setState(t);else{const e=Date.now(),s=e-t.t0;if(s>n&&e>t.t0||s>2*n){const r=i-t.v0;t.v0=i,t.t0=e,t.dv=r,t.dt=s}if(r.setState(t),0!==t.dt){const e=n*t.dv/t.dt;return Or.from(e)}}}return ar.absent()}expand(t,e,r){return t=t.evaluate(e).toValue(),this.invoke(t,e,r)}}class l extends Ci{invoke(t,e,r){const i=(t=t.evaluate(e).toValue()).length>=1?t.getItem(0).numberValue(0):0,n=t.length>=2?t.getItem(1).numberValue(i+1):i+1,s=i+Math.random()*(n-i);return Or.from(s)}}return t}();class Mi extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Mi.prototype)}}let Oi=(()=>{var t;let i,n,s,a,u,h,l=[];return t=class{withTag(t){return void 0===t||t===this.tag?this:new Ei(this,t)}withUnit(t){return t===this.unit?this:new Ti(this,t)}static forString(){return new Pi("")}static forNumber(){return new Ii(0)}static forBoolean(){return new Di(!1)}static forAny(){return new Li(void 0)}static forItem(){return new qi(ar.absent())}static forValue(){return new Ai(mr.absent())}},(()=>{const c="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],s=[o],a=[o],u=[o],h=[o],e(t,null,i,{kind:"method",name:"forString",static:!0,private:!1,access:{has:t=>"forString"in t,get:t=>t.forString},metadata:c},null,l),e(t,null,n,{kind:"method",name:"forNumber",static:!0,private:!1,access:{has:t=>"forNumber"in t,get:t=>t.forNumber},metadata:c},null,l),e(t,null,s,{kind:"method",name:"forBoolean",static:!0,private:!1,access:{has:t=>"forBoolean"in t,get:t=>t.forBoolean},metadata:c},null,l),e(t,null,a,{kind:"method",name:"forAny",static:!0,private:!1,access:{has:t=>"forAny"in t,get:t=>t.forAny},metadata:c},null,l),e(t,null,u,{kind:"method",name:"forItem",static:!0,private:!1,access:{has:t=>"forItem"in t,get:t=>t.forItem},metadata:c},null,l),e(t,null,h,{kind:"method",name:"forValue",static:!0,private:!1,access:{has:t=>"forValue"in t,get:t=>t.forValue},metadata:c},null,l),c&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:c}),r(t,l)})(),t})();Object.defineProperty(Oi.prototype,"tag",{get(){},configurable:!0}),Object.defineProperty(Oi.prototype,"unit",{get(){},configurable:!0});class Ei extends Oi{constructor(t,e){super(),this.form=t,this.tag=e}withTag(t){return void 0!==t&&t!==this.tag?new Ei(this.form,t):void 0===t?this.form:this}withUnit(t){return t===this.unit?this:new Ei(this.form.withUnit(t),this.tag)}mold(t,e){return(e=this.form.mold(t,e)).header(this.tag).isDefined()||(e=e.prepended(cr.of(this.tag))),e}cast(t,e){return t.header(this.tag).isDefined()?this.form.cast(t,e):t.keyEquals(this.tag)?this.form.cast(t.toValue(),e):void 0}}Object.defineProperty(Ei.prototype,"unit",{get(){return this.form.unit},configurable:!0});class Ti extends Oi{constructor(t,e){super(),this.form=t,Object.defineProperty(this,"unit",{value:e,enumerable:!0,configurable:!0})}withTag(t){return t===this.tag?this:new Ti(this.form.withTag(t),this.unit)}withUnit(t){return t!==this.unit?new Ti(this.form,t):t===this.form.unit?this.form:this}mold(t,e){return 1===arguments.length?this.form.mold(t):this.form.mold(t,e)}cast(t,e){return 1===arguments.length?this.form.cast(t):this.form.cast(t,e)}}Object.defineProperty(Ti.prototype,"tag",{get(){return this.form.tag},configurable:!0});class Pi extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Pi(t)}mold(t,e){return void 0===e?kr.from(t):e.concat(kr.from(t))}cast(t,e){const r=t.target;try{return r.stringValue()}catch(t){return}}}class Ii extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Ii(t)}mold(t,e){return void 0===e?Or.from(t):e.concat(Or.from(t))}cast(t,e){const r=t.target;try{return r.numberValue()}catch(t){return}}}class Di extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Di(t)}mold(t,e){return void 0===e?Tr.from(t):e.concat(Tr.from(t))}cast(t,e){const r=t.target;try{return r.booleanValue()}catch(t){return}}}class Li extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Li(t)}mold(t,e){return t=ar.fromLike(t),void 0!==e&&(t=e.concat(t)),t}cast(t,e){return t.toLike()}}class qi extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new qi(t)}mold(t,e){return t=ar.fromLike(t),void 0!==e&&(t=e.concat(t)),t}cast(t,e){return t}}class Ai extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Ai(t)}mold(t,e){return t=mr.fromLike(t),void 0!==e&&(t=e.concat(t)),t}cast(t,e){return t.toValue()}}const Fi=function(){const t={};return Object.defineProperty(t,"structureParser",{value:function(){const e=new fn;return Object.defineProperty(t,"structureParser",{value:function(){return e},enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"structureWriter",{value:function(){const e=new zn;return Object.defineProperty(t,"structureWriter",{value:function(){return e},enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),t.parse=function(e){return t.structureParser().parseBlockString(e)},t.parser=function(){return t.structureParser().blockParser()},t.sizeOf=function(e){return t.structureWriter().sizeOfItem(e)},t.sizeOfBlock=function(e){return t.structureWriter().sizeOfBlockItem(e)},t.write=function(e,r){return t.structureWriter().writeItem(e,r)},t.writeBlock=function(e,r){return t.structureWriter().writeBlockItem(e,r)},t.toString=function(e){let r=xt.stringOutput();const i=t.write(r,e);return i.isDone()||(r=yt.error(i.trap())),r.bind()},t.toBlockString=function(e){let r=xt.stringOutput();const i=t.writeBlock(r,e);return i.isDone()||(r=yt.error(i.trap())),r.bind()},t.toData=function(e){let r=re.encodedOutput(Sr.output());const i=t.write(r,e);return i.isDone()||(r=yt.error(i.trap())),r.bind()},t.toBlockData=function(e){let r=re.encodedOutput(Sr.output());const i=t.writeBlock(r,e);return i.isDone()||(r=yt.error(i.trap())),r.bind()},t.isSpace=function(t){return 32===t||9===t},t.isNewline=function(t){return 10===t||13===t},t.isWhitespace=function(e){return t.isSpace(e)||t.isNewline(e)},t.isIdentStartChar=function(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},t.isIdentChar=function(t){return 45===t||t>=48&&t<=57||t>=65&&t<=90||95===t||t>=97&&t<=122||183===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},ar.prototype.toRecon=function(){return t.toString(this)},ar.prototype.toReconBlock=function(){return t.toBlockString(this)},t}();mr.parseRecon=function(t){return Fi.parse(t)};class Vi extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.keyParser=r,this.valueParser=i,this.step=n}feed(t){return Vi.parse(t,this.recon,this.builder,this.keyParser,this.valueParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;t:for(;;){if(1===s){for(;t.isCont()&&(o=t.head(),Fi.isWhitespace(o));)t=t.step();if(t.isCont())if(33===o||34===o||36===o||37===o||39===o||40===o||43===o||45===o||o>=48&&o<=57||64===o||91===o||96===o||123===o||126===o||Fi.isIdentStartChar(o))r=r||e.valueBuilder(),s=2;else{if(35!==o)return void 0!==r?Nt.done(r.build()):Nt.done(e.absent());t=t.step(),s=7}else if(t.isDone())return void 0!==r?Nt.done(r.build()):Nt.done(e.absent())}if(2===s){for(void 0===i&&(i=e.parseBlockExpression(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=3;else if(i.isError())return i}if(3===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont())58===o?(t=t.step(),s=4):(r.push(e.item(i.bind())),i=void 0,s=6);else if(t.isDone())return r.push(e.item(i.bind())),Nt.done(r.build())}if(4===s){for(;t.isCont()&&Fi.isSpace(t.head());)t=t.step();if(t.isCont())s=5;else if(t.isDone())return r.push(e.slot(i.bind())),Nt.done(r.build())}if(5===s){for(void 0===n&&(n=e.parseBlockExpression(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())r.push(e.slot(i.bind(),n.bind())),i=void 0,n=void 0,s=6;else if(n.isError())return n}if(6===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(44===o||59===o||Fi.isNewline(o)){t=t.step(),s=1;continue}if(35!==o)return Nt.done(r.build());t=t.step(),s=7}else if(t.isDone())return Nt.done(r.build())}if(7===s){for(;t.isCont();){if(o=t.head(),Fi.isNewline(o)){s=1;continue t}t=t.step()}if(t.isDone()){s=1;continue}}break}return new Vi(e,r,i,n,s)}}class zi extends Nt{constructor(t,e,r,i){super(),this.recon=t,this.keyParser=e,this.valueParser=r,this.step=i}feed(t){return zi.parse(t,this.recon,this.keyParser,this.valueParser,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n)if(t.isCont()){if(s=t.head(),64!==s)return Nt.error(kt.expected(64,t));t=t.step(),n=2}else if(t.isDone())return Nt.error(kt.expected(64,t));if(2===n){if(void 0===r){if(t.isCont())if(s=t.head(),34===s||39===s)r=e.parseString(t);else{if(!Fi.isIdentStartChar(s))return Nt.error(kt.expected("attribute name",t));r=e.parseIdent(t)}else if(t.isDone())return Nt.error(kt.expected("attribute name",t))}else r=r.feed(t);if(void 0!==r)if(r.isDone())n=3;else if(r.isError())return r.asError()}if(3===n)if(t.isCont()&&40===t.head())t=t.step(),n=4;else if(!t.isEmpty())return Nt.done(e.attr(r.bind()));if(4===n){for(;t.isCont()&&(s=t.head(),Fi.isWhitespace(s));)t=t.step();if(t.isCont()){if(41===s)return t=t.step(),Nt.done(e.attr(r.bind()));n=5}else if(t.isDone())return Nt.error(kt.expected(")",t))}if(5===n){for(void 0===i&&(i=e.parseBlock(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())n=6;else if(i.isError())return i.asError()}if(6===n){for(;t.isCont()&&(s=t.head(),Fi.isWhitespace(s));)t=t.step();if(t.isCont())return 41===s?(t=t.step(),Nt.done(e.attr(r.bind(),i.bind()))):Nt.error(kt.expected(")",t));if(t.isDone())return Nt.error(kt.expected(")",t))}return new zi(e,r,i,n)}}class ji extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.fieldParser=r,this.valueParser=i,this.step=n}feed(t){return ji.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;for(;;){if(1===s)if(t.isCont())if(o=t.head(),64===o)i=e.parseAttr(t),s=2;else if(123===o)r=r||e.recordBuilder(),n=e.parseRecord(t,r),s=5;else if(91===o)r=r||e.recordBuilder(),n=e.parseMarkup(t,r),s=5;else if(Fi.isIdentStartChar(o))n=e.parseIdent(t),s=4;else if(34===o||39===o)n=e.parseString(t),s=4;else if(96===o)n=e.parseRawString(t),s=4;else if(45===o||o>=48&&o<=57)n=e.parseNumber(t),s=4;else if(37===o)n=e.parseData(t),s=4;else{if(36!==o)return void 0===r?Nt.done(e.extant()):Nt.done(r.build());n=e.parseSelector(t),s=4}else if(t.isDone())return void 0===r?Nt.done(e.extant()):Nt.done(r.build());if(2===s){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())(r=r||e.valueBuilder()).push(i.bind()),i=void 0,s=3;else if(i.isError())return i.asError()}if(3===s){for(;t.isCont()&&Fi.isSpace(t.head());)t=t.step();if(t.isCont()){s=1;continue}if(t.isDone())return Nt.done(r.build())}if(4===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())(r=r||e.valueBuilder()).push(e.item(n.bind())),n=void 0,s=6;else if(n.isError())return n}if(5===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())n=void 0,s=6;else if(n.isError())return n}if(6===s){for(;t.isCont()&&Fi.isSpace(t.head());)t=t.step();if(t.isCont()){if(64!==t.head())return Nt.done(r.build());s=1}else if(t.isDone())return Nt.done(r.build())}break}return new ji(e,r,i,n,s)}}class Ni extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.fieldParser=r,this.valueParser=i,this.step=n}feed(t){return Ni.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s)if(t.isCont())if(o=t.head(),64===o)i=e.parseAttr(t),s=2;else if(123===o)void 0!==r?(n=e.parseRecord(t,r),s=5):(n=e.parseRecord(t),s=4);else{if(91!==o)return void 0===r?Nt.done(e.extant()):Nt.done(r.build());void 0!==r?(n=e.parseMarkup(t,r),s=5):(n=e.parseMarkup(t),s=4)}else if(t.isDone())return void 0===r?Nt.done(e.extant()):Nt.done(r.build());if(2===s){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())(r=r||e.valueBuilder()).push(i.bind()),i=void 0,s=3;else if(i.isError())return i.asError()}if(3===s)if(t.isCont())if(o=t.head(),123===o)n=e.parseRecord(t,r),s=5;else{if(91!==o)return Nt.done(r.build());n=e.parseMarkup(t,r),s=5}else if(t.isDone())return Nt.done(r.build());if(4===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())return(r=r||e.valueBuilder()).push(e.item(n.bind())),Nt.done(r.build());if(n.isError())return n}if(5===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())return Nt.done(r.build());if(n.isError())return n}return new Ni(e,r,i,n,s)}}class Ui extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.keyParser=r,this.valueParser=i,this.step=n}feed(t){return Ui.parse(t,this.recon,this.builder,this.keyParser,this.valueParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s)if(t.isCont()){if(o=t.head(),123!==o)return Nt.error(kt.expected(123,t));t=t.step(),s=2}else if(t.isDone())return Nt.error(kt.expected(123,t));t:for(;;){if(2===s){for(;t.isCont()&&(o=t.head(),Fi.isWhitespace(o));)t=t.step();if(t.isCont()){if(r=r||e.recordBuilder(),125===o)return t=t.step(),Nt.done(r.build());35===o?(t=t.step(),s=8):s=3}else if(t.isDone())return Nt.error(kt.expected(125,t))}if(3===s){for(void 0===i&&(i=e.parseBlockExpression(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=4;else if(i.isError())return i}if(4===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont())58===o?(t=t.step(),s=5):(r.push(e.item(i.bind())),i=void 0,s=7);else if(t.isDone())return Nt.error(kt.expected(125,t))}if(5===s){for(;t.isCont()&&Fi.isSpace(t.head());)t=t.step();if(t.isCont())s=6;else if(t.isDone())return r.push(e.slot(i.bind())),Nt.done(r.build())}if(6===s){for(void 0===n&&(n=e.parseBlockExpression(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())r.push(e.slot(i.bind(),n.bind())),i=void 0,n=void 0,s=7;else if(n.isError())return n}if(7===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(44===o||59===o||Fi.isNewline(o)){t=t.step(),s=2;continue}if(35!==o)return 125===o?(t=t.step(),Nt.done(r.build())):Nt.error(kt.expected("'}', ';', ',', or newline",t));t=t.step(),s=8}else if(t.isDone())return Nt.error(kt.expected(125,t))}if(8===s){for(;t.isCont();){if(o=t.head(),Fi.isNewline(o)){s=2;continue t}t=t.step()}if(t.isDone()){s=2;continue}}break}return new Ui(e,r,i,n,s)}}class Ri extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.textOutput=r,this.valueParser=i,this.step=n}feed(t){return Ri.parse(t,this.recon,this.builder,this.textOutput,this.valueParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s)if(t.isCont()){if(o=t.head(),91!==o)return Nt.error(kt.expected(91,t));t=t.step(),s=2}else if(t.isDone())return Nt.error(kt.expected(91,t));for(;;){if(2===s){for(;t.isCont()&&(o=t.head(),64!==o&&91!==o&&92!==o&&93!==o&&123!==o&&125!==o);)t=t.step(),(i=i||e.textOutput()).write(o);if(t.isCont()){if(93===o)return t=t.step(),r=r||e.recordBuilder(),void 0!==i&&r.push(e.item(i.bind())),Nt.done(r.build());if(64===o)r=r||e.recordBuilder(),void 0!==i&&(r.push(e.item(i.bind())),i=void 0),n=e.parseInlineItem(t),s=3;else if(123===o)r=r||e.recordBuilder(),void 0!==i&&(r.push(e.item(i.bind())),i=void 0),n=e.parseRecord(t,r),s=4;else if(91===o)r=r||e.recordBuilder(),void 0!==i&&(r.push(e.item(i.bind())),i=void 0),n=e.parseMarkup(t,r),s=4;else{if(92!==o)return Nt.error(kt.unexpected(t));t=t.step(),s=5}}else if(t.isDone())return Nt.error(kt.unexpected(t))}if(3===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){r.push(e.item(n.bind())),n=void 0,s=2;continue}if(n.isError())return n}if(4===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){n=void 0,s=2;continue}if(n.isError())return n}if(5===s){if(t.isCont()){if(o=t.head(),i=i||e.textOutput(),34===o||36===o||39===o||47===o||64===o||91===o||92===o||93===o||123===o||125===o)t=t.step(),i.write(o),s=2;else if(98===o)t=t.step(),i.write(8),s=2;else if(102===o)t=t.step(),i.write(12),s=2;else if(110===o)t=t.step(),i.write(10),s=2;else if(114===o)t=t.step(),i.write(13),s=2;else{if(116!==o)return Nt.error(kt.expected("escape character",t));t=t.step(),i.write(9),s=2}continue}if(t.isDone())return Nt.error(kt.expected("escape character",t))}break}return new Ri(e,r,i,n,s)}}class Bi extends Nt{constructor(t,e,r){super(),this.recon=t,this.base64Parser=e,this.step=r}feed(t){return Bi.parse(t,this.recon,this.base64Parser,this.step)}static parse(t,e,r,i=1){let n=0;if(1===i)if(t.isCont()){if(n=t.head(),37!==n)return Nt.error(kt.expected(37,t));t=t.step(),i=2}else if(t.isDone())return Nt.error(kt.expected(37,t));if(2===i){for(void 0===r&&(r=he.standard().parse(t,e.dataOutput()));r.isCont()&&!t.isEmpty();)r=r.feed(t);if(r.isDone())return r;if(r.isError())return r}return new Bi(e,r,i)}}class Yi extends Nt{constructor(t,e,r){super(),this.recon=t,this.output=e,this.step=r}feed(t){return Yi.parse(t,this.recon,this.output,this.step)}static parse(t,e,r,i=1){let n=0;if(1===i)if(t.isCont()){if(n=t.head(),!Fi.isIdentStartChar(n))return Nt.error(kt.expected("identifier",t));t=t.step(),r=(r=r||e.textOutput()).write(n),i=2}else if(t.isDone())return Nt.error(kt.expected("identifier",t));if(2===i){for(;t.isCont()&&(n=t.head(),Fi.isIdentChar(n));)t=t.step(),r.write(n);if(!t.isEmpty())return Nt.done(e.ident(r.bind()))}return new Yi(e,r,i)}}class Hi extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.output=e,this.quote=r,this.code=i,this.step=n}feed(t){return Hi.parse(t,this.recon,this.output,this.quote,this.code,this.step)}static parse(t,e,r,i=0,n=0,s=1){let o=0;if(1===s){for(;t.isCont()&&(o=t.head(),Fi.isWhitespace(o));)t=t.step();if(t.isCont()){if(34!==o&&39!==o||i!==o&&0!==i)return Nt.error(kt.expected("string",t));t=t.step(),r=r||e.textOutput(),i=o,s=2}else if(t.isDone())return Nt.error(kt.expected("string",t))}t:for(;;){if(2===s){for(;t.isCont()&&(o=t.head(),o>=32&&o!==i&&92!==o);)t=t.step(),r=r.write(o);if(t.isCont()){if(o===i)return t=t.step(),Nt.done(r.bind());if(92!==o)return Nt.error(kt.expected(i,t));t=t.step(),s=3}else if(t.isDone())return Nt.error(kt.expected(i,t))}if(3===s)if(t.isCont()){if(o=t.head(),34===o||36===o||39===o||47===o||64===o||91===o||92===o||93===o||123===o||125===o){t=t.step(),r=r.write(o),s=2;continue}if(98===o){t=t.step(),r=r.write(8),s=2;continue}if(102===o){t=t.step(),r=r.write(12),s=2;continue}if(110===o){t=t.step(),r=r.write(10),s=2;continue}if(114===o){t=t.step(),r=r.write(13),s=2;continue}if(116===o){t=t.step(),r=r.write(9),s=2;continue}if(117!==o)return Nt.error(kt.expected("escape character",t));t=t.step(),s=4}else if(t.isDone())return Nt.error(kt.expected("escape character",t));if(s>=4)for(;;){if(t.isCont()){if(o=t.head(),_t.isDigit(o)){if(t=t.step(),n=16*n+_t.decodeDigit(o),s<=6){s+=1;continue}r=r.write(n),n=0,s=2;continue t}return Nt.error(kt.expected("hex digit",t))}if(t.isDone())return Nt.error(kt.expected("hex digit",t));break}break}return new Hi(e,r,i,n,s)}}class Wi extends Nt{constructor(t,e,r,i){super(),this.recon=t,this.output=e,this.count=r,this.step=i}feed(t){return Wi.parse(t,this.recon,this.output,this.count,this.step)}static parse(t,e,r,i=0,n=1){let s=0;if(1===n){for(;t.isCont()&&(s=t.head(),Fi.isWhitespace(s));)t=t.step();if(t.isCont()&&96===s)t=t.step(),i=1,n=2;else if(t.isDone())return Nt.error(kt.expected("raw string",t))}if(2===n)if(t.isCont())96===t.head()?(t=t.step(),i=2,n=3):(r=r||e.textOutput(),n=4);else if(t.isDone())return Nt.error(kt.expected("raw string",t));if(3===n)if(t.isCont()){if(96!==t.head())return r=r||e.textOutput(),Nt.done(r.bind());t=t.step(),r=r||e.textOutput(),i=3,n=4}else if(t.isDone())return r=r||e.textOutput(),Nt.done(r.bind());for(;;){if(4===n){for(;t.isCont()&&(s=t.head(),(1!==i||s>=32)&&96!==s&&92!==s);)t=t.step(),r=r.write(s);if(t.isCont())if(92===s)t=t.step(),n=5;else{if(96!==s)return Nt.error(kt.expected(96,t));if(t=t.step(),1===i)return Nt.done(r.bind());n=6}else if(t.isDone())return Nt.error(kt.expected(96,t))}if(5===n){if(t.isCont()){s=t.head(),t=t.step(),92!==s&&96!==s&&(r=r.write(92)),r=r.write(s),n=4;continue}if(t.isDone())return Nt.error(kt.expected("escape character",t))}if(6===n)if(t.isCont()){if(96!==t.head()){r=r.write(96),n=4;continue}t=t.step(),n=7}else if(t.isDone())return Nt.error(kt.message("unclosed raw string",t));if(7===n){if(t.isCont()){if(96===t.head())return t=t.step(),Nt.done(r.bind());r=(r=r.write(96)).write(96),n=4;continue}if(t.isDone())return Nt.error(kt.message("unclosed raw string",t))}break}return new Wi(e,r,i,n)}}class Xi extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.sign=e,this.value=r,this.mode=i,this.step=n}feed(t){return Xi.parse(t,this.recon,this.sign,this.value,this.mode,this.step)}static parse(t,e,r=1,i=0,n=2,s=1){let o=0;if(1===s){for(;t.isCont()&&(o=t.head(),Fi.isWhitespace(o));)t=t.step();if(t.isCont())45===o&&(t=t.step(),r=-1),s=2;else if(t.isDone())return Nt.error(kt.expected("number",t))}if(2===s)if(t.isCont())if(o=t.head(),48===o)t=t.step(),s=4;else{if(!(o>=49&&o<=57))return Nt.error(kt.expected("digit",t));t=t.step(),i=r*(o-48),s=3}else if(t.isDone())return Nt.error(kt.expected("digit",t));if(3===s){for(;t.isCont()&&(o=t.head(),o>=48&&o<=57);){const e=10*i+r*(o-48);if(!(-9007199254740991<=e&&e<=9007199254740992))return Nt.error(kt.message("integer overflow",t));i=e,t=t.step()}if(t.isCont())s=4;else if(t.isDone())return Nt.done(e.num(i))}if(4===s){if(t.isCont()){if(o=t.head(),n>0&&46===o||n>1&&(69===o||101===o)){let s=xt.stringOutput();return s=r<0&&0===i?s.write(45).write(48):s.write(""+i),Ki.parse(t,e,s,n)}return 120===o&&r>0&&0===i?(t=t.step(),Gi.parse(t,e)):Nt.done(e.num(i))}if(t.isDone())return Nt.done(e.num(i))}return new Xi(e,r,i,n,s)}static parseInteger(t,e){return Xi.parse(t,e,void 0,void 0,0)}static parseDecimal(t,e){return Xi.parse(t,e,void 0,void 0,1)}}class Ki extends Nt{constructor(t,e,r,i){super(),this.recon=t,this.output=e,this.mode=r,this.step=i}feed(t){return Ki.parse(t,this.recon,this.output,this.mode,this.step)}static parse(t,e,r,i=2,n=1){let s=0;if(1===n)if(t.isCont())if(s=t.head(),46===s)t=t.step(),r=r.write(s),n=2;else{if(!(i>1)||69!==s&&101!==s)return Nt.error(kt.expected("decimal or exponent",t));t=t.step(),r=r.write(s),n=5}else if(t.isDone())return Nt.error(kt.expected("decimal or exponent",t));if(2===n)if(t.isCont()){if(s=t.head(),!(s>=48&&s<=57))return Nt.error(kt.expected("digit",t));t=t.step(),r=r.write(s),n=3}else if(t.isDone())return Nt.error(kt.expected("digit",t));if(3===n){for(;t.isCont()&&(s=t.head(),s>=48&&s<=57);)t=t.step(),r=r.write(s);if(t.isCont()){if(!(i>1))return Nt.done(e.num(r.bind()));n=4}else if(t.isDone())return Nt.done(e.num(r.bind()))}if(4===n){if(s=t.head(),69!==s&&101!==s)return Nt.done(e.num(r.bind()));t=t.step(),r=r.write(s),n=5}if(5===n)if(t.isCont())s=t.head(),43!==s&&45!==s||(t=t.step(),r=r.write(s)),n=6;else if(t.isDone())return Nt.error(kt.unexpected(t));if(6===n)if(t.isCont()){if(s=t.head(),!(s>=48&&s<=57))return Nt.error(kt.expected("digit",t));t=t.step(),r=r.write(s),n=7}else if(t.isDone())return Nt.error(kt.expected("digit",t));if(7===n){for(;t.isCont()&&(s=t.head(),s>=48&&s<=57);)t=t.step(),r=r.write(s);if(!t.isEmpty())return Nt.done(e.num(r.bind()))}return new Ki(e,r,i,n)}}class Gi extends Nt{constructor(t,e,r){super(),this.recon=t,this.value=e,this.size=r}feed(t){return Gi.parse(t,this.recon,this.value,this.size)}static parse(t,e,r=0,i=0){let n=0;for(;t.isCont()&&(n=t.head(),_t.isDigit(n));)t=t.step(),r=16*r+_t.decodeDigit(n),i+=1;return t.isEmpty()?new Gi(e,r,i):i>0?i<=8?Nt.done(e.uint32(r)):Nt.done(e.uint64(r)):Nt.error(kt.expected("hex digit",t))}}class Zi extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.bindingsParser=r,this.templateParser=i,this.step=n}feed(t){return Zi.parse(t,this.recon,this.builder,this.bindingsParser,this.templateParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s){for(void 0===i&&(i=e.parseConditionalOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s)if(t.isCont()){if(o=t.head(),62!==o)return i;t=t.step(),s=3}else if(t.isDone())return i;if(3===s){for(void 0===n&&(n=e.parseConditionalOperator(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){const t=i.bind(),r=n.bind();return Nt.done(e.lambda(t,r))}if(n.isError())return n.asError()}return new Zi(e,r,i,n,s)}}class Qi extends Nt{constructor(t,e,r,i,n,s){super(),this.recon=t,this.builder=e,this.ifParser=r,this.thenParser=i,this.elseParser=n,this.step=s}feed(t){return Qi.parse(t,this.recon,this.builder,this.ifParser,this.thenParser,this.elseParser,this.step)}static parse(t,e,r,i,n,s,o=1){let a=0;if(1===o){for(void 0===i&&(i=e.parseOrOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())o=2;else if(i.isError())return i.asError()}if(2===o){for(;t.isCont()&&(a=t.head(),Fi.isSpace(a));)t=t.step();if(t.isCont()){if(63!==a)return i;t=t.step(),o=3}else if(t.isDone())return i}if(3===o){for(void 0===n&&(n=e.parseConditionalOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())o=4;else if(n.isError())return n.asError()}if(4===o){for(;t.isCont()&&(a=t.head(),Fi.isSpace(a));)t=t.step();if(t.isCont()){if(58!==a)return Nt.error(kt.expected(58,t));t=t.step(),o=5}else if(t.isDone())return Nt.error(kt.expected(58,t))}if(5===o){for(void 0===s&&(s=e.parseConditionalOperator(t,r));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){const t=i.bind(),r=n.bind(),o=s.bind();return Nt.done(e.conditional(t,r,o))}if(s.isError())return s.asError()}return new Qi(e,r,i,n,s,o)}}class Ji extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.rhsParser=i,this.step=n}feed(t){return Ji.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;for(;;){if(1===s){for(void 0===i&&(i=e.parseAndOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s)if(t.isCont()){if(o=t.head(),124!==o)return i;t=t.step(),s=3}else if(t.isDone())return i;if(3===s){for(void 0===n&&(n=e.parseAndOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){const t=i.bind(),r=n.bind();i=Nt.done(e.or(t,r)),n=void 0,s=2;continue}if(n.isError())return n.asError()}break}return new Ji(e,r,i,n,s)}}class $i extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.rhsParser=i,this.step=n}feed(t){return $i.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;for(;;){if(1===s){for(void 0===i&&(i=e.parseBitwiseOrOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s)if(t.isCont()){if(o=t.head(),38!==o)return i;t=t.step(),s=3}else if(t.isDone())return i;if(3===s){for(void 0===n&&(n=e.parseBitwiseOrOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){const t=i.bind(),r=n.bind();i=Nt.done(e.and(t,r)),n=void 0,s=2;continue}if(n.isError())return n.asError()}break}return new $i(e,r,i,n,s)}}class _i extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.rhsParser=i,this.step=n}feed(t){return _i.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;for(;;){if(1===s){for(void 0===i&&(i=e.parseBitwiseXorOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(124!==o)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s)if(t.isCont()){if(o=t.head(),124===o)return i;s=4}else if(t.isDone())return Nt.error(kt.unexpected(t));if(4===s){for(void 0===n&&(n=e.parseBitwiseXorOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){const t=i.bind(),r=n.bind();i=Nt.done(e.bitwiseOr(t,r)),n=void 0,s=2;continue}if(n.isError())return n.asError()}break}return new _i(e,r,i,n,s)}}class tn extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.rhsParser=i,this.step=n}feed(t){return tn.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;for(;;){if(1===s){for(void 0===i&&(i=e.parseBitwiseAndOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(94!==o)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s){for(void 0===n&&(n=e.parseBitwiseAndOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){const t=i.bind(),r=n.bind();i=Nt.done(e.bitwiseXor(t,r)),n=void 0,s=2;continue}if(n.isError())return n.asError()}break}return new tn(e,r,i,n,s)}}class en extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.rhsParser=i,this.step=n}feed(t){return en.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;for(;;){if(1===s){for(void 0===i&&(i=e.parseComparisonOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(38!==o)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s)if(t.isCont()){if(o=t.head(),38===o)return i;s=4}else if(t.isDone())return Nt.error(kt.unexpected(t));if(4===s){for(void 0===n&&(n=e.parseComparisonOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){const t=i.bind(),r=n.bind();i=Nt.done(e.bitwiseAnd(t,r)),n=void 0,s=2;continue}if(n.isError())return n.asError()}break}return new en(e,r,i,n,s)}}class rn extends Nt{constructor(t,e,r,i,n,s){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.operator=i,this.rhsParser=n,this.step=s}feed(t){return rn.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)}static parse(t,e,r,i,n,s,o=1){let a=0;if(1===o){for(void 0===i&&(i=e.parseAttrExpression(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())o=2;else if(i.isError())return i.asError()}if(2===o){for(;t.isCont()&&(a=t.head(),Fi.isSpace(a));)t=t.step();if(t.isCont())if(33===a)t=t.step(),o=3;else if(60===a)t=t.step(),o=4;else if(62===a)t=t.step(),o=5;else{if(61!==a)return i;t=t.step(),o=6}else if(t.isDone())return i}if(3===o)if(t.isCont())a=t.head(),61===a?(t=t.step(),n="!=",o=7):(n="!",o=7);else if(t.isDone())return Nt.error(kt.unexpected(t));if(4===o)if(t.isCont())a=t.head(),61===a?(t=t.step(),n="<=",o=7):(n="<",o=7);else if(t.isDone())return Nt.error(kt.unexpected(t));if(5===o)if(t.isCont())a=t.head(),61===a?(t=t.step(),n=">=",o=7):(n=">",o=7);else if(t.isDone())return Nt.error(kt.unexpected(t));if(6===o)if(t.isCont())if(a=t.head(),61===a)t=t.step(),n="==",o=7;else{if(62===a)return i;n="=",o=7}else if(t.isDone())return Nt.error(kt.unexpected(t));if(7===o){for(void 0===s&&(s=e.parseAttrExpression(t,r));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){const r=i.bind(),o=s.bind();return"<"===n?Nt.done(e.lt(r,o)):"<="===n?Nt.done(e.le(r,o)):"=="===n?Nt.done(e.eq(r,o)):"!="===n?Nt.done(e.ne(r,o)):">="===n?Nt.done(e.ge(r,o)):">"===n?Nt.done(e.gt(r,o)):Nt.error(kt.message(n,t))}if(s.isError())return s.asError()}return new rn(e,r,i,n,s,o)}}class nn extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.fieldParser=r,this.valueParser=i,this.step=n}feed(t){return nn.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;for(;;){if(1===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont())if(64===o)s=2;else if(123===o||91===o)r=r||e.recordBuilder(),s=5;else if(40===o)s=4;else{if(!(33===o||34===o||36===o||37===o||39===o||43===o||45===o||o>=48&&o<=57||96===o||126===o||Fi.isIdentStartChar(o)))return void 0===r?Nt.done(e.extant()):Nt.done(r.build());s=3}else if(t.isDone())return void 0===r?Nt.done(e.extant()):Nt.done(r.build())}if(2===s){for(void 0===i&&(i=e.parseAttr(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone()){(r=r||e.recordBuilder()).push(i.bind()),i=void 0,s=1;continue}if(i.isError())return i.asError()}if(3===s){for(void 0===n&&(n=e.parseAdditiveOperator(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())(r=r||e.valueBuilder()).push(e.item(n.bind())),n=void 0,s=6;else if(n.isError())return n.asError()}if(4===s){for(void 0===n&&(n=e.parseAdditiveOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())void 0===r&&(r=e.valueBuilder()).push(e.item(n.bind())),n=void 0,s=6;else if(n.isError())return n.asError()}if(5===s){for(void 0===n&&(n=e.parseAdditiveOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())n=void 0,s=6;else if(n.isError())return n.asError()}if(6===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(64===o){s=1;continue}return Nt.done(r.build())}if(t.isDone())return Nt.done(r.build())}break}return new nn(e,r,i,n,s)}}class sn extends Nt{constructor(t,e,r,i,n,s){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.operator=i,this.rhsParser=n,this.step=s}feed(t){return sn.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)}static parse(t,e,r,i,n,s,o=1){let a=0;for(;;){if(1===o){for(void 0===i&&(i=e.parseMultiplicativeOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())o=2;else if(i.isError())return i.asError()}if(2===o){for(;t.isCont()&&(a=t.head(),Fi.isSpace(a));)t=t.step();if(t.isCont())if(43===a)t=t.step(),n="+",o=3;else{if(45!==a)return i;t=t.step(),n="-",o=3}else if(t.isDone())return i}if(3===o){for(void 0===s&&(s=e.parseMultiplicativeOperator(t,r));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){const r=i.bind(),a=s.bind();if("+"===n)i=Nt.done(e.plus(r,a));else{if("-"!==n)return Nt.error(kt.message(n,t));i=Nt.done(e.minus(r,a))}s=void 0,n=void 0,o=2;continue}if(s.isError())return s.asError()}break}return new sn(e,r,i,n,s,o)}}class on extends Nt{constructor(t,e,r,i,n,s){super(),this.recon=t,this.builder=e,this.lhsParser=r,this.operator=i,this.rhsParser=n,this.step=s}feed(t){return on.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)}static parse(t,e,r,i,n,s,o=1){let a=0;for(;;){if(1===o){for(void 0===i&&(i=e.parsePrefixOperator(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())o=2;else if(i.isError())return i.asError()}if(2===o){for(;t.isCont()&&(a=t.head(),Fi.isSpace(a));)t=t.step();if(t.isCont())if(42===a)t=t.step(),n="*",o=3;else if(47===a)t=t.step(),n="/",o=3;else{if(37!==a)return i;t=t.step(),n="%",o=3}else if(t.isDone())return i}if(3===o){for(void 0===s&&(s=e.parsePrefixOperator(t,r));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){const r=i.bind(),a=s.bind();if("*"===n)i=Nt.done(e.times(r,a));else if("/"===n)i=Nt.done(e.divide(r,a));else{if("%"!==n)return Nt.error(kt.message(n,t));i=Nt.done(e.modulo(r,a))}s=void 0,n=void 0,o=2;continue}if(s.isError())return s.asError()}break}return new on(e,r,i,n,s,o)}}class an extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.operator=r,this.operandParser=i,this.step=n}feed(t){return an.parse(t,this.recon,this.builder,this.operator,this.operandParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(33===o)t=t.step(),i="!";else if(126===o)t=t.step(),i="~";else if(45===o)t=t.step(),i="-";else{if(43!==o)return e.parseInvokeOperator(t,r);t=t.step(),i="+"}s=2}else if(t.isDone())return e.parseInvokeOperator(t,r)}if(2===s){for(void 0===n&&(n=e.parsePrefixOperator(t,r));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){const r=n.bind();return e.isDistinct(r)?"!"===i?Nt.done(e.not(r)):"~"===i?Nt.done(e.bitwiseNot(r)):"-"===i?Nt.done(e.negative(r)):"+"===i?Nt.done(e.positive(r)):Nt.error(kt.message(i,t)):Nt.error(kt.expected("value",t))}if(n.isError())return n.asError()}return new an(e,r,i,n,s)}}class un extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.exprParser=r,this.argsParser=i,this.step=n}feed(t){return un.parse(t,this.recon,this.builder,this.exprParser,this.argsParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s){for(void 0===i&&(i=e.parsePrimary(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}for(;;){if(2===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(40!==o)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s){for(;t.isCont()&&(o=t.head(),Fi.isWhitespace(o));)t=t.step();if(t.isCont()){if(41===o){t=t.step();const r=i.bind();i=Nt.done(e.invoke(r,e.extant())),s=2;continue}s=4}else if(t.isDone())return Nt.error(kt.expected(41,t))}if(4===s){for(void 0===n&&(n=e.parseBlock(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=5;else if(n.isError())return n.asError()}if(5===s){for(;t.isCont()&&(o=t.head(),Fi.isWhitespace(o));)t=t.step();if(t.isCont()){if(41===o){t=t.step();const r=i.bind(),o=n.bind();i=Nt.done(e.invoke(r,o)),n=void 0,s=2;continue}return Nt.error(kt.expected(41,t))}if(t.isDone())return Nt.error(kt.expected(41,t))}break}return new un(e,r,i,n,s)}}class hn extends Nt{constructor(t,e,r,i){super(),this.recon=t,this.builder=e,this.exprParser=r,this.step=i}feed(t){return hn.parse(t,this.recon,this.builder,this.exprParser,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n){for(;t.isCont()&&(s=t.head(),Fi.isSpace(s));)t=t.step();t.isCont()?40===s?(t=t.step(),n=3):n=2:t.isDone()&&(n=2)}if(2===n){for(void 0===i&&(i=e.parseLiteral(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())return i;if(i.isError())return i.asError()}if(3===n){for(void 0===i&&(i=e.parseBlockExpression(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())n=4;else if(i.isError())return i.asError()}for(;;){if(4===n){for(;t.isCont()&&(s=t.head(),Fi.isSpace(s));)t=t.step();if(t.isCont()){if(44!==s)return 41===s?(t=t.step(),void 0!==i?i:Nt.done(r.build())):Nt.error(kt.expected(41,t));t=t.step(),void 0!==i&&(void 0===r&&(r=e.recordBuilder()).push(e.item(i.bind())),i=void 0),n=5}else if(t.isDone())return Nt.error(kt.expected(41,t))}if(5===n){for(void 0===i&&(i=e.parseBlockExpression(t,r));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone()){i=void 0,n=4;continue}if(i.isError())return i.asError()}break}return new hn(e,r,i,n)}}class ln extends Nt{constructor(t,e,r,i){super(),this.recon=t,this.builder=e,this.valueParser=r,this.step=i}feed(t){return ln.parse(t,this.recon,this.builder,this.valueParser,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n){for(;t.isCont()&&(s=t.head(),Fi.isSpace(s));)t=t.step();if(t.isCont())if(40===s)t=t.step(),n=4;else if(123===s)r=r||e.recordBuilder(),i=e.parseRecord(t,r),n=3;else if(91===s)r=r||e.recordBuilder(),i=e.parseMarkup(t,r),n=3;else if(Fi.isIdentStartChar(s))i=e.parseIdent(t),n=2;else if(34===s||39===s)i=e.parseString(t),n=2;else if(96===s)i=e.parseRawString(t),n=2;else if(45===s||s>=48&&s<=57)i=e.parseNumber(t),n=2;else if(37===s)i=e.parseData(t),n=2;else{if(36!==s)return void 0===r?Nt.done(e.extant()):Nt.done(r.build());i=e.parseSelector(t),n=2}else if(t.isDone())return void 0===r?Nt.done(e.extant()):Nt.done(r.build())}if(2===n){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())return(r=r||e.valueBuilder()).push(e.item(i.bind())),Nt.done(r.build());if(i.isError())return i.asError()}if(3===n){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())return Nt.done(r.build());if(i.isError())return i.asError()}if(4===n){for(void 0===i&&(i=e.parseBlockExpression(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())n=5;else if(i.isError())return i.asError()}if(5===n){for(;t.isCont()&&(s=t.head(),Fi.isWhitespace(s));)t=t.step();if(t.isCont())return 41===s?(t=t.step(),(r=r||e.valueBuilder()).push(e.item(i.bind())),Nt.done(r.build())):Nt.error(kt.expected(41,t));if(t.isDone())return Nt.error(kt.expected(41,t))}return new ln(e,r,i,n)}}class cn extends Nt{constructor(t,e,r,i,n){super(),this.recon=t,this.builder=e,this.selector=r,this.valueParser=i,this.step=n}feed(t){return cn.parse(t,this.recon,this.builder,this.selector,this.valueParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()&&36===o)t=t.step(),i=i||e.selector(),s=2;else if(t.isDone())return Nt.error(kt.expected(36,t))}if(2===s)if(t.isCont())o=t.head(),91===o?(t=t.step(),s=8):64===o?(t=t.step(),s=7):58===o?(t=t.step(),s=6):42===o?(t=t.step(),s=5):35===o?(t=t.step(),s=4):s=3;else if(t.isDone())return Nt.error(kt.unexpected(t));for(;;){if(3===s){for(void 0===n&&(n=e.parseLiteral(t,e.valueBuilder()));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())i=e.get(i,n.bind()),n=void 0,s=10;else if(n.isError())return n.asError()}if(4===s){for(void 0===n&&(n=e.parseInteger(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())i=e.value(e.getItem(i,n.bind())),n=void 0,s=10;else if(n.isError())return n.asError()}if(5===s&&(t.isCont()?(o=t.head(),58===o?(t=t.step(),i=e.keys(i),s=10):42===o?(t=t.step(),i=e.descendants(i),s=10):(i=e.children(i),s=10)):t.isDone()&&(i=e.children(i),s=10)),6===s)if(t.isCont()){if(o=t.head(),42!==o)return Nt.error(kt.expected(42,t));t=t.step(),i=e.values(i),s=10}else if(t.isDone())return Nt.error(kt.expected(42,t));if(7===s){for(void 0===n&&(n=e.parseIdent(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())i=e.getAttr(i,n.bind()),n=void 0,s=10;else if(n.isError())return n.asError()}if(8===s){for(void 0===n&&(n=e.parseBlockExpression(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=9;else if(n.isError())return n.asError()}if(9===s){for(;t.isCont()&&(o=t.head(),Fi.isSpace(o));)t=t.step();if(t.isCont()){if(93!==o)return Nt.error(kt.expected(93,t));t=t.step(),i=e.filter(i,n.bind()),n=void 0,s=10}else if(t.isDone())return Nt.error(kt.expected(93,t))}if(10===s)if(t.isCont()){if(o=t.head(),91===o){t=t.step(),s=8;continue}if(35===o){t=t.step(),s=4;continue}if(46!==o)return void 0!==r?(r.push(e.item(i)),Nt.done(r.build())):Nt.done(i);t=t.step(),s=11}else if(t.isDone())return void 0!==r?(r.push(e.item(i)),Nt.done(r.build())):Nt.done(i);if(11===s){if(t.isCont()){if(o=t.head(),64===o){t=t.step(),s=7;continue}if(58===o){t=t.step(),s=6;continue}if(42===o){t=t.step(),s=5;continue}s=3;continue}if(t.isDone())return Nt.error(kt.unexpected(t))}break}return new cn(e,r,i,n,s)}}class dn{parseBlock(t){return Vi.parse(t,this)}parseAttr(t){return zi.parse(t,this)}parseBlockItem(t){return ji.parse(t,this)}parseInlineItem(t){return Ni.parse(t,this)}parseRecord(t,e){return Ui.parse(t,this,e)}parseMarkup(t,e){return Ri.parse(t,this,e)}parseData(t){return Bi.parse(t,this)}parseIdent(t){return Yi.parse(t,this)}parseString(t){return Hi.parse(t,this)}parseRawString(t){return Wi.parse(t,this)}parseNumber(t){return Xi.parse(t,this)}parseInteger(t){return Xi.parseInteger(t,this)}parseBlockExpression(t,e){return this.parseLambdaFunc(t,e)}parseLambdaFunc(t,e){return Zi.parse(t,this,e)}parseConditionalOperator(t,e){return Qi.parse(t,this,e)}parseOrOperator(t,e){return Ji.parse(t,this,e)}parseAndOperator(t,e){return $i.parse(t,this,e)}parseBitwiseOrOperator(t,e){return _i.parse(t,this,e)}parseBitwiseXorOperator(t,e){return tn.parse(t,this,e)}parseBitwiseAndOperator(t,e){return en.parse(t,this,e)}parseComparisonOperator(t,e){return rn.parse(t,this,e)}parseAttrExpression(t,e){return nn.parse(t,this,e)}parseAdditiveOperator(t,e){return sn.parse(t,this,e)}parseMultiplicativeOperator(t,e){return on.parse(t,this,e)}parsePrefixOperator(t,e){return an.parse(t,this,e)}parseInvokeOperator(t,e){return un.parse(t,this,e)}parsePrimary(t,e){return hn.parse(t,this,e)}parseLiteral(t,e){return ln.parse(t,this,e)}parseSelector(t,e){return cn.parse(t,this,e)}blockParser(){return new Vi(this)}parseBlockString(t){let e=xt.stringInput(t);for(;e.isCont()&&Fi.isWhitespace(e.head());)e=e.step();let r=this.parseBlock(e);if(r.isDone())for(;e.isCont()&&Fi.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}}class fn extends dn{isDistinct(t){return t.isDistinct()}item(t){return t}value(t){return t.toValue()}attr(t,e){return 1===arguments.length?cr.of(t):cr.of(t,e)}slot(t,e){return 1===arguments.length?fr.of(t):fr.of(t,e)}valueBuilder(){return mr.builder()}recordBuilder(){return gr.create()}dataOutput(){return Sr.output()}textOutput(){return kr.output()}ident(t){if(t instanceof kr){const e=t.stringValue();if("true"===e)return Tr.from(!0);if("false"===e)return Tr.from(!1)}return t}num(t){if("number"==typeof t)return Or.from(t);if("string"==typeof t)return Or.from(+t);throw new TypeError(""+t)}uint32(t){return Or.uint32(t)}uint64(t){return Or.uint64(t)}bool(t){return Tr.from(t)}selector(){return li.identity()}extant(){return mr.extant()}absent(){return mr.absent()}conditional(t,e,r){return t.conditional(e,r)}or(t,e){return new Br(t,e)}and(t,e){return new Yr(t,e)}bitwiseOr(t,e){return new Hr(t,e)}bitwiseXor(t,e){return new Wr(t,e)}bitwiseAnd(t,e){return new Xr(t,e)}lt(t,e){return new Kr(t,e)}le(t,e){return new Gr(t,e)}eq(t,e){return new Zr(t,e)}ne(t,e){return new Qr(t,e)}ge(t,e){return new Jr(t,e)}gt(t,e){return new $r(t,e)}plus(t,e){return new _r(t,e)}minus(t,e){return new ti(t,e)}times(t,e){return new ei(t,e)}divide(t,e){return new ri(t,e)}modulo(t,e){return new ii(t,e)}not(t){return new ni(t)}bitwiseNot(t){return new si(t)}negative(t){return t instanceof Or?t.negative():new oi(t)}positive(t){return new ai(t)}invoke(t,e){return new ui(t,e)}lambda(t,e){return t.lambda(e)}get(t,e){return t.get(e)}getAttr(t,e){return t.getAttr(e)}getItem(t,e){return t.getItem(e)}children(t){return li.literal(t).children()}descendants(t){return li.literal(t).descendants()}keys(t){return li.literal(t).keys()}values(t){return li.literal(t).values()}filter(t,e){return t.filter(e)}}class pn extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.key=e,this.value=r,this.part=i,this.step=n}pull(t){return pn.write(t,this.recon,this.key,this.value,this.part,this.step)}static sizeOf(t,e,r){let i=0;return i+=1,i+=t.sizeOfValue(e),t.isExtant(t.item(r))||(i+=1,i+=t.sizeOfBlockValue(r),i+=1),i}static write(t,e,r,i,n,s=1){if(1===s&&t.isCont()&&(t=t.write(64),s=2),2===s)if((n=void 0===n?e.writeValue(t,r):n.pull(t)).isDone()){if(n=void 0,e.isExtant(e.item(i)))return bt.end();s=3}else if(n.isError())return n.asError();if(3===s&&t.isCont()&&(t=t.write(40),s=4),4===s)if((n=void 0===n?e.writeBlockValue(t,i):n.pull(t)).isDone())n=void 0,s=5;else if(n.isError())return n.asError();return 5===s&&t.isCont()?(t=t.write(41),bt.end()):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new pn(e,r,i,n,s)}}class mn extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.key=e,this.value=r,this.part=i,this.step=n}pull(t){return mn.write(t,this.recon,this.key,this.value,this.part,this.step)}static sizeOf(t,e,r){let i=0;return i+=t.sizeOfValue(e),i+=1,t.isExtant(t.item(r))||(i+=t.sizeOfValue(r)),i}static write(t,e,r,i,n,s=1){if(1===s)if((n=void 0===n?e.writeValue(t,r):n.pull(t)).isDone())n=void 0,s=2;else if(n.isError())return n.asError();if(2===s&&t.isCont()){if(t=t.write(58),e.isExtant(e.item(i)))return bt.end();s=3}if(3===s){if((n=void 0===n?e.writeValue(t,i):n.pull(t)).isDone())return bt.end();if(n.isError())return n.asError()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new mn(e,r,i,n,s)}}class yn extends bt{constructor(t,e,r,i,n,s,o,a,u,h,l,c){super(),this.recon=t,this.items=e,this.inBlock=r,this.inMarkup=i,this.inBraces=n,this.inBrackets=s,this.first=o,this.markupSafe=a,this.item=u,this.next=h,this.part=l,this.step=c}pull(t){return yn.write(t,this.recon,this.items,this.inBlock,this.inMarkup,this.inBraces,this.inBrackets,this.first,this.markupSafe,this.item,this.next,this.part,this.step)}static sizeOf(t,e,r,i){let n,s=0,o=!1,a=!1,u=!0,h=!0;for(;void 0!==n||e.hasNext();){let l;void 0===n?l=e.next().value:(l=n,n=void 0),e.hasNext()&&(n=e.next().value),t.isExpression(l)&&(h=!1),a&&t.isAttr(l)&&(o&&(s+=1,o=!1),s+=1,a=!1),t.isAttr(l)?(o?(s+=1,o=!1):a&&(s+=1,a=!1),s+=t.sizeOfItem(l),u=!1):a&&t.isText(l)?(o&&(s+=1,o=!1),s+=t.sizeOfMarkupText(l)):o?(u?u=!1:s+=1,s+=yn.sizeOfBlockItem(t,l)):a?t.isRecord(l)&&t.isMarkupSafe(t.items(l))?(s+=t.sizeOfBlock(t.items(l),!1,!0),void 0!==n&&t.isText(n)?(s+=t.sizeOfMarkupText(n),n=void 0):void 0===n||t.isAttr(n)?(s+=1,a=!1):(s+=1,o=!0,u=!0)):(s+=1,s+=t.sizeOfItem(l),o=!0,u=!1):!h||!t.isText(l)||void 0===n||t.isField(n)||t.isText(n)||t.isBool(n)?r&&!o?(u?u=!1:s+=1,s+=yn.sizeOfBlockItem(t,l)):i&&t.isText(l)&&void 0===n?(s+=1,s+=t.sizeOfMarkupText(l),s+=1):!i&&t.isValue(l)&&!t.isRecord(l)&&(!u&&void 0===n||void 0!==n&&t.isAttr(n))?(!u&&(t.isText(l)&&t.isIdent(l)||t.isNum(l)||t.isBool(l))&&(s+=1),s+=t.sizeOfItem(l)):(s+=1,s+=t.sizeOfItem(l),o=!0,u=!1):(s+=1,s+=t.sizeOfMarkupText(l),a=!0)}return o&&(s+=1),a&&(s+=1),s}static sizeOfBlockItem(t,e){let r=0;return t.isField(e)?r+=t.sizeOfSlot(t.key(e),t.value(e)):r+=t.sizeOfItem(e),r}static write(t,e,r,i,n,s=!1,o=!1,a=!0,u=!0,h,l,c,d=1){for(;;){if(1===d){if(void 0===l&&!r.hasNext()){d=10;break}void 0===l?h=r.next().value:(h=l,l=void 0),r.hasNext()&&(l=r.next().value),e.isExpression(h)&&(u=!1),d=2}if(2===d&&t.isCont()&&(o&&e.isAttr(h)?(s&&(t=t.write(125),s=!1),d=3):d=4),3===d&&t.isCont()&&(t=t.write(93),o=!1,d=4),4===d&&t.isCont()&&(e.isAttr(h)?(s?(t=t.write(125),s=!1):o&&(t=t.write(93),o=!1),c=e.writeItem(t,h),a=!1,d=7):o&&e.isText(h)?(s&&(t=t.write(125),s=!1),c=e.writeMarkupText(t,h),d=7):s?(a?a=!1:t=t.write(44),c=yn.writeBlockItem(t,e,h),d=7):o?e.isRecord(h)&&e.isMarkupSafe(e.items(h))?(c=e.writeBlock(t,e.items(h),!1,!0),d=5):(t=t.write(123),c=e.writeItem(t,h),s=!0,a=!1,d=7):!u||!e.isText(h)||void 0===l||e.isField(l)||e.isText(l)||e.isBool(l)?i&&!s?(a?a=!1:t=t.write(44),c=yn.writeBlockItem(t,e,h),d=7):n&&e.isText(h)&&void 0===l?(t=t.write(91),c=e.writeMarkupText(t,h),d=8):!n&&e.isValue(h)&&!e.isRecord(h)&&(!a&&void 0===l||void 0!==l&&e.isAttr(l))?(!a&&(e.isText(h)&&e.isIdent(h)||e.isNum(h)||e.isBool(h))&&(t=t.write(32)),c=e.writeItem(t,h),d=7):(t=t.write(123),c=e.writeItem(t,h),s=!0,a=!1,d=7):(t=t.write(91),c=e.writeMarkupText(t,h),o=!0,d=7)),5===d)if((c=c.pull(t)).isDone())c=void 0,d=6;else if(c.isError())return c.asError();if(6===d&&t.isCont()){if(void 0===l||!e.isText(l)){if(void 0===l||e.isAttr(l)){t=t.write(93),o=!1,d=1;continue}t=t.write(123),s=!0,a=!0,d=1;continue}c=e.writeMarkupText(t,l),l=void 0,d=7}if(7===d){if((c=c.pull(t)).isDone()){c=void 0,d=1;continue}if(c.isError())return c.asError()}if(8===d)if((c=c.pull(t)).isDone())c=void 0,d=9;else if(c.isError())return c.asError();if(9!==d||!t.isCont())break;t=t.write(93),d=1}if(10===d&&(s?t.isCont()&&(t=t.write(125),d=11):d=11),11===d){if(!o)return bt.end();if(t.isCont())return t=t.write(93),bt.end()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new yn(e,r,i,n,s,o,a,u,h,l,c,d)}static writeBlockItem(t,e,r){return e.isField(r)?e.writeSlot(t,e.key(r),e.value(r)):e.writeItem(t,r)}}class gn extends bt{constructor(t,e,r,i,n,s,o,a){super(),this.recon=t,this.items=e,this.inParens=r,this.first=i,this.item=n,this.next=s,this.part=o,this.step=a}pull(t){return gn.write(t,this.recon,this.items,this.inParens,this.first,this.item,this.next,this.part,this.step)}static sizeOf(t,e){let r,i=0,n=!1,s=!0;for(;void 0!==r||e.hasNext();){let o;void 0===r?o=e.next().value:(o=r,r=void 0),e.hasNext()&&(r=e.next().value),n||s||(i+=1),t.isAttr(o)?(n&&(i+=1,n=!1),i+=t.sizeOfItem(o),s=!1):n?(s?s=!1:i+=1,i+=t.sizeOfBlockItem(o)):t.isValue(o)&&!t.isRecord(o)&&(!s&&void 0===r||void 0!==r&&t.isAttr(r))?i+=t.sizeOfItem(o):(i+=1,i+=t.sizeOfItem(o),n=!0,s=!1)}return n&&(i+=1),i}static write(t,e,r,i=!1,n=!0,s,o,a,u=1){for(;;){if(1===u){if(void 0===o&&!r.hasNext()){u=5;break}void 0===o?s=r.next().value:(s=o,o=void 0),r.hasNext()&&(o=r.next().value),u=2}if(2===u&&t.isCont()&&(i||n||(t=t.write(32)),u=3),3===u&&t.isCont()&&(e.isAttr(s)?(i&&(t=t.write(41),i=!1),a=e.writeItem(t,s),n=!1,u=4):i?(n?n=!1:t=t.write(44),a=e.writeBlockItem(t,s),u=4):e.isValue(s)&&!e.isRecord(s)&&(!n&&void 0===o||void 0!==o&&e.isAttr(o))?(a=e.writeItem(t,s),u=4):(t=t.write(40),a=e.writeItem(t,s),i=!0,n=!1,u=4)),4===u){if((a=a.pull(t)).isDone()){a=void 0,u=1;continue}if(a.isError())return a.asError()}break}if(5===u){if(!i)return bt.end();if(t.isCont())return t=t.write(41),bt.end()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new gn(e,r,i,n,s,o,a,u)}}class wn extends bt{constructor(t,e,r,i){super(),this.text=t,this.index=e,this.escape=r,this.step=i}pull(t){return wn.write(t,this.text,this.index,this.escape,this.step)}static sizeOf(t){let e=0;for(let r=0;r<t.length;r=p.offsetByCodePoints(t,r,1)){let i=t.codePointAt(r);void 0===i&&(i=t.charCodeAt(r)),e+=36===i||64===i||91===i||92===i||93===i||123===i||125===i||8===i||12===i||10===i||13===i||9===i?2:i<32?6:re.sizeOf(i)}return e}static write(t,e,r=0,i=0,n=1){const s=e.length;for(;t.isCont();)if(1===n){if(!(r<s))return bt.end();{let s=e.codePointAt(r);void 0===s&&(s=e.charCodeAt(r)),r=p.offsetByCodePoints(e,r,1),36===s||64===s||91===s||92===s||93===s||123===s||125===s?(t=t.write(92),i=s,n=2):8===s?(t=t.write(92),i=98,n=2):12===s?(t=t.write(92),i=102,n=2):10===s?(t=t.write(92),i=110,n=2):13===s?(t=t.write(92),i=114,n=2):9===s?(t=t.write(92),i=116,n=2):s<32?(t=t.write(92),i=s,n=3):t=t.write(s)}}else 2===n?(t=t.write(i),i=0,n=1):3===n?(t=t.write(117),n=4):4===n?(t=t.write(_t.uppercase.encodeDigit(i>>>12&15)),n=5):5===n?(t=t.write(_t.uppercase.encodeDigit(i>>>8&15)),n=6):6===n?(t=t.write(_t.uppercase.encodeDigit(i>>>4&15)),n=7):7===n&&(t=t.write(_t.uppercase.encodeDigit(15&i)),i=0,n=1);return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new wn(e,r,i,n)}}class bn extends bt{constructor(t,e,r){super(),this.array=t,this.part=e,this.step=r}pull(t){return bn.write(t,this.array,this.part,this.step)}static sizeOf(t){return 1+(Math.floor(4*t/3)+3&-4)}static write(t,e,r,i=1){if(1===i&&t.isCont()&&(t=t.write(37),i=2),2===i){if((r=void 0===r?he.standard().writeUint8Array(t,e):r.pull(t)).isDone())return r=void 0,bt.end();if(r.isError())return r.asError()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new bn(e,r,i)}}class vn extends bt{constructor(t,e){super(),this.ident=t,this.index=e}pull(t){return vn.write(t,this.ident,this.index)}static sizeOf(t){return re.sizeOf(t)}static write(t,e,r=0){let i;const n=e.length;if(0===n)return bt.error(new wt("empty identifier"));for(0===r&&t.isCont()&&(i=e.codePointAt(0),void 0===i&&(i=e.charCodeAt(0)),Fi.isIdentStartChar(i)&&(t=t.write(i),r=p.offsetByCodePoints(e,0,1)));r<n&&t.isCont();){if(i=e.codePointAt(r),void 0===i&&(i=e.charCodeAt(r)),!Fi.isIdentChar(i))return bt.error(new wt("invalid identifier"));t=t.write(i),r=p.offsetByCodePoints(e,r,1)}return r>=n?bt.end():t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new vn(e,r)}}class xn extends bt{constructor(t,e,r,i){super(),this.string=t,this.index=e,this.escape=r,this.step=i}pull(t){return xn.write(t,this.string,this.index,this.escape,this.step)}static sizeOf(t){let e=0;e+=1;for(let r=0;r<t.length;r=p.offsetByCodePoints(t,r,1)){let i=t.codePointAt(r);void 0===i&&(i=t.charCodeAt(r)),e+=34===i||92===i||8===i||12===i||10===i||13===i||9===i?2:i<32?6:re.sizeOf(i)}return e+=1,e}static write(t,e,r=0,i=0,n=1){1===n&&t.isCont()&&(t=t.write(34),n=2);const s=e.length;for(;n>=2&&n<=8&&t.isCont();)if(2===n){if(!(r<s)){n=9;break}{let s=e.codePointAt(r);void 0===s&&(s=e.charCodeAt(r)),r=p.offsetByCodePoints(e,r,1),34===s||92===s?(t=t.write(92),i=s,n=3):8===s?(t=t.write(92),i=98,n=3):12===s?(t=t.write(92),i=102,n=3):10===s?(t=t.write(92),i=110,n=3):13===s?(t=t.write(92),i=114,n=3):9===s?(t=t.write(92),i=116,n=3):s<32?(t=t.write("\\"),i=s,n=4):t=t.write(s)}}else 3===n?(t=t.write(i),i=0,n=2):4===n?(t=t.write(117),n=5):5===n?(t=t.write(_t.uppercase.encodeDigit(i>>>12&15)),n=6):6===n?(t=t.write(_t.uppercase.encodeDigit(i>>>8&15)),n=7):7===n?(t=t.write(_t.uppercase.encodeDigit(i>>>4&15)),n=8):8===n&&(t=t.write(_t.uppercase.encodeDigit(15&i)),i=0,n=2);return 9===n&&t.isCont()?(t=t.write(34),bt.end()):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new xn(e,r,i,n)}}class Sn extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.bindings=e,this.template=r,this.part=i,this.step=n}pull(t){return Sn.write(t,this.recon,this.bindings,this.template,this.part,this.step)}static sizeOf(t,e,r){let i=0;return i+=t.sizeOfPrimary(e),i+=4,i+=t.sizeOfValue(r),i}static write(t,e,r,i,n,s=1){if(1===s)if((n=void 0===n?e.writePrimary(t,r):n.pull(t)).isDone())n=void 0,s=2;else if(n.isError())return n.asError();if(2===s&&t.isCont()&&(t=t.write(32),s=3),3===s&&t.isCont()&&(t=t.write(61),s=4),4===s&&t.isCont()&&(t=t.write(62),s=5),5===s&&t.isCont()&&(t=t.write(32),s=6),6===s){if((n=void 0===n?e.writeValue(t,i):n.pull(t)).isDone())return bt.end();if(n.isError())return n.asError()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Sn(e,r,i,n,s)}}class Cn extends bt{constructor(t,e,r,i,n,s,o){super(),this.recon=t,this.ifTerm=e,this.thenTerm=r,this.elseTerm=i,this.precedence=n,this.part=s,this.step=o}pull(t){return Cn.write(t,this.recon,this.ifTerm,this.thenTerm,this.elseTerm,this.precedence,this.part,this.step)}static sizeOf(t,e,r,i,n){let s=0;return t.precedence(e)>0&&t.precedence(e)<=n?(s+=1,s+=t.sizeOfItem(e),s+=1):s+=t.sizeOfItem(e),s+=3,s+=t.sizeOfItem(r),s+=3,s+=t.sizeOfItem(i),s}static write(t,e,r,i,n,s,o,a=1){if(1===a&&(e.precedence(r)>0&&e.precedence(r)<=s?t.isCont()&&(t=t.write(40),a=2):a=2),2===a)if((o=void 0===o?e.writeItem(t,r):o.pull(t)).isDone())o=void 0,a=3;else if(o.isError())return o.asError();if(3===a&&(e.precedence(r)>0&&e.precedence(r)<=s?t.isCont()&&(t=t.write(41),a=4):a=4),4===a&&t.isCont()&&(t=t.write(32),a=5),5===a&&t.isCont()&&(t=t.write(63),a=6),6===a&&t.isCont()&&(t=t.write(32),a=7),7===a)if((o=void 0===o?e.writeItem(t,i):o.pull(t)).isDone())o=void 0,a=8;else if(o.isError())return o.asError();if(8===a&&t.isCont()&&(t=t.write(32),a=9),9===a&&t.isCont()&&(t=t.write(58),a=10),10===a&&t.isCont()&&(t=t.write(32),a=11),11===a){if((o=void 0===o?e.writeItem(t,n):o.pull(t)).isDone())return bt.end();if(o.isError())return o.asError()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Cn(e,r,i,n,s,o,a)}}class kn extends bt{constructor(t,e,r,i,n,s,o){super(),this.recon=t,this.lhs=e,this.operator=r,this.rhs=i,this.precedence=n,this.part=s,this.step=o}pull(t){return kn.write(t,this.recon,this.lhs,this.operator,this.rhs,this.precedence,this.part,this.step)}static sizeOf(t,e,r,i,n){let s=0;return t.precedence(e)<n?(s+=1,s+=t.sizeOfItem(e),s+=1):s+=t.sizeOfItem(e),s+=1,s+=re.sizeOf(r),s+=1,t.precedence(i)<n?(s+=1,s+=t.sizeOfItem(i),s+=1):s+=t.sizeOfItem(i),s}static write(t,e,r,i,n,s,o,a=1){if(1===a&&(e.precedence(r)<s?t.isCont()&&(t=t.write(40),a=2):a=2),2===a)if((o=void 0===o?e.writeItem(t,r):o.pull(t)).isDone())o=void 0,a=3;else if(o.isError())return o.asError();if(3===a&&(e.precedence(r)<s?t.isCont()&&(t=t.write(41),a=4):a=4),4===a&&t.isCont()&&(t=t.write(32),a=5),5===a)if((o=void 0===o?xt.writeString(t,i):o.pull(t)).isDone())o=void 0,a=6;else if(o.isError())return o.asError();if(6===a&&t.isCont()&&(t=t.write(32),a=7),7===a&&(e.precedence(n)<s?t.isCont()&&(t=t.write(40),a=8):a=8),8===a)if((o=void 0===o?e.writeItem(t,n):o.pull(t)).isDone())o=void 0,a=9;else if(o.isError())return o.asError();if(9===a){if(!(e.precedence(n)<s))return bt.end();if(t.isCont())return t=t.write(41),bt.end()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new kn(e,r,i,n,s,o,a)}}class Mn extends bt{constructor(t,e,r,i,n,s){super(),this.recon=t,this.operator=e,this.rhs=r,this.precedence=i,this.part=n,this.step=s}pull(t){return Mn.write(t,this.recon,this.operator,this.rhs,this.precedence,this.part,this.step)}static sizeOf(t,e,r,i){let n=0;return n+=re.sizeOf(e),t.precedence(r)<i?(n+=1,n+=t.sizeOfItem(r),n+=1):n+=t.sizeOfItem(r),n}static write(t,e,r,i,n,s,o=1){if(1===o)if((s=void 0===s?xt.writeString(t,r):s.pull(t)).isDone())s=void 0,o=2;else if(s.isError())return s.asError();if(2===o&&(e.precedence(i)<n?t.isCont()&&(t=t.write(40),o=3):o=3),3===o)if((s=void 0===s?e.writeItem(t,i):s.pull(t)).isDone())s=void 0,o=4;else if(s.isError())return s.asError();if(4===o){if(!(e.precedence(i)<n))return bt.end();if(t.isCont())return t=t.write(41),bt.end()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Mn(e,r,i,n,s,o)}}class On extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.func=e,this.args=r,this.part=i,this.step=n}pull(t){return On.write(t,this.recon,this.func,this.args,this.part,this.step)}static sizeOf(t,e,r){let i=0;return i+=t.sizeOfValue(e),i+=1,i+=t.sizeOfBlockValue(r),i+=1,i}static write(t,e,r,i,n,s=1){if(1===s)if((n=void 0===n?e.writeValue(t,r):n.pull(t)).isDone())n=void 0,s=2;else if(n.isError())return n.asError();if(2===s&&t.isCont()&&(t=t.write(40),s=3),3===s)if((n=void 0===n?e.writeBlockValue(t,i):n.pull(t)).isDone())n=void 0,s=4;else if(n.isError())return n.asError();return 4===s&&t.isCont()?(t=t.write(41),bt.end()):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new On(e,r,i,n,s)}}class En extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.item=e,this.then=r,this.part=i,this.step=n}pull(t){return En.write(t,this.recon,this.item,this.then,this.part,this.step)}static sizeOf(t,e,r){let i=0;return t.precedence(e)<t.precedence(t.item(r))?(i+=1,i+=t.sizeOfItem(e),i+=1):i+=t.sizeOfItem(e),i+=t.sizeOfThen(r),i}static write(t,e,r,i,n,s=1){if(1===s&&(e.precedence(r)<e.precedence(e.item(i))?t.isCont()&&(t=t.write(40),s=2):s=2),2===s)if((n=void 0===n?e.writeItem(t,r):n.pull(t)).isDone())n=void 0,s=3;else if(n.isError())return n.asError();return 3===s&&(e.precedence(r)<e.precedence(e.item(i))?t.isCont()&&(t=t.write(41),s=4):s=4),4===s?e.writeThen(t,i):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new En(e,r,i,n,s)}}class Tn extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.key=e,this.then=r,this.part=i,this.step=n}pull(t){return Tn.write(t,this.recon,this.key,this.then,this.part,this.step)}static sizeOf(t,e,r){let i=1;return t.isRecord(t.item(e))?(i+=1,i+=t.sizeOfBlockValue(e),i+=1):i+=t.sizeOfValue(e),i+=t.sizeOfThen(r),i}static write(t,e,r,i,n,s=1){if(1===s&&t.isCont()?(t=t.write(36),s=3):2===s&&t.isCont()&&(t=t.write(46),s=3),3===s&&(e.isRecord(e.item(r))?t.isCont()&&(t=t.write(123),s=4):s=4),4===s)if((n=void 0===n?e.isRecord(e.item(r))?e.writeBlockValue(t,r):e.writeValue(t,r):n.pull(t)).isDone())n=void 0,s=5;else if(n.isError())return n.asError();return 5===s&&(e.isRecord(e.item(r))?t.isCont()&&(t=t.write(125),s=6):s=6),6===s?e.writeThen(t,i):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Tn(e,r,i,n,s)}static writeThen(t,e,r,i){return Tn.write(t,e,r,i,void 0,2)}}class Pn extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.key=e,this.then=r,this.part=i,this.step=n}pull(t){return Pn.write(t,this.recon,this.key,this.then,this.part,this.step)}static sizeOf(t,e,r){let i=2;return i+=t.sizeOfValue(e),i+=t.sizeOfThen(r),i}static write(t,e,r,i,n,s=1){if(1===s&&t.isCont()?(t=t.write(36),s=3):2===s&&t.isCont()&&(t=t.write(46),s=3),3===s&&t.isCont()&&(t=t.write(64),s=4),4===s){if((n=void 0===n?e.writeValue(t,r):n.pull(t)).isDone())return e.writeThen(t,i);if(n.isError())return n.asError()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Pn(e,r,i,n,s)}static writeThen(t,e,r,i){return Pn.write(t,e,r,i,void 0,2)}}class In extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.index=e,this.then=r,this.part=i,this.step=n}pull(t){return In.write(t,this.recon,this.index,this.then,this.part,this.step)}static sizeOf(t,e,r){let i=2;return i+=t.sizeOfValue(e),i+=t.sizeOfThen(r),i}static sizeOfThen(t,e,r){let i=1;return i+=t.sizeOfValue(e),i+=t.sizeOfThen(r),i}static write(t,e,r,i,n,s=1){if(1===s&&t.isCont()&&(t=t.write(36),s=2),2===s&&t.isCont()&&(t=t.write(35),s=3),3===s){if((n=void 0===n?e.writeValue(t,r):n.pull(t)).isDone())return e.writeThen(t,i);if(n.isError())return n.asError()}return t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new In(e,r,i,n,s)}static writeThen(t,e,r,i){return In.write(t,e,r,i,void 0,2)}}class Dn extends bt{constructor(t,e,r){super(),this.recon=t,this.then=e,this.step=r}pull(t){return Dn.write(t,this.recon,this.then,this.step)}static sizeOf(t,e){let r=3;return r+=t.sizeOfThen(e),r}static write(t,e,r,i=1){return 1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()&&(t=t.write(42),i=4),4===i&&t.isCont()?(t=t.write(58),e.writeThen(t,r)):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Dn(e,r,i)}static writeThen(t,e,r){return Dn.write(t,e,r,2)}}class Ln extends bt{constructor(t,e,r){super(),this.recon=t,this.then=e,this.step=r}pull(t){return Ln.write(t,this.recon,this.then,this.step)}static sizeOf(t,e){let r=3;return r+=t.sizeOfThen(e),r}static write(t,e,r,i=1){return 1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()&&(t=t.write(58),i=4),4===i&&t.isCont()?(t=t.write(42),e.writeThen(t,r)):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Ln(e,r,i)}static writeThen(t,e,r){return Ln.write(t,e,r,2)}}class qn extends bt{constructor(t,e,r){super(),this.recon=t,this.then=e,this.step=r}pull(t){return qn.write(t,this.recon,this.then,this.step)}static sizeOf(t,e){let r=2;return r+=t.sizeOfThen(e),r}static write(t,e,r,i=1){return 1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()?(t=t.write(42),e.writeThen(t,r)):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new qn(e,r,i)}static writeThen(t,e,r){return qn.write(t,e,r,2)}}class An extends bt{constructor(t,e,r){super(),this.recon=t,this.then=e,this.step=r}pull(t){return An.write(t,this.recon,this.then,this.step)}static sizeOf(t,e){let r=3;return r+=t.sizeOfThen(e),r}static write(t,e,r,i=1){return 1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()&&(t=t.write(42),i=4),4===i&&t.isCont()?(t=t.write(42),e.writeThen(t,r)):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new An(e,r,i)}static writeThen(t,e,r){return An.write(t,e,r,2)}}class Fn extends bt{constructor(t,e,r,i,n){super(),this.recon=t,this.predicate=e,this.then=r,this.part=i,this.step=n}pull(t){return Fn.write(t,this.recon,this.predicate,this.then,this.part,this.step)}static sizeOf(t,e,r){let i=2;return i+=t.sizeOfValue(e),i+=1,i+=t.sizeOfThen(r),i}static sizeOfThen(t,e,r){let i=1;return i+=t.sizeOfValue(e),i+=1,i+=t.sizeOfThen(r),i}static write(t,e,r,i,n,s=1){if(1===s&&t.isCont()&&(t=t.write(36),s=2),2===s&&t.isCont()&&(t=t.write(91),s=3),3===s)if((n=void 0===n?e.writeValue(t,r):n.pull(t)).isDone())n=void 0,s=4;else if(n.isError())return n.asError();return 4===s&&t.isCont()?(t=t.write(93),e.writeThen(t,i)):t.isDone()?bt.error(new wt("truncated")):t.isError()?bt.error(t.trap()):new Fn(e,r,i,n,s)}static writeThen(t,e,r,i){return Fn.write(t,e,r,i,void 0,2)}}class Vn{sizeOfAttr(t,e){return pn.sizeOf(this,t,e)}writeAttr(t,e,r){return pn.write(t,this,e,r)}sizeOfSlot(t,e){return mn.sizeOf(this,t,e)}writeSlot(t,e,r){return mn.write(t,this,e,r)}sizeOfBlock(t,e,r){if(3===arguments.length)return yn.sizeOf(this,t,e,r);{const e=this.items(t);return e.hasNext()?yn.sizeOf(this,e,this.isBlockSafe(this.items(t)),!1):2}}writeBlock(t,e,r,i){if(4===arguments.length)return yn.write(t,this,e,r,i);{const r=this.items(e);return r.hasNext()?yn.write(t,this,r,this.isBlockSafe(this.items(e)),!1):xt.writeString(t,"{}")}}sizeOfRecord(t){const e=this.items(t);return e.hasNext()?yn.sizeOf(this,e,!1,!1):2}writeRecord(t,e){const r=this.items(e);return r.hasNext()?yn.write(t,this,r,!1,!1):xt.writeString(t,"{}")}sizeOfPrimary(t){if(this.isRecord(this.item(t))){const e=this.items(this.item(t));if(e.hasNext())return gn.sizeOf(this,e)}else if(!this.isExtant(this.item(t)))return this.sizeOfValue(t);return 2}writePrimary(t,e){if(this.isRecord(this.item(e))){const r=this.items(this.item(e));if(r.hasNext())return gn.write(t,this,r)}else if(!this.isExtant(this.item(e)))return this.writeValue(t,e);return xt.writeString(t,"()")}isBlockSafe(t){for(;t.hasNext();)if(this.isAttr(t.next().value))return!1;return!0}isMarkupSafe(t){if(!t.hasNext()||!this.isAttr(t.next().value))return!1;for(;t.hasNext();)if(this.isAttr(t.next().value))return!1;return!0}sizeOfMarkupText(t){return"string"!=typeof t&&(t=this.string(t)),wn.sizeOf(t)}writeMarkupText(t,e){return"string"!=typeof e&&(e=this.string(e)),wn.write(t,e)}sizeOfData(t){return bn.sizeOf(t)}writeData(t,e){return void 0!==e?bn.write(t,e):xt.writeString(t,"%")}isIdent(t){"string"!=typeof t&&(t=this.string(t));const e=t.length;let r;if(0===e||(r=t.codePointAt(0),void 0!==r&&!Fi.isIdentStartChar(r)))return!1;for(let i=p.offsetByCodePoints(t,0,1);i<e;i=p.offsetByCodePoints(t,i,1))if(r=t.codePointAt(i),void 0===r||!Fi.isIdentChar(r))return!1;return!0}sizeOfText(t){return this.isIdent(t)?vn.sizeOf(t):xn.sizeOf(t)}writeText(t,e){return this.isIdent(e)?vn.write(t,e):xn.write(t,e)}sizeOfNum(t){if(isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<2147483648){let e=Ct.countDigits(t);return t<0&&(e+=1),e}return(""+t).length}writeNum(t,e){return isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<2147483648?Ct.writeInteger(t,e):xt.writeString(t,""+e)}sizeOfUint32(t){return 10}writeUint32(t,e){return _t.lowercase.writeIntegerLiteral(t,e,8)}sizeOfUint64(t){return 18}writeUint64(t,e){return _t.lowercase.writeIntegerLiteral(t,e,16)}sizeOfBool(t){return t?4:5}writeBool(t,e){return xt.writeString(t,e?"true":"false")}sizeOfLambdaFunc(t,e){return Sn.sizeOf(this,t,e)}writeLambdaFunc(t,e,r){return Sn.write(t,this,e,r)}sizeOfConditionalOperator(t,e,r,i){return Cn.sizeOf(this,t,e,r,i)}writeConditionalOperator(t,e,r,i,n){return Cn.write(t,this,e,r,i,n)}sizeOfInfixOperator(t,e,r,i){return kn.sizeOf(this,t,e,r,i)}writeInfixOperator(t,e,r,i,n){return kn.write(t,this,e,r,i,n)}sizeOfPrefixOperator(t,e,r){return Mn.sizeOf(this,t,e,r)}writePrefixOperator(t,e,r,i){return Mn.write(t,this,e,r,i)}sizeOfInvokeOperator(t,e){return On.sizeOf(this,t,e)}writeInvokeOperator(t,e,r){return On.write(t,this,e,r)}sizeOfIdentitySelector(){return 0}writeIdentitySelector(t){return bt.end()}sizeOfThenIdentitySelector(){return 0}writeThenIdentitySelector(t){return bt.end()}sizeOfLiteralSelector(t,e){return En.sizeOf(this,t,e)}writeLiteralSelector(t,e,r){return En.write(t,this,e,r)}sizeOfThenLiteralSelector(t,e){return 0}writeThenLiteralSelector(t,e,r){return bt.end()}sizeOfGetSelector(t,e){return Tn.sizeOf(this,t,e)}writeGetSelector(t,e,r){return Tn.write(t,this,e,r)}sizeOfThenGetSelector(t,e){return Tn.sizeOf(this,t,e)}writeThenGetSelector(t,e,r){return Tn.writeThen(t,this,e,r)}sizeOfGetAttrSelector(t,e){return Pn.sizeOf(this,t,e)}writeGetAttrSelector(t,e,r){return Pn.write(t,this,e,r)}sizeOfThenGetAttrSelector(t,e){return Pn.sizeOf(this,t,e)}writeThenGetAttrSelector(t,e,r){return Pn.writeThen(t,this,e,r)}sizeOfGetItemSelector(t,e){return In.sizeOf(this,t,e)}writeGetItemSelector(t,e,r){return In.write(t,this,e,r)}sizeOfThenGetItemSelector(t,e){return In.sizeOfThen(this,t,e)}writeThenGetItemSelector(t,e,r){return In.writeThen(t,this,e,r)}sizeOfKeysSelector(t){return Dn.sizeOf(this,t)}writeKeysSelector(t,e){return Dn.write(t,this,e)}sizeOfThenKeysSelector(t){return Dn.sizeOf(this,t)}writeThenKeysSelector(t,e){return Dn.writeThen(t,this,e)}sizeOfValuesSelector(t){return Ln.sizeOf(this,t)}writeValuesSelector(t,e){return Ln.write(t,this,e)}sizeOfThenValuesSelector(t){return Ln.sizeOf(this,t)}writeThenValuesSelector(t,e){return Ln.writeThen(t,this,e)}sizeOfChildrenSelector(t){return qn.sizeOf(this,t)}writeChildrenSelector(t,e){return qn.write(t,this,e)}sizeOfThenChildrenSelector(t){return qn.sizeOf(this,t)}writeThenChildrenSelector(t,e){return qn.writeThen(t,this,e)}sizeOfDescendantsSelector(t){return An.sizeOf(this,t)}writeDescendantsSelector(t,e){return An.write(t,this,e)}sizeOfThenDescendantsSelector(t){return An.sizeOf(this,t)}writeThenDescendantsSelector(t,e){return An.writeThen(t,this,e)}sizeOfFilterSelector(t,e){return Fn.sizeOf(this,t,e)}writeFilterSelector(t,e,r){return Fn.write(t,this,e,r)}sizeOfThenFilterSelector(t,e){return Fn.sizeOfThen(this,t,e)}writeThenFilterSelector(t,e,r){return Fn.writeThen(t,this,e,r)}sizeOfExtant(){return 0}writeExtant(t){return bt.end()}sizeOfAbsent(){return 0}writeAbsent(t){return bt.end()}}class zn extends Vn{isField(t){return t instanceof hr}isAttr(t){return t instanceof cr}isSlot(t){return t instanceof fr}isValue(t){return t instanceof mr}isRecord(t){return t instanceof gr}isText(t){return t instanceof kr}isNum(t){return t instanceof Or}isBool(t){return t instanceof Tr}isExpression(t){return t instanceof Dr}isExtant(t){return t instanceof Pr}items(t){return t.iterator()}item(t){return t}key(t){return t.key}value(t){return t.toValue()}string(t){return t.stringValue("")}precedence(t){return t.precedence}sizeOfItem(t){if(t instanceof hr){if(t instanceof cr)return this.sizeOfAttr(t.key,t.value);if(t instanceof fr)return this.sizeOfSlot(t.key,t.value)}else if(t instanceof mr)return this.sizeOfValue(t);throw new wt("No Recon serialization for "+t)}writeItem(t,e){if(e instanceof hr){if(e instanceof cr)return this.writeAttr(t,e.key,e.value);if(e instanceof fr)return this.writeSlot(t,e.key,e.value)}else if(e instanceof mr)return this.writeValue(t,e);return bt.error(new wt("No Recon serialization for "+e))}sizeOfValue(t){if(t instanceof gr)return this.sizeOfRecord(t);if(t instanceof Sr)return this.sizeOfData(t.size);if(t instanceof kr)return this.sizeOfText(t.value);if(t instanceof Or)return t.isUint32()?this.sizeOfUint32(t.value):t.isUint64()?this.sizeOfUint64(t.value):this.sizeOfNum(t.value);if(t instanceof Tr)return this.sizeOfBool(t.value);if(t instanceof li)return this.sizeOfSelector(t);if(t instanceof Lr)return this.sizeOfOperator(t);if(t instanceof xi)return this.sizeOfFunc(t);if(t instanceof Pr)return this.sizeOfExtant();if(t instanceof Ir)return this.sizeOfAbsent();throw new wt("No Recon serialization for "+t)}writeValue(t,e){return e instanceof gr?this.writeRecord(t,e):e instanceof Sr?this.writeData(t,e.asUint8Array()):e instanceof kr?this.writeText(t,e.value):e instanceof Or?e.isUint32()?this.writeUint32(t,e.value):e.isUint64()?this.writeUint64(t,e.value):this.writeNum(t,e.value):e instanceof Tr?this.writeBool(t,e.value):e instanceof li?this.writeSelector(t,e):e instanceof Lr?this.writeOperator(t,e):e instanceof xi?this.writeFunc(t,e):e instanceof Pr?this.writeExtant(t):e instanceof Ir?this.writeAbsent(t):bt.error(new wt("No Recon serialization for "+e))}sizeOfSelector(t){if(t instanceof ci)return this.sizeOfIdentitySelector();if(t instanceof vi)return this.sizeOfLiteralSelector(t.item,t.then);if(t instanceof di)return this.sizeOfGetSelector(t.item,t.then);if(t instanceof fi)return this.sizeOfGetAttrSelector(t.item,t.then);if(t instanceof pi)return this.sizeOfGetItemSelector(t.item,t.then);if(t instanceof mi)return this.sizeOfKeysSelector(t.then);if(t instanceof yi)return this.sizeOfValuesSelector(t.then);if(t instanceof gi)return this.sizeOfChildrenSelector(t.then);if(t instanceof wi)return this.sizeOfDescendantsSelector(t.then);if(t instanceof bi)return this.sizeOfFilterSelector(t.predicate,t.then);throw new wt("No Recon serialization for "+t)}writeSelector(t,e){return e instanceof ci?this.writeIdentitySelector(t):e instanceof vi?this.writeLiteralSelector(t,e.item,e.then):e instanceof di?this.writeGetSelector(t,e.item,e.then):e instanceof fi?this.writeGetAttrSelector(t,e.item,e.then):e instanceof pi?this.writeGetItemSelector(t,e.item,e.then):e instanceof mi?this.writeKeysSelector(t,e.then):e instanceof yi?this.writeValuesSelector(t,e.then):e instanceof gi?this.writeChildrenSelector(t,e.then):e instanceof wi?this.writeDescendantsSelector(t,e.then):e instanceof bi?this.writeFilterSelector(t,e.predicate,e.then):bt.error(new wt("No Recon serialization for "+e))}sizeOfOperator(t){if(t instanceof qr)return this.sizeOfInfixOperator(t.operand1,t.operator,t.operand2,t.precedence);if(t instanceof Fr)return this.sizeOfPrefixOperator(t.operator,t.operand,t.precedence);if(t instanceof ui)return this.sizeOfInvokeOperator(t.func,t.args);if(t instanceof zr)return this.sizeOfConditionalOperator(t.ifTerm,t.thenTerm,t.elseTerm,t.precedence);throw new wt("No Recon serialization for "+t)}writeOperator(t,e){return e instanceof qr?this.writeInfixOperator(t,e.operand1,e.operator,e.operand2,e.precedence):e instanceof Fr?this.writePrefixOperator(t,e.operator,e.operand,e.precedence):e instanceof ui?this.writeInvokeOperator(t,e.func,e.args):e instanceof zr?this.writeConditionalOperator(t,e.ifTerm,e.thenTerm,e.elseTerm,e.precedence):bt.error(new wt("No Recon serialization for "+e))}sizeOfFunc(t){if(t instanceof Si)return this.sizeOfLambdaFunc(t.bindings,t.template);if(t instanceof Ci)return 0;throw new wt("No Recon serialization for "+t)}writeFunc(t,e){return e instanceof Si?this.writeLambdaFunc(t,e.bindings,e.template):e instanceof Ci?bt.end():bt.error(new wt("No Recon serialization for "+e))}sizeOfBlockItem(t){if(t instanceof hr)return this.sizeOfItem(t);if(t instanceof mr)return this.sizeOfBlockValue(t);throw new wt("No Recon serialization for "+t)}writeBlockItem(t,e){return e instanceof hr?this.writeItem(t,e):e instanceof mr?this.writeBlockValue(t,e):bt.error(new wt("No Recon serialization for "+e))}sizeOfBlockValue(t){return t instanceof gr?this.sizeOfBlock(t):this.sizeOfValue(t)}writeBlockValue(t,e){return e instanceof gr?this.writeBlock(t,e):this.writeValue(t,e)}sizeOfThen(t){if(t instanceof li){if(t instanceof ci)return this.sizeOfThenIdentitySelector();if(t instanceof vi)return this.sizeOfThenLiteralSelector(t.item,t.then);if(t instanceof di)return this.sizeOfThenGetSelector(t.item,t.then);if(t instanceof fi)return this.sizeOfThenGetAttrSelector(t.item,t.then);if(t instanceof pi)return this.sizeOfThenGetItemSelector(t.item,t.then);if(t instanceof mi)return this.sizeOfThenKeysSelector(t.then);if(t instanceof yi)return this.sizeOfThenValuesSelector(t.then);if(t instanceof gi)return this.sizeOfThenChildrenSelector(t.then);if(t instanceof wi)return this.sizeOfThenDescendantsSelector(t.then);if(t instanceof bi)return this.sizeOfThenFilterSelector(t.predicate,t.then)}throw new wt("No Recon serialization for "+t)}writeThen(t,e){if(e instanceof li){if(e instanceof ci)return this.writeThenIdentitySelector(t);if(e instanceof vi)return this.writeThenLiteralSelector(t,e.item,e.then);if(e instanceof di)return this.writeThenGetSelector(t,e.item,e.then);if(e instanceof fi)return this.writeThenGetAttrSelector(t,e.item,e.then);if(e instanceof pi)return this.writeThenGetItemSelector(t,e.item,e.then);if(e instanceof mi)return this.writeThenKeysSelector(t,e.then);if(e instanceof yi)return this.writeThenValuesSelector(t,e.then);if(e instanceof gi)return this.writeThenChildrenSelector(t,e.then);if(e instanceof wi)return this.writeThenDescendantsSelector(t,e.then);if(e instanceof bi)return this.writeThenFilterSelector(t,e.predicate,e.then)}return bt.error(new wt("No Recon serialization for "+e))}}const jn={[Symbol.hasInstance]:t=>t instanceof Un||Nn[Symbol.hasInstance](t)||"string"==typeof t},Nn={[Symbol.hasInstance]:t=>b.hasAnyKey(t,"scheme","authority","path","query","fragment")};let Un=(()=>{var t;let i,n,s,a=[];return t=class{constructor(t,e,r,i,n){this.scheme=t,this.authority=e,this.path=r,this.query=i,this.fragment=n,this.hashValue=void 0,this.stringValue=void 0}isDefined(){return this.scheme.isDefined()||this.authority.isDefined()||this.path.isDefined()||this.query.isDefined()||this.fragment.isDefined()}isEmpty(){return!this.scheme.isDefined()&&!this.authority.isDefined()&&this.path.isEmpty()&&!this.query.isDefined()&&!this.fragment.isDefined()}withScheme(t){return(t=Hn.fromLike(t))===this.scheme?this:this.copy(t,this.authority,this.path,this.query,this.fragment)}get schemePart(){return this.scheme.toString()}withSchemePart(t){return this.withScheme(Hn.parse(t))}get schemeName(){return this.scheme.name}withSchemeName(t){return this.withScheme(Hn.create(t))}withAuthority(t){return(t=Gn.fromLike(t))===this.authority?this:this.copy(this.scheme,t,this.path,this.query,this.fragment)}get authorityPart(){return this.authority.toString()}withAuthorityPart(t){return this.withAuthority(Gn.parse(t))}get user(){return this.authority.user}withUser(t){return this.withAuthority(this.authority.withUser(t))}get userPart(){return this.authority.userPart}withUserPart(t){return this.withAuthority(this.authority.withUserPart(t))}get username(){return this.authority.username}withUsername(t,e){if(1===arguments.length)return this.withAuthority(this.authority.withUsername(t));if(2===arguments.length)return this.withAuthority(this.authority.withUsername(t,e));throw new Error(arguments.toString())}get password(){return this.authority.password}withPassword(t){return this.withAuthority(this.authority.withPassword(t))}get host(){return this.authority.host}withHost(t){return this.withAuthority(this.authority.withHost(t))}get hostPart(){return this.authority.hostPart}withHostPart(t){return this.withAuthority(this.authority.withHostPart(t))}get hostAddress(){return this.authority.hostAddress}get hostName(){return this.authority.hostName}withHostName(t){return this.withAuthority(this.authority.withHostName(t))}get hostIPv4(){return this.authority.hostIPv4}withHostIPv4(t){return this.withAuthority(this.authority.withHostIPv4(t))}get hostIPv6(){return this.authority.hostIPv6}withHostIPv6(t){return this.withAuthority(this.authority.withHostIPv6(t))}get port(){return this.authority.port}withPort(t){return this.withAuthority(this.authority.withPort(t))}get portPart(){return this.authority.portPart}withPortPart(t){return this.withAuthority(this.authority.withPortPart(t))}get portNumber(){return this.authority.portNumber}withPortNumber(t){return this.withAuthority(this.authority.withPortNumber(t))}withPath(...t){const e=fs.of(...t);return e===this.path?this:this.copy(this.scheme,this.authority,e,this.query,this.fragment)}get pathPart(){return this.path.toString()}withPathPart(t){return this.withPath(fs.parse(t))}get pathName(){return this.path.name}withPathName(t){return this.withPath(this.path.withName(t))}parentPath(){return this.path.parent()}basePath(){return this.path.base()}parent(){return t.create(this.scheme,this.authority,this.path.parent())}base(){return t.create(this.scheme,this.authority,this.path.base())}appendedPath(...t){return this.withPath(this.path.appended(...t))}appendedSlash(){return this.withPath(this.path.appendedSlash())}appendedSegment(t){return this.withPath(this.path.appendedSegment(t))}prependedPath(...t){return this.withPath(this.path.prepended(...t))}prependedSlash(){return this.withPath(this.path.prependedSlash())}prependedSegment(t){return this.withPath(this.path.prependedSegment(t))}withQuery(t){return(t=xs.fromLike(t))===this.query?this:this.copy(this.scheme,this.authority,this.path,t,this.fragment)}get queryPart(){return this.query.toString()}withQueryPart(t){return this.withQuery(xs.parse(t))}updatedQuery(t,e){return this.withQuery(this.query.updated(t,e))}removedQuery(t){return this.withQuery(this.query.removed(t))}appendedQuery(t,e){return this.withQuery(this.query.appended(t,e))}prependedQuery(t,e){return this.withQuery(this.query.prepended(t,e))}withFragment(e){return(e=Es.fromLike(e))===this.fragment?this:t.create(this.scheme,this.authority,this.path,this.query,e)}get fragmentPart(){return this.fragment.toString()}withFragmentPart(t){return this.withFragment(Es.parse(t))}get fragmentIdentifier(){return this.fragment.identifier}withFragmentIdentifier(t){return this.withFragment(Es.create(t))}endpoint(){return this.path.isDefined()||this.query.isDefined()||this.fragment.isDefined()?t.create(this.scheme,this.authority):this}resolve(e){const r=t.fromLike(e);return r.scheme.isDefined()?this.copy(r.scheme,r.authority,r.path.removeDotSegments(),r.query,r.fragment):r.authority.isDefined()?this.copy(this.scheme,r.authority,r.path.removeDotSegments(),r.query,r.fragment):r.path.isEmpty()?this.copy(this.scheme,this.authority,this.path,r.query.isDefined()?r.query:this.query,r.fragment):r.path.isAbsolute()?this.copy(this.scheme,this.authority,r.path.removeDotSegments(),r.query,r.fragment):this.copy(this.scheme,this.authority,this.merge(r.path).removeDotSegments(),r.query,r.fragment)}merge(t){return this.authority.isDefined()&&this.path.isEmpty()?t.prependedSlash():this.path.isEmpty()?t:this.path.merge(t)}unresolve(e){const r=t.fromLike(e);return this.scheme.equals(r.scheme)&&this.authority.equals(r.authority)?t.create(Hn.undefined(),Gn.undefined(),this.path.unmerge(r.path),r.query,r.fragment):r}copy(e,r,i,n,s){return t.create(e,r,i,n,s)}toLike(){const t={};return t.scheme=this.scheme.toLike(),this.authority.toLike(t),t.path=this.path.toLike(),t.query=this.query.toLike(),t.fragment=this.fragment.toLike(),t}compareTo(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN}equals(e){return this===e||e instanceof t&&this.toString()===e.toString()}hashCode(){let t=this.hashValue;return void 0===t&&(t=p.hash(this.toString()),this.hashValue=t),t}debug(t){return t=t.write("Uri").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("empty").write(40).write(41)}display(t){const e=this.stringValue;return void 0!==e?t=t.write(e):(this.scheme.isDefined()&&(t=t.display(this.scheme).write(58)),this.authority.isDefined()&&(t=t.write(47).write(47).display(this.authority)),t=t.display(this.path),this.query.isDefined()&&(t=t.write(63).display(this.query)),this.fragment.isDefined()&&(t=t.write(35).display(this.fragment))),t}toString(){let t=this.stringValue;return void 0===t&&(t=St.display(this),this.stringValue=t),t}static empty(){return new t(Hn.undefined(),Gn.undefined(),fs.empty(),xs.undefined(),Es.undefined())}static create(e=Hn.undefined(),r=Gn.undefined(),i=fs.empty(),n=xs.undefined(),s=Es.undefined()){return e.isDefined()||r.isDefined()||i.isDefined()||n.isDefined()||s.isDefined()?new t(e,r,i,n,s):t.empty()}static fromLike(e){if(null==e||e instanceof t)return e;if("object"==typeof e)return t.fromInit(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static fromInit(t){const e=Hn.fromLike(t.scheme),r=Gn.fromLike(t.authority),i=fs.fromLike(t.path),n=xs.fromLike(t.query),s=Es.fromLike(t.fragment);return this.create(e,r,i,n,s)}static scheme(e){return e=Hn.fromLike(e),t.create(e,void 0,void 0,void 0,void 0)}static schemePart(e){const r=Hn.parse(e);return t.create(r,void 0,void 0,void 0,void 0)}static schemeName(e){const r=Hn.create(e);return t.create(r,void 0,void 0,void 0,void 0)}static authority(e){return e=Gn.fromLike(e),t.create(void 0,e,void 0,void 0,void 0)}static authorityPart(e){const r=Gn.parse(e);return t.create(void 0,r,void 0,void 0,void 0)}static user(e){const r=Gn.user(e);return t.create(void 0,r,void 0,void 0,void 0)}static userPart(e){const r=Gn.userPart(e);return t.create(void 0,r,void 0,void 0,void 0)}static username(e,r){const i=Gn.username(e,r);return t.create(void 0,i,void 0,void 0,void 0)}static password(e){const r=Gn.password(e);return t.create(void 0,r,void 0,void 0,void 0)}static host(e){const r=Gn.host(e);return t.create(void 0,r,void 0,void 0,void 0)}static hostPart(e){const r=Gn.hostPart(e);return t.create(void 0,r,void 0,void 0,void 0)}static hostName(e){const r=Gn.hostName(e);return t.create(void 0,r,void 0,void 0,void 0)}static hostIPv4(e){const r=Gn.hostIPv4(e);return t.create(void 0,r,void 0,void 0,void 0)}static hostIPv6(e){const r=Gn.hostIPv6(e);return t.create(void 0,r,void 0,void 0,void 0)}static port(e){const r=Gn.port(e);return t.create(void 0,r,void 0,void 0,void 0)}static portPart(e){const r=Gn.portPart(e);return t.create(void 0,r,void 0,void 0,void 0)}static portNumber(e){const r=Gn.portNumber(e);return t.create(void 0,r,void 0,void 0,void 0)}static path(...e){const r=fs.of(...e);return t.create(void 0,void 0,r,void 0,void 0)}static pathPart(e){const r=fs.parse(e);return t.create(void 0,void 0,r,void 0,void 0)}static query(e){return e=xs.fromLike(e),t.create(void 0,void 0,void 0,e,void 0)}static queryPart(e){const r=xs.parse(e);return t.create(void 0,void 0,void 0,r,void 0)}static fragment(e){return e=Es.fromLike(e),t.create(void 0,void 0,void 0,void 0,e)}static fragmentPart(e){const r=Es.parse(e);return t.create(void 0,void 0,void 0,void 0,r)}static fragmentIdentifier(e){const r=Es.create(e);return t.create(void 0,void 0,void 0,void 0,r)}static parseCache(){return new Map}static parse(e){const r=this.parseCache();let i,n;if("string"==typeof e&&(i=r.get(e),void 0!==i&&r.delete(e)),void 0===i){const t="string"==typeof e?xt.stringInput(e):e;n=Bn.parse(t),"string"==typeof e&&t.isCont()&&!n.isError()&&(n=Nt.error(kt.unexpected(t)))}if("string"==typeof e){void 0===i&&(i=n.bind()),r.set(e,i);const s=t.ParseCacheCapacity;let o=r.size;if(o>s){const t=r.keys();let e;for(;o>s&&!0!==(e=t.next()).done;)r.delete(e.value),o-=1}return i}return n}static pathBuilder(){return new gs}static queryBuilder(){return new ks}static form(){return new Rn(t.empty())}static isUnreservedChar(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||45===t||46===t||95===t||126===t}static isSubDelimChar(t){return 33===t||36===t||38===t||40===t||41===t||42===t||43===t||44===t||59===t||61===t||39===t}static isSchemeChar(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||43===t||45===t||46===t}static isUserInfoChar(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e}static isUserChar(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)}static isHostChar(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)}static isPathChar(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e||64===e}static isQueryChar(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e}static isParamChar(e){return t.isUnreservedChar(e)||33===e||36===e||40===e||41===e||42===e||43===e||44===e||47===e||58===e||59===e||63===e||64===e||39===e}static isFragmentChar(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e}static isAlpha(t){return t>=65&&t<=90||t>=97&&t<=122}static toLowerCase(t){return t>=65&&t<=90?t+32:t}static writeScheme(e,r){if(0===r.length||!t.isAlpha(r.charCodeAt(0)))return yt.error(new Error("Invalid scheme: "+r));for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);if(!t.isSchemeChar(n))return yt.error(new Error("Invalid scheme: "+r));e=e.write(n)}return e}static writeUserInfo(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isUserInfoChar(n)?e.write(n):t.writeEncoded(e,n)}return e}static writeUser(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isUserChar(n)?e.write(n):t.writeEncoded(e,n)}return e}static writeHost(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isHostChar(n)?e.write(n):t.writeEncoded(e,n)}return e}static writeHostLiteral(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isHostChar(n)||58===n?e.write(n):t.writeEncoded(e,n)}return e}static writePathSegment(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isPathChar(n)?e.write(n):t.writeEncoded(e,n)}return e}static writeQuery(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isQueryChar(n)?e.write(n):t.writeEncoded(e,n)}return e}static writeParam(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isParamChar(n)?e.write(n):t.writeEncoded(e,n)}return e}static writeFragment(e,r){for(let i=0;i<r.length;i+=1){const n=r.charCodeAt(i);e=t.isFragmentChar(n)?e.write(n):t.writeEncoded(e,n)}return e}static writeEncoded(e,r){return 0===r?(e=t.writePctEncoded(e,192),e=t.writePctEncoded(e,128)):r>=0&&r<=127?e=t.writePctEncoded(e,r):r>=128&&r<=2047?(e=t.writePctEncoded(e,192|r>>>6),e=t.writePctEncoded(e,128|63&r)):r>=2048&&r<=65535?(e=t.writePctEncoded(e,224|r>>>12),e=t.writePctEncoded(e,128|r>>>6&63),e=t.writePctEncoded(e,128|63&r)):r>=65536&&r<=1114111?(e=t.writePctEncoded(e,240|r>>>18),e=t.writePctEncoded(e,128|r>>>12&63),e=t.writePctEncoded(e,128|r>>>6&63),e=t.writePctEncoded(e,128|63&r)):(e=t.writePctEncoded(e,239),e=t.writePctEncoded(e,191),e=t.writePctEncoded(e,189)),e}static writePctEncoded(t,e){const r=_t.lowercase;return t=t.write(37).write(r.encodeDigit(e>>>4&15)).write(r.encodeDigit(15&e))}},(()=>{const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],s=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,a),e(t,null,n,{kind:"method",name:"parseCache",static:!0,private:!1,access:{has:t=>"parseCache"in t,get:t=>t.parseCache},metadata:u},null,a),e(t,null,s,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t.ParseCacheCapacity=256,t})();class Rn extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Rn(t)}mold(t,e){return t=Un.fromLike(t),void 0===e?kr.from(t.toString()):e.concat(kr.from(t.toString()))}cast(t,e){const r=t.target;try{const t=r.stringValue();if("string"==typeof t)return Un.parse(t)}catch(t){}}}class Bn extends Nt{constructor(t,e,r,i,n,s){super(),this.schemeParser=t,this.authorityParser=e,this.pathParser=r,this.queryParser=i,this.fragmentParser=n,this.step=s}feed(t){return Bn.parse(t,this.schemeParser,this.authorityParser,this.pathParser,this.queryParser,this.fragmentParser,this.step)}static parse(t,e,r,i,n,s,o=1){let a=0;if(1===o)if(t.isCont()){const e=t.clone();for(;e.isCont()&&(a=e.head(),Un.isSchemeChar(a));)e.step();o=e.isCont()&&58===a?2:3}else t.isDone()&&(o=3);if(2===o)if((e=void 0===e?Wn.parse(t):e.feed(t)).isDone()){if(t.isCont()&&58===t.head())t=t.step(),o=3;else if(!t.isEmpty())return Nt.error(kt.expected(58,t))}else if(e.isError())return e.asError();if(3===o)if(t.isCont())a=t.head(),47===a?(t=t.step(),o=4):63===a?(t=t.step(),o=7):35===a?(t=t.step(),o=8):o=6;else if(t.isDone())return Nt.done(Un.create(void 0!==e?e.bind():void 0,void 0,void 0,void 0,void 0));if(4===o)if(t.isCont()&&47===t.head())t=t.step(),o=5;else if(t.isCont()){const e=new gs;e.addSlash(),i=bs.parse(t,e),o=6}else if(t.isDone())return Nt.done(Un.create(void 0!==e?e.bind():void 0,void 0,fs.slash(),void 0,void 0));if(5===o)if((r=void 0===r?Zn.parse(t):r.feed(t)).isDone()){if(t.isCont())a=t.head(),63===a?(t=t.step(),o=7):35===a?(t=t.step(),o=8):o=6;else if(t.isDone())return Nt.done(Un.create(void 0!==e?e.bind():void 0,void 0!==r?r.bind():void 0,void 0,void 0,void 0))}else if(r.isError())return r.asError();if(6===o)if((i=void 0===i?bs.parse(t):i.feed(t)).isDone()){if(t.isCont()&&63===t.head())t=t.step(),o=7;else if(t.isCont()&&35===t.head())t=t.step(),o=8;else if(!t.isEmpty())return Nt.done(Un.create(void 0!==e?e.bind():void 0,void 0!==r?r.bind():void 0,i.bind(),void 0,void 0))}else if(i.isError())return i.asError();if(7===o)if((n=void 0===n?Ms.parse(t):n.feed(t)).isDone()){if(t.isCont()&&35===t.head())t=t.step(),o=8;else if(!t.isEmpty())return Nt.done(Un.create(void 0!==e?e.bind():void 0,void 0!==r?r.bind():void 0,void 0!==i?i.bind():void 0,n.bind(),void 0))}else if(n.isError())return n.asError();if(8===o){if((s=void 0===s?Ts.parse(t):s.feed(t)).isDone())return Nt.done(Un.create(void 0!==e?e.bind():void 0,void 0!==r?r.bind():void 0,void 0!==i?i.bind():void 0,void 0!==n?n.bind():void 0,s.bind()));if(s.isError())return s.asError()}return new Bn(e,r,i,n,s,o)}}const Yn={[Symbol.hasInstance]:t=>t instanceof Hn||"string"==typeof t};let Hn=(()=>{var t;let i,n=[];return t=class{constructor(t){this.name=t}isDefined(){return 0!==this.name.length}toLike(){return 0!==this.name.length?this.name:void 0}compareTo(e){return e instanceof t?this.name.localeCompare(e.name):NaN}equals(e){return this===e||e instanceof t&&this.name===e.name}hashCode(){return p.hash(this.name)}debug(t){return t=t.write("UriScheme").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)}display(t){return t=Un.writeScheme(t,this.name)}toString(){return this.name}static undefined(){return new t("")}static create(e){return new t(e)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=Wn.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class Wn extends Nt{constructor(t,e){super(),this.output=t,this.step=e}feed(t){return Wn.parse(t,this.output,this.step)}static parse(t,e,r=1){let i=0;if(1===r)if(t.isCont()&&(i=t.head(),Un.isAlpha(i)))t=t.step(),e=(e=e||re.decodedString()).write(Un.toLowerCase(i)),r=2;else if(!t.isEmpty())return Nt.error(kt.expected("scheme",t));if(2===r){for(;t.isCont()&&(i=t.head(),Un.isSchemeChar(i));)t=t.step(),e.write(Un.toLowerCase(i));if(!t.isEmpty())return Nt.done(Hn.create(e.bind()))}return new Wn(e,r)}}const Xn={[Symbol.hasInstance]:t=>t instanceof Gn||Kn[Symbol.hasInstance](t)||"string"==typeof t},Kn={[Symbol.hasInstance]:t=>b.hasAnyKey(t,"user","host","port")};let Gn=(()=>{var t;let i,n=[];return t=class{constructor(t,e,r){this.user=t,this.host=e,this.port=r,this.hashValue=void 0,this.stringValue=void 0}isDefined(){return this.user.isDefined()||this.host.isDefined()||this.port.isDefined()}withUser(t){return(t=$n.fromLike(t))===this.user?this:this.copy(t,this.host,this.port)}get userPart(){return this.user.toString()}withUserPart(t){return this.withUser($n.parse(t))}get username(){return this.user.username}withUsername(t,e){if(1===arguments.length)return this.withUser(this.user.withUsername(t));if(2===arguments.length)return this.withUser($n.create(t,e));throw new Error(arguments.toString())}get password(){return this.user.password}withPassword(t){return this.withUser(this.user.withPassword(t))}withHost(t){return(t=es.fromLike(t))===this.host?this:this.copy(this.user,t,this.port)}get hostPart(){return this.host.toString()}withHostPart(t){return this.withHost(es.parse(t))}get hostAddress(){return this.host.address}get hostName(){return this.host.name}withHostName(t){return this.withHost(es.hostname(t))}get hostIPv4(){return this.host.ipv4}withHostIPv4(t){return this.withHost(es.ipv4(t))}get hostIPv6(){return this.host.ipv6}withHostIPv6(t){return this.withHost(es.ipv6(t))}withPort(t){return(t=ls.fromLike(t))===this.port?this:this.copy(this.user,this.host,t)}get portPart(){return this.port.toString()}withPortPart(t){return this.withPort(ls.parse(t))}get portNumber(){return this.port.number}withPortNumber(t){return this.withPort(ls.create(t))}copy(e,r,i){return t.create(e,r,i)}toLike(t){return this.isDefined()&&(void 0===t&&(t={}),this.user.toLike(t),this.host.isDefined()&&(t.host=this.host.toLike()),this.port.isDefined()&&(t.port=this.port.toLike())),t}compareTo(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN}equals(e){return this===e||e instanceof t&&this.toString()===e.toString()}hashCode(){let t=this.hashValue;return void 0===t&&(t=p.hash(this.toString()),this.hashValue=t),t}debug(t){return t=t.write("UriAuthority").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)}display(t){const e=this.stringValue;if(void 0!==e)t=t.write(e);else{const e=this.user;e.isDefined()&&(t=t.display(e).write(64)),t=t.display(this.host);const r=this.port;r.isDefined()&&(t=t.write(58).display(r))}return t}toString(){let t=this.stringValue;return void 0===t&&(t=St.display(this),this.stringValue=t),t}static undefined(){return new t($n.undefined(),es.undefined(),ls.undefined())}static create(e=$n.undefined(),r=es.undefined(),i=ls.undefined()){return e.isDefined()||r.isDefined()||i.isDefined()?new t(e,r,i):t.undefined()}static fromLike(e){if(null==e||e instanceof t)return e;if("object"==typeof e)return t.fromInit(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static fromInit(t){const e=$n.fromLike(t.user),r=es.fromLike(t.host),i=ls.fromLike(t.port);return this.create(e,r,i)}static user(t){return t=$n.fromLike(t),this.create(t,void 0,void 0)}static userPart(t){const e=$n.parse(t);return this.create(e,void 0,void 0)}static username(t,e){const r=$n.create(t,e);return this.create(r,void 0,void 0)}static password(t){const e=$n.create("",t);return this.create(e,void 0,void 0)}static host(t){return t=es.fromLike(t),this.create(void 0,t,void 0)}static hostPart(t){const e=es.parse(t);return this.create(void 0,e,void 0)}static hostName(t){const e=es.hostname(t);return this.create(void 0,e,void 0)}static hostIPv4(t){const e=es.ipv4(t);return this.create(void 0,e,void 0)}static hostIPv6(t){const e=es.ipv6(t);return this.create(void 0,e,void 0)}static port(t){return t=ls.fromLike(t),this.create(void 0,void 0,t)}static portPart(t){const e=ls.parse(t);return this.create(void 0,void 0,e)}static portNumber(t){const e=ls.create(t);return this.create(void 0,void 0,e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=Zn.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class Zn extends Nt{constructor(t,e,r,i){super(),this.userParser=t,this.hostParser=e,this.portParser=r,this.step=i}feed(t){return Zn.parse(t,this.userParser,this.hostParser,this.portParser,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n)if(t.isCont()){const e=t.clone();for(;e.isCont()&&(s=e.head(),64!==s&&47!==s);)e.step();n=e.isCont()&&64===s?2:3}else t.isDone()&&(n=3);if(2===n)if((e=void 0===e?_n.parse(t):e.feed(t)).isDone()){if(t.isCont()&&64===t.head())t=t.step(),n=3;else if(!t.isEmpty())return Nt.error(kt.expected(64,t))}else if(e.isError())return e.asError();if(3===n)if((r=void 0===r?os.parse(t):r.feed(t)).isDone()){if(t.isCont()&&58===t.head())t=t.step(),n=4;else if(!t.isEmpty())return Nt.done(Gn.create(void 0!==e?e.bind():void 0,r.bind()))}else if(r.isError())return r.asError();if(4===n){if((i=void 0===i?cs.parse(t):i.feed(t)).isDone())return Nt.done(Gn.create(void 0!==e?e.bind():void 0,r.bind(),i.bind()));if(i.isError())return i.asError()}return new Zn(e,r,i,n)}}const Qn={[Symbol.hasInstance]:t=>t instanceof $n||Jn[Symbol.hasInstance](t)||"string"==typeof t},Jn={[Symbol.hasInstance]:t=>b.hasAnyKey(t,"username","password")};let $n=(()=>{var t;let i,n=[];return t=class{constructor(t,e){this.username=t,this.password=e}isDefined(){return void 0!==this.username}withUsername(t){return t===this.username?this:this.copy(t,this.password)}withPassword(t){return t===this.password?this:this.copy(this.username,t)}copy(e,r){return t.create(e,r)}toLike(t){return void 0!==this.username&&(void 0===t&&(t={}),t.username=this.username,void 0!==this.password&&(t.password=this.password)),t}equals(e){return this===e||e instanceof t&&(this.username===e.username&&this.password===e.password)}hashCode(){return p.hash(this.toString())}debug(t){return t=t.write("UriUser").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)}display(t){return void 0!==this.username&&(t=Un.writeUser(t,this.username),void 0!==this.password&&(t=t.write(58),t=Un.writeUser(t,this.password))),t}toString(){return St.display(this)}static undefined(){return new t(void 0,void 0)}static create(e,r){return void 0===e&&void 0===r?t.undefined():new t(e,r)}static fromInit(e){return t.create(e.username,e.password)}static fromLike(e){if(null==e||e instanceof t)return e;if("object"==typeof e)return t.fromInit(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=_n.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class _n extends Nt{constructor(t,e,r,i){super(),this.usernameOutput=t,this.passwordOutput=e,this.c1=r,this.step=i}feed(t){return _n.parse(t,this.usernameOutput,this.passwordOutput,this.c1,this.step)}static parse(t,e,r,i=0,n=1){let s=0;for(;;){if(1===n){for(e=e||re.decodedString();t.isCont()&&(s=t.head(),Un.isUserChar(s));)t=t.step(),e.write(s);if(t.isCont()&&58===s)t=t.step(),n=4;else if(t.isCont()&&37===s)t=t.step(),n=2;else if(!t.isEmpty())return Nt.done($n.create(e.bind()))}if(2===n)if(t.isCont()&&(s=t.head(),_t.isDigit(s)))t=t.step(),i=s,n=3;else if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t));if(3===n){if(t.isCont()&&(s=t.head(),_t.isDigit(s))){t=t.step(),e.write(_t.decodeDigit(i)<<4|_t.decodeDigit(s)),i=0,n=1;continue}if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t))}if(4===n){for(r=r||re.decodedString();t.isCont()&&(s=t.head(),Un.isUserInfoChar(s));)t=t.step(),r.write(s);if(t.isCont()&&37===s)t=t.step(),n=5;else if(!t.isEmpty())return Nt.done($n.create(e.bind(),r.bind()))}if(5===n)if(t.isCont()&&(s=t.head(),_t.isDigit(s)))t=t.step(),i=s,n=6;else if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t));if(6===n){if(t.isCont()&&(s=t.head(),_t.isDigit(s))){t=t.step(),r.write(_t.decodeDigit(i)<<4|_t.decodeDigit(s)),i=0,n=4;continue}if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t))}break}return new _n(e,r,i,n)}}const ts={[Symbol.hasInstance]:t=>t instanceof es||"string"==typeof t};let es=(()=>{var t;let i,n=[];return t=class{constructor(){}isDefined(){return!0}get name(){}get ipv4(){}get ipv6(){}toLike(){return this.toString()}compareTo(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN}equals(e){return this===e||e instanceof t&&this.toString()===e.toString()}hashCode(){return p.hash(this.toString())}static undefined(){return new rs}static hostname(t){return new is(t)}static ipv4(t){return new ns(t)}static ipv6(t){return new ss(t)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=os.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class rs extends es{constructor(){super()}isDefined(){return!1}get address(){return""}debug(t){return t=t.write("UriHost").write(46).write("undefined").write(40).write(41)}display(t){return t}toString(){return""}}class is extends es{constructor(t){super(),this.address=t}get name(){return this.address}debug(t){return t=t.write("UriHost").write(46).write("hostname").write(40).debug(this.address).write(41)}display(t){return t=Un.writeHost(t,this.address)}toString(){return this.address}}class ns extends es{constructor(t){super(),this.address=t}get ipv4(){return this.address}debug(t){return t=t.write("UriHost").write(46).write("ipv4").write(40).debug(this.address).write(41)}display(t){return t=Un.writeHost(t,this.address)}toString(){return this.address}}class ss extends es{constructor(t){super(),this.address=t}get ipv6(){return this.address}debug(t){return t=t.write("UriHost").write(46).write("ipv6").write(40).debug(this.address).write(41)}display(t){return t=t.write(91),t=(t=Un.writeHostLiteral(t,this.address)).write(93)}toString(){return"["+this.address+"]"}}class os extends Nt{feed(t){return os.parse(t)}static parse(t){if(t.isCont()){return 91===t.head()?us.parse(t):as.parse(t)}return t.isDone()?Nt.done(es.hostname("")):new os}}class as extends Nt{constructor(t,e,r,i){super(),this.output=t,this.c1=e,this.x=r,this.step=i}feed(t){return as.parse(t,this.output,this.c1,this.x,this.step)}static parse(t,e,r=0,i=0,n=1){let s=0;for(e=e||re.decodedString();n<=4;){for(;t.isCont()&&(s=t.head(),Ct.isDigit(s));)t=t.step(),e=e.write(s),i=10*i+Ct.decodeDigit(s);if(!t.isCont()){if(t.isEmpty())break;return 4===n&&i<=255?Nt.done(es.ipv4(e.bind())):Nt.done(es.hostname(e.bind()))}if(!(46===s&&n<4&&i<=255)){if(!Un.isHostChar(s)&&37!==s&&4===n&&i<=255)return Nt.done(es.ipv4(e.bind()));i=0,n=5;break}t=t.step(),e=e.write(s),i=0,n+=1}for(;;){if(5===n){for(;t.isCont()&&(s=t.head(),Un.isHostChar(s));)t=t.step(),e.write(Un.toLowerCase(s));if(t.isCont()&&37===s)t=t.step(),n=6;else if(!t.isEmpty())return Nt.done(es.hostname(e.bind()))}if(6===n)if(t.isCont()&&(s=t.head(),_t.isDigit(s)))t=t.step(),r=s,n=7;else if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t));if(7===n){if(t.isCont()&&(s=t.head(),_t.isDigit(s))){t=t.step(),e.write(_t.decodeDigit(r)<<4|_t.decodeDigit(s)),r=0,n=5;continue}if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t))}break}return new as(e,r,i,n)}}class us extends Nt{constructor(t,e){super(),this.output=t,this.step=e}feed(t){return us.parse(t,this.output,this.step)}static parse(t,e,r=1){let i=0;if(1===r)if(t.isCont()&&91===t.head())t=t.step(),r=2;else if(!t.isEmpty())return Nt.error(kt.expected(91,t));if(2===r){for(e=e||re.decodedString();t.isCont()&&(i=t.head(),Un.isHostChar(i)||58===i);)t=t.step(),e=e.write(Un.toLowerCase(i));if(t.isCont()&&93===i)return t=t.step(),Nt.done(es.ipv6(e.bind()));if(!t.isEmpty())return Nt.error(kt.expected(93,t))}return new us(e,r)}}const hs={[Symbol.hasInstance]:t=>t instanceof ls||"number"==typeof t||"string"==typeof t};let ls=(()=>{var t;let i,n=[];return t=class{constructor(t){this.number=t}isDefined(){return 0!==this.number}valueOf(){return this.number}toLike(){return this.number}compareTo(e){return e instanceof t?this.number<e.number?-1:this.number>e.number?1:0:NaN}equals(e){return this===e||e instanceof t&&this.number===e.number}hashCode(){return p.hash(this.toString())}debug(t){return t=t.write("UriPort").write(46),this.isDefined()?(t=t.write("create").write(40),t=St.displayNumber(t,this.number)):t=t.write("undefined").write(40),t=t.write(41)}display(t){return t=St.displayNumber(t,this.number)}toString(){return""+this.number}static undefined(){return new t(0)}static create(e){if(e<0)throw new TypeError(""+e);return 0===e?t.undefined():new t(e)}static fromLike(e){if(null==e||e instanceof t)return e;if("number"==typeof e)return t.create(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=cs.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class cs extends Nt{constructor(t){super(),this.number=t}feed(t){return cs.parse(t,this.number)}static parse(t,e=0){let r=0;for(;t.isCont()&&(r=t.head(),Ct.isDigit(r));)t=t.step(),e=10*e+Ct.decodeDigit(r);return t.isEmpty()?new cs(e):Nt.done(ls.create(e))}}const ds={[Symbol.hasInstance]:t=>t instanceof fs||Array.isArray(t)||"string"==typeof t};let fs=(()=>{var t;let i,n,s=[];return t=class{constructor(){}get length(){let t=0,e=this;for(;!e.isEmpty();)t+=1,e=e.tail();return t}get(t){let e=0,r=this;for(;!r.isEmpty();){if(e>=t)return r.head();e+=1,r=r.tail()}}get name(){if(this.isEmpty())return"";let t=this;for(;;){const e=t.tail();if(e.isEmpty())return t.isRelative()?t.head():"";t=e}}withName(t){const e=new gs;return e.addPath(this.base()),e.addSegment(t),e.build()}body(){if(this.isEmpty())return this;const t=new gs;let e=this;for(;;){const r=e.tail();if(r.isEmpty())return t.build();e.isSegment()?t.addSegment(e.head()):e.isAbsolute()&&t.addSlash(),e=r}}foot(){if(this.isEmpty())return this;let t=this;for(;;){const e=t.tail();if(e.isEmpty())return t;t=e}}isSubpathOf(e){e=t.fromLike(e);let r=this;for(;!r.isEmpty()&&!e.isEmpty();){if(r.isRelative()!=e.isRelative()||r.head()!==e.head())return!1;r=r.tail(),e=e.tail()}return e.isEmpty()}appended(...t){if(0===arguments.length)return this;const e=new gs;return e.addPath(this),e.push(...t),e.build()}appendedSlash(){const t=new gs;return t.addPath(this),t.addSlash(),t.build()}appendedSegment(t){const e=new gs;return e.addPath(this),e.addSegment(t),e.build()}prepended(...t){if(0===arguments.length)return this;const e=new gs;return e.push(...t),e.addPath(this),e.build()}prependedSlash(){return new ms(this)}prependedSegment(e){return this.isEmpty()||this.isAbsolute()?t.segment(e,this):t.segment(e,this.prependedSlash())}resolve(t){return t.isEmpty()?this:t.isAbsolute()||this.isEmpty()?t.removeDotSegments():this.merge(t).removeDotSegments()}removeDotSegments(){let e=this;const r=new gs;for(;!e.isEmpty();){const i=e.head();if("."===i||".."===i)e=e.tail(),e.isEmpty()||(e=e.tail());else if(e.isAbsolute()){const n=e.tail();if(n.isEmpty())r.push(e.head()),e=e.tail();else{const s=n.head();"."===s?(e=n.tail(),e.isEmpty()&&(e=t.slash())):".."===s?(e=n.tail(),e.isEmpty()&&(e=t.slash()),r.isEmpty()||r.pop().isAbsolute()||r.isEmpty()||r.pop()):(r.push(i,s),e=n.tail())}}else r.push(e.head()),e=e.tail()}return r.build()}merge(t){if(this.isEmpty())return t;const e=new gs;let r=this;for(;;){const t=r.tail();if(t.isEmpty()){r.isAbsolute()&&e.addSlash();break}r.isAbsolute()?e.addSlash():e.addSegment(r.head()),r=t}return e.addPath(t),e.build()}unmerge(e){let r=this,i=e;if(r.isEmpty())return i;for(;;){if(r.isEmpty())return i.isEmpty()||i.tail().isEmpty()?i:i.tail();if(r.isRelative())return i;if(i.isRelative())return i.prependedSlash();let n=r.tail(),s=i.tail();if(!n.isEmpty()&&s.isEmpty())return t.slash();if(n.isEmpty()||s.isEmpty()||n.isRelative()!=s.isRelative()||n.head()!==s.head())return s;if(n=n.tail(),s=s.tail(),!n.isEmpty()&&s.isEmpty())return e;r=n,i=s}}relativeTo(e){return t.difference(e,this)}static difference(t,e){let r=!1;for(;!t.isEmpty()&&!e.isEmpty()&&t.isRelative()===e.isRelative()&&t.head()===e.head();)r=t.isAbsolute(),t=t.tail(),e=e.tail();if(t.isEmpty())return e;const i=new gs;for(;!t.isEmpty();)t.isRelative()&&i.addSegment(".."),t=t.tail();return r&&i.addSlash(),i.addPath(e),i.build()}toLike(){const t=[];let e=this;for(;!e.isEmpty();)t.push(e.head()),e=e.tail();return t}compareTo(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN}equals(e){return this===e||e instanceof t&&this.toString()===e.toString()}hashCode(){return p.hash(this.toString())}display(t){let e=this;for(;!e.isEmpty();)t=e.isAbsolute()?t.write(47):Un.writePathSegment(t,e.head()),e=e.tail();return t}static builder(){return new gs}static empty(){return new ps}static slash(t){return void 0===t?ms.slash():("string"==typeof t&&(t=this.segment(t)),new ms(t))}static segment(e,r){return void 0===r&&(r=t.empty()),new ys(e,r)}static of(...t){const e=new gs;return e.push(...t),e.build()}static fromLike(e){if(null==e||e instanceof t)return e;if(Array.isArray(e))return t.of(...e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=bs.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}static pathForm(){return new ws(t.empty())}},(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:a},null,s),e(t,null,n,{kind:"method",name:"pathForm",static:!0,private:!1,access:{has:t=>"pathForm"in t,get:t=>t.pathForm},metadata:a},null,s),a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),r(t,s)})(),t})();class ps extends fs{constructor(){super()}isDefined(){return!1}isAbsolute(){return!1}isRelative(){return!0}isSegment(){return!1}isEmpty(){return!0}head(){throw new Error("empty path")}tail(){throw new Error("empty path")}setTail(t){throw new Error("empty path")}dealias(){return this}parent(){return this}base(){return this}appended(...t){return fs.of(...t)}appendedSlash(){return fs.slash()}appendedSegment(t){return fs.segment(t)}prepended(...t){return fs.of(...t)}prependedSlash(){return fs.slash()}prependedSegment(t){return fs.segment(t)}merge(t){return t}debug(t){return t=t.write("UriPath").write(46).write("empty").write(40).write(41)}display(t){return t}toString(){return""}}let ms=(()=>{var t;let i,n=fs,s=[];return t=class extends n{constructor(t){super(),this.rest=t,this.stringValue=void 0}isDefined(){return!0}isAbsolute(){return!0}isRelative(){return!1}isSegment(){return!1}isEmpty(){return!1}head(){return"/"}tail(){return this.rest}setTail(t){this.rest=t}dealias(){return new t(this.rest)}parent(){const e=this.rest;if(e.isEmpty())return fs.empty();return e.tail().isEmpty()?fs.slash():new t(e.parent())}base(){const e=this.rest;return e.isEmpty()?this:new t(e.base())}prependedSegment(t){return fs.segment(t,this)}debug(t){return t=t.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)}display(t){const e=this.stringValue;return t=void 0!==e?t.write(e):super.display(t)}toString(){let t=this.stringValue;return void 0===t&&(t=St.display(this),this.stringValue=t),t}static slash(){return new t(fs.empty())}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"slash",static:!0,private:!1,access:{has:t=>"slash"in t,get:t=>t.slash},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class ys extends fs{constructor(t,e){super(),this.segment=t,this.rest=e,this.stringValue=void 0}isDefined(){return!0}isAbsolute(){return!1}isRelative(){return!0}isSegment(){return!0}isEmpty(){return!1}head(){return this.segment}tail(){return this.rest}setTail(t){if(t instanceof ys)throw new Error("adjacent path segments");this.rest=t}dealias(){return new ys(this.segment,this.rest)}parent(){const t=this.rest;if(t.isEmpty())return fs.empty();return t.tail().isEmpty()?fs.empty():new ys(this.segment,t.parent())}base(){const t=this.rest;return t.isEmpty()?fs.empty():new ys(this.segment,t.base())}prependedSegment(t){return fs.segment(t,this.prependedSlash())}debug(t){return t=t.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)}display(t){const e=this.stringValue;return t=void 0!==e?t.write(e):super.display(t)}toString(){let t=this.stringValue;return void 0===t&&(t=St.display(this),this.stringValue=t),t}}class gs{constructor(){this.first=fs.empty(),this.last=null,this.size=0,this.aliased=0}isEmpty(){return 0===this.size}push(...t){for(let e=0;e<t.length;e+=1){const r=t[e];r instanceof fs?this.addPath(r):Array.isArray(r)?this.push(...r):"/"===r?this.addSlash():this.addSegment(r)}}build(){return this.aliased=0,this.first}addSlash(){const t=fs.slash().dealias(),e=this.size;0===e?this.first=t:this.dealias(e-1).setTail(t),this.last=t,this.size=e+1,this.aliased+=1}addSegment(t){const e=fs.segment(t,fs.empty());let r=this.size;if(0===r)this.first=e;else{const t=this.dealias(r-1);t.isAbsolute()?t.setTail(e):(t.setTail(e.prependedSlash()),r+=1,this.aliased+=1)}this.last=e,this.size=r+1,this.aliased+=1}addPath(t){if(t.isEmpty())return;let e=this.size;if(0===e)this.first=t;else{const r=this.dealias(e-1);r.isAbsolute()||t.isAbsolute()?r.setTail(t):(r.setTail(t.prependedSlash()),e+=1,this.aliased+=1)}for(e+=1;;){const r=t.tail();if(r.isEmpty())break;t=r,e+=1}this.last=t,this.size=e}pop(){const t=this.size,e=this.aliased;if(0===t)throw new Error("Empty UriPath");if(1===t){const r=this.first;return this.first=r.tail(),r.tail().isEmpty()&&(this.last=null),this.size=t-1,e>0&&(this.aliased=e-1),r}const r=this.dealias(t-2);return r.setTail(fs.empty()),this.last=r,this.size=t-1,this.aliased=e-1,r.tail()}dealias(t){let e=0,r=null,i=this.first;if(this.aliased<=t){for(;e<this.aliased;)r=i,i=i.tail(),e+=1;for(;e<=t;){const t=i.dealias();0===e?this.first=t:r.setTail(t),r=t,i=i.tail(),e+=1}e===this.size&&(this.last=r),this.aliased=e}else if(0===t)r=this.first;else if(t===this.size-1)r=this.last;else for(;e<=t;)r=i,i=i.tail(),e+=1;return r}toString(){return this.build().toString()}}class ws extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new ws(t)}mold(t,e){return t=fs.fromLike(t),void 0===e?kr.from(t.toString()):e.concat(kr.from(t.toString()))}cast(t,e){const r=t.target;try{const t=r.stringValue();if("string"==typeof t)return fs.parse(t)}catch(t){}}}class bs extends Nt{constructor(t,e,r,i){super(),this.builder=t,this.output=e,this.c1=r,this.step=i}feed(t){return bs.parse(t,this.builder,this.output,this.c1,this.step)}static parse(t,e,r,i=0,n=1){let s=0;for(;;){if(1===n){for(;t.isCont()&&(s=t.head(),Un.isPathChar(s));)r=r||re.decodedString(),t=t.step(),r=r.write(s);if(t.isCont()&&47===s){t=t.step(),e=e||new gs,void 0!==r&&(e.addSegment(r.bind()),r=void 0),e.addSlash();continue}if(t.isCont()&&37===s)t=t.step(),n=2;else if(!t.isEmpty())return void 0!==r&&(e=e||new gs).addSegment(r.bind()),void 0!==e?Nt.done(e.build()):Nt.done(fs.empty())}if(2===n)if(t.isCont()&&(s=t.head(),_t.isDigit(s)))t=t.step(),i=s,n=3;else if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t));if(3===n){if(t.isCont()&&(s=t.head(),_t.isDigit(s))){r=r||re.decodedString(),t=t.step(),r=r.write(_t.decodeDigit(i)<<4|_t.decodeDigit(s)),i=0,n=1;continue}if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t))}break}return new bs(e,r,i,n)}}const vs={[Symbol.hasInstance]:t=>t instanceof xs||"object"==typeof t&&null!==t||"string"==typeof t};let xs=(()=>{var t;let i,n=[];return t=class{get length(){let t=0,e=this;for(;!e.isEmpty();)t+=1,e=e.tail();return t}has(t){let e=this;for(;!e.isEmpty();){if(t===e.key)return!0;e=e.tail()}return!1}get(t){let e=this;for(;!e.isEmpty();){if(t===e.key)return e.value;e=e.tail()}}updated(t,e){let r=this;const i=new ks;let n=!1;for(;!r.isEmpty();)t===r.key?(i.addParam(t,e),n=!0):i.addParam(r.key,r.value),r=r.tail();return n||i.addParam(t,e),i.build()}removed(t){let e=this;const r=new ks;let i=!1;for(;!e.isEmpty();)t===e.key?i=!0:r.addParam(e.key,e.value),e=e.tail();return i?r.build():this}appended(t,e){const r=new ks;return r.addQuery(this),r.add(t,e),r.build()}prepended(t,e){const r=new ks;return r.add(t,e),r.addQuery(this),r.build()}toLike(t){if(this.isDefined()){t=t||{};let e=this,r=0;for(;!e.isEmpty();){const i=e.key;void 0!==i?t[i]=e.value:t["$"+r]=e.value,e=e.tail(),r+=1}}return t}compareTo(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN}equals(e){return this===e||e instanceof t&&this.toString()===e.toString()}hashCode(){return p.hash(this.toString())}display(t){let e=this,r=!0;for(;!e.isEmpty();){r?r=!1:t=t.write(38);const i=e.key;void 0!==i&&(t=(t=Un.writeParam(t,i)).write(61)),t=Un.writeQuery(t,e.value),e=e.tail()}return t}static builder(){return new ks}static undefined(){return new Ss}static param(e,r,i){return void 0===i&&(i=r,r=e,e=void 0),void 0===i&&(i=t.undefined()),new Cs(e,r,i)}static fromLike(e){if(null==e||e instanceof t)return e;if("object"==typeof e){const t=new ks;return t.add(e),t.build()}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=Ms.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class Ss extends xs{isDefined(){return!1}isEmpty(){return!0}head(){throw new Error("undefined query")}get key(){throw new Error("undefined query")}get value(){throw new Error("undefined query")}tail(){throw new Error("undefined query")}setTail(t){throw new Error("undefined query")}dealias(){return this}updated(t,e){return xs.param(t,e,this)}removed(t){return this}appended(t,e){const r=new ks;return r.add(t,e),r.build()}prepended(t,e){const r=new ks;return r.add(t,e),r.build()}debug(t){return t=t.write("UriQuery").write(46).write("undefined").write(40).write(41)}display(t){return t}toString(){return""}}class Cs extends xs{constructor(t,e,r){super(),this.key=t,this.value=e,this.rest=r,this.stringValue=void 0}isDefined(){return!0}isEmpty(){return!1}head(){return[this.key,this.value]}tail(){return this.rest}setTail(t){this.rest=t}dealias(){return new Cs(this.key,this.value,this.rest)}debug(t){return t=t.write("UriQuery").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)}display(t){const e=this.stringValue;return t=void 0!==e?t.write(e):super.display(t)}toString(){let t=this.stringValue;return void 0===t&&(t=St.display(this),this.stringValue=t),t}}class ks{constructor(){this.first=xs.undefined(),this.last=null,this.size=0,this.aliased=0}isEmpty(){return 0===this.size}add(t,e){if(void 0!==e)this.addParam(t,e);else if("string"==typeof t)this.addParam(void 0,t);else if(t instanceof xs)this.addQuery(t);else{const e=t;for(const t in e){let r=t;const i=e[t];36===t.charCodeAt(0)&&(r=void 0),this.addParam(r,i)}}}build(){return this.aliased=0,this.first}addParam(t,e){void 0===e&&(e=t,t=void 0);const r=xs.param(t,e,xs.undefined()),i=this.size;0===i?this.first=r:this.dealias(i-1).setTail(r),this.last=r,this.size=i+1,this.aliased+=1}addQuery(t){if(t.isEmpty())return;let e=this.size;for(0===e?this.first=t:this.dealias(e-1).setTail(t),e+=1;;){const r=t.tail();if(r.isEmpty())break;t=r,e+=1}this.last=t,this.size=e}dealias(t){let e=0,r=null,i=this.first;if(this.aliased<=t){for(;e<this.aliased;)r=i,i=i.tail(),e+=1;for(;e<=t;){const t=i.dealias();0===e?this.first=t:r.setTail(t),r=t,i=i.tail(),e+=1}e===this.size&&(this.last=r),this.aliased=e}else if(0===t)r=this.first;else if(t===this.size-1)r=this.last;else for(;e<=t;)r=i,i=i.tail(),e+=1;return r}toString(){return this.build().toString()}}class Ms extends Nt{constructor(t,e,r,i,n){super(),this.builder=t,this.keyOutput=e,this.valueOutput=r,this.c1=i,this.step=n}feed(t){return Ms.parse(t,this.builder,this.keyOutput,this.valueOutput,this.c1,this.step)}static parse(t,e,r,i,n=0,s=1){let o=0;for(;;){if(1===s){for(r=r||re.decodedString();t.isCont()&&(o=t.head(),Un.isParamChar(o));)t=t.step(),r.write(o);if(t.isCont()&&61===o)t=t.step(),s=4;else{if(t.isCont()&&38===o){t=t.step(),(e=e||new ks).addParam(r.bind()),r=void 0;continue}if(t.isCont()&&37===o)t=t.step(),s=2;else if(!t.isEmpty())return(e=e||new ks).addParam(r.bind()),Nt.done(e.build())}}if(2===s)if(t.isCont()&&(o=t.head(),_t.isDigit(o)))t=t.step(),n=o,s=3;else if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t));if(3===s){if(t.isCont()&&(o=t.head(),_t.isDigit(o))){t=t.step(),r.write(_t.decodeDigit(n)<<4|_t.decodeDigit(o)),n=0,s=1;continue}if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t))}if(4===s){for(i=i||re.decodedString();t.isCont()&&(o=t.head(),Un.isParamChar(o)||61===o);)t=t.step(),i.write(o);if(t.isCont()&&38===o){t=t.step(),(e=e||new ks).addParam(r.bind(),i.bind()),r=void 0,i=void 0,s=1;continue}if(t.isCont()&&37===o)t=t.step(),s=5;else if(!t.isEmpty())return(e=e||new ks).addParam(r.bind(),i.bind()),Nt.done(e.build())}if(5===s)if(t.isCont()&&(o=t.head(),_t.isDigit(o)))t=t.step(),n=o,s=6;else if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t));if(6===s){if(t.isCont()&&(o=t.head(),_t.isDigit(o))){t=t.step(),i.write(_t.decodeDigit(n)<<4|_t.decodeDigit(o)),n=0,s=4;continue}if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t))}break}return new Ms(e,r,i,n,s)}}const Os={[Symbol.hasInstance]:t=>t instanceof Es||"string"==typeof t};let Es=(()=>{var t;let i,n=[];return t=class{constructor(t){this.identifier=t,this.stringValue=void 0}isDefined(){return void 0!==this.identifier}toLike(){return this.identifier}compareTo(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN}equals(e){return this===e||e instanceof t&&this.identifier===e.identifier}hashCode(){return p.hash(this.identifier)}debug(t){return t=t.write("UriFragment").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)}display(t){const e=this.stringValue;return void 0!==e?t=t.write(e):void 0!==this.identifier&&(t=Un.writeFragment(t,this.identifier)),t}toString(){let t=this.stringValue;return void 0===t&&(t=St.display(this),this.stringValue=t),t}static undefined(){return new t(void 0)}static create(e){return void 0===e?t.undefined():new t(e)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){const e="string"==typeof t?xt.stringInput(t):t;let r=Ts.parse(e);return"string"==typeof t&&e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),"string"==typeof t?r.bind():r}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();class Ts extends Nt{constructor(t,e,r){super(),this.output=t,this.c1=e,this.step=r}feed(t){return Ts.parse(t,this.output,this.c1,this.step)}static parse(t,e,r=0,i=1){let n=0;for(e=e||re.decodedString();;){if(1===i){for(;t.isCont()&&(n=t.head(),Un.isFragmentChar(n));)t=t.step(),e=e.write(n);if(t.isCont()&&37===n)t=t.step(),i=2;else if(!t.isEmpty())return Nt.done(Es.create(e.bind()))}if(2===i)if(t.isCont()&&(n=t.head(),_t.isDigit(n)))t=t.step(),r=n,i=3;else if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t));if(3===i){if(t.isCont()&&(n=t.head(),_t.isDigit(n))){t=t.step(),e=e.write(_t.decodeDigit(r)<<4|_t.decodeDigit(n)),r=0,i=1;continue}if(!t.isEmpty())return Nt.error(kt.expected("hex digit",t))}break}return new Ts(e,r,i)}}const Ps={[Symbol.hasInstance]:t=>t instanceof Is||"number"==typeof t||"string"==typeof t};let Is=(()=>{var t;let i,n=[];return t=class{isDefined(){return isFinite(this.value)}plus(e,r=this.units,i){return e=t.fromLike(e),t.of(this.toValue(r,i)+e.toValue(r,i),r)}negative(e=this.units,r){return t.of(-this.toValue(e,r),e)}minus(e,r=this.units,i){return e=t.fromLike(e),t.of(this.toValue(r,i)-e.toValue(r,i),r)}times(e,r=this.units,i){return t.of(this.toValue(r,i)*e,r)}divide(e,r=this.units,i){return t.of(this.toValue(r,i)/e,r)}combine(e,r=1,i=this.units,n){return e=t.fromLike(e),t.of(this.toValue(i,n)+e.toValue(i,n)*r,i)}emValue(e){return 0!==this.value?this.pxValue(e)/t.emUnit(e):0}remValue(e){return 0!==this.value?this.pxValue(e)/t.remUnit(e):0}pctValue(e){return 0!==this.value?this.pxValue(e)/t.pctUnit(e):0}px(t){return Ds.of(this.pxValue(t))}em(t){return Ls.of(this.emValue(t))}rem(t){return qs.of(this.remValue(t))}pct(t){return As.of(this.pctValue(t))}toValue(t,e){if(void 0===t)return kr.from(this.toString());switch(t){case"px":return this.pxValue(e);case"em":return this.emValue(e);case"rem":return this.remValue(e);case"%":return this.pctValue(e);default:throw new Error("unknown length units: "+t)}}to(t,e){switch(t){case"px":return this.px(e);case"em":return this.em(e);case"rem":return this.rem(e);case"%":return this.pct(e);default:throw new Error("unknown length units: "+t)}}interpolateTo(e){return e instanceof t?Vs(this,e):null}static zero(t){switch(t){case void 0:case"px":return Ds.zero();case"em":return Ls.zero();case"rem":return qs.zero();case"%":return As.zero();case"":return Fs.zero();default:throw new Error("unknown length units: "+t)}}static px(t){return Ds.of(t)}static em(t){return Ls.of(t)}static rem(t){return qs.of(t)}static pct(t){return As.of(t)}static unitless(t){return Fs.of(t)}static of(t,e){switch(e){case void 0:case"px":return Ds.of(t);case"em":return Ls.of(t);case"rem":return qs.of(t);case"%":return As.of(t);case"":return Fs.of(t);default:throw new Error("unknown length units: "+e)}}static fromCssValue(e){if(e instanceof CSSUnitValue)return t.of(e.value,e.unit);throw new TypeError(""+e)}static fromLike(e,r){if(null==e||e instanceof t)return e;if("number"==typeof e)return t.of(e,r);if("string"==typeof e)return t.parse(e,r);throw new TypeError(""+e)}static fromValue(t){if(2!==t.length)return null;const e=t.getItem(0).numberValue(void 0),r=t.getItem(1);if(!(void 0!==e&&isFinite(e)&&r instanceof cr&&r.value===mr.extant()))return null;switch(r.key.value){case"px":return Ds.of(e);case"em":return Ls.of(e);case"rem":return qs.of(e);case"pct":return As.of(e);default:return null}}static parse(t,e){let r=xt.stringInput(t);for(;r.isCont()&&xt.isWhitespace(r.head());)r=r.step();let i=js.parse(r,e);if(i.isDone())for(;r.isCont()&&xt.isWhitespace(r.head());)r=r.step();return r.isCont()&&!i.isError()&&(i=Nt.error(kt.unexpected(r))),i.bind()}static form(){return new zs(void 0,t.zero())}static emUnit(t){if(void 0===t||"number"==typeof t)throw new Error("unknown em unit: "+t);const e=t.emUnit;if("number"==typeof e)return e;if(!(e instanceof Node))throw new Error("unknown em unit: "+e);let r=e;for(;null!==r;){if(r instanceof Element){const t=getComputedStyle(r).fontSize;if("string"==typeof t)return parseFloat(t)}r=r.parentNode}throw new Error("unknown em unit: "+e)}static remUnit(t){if(void 0!==t&&"number"!=typeof t){const e=t.remUnit;if("number"==typeof e)return e}const e=getComputedStyle(document.documentElement).fontSize;if("string"==typeof e)return parseFloat(e);throw new Error("unknown rem unit")}static pctUnit(t){if("number"==typeof t)return t;if(void 0!==t){const e=t.pctUnit;if("number"==typeof e)return e}throw new Error("unknown percentage unit")}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})(),Ds=(()=>{var t;let i,n=Is,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"px"}pxValue(t){return this.value}px(t){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"px"):null}valueOf(){return this.value}compareTo(t){if(t instanceof Is){const e=this.value,r=t.pxValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Is&&f.equivalent(this.value,t.pxValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Length").write(46).write("px").write(40).debug(this.value).write(41)}toString(){return this.value+"px"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})(),Ls=(()=>{var t;let i,n=Is,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"em"}pxValue(t){return 0!==this.value?this.value*Is.emUnit(t):0}emValue(t){return this.value}em(t){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"em"):null}compareTo(t){if(t instanceof Is){const e=this.value,r=t.emValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Is&&f.equivalent(this.value,t.emValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Length").write(46).write("em").write(40).debug(this.value).write(41)}toString(){return this.value+"em"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})(),qs=(()=>{var t;let i,n=Is,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"rem"}pxValue(t){return 0!==this.value?this.value*Is.remUnit(t):0}remValue(t){return this.value}rem(t){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"rem"):null}compareTo(e){if(e instanceof t){const t=this.value,r=e.remValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN}equivalentTo(e,r){return e instanceof t&&f.equivalent(this.value,e.remValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Length").write(46).write("rem").write(40).debug(this.value).write(41)}toString(){return this.value+"rem"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})(),As=(()=>{var t;let i,n=Is,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"%"}pxValue(t){return 0!==this.value?this.value*Is.pctUnit(t)/100:0}pctValue(t){return this.value}pct(t){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"percent"):null}compareTo(t){if(t instanceof Is){const e=this.value,r=t.pctValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Is&&f.equivalent(this.value,t.pctValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Length").write(46).write("pct").write(40).debug(this.value).write(41)}toString(){return this.value+"%"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})(),Fs=(()=>{var t;let i,n=Is,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return""}pxValue(t){throw new Error("unitless length")}toCssValue(){return null}compareTo(t){if(t instanceof Is){const e=this.value,r=t.value;return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Is&&f.equivalent(this.value,t.value)}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Length").write(46).write("unitless").write(40).debug(this.value).write(41)}toString(){return this.value+""}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})();const Vs=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1];return Is.of(e.value+t*(r.value-e.value),r.units)};return Object.setPrototypeOf(i,e.prototype),i[0]=t.to(r.units),i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class zs extends Oi{constructor(t,e){super(),this.defaultUnits=t,Object.defineProperty(this,"unit",{value:e,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new zs(this.defaultUnits,t)}mold(t){return t=Is.fromLike(t,this.defaultUnits),kr.from(t.toString())}cast(t){const e=t.toValue();let r=null;try{if(r=Is.fromValue(e),void 0!==r){const t=e.stringValue(void 0);void 0!==t&&(r=Is.parse(t,this.defaultUnits))}}catch(t){}return null!==r?r:void 0}}class js extends Nt{constructor(t,e,r,i){super(),this.defaultUnits=t,this.valueParser=e,this.unitsOutput=r,this.step=i}feed(t){return js.parse(t,this.defaultUnits,this.valueParser,this.unitsOutput,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n)if((r=void 0===r?Ct.parseDecimal(t):r.feed(t)).isDone())n=2;else if(r.isError())return r.asError();if(2===n){for(i=i||xt.stringOutput();t.isCont()&&(s=t.head(),xt.isAlpha(s)||37===s);)t=t.step(),i.push(s);if(!t.isEmpty()){const n=r.bind(),s=i.bind()||e;switch(s){case"px":return Nt.done(Is.px(n));case"em":return Nt.done(Is.em(n));case"rem":return Nt.done(Is.rem(n));case"%":return Nt.done(Is.pct(n));case"":case void 0:return Nt.done(Is.unitless(n));default:return Nt.error(kt.message("unknown length units: "+s,t))}}}return new js(e,r,i,n)}}const Ns={[Symbol.hasInstance]:t=>t instanceof Us||"number"==typeof t||"string"==typeof t};let Us=(()=>{var t;let i,n=[];return t=class{isDefined(){return isFinite(this.value)}plus(e,r=this.units){return e=t.fromLike(e),t.of(this.toValue(r)+e.toValue(r),r)}negative(e=this.units){return t.of(-this.toValue(e),e)}minus(e,r=this.units){return e=t.fromLike(e),t.of(this.toValue(r)-e.toValue(r),r)}times(e,r=this.units){return t.of(this.toValue(r)*e,r)}divide(e,r=this.units){return t.of(this.toValue(r)/e,r)}combine(e,r=1,i=this.units){return e=t.fromLike(e),t.of(this.toValue(i)+e.toValue(i)*r,i)}norm(e,r=this.units){return e=t.fromLike(e),t.of(this.toValue(r)/e.toValue(r),r)}deg(){return Rs.of(this.degValue())}rad(){return Bs.of(this.radValue())}grad(){return Ys.of(this.gradValue())}turn(){return Hs.of(this.turnValue())}toValue(t){if(void 0===t)return kr.from(this.toString());switch(t){case"deg":return this.degValue();case"rad":return this.radValue();case"grad":return this.gradValue();case"turn":return this.turnValue();default:throw new Error("unknown angle units: "+t)}}to(t){switch(t){case"deg":return this.deg();case"rad":return this.rad();case"grad":return this.grad();case"turn":return this.turn();default:throw new Error("unknown angle units: "+t)}}interpolateTo(e){return e instanceof t?Ws(this,e):null}static zero(t){switch(t){case"deg":return Rs.zero();case void 0:case"rad":return Bs.zero();case"grad":return Ys.zero();case"turn":return Hs.zero();default:throw new Error("unknown angle units: "+t)}}static deg(t){return Rs.of(t)}static rad(t){return Bs.of(t)}static grad(t){return Ys.of(t)}static turn(t){return Hs.of(t)}static of(t,e){switch(e){case"deg":return Rs.of(t);case void 0:case"rad":return Bs.of(t);case"grad":return Ys.of(t);case"turn":return Hs.of(t);default:throw new Error("unknown angle units: "+e)}}static fromCssValue(e){if(e instanceof CSSUnitValue)return t.of(e.value,e.unit);throw new TypeError(""+e)}static fromLike(e,r){if(null==e||e instanceof t)return e;if("number"==typeof e)return t.of(e,r);if("string"==typeof e)return t.parse(e,r);throw new TypeError(""+e)}static fromValue(t){if(2!==t.length)return null;const e=t.getItem(0).numberValue(),r=t.getItem(1);if(!(void 0!==e&&isFinite(e)&&r instanceof cr&&r.toValue()===mr.extant()))return null;switch(r.key.value){case"deg":return Rs.of(e);case"rad":return Bs.of(e);case"grad":return Ys.of(e);case"turn":return Hs.of(e);default:return null}}static parse(t,e){let r=xt.stringInput(t);for(;r.isCont()&&xt.isWhitespace(r.head());)r=r.step();let i=Ks.parse(r,e);if(i.isDone())for(;r.isCont()&&xt.isWhitespace(r.head());)r=r.step();return r.isCont()&&!i.isError()&&(i=Nt.error(kt.unexpected(r))),i.bind()}static form(){return new Xs(void 0,t.zero())}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})(),Rs=(()=>{var t;let i,n=Us,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"deg"}degValue(){return this.value}gradValue(){return 10*this.value/9}radValue(){return this.value*Math.PI/180}turnValue(){return this.value/360}deg(){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"deg"):null}compareTo(t){if(t instanceof Us){const e=this.value,r=t.degValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Us&&f.equivalent(this.value,t.degValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Angle").write(46).write("deg").write(40).debug(this.value).write(41)}toString(){return this.value+"deg"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})(),Bs=(()=>{var t;let i,n=Us,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"rad"}degValue(){return 180*this.value/Math.PI}gradValue(){return 200*this.value/Math.PI}radValue(){return this.value}turnValue(){return this.value/(2*Math.PI)}rad(){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"rad"):null}compareTo(t){if(t instanceof Us){const e=this.value,r=t.radValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Us&&f.equivalent(this.value,t.radValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Angle").write(46).write("rad").write(40).debug(this.value).write(41)}toString(){return this.value+"rad"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})(),Ys=(()=>{var t;let i,n=Us,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"grad"}degValue(){return.9*this.value}gradValue(){return this.value}radValue(){return this.value*Math.PI/200}turnValue(){return this.value/400}grad(){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"grad"):null}compareTo(t){if(t instanceof Us){const e=this.value,r=t.gradValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Us&&f.equivalent(this.value,t.gradValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Angle").write(46).write("grad").write(40).debug(this.value).write(41)}toString(){return this.value+"grad"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})(),Hs=(()=>{var t;let i,n=Us,a=[];return t=class extends n{constructor(t){super(),this.value=t}get units(){return"turn"}degValue(){return 360*this.value}gradValue(){return 400*this.value}radValue(){return this.value*(2*Math.PI)}turnValue(){return this.value}turn(){return this}toCssValue(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"turn"):null}compareTo(t){if(t instanceof Us){const e=this.value,r=t.turnValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN}equivalentTo(t,e){return t instanceof Us&&f.equivalent(this.value,t.turnValue())}equals(e){return e instanceof t&&this.value===e.value}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.value)))}debug(t){return t=t.write("Angle").write(46).write("turn").write(40).debug(this.value).write(41)}toString(){return this.value+"turn"}static zero(){return new t(0)}static of(e){return 0===e?this.zero():new t(e)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})();const Ws=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1];return Us.of(e.value+t*(r.value-e.value),r.units)};return Object.setPrototypeOf(i,e.prototype),i[0]=t.to(r.units),i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class Xs extends Oi{constructor(t,e){super(),this.defaultUnits=t,Object.defineProperty(this,"unit",{value:e,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Xs(this.defaultUnits,t)}mold(t){return t=Us.fromLike(t,this.defaultUnits),kr.from(t.toString())}cast(t){const e=t.toValue();let r=null;try{if(r=Us.fromValue(e),void 0===r){const t=e.stringValue(void 0);void 0!==t&&(r=Us.parse(t,this.defaultUnits))}}catch(t){}return null!==r?r:void 0}}class Ks extends Nt{constructor(t,e,r,i){super(),this.defaultUnits=t,this.valueParser=e,this.unitsOutput=r,this.step=i}feed(t){return Ks.parse(t,this.defaultUnits,this.valueParser,this.unitsOutput,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n)if((r=void 0===r?Ct.parseDecimal(t):r.feed(t)).isDone())n=2;else if(r.isError())return r.asError();if(2===n){for(i=i||xt.stringOutput();t.isCont()&&(s=t.head(),xt.isAlpha(s));)t=t.step(),i.push(s);if(!t.isEmpty()){const n=r.bind(),s=i.bind()||e;switch(s){case"deg":return Nt.done(Us.deg(n));case"":case"rad":return Nt.done(Us.rad(n));case"grad":return Nt.done(Us.grad(n));case"turn":return Nt.done(Us.turn(n));default:return Nt.error(kt.message("unknown units: "+s,t))}}}return new Ks(e,r,i,n)}}const Gs={[Symbol.hasInstance]:t=>t instanceof Qs||Zs[Symbol.hasInstance](t)},Zs={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"x","y")};let Qs=(()=>{var t;let i,n=[];return t=class{constructor(t,e){this.x=t,this.y=e}isDefined(){return isFinite(this.x)&&isFinite(this.y)}plus(e){return new t(this.x+e.x,this.y+e.y)}negative(){return new t(-this.x,-this.y)}minus(e){return new t(this.x-e.x,this.y-e.y)}times(e){return new t(this.x*e,this.y*e)}toLike(){return{x:this.x,y:this.y}}interpolateTo(e){return e instanceof t?Js(this,e):null}equivalentTo(e,r){return this===e||e instanceof t&&(f.equivalent(this.x,e.x,r)&&f.equivalent(this.y,e.y,r))}equals(e){return this===e||e instanceof t&&(this.x===e.x&&this.y===e.y)}hashCode(){return s.mash(s.mix(s.mix(g.hash(t),f.hash(this.x)),f.hash(this.y)))}debug(t){return t=t.write("R2Vector").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(41)}toString(){return St.debug(this)}static zero(){return new t(0,0)}static of(e,r){return new t(e,r)}static fromLike(e){if(null==e||e instanceof t)return e;if(Zs[Symbol.hasInstance](e))return t.fromInit(e);throw new TypeError(""+e)}static fromInit(e){return new t(e.x,e.y)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"zero",static:!0,private:!1,access:{has:t=>"zero"in t,get:t=>t.zero},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();const Js=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.x+t*(r.x-e.x),s=e.y+t*(r.y-e.y);return new Qs(n,s)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),$s={[Symbol.hasInstance]:t=>t instanceof _s||eo[Symbol.hasInstance](t)||ro[Symbol.hasInstance](t)||ho[Symbol.hasInstance](t)||Lo[Symbol.hasInstance](t)||Po[Symbol.hasInstance](t)||"string"==typeof t};class _s{union(t){return t=_s.fromLike(t),new qo(Math.min(this.xMin,t.xMin),Math.min(this.yMin,t.yMin),Math.max(this.xMax,t.xMax),Math.max(this.yMax,t.yMax))}get bounds(){return new qo(this.xMin,this.yMin,this.xMax,this.yMax)}static fromLike(t){if(null==t||t instanceof _s)return t;if(eo[Symbol.hasInstance](t))return io.fromInit(t);if(ro[Symbol.hasInstance](t))return io.fromTuple(t);if(ho[Symbol.hasInstance](t))return lo.fromInit(t);if(Lo[Symbol.hasInstance](t))return qo.fromInit(t);if(To[Symbol.hasInstance](t))return Po.fromInit(t);if("string"==typeof t)return ko.parse(t);throw new TypeError(""+t)}}const to={[Symbol.hasInstance]:t=>t instanceof io||eo[Symbol.hasInstance](t)||ro[Symbol.hasInstance](t)},eo={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"x","y")},ro={[Symbol.hasInstance]:t=>Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]};let io=(()=>{var t;let i,n,a=_s,u=[];return t=class extends a{constructor(t,e){super(),this.x=t,this.y=e}isDefined(){return isFinite(this.x)&&isFinite(this.y)}get xMin(){return this.x}get yMin(){return this.y}get xMax(){return this.x}get yMax(){return this.y}plus(e){return new t(this.x+e.x,this.y+e.y)}minus(e){return e instanceof Qs?new t(this.x-e.x,this.y-e.y):new Qs(this.x-e.x,this.y-e.y)}contains(e,r){return"number"==typeof e?this.x===e&&this.y===r:(e=_s.fromLike(e))instanceof t?this.x===e.x&&this.y===e.y:e instanceof _s&&(this.x<=e.xMin&&e.xMax<=this.x&&this.y<=e.yMin&&e.yMax<=this.y)}intersects(t){return(t=_s.fromLike(t)).intersects(this)}transform(e){return new t(e.transformX(this.x,this.y),e.transformY(this.x,this.y))}toLike(){return{x:this.x,y:this.y}}interpolateTo(e){return e instanceof t?no(this,e):null}equivalentTo(e,r){return this===e||e instanceof t&&(f.equivalent(this.x,e.x,r)&&f.equivalent(this.y,e.y,r))}equals(e){return this===e||e instanceof t&&(this.x===e.x&&this.y===e.y)}hashCode(){return s.mash(s.mix(s.mix(g.hash(t),f.hash(this.x)),f.hash(this.y)))}debug(t){return t=t.write("R2Point").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(41)}toString(){return St.debug(this)}static undefined(){return new t(NaN,NaN)}static origin(){return new t(0,0)}static of(e,r){return new t(e,r)}static fromLike(e){if(null==e||e instanceof t)return e;if(eo[Symbol.hasInstance](e))return t.fromInit(e);if(ro[Symbol.hasInstance](e))return t.fromTuple(e);throw new TypeError(""+e)}static fromInit(e){return new t(e.x,e.y)}static fromTuple(e){return new t(e[0],e[1])}},(()=>{var s;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=a[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:h},null,u),e(t,null,n,{kind:"method",name:"origin",static:!0,private:!1,access:{has:t=>"origin"in t,get:t=>t.origin},metadata:h},null,u),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,u)})(),t})();const no=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.x+t*(r.x-e.x),s=e.y+t*(r.y-e.y);return new io(n,s)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class so extends _s{draw(t){this.drawMove(t),this.drawRest(t)}transformDraw(t,e){this.transformDrawMove(t,e),this.transformDrawRest(t,e)}writePath(t){return t=this.writeMove(t),t=this.writeRest(t)}toPathString(t){let e=xt.stringOutput(t);return e=this.writePath(e),e.toString()}static linear(t,e,r,i){return new lo(t,e,r,i)}static quadratic(t,e,r,i,n,s){return new po(t,e,r,i,n,s)}static cubic(t,e,r,i,n,s,o,a){return new yo(t,e,r,i,n,s,o,a)}static elliptic(t,e,r,i,n,s,o){return new wo(t,e,r,i,n,s,o)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=ao.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}}class oo extends so{}class ao extends Nt{constructor(t,e,r,i){super(),this.x0Parser=t,this.y0Parser=e,this.command=r,this.step=i}feed(t){return ao.parse(t,this.x0Parser,this.y0Parser,this.command,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n){for(;t.isCont()&&(s=t.head(),xt.isSpace(s));)t=t.step();if(t.isCont()){if(77!==s&&109!==s)return Nt.error(kt.expected("moveto",t));t=t.step(),i=s,n=2}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(2===n){if(void 0===e){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(e=Ct.parseDecimal(t))}else e=e.feed(t);if(void 0!==e)if(e.isDone())n=3;else if(e.isError())return e.asError()}if(3===n){for(;t.isCont()&&(s=t.head(),xt.isSpace(s));)t=t.step();t.isCont()?(44===s&&(t=t.step()),n=4):t.isEmpty()||(n=4)}if(4===n){if(void 0===r){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(r=Ct.parseDecimal(t))}else r=r.feed(t);if(void 0!==r)if(r.isDone())n=5;else if(r.isError())return r.asError()}if(5===n){for(;t.isCont()&&(s=t.head(),xt.isSpace(s));)t=t.step();if(t.isCont())switch(s){case 76:case 108:case 72:case 104:case 86:case 118:return fo.parse(t,e,r);case 81:case 113:return mo.parse(t,e,r);case 84:return mo.parse(t,e,r,e,r);case 116:return mo.parse(t,e,r,Nt.done(0),Nt.done(0));case 67:case 99:return go.parse(t,e,r);case 83:return go.parse(t,e,r,e,r);case 115:return go.parse(t,e,r,Nt.done(0),Nt.done(0));case 65:case 97:return bo.parse(t,e,r);case 44:t=t.step();case 43:case 45:case 46:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:switch(i){case 77:case 109:return fo.parseRest(t,i,e,r)}default:return Nt.error(kt.expected("draw command",t))}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}return new ao(e,r,i,n)}}const uo={[Symbol.hasInstance]:t=>t instanceof lo||ho[Symbol.hasInstance](t)},ho={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"x0","y0","x1","y1")};class lo extends oo{constructor(t,e,r,i){super(),this.x0=t,this.y0=e,this.x1=r,this.y1=i}isDefined(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)}get xMin(){return Math.min(this.x0,this.x1)}get yMin(){return Math.min(this.y0,this.y1)}get xMax(){return Math.max(this.x0,this.x1)}get yMax(){return Math.max(this.y0,this.y1)}interpolateX(t){return(1-t)*this.x0+t*this.x1}interpolateY(t){return(1-t)*this.y0+t*this.y1}interpolate(t){const e=1-t,r=e*this.x0+t*this.x1,i=e*this.y0+t*this.y1;return new io(r,i)}contains(t,e){return"number"==typeof t?lo.contains(this.x0,this.y0,this.x1,this.y1,t,e):(t=_s.fromLike(t))instanceof io?this.containsPoint(t):t instanceof lo&&this.containsSegment(t)}containsPoint(t){return lo.contains(this.x0,this.y0,this.x1,this.y1,t.x,t.y)}containsSegment(t){return lo.contains(this.x0,this.y0,this.x1,this.y1,t.x0,t.y0)&&lo.contains(this.x0,this.y0,this.x1,this.y1,t.x1,t.y1)}static contains(t,e,r,i,n,s){return(t<=n&&n<=r||r<=n&&n<=t)&&(e<=s&&s<=i||i<=s&&s<=e)&&(r-t)*(s-e)==(n-t)*(i-e)}intersects(t){return(t=_s.fromLike(t))instanceof io?this.intersectsPoint(t):t instanceof lo?this.intersectsSegment(t):t.intersects(this)}intersectsPoint(t){return lo.contains(this.x0,this.y0,this.x1,this.y1,t.x,t.y)}intersectsSegment(t){return lo.intersects(this.x0,this.y0,this.x1-this.x0,this.y1-this.y0,t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}static intersects(t,e,r,i,n,s,o,a){const u=n-t,h=s-e,l=u*i-h*r,c=r*a-i*o;if(0===l&&0===c){const t=r*r+i*i,e=o*r+a*i,n=(u*r+h*i)/t,s=n+e/t;return e>=0?0<s&&n<1:0<n&&s<1}if(0===c)return!1;const d=(u*a-h*o)/c,f=l/c;return 0<=d&&d<=1&&0<=f&&f<=1}split(t){const e=1-t,r=e*this.x0+t*this.x1,i=e*this.y0+t*this.y1;return[new lo(this.x0,this.y0,r,i),new lo(r,i,this.x1,this.y1)]}transform(t){return new lo(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0),t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1))}toLike(){return{x0:this.x0,y0:this.y0,x1:this.x1,y1:this.y1}}drawMove(t){t.moveTo(this.x0,this.y0)}drawRest(t){t.lineTo(this.x1,this.y1)}transformDrawMove(t,e){t.moveTo(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0))}transformDrawRest(t,e){t.lineTo(e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1))}writeMove(t){return t=t.write(77),t=(t=St.displayNumber(t,this.x0)).write(44),t=St.displayNumber(t,this.y0)}writeRest(t){return t=t.write(76),t=(t=St.displayNumber(t,this.x1)).write(44),t=St.displayNumber(t,this.y1)}interpolateTo(t){return t instanceof lo?co(this,t):null}equivalentTo(t,e){return this===t||t instanceof lo&&(f.equivalent(this.x0,t.x0,e)&&f.equivalent(this.y0,t.y0,e)&&f.equivalent(this.x1,t.x1,e)&&f.equivalent(this.y1,t.y1,e))}equals(t){return this===t||t instanceof lo&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1)}hashCode(){return s.mash(s.mix(s.mix(s.mix(s.mix(g.hash(lo),f.hash(this.x0)),f.hash(this.y0)),f.hash(this.x1)),f.hash(this.y1)))}debug(t){return t=t.write("R2Segment").write(46).write("of").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(41)}toString(){return St.debug(this)}static of(t,e,r,i){return new lo(t,e,r,i)}static fromLike(t){if(null==t||t instanceof lo)return t;if(ho[Symbol.hasInstance](t))return lo.fromInit(t);throw new TypeError(""+t)}static fromInit(t){return new lo(t.x0,t.y0,t.x1,t.y1)}}const co=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.x0+t*(r.x0-e.x0),s=e.y0+t*(r.y0-e.y0),o=e.x1+t*(r.x1-e.x1),a=e.y1+t*(r.y1-e.y1);return new lo(n,s,o,a)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class fo extends Nt{constructor(t,e,r,i,n,s){super(),this.x0Parser=t,this.y0Parser=e,this.x1Parser=r,this.y1Parser=i,this.command=n,this.step=s}feed(t){return fo.parse(t,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.command,this.step)}static parse(t,e,r,i,n,s,o=1){let a=0;if(1===o){for(;t.isCont()&&(a=t.head(),xt.isSpace(a));)t=t.step();if(t.isCont())switch(a){case 77:case 109:case 76:case 108:t=t.step(),s=a,o=2;break;case 72:t=t.step(),n=r,s=a,o=2;break;case 104:t=t.step(),n=Nt.done(0),s=a,o=2;break;case 86:t=t.step(),i=e,s=a,o=4;break;case 118:t=t.step(),i=Nt.done(0),s=a,o=4;break;default:return Nt.error(kt.expected("lineto",t))}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(2===o){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=Ct.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())o=void 0!==n&&n.isDone()?4:3;else if(i.isError())return i.asError()}if(3===o){for(;t.isCont()&&(a=t.head(),xt.isSpace(a));)t=t.step();t.isCont()?(44===a&&(t=t.step()),o=4):t.isEmpty()||(o=4)}if(4===o){if(void 0===n){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(n=Ct.parseDecimal(t))}else n=n.feed(t);if(void 0!==n){if(n.isDone()){const t=e.bind(),o=r.bind();let a=i.bind(),u=n.bind();return 109!==s&&108!==s&&104!==s&&118!==s||(a+=t,u+=o),Nt.done(new lo(t,o,a,u))}if(n.isError())return n.asError()}}return new fo(e,r,i,n,s,o)}static parseRest(t,e,r,i){let n,s,o;switch(e){case 72:s=i,o=2;break;case 104:s=Nt.done(0),o=2;break;case 86:n=r,o=4;break;case 118:n=Nt.done(0),o=4;break;default:o=2}return this.parse(t,r,i,n,s,e,o)}}class po extends oo{constructor(t,e,r,i,n,s){super(),this.x0=t,this.y0=e,this.x1=r,this.y1=i,this.x2=n,this.y2=s}isDefined(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)&&isFinite(this.x2)&&isFinite(this.y2)}get xMin(){return Math.min(this.x0,this.x1,this.x2)}get yMin(){return Math.min(this.y0,this.y1,this.y2)}get xMax(){return Math.max(this.x0,this.x1,this.x2)}get yMax(){return Math.max(this.y0,this.y1,this.y2)}interpolateX(t){const e=1-t;return e*(e*this.x0+t*this.x1)+t*(e*this.x1+t*this.x2)}interpolateY(t){const e=1-t;return e*(e*this.y0+t*this.y1)+t*(e*this.y1+t*this.y2)}interpolate(t){const e=1-t,r=e*this.x0+t*this.x1,i=e*this.y0+t*this.y1,n=e*this.x1+t*this.x2,s=e*this.y1+t*this.y2;return new io(e*r+t*n,e*i+t*s)}contains(t,e){return!1}intersects(t){return!1}split(t){const e=1-t,r=e*this.x0+t*this.x1,i=e*this.y0+t*this.y1,n=e*this.x1+t*this.x2,s=e*this.y1+t*this.y2,o=e*r+t*n,a=e*i+t*s;return[new po(this.x0,this.y0,r,i,o,a),new po(o,a,n,s,this.x2,this.y2)]}transform(t){return new po(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0),t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1),t.transformX(this.x2,this.y2),t.transformY(this.x2,this.y2))}drawMove(t){t.moveTo(this.x0,this.y0)}drawRest(t){t.quadraticCurveTo(this.x1,this.y1,this.x2,this.y2)}transformDrawMove(t,e){t.moveTo(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0))}transformDrawRest(t,e){t.quadraticCurveTo(e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1),e.transformX(this.x2,this.y2),e.transformY(this.x2,this.y2))}writeMove(t){return t=t.write(77),t=(t=St.displayNumber(t,this.x0)).write(44),t=St.displayNumber(t,this.y0)}writeRest(t){return t=t.write(81),t=(t=St.displayNumber(t,this.x1)).write(44),t=(t=St.displayNumber(t,this.y1)).write(44),t=(t=St.displayNumber(t,this.x2)).write(44),t=St.displayNumber(t,this.y2)}equivalentTo(t,e){return this===t||t instanceof po&&(f.equivalent(this.x0,t.x0,e)&&f.equivalent(this.y0,t.y0,e)&&f.equivalent(this.x1,t.x1,e)&&f.equivalent(this.y1,t.y1,e)&&f.equivalent(this.x2,t.x2,e)&&f.equivalent(this.y2,t.y2,e))}equals(t){return this===t||t instanceof po&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2)}debug(t){return t=t.write("R2Curve").write(46).write("quadratic").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.x2).write(", ").debug(this.y2).write(41)}toString(){return St.debug(this)}}class mo extends Nt{constructor(t,e,r,i,n,s,o,a){super(),this.x0Parser=t,this.y0Parser=e,this.x1Parser=r,this.y1Parser=i,this.x2Parser=n,this.y2Parser=s,this.command=o,this.step=a}feed(t){return mo.parse(t,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.x2Parser,this.y2Parser,this.command,this.step)}static parse(t,e,r,i,n,s,o,a,u=1){let h=0;if(1===u){for(;t.isCont()&&(h=t.head(),xt.isSpace(h));)t=t.step();if(t.isCont())switch(h){case 81:case 113:t=t.step(),a=h,u=2;break;case 84:case 116:t=t.step(),a=h,u=6;break;default:return Nt.error(kt.expected("curveto",t))}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(2===u){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=Ct.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())u=3;else if(i.isError())return i.asError()}if(3===u){for(;t.isCont()&&(h=t.head(),xt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),u=4):t.isEmpty()||(u=4)}if(4===u){if(void 0===n){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(n=Ct.parseDecimal(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())u=5;else if(n.isError())return n.asError()}if(5===u){for(;t.isCont()&&(h=t.head(),xt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),u=6):t.isEmpty()||(u=6)}if(6===u){if(void 0===s){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(s=Ct.parseDecimal(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())u=7;else if(s.isError())return s.asError()}if(7===u){for(;t.isCont()&&(h=t.head(),xt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),u=8):t.isEmpty()||(u=8)}if(8===u){if(void 0===o){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(o=Ct.parseDecimal(t))}else o=o.feed(t);if(void 0!==o){if(o.isDone()){const t=e.bind(),u=r.bind();let h=i.bind(),l=n.bind(),c=s.bind(),d=o.bind();return 113!==a&&116!==a||(h+=t,l+=u,c+=t,d+=u),Nt.done(new po(t,u,h,l,c,d))}if(o.isError())return o.asError()}}return new mo(e,r,i,n,s,o,a,u)}static parseRest(t,e,r,i,n,s){const o=84===e||116===e?6:2;return mo.parse(t,r,i,n,s,void 0,void 0,e,o)}}class yo extends oo{constructor(t,e,r,i,n,s,o,a){super(),this.x0=t,this.y0=e,this.x1=r,this.y1=i,this.x2=n,this.y2=s,this.x3=o,this.y3=a}isDefined(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)&&isFinite(this.x2)&&isFinite(this.y2)&&isFinite(this.x3)&&isFinite(this.y3)}get xMin(){return Math.min(this.x0,this.x1,this.x2,this.x3)}get yMin(){return Math.min(this.y0,this.y1,this.y2,this.y3)}get xMax(){return Math.max(this.x0,this.x1,this.x2,this.x3)}get yMax(){return Math.max(this.y0,this.y1,this.y2,this.y3)}interpolateX(t){const e=1-t,r=e*this.x0+t*this.x1,i=e*this.x1+t*this.x2;return e*(e*r+t*i)+t*(e*i+t*(e*this.x2+t*this.x3))}interpolateY(t){const e=1-t,r=e*this.y0+t*this.y1,i=e*this.y1+t*this.y2;return e*(e*r+t*i)+t*(e*i+t*(e*this.y2+t*this.y3))}interpolate(t){const e=1-t,r=e*this.x0+t*this.x1,i=e*this.y0+t*this.y1,n=e*this.x1+t*this.x2,s=e*this.y1+t*this.y2,o=e*this.x2+t*this.x3,a=e*this.y2+t*this.y3;return new io(e*(e*r+t*n)+t*(e*n+t*o),e*(e*i+t*s)+t*(e*s+t*a))}contains(t,e){return!1}intersects(t){return!1}split(t){const e=1-t,r=e*this.x0+t*this.x1,i=e*this.y0+t*this.y1,n=e*this.x1+t*this.x2,s=e*this.y1+t*this.y2,o=e*this.x2+t*this.x3,a=e*this.y2+t*this.y3,u=e*r+t*n,h=e*i+t*s,l=e*n+t*o,c=e*s+t*a,d=e*u+t*l,f=e*h+t*c;return[new yo(this.x0,this.y0,r,i,u,h,d,f),new yo(d,f,l,c,o,a,this.x3,this.y3)]}transform(t){return new yo(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0),t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1),t.transformX(this.x2,this.y2),t.transformY(this.x2,this.y2),t.transformX(this.x3,this.y3),t.transformY(this.x3,this.y3))}drawMove(t){t.moveTo(this.x0,this.y0)}drawRest(t){t.bezierCurveTo(this.x1,this.y1,this.x2,this.y2,this.x3,this.y3)}transformDrawMove(t,e){t.moveTo(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0))}transformDrawRest(t,e){t.bezierCurveTo(e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1),e.transformX(this.x2,this.y2),e.transformY(this.x2,this.y2),e.transformX(this.x3,this.y3),e.transformY(this.x3,this.y3))}writeMove(t){return t=t.write(77),t=(t=St.displayNumber(t,this.x0)).write(44),t=St.displayNumber(t,this.y0)}writeRest(t){return t=t.write(67),t=(t=St.displayNumber(t,this.x1)).write(44),t=(t=St.displayNumber(t,this.y1)).write(44),t=(t=St.displayNumber(t,this.x2)).write(44),t=(t=St.displayNumber(t,this.y2)).write(44),t=(t=St.displayNumber(t,this.x3)).write(44),t=St.displayNumber(t,this.y3)}equivalentTo(t,e){return this===t||t instanceof yo&&(f.equivalent(this.x0,t.x0,e)&&f.equivalent(this.y0,t.y0,e)&&f.equivalent(this.x1,t.x1,e)&&f.equivalent(this.y1,t.y1,e)&&f.equivalent(this.x2,t.x2,e)&&f.equivalent(this.y2,t.y2,e)&&f.equivalent(this.x3,t.x3,e)&&f.equivalent(this.y3,t.y3,e))}equals(t){return this===t||t instanceof yo&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2&&this.x3===t.x3&&this.y3===t.y3)}debug(t){return t=t.write("R2Curve").write(46).write("cubic").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.x2).write(", ").debug(this.y2).write(", ").debug(this.x3).write(", ").debug(this.y3).write(41)}toString(){return St.debug(this)}}class go extends Nt{constructor(t,e,r,i,n,s,o,a,u,h){super(),this.x0Parser=t,this.y0Parser=e,this.x1Parser=r,this.y1Parser=i,this.x2Parser=n,this.y2Parser=s,this.x3Parser=o,this.y3Parser=a,this.command=u,this.step=h}feed(t){return go.parse(t,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.x2Parser,this.y2Parser,this.x3Parser,this.y3Parser,this.command,this.step)}static parse(t,e,r,i,n,s,o,a,u,h,l=1){let c=0;if(1===l){for(;t.isCont()&&(c=t.head(),xt.isSpace(c));)t=t.step();if(t.isCont())switch(c){case 67:case 99:t=t.step(),h=c,l=2;break;case 83:case 115:t=t.step(),h=c,l=6;break;default:return Nt.error(kt.expected("curveto",t))}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(2===l){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=Ct.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())l=3;else if(i.isError())return i.asError()}if(3===l){for(;t.isCont()&&(c=t.head(),xt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),l=4):t.isEmpty()||(l=4)}if(4===l){if(void 0===n){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(n=Ct.parseDecimal(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())l=5;else if(n.isError())return n.asError()}if(5===l){for(;t.isCont()&&(c=t.head(),xt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),l=6):t.isEmpty()||(l=6)}if(6===l){if(void 0===s){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(s=Ct.parseDecimal(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())l=7;else if(s.isError())return s.asError()}if(7===l){for(;t.isCont()&&(c=t.head(),xt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),l=8):t.isEmpty()||(l=8)}if(8===l){if(void 0===o){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(o=Ct.parseDecimal(t))}else o=o.feed(t);if(void 0!==o)if(o.isDone())l=9;else if(o.isError())return o.asError()}if(9===l){for(;t.isCont()&&(c=t.head(),xt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),l=10):t.isEmpty()||(l=10)}if(10===l){if(void 0===a){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(a=Ct.parseDecimal(t))}else a=a.feed(t);if(void 0!==a)if(a.isDone())l=11;else if(a.isError())return a.asError()}if(11===l){for(;t.isCont()&&(c=t.head(),xt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),l=12):t.isEmpty()||(l=12)}if(12===l){if(void 0===u){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(u=Ct.parseDecimal(t))}else u=u.feed(t);if(void 0!==u){if(u.isDone()){const t=e.bind(),l=r.bind();let c=i.bind(),d=n.bind(),f=s.bind(),p=o.bind(),m=a.bind(),y=u.bind();return 99!==h&&115!==h||(c+=t,d+=l,f+=t,p+=l,m+=t,y+=l),Nt.done(new yo(t,l,c,d,f,p,m,y))}if(u.isError())return u.asError()}}return new go(e,r,i,n,s,o,a,u,h,l)}static parseRest(t,e,r,i,n,s){const o=83===e||115===e?6:2;return go.parse(t,r,i,n,s,void 0,void 0,void 0,void 0,e,o)}}class wo extends so{constructor(t,e,r,i,n,s,o){super(),this.cx=t,this.cy=e,this.rx=r,this.ry=i,this.phi=n,this.a0=s,this.da=o}isDefined(){return isFinite(this.cx)&&isFinite(this.cy)&&isFinite(this.rx)&&isFinite(this.ry)&&isFinite(this.phi)&&isFinite(this.a0)&&isFinite(this.da)}get xMin(){return this.cx-Math.max(this.rx,this.ry)}get yMin(){return this.cy-Math.max(this.rx,this.ry)}get xMax(){return this.cx+Math.max(this.rx,this.ry)}get yMax(){return this.cy+Math.max(this.rx,this.ry)}interpolateX(t){const e=this.a0+t*this.da,r=this.rx*Math.cos(e),i=this.ry*Math.sin(e),n=this.phi;return 0===n?this.cx+r:this.cx+r*Math.cos(n)-i*Math.sin(n)}interpolateY(t){const e=this.a0+t*this.da,r=this.rx*Math.cos(e),i=this.ry*Math.sin(e),n=this.phi;return 0===n?this.cy+i:this.cy+r*Math.sin(n)+i*Math.cos(n)}interpolate(t){const e=this.a0+t*this.da,r=this.rx*Math.cos(e),i=this.ry*Math.sin(e),n=this.phi;return 0===n?new io(this.cx+r,this.cy+i):new io(this.cx+r*Math.cos(n)-i*Math.sin(n),this.cy+r*Math.sin(n)+i*Math.cos(n))}contains(t,e){return!1}intersects(t){return!1}split(t){const e=this.a0,r=this.da,i=e+t*r;return[new wo(this.cx,this.cy,this.rx,this.ry,this.phi,e,i-e),new wo(this.cx,this.cy,this.rx,this.ry,this.phi,i,e+r-i)]}transform(t){const e=t.transformX(this.cx,this.cy),r=t.transformY(this.cx,this.cy),i=t.transformX(this.cx+this.rx,this.cy+this.ry)-e,n=t.transformY(this.cx+this.rx,this.cy+this.ry)-r,s=this.a0,o=this.da,a=s+o,u=Math.cos(s),h=Math.sin(s),l=Math.cos(a),c=Math.sin(a),d=t.transformX(this.cx+u,this.cy-h)-e,f=t.transformY(this.cx+u,this.cy-h)-r,p=t.transformX(this.cx+l,this.cy-c)-e,m=t.transformY(this.cx+l,this.cy-c)-r,y=Math.atan2(f,d);let g=Math.atan2(m,p);Math.abs(o)>Math.PI&&(g>0?g=-2*Math.PI+g:g<0&&(g=2*Math.PI-g));const w=g-y;return new wo(e,r,i,n,this.phi,y,w)}drawMove(t){const{x0:e,y0:r}=this.toEndpoints();t.moveTo(e,r)}drawRest(t){t.ellipse(this.cx,this.cy,this.rx,this.ry,this.phi,this.a0,this.a0+this.da,this.da<0)}transformDrawMove(t,e){const{x0:r,y0:i}=this.toEndpoints();t.moveTo(e.transformX(r,i),e.transformY(r,i))}transformDrawRest(t,e){const r=e.transformX(this.cx,this.cy),i=e.transformY(this.cx,this.cy),n=e.transformX(this.cx+this.rx,this.cy+this.ry)-r,s=e.transformY(this.cx+this.rx,this.cy+this.ry)-i,o=this.a0,a=this.da,u=o+a,h=Math.cos(o),l=Math.sin(o),c=Math.cos(u),d=Math.sin(u),f=e.transformX(this.cx+h,this.cy-l)-r,p=e.transformY(this.cx+h,this.cy-l)-i,m=e.transformX(this.cx+c,this.cy-d)-r,y=e.transformY(this.cx+c,this.cy-d)-i,g=Math.atan2(p,f);let w=Math.atan2(y,m);Math.abs(a)>Math.PI&&(w>0?w=-2*Math.PI+w:w<0&&(w=2*Math.PI-w));const b=w<g;t.ellipse(r,i,n,s,this.phi,g,w,b)}writeMove(t){const{x0:e,y0:r}=this.toEndpoints();return t=t.write(77),t=(t=St.displayNumber(t,e)).write(44),t=St.displayNumber(t,r)}writeRest(t){const{rx:e,ry:r,phi:i,large:n,sweep:s,x1:o,y1:a}=this.toEndpoints();return t=t.write(65),t=(t=St.displayNumber(t,e)).write(44),t=(t=St.displayNumber(t,r)).write(32),t=(t=(t=(t=(t=(t=St.displayNumber(t,i)).write(32)).write(n?49:48)).write(44)).write(s?49:48)).write(32),t=(t=St.displayNumber(t,o)).write(44),t=St.displayNumber(t,a)}toEndpoints(){const t=this.cx,e=this.cy,r=this.rx,i=this.ry,n=this.phi,s=this.a0,o=this.da,a=s+o,u=Math.cos(n),h=Math.sin(n),l=Math.cos(s),c=Math.sin(s),d=Math.cos(a),f=Math.sin(a),p=u*r*d-h*i*f+t,m=h*r*d+u*i*f+e;return{x0:u*r*l-h*i*c+t,y0:h*r*l+u*i*c+e,rx:r,ry:i,phi:n,large:Math.abs(o)>Math.PI,sweep:o>0,x1:p,y1:m}}equivalentTo(t,e){return this===t||t instanceof wo&&(f.equivalent(this.cx,t.cx,e)&&f.equivalent(this.cy,t.cy,e)&&f.equivalent(this.rx,t.rx,e)&&f.equivalent(this.ry,t.ry,e)&&f.equivalent(this.phi,t.phi,e)&&f.equivalent(this.a0,t.a0,e)&&f.equivalent(this.da,t.da,e))}equals(t){return this===t||t instanceof wo&&(this.cx===t.cx&&this.cy===t.cy&&this.rx===t.rx&&this.ry===t.ry&&this.phi===t.phi&&this.a0===t.a0&&this.da===t.da)}debug(t){return t=t.write("R2Curve").write(46).write("elliptic").write(40).debug(this.cx).write(", ").debug(this.cy).write(", ").debug(this.rx).write(", ").debug(this.ry).write(", ").debug(this.phi).write(", ").debug(this.a0).write(", ").debug(this.da).write(41)}toString(){return St.debug(this)}static fromEndpoints(t,e,r,i,n,s,o,a,u){const h=Math.cos(n),l=Math.sin(n),c=h*((t-a)/2)+l*((e-u)/2),d=(t-a)/2*-l+h*((e-u)/2),f=r*r,p=i*i,m=c*c,y=d*d;let g=Math.sqrt((f*p-f*y-p*m)/(f*y+p*m));s===o&&(g=-g);const w=g*r*d/i,b=-g*i*c/r,v=h*w-l*b+(t+a)/2,x=l*w+h*b+(e+u)/2;function S(t,e,r,i){const n=t*r+e*i,s=t*t+e*e,o=r*r+i*i;let a=Math.acos(n/(Math.sqrt(s)*Math.sqrt(o)));return t*i-e*r<0&&(a=-a),a}const C=S(1,0,(c-w)/r,(d-b)/i);let k=S((c-w)/r,(d-b)/i,(-c-w)/r,(-d-b)/i)%(2*Math.PI);return o&&k<0?k+=2*Math.PI:!o&&k>0&&(k-=2*Math.PI),new wo(v,x,r,i,n,C,k)}}class bo extends Nt{constructor(t,e,r,i,n,s,o,a,u,h,l){super(),this.x0Parser=t,this.y0Parser=e,this.rxParser=r,this.ryParser=i,this.phiParser=n,this.large=s,this.sweep=o,this.x1Parser=a,this.y1Parser=u,this.command=h,this.step=l}feed(t){return bo.parse(t,this.x0Parser,this.y0Parser,this.rxParser,this.ryParser,this.phiParser,this.large,this.sweep,this.x1Parser,this.y1Parser,this.command,this.step)}static parse(t,e,r,i,n,s,o,a,u,h,l,c=1){let d=0;if(1===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();if(t.isCont())switch(d){case 65:case 97:t=t.step(),l=d,c=2;break;default:return Nt.error(kt.expected("arcto",t))}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(2===c){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=Ct.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())c=3;else if(i.isError())return i.asError()}if(3===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();t.isCont()?(44===d&&(t=t.step()),c=4):t.isEmpty()||(c=4)}if(4===c){if(void 0===n){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(n=Ct.parseDecimal(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())c=5;else if(n.isError())return n.asError()}if(5===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();t.isCont()?(44===d&&(t=t.step()),c=6):t.isEmpty()||(c=6)}if(6===c){if(void 0===s){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(s=Ct.parseDecimal(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())c=7;else if(s.isError())return s.asError()}if(7===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();t.isCont()?(44===d&&(t=t.step()),c=8):t.isEmpty()||(c=8)}if(8===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();if(t.isCont())if(48===d)t=t.step(),o=!1,c=9;else{if(49!==d)return Nt.error(kt.expected("flag",t));t=t.step(),o=!0,c=9}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(9===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();t.isCont()?(44===d&&(t=t.step()),c=10):t.isEmpty()||(c=10)}if(10===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();if(t.isCont())if(48===d)t=t.step(),a=!1,c=11;else{if(49!==d)return Nt.error(kt.expected("flag",t));t=t.step(),a=!0,c=11}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(11===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();t.isCont()?(44===d&&(t=t.step()),c=12):t.isEmpty()||(c=12)}if(12===c){if(void 0===u){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(u=Ct.parseDecimal(t))}else u=u.feed(t);if(void 0!==u)if(u.isDone())c=13;else if(u.isError())return u.asError()}if(13===c){for(;t.isCont()&&(d=t.head(),xt.isSpace(d));)t=t.step();t.isCont()?(44===d&&(t=t.step()),c=14):t.isEmpty()||(c=14)}if(14===c){if(void 0===h){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(h=Ct.parseDecimal(t))}else h=h.feed(t);if(void 0!==h){if(h.isDone()){const t=e.bind(),c=r.bind(),d=i.bind(),f=n.bind(),p=s.bind()*Math.PI/180;let m=u.bind(),y=h.bind();return 97===l&&(m+=t,y+=c),Nt.done(wo.fromEndpoints(t,c,d,f,p,o,a,m,y))}if(h.isError())return h.asError()}}return new bo(e,r,i,n,s,o,a,u,h,l,c)}static parseRest(t,e,r,i){return bo.parse(t,r,i,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e,2)}}let vo=(()=>{var t;let i,n=so,s=[];return t=class extends n{constructor(t,e){super(),this.curves=t,this.closed=e,this.boundingBox=null,this.pathString=void 0}isDefined(){return 0!==this.curves.length}isClosed(){return this.closed}get xMin(){return this.bounds.xMin}get yMin(){return this.bounds.yMin}get xMax(){return this.bounds.xMax}get yMax(){return this.bounds.yMax}interpolateX(t){const e=this.curves,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r-1),s=r*(t-n*i);return e[n].interpolateX(s)}interpolateY(t){const e=this.curves,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r-1),s=r*(t-n*i);return e[n].interpolateY(s)}interpolate(t){const e=this.curves,r=e.length;if(0===r)return io.undefined();const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r-1),s=r*(t-n*i);return e[n].interpolate(s)}contains(t,e){return!1}intersects(t){return!1}split(e){const r=this.curves,i=r.length;if(0===i)return[t.empty(),t.empty()];const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i-1),o=i*(e-s*n),[a,u]=r[s].split(o),h=new Array(s+1),l=new Array(i-s);for(let t=0;t<s;t+=1)h[t]=r[t];h[s]=a,l[0]=u;for(let t=s+1;t<i;t+=1)l[t-s]=r[t];return[new t(h,!1),new t(l,!1)]}subdivide(e){const r=this.curves,i=r.length;if(0===i)return t.empty();const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i-1),o=i*(e-s*n),[a,u]=r[s].split(o),h=new Array(i+1);for(let t=0;t<s;t+=1)h[t]=r[t];h[s]=a,h[s+1]=u;for(let t=s+1;t<i;t+=1)h[t+1]=r[t];return new t(h,this.closed)}transform(e){const r=this.curves,i=r.length;if(0===i)return t.empty();const n=new Array(i);for(let t=0;t<i;t+=1)n[t]=r[t].transform(e);return new t(n,this.closed)}get bounds(){let t=this.boundingBox;if(null===t){let e=1/0,r=1/0,i=-1/0,n=-1/0;const s=this.curves;for(let t=0;t<s.length;t+=1){const o=s[t];e=Math.min(e,o.xMin),r=Math.min(r,o.yMin),i=Math.max(o.xMax,i),n=Math.max(o.yMax,n)}t=new qo(e,r,i,n),this.boundingBox=t}return t}drawMove(t){const e=this.curves;0!==e.length&&e[0].drawMove(t)}drawRest(t){const e=this.curves,r=this.closed,i=e.length-(r&&void 0!==t.closePath?1:0);for(let r=0;r<i;r+=1)e[r].drawRest(t);r&&void 0!==t.closePath&&t.closePath()}transformDrawMove(t,e){const r=this.curves;0!==r.length&&r[0].transformDrawMove(t,e)}transformDrawRest(t,e){const r=this.curves,i=this.closed,n=r.length-(i&&void 0!==t.closePath?1:0);for(let i=0;i<n;i+=1)r[i].transformDrawRest(t,e);i&&void 0!==t.closePath&&t.closePath()}writeMove(t){const e=this.curves;return 0!==e.length&&(t=e[0].writeMove(t)),t}writeRest(t){const e=this.curves,r=this.closed,i=e.length-(r?1:0);for(let r=0;r<i;r+=1)t=e[r].writeRest(t);return r&&(t=t.write(90)),t}toPathString(t){let e;if(void 0!==t||(e=this.pathString,void 0===e)){const r=xt.stringOutput(t);this.writePath(r),e=r.bind(),void 0===t&&(this.pathString=e)}return e}equivalentTo(e,r){return this===e||e instanceof t&&(w.equivalent(this.curves,e.curves,r)&&this.closed===e.closed)}equals(e){return this===e||e instanceof t&&(w.equal(this.curves,e.curves)&&this.closed===e.closed)}debug(t){const e=this.curves,r=e.length;if(t=t.write("R2Spline").write(46),0===r)t=t.write("empty").write(40);else if(0!==r){t=(t=t.write(this.closed?"closed":"open").write(40)).debug(e[0]);for(let i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}return t=t.write(41)}toString(){return St.debug(this)}static builder(){return new xo}static empty(){return new t(w.empty(),!1)}static open(...e){return new t(e,!1)}static closed(...e){return new t(e,!0)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=So.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class xo{constructor(){this.curves=[],this.closed=!1,this.aliased=!1,this.x0=0,this.y0=0,this.x=0,this.y=0}dealias(){this.aliased&&(this.curves=this.curves.slice(0),this.aliased=!1)}moveTo(t,e){this.aliased?(this.curves=[],this.aliased=!1):this.curves.length=0,this.closed=!1,this.x0=t,this.y0=e,this.x=t,this.y=e}closePath(){this.dealias(),this.curves.push(new lo(this.x,this.y,this.x0,this.y0)),this.closed=!0,this.x=this.x0,this.y=this.y0}lineTo(t,e){this.dealias(),this.curves.push(new lo(this.x,this.y,t,e)),this.x=t,this.y=e}quadraticCurveTo(t,e,r,i){this.dealias(),this.curves.push(new po(this.x,this.y,t,e,r,i)),this.x=r,this.y=i}bezierCurveTo(t,e,r,i,n,s){this.dealias(),this.curves.push(new yo(this.x,this.y,t,e,r,i,n,s)),this.x=n,this.y=s}arcTo(t,e,r,i,n){this.dealias();const s=this.x,o=this.y,a=t-s,u=e-o,h=r-t,l=i-e,c=Math.atan2(u,a)-Math.PI/2,d=Math.atan2(l,h)-Math.PI/2,f=d-c,p=Math.cos(c),m=Math.sin(c),y=Math.cos(d),g=Math.sin(d),w=s-p,b=o-m,v=t-p,x=e-m,S=t-y,C=e-g,k=r-y,M=i-g,O=xo.intersection(w,b,v-w,x-b,S,C,k-S,M-C),E=w+O*(v-w),T=b+O*(x-b);this.curves.push(new wo(E,T,n,n,0,c,f)),this.x=r,this.y=i}static intersection(t,e,r,i,n,s,o,a){const u=n-t,h=s-e,l=u*i-h*r,c=r*a-i*o;if(0===l&&0===c){const t=r*r+i*i,e=o*r+a*i,n=(u*r+h*i)/t,s=n+e/t;return(e>=0?0<s&&n<1:0<n&&s<1)?n:NaN}if(0===c)return NaN;const d=(u*a-h*o)/c,f=l/c;return d<0||d>1||f<0||f>1?NaN:d}arc(t,e,r,i,n,s=!1){this.dealias();let o=n-i;!0===s&&o>0?o-=2*Math.PI:!1===s&&o<0&&(o+=2*Math.PI);const a=new wo(t,e,r,r,0,i,o);this.curves.push(a);const{x:u,y:h}=a.interpolate(1);this.x=u,this.y=h}ellipse(t,e,r,i,n,s,o,a){this.dealias();let u=o-s;!0===a&&u>0?u-=2*Math.PI:!1===a&&u<0&&(u+=2*Math.PI);const h=new wo(t,e,r,i,n,s,u);this.curves.push(h);const{x:l,y:c}=h.interpolate(1);this.x=l,this.y=c}rect(t,e,r,i){this.dealias(),this.curves.push(new lo(t,e,t+r,e),new lo(t+r,e,t+r,e+i),new lo(t+r,e+i,t,e+i),new lo(t,e+i,t,e)),this.x=t,this.y=e}build(){return this.aliased=!0,new vo(this.curves,this.closed)}}class So extends Nt{constructor(t,e,r,i,n,s,o,a){super(),this.xParser=t,this.yParser=e,this.x0Parser=r,this.y0Parser=i,this.curveParser=n,this.curves=s,this.command=o,this.step=a}feed(t){return So.parse(t,this.xParser,this.yParser,this.x0Parser,this.y0Parser,this.curveParser,this.curves,this.command,this.step)}static parse(t,e,r,i,n,s,o,a,u=1){let h=0;if(1===u){for(;t.isCont()&&(h=t.head(),xt.isSpace(h));)t=t.step();if(t.isCont()){if(77!==h&&109!==h)return Nt.error(kt.expected("moveto",t));t=t.step(),a=h,u=2}else if(!t.isEmpty())return Nt.error(kt.unexpected(t))}if(2===u){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=Ct.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())109===a&&void 0!==e&&(i=Nt.done(e.bind()+i.bind())),e=i,u=3;else if(i.isError())return i.asError()}if(3===u){for(;t.isCont()&&(h=t.head(),xt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),u=4):t.isEmpty()||(u=4)}if(4===u){if(void 0===n){for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();t.isEmpty()||(n=Ct.parseDecimal(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())109===a&&void 0!==r&&(n=Nt.done(r.bind()+n.bind())),r=n,u=5;else if(n.isError())return n.asError()}for(;;){if(5===u){if(void 0===s){for(;t.isCont()&&(h=t.head(),xt.isSpace(h));)t=t.step();if(t.isCont()){const u=void 0!==o&&0!==o.length?o[o.length-1]:null;switch(h){case 76:case 108:case 72:case 104:case 86:case 118:s=fo.parse(t,e,r),a=h;break;case 81:case 113:s=mo.parse(t,e,r),a=h;break;case 84:if(u instanceof po){const i=u.x2-u.x1,n=u.y2-u.y1,o=e.bind()+i,a=r.bind()+n;s=mo.parse(t,e,r,Nt.done(o),Nt.done(a))}else s=mo.parse(t,e,r,e,r);a=h;break;case 116:if(u instanceof po){const i=u.x2-u.x1,n=u.y2-u.y1;s=mo.parse(t,e,r,Nt.done(i),Nt.done(n))}else s=mo.parse(t,e,r,Nt.done(0),Nt.done(0));a=h;break;case 67:case 99:s=go.parse(t,e,r),a=h;break;case 83:if(u instanceof yo){const i=u.x3-u.x2,n=u.y3-u.y2,o=e.bind()+i,a=r.bind()+n;s=go.parse(t,e,r,Nt.done(o),Nt.done(a))}else s=go.parse(t,e,r,e,r);a=h;break;case 115:if(u instanceof yo){const i=u.x3-u.x2,n=u.y3-u.y2;s=go.parse(t,e,r,Nt.done(i),Nt.done(n))}else s=go.parse(t,e,r,Nt.done(0),Nt.done(0));a=h;break;case 65:case 97:s=bo.parse(t,e,r),a=h;break;case 90:case 122:return t=t.step(),void 0===o&&(o=[]),o.push(new lo(e.bind(),r.bind(),i.bind(),n.bind())),Nt.done(new vo(o,!0));case 44:t=t.step();case 43:case 45:case 46:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:switch(a){case 77:case 109:case 76:case 108:case 72:case 104:case 86:case 118:s=fo.parseRest(t,a,e,r);break;case 81:case 113:s=mo.parseRest(t,a,e,r);break;case 84:if(u instanceof po){const i=u.x2-u.x1,n=u.y2-u.y1,o=e.bind()+i,h=r.bind()+n;s=mo.parseRest(t,a,e,r,Nt.done(o),Nt.done(h))}else s=mo.parseRest(t,a,e,r,e,r);break;case 116:if(u instanceof po){const i=u.x2-u.x1,n=u.y2-u.y1;s=mo.parseRest(t,a,e,r,Nt.done(i),Nt.done(n))}else s=mo.parseRest(t,a,e,r,Nt.done(0),Nt.done(0));break;case 67:case 99:s=go.parseRest(t,a,e,r);break;case 83:if(u instanceof yo){const i=u.x3-u.x2,n=u.y3-u.y2,o=e.bind()+i,h=r.bind()+n;s=go.parseRest(t,a,e,r,Nt.done(o),Nt.done(h))}else s=go.parseRest(t,a,e,r,e,r);break;case 115:if(u instanceof yo){const i=u.x3-u.x2,n=u.y3-u.y2;s=go.parseRest(t,a,e,r,Nt.done(i),Nt.done(n))}else s=go.parseRest(t,a,e,r,Nt.done(0),Nt.done(0));break;case 65:case 97:s=bo.parseRest(t,a,e,r);break;default:return void 0!==o?Nt.done(new vo(o,!1)):Nt.done(vo.empty())}break;default:return void 0!==o?Nt.done(new vo(o,!1)):Nt.done(vo.empty())}}else if(!t.isEmpty())return void 0!==o?Nt.done(new vo(o,!1)):Nt.done(vo.empty())}else s=s.feed(t);if(void 0!==s){if(s.isDone()){const t=s.bind();s=void 0,void 0===o&&(o=[]),o.push(t),e=Nt.done(t.interpolateX(1)),r=Nt.done(t.interpolateY(1));continue}if(s.isError())return s.asError()}}break}return new So(e,r,i,n,s,o,a,u)}}const Co={[Symbol.hasInstance]:t=>t instanceof ko||"string"==typeof t};let ko=(()=>{var t;let i,n=_s,s=[];return t=class extends n{constructor(t){super(),this.splines=t,this.boundingBox=null,this.pathString=void 0}isDefined(){return 0!==this.splines.length}get xMin(){return this.bounds.xMin}get yMin(){return this.bounds.yMin}get xMax(){return this.bounds.xMax}get yMax(){return this.bounds.yMax}interpolateX(t){const e=this.splines,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolateX(s)}interpolateY(t){const e=this.splines,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolateY(s)}interpolate(t){const e=this.splines,r=e.length;if(0===r)return io.undefined();const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolate(s)}contains(t,e){return!1}intersects(t){return!1}split(e){const r=this.splines,i=r.length;if(0===i)return[t.empty(),t.empty()];const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i),o=e*i-s*n,[a,u]=r[s].split(o),h=new Array(s+1),l=new Array(i-s);for(let t=0;t<s;t+=1)h[t]=r[t];h[s]=a,l[0]=u;for(let t=s+1;t<i;t+=1)l[t-s]=r[t];return[new t(h),new t(l)]}subdivide(e){const r=this.splines,i=r.length;if(0===i)return t.empty();const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i),o=e*i-s*n,a=new Array(i);for(let t=0;t<s;t+=1)a[t]=r[t];a[s]=r[s].subdivide(o);for(let t=s+1;t<i;t+=1)a[t]=r[t];return new t(a)}transform(e){const r=this.splines,i=r.length;if(0===i)return t.empty();const n=new Array(i);for(let t=0;t<i;t+=1)n[t]=r[t].transform(e);return new t(n)}get bounds(){let t=this.boundingBox;if(null===t){let e=1/0,r=1/0,i=-1/0,n=-1/0;const s=this.splines;for(let t=0;t<s.length;t+=1){const o=s[t];e=Math.min(e,o.xMin),r=Math.min(r,o.yMin),i=Math.max(o.xMax,i),n=Math.max(o.yMax,n)}t=new qo(e,r,i,n),this.boundingBox=t}return t}draw(t){const e=this.splines;for(let r=0;r<e.length;r+=1)e[r].draw(t)}transformDraw(t,e){const r=this.splines;for(let i=0;i<r.length;i+=1)r[i].transformDraw(t,e)}writePath(t){const e=this.splines,r=e.length;if(t.settings===ht.standard())for(let i=0;i<r;i+=1)t=t.write(e[i].toPathString());else for(let i=0;i<r;i+=1)t=e[i].writePath(t);return t}toPathString(t){let e;if(void 0!==t||(e=this.pathString,void 0===e)){const r=xt.stringOutput(t);this.writePath(r),e=r.bind(),void 0===t&&(this.pathString=e)}return e}equivalentTo(e,r){return this===e||e instanceof t&&w.equivalent(this.splines,e.splines,r)}equals(e){return this===e||e instanceof t&&w.equal(this.splines,e.splines)}debug(t){const e=this.splines,r=e.length;if(t=t.write("R2Path").write(46),0===r)t=t.write("empty").write(40);else if(1===r){const r=e[0];t=t.write(r.closed?"closed":"open").write(40);const i=r.curves,n=i.length;if(0!==n){t=t.debug(i[0]);for(let e=1;e<n;e+=1)t=t.write(", ").debug(i[e])}}else{t=(t=t.write("of").write(40)).debug(e[0]);for(let i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}return t=t.write(41)}toAttributeString(){return this.toPathString()}toString(){return St.debug(this)}static builder(){return new Mo}static empty(){return new t(w.empty())}static of(...e){return new t(e)}static open(...e){return new t([new vo(e,!1)])}static closed(...e){return new t([new vo(e,!0)])}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=Oo.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class Mo{constructor(){this.splines=[],this.builder=null}moveTo(t,e){let r=this.builder;if(null!==r){const t=r.build();t.isDefined()&&this.splines.push(t)}r=new xo,this.builder=r,r.moveTo(t,e)}closePath(){const t=this.builder;if(null===t)throw new Error;t.closePath()}lineTo(t,e){const r=this.builder;if(null===r)throw new Error;r.lineTo(t,e)}quadraticCurveTo(t,e,r,i){const n=this.builder;if(null===n)throw new Error;n.quadraticCurveTo(t,e,r,i)}bezierCurveTo(t,e,r,i,n,s){const o=this.builder;if(null===o)throw new Error;o.bezierCurveTo(t,e,r,i,n,s)}arcTo(t,e,r,i,n){const s=this.builder;if(null===s)throw new Error;s.arcTo(t,e,r,i,n)}arc(t,e,r,i,n,s){const o=this.builder;if(null===o)throw new Error;o.arc(t,e,r,i,n,s)}ellipse(t,e,r,i,n,s,o,a){const u=this.builder;if(null===u)throw new Error;u.ellipse(t,e,r,i,n,s,o,a)}rect(t,e,r,i){const n=this.builder;if(null===n)throw new Error;n.rect(t,e,r,i)}build(){const t=this.splines.slice(0),e=this.builder;if(null!==e){const r=e.build();r.isDefined()&&t.push(r)}return new ko(t)}}class Oo extends Nt{constructor(t,e,r){super(),this.splineParser=t,this.splines=e,this.step=r}feed(t){return Oo.parse(t,this.splineParser,this.splines,this.step)}static parse(t,e,r,i=1){let n=0;for(;;){if(1===i){if(void 0===e){for(;t.isCont()&&(n=t.head(),xt.isSpace(n));)t=t.step();if(t.isCont())switch(n){case 77:e=So.parse(t);break;case 109:{let i,n;if(void 0!==r&&0!==r.length){const t=r[r.length-1];i=Nt.done(t.interpolateX(1)),n=Nt.done(t.interpolateY(1))}e=So.parse(t,i,n);break}case 110:i=2;break;default:return void 0!==r?Nt.done(new ko(r)):Nt.done(ko.empty())}else if(!t.isEmpty())return void 0!==r?Nt.done(new ko(r)):Nt.done(ko.empty())}else e=e.feed(t);if(void 0!==e){if(e.isDone()){const t=e.bind();e=void 0,t.isDefined()&&(void 0===r&&(r=[]),r.push(t));continue}if(e.isError())return e.asError()}}break}if(i>=2&&i<=5)for(;;){if(t.isCont()){if(t.head()==="none".charCodeAt(i-2)){if(t=t.step(),i<5){i+=1;continue}return Nt.done(ko.empty())}return Nt.error(kt.expected("none",t))}if(!t.isEmpty())return Nt.error(kt.unexpected(t));break}return new Oo(e,r,i)}}const Eo={[Symbol.hasInstance]:t=>t instanceof Po||To[Symbol.hasInstance](t)},To={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"cx","cy","r")};class Po extends _s{constructor(t,e,r){super(),this.cx=t,this.cy=e,this.r=r}isDefined(){return isFinite(this.cx)&&isFinite(this.cy)&&isFinite(this.r)}get xMin(){return this.cx-this.r}get yMin(){return this.cy-this.r}get xMax(){return this.cx+this.r}get yMax(){return this.cy+this.r}contains(t,e){if("number"==typeof t){const r=t-this.cx,i=e-this.cy;return r*r+i*i<=this.r*this.r}return(t=_s.fromLike(t))instanceof io?this.containsPoint(t):t instanceof lo?this.containsSegment(t):t instanceof qo?this.containsBox(t):t instanceof Po&&this.containsCircle(t)}containsPoint(t){const e=t.x-this.cx,r=t.y-this.cy;return e*e+r*r<=this.r*this.r}containsSegment(t){const e=t.x0-this.cx,r=t.y0-this.cy,i=t.x1-this.cx,n=t.y1-this.cy,s=this.r*this.r;return e*e+r*r<=s&&i*i+n*n<=s}containsBox(t){const e=t.xMin-this.cx,r=t.yMin-this.cy,i=t.xMax-this.cx,n=t.yMax-this.cy,s=this.r*this.r;return e*e+r*r<=s&&e*e+n*n<=s&&i*i+r*r<=s&&i*i+n*n<=s}containsCircle(t){const e=t.cx-this.cx,r=t.cy-this.cy;return e*e+r*r+t.r*t.r<=this.r*this.r}intersects(t){return(t=_s.fromLike(t))instanceof io?this.intersectsPoint(t):t instanceof lo?this.intersectsSegment(t):t instanceof qo?this.intersectsBox(t):t instanceof Po?this.intersectsCircle(t):t.intersects(this)}intersectsPoint(t){const e=t.x-this.cx,r=t.y-this.cy;return e*e+r*r<=this.r*this.r}intersectsSegment(t){const e=this.cx,r=this.cy,i=this.r,n=t.x0,s=t.y0,o=t.x1,a=t.y1,u=o-n,h=a-s,l=Math.sqrt(u*u+h*h),c=u/l,d=h/l,f=(e-n)*d-(r-s)*c;if(f<-i||i<f)return!1;const p=n-e,m=s-r,y=o-e,g=a-r,w=i*i;if(p*p+m*m<=w||y*y+g*g<=w)return!0;const b=c*e+d*r,v=c*n+d*s,x=c*o+d*a;return v<b&&b<=x||x<b&&b<=v}intersectsBox(t){const e=(this.cx<t.xMin?t.xMin:t.xMax<this.cx?t.xMax:this.cx)-this.cx,r=(this.cy<t.yMin?t.yMin:t.yMax<this.cy?t.yMax:this.cy)-this.cy;return e*e+r*r<=this.r*this.r}intersectsCircle(t){const e=t.cx-this.cx,r=t.cy-this.cy,i=this.r+t.r;return e*e+r*r<=i*i}transform(t){const e=t.transformX(this.cx,this.cy),r=t.transformY(this.cx,this.cy),i=t.transformX(this.cx+this.r,this.cy)-e,n=t.transformY(this.cx+this.r,this.cy)-r,s=Math.sqrt(i*i+n*n);return new Po(e,r,s)}toLike(){return{cx:this.cx,cy:this.cy,r:this.r}}interpolateTo(t){return t instanceof Po?Io(this,t):null}equivalentTo(t,e){return this===t||t instanceof Po&&(f.equivalent(this.cx,t.cx,e)&&f.equivalent(this.cy,t.cy,e)&&f.equivalent(this.r,t.r,e))}equals(t){return this===t||t instanceof Po&&(this.cx===t.cx&&this.cy===t.cy&&this.r===t.r)}hashCode(){return s.mash(s.mix(s.mix(s.mix(g.hash(Po),f.hash(this.cx)),f.hash(this.cy)),f.hash(this.r)))}debug(t){return t=t.write("R2Circle").write(46).write("of").write(40).debug(this.cx).write(", ").debug(this.cy).write(", ").debug(this.r).write(41)}toString(){return St.debug(this)}static of(t,e,r){return new Po(t,e,r)}static fromLike(t){if(null==t||t instanceof Po)return t;if(To[Symbol.hasInstance](t))return Po.fromInit(t);throw new TypeError(""+t)}static fromInit(t){return new Po(t.cx,t.cy,t.r)}}const Io=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.cx+t*(r.cx-e.cx),s=e.cy+t*(r.cy-e.cy),o=e.r+t*(r.r-e.r);return new Po(n,s,o)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),Do={[Symbol.hasInstance]:t=>t instanceof qo||Lo[Symbol.hasInstance](t)},Lo={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"xMin","yMin","xMax","yMax")};let qo=(()=>{var t;let i,n=_s,a=[];return t=class extends n{constructor(t,e,r,i){super(),this.xMin=t,this.yMin=e,this.xMax=r,this.yMax=i}isDefined(){return isFinite(this.xMin)&&isFinite(this.yMin)&&isFinite(this.xMax)&&isFinite(this.yMax)}get x(){return this.xMin}get y(){return this.yMin}get width(){return this.xMax-this.xMin}get height(){return this.yMax-this.yMin}get top(){return this.yMin}get right(){return this.xMax}get bottom(){return this.yMax}get left(){return this.xMin}get center(){return new io((this.xMin+this.xMax)/2,(this.yMin+this.yMax)/2)}contains(e,r){return"number"==typeof e?this.xMin<=e&&e<=this.xMax&&this.yMin<=r&&r<=this.yMax:(e=_s.fromLike(e))instanceof io?this.containsPoint(e):e instanceof lo?this.containsSegment(e):e instanceof t?this.containsBox(e):e instanceof Po?this.containsCircle(e):e instanceof _s&&(this.xMin<=e.xMin&&e.xMax<=this.xMax&&this.yMin<=e.yMin&&e.yMax<=this.yMax)}containsPoint(t){return this.xMin<=t.x&&t.x<=this.xMax&&this.yMin<=t.y&&t.y<=this.yMax}containsSegment(t){return this.xMin<=t.x0&&t.x0<=this.xMax&&this.yMin<=t.y0&&t.y0<=this.yMax&&this.xMin<=t.x1&&t.x1<=this.xMax&&this.yMin<=t.y1&&t.y1<=this.yMax}containsBox(t){return this.xMin<=t.xMin&&t.xMax<=this.xMax&&this.yMin<=t.yMin&&t.yMax<=this.yMax}containsCircle(t){return this.xMin<=t.cx-t.r&&t.cx+t.r<=this.xMax&&this.yMin<=t.cy-t.r&&t.cy+t.r<=this.yMax}intersects(e){return(e=_s.fromLike(e))instanceof io?this.intersectsPoint(e):e instanceof lo?this.intersectsSegment(e):e instanceof t?this.intersectsBox(e):e instanceof Po?this.intersectsCircle(e):e.intersects(this)}intersectsPoint(t){return this.xMin<=t.x&&t.x<=this.xMax&&this.yMin<=t.y&&t.y<=this.yMax}intersectsSegment(e){const r=this.xMin,i=this.yMin,n=this.xMax,s=this.yMax,o=e.x0,a=e.y0,u=e.x1,h=e.y1;return!(o<r&&u<r||o>n&&u>n||a<i&&h<i||a>s&&h>s)&&(o>r&&o<n&&a>i&&a<s||!!(t.intersectsSegment(o-r,u-r,o,a,u,h)&&t.hitY>i&&t.hitY<s||t.intersectsSegment(a-i,h-i,o,a,u,h)&&t.hitX>r&&t.hitX<n||t.intersectsSegment(o-n,u-n,o,a,u,h)&&t.hitY>i&&t.hitY<s||t.intersectsSegment(a-s,h-s,o,a,u,h)&&t.hitX>r&&t.hitX<n))}static intersectsSegment(e,r,i,n,s,o){if(e===r&&e*r>=0)return!1;const a=-e/(r-e);return t.hitX=i+(s-i)*a,t.hitY=n+(o-n)*a,!0}intersectsBox(t){return this.xMin<=t.xMax&&t.xMin<=this.xMax&&this.yMin<=t.yMax&&t.yMin<=this.yMax}intersectsCircle(t){const e=(t.cx<this.xMin?this.xMin:this.xMax<t.cx?this.xMax:t.cx)-t.cx,r=(t.cy<this.yMin?this.yMin:this.yMax<t.cy?this.yMax:t.cy)-t.cy;return e*e+r*r<=t.r*t.r}union(t){return super.union(t)}transform(e){return new t(e.transformX(this.xMin,this.yMin),e.transformY(this.xMin,this.yMin),e.transformX(this.xMax,this.yMax),e.transformY(this.xMax,this.yMax))}get bounds(){return this}toLike(){return{xMin:this.xMin,yMin:this.yMin,xMax:this.xMax,yMax:this.yMax}}interpolateTo(e){return e instanceof t?Ao(this,e):null}equivalentTo(e,r){return this===e||e instanceof t&&(f.equivalent(this.xMin,e.xMin,r)&&f.equivalent(this.yMin,e.yMin,r)&&f.equivalent(this.xMax,e.xMax,r)&&f.equivalent(this.yMax,e.yMax,r))}equals(e){return this===e||e instanceof t&&(this.xMin===e.xMin&&this.yMin===e.yMin&&this.xMax===e.xMax&&this.yMax===e.yMax)}hashCode(){return s.mash(s.mix(s.mix(s.mix(s.mix(g.hash(t),f.hash(this.xMin)),f.hash(this.yMin)),f.hash(this.xMax)),f.hash(this.yMax)))}debug(t){return t=t.write("R2Box").write(46).write("of").write(40).debug(this.xMin).write(", ").debug(this.yMin).write(", ").debug(this.xMax).write(", ").debug(this.yMax).write(41)}toString(){return St.debug(this)}static undefined(){return new t(1/0,1/0,-1/0,-1/0)}static of(e,r,i,n){return void 0===i&&(i=e),void 0===n&&(n=r),new t(e,r,i,n)}static fromLike(e){if(null==e||e instanceof t)return e;if(Lo[Symbol.hasInstance](e))return t.fromInit(e);throw new TypeError(""+e)}static fromInit(e){return new t(e.xMin,e.yMin,e.xMax,e.yMax)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t.hitX=0,t.hitY=0,t})();const Ao=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.xMin+t*(r.xMin-e.xMin),s=e.yMin+t*(r.yMin-e.yMin),o=e.xMax+t*(r.xMax-e.xMax),a=e.yMax+t*(r.yMax-e.yMax);return new qo(n,s,o,a)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);let Fo=(()=>{var t;let i,n=_s,s=[];return t=class extends n{constructor(t){super(),this.shapes=t,this.boundingBox=null}isDefined(){return 0!==this.shapes.length}get xMin(){return this.bounds.xMin}get yMin(){return this.bounds.yMin}get xMax(){return this.bounds.xMax}get yMax(){return this.bounds.yMax}contains(t,e){return!1}intersects(t){return!1}transform(e){const r=this.shapes,i=r.length;if(0===i)return t.empty();const n=new Array(i);for(let t=0;t<i;t+=1)n[t]=r[t].transform(e);return new t(n)}get bounds(){let t=this.boundingBox;if(null===t){let e=1/0,r=1/0,i=-1/0,n=-1/0;const s=this.shapes;for(let t=0;t<s.length;t+=1){const o=s[t];e=Math.min(e,o.xMin),r=Math.min(r,o.yMin),i=Math.max(o.xMax,i),n=Math.max(o.yMax,n)}t=new qo(e,r,i,n),this.boundingBox=t}return t}equivalentTo(e,r){return this===e||e instanceof t&&w.equivalent(this.shapes,e.shapes,r)}equals(e){return this===e||e instanceof t&&w.equal(this.shapes,e.shapes)}debug(t){const e=this.shapes,r=e.length;if(t=t.write("R2Group").write(46),0===r)t=t.write("empty").write(40);else{t=(t=t.write("of").write(40)).debug(e[0]);for(let i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}return t=t.write(41)}toString(){return St.debug(this)}static empty(){return new t(w.empty())}static of(...e){return new t(e)}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();const Vo={[Symbol.hasInstance]:t=>t instanceof zo||"string"==typeof t};let zo=(()=>{var t;let i,n,s=[];return t=class{translate(e,r){return this.transform(t.translate(e,r))}translateX(e){return this.transform(t.translateX(e))}translateY(e){return this.transform(t.translateY(e))}scale(e,r){return this.transform(t.scale(e,r))}scaleX(e){return this.transform(t.scaleX(e))}scaleY(e){return this.transform(t.scaleY(e))}rotate(e){return this.transform(t.rotate(e))}skew(e,r){return this.transform(t.skew(e,r))}skewX(e){return this.transform(t.skewX(e))}skewY(e){return this.transform(t.skewY(e))}toMatrix(){return this.toAffine().toMatrix()}toCssTransformComponent(){return null}toCssValue(){if("undefined"==typeof CSSTransformValue)return null;const t=this.toCssTransformComponent();return null===t?null:new CSSTransformValue([t])}interpolateTo(e){return e instanceof t?sa(this.toAffine(),e.toAffine()):null}toAttributeString(){return this.toString()}static identity(){return new Uo}static translate(t,e){return t=Is.fromLike(t),e=Is.fromLike(e),new Bo(t,e)}static translateX(t){return t=Is.fromLike(t),new Bo(t,Ds.zero())}static translateY(t){return t=Is.fromLike(t),new Bo(Ds.zero(),t)}static scale(t,e){return new Xo(t,e)}static scaleX(t){return new Xo(t,1)}static scaleY(t){return new Xo(1,t)}static rotate(t){return t=Us.fromLike(t,"deg"),new Qo(t)}static skew(t,e){return t=Us.fromLike(t,"deg"),e=Us.fromLike(e,"deg"),new ta(t,e)}static skewX(t){return t=Us.fromLike(t,"deg"),new ta(t,Rs.zero())}static skewY(t){return t=Us.fromLike(t,"deg"),new ta(Rs.zero(),t)}static affine(t=1,e=0,r=0,i=1,n=0,s=0){return new na(t,e,r,i,n,s)}static list(...e){const r=[];for(let i=0;i<e.length;i+=1){const n=t.fromLike(e[i]);n instanceof ua?r.push(...n.transforms):n instanceof Uo||r.push(n)}return new ua(r)}static fromCssValue(e){if(e instanceof CSSTransformValue)return t.fromCssTransform(e);throw new TypeError(""+e)}static fromCssTransform(e){const r=e.length;if(1===r)return t.fromCssTransformComponent(e[0]);const i=new Array(r);for(let n=0;n<r;n+=1)i[n]=t.fromCssTransformComponent(e[n]);return new ua(i)}static fromCssTransformComponent(t){if(t instanceof CSSTranslate)return Bo.fromCssTransformComponent(t);if(t instanceof CSSRotate)return Qo.fromCssTransformComponent(t);if(t instanceof CSSScale)return Xo.fromCssTransformComponent(t);if(t instanceof CSSSkew)return ta.fromCssTransformComponent(t);if(t instanceof CSSMatrixComponent)return na.fromCssTransformComponent(t);throw new TypeError(""+t)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static fromValue(t){switch(t.tag){case"identity":return Uo.fromValue(t);case"translate":return Bo.fromValue(t);case"scale":return Xo.fromValue(t);case"rotate":return Qo.fromValue(t);case"skew":return ta.fromValue(t);case"matrix":return na.fromValue(t);default:return ua.fromValue(t)}}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=la.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}static form(){return new jo(t.identity())}},(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"identity",static:!0,private:!1,access:{has:t=>"identity"in t,get:t=>t.identity},metadata:a},null,s),e(t,null,n,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:a},null,s),a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),r(t,s)})(),t})();class jo extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new jo(t)}mold(t){return(t=zo.fromLike(t)).toValue()}cast(t){const e=t.toValue();try{if(e instanceof gr){const t=zo.fromValue(e);return null!==t?t:void 0}{const t=e.stringValue(void 0);if(void 0!==t)return zo.parse(t)}}catch(t){}}}class No extends Nt{constructor(t){super(),this.identOutput=t}feed(t){return No.parse(t,this.identOutput)}static parse(t,e){let r=0;for(e=e||xt.stringOutput();t.isCont()&&(r=t.head(),xt.isAlpha(r)||xt.isDigit(r)||45===r);)t=t.step(),e.write(r);if(!t.isEmpty()){const r=e.bind();switch(r){case"translate3d":case"translateX":case"translateY":case"translate":return Ho.parseRest(t,e);case"scaleX":case"scaleY":case"scale":return Go.parseRest(t,e);case"rotate":return $o.parseRest(t,e);case"skewX":case"skewY":case"skew":return ra.parseRest(t,e);case"matrix":return oa.parseRest(t,e);case"none":return Nt.done(zo.identity());default:return Nt.error(kt.message("unknown transform function: "+r,t))}}return new No(e)}}class Uo extends zo{transform(t,e){if(2===arguments.length)return new io(t,e);if(t instanceof zo)return t;throw new TypeError(""+t)}transformX(t,e){return t}transformY(t,e){return e}inverse(){return this}toAffine(){return new na(1,0,0,1,0,0)}toCssValue(){return new CSSKeywordValue("identity")}toValue(){return gr.create(1).attr("identity")}interpolateTo(t){return t instanceof Uo?U(this):super.interpolateTo(t)}conformsTo(t){return t instanceof Uo}equivalentTo(t,e){return t instanceof Uo}equals(t){return t instanceof Uo}hashCode(){return g.hash(Uo)}debug(t){return t=t.write("Transform").write(46).write("identity").write(40).write(41)}toString(){return"none"}static fromValue(t){return"identity"===t.tag?zo.identity():null}}const Ro={[Symbol.hasInstance]:t=>t instanceof Bo||"string"==typeof t};class Bo extends zo{constructor(t,e){super(),this.x=t,this.y=e,this.stringValue=void 0}transform(t,e){if(2===arguments.length)return new io(this.x.pxValue()+t,this.y.pxValue()+e);if(t instanceof Uo)return this;if(t instanceof Bo)return new Bo(this.x.plus(t.x),this.y.plus(t.y));if(t instanceof zo)return zo.list(this,t);throw new TypeError(""+t)}transformX(t,e){return this.x.pxValue()+t}transformY(t,e){return this.y.pxValue()+e}inverse(){return new Bo(this.x.negative(),this.y.negative())}toAffine(){return new na(1,0,0,1,this.x.pxValue(),this.y.pxValue())}toCssTransformComponent(){return"undefined"==typeof CSSTranslate?null:new CSSTranslate(this.x.toCssValue(),this.y.toCssValue())}toValue(){return gr.create(1).attr("translate",gr.create(2).slot("x",this.x.toValue()).slot("y",this.y.toValue()))}interpolateTo(t){return t instanceof Bo?Yo(this,t):super.interpolateTo(t)}conformsTo(t){return t instanceof Bo}equivalentTo(t,e){return t instanceof Bo&&(this.x.equivalentTo(t.x,e)&&this.y.equivalentTo(t.y,e))}equals(t){return t instanceof Bo&&(this.x.equals(t.x)&&this.y.equals(t.y))}hashCode(){return s.mash(s.mix(s.mix(g.hash(Bo),this.x.hashCode()),this.y.hashCode()))}debug(t){return t=t.write("Transform").write(46).write("translate"),t=(t=this.x.isDefined()&&!this.y.isDefined()?t.write("X").write(40).debug(this.x):!this.x.isDefined()&&this.y.isDefined()?t.write("Y").write(40).debug(this.y):t.write(40).debug(this.x).write(", ").debug(this.y)).write(41)}toString(){let t=this.stringValue;return void 0===t&&(t=this.x.isDefined()&&!this.y.isDefined()?"translate("+this.x+",0)":!this.x.isDefined()&&this.y.isDefined()?"translate(0,"+this.y+")":"translate("+this.x+","+this.y+")",this.stringValue=t),t}toAttributeString(){return this.x.isDefined()&&!this.y.isDefined()?"translate("+this.x.pxValue()+",0)":!this.x.isDefined()&&this.y.isDefined()?"translate(0,"+this.y.pxValue()+")":"translate("+this.x.pxValue()+","+this.y.pxValue()+")"}static fromCssTransformComponent(t){const e="number"==typeof t.x?Is.px(t.x):Is.fromCssValue(t.x),r="number"==typeof t.y?Is.px(t.y):Is.fromCssValue(t.y);return new Bo(e,r)}static fromLike(t){if(null==t||t instanceof Bo)return t;if("string"==typeof t)return Bo.parse(t);throw new TypeError(""+t)}static fromValue(t){const e=t.header("translate");if(!e.isDefined())return null;let r=Is.zero(),i=Is.zero();return e.forEach((function(t,e){const n=t.key.stringValue();void 0!==n?"x"===n?r=t.toValue().cast(Is.form(),r):"y"===n&&(i=t.toValue().cast(Is.form(),i)):t instanceof mr&&(0===e?r=t.cast(Is.form(),r):1===e&&(i=t.cast(Is.form(),i)))}),this),new Bo(r,i)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=Ho.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}}const Yo=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=Is.of(e.x.value+t*(r.x.value-e.x.value),r.x.units),s=Is.of(e.y.value+t*(r.y.value-e.y.value),r.y.units);return new Bo(n,s)};return Object.setPrototypeOf(i,e.prototype),i[0]=t.x.units===r.x.units&&t.y.units===r.y.units?t:new Bo(t.x.to(r.x.units),t.y.to(r.y.units)),i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class Ho extends Nt{constructor(t,e,r,i,n){super(),this.identOutput=t,this.xParser=e,this.yParser=r,this.zParser=i,this.step=n}feed(t){return Ho.parse(t,this.identOutput,this.xParser,this.yParser,this.zParser,this.step)}static parse(t,e,r,i,n,s=1){let o=0;if(1===s){for(e=e||xt.stringOutput();t.isCont()&&(o=t.head(),xt.isAlpha(o)||xt.isDigit(o)||45===o);)t=t.step(),e.write(o);if(!t.isEmpty()){const r=e.bind();switch(r){case"translate3d":case"translateX":case"translateY":case"translate":s=2;break;default:return Nt.error(kt.message("unknown transform function: "+r,t))}}}if(2===s){for(;t.isCont()&&(o=t.head(),xt.isSpace(o));)t=t.step();if(t.isCont()&&40===o)t.step(),s=3;else if(!t.isEmpty())return Nt.error(kt.expected("(",t))}if(3===s){if(void 0===r){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(r=js.parse(t,"px"))}else r=r.feed(t);if(void 0!==r)if(r.isDone())s=4;else if(r.isError())return r.asError()}if(4===s){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont())if(o=t.head(),41===o){t.step();const i=e.bind();switch(i){case"translateX":return Nt.done(new Bo(r.bind(),Ds.zero()));case"translateY":return Nt.done(new Bo(Ds.zero(),r.bind()));default:return Nt.error(kt.message("unknown transform function: "+i,t))}}else{if(44!==o)return Nt.error(kt.expected(",",t));t.step(),s=5}else if(t.isDone())return Nt.error(kt.unexpected(t))}if(5===s){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(i=js.parse(t,"px"))}else i=i.feed(t);if(void 0!==i)if(i.isDone())s=6;else if(i.isError())return i.asError()}if(6===s){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont()){if(o=t.head(),41===o){t.step();const n=e.bind();return"translate"===n?Nt.done(new Bo(r.bind(),i.bind())):Nt.error(kt.message("unknown transform function: "+n,t))}if(44!==o)return Nt.error(kt.expected(",",t));t.step(),s=7}else if(t.isDone())return Nt.error(kt.unexpected(t))}if(7===s){if(void 0===n){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(n=js.parse(t,"px"))}else n=n.feed(t);if(void 0!==n)if(n.isDone())s=8;else if(n.isError())return n.asError()}if(8===s){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont()&&41===t.head()){t.step();const s=e.bind();return"translate3d"===s&&0===n.bind().value?Nt.done(new Bo(r.bind(),i.bind())):Nt.error(kt.message("unknown transform function: "+s,t))}if(!t.isEmpty())return Nt.error(kt.expected(")",t))}return new Ho(e,r,i,n,s)}static parseRest(t,e){return Ho.parse(t,e,void 0,void 0,void 0,2)}}const Wo={[Symbol.hasInstance]:t=>t instanceof Xo||"string"==typeof t};class Xo extends zo{constructor(t,e){super(),this.x=t,this.y=e,this.stringValue=void 0}transform(t,e){if(2===arguments.length)return new io(this.x*t,this.y*e);if(t instanceof Uo)return this;if(t instanceof zo)return zo.list(this,t);throw new TypeError(""+t)}transformX(t,e){return this.x*t}transformY(t,e){return this.y*e}inverse(){return new Xo(1/(this.x||1),1/(this.y||1))}toAffine(){return new na(this.x,0,0,this.y,0,0)}toCssTransformComponent(){return"undefined"==typeof CSSTranslate?null:new CSSScale(this.x,this.y)}toValue(){return gr.create(1).attr("scale",gr.create(2).slot("x",this.x).slot("y",this.y))}interpolateTo(t){return t instanceof Xo?Ko(this,t):super.interpolateTo(t)}conformsTo(t){return t instanceof Xo}equivalentTo(t,e){return t instanceof Xo&&(f.equivalent(this.x,t.x,e)&&f.equivalent(this.y,t.y,e))}equals(t){return t instanceof Xo&&(this.x===t.x&&this.y===t.y)}hashCode(){return s.mash(s.mix(s.mix(g.hash(Xo),f.hash(this.x)),f.hash(this.y)))}debug(t){return t=t.write("Transform").write(46).write("scale"),t=(t=0!==this.x&&0===this.y?t.write("X").write(40).debug(this.x):0===this.x&&0!==this.y?t.write("Y").write(40).debug(this.y):t.write(40).debug(this.x).write(", ").debug(this.y)).write(41)}toString(){let t=this.stringValue;return void 0===t&&(t=0!==this.x&&0===this.y?"scaleX("+this.x+")":0===this.x&&0!==this.y?"scaleY("+this.y+")":"scale("+this.x+","+this.y+")",this.stringValue=t),t}static fromCssTransformComponent(t){const e="number"==typeof t.x?t.x:t.x.to("number").value,r="number"==typeof t.y?t.y:t.y.to("number").value;return new Xo(e,r)}static fromLike(t){if(null==t||t instanceof Xo)return t;if("string"==typeof t)return Xo.parse(t);throw new TypeError(""+t)}static fromValue(t){const e=t.header("scale");if(!e.isDefined())return null;let r=0,i=0;return e.forEach((function(t,e){const n=t.key.stringValue();void 0!==n?"x"===n?r=t.toValue().numberValue(r):"y"===n&&(i=t.toValue().numberValue(i)):t instanceof mr&&(0===e?r=t.numberValue(r):1===e&&(i=t.numberValue(i)))}),this),new Xo(r,i)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=Go.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}}const Ko=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.x+t*(r.x-e.x),s=e.y+t*(r.y-e.y);return new Xo(n,s)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=j,e}(j);class Go extends Nt{constructor(t,e,r,i){super(),this.identOutput=t,this.xParser=e,this.yParser=r,this.step=i}feed(t){return Go.parse(t,this.identOutput,this.xParser,this.yParser,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n){for(e=e||xt.stringOutput();t.isCont()&&(s=t.head(),xt.isAlpha(s));)t=t.step(),e.write(s);if(!t.isEmpty()){const r=e.bind();switch(r){case"scaleX":case"scaleY":case"scale":n=2;break;default:return Nt.error(kt.message("unknown transform function: "+r,t))}}}if(2===n){for(;t.isCont()&&(s=t.head(),xt.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),n=3;else if(!t.isEmpty())return Nt.error(kt.expected("(",t))}if(3===n){if(void 0===r){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(r=Ct.parseNumber(t))}else r=r.feed(t);if(void 0!==r)if(r.isDone())n=4;else if(r.isError())return r.asError()}if(4===n){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont())if(s=t.head(),41===s){t.step();const i=e.bind();switch(i){case"scaleX":return Nt.done(new Xo(r.bind(),1));case"scaleY":return Nt.done(new Xo(1,r.bind()));default:return Nt.error(kt.message("unknown transform function: "+i,t))}}else{if(44!==s)return Nt.error(kt.expected(",",t));t.step(),n=5}else if(t.isDone())return Nt.error(kt.unexpected(t))}if(5===n){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(i=Ct.parseNumber(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())n=6;else if(i.isError())return i.asError()}if(6===n){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont()&&41===t.head()){t.step();const n=e.bind();return"scale"===n?Nt.done(new Xo(r.bind(),i.bind())):Nt.error(kt.message("unknown transform function: "+n,t))}if(!t.isEmpty())return Nt.error(kt.expected(")",t))}return new Go(e,r,i,n)}static parseRest(t,e){return Go.parse(t,e,void 0,void 0,2)}}const Zo={[Symbol.hasInstance]:t=>t instanceof Qo||"string"==typeof t};class Qo extends zo{constructor(t){super(),this.angle=t,this.stringValue=void 0}transform(t,e){if(2===arguments.length){const r=this.angle.radValue(),i=Math.cos(r),n=Math.sin(r);return new io(t*i-e*n,t*n+e*i)}if(t instanceof Uo)return this;if(t instanceof zo)return zo.list(this,t);throw new TypeError(""+t)}transformX(t,e){const r=this.angle.radValue();return t*Math.cos(r)-e*Math.sin(r)}transformY(t,e){const r=this.angle.radValue();return t*Math.sin(r)+e*Math.cos(r)}inverse(){return new Qo(this.angle.negative())}toAffine(){const t=this.angle.radValue();return new na(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0)}toCssTransformComponent(){return"undefined"==typeof CSSTranslate?null:new CSSRotate(this.angle.toCssValue())}toValue(){return gr.create(1).attr("rotate",this.angle.toString())}interpolateTo(t){return t instanceof Qo?Jo(this,t):super.interpolateTo(t)}conformsTo(t){return t instanceof Qo}equivalentTo(t,e){return t instanceof Qo&&this.angle.equivalentTo(t.angle,e)}equals(t){return t instanceof Qo&&this.angle.equals(t.angle)}hashCode(){return s.mash(s.mix(g.hash(Qo),this.angle.hashCode()))}debug(t){return t=t.write("Transform").write(46).write("rotate").write(40).debug(this.angle).write(41)}toString(){let t=this.stringValue;return void 0===t&&(t="rotate("+this.angle+")",this.stringValue=t),t}toAttributeString(){return"rotate("+this.angle.degValue()+")"}static fromCssTransformComponent(t){const e=Us.fromCssValue(t.angle);return new Qo(e)}static fromLike(t){if(null==t||t instanceof Qo)return t;if("string"==typeof t)return Qo.parse(t);throw new TypeError(""+t)}static fromValue(t){const e=t.header("rotate");if(!e.isDefined())return null;let r=Us.zero();return e.forEach((function(t,e){"angle"===t.key.stringValue()?r=t.toValue().cast(Us.form(),r):t instanceof mr&&0===e&&(r=t.cast(Us.form(),r))}),this),new Qo(r)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=$o.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}}const Jo=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=Us.of(e.angle.value+t*(r.angle.value-e.angle.value),r.angle.units);return new Qo(n)};return Object.setPrototypeOf(i,e.prototype),i[0]=t.angle.units===r.angle.units?t:new Qo(t.angle.to(r.angle.units)),i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class $o extends Nt{constructor(t,e,r){super(),this.identOutput=t,this.angleParser=e,this.step=r}feed(t){return $o.parse(t,this.identOutput,this.angleParser,this.step)}static parse(t,e,r,i=1){let n=0;if(1===i){for(e=e||xt.stringOutput();t.isCont()&&(n=t.head(),xt.isAlpha(n));)t=t.step(),e.write(n);if(!t.isEmpty()){const r=e.bind();if("rotate"!==r)return Nt.error(kt.message("unknown transform function: "+r,t));i=2}}if(2===i){for(;t.isCont()&&(n=t.head(),xt.isSpace(n));)t=t.step();if(t.isCont()&&40===n)t.step(),i=3;else if(!t.isEmpty())return Nt.error(kt.expected("(",t))}if(3===i){if(void 0===r){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(r=Ks.parse(t,"deg"))}else r=r.feed(t);if(void 0!==r)if(r.isDone())i=4;else if(r.isError())return r.asError()}if(4===i){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont()&&41===t.head()){t.step();const i=e.bind();return"rotate"===i?Nt.done(new Qo(r.bind())):Nt.error(kt.message("unknown transform function: "+i,t))}if(!t.isEmpty())return Nt.error(kt.expected(")",t))}return new $o(e,r,i)}static parseRest(t,e){return $o.parse(t,e,void 0,2)}}const _o={[Symbol.hasInstance]:t=>t instanceof ta||"string"==typeof t};class ta extends zo{constructor(t,e){super(),this.x=t,this.y=e,this.stringValue=void 0}transform(t,e){if(2===arguments.length)return new io(Math.tan(this.x.radValue())*e+t,Math.tan(this.y.radValue())*t+e);if(t instanceof Uo)return this;if(t instanceof zo)return zo.list(this,t);throw new TypeError(""+t)}transformX(t,e){return Math.tan(this.x.radValue())*e+t}transformY(t,e){return Math.tan(this.y.radValue())*t+e}inverse(){return new ta(this.x.negative(),this.y.negative())}toAffine(){const t=this.x.radValue(),e=this.y.radValue();return new na(1,Math.tan(e),Math.tan(t),1,0,0)}toCssTransformComponent(){return"undefined"==typeof CSSTranslate?null:new CSSSkew(this.x.toCssValue(),this.y.toCssValue())}toValue(){return gr.create(1).attr("skew",gr.create(2).slot("x",this.x.toValue()).slot("y",this.y.toValue()))}interpolateTo(t){return t instanceof ta?ea(this,t):super.interpolateTo(t)}conformsTo(t){return t instanceof ta}equivalentTo(t,e){return t instanceof ta&&(this.x.equivalentTo(t.x,e)&&this.y.equivalentTo(t.y,e))}equals(t){return t instanceof ta&&(this.x.equals(t.x)&&this.y.equals(t.y))}hashCode(){return s.mash(s.mix(s.mix(g.hash(ta),this.x.hashCode()),this.y.hashCode()))}debug(t){return t=t.write("Transform").write(46).write("skew"),t=(t=this.x.isDefined()&&!this.y.isDefined()?t.write("X").write(40).debug(this.x):!this.x.isDefined()&&this.y.isDefined()?t.write("Y").write(40).debug(this.y):t.write(40).debug(this.x).write(", ").debug(this.y)).write(41)}toString(){let t=this.stringValue;return void 0===t&&(t=this.x.isDefined()&&!this.y.isDefined()?"skewX("+this.x+")":!this.x.isDefined()&&this.y.isDefined()?"skewY("+this.y+")":"skew("+this.x+","+this.y+")",this.stringValue=t),t}toAttributeString(){return this.x.isDefined()&&!this.y.isDefined()?"skewX("+this.x.degValue()+")":!this.x.isDefined()&&this.y.isDefined()?"skewY("+this.y.degValue()+")":"skew("+this.x.degValue()+","+this.y.degValue()+")"}static fromCssTransformComponent(t){const e="number"==typeof t.ax?Us.rad(t.ax):Us.fromCssValue(t.ax),r="number"==typeof t.ay?Us.rad(t.ay):Us.fromCssValue(t.ay);return new ta(e,r)}static fromLike(t){if(null==t||t instanceof ta)return t;if("string"==typeof t)return ta.parse(t);throw new TypeError(""+t)}static fromValue(t){const e=t.header("skew");if(!e.isDefined())return null;let r=Us.zero(),i=Us.zero();return e.forEach((function(t,e){const n=t.key.stringValue();void 0!==n?"x"===n?r=t.toValue().cast(Us.form(),r):"y"===n&&(i=t.toValue().cast(Us.form(),i)):t instanceof mr&&(0===e?r=t.cast(Us.form(),r):1===e&&(i=t.cast(Us.form(),i)))}),this),new ta(r,i)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=ra.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}}const ea=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=Us.of(e.x.value+t*(r.x.value-e.x.value),r.x.units),s=Us.of(e.y.value+t*(r.y.value-e.y.value),r.y.units);return new ta(n,s)};return Object.setPrototypeOf(i,e.prototype),i[0]=t.x.units===r.x.units&&t.y.units===r.y.units?t:new ta(t.x.to(r.x.units),t.y.to(r.y.units)),i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class ra extends Nt{constructor(t,e,r,i){super(),this.identOutput=t,this.xParser=e,this.yParser=r,this.step=i}feed(t){return ra.parse(t,this.identOutput,this.xParser,this.yParser,this.step)}static parse(t,e,r,i,n=1){let s=0;if(1===n){for(e=e||xt.stringOutput();t.isCont()&&(s=t.head(),xt.isAlpha(s));)t=t.step(),e.write(s);if(!t.isEmpty()){const r=e.bind();switch(r){case"skewX":case"skewY":case"skew":n=2;break;default:return Nt.error(kt.message("unknown transform function: "+r,t))}}}if(2===n){for(;t.isCont()&&(s=t.head(),xt.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),n=3;else if(!t.isEmpty())return Nt.error(kt.expected("(",t))}if(3===n){if(void 0===r){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(r=Ks.parse(t,"deg"))}else r=r.feed(t);if(void 0!==r)if(r.isDone())n=4;else if(r.isError())return r.asError()}if(4===n){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont())if(s=t.head(),41===s){t.step();const i=e.bind();switch(i){case"skewX":return Nt.done(new ta(r.bind(),Rs.zero()));case"skewY":return Nt.done(new ta(Rs.zero(),r.bind()));default:return Nt.error(kt.message("unknown transform function: "+i,t))}}else{if(44!==s)return Nt.error(kt.expected(",",t));t.step(),n=5}else if(t.isDone())return Nt.error(kt.unexpected(t))}if(5===n){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(i=Ks.parse(t,"deg"))}else i=i.feed(t);if(void 0!==i)if(i.isDone())n=6;else if(i.isError())return i.asError()}if(6===n){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont()&&41===t.head()){t.step();const n=e.bind();return"skew"===n?Nt.done(new ta(r.bind(),i.bind())):Nt.error(kt.message("unknown transform function: "+n,t))}if(!t.isEmpty())return Nt.error(kt.expected(")",t))}return new ra(e,r,i,n)}static parseRest(t,e){return ra.parse(t,e,void 0,void 0,2)}}const ia={[Symbol.hasInstance]:t=>t instanceof na||"string"==typeof t};let na=(()=>{var t;let i,n=zo,a=[];return t=class extends n{constructor(t,e,r,i,n,s){super(),this.x0=t,this.y0=e,this.x1=r,this.y1=i,this.tx=n,this.ty=s,this.stringValue=void 0}transform(t,e){if(2===arguments.length)return new io(this.x0*t+this.x1*e+this.tx,this.y0*t+this.y1*e+this.ty);if(t instanceof Uo)return this;if(t instanceof zo)return this.multiply(t.toAffine());throw new TypeError(""+t)}transformX(t,e){return this.x0*t+this.x1*e+this.tx}transformY(t,e){return this.y0*t+this.y1*e+this.ty}inverse(){const e=this.x0,r=this.y0,i=this.x1,n=this.y1,s=this.tx,o=this.ty,a=e*n-i*r;if(Math.abs(a)<Number.MIN_VALUE)throw new Error("non-invertible affine transform with determinant "+a);return new t(n/a,-r/a,-i/a,e/a,(i*o-n*s)/a,(r*s-e*o)/a)}multiply(e){const r=this.x0*e.x0+this.x1*e.y0,i=this.y0*e.x0+this.y1*e.y0,n=this.x0*e.x1+this.x1*e.y1,s=this.y0*e.x1+this.y1*e.y1,o=this.x0*e.tx+this.x1*e.ty,a=this.y0*e.tx+this.y1*e.ty;return new t(r,i,n,s,o,a)}toAffine(){return this}toMatrix(){return new DOMMatrix([this.x0,this.y0,this.x1,this.y1,this.tx,this.ty])}toCssTransformComponent(){return"undefined"==typeof CSSTranslate?null:new CSSMatrixComponent(this.toMatrix())}toValue(){return gr.create(1).attr("matrix",gr.create(6).item(this.x0).item(this.y0).item(this.x1).item(this.y1).item(this.tx).item(this.ty))}interpolateTo(e){return e instanceof t?sa(this,e):super.interpolateTo(e)}conformsTo(e){return e instanceof t}equivalentTo(e,r){return e instanceof t&&(f.equivalent(this.x0,e.x0,r)&&f.equivalent(this.y0,e.y0,r)&&f.equivalent(this.x1,e.x1,r)&&f.equivalent(this.y1,e.y1,r)&&f.equivalent(this.tx,e.tx,r)&&f.equivalent(this.ty,e.ty,r))}equals(e){return e instanceof t&&(this.x0===e.x0&&this.y0===e.y0&&this.x1===e.x1&&this.y1===e.y1&&this.tx===e.tx&&this.ty===e.ty)}hashCode(){return s.mash(s.mix(s.mix(s.mix(s.mix(s.mix(s.mix(g.hash(t),f.hash(this.x0)),f.hash(this.y0)),f.hash(this.x1)),f.hash(this.y1)),f.hash(this.tx)),f.hash(this.ty)))}debug(t){return t=t.write("Transform").write(46).write("affine").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.tx).write(", ").debug(this.ty).write(41)}toString(){let t=this.stringValue;return void 0===t&&(t="matrix("+this.x0+","+this.y0+","+this.x1+","+this.y1+","+this.tx+","+this.ty+")",this.stringValue=t),t}static identity(){return new t(1,0,0,1,0,0)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static fromMatrix(e){return new t(e.a,e.b,e.c,e.d,e.e,e.f)}static fromCssTransformComponent(e){return t.fromMatrix(e.matrix)}static fromValue(e){const r=e.header("matrix");if(!r.isDefined())return null;let i=0,n=0,s=0,o=0,a=0,u=0;return r.forEach((function(t,e){const r=t.key.stringValue();if(void 0!==r)"x0"===r?i=t.toValue().numberValue(i):"y0"===r?n=t.toValue().numberValue(n):"x1"===r?s=t.toValue().numberValue(s):"y1"===r?o=t.toValue().numberValue(o):"tx"===r?a=t.toValue().numberValue(a):"ty"===r&&(u=t.toValue().numberValue(u));else if(t instanceof mr)switch(e){case 0:i=t.numberValue(i);break;case 1:n=t.numberValue(n);break;case 2:s=t.numberValue(s);break;case 3:o=t.numberValue(o);break;case 4:a=t.numberValue(a);break;case 5:u=t.numberValue(u)}}),this),new t(i,n,s,o,a,u)}static parse(t){let e=xt.stringInput(t);for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();let r=oa.parse(e);if(r.isDone())for(;e.isCont()&&xt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=Nt.error(kt.unexpected(e))),r.bind()}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"identity",static:!0,private:!1,access:{has:t=>"identity"in t,get:t=>t.identity},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})();const sa=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.x0+t*(r.x0-e.x0),s=e.y0+t*(r.y0-e.y0),o=e.x1+t*(r.x1-e.x1),a=e.y1+t*(r.y1-e.y1),u=e.tx+t*(r.tx-e.tx),h=e.ty+t*(r.ty-e.ty);return new na(n,s,o,a,u,h)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class oa extends Nt{constructor(t,e,r,i){super(),this.identOutput=t,this.entries=e,this.entryParser=r,this.step=i}feed(t){return oa.parse(t,this.identOutput,this.entries,this.entryParser,this.step)}static parse(t,e,r=[],i,n=1){let s=0;if(1===n){for(e=e||xt.stringOutput();t.isCont()&&(s=t.head(),xt.isAlpha(s));)t=t.step(),e.write(s);if(!t.isEmpty()){const r=e.bind();if("matrix"!==r)return Nt.error(kt.message("unknown transform function: "+r,t));n=2}}if(2===n){for(;t.isCont()&&(s=t.head(),xt.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),n=3;else if(!t.isEmpty())return Nt.error(kt.expected("(",t))}for(;;){if(3===n){if(void 0===i){for(;t.isCont()&&xt.isSpace(t.head());)t.step();t.isEmpty()||(i=Ct.parseNumber(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())r.push(i.bind()),i=void 0,n=4;else if(i.isError())return i.asError()}if(4===n){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont()){if(s=t.head(),41===s){t.step();const i=e.bind();return"matrix"===i?Nt.done(zo.affine(...r)):Nt.error(kt.message("unknown transform function: "+i,t))}if(r.length>=6)return Nt.error(kt.expected(")",t));if(44===s){t.step(),n=3;continue}return Nt.error(kt.expected(",",t))}if(t.isDone())return Nt.error(kt.unexpected(t))}break}return new oa(e,r,i,n)}static parseRest(t,e){return oa.parse(t,e,void 0,void 0,2)}}const aa={[Symbol.hasInstance]:t=>t instanceof ua||"string"==typeof t};class ua extends zo{constructor(t){super(),this.transforms=t,this.stringValue=void 0}transform(t,e){if(2===arguments.length){const r=this.transforms;for(let i=0;i<r.length;i+=1){const n=r[i],s=n.transformX(t,e),o=n.transformY(t,e);t=s,e=o}return new io(t,e)}if(t instanceof Uo)return this;if(t instanceof zo)return zo.list(this,t);throw new TypeError(""+t)}transformX(t,e){const r=this.transforms;for(let i=0;i<r.length;i+=1){const n=r[i],s=n.transformX(t,e),o=n.transformY(t,e);t=s,e=o}return t}transformY(t,e){const r=this.transforms;for(let i=0;i<r.length;i+=1){const n=r[i],s=n.transformX(t,e),o=n.transformY(t,e);t=s,e=o}return e}inverse(){const t=this.transforms,e=t.length,r=new Array(e);for(let i=0;i<e;i+=1)r[i]=t[e-i-1].inverse();return new ua(r)}toAffine(){let t=na.identity();const e=this.transforms;for(let r=0;r<e.length;r+=1)t=t.multiply(e[r].toAffine());return t}toCssTransformComponent(){return"undefined"==typeof CSSTranslate?null:new CSSMatrixComponent(this.toMatrix())}toCssValue(){if("undefined"==typeof CSSTransformValue)return null;const t=this.transforms,e=t.length,r=new Array(e);for(let e=0;e<t.length;e+=1){const i=t[e].toCssTransformComponent();if(null===i)return null;r[e]=i}return new CSSTransformValue(r)}toValue(){const t=this.transforms,e=t.length,r=gr.create(e);for(let i=0;i<e;i+=1)r.push(t[i].toValue());return r}interpolateTo(t){return t instanceof ua?ha(this,t):super.interpolateTo(t)}conformsTo(t){if(!(t instanceof ua))return!1;const e=this.transforms.length;if(e!==t.transforms.length)return!1;for(let r=0;r<e;r+=1)if(!this.transforms[r].conformsTo(t.transforms[r]))return!1;return!0}equivalentTo(t,e){if(!(t instanceof ua))return!1;const r=this.transforms.length;if(r!==t.transforms.length)return!1;for(let i=0;i<r;i+=1)if(!this.transforms[i].equivalentTo(t.transforms[i],e))return!1;return!0}equals(t){if(!(t instanceof ua))return!1;const e=this.transforms.length;if(e!==t.transforms.length)return!1;for(let r=0;r<e;r+=1)if(!this.transforms[r].equals(t.transforms[r]))return!1;return!0}hashCode(){let t=g.hash(ua);const e=this.transforms;for(let r=0;r<e.length;r+=1)t=s.mix(t,e[r].hashCode());return s.mash(t)}debug(t){t=t.write("Transform").write(46).write("list").write(40);const e=this.transforms,r=e.length;if(r>0){t=t.debug(e[0]);for(let i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}return t=t.write(41)}toString(){let t=this.stringValue;if(void 0===t){const e=this.transforms,r=e.length;if(0===r)t="none";else{t=e[0].toString();for(let i=1;i<r;i+=1)t+=" ",t+=e[i].toString()}this.stringValue=t}return t}toAttributeString(){const t=this.transforms,e=t.length;if(0===e)return"";let r=t[0].toAttributeString();for(let i=1;i<e;i+=1)r+=" ",r+=t[i].toAttributeString();return r}static fromLike(t){if(null==t||t instanceof ua)return t;if("string"==typeof t)return ua.parse(t);throw new TypeError(""+t)}static fromValue(t){const e=[];return t.forEach((function(t){const r=zo.fromValue(t.toValue());null!==r&&e.push(r)}),this),0!==e.length?new ua(e):null}static parse(t){const e=zo.parse(t);return e instanceof ua?e:new ua([e])}}const ha=function(t){const e=function(t,r){const i=function(t){const e=i.interpolators,r=e.length,n=new Array(r);for(let i=0;i<r;i+=1)n[i]=e[i](t);return new ua(n)};Object.setPrototypeOf(i,e.prototype);const n=t.transforms,s=r.transforms,o=Math.min(n.length,s.length),a=new Array(o);for(let t=0;t<o;t+=1)a[t]=n[t].interpolateTo(s[t]);return i.interpolators=a,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.interpolators,e=t.length,r=new Array(e);for(let i=0;i<e;i+=1)r[i]=t[i][0];return new ua(r)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.interpolators,e=t.length,r=new Array(e);for(let i=0;i<e;i+=1)r[i]=t[i][1];return new ua(r)},configurable:!0}),e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){const e=this.interpolators.length;if(e!==t.interpolators.length)return!1;for(let r=0;r<e;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}return!1},e}(j);class la extends Nt{constructor(t,e){super(),this.transform=t,this.transformParser=e}feed(t){return la.parse(t,this.transform,this.transformParser)}static parse(t,e=zo.identity(),r){for(;;){if(void 0===r){for(;t.isCont()&&xt.isSpace(t.head());)t.step();if(t.isCont())r=No.parse(t);else if(t.isDone())return Nt.done(e)}if(void 0!==r){if((r=r.feed(t)).isDone()){e=e.transform(r.bind()),r=void 0;continue}if(r.isError())return r.asError()}break}return new la(e,r)}}const ca={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"project","unproject")},da={[Symbol.hasInstance]:t=>t instanceof fa||ma[Symbol.hasInstance](t)||ya[Symbol.hasInstance](t)||xa[Symbol.hasInstance](t)||Ma[Symbol.hasInstance](t)||Pa[Symbol.hasInstance](t)||qa[Symbol.hasInstance](t)||Aa[Symbol.hasInstance](t)||za[Symbol.hasInstance](t)};class fa{union(t){return t=fa.fromLike(t),new ja(Math.min(this.lngMin,t.lngMin),Math.min(this.latMin,t.latMin),Math.max(this.lngMax,t.lngMax),Math.max(this.latMax,t.latMax))}get bounds(){return new ja(this.lngMin,this.latMin,this.lngMax,this.latMax)}static fromLike(t){if(null==t||t instanceof fa)return t;if(ma[Symbol.hasInstance](t))return ga.fromInit(t);if(ya[Symbol.hasInstance](t))return ga.fromTuple(t);if(xa[Symbol.hasInstance](t))return Sa.fromInit(t);if(Ma[Symbol.hasInstance](t))return Oa.fromPoints(t);if(Pa[Symbol.hasInstance](t))return Ia.fromSplines(t);if(qa[Symbol.hasInstance](t))return Fa.fromInit(t);if(Aa[Symbol.hasInstance](t))return Fa.fromTuple(t);if(za[Symbol.hasInstance](t))return ja.fromInit(t);throw new TypeError(""+t)}}const pa={[Symbol.hasInstance]:t=>t instanceof ga||ma[Symbol.hasInstance](t)||ya[Symbol.hasInstance](t)},ma={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"lng","lat")},ya={[Symbol.hasInstance]:t=>Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]};let ga=(()=>{var t;let i,n,a=fa,u=[];return t=class extends a{constructor(t,e){super(),this.lng=t,this.lat=e}isDefined(){return isFinite(this.lng)&&isFinite(this.lat)}get lngMin(){return this.lng}get latMin(){return this.lat}get lngMax(){return this.lng}get latMax(){return this.lat}contains(e,r){return"number"==typeof e?this.lng===e&&this.lat===r:(e=fa.fromLike(e))instanceof t?this.lng===e.lng&&this.lat===e.lat:e instanceof fa&&(this.lng<=e.lngMin&&e.lngMax<=this.lng&&this.lat<=e.latMin&&e.latMax<=this.lat)}intersects(t){return(t=fa.fromLike(t)).intersects(this)}project(t){return t.project(this)}normalized(){const e=this.lng,r=this.lat,i=t.normalizeLng(e),n=t.normalizeLat(r);return e===i&&r===n?this:new t(i,n)}toLike(){return{lng:this.lng,lat:this.lat}}interpolateTo(e){return e instanceof t?wa(this,e):null}equivalentTo(e,r){return this===e||e instanceof t&&(f.equivalent(this.lng,e.lng,r)&&f.equivalent(this.lat,e.lat,r))}equals(e){return this===e||e instanceof t&&(this.lng===e.lng&&this.lat===e.lat)}hashCode(){return s.mash(s.mix(s.mix(g.hash(t),f.hash(this.lng)),f.hash(this.lat)))}debug(t){return t=t.write("GeoPoint").write(46).write("of").write(40).debug(this.lng).write(", ").debug(this.lat).write(41)}toString(){return St.debug(this)}static undefined(){return new t(NaN,NaN)}static origin(){return new t(0,0)}static of(e,r){return new t(e,r)}static fromLike(e){if(null==e||e instanceof t)return e;if(ma[Symbol.hasInstance](e))return t.fromInit(e);if(ya[Symbol.hasInstance](e))return t.fromTuple(e);throw new TypeError(""+e)}static fromInit(e){return new t(e.lng,e.lat)}static fromTuple(e){return new t(e[0],e[1])}static normalized(e,r){return e=t.normalizeLng(e),r=t.normalizeLat(r),new t(e,r)}static normalizeLng(t){return t<-180?t=180-(180-t)%360:t>180&&(t=(t-180)%360-180),t}static normalizeLat(t){return t=Math.min(Math.max(-90+h.Epsilon,t),90-h.Epsilon)}},(()=>{var s;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=a[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:h},null,u),e(t,null,n,{kind:"method",name:"origin",static:!0,private:!1,access:{has:t=>"origin"in t,get:t=>t.origin},metadata:h},null,u),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,u)})(),t})();const wa=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=e.lng,n=e.lat,s=i[1],o=s.lng,a=s.lat;let u;if(r>0&&o<0&&r-o>180){const e=180-r,i=180+o,n=e/(e+i);if(t<n)u=r+t/n*e;else{u=(t-n)/(1-n)*i-180}}else if(r<0&&o>0&&o-r>180){const e=180+r,i=180-o,n=e/(e+i);if(t<n)u=r-t/n*e;else{u=180-(t-n)/(1-n)*i}}else u=r+t*(o-r);return new ga(u,n+t*(a-n))};return Object.setPrototypeOf(i,e.prototype),i[0]=t.normalized(),i[1]=r.normalized(),i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class ba extends fa{}const va={[Symbol.hasInstance]:t=>t instanceof Sa||xa[Symbol.hasInstance](t)},xa={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"lng0","lat0","lng1","lat1")};class Sa extends ba{constructor(t,e,r,i){super(),this.lng0=t,this.lat0=e,this.lng1=r,this.lat1=i}isDefined(){return isFinite(this.lng0)&&isFinite(this.lat0)&&isFinite(this.lng1)&&isFinite(this.lat1)}get lngMin(){return Math.min(this.lng0,this.lng1)}get latMin(){return Math.min(this.lat0,this.lat1)}get lngMax(){return Math.max(this.lng0,this.lng1)}get latMax(){return Math.max(this.lat0,this.lat1)}interpolateLng(t){return(1-t)*this.lng0+t*this.lng1}interpolateLat(t){return(1-t)*this.lat0+t*this.lat1}interpolate(t){const e=1-t,r=e*this.lng0+t*this.lng1,i=e*this.lat0+t*this.lat1;return new ga(r,i)}contains(t,e){return"number"==typeof t?lo.contains(this.lng0,this.lat0,this.lng1,this.lat1,t,e):(t=fa.fromLike(t))instanceof ga?this.containsPoint(t):t instanceof Sa&&this.containsSegment(t)}containsPoint(t){return lo.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng,t.lat)}containsSegment(t){return lo.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng0,t.lat0)&&lo.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng1,t.lat1)}intersects(t){return(t=fa.fromLike(t))instanceof ga?this.intersectsPoint(t):t instanceof Sa?this.intersectsSegment(t):t.intersects(this)}intersectsPoint(t){return lo.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng,t.lat)}intersectsSegment(t){return lo.intersects(this.lng0,this.lat0,this.lng1-this.lat0,this.lng1-this.lat0,t.lng0,t.lat0,t.lng1-t.lat0,t.lng1-t.lat0)}split(t){const e=1-t,r=e*this.lng0+t*this.lng1,i=e*this.lat0+t*this.lat1;return[new Sa(this.lng0,this.lat0,r,i),new Sa(r,i,this.lng1,this.lat1)]}project(t){const e=t.project(this.lng0,this.lat0),r=t.project(this.lng1,this.lat1);return new lo(e.x,e.y,r.x,r.y)}forEachCoord(t,e){let r;return r=t.call(e,this.lng0,this.lat0),void 0!==r?r:(r=t.call(e,this.lng1,this.lat1),void 0!==r?r:void 0)}forEachCoordRest(t,e){const r=t.call(e,this.lng1,this.lat1);if(void 0!==r)return r}toLike(){return{lng0:this.lng0,lat0:this.lat0,lng1:this.lng1,lat1:this.lat1}}interpolateTo(t){return t instanceof Sa?Ca(this,t):null}equivalentTo(t,e){return this===t||t instanceof Sa&&(f.equivalent(this.lng0,t.lng0,e)&&f.equivalent(this.lat0,t.lat0,e)&&f.equivalent(this.lng1,t.lng1,e)&&f.equivalent(this.lat1,t.lat1,e))}equals(t){return this===t||t instanceof Sa&&(this.lng0===t.lng0&&this.lat0===t.lat0&&this.lng1===t.lng1&&this.lat1===t.lat1)}hashCode(){return s.mash(s.mix(s.mix(s.mix(s.mix(g.hash(Sa),f.hash(this.lng0)),f.hash(this.lat0)),f.hash(this.lng1)),f.hash(this.lat1)))}debug(t){return t=t.write("GeoSegment").write(46).write("of").write(40).debug(this.lng0).write(", ").debug(this.lat0).write(", ").debug(this.lng1).write(", ").debug(this.lat1).write(41)}toString(){return St.debug(this)}static of(t,e,r,i){return new Sa(t,e,r,i)}static fromLike(t){if(null==t||t instanceof Sa)return t;if(xa[Symbol.hasInstance](t))return Sa.fromInit(t);throw new TypeError(""+t)}static fromInit(t){return new Sa(t.lng0,t.lat0,t.lng1,t.lat1)}}const Ca=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.lng0+t*(r.lng0-e.lng0),s=e.lat0+t*(r.lat0-e.lat0),o=e.lng1+t*(r.lng1-e.lng1),a=e.lat1+t*(r.lat1-e.lat1);return new Sa(n,s,o,a)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),ka={[Symbol.hasInstance]:t=>t instanceof Oa||Ma[Symbol.hasInstance](t)},Ma={[Symbol.hasInstance]:t=>Array.isArray(t)&&t.length>=2&&pa[Symbol.hasInstance](t[0])};let Oa=(()=>{var t;let i,n=ba,s=[];return t=class extends n{constructor(t,e){super(),this.curves=t,this.closed=e,this.boundingBox=null}isDefined(){return 0!==this.curves.length}isClosed(){return this.closed}get lngMin(){return this.bounds.lngMin}get latMin(){return this.bounds.latMin}get lngMax(){return this.bounds.lngMax}get latMax(){return this.bounds.latMax}interpolateLng(t){const e=this.curves,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolateLng(s)}interpolateLat(t){const e=this.curves,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolateLat(s)}interpolate(t){const e=this.curves,r=e.length;if(0===r)return ga.undefined();const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolate(s)}contains(t,e){return!1}intersects(t){return!1}split(e){const r=this.curves,i=r.length;if(0===i)return[t.empty(),t.empty()];const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i),o=e*i-s*n,[a,u]=r[s].split(o),h=new Array(s+1),l=new Array(i-s);for(let t=0;t<s;t+=1)h[t]=r[t];h[s]=a,l[0]=u;for(let t=s+1;t<i;t+=1)l[t-s]=r[t];return[new t(h,!1),new t(l,!1)]}subdivide(e){const r=this.curves,i=r.length;if(0===i)return t.empty();const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i),o=e*i-s*n,[a,u]=r[s].split(o),h=new Array(i+1);for(let t=0;t<s;t+=1)h[t]=r[t];h[s]=a,h[s+1]=u;for(let t=s+1;t<i;t+=1)h[t+1]=r[t];return new t(h,this.closed)}project(t){const e=this.curves,r=e.length;if(0===r)return vo.empty();let i=0;const n=new Array(r);let s=e[0];if(s instanceof Sa){let o=t.project(s.lng0,s.lat0);for(;i<r&&(s=e[i],s instanceof Sa);){const e=t.project(s.lng1,s.lat1);n[i]=new lo(o.x,o.y,e.x,e.y),o=e,i+=1}}for(;i<r;)s=e[i],n[i]=s.project(t),i+=1;return new vo(n,this.closed)}get bounds(){let t=this.boundingBox;if(null===t){let e=1/0,r=1/0,i=-1/0,n=-1/0;const s=this.curves;for(let t=0;t<s.length;t+=1){const o=s[t];e=Math.min(e,o.lngMin),r=Math.min(r,o.latMin),i=Math.max(o.lngMax,i),n=Math.max(o.latMax,n)}t=new ja(e,r,i,n),this.boundingBox=t}return t}forEachCoord(t,e){const r=this.curves,i=r.length;if(0===i)return;let n=r[0],s=n.forEachCoord(t,e);if(void 0!==s)return s;for(let o=1;o<i;o+=1)if(n=r[o],s=n.forEachCoordRest(t,e),void 0!==s)return s}forEachCoordRest(t,e){const r=this.curves;for(let i=0;i<r.length;i+=1){const n=r[i].forEachCoordRest(t,e);if(void 0!==n)return n}}equivalentTo(e,r){return this===e||e instanceof t&&(w.equivalent(this.curves,e.curves,r)&&this.closed===e.closed)}equals(e){return this===e||e instanceof t&&(w.equal(this.curves,e.curves)&&this.closed===e.closed)}debug(t){const e=this.curves,r=e.length;if(t=t.write("GeoSpline").write(46),0===r)t=t.write("empty").write(40);else if(0!==r){t=(t=t.write(this.closed?"closed":"open").write(40)).debug(e[0]);for(let i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}return t=t.write(41)}toString(){return St.debug(this)}static builder(){return new Ea}static empty(){return new t(w.empty(),!1)}static open(...e){return new t(e,!1)}static closed(...e){return new t(e,!0)}static fromLike(e){if(null==e||e instanceof t)return e;if(Ma[Symbol.hasInstance](e))return t.fromPoints(e);throw new TypeError(""+e)}static fromPoints(e){const r=e.length;if(0===r||1===r)return t.empty();const i=new Array(r-1),n=ga.fromLike(e[0]);let s=n;for(let t=1;t<r;t+=1){const r=ga.fromLike(e[t]);i[t-1]=new Sa(s.lng,s.lat,r.lng,r.lat),s=r}const o=n.equals(s);return new t(i,o)}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class Ea{constructor(){this.curves=[],this.closed=!1,this.aliased=!1,this.lng0=0,this.lat0=0,this.lng=0,this.lat=0}dealias(){this.aliased&&(this.curves=this.curves.slice(0),this.aliased=!1)}moveTo(t,e){this.aliased?(this.curves=[],this.aliased=!1):this.curves.length=0,this.closed=!1,this.lng0=t,this.lat0=e,this.lng=t,this.lat=e}closePath(){this.dealias(),this.curves.push(new Sa(this.lng,this.lat,this.lng0,this.lat0)),this.closed=!0,this.lng=this.lng0,this.lat=this.lat0}lineTo(t,e){this.dealias(),this.curves.push(new Sa(this.lng,this.lat,t,e)),this.lng=t,this.lat=e}build(){return this.aliased=!0,new Oa(this.curves,this.closed)}}const Ta={[Symbol.hasInstance]:t=>t instanceof Ia||Pa[Symbol.hasInstance](t)},Pa={[Symbol.hasInstance]:t=>Array.isArray(t)&&0!==t.length&&Ma[Symbol.hasInstance](t[0])};let Ia=(()=>{var t;let i,n=fa,s=[];return t=class extends n{constructor(t){super(),this.splines=t,this.boundingBox=null}isDefined(){return 0!==this.splines.length}isClosed(){const t=this.splines;if(0===t.length)return!1;for(let e=0;e<t.length;e+=1){if(!t[e].isClosed())return!1}return!0}get lngMin(){return this.bounds.lngMin}get latMin(){return this.bounds.latMin}get lngMax(){return this.bounds.lngMax}get latMax(){return this.bounds.latMax}interpolateLng(t){const e=this.splines,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolateLng(s)}interpolateLat(t){const e=this.splines,r=e.length;if(0===r)return NaN;const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolateLat(s)}interpolate(t){const e=this.splines,r=e.length;if(0===r)return ga.undefined();const i=1/r,n=Math.min(Math.max(0,Math.floor(t/i)),r),s=t*r-n*i;return e[n].interpolate(s)}contains(t,e){return!1}intersects(t){return!1}split(e){const r=this.splines,i=r.length;if(0===i)return[t.empty(),t.empty()];const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i),o=e*i-s*n,[a,u]=r[s].split(o),h=new Array(s+1),l=new Array(i-s);for(let t=0;t<s;t+=1)h[t]=r[t];h[s]=a,l[0]=u;for(let t=s+1;t<i;t+=1)l[t-s]=r[t];return[new t(h),new t(l)]}subdivide(e){const r=this.splines,i=r.length;if(0===i)return t.empty();const n=1/i,s=Math.min(Math.max(0,Math.floor(e/n)),i),o=e*i-s*n,a=new Array(i);for(let t=0;t<s;t+=1)a[t]=r[t];a[s]=r[s].subdivide(o);for(let t=s+1;t<i;t+=1)a[t]=r[t];return new t(a)}project(t){const e=this.splines,r=e.length;if(0===r)return ko.empty();const i=new Array(r);for(let n=0;n<r;n+=1)i[n]=e[n].project(t);return new ko(i)}get bounds(){let t=this.boundingBox;if(null===t){let e=1/0,r=1/0,i=-1/0,n=-1/0;const s=this.splines;for(let t=0;t<s.length;t+=1){const o=s[t];e=Math.min(e,o.lngMin),r=Math.min(r,o.latMin),i=Math.max(o.lngMax,i),n=Math.max(o.latMax,n)}t=new ja(e,r,i,n),this.boundingBox=t}return t}centroid(){let t=0,e=0,r=0;return this.forEachCoord((function(i,n){t+=i,e+=n,r+=1}),this),0===r?ga.undefined():new ga(t/r,e/r)}forEachCoord(t,e){const r=this.splines;for(let i=0;i<r.length;i+=1){const n=r[i].forEachCoord(t,e);if(void 0!==n)return n}}equivalentTo(e,r){return this===e||e instanceof t&&w.equivalent(this.splines,e.splines,r)}equals(e){return this===e||e instanceof t&&w.equal(this.splines,e.splines)}debug(t){const e=this.splines,r=e.length;if(t=t.write("GeoPath").write(46),0===r)t=t.write("empty").write(40);else if(1===r){const r=e[0];t=t.write(r.closed?"closed":"open").write(40);const i=r.curves,n=i.length;if(0!==n){t=t.debug(i[0]);for(let e=1;e<n;e+=1)t=t.write(", ").debug(i[e])}}else{t=(t=t.write("of").write(40)).debug(e[0]);for(let i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}return t=t.write(41)}toString(){return St.debug(this)}static builder(){return new Da}static empty(){return new t(w.empty())}static of(...e){return new t(e)}static open(...e){return new t([new Oa(e,!1)])}static closed(...e){return new t([new Oa(e,!0)])}static fromLike(e){if(null==e||e instanceof t)return e;if(Pa[Symbol.hasInstance](e))return t.fromSplines(e);if(ka[Symbol.hasInstance](e))return t.of(Oa.fromLike(e));throw new TypeError(""+e)}static fromSplines(e){const r=e.length,i=new Array(r);for(let t=0;t<r;t+=1)i[t]=Oa.fromLike(e[t]);return new t(i)}static fromPoints(e){return new t([Oa.fromPoints(e)])}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();class Da{constructor(){this.splines=[],this.builder=null}moveTo(t,e){let r=this.builder;if(null!==r){const t=r.build();t.isDefined()&&this.splines.push(t)}r=new Ea,this.builder=r,r.moveTo(t,e)}closePath(){const t=this.builder;if(null===t)throw new Error;t.closePath()}lineTo(t,e){const r=this.builder;if(null===r)throw new Error;r.lineTo(t,e)}build(){const t=this.splines.slice(0),e=this.builder;if(null!==e){const r=e.build();r.isDefined()&&t.push(r)}return new Ia(t)}}const La={[Symbol.hasInstance]:t=>t instanceof Fa||qa[Symbol.hasInstance](t)||Aa[Symbol.hasInstance](t)},qa={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"x","y","z")},Aa={[Symbol.hasInstance]:t=>Array.isArray(t)&&3===t.length};let Fa=(()=>{var t;let i,n=fa,a=[];return t=class extends n{constructor(t,e,r){super(),this.x=t,this.y=e,this.z=r}isDefined(){return!0}get lngMin(){return t.unprojectX(this.x/(1<<this.z))}get latMin(){return t.unprojectY(this.y/(1<<this.z))}get lngMax(){return t.unprojectX((this.x+1)/(1<<this.z))}get latMax(){return t.unprojectY((this.y+1)/(1<<this.z))}get west(){return this.lngMin}get south(){return this.latMin}get east(){return this.lngMax}get north(){return this.latMax}get southWest(){return new ga(this.lngMin,this.latMin)}get northWest(){return new ga(this.lngMin,this.latMax)}get southEast(){return new ga(this.lngMax,this.latMin)}get northEast(){return new ga(this.lngMax,this.latMax)}get center(){return new ga((this.lngMin+this.lngMax)/2,(this.latMin+this.latMax)/2)}get southWestTile(){return new t(2*this.x,2*this.y,this.z+1)}get northWestTile(){return new t(2*this.x,2*this.y+1,this.z+1)}get southEastTile(){return new t(2*this.x+1,2*this.y,this.z+1)}get northEastTile(){return new t(2*this.x+1,2*this.y+1,this.z+1)}get parentTile(){return new t(this.x>>1,this.y>>1,this.z-1)}contains(e,r){if("number"==typeof e)return this.lngMin<=e&&e<=this.lngMax&&this.latMin<=r&&r<=this.latMax;if(pa[Symbol.hasInstance](e))return this.containsPoint(ga.fromLike(e));if(va[Symbol.hasInstance](e))return this.containsSegment(Sa.fromLike(e));if(La[Symbol.hasInstance](e))return this.containsTile(t.fromLike(e));if(Va[Symbol.hasInstance](e))return this.containsBox(ja.fromLike(e));throw new TypeError(""+e)}containsPoint(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax}containsSegment(t){return this.lngMin<=t.lng0&&t.lng0<=this.lngMax&&this.latMin<=t.lat0&&t.lat0<=this.latMax&&this.lngMin<=t.lng1&&t.lng1<=this.lngMax&&this.latMin<=t.lat1&&t.lat1<=this.latMax}containsTile(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax}containsBox(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax}intersects(e){if(pa[Symbol.hasInstance](e))return this.intersectsPoint(ga.fromLike(e));if(va[Symbol.hasInstance](e))return this.intersectsSegment(Sa.fromLike(e));if(La[Symbol.hasInstance](e))return this.intersectsTile(t.fromLike(e));if(Va[Symbol.hasInstance](e))return this.intersectsBox(ja.fromLike(e));throw new TypeError(""+e)}intersectsPoint(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax}intersectsSegment(t){const e=this.lngMin,r=this.latMin,i=this.lngMax,n=this.latMax,s=t.lng0,o=t.lat0,a=t.lng1,u=t.lat1;return!(s<e&&a<e||s>i&&a>i||o<r&&u<r||o>n&&u>n)&&(s>e&&s<i&&o>r&&o<n||!!(qo.intersectsSegment(s-e,a-e,s,o,a,u)&&qo.hitY>r&&qo.hitY<n||qo.intersectsSegment(o-r,u-r,s,o,a,u)&&qo.hitX>e&&qo.hitX<i||qo.intersectsSegment(s-i,a-i,s,o,a,u)&&qo.hitY>r&&qo.hitY<n||qo.intersectsSegment(o-n,u-n,s,o,a,u)&&qo.hitX>e&&qo.hitX<i))}intersectsTile(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax}intersectsBox(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax}project(t){const e=t.project(this.lngMin,this.latMin),r=t.project(this.lngMax,this.latMax);let i=e.x,n=e.y,s=r.x,o=r.y;if(i>s){const t=i;i=s,s=t}if(n>o){const t=n;n=o,o=t}return isFinite(i)||(i=-1/0),isFinite(n)||(n=-1/0),isFinite(s)||(s=1/0),isFinite(o)||(o=1/0),new qo(i,n,s,o)}toLike(){return{x:this.x,y:this.y,z:this.z}}equivalentTo(e,r){return this===e||e instanceof t&&(f.equivalent(this.x,e.x,r)&&f.equivalent(this.y,e.y,r)&&f.equivalent(this.z,e.z,r))}equals(e){return this===e||e instanceof t&&(this.x===e.x&&this.y===e.y&&this.z===e.z)}hashCode(){return s.mash(s.mix(s.mix(s.mix(g.hash(t),f.hash(this.x)),f.hash(this.y)),f.hash(this.z)))}debug(t){return t=t.write("GeoTile").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(", ").debug(this.z).write(41)}toString(){return St.debug(this)}static root(){return new t(0,0,0)}static of(e,r,i){return new t(e,r,i)}static fromLike(e){if(null==e||e instanceof t)return e;if(qa[Symbol.hasInstance](e))return t.fromInit(e);if(Aa[Symbol.hasInstance](e))return t.fromTuple(e);throw new TypeError(""+e)}static fromInit(e){return new t(e.x,e.y,e.z)}static fromTuple(e){return new t(e[0],e[1],e[2])}static unprojectX(t){return(t*Math.PI*2-Math.PI)*(180/Math.PI)}static unprojectY(t){return(2*Math.atan(Math.exp(t*Math.PI*2-Math.PI))-Math.PI/2)*(180/Math.PI)}},(()=>{var s;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=n[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"root",static:!0,private:!1,access:{has:t=>"root"in t,get:t=>t.root},metadata:u},null,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,a)})(),t})();const Va={[Symbol.hasInstance]:t=>t instanceof ja||za[Symbol.hasInstance](t)},za={[Symbol.hasInstance]:t=>b.hasAllKeys(t,"lngMin","latMin","lngMax","latMax")};let ja=(()=>{var t;let i,n,a=fa,u=[];return t=class extends a{constructor(t,e,r,i){super(),this.lngMin=t,this.latMin=e,this.lngMax=r,this.latMax=i}isDefined(){return isFinite(this.lngMin)&&isFinite(this.latMin)&&isFinite(this.lngMax)&&isFinite(this.latMax)}get west(){return this.lngMin}get south(){return this.latMin}get east(){return this.lngMax}get north(){return this.latMax}get southWest(){return new ga(this.lngMin,this.latMin)}get northWest(){return new ga(this.lngMin,this.latMax)}get southEast(){return new ga(this.lngMax,this.latMin)}get northEast(){return new ga(this.lngMax,this.latMax)}get center(){return new ga((this.lngMin+this.lngMax)/2,(this.latMin+this.latMax)/2)}contains(e,r){if("number"==typeof e)return this.lngMin<=e&&e<=this.lngMax&&this.latMin<=r&&r<=this.latMax;if(pa[Symbol.hasInstance](e))return this.containsPoint(ga.fromLike(e));if(va[Symbol.hasInstance](e))return this.containsSegment(Sa.fromLike(e));if(La[Symbol.hasInstance](e))return this.containsTile(Fa.fromLike(e));if(Va[Symbol.hasInstance](e))return this.containsBox(t.fromLike(e));throw new TypeError(""+e)}containsPoint(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax}containsSegment(t){return this.lngMin<=t.lng0&&t.lng0<=this.lngMax&&this.latMin<=t.lat0&&t.lat0<=this.latMax&&this.lngMin<=t.lng1&&t.lng1<=this.lngMax&&this.latMin<=t.lat1&&t.lat1<=this.latMax}containsTile(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax}containsBox(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax}intersects(e){if(pa[Symbol.hasInstance](e))return this.intersectsPoint(ga.fromLike(e));if(va[Symbol.hasInstance](e))return this.intersectsSegment(Sa.fromLike(e));if(La[Symbol.hasInstance](e))return this.intersectsTile(Fa.fromLike(e));if(Va[Symbol.hasInstance](e))return this.intersectsBox(t.fromLike(e));throw new TypeError(""+e)}intersectsPoint(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax}intersectsSegment(t){const e=this.lngMin,r=this.latMin,i=this.lngMax,n=this.latMax,s=t.lng0,o=t.lat0,a=t.lng1,u=t.lat1;return!(s<e&&a<e||s>i&&a>i||o<r&&u<r||o>n&&u>n)&&(s>e&&s<i&&o>r&&o<n||!!(qo.intersectsSegment(s-e,a-e,s,o,a,u)&&qo.hitY>r&&qo.hitY<n||qo.intersectsSegment(o-r,u-r,s,o,a,u)&&qo.hitX>e&&qo.hitX<i||qo.intersectsSegment(s-i,a-i,s,o,a,u)&&qo.hitY>r&&qo.hitY<n||qo.intersectsSegment(o-n,u-n,s,o,a,u)&&qo.hitX>e&&qo.hitX<i))}intersectsTile(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax}intersectsBox(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax}union(t){return super.union(t)}project(t){const e=t.project(this.lngMin,this.latMin),r=t.project(this.lngMax,this.latMax);let i=e.x,n=e.y,s=r.x,o=r.y;if(i>s){const t=i;i=s,s=t}if(n>o){const t=n;n=o,o=t}return isFinite(i)||(i=-1/0),isFinite(n)||(n=-1/0),isFinite(s)||(s=1/0),isFinite(o)||(o=1/0),new qo(i,n,s,o)}get bounds(){return this}toLike(){return{lngMin:this.lngMin,latMin:this.latMin,lngMax:this.lngMax,latMax:this.latMax}}interpolateTo(e){return e instanceof t?Na(this,e):null}equivalentTo(e,r){return this===e||e instanceof t&&(f.equivalent(this.lngMin,e.lngMin,r)&&f.equivalent(this.latMin,e.latMin,r)&&f.equivalent(this.lngMax,e.lngMax,r)&&f.equivalent(this.latMax,e.latMax,r))}equals(e){return this===e||e instanceof t&&(this.lngMin===e.lngMin&&this.latMin===e.latMin&&this.lngMax===e.lngMax&&this.latMax===e.latMax)}hashCode(){return s.mash(s.mix(s.mix(s.mix(s.mix(g.hash(t),f.hash(this.lngMin)),f.hash(this.latMin)),f.hash(this.lngMax)),f.hash(this.latMax)))}debug(t){return t=t.write("GeoBox").write(46).write("of").write(40).debug(this.lngMin).write(", ").debug(this.latMin).write(", ").debug(this.lngMax).write(", ").debug(this.latMax).write(41)}toString(){return St.debug(this)}static undefined(){return new t(1/0,1/0,-1/0,-1/0)}static globe(){return new t(-180,-90,180,90)}static of(e,r,i,n){return void 0===i&&(i=e),void 0===n&&(n=r),new t(e,r,i,n)}static fromLike(e){if(null==e||e instanceof t)return e;if(za[Symbol.hasInstance](e))return t.fromInit(e);throw new TypeError(""+e)}static fromInit(e){return new t(e.lngMin,e.latMin,e.lngMax,e.latMax)}},(()=>{var s;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(s=a[Symbol.metadata])&&void 0!==s?s:null):void 0;i=[o],n=[o],e(t,null,i,{kind:"method",name:"undefined",static:!0,private:!1,access:{has:t=>"undefined"in t,get:t=>t.undefined},metadata:h},null,u),e(t,null,n,{kind:"method",name:"globe",static:!0,private:!1,access:{has:t=>"globe"in t,get:t=>t.globe},metadata:h},null,u),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),r(t,u)})(),t})();const Na=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.lngMin+t*(r.lngMin-e.lngMin),s=e.latMin+t*(r.latMin-e.latMin),o=e.lngMax+t*(r.lngMax-e.lngMax),a=e.latMax+t*(r.latMax-e.latMax);return new ja(n,s,o,a)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);let Ua=(()=>{var t;let i,n=fa,s=[];return t=class extends n{constructor(t){super(),this.shapes=t,this.boundingBox=null}isDefined(){return 0!==this.shapes.length}get lngMin(){return this.bounds.lngMin}get latMin(){return this.bounds.latMin}get lngMax(){return this.bounds.lngMax}get latMax(){return this.bounds.latMax}contains(t,e){return!1}intersects(t){return!1}project(t){const e=this.shapes,r=e.length;if(0===r)return Fo.empty();const i=new Array(r);for(let n=0;n<r;n+=1)i[n]=e[n].project(t);return new Fo(i)}get bounds(){let t=this.boundingBox;if(null===t){let e=1/0,r=1/0,i=-1/0,n=-1/0;const s=this.shapes;for(let t=0;t<s.length;t+=1){const o=s[t];e=Math.min(e,o.lngMin),r=Math.min(r,o.latMin),i=Math.max(o.lngMax,i),n=Math.max(o.latMax,n)}t=new ja(e,r,i,n),this.boundingBox=t}return t}equivalentTo(e,r){return this===e||e instanceof t&&w.equivalent(this.shapes,e.shapes,r)}equals(e){return this===e||e instanceof t&&w.equal(this.shapes,e.shapes)}debug(t){const e=this.shapes,r=e.length;if(t=t.write("GeoGroup").write(46),0===r)t=t.write("empty").write(40);else{t=(t=t.write("of").write(40)).debug(e[0]);for(let i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}return t=t.write(41)}toString(){return St.debug(this)}static empty(){return new t(w.empty())}static of(...e){return new t(e)}},(()=>{var a;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[o],e(t,null,i,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:u},null,s),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),r(t,s)})(),t})();const Ra={[Symbol.hasInstance]:t=>Array.isArray(t)&&(2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]||3===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2])},Ba={toShape:function(t){return"Feature"===t.type?Ja.toShape(t):"FeatureCollection"===t.type?$a.toShapes(t):Ya.toShape(t)},[Symbol.hasInstance]:t=>Ya[Symbol.hasInstance](t)||Ja[Symbol.hasInstance](t)||$a[Symbol.hasInstance](t)},Ya={toShape(t){if("Point"===t.type)return Ha.toShape(t);if("MultiPoint"===t.type)return Wa.toShape(t);if("LineString"===t.type)return Xa.toShape(t);if("MultiLineString"===t.type)return Ka.toShape(t);if("Polygon"===t.type)return Ga.toShape(t);if("MultiPolygon"===t.type)return Za.toShape(t);if("GeometryCollection"===t.type)return Qa.toShape(t);throw new TypeError(""+t)},[Symbol.hasInstance]:t=>Ha[Symbol.hasInstance](t)||Wa[Symbol.hasInstance](t)||Xa[Symbol.hasInstance](t)||Ka[Symbol.hasInstance](t)||Ga[Symbol.hasInstance](t)||Za[Symbol.hasInstance](t)||Qa[Symbol.hasInstance](t)},Ha={toShape(t){const e=t.coordinates;return new ga(e[0],e[1])},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"Point"===t.type&&Ra[Symbol.hasInstance](t.coordinates)},Wa={toShape(t){const e=t.coordinates,r=e.length,i=new Array(r);for(let t=0;t<r;t+=1){const r=e[t];i[t]=new ga(r[0],r[1])}return new Ua(i)},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"MultiPoint"===t.type&&Array.isArray(t.coordinates)},Xa={toShape(t){const e=t.coordinates,r=e.length;if(0===r)return Oa.empty();const i=new Array(r-1);let n=e[0],s=n[0],o=n[1];for(let t=1;t<r;t+=1)n=e[t],i[t-1]=new Sa(s,o,(s=n[0],s),(o=n[1],o));return new Oa(i,!1)},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"LineString"===t.type&&Array.isArray(t.coordinates)},Ka={toShape(t){const e=t.coordinates,r=e.length,i=new Array(r);for(let t=0;t<r;t+=1){const r=e[t],n=r.length;if(0===n){i[t]=Oa.empty();continue}const s=new Array(n-1);let o=r[0],a=o[0],u=o[1];for(let t=1;t<n;t+=1)o=r[t],s[t-1]=new Sa(a,u,(a=o[0],a),(u=o[1],u));i[t]=new Oa(s,!1)}return new Ua(i)},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"MultiLineString"===t.type&&Array.isArray(t.coordinates)},Ga={toShape(t){const e=t.coordinates,r=e.length,i=new Array(r);for(let t=0;t<r;t+=1){const r=e[t],n=r.length;if(0===n){i[t]=Oa.empty();continue}const s=new Array(n-1);let o=r[0],a=o[0],u=o[1];for(let t=1;t<n;t+=1)o=r[t],s[t-1]=new Sa(a,u,(a=o[0],a),(u=o[1],u));i[t]=new Oa(s,!0)}return new Ia(i)},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"Polygon"===t.type&&Array.isArray(t.coordinates)},Za={toShape(t){const e=t.coordinates,r=e.length,i=new Array(r);for(let t=0;t<r;t+=1){const r=e[t],n=r.length,s=new Array(n);for(let t=0;t<n;t+=1){const e=r[t],i=e.length;if(0===i){s[t]=Oa.empty();continue}const n=new Array(i-1);let o=e[0],a=o[0],u=o[1];for(let t=1;t<i;t+=1)o=e[t],n[t-1]=new Sa(a,u,(a=o[0],a),(u=o[1],u));s[t]=new Oa(n,!0)}i[t]=new Ia(s)}return new Ua(i)},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"MultiPolygon"===t.type&&Array.isArray(t.coordinates)},Qa={toShape(t){const e=t.geometries,r=e.length,i=new Array(r);for(let t=0;t<r;t+=1)i[t]=Ya.toShape(e[t]);return new Ua(i)},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"GeometryCollection"===t.type&&Array.isArray(t.geometries)},Ja={toShape(t){const e=t.geometry;return null!==e?Ya.toShape(e):null},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"Feature"===t.type&&Ya[Symbol.hasInstance](t.geometry)&&"object"==typeof t.properties},$a={toShapes(t){const e=t.features,r=e.length,i=new Array(r);for(let t=0;t<r;t+=1)i[t]=Ja.toShape(e[t]);return i},[Symbol.hasInstance]:t=>null!==t&&"object"==typeof t&&"FeatureCollection"===t.type&&Array.isArray(t.features)},_a={[Symbol.hasInstance]:t=>t instanceof tu||"string"==typeof t||"number"==typeof t};let tu=(()=>{var t;let i,n,a,u=[];return t=class{constructor(t,e){this.name=t,this.offset=e}isUTC(){return 0===this.offset}isLocal(){return this.offset===-(new Date).getTimezoneOffset()}equals(e){return this===e||e instanceof t&&this.offset===e.offset}hashCode(){return s.mash(s.mix(g.hash(t),f.hash(this.offset)))}debug(t){return t=t.write("TimeZone").write(46),t=(t="UTC"===this.name&&0===this.offset?t.write("utc").write(40):void 0===this.name?t.write("forOffset").write(40).debug(this.offset):t.write("create").write(40).debug(this.name).write(", ").debug(this.offset)).write(41)}toString(){return St.debug(this)}static utc(){return new t("UTC",0)}static local(){return this.forOffset(-(new Date).getTimezoneOffset())}static create(e,r){return"UTC"===e&&0===r?t.utc():new t(e,r)}static forName(e){return"UTC"===e?t.utc():null}static forOffset(e){return 0===e?t.utc():new t(void 0,e)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e){const r=t.forName(e);if(null!==r)return r}else if("number"==typeof e)return t.forOffset(e);throw new TypeError(""+e)}static fromValue(e){const r=e.stringValue(void 0);if(void 0!==r)return t.forName(r);const i=e.numberValue(void 0);return void 0!==i?t.forOffset(i):null}static form(){return new eu(t.utc())}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],n=[o],a=[o],e(t,null,i,{kind:"method",name:"utc",static:!0,private:!1,access:{has:t=>"utc"in t,get:t=>t.utc},metadata:s},null,u),e(t,null,n,{kind:"method",name:"local",static:!0,private:!1,access:{has:t=>"local"in t,get:t=>t.local},metadata:s},null,u),e(t,null,a,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:s},null,u),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,u)})(),t})();class eu extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new eu(t)}mold(t){const e=(t=tu.fromLike(t)).name;return void 0!==e?kr.from(e):Or.from(t.offset)}cast(t){const e=t.toValue(),r=tu.fromValue(e);return null!==r?r:void 0}}const ru={[Symbol.hasInstance]:t=>t instanceof nu||t instanceof Date||iu[Symbol.hasInstance](t)||"string"==typeof t||"number"==typeof t},iu={[Symbol.hasInstance]:t=>b.hasAnyKey(t,"time","year","month","day","hour","minute","second","millisecond")};let nu=(()=>{var t;let i,n=[];return t=class{constructor(t,e=tu.utc()){this.time=t,this.zone=e}isDefined(){return isFinite(new Date(this.time).getTime())}get year(){return this.toUTCLocalDate().getUTCFullYear()}withYear(e,r,i,n,s,o,a){const u=this.toUTCLocalDate();return u.setUTCFullYear(e),void 0!==r&&u.setUTCMonth(r),void 0!==i&&u.setUTCDate(i),void 0!==n&&u.setUTCHours(n),void 0!==s&&u.setUTCMinutes(s),void 0!==o&&u.setUTCSeconds(o),void 0!==a&&u.setUTCMilliseconds(a),t.fromUTCLocalDate(u,this.zone)}get month(){return this.toUTCLocalDate().getUTCMonth()}withMonth(e,r,i,n,s,o){const a=this.toUTCLocalDate();return a.setUTCMonth(e),void 0!==r&&a.setUTCDate(r),void 0!==i&&a.setUTCHours(i),void 0!==n&&a.setUTCMinutes(n),void 0!==s&&a.setUTCSeconds(s),void 0!==o&&a.setUTCMilliseconds(o),t.fromUTCLocalDate(a,this.zone)}get day(){return this.toUTCLocalDate().getUTCDate()}withDay(e,r,i,n,s){const o=this.toUTCLocalDate();return o.setUTCDate(e),void 0!==r&&o.setUTCHours(r),void 0!==i&&o.setUTCMinutes(i),void 0!==n&&o.setUTCSeconds(n),void 0!==s&&o.setUTCMilliseconds(s),t.fromUTCLocalDate(o,this.zone)}get hour(){return this.toUTCLocalDate().getUTCHours()}withHour(e,r,i,n){const s=this.toUTCLocalDate();return s.setUTCHours(e),void 0!==r&&s.setUTCMinutes(r),void 0!==i&&s.setUTCSeconds(i),void 0!==n&&s.setUTCMilliseconds(n),t.fromUTCLocalDate(s,this.zone)}get minute(){return this.toUTCLocalDate().getUTCMinutes()}withMinute(e,r,i){const n=this.toUTCLocalDate();return n.setUTCMinutes(e),void 0!==r&&n.setUTCSeconds(r),void 0!==i&&n.setUTCMilliseconds(i),t.fromUTCLocalDate(n,this.zone)}get second(){return this.toUTCLocalDate().getUTCSeconds()}withSecond(e,r){const i=this.toUTCLocalDate();return i.setUTCSeconds(e),void 0!==r&&i.setUTCMilliseconds(r),t.fromUTCLocalDate(i,this.zone)}get millisecond(){return this.toUTCLocalDate().getUTCMilliseconds()}withMillisecond(e){const r=this.toUTCLocalDate();return r.setUTCMilliseconds(e),t.fromUTCLocalDate(r,this.zone)}get weekday(){return this.toUTCLocalDate().getUTCDay()}toUTCLocalDate(){return new Date(this.time+6e4*this.zone.offset)}toDate(){return new Date(this.time)}valueOf(){return this.time}interpolateTo(e){return e instanceof t?su(this,e):null}compareTo(e){if(e instanceof t){const t=this.time,r=e.time;return t<r?-1:t>r?1:t===r?0:NaN}return NaN}equivalentTo(e,r){return this===e||e instanceof t&&f.equivalent(this.time,e.time,r)}equals(e){return this===e||e instanceof t&&(this.time===e.time&&this.zone.equals(e.zone))}hashCode(){return s.mash(s.mix(s.mix(g.hash(t),f.hash(this.time)),this.zone.hashCode()))}display(t,e=lu.iso8601()){return t=e.writeDate(t,this)}toString(t=lu.iso8601()){return t.format(this)}static current(e){return e=void 0!==e?tu.fromLike(e):tu.local(),new t(Date.now(),e)}static fromUTCLocalDate(e,r){return new t(e.getTime()-6e4*r.offset,r)}static fromLike(e,r){if(null==e||e instanceof t)return e;if(e instanceof Date)return r=void 0!==r?tu.fromLike(r):tu.utc(),new t(e.getTime(),r);if("number"==typeof e)return r=void 0!==r?tu.fromLike(r):tu.utc(),new t(e,r);if("string"==typeof e)return t.parse(e,r);if(iu[Symbol.hasInstance](e))return t.fromInit(e,r);throw new TypeError(""+e)}static fromInit(e,r){let i=e.time;return void 0===i&&(i=Date.UTC(void 0!==e.year?e.year:1970,void 0!==e.month?e.month:0,void 0!==e.day?e.day:1,void 0!==e.hour?e.hour:0,void 0!==e.minute?e.minute:0,void 0!==e.second?e.second:0,void 0!==e.millisecond?e.millisecond:0)),void 0===(r=tu.fromLike(e.zone))?r=tu.utc():i+=6e4*r.offset,new t(i,r)}static fromValue(e){let r;const i=e.header("date");i.isDefined()?(e=i,r=!0):r=!1;const n={};return e.forEach((function(t,e){const i=t.key.stringValue(void 0);void 0!==i?"year"===i?n.year=t.toValue().numberValue(n.year):"month"===i?n.month=t.toValue().numberValue(n.month):"day"===i?n.day=t.toValue().numberValue(n.day):"hour"===i?n.hour=t.toValue().numberValue(n.hour):"minute"===i?n.minute=t.toValue().numberValue(n.minute):"second"===i?n.second=t.toValue().numberValue(n.second):"millisecond"===i?n.millisecond=t.toValue().numberValue(n.millisecond):"zone"===i&&(n.zone=t.toValue().cast(tu.form(),n.zone)):t instanceof mr&&r&&(0===e?n.year=t.numberValue(n.year):1===e?n.month=t.numberValue(n.month):2===e?n.day=t.numberValue(n.day):3===e?n.hour=t.numberValue(n.hour):4===e?n.minute=t.numberValue(n.minute):5===e?n.second=t.numberValue(n.second):6===e?n.millisecond=t.numberValue(n.millisecond):7===e&&(n.zone=t.cast(tu.form(),n.zone)))})),iu[Symbol.hasInstance](n)?t.fromInit(n):null}static parse(t,e){return lu.iso8601().parse(t)}static time(e){if(e instanceof t)return e.time;if(e instanceof Date)return e.getTime();if("number"==typeof e)return e;if("string"==typeof e)return t.parse(e).time;if(iu[Symbol.hasInstance](e))return t.fromInit(e).time;throw new TypeError(""+e)}static zone(e){return e instanceof t?e.zone:tu.utc()}static form(){return new ou(new t(0))}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t})();const su=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1];return new nu(e.time+t*(r.time-e.time),r.zone)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);class ou extends Oi{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new ou(t)}mold(t){return t=nu.fromLike(t),kr.from(t.toString())}cast(t){let e=null;try{if(e=nu.fromValue(t),void 0===e){const r=t.numberValue(void 0);if(void 0!==r)e=new nu(r);else{const r=t.stringValue(void 0);void 0!==r&&(e=nu.parse(r))}}}catch(t){}return null!==e?e:void 0}}class au extends Nt{constructor(t){super(),this.dateParser=t}feed(t){return au.parse(t,this.dateParser)}static parse(t,e){return(e=e.feed(t)).isDone()?Nt.done(nu.fromLike(e.bind())):e.isError()?e.asError():new au(e)}}let uu=(()=>{var t;let i,n=[];return t=class{constructor(e=t.Periods,r=t.Weekdays,i=t.ShortWeekdays,n=t.Months,s=t.ShortMonths){this.periods=e,this.weekdays=r,this.shortWeekdays=i,this.months=n,this.shortMonths=s}static standard(){return new t}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;i=[o],e(t,null,i,{kind:"method",name:"standard",static:!0,private:!1,access:{has:t=>"standard"in t,get:t=>t.standard},metadata:s},null,n),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),r(t,n)})(),t.Periods=["AM","PM"],t.Weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.ShortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.ShortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t})();const hu=function(){const t={};let e=null;return t.standard=function(t){let r=null;return void 0===t&&(t=uu.standard()),t===uu.standard()&&(r=e),null===r&&(r={Y:lu.year(),m:lu.monthOfYear(),B:lu.month(t),b:lu.shortMonth(t),d:lu.dayOfMonth(48),e:lu.dayOfMonth(32),A:lu.weekday(t),a:lu.shortWeekday(t),H:lu.hour24(),I:lu.hour12(48),i:lu.hour12(32),p:lu.period(t),M:lu.minute(),S:lu.second(),L:lu.millisecond()},t===uu.standard()&&(e=r)),r},t}();class lu{withLocale(t){return this}format(t){t=nu.fromLike(t);let e=xt.stringOutput();return e=this.writeDate(e,t),e.bind()}parse(t){for("string"==typeof t&&(t=xt.stringInput(t));t.isCont()&&xt.isSpace(t.head());)t=t.step();let e=this.parseDate(t,{});if(e.isDone())for(;t.isCont()&&xt.isSpace(t.head());)t=t.step();return t.isCont()&&!e.isError()&&(e=Nt.error(kt.unexpected(t))),e.bind()}parseDate(t,e){const r=this.parseDateTime(t,e);return r.isDone()?Nt.done(nu.fromLike(r.bind())):r.isError()?r.asError():new au(r)}static year(){return null===this.Year&&(this.Year=new cu),this.Year}static monthOfYear(){return null===this.MonthOfYear&&(this.MonthOfYear=new du),this.MonthOfYear}static month(t){return void 0!==t&&t!==uu.standard()?new fu(t):(null===this.Month&&(this.Month=new fu(uu.standard())),this.Month)}static shortMonth(t){return void 0!==t&&t!==uu.standard()?new pu(t):(null===this.ShortMonth&&(this.ShortMonth=new pu(uu.standard())),this.ShortMonth)}static dayOfMonth(t){return void 0===t||48===t?(null===this.DayOfMonthZeroPadded&&(this.DayOfMonthZeroPadded=new mu(48)),this.DayOfMonthZeroPadded):32===t?(null===this.DayOfMonthSpacePadded&&(this.DayOfMonthSpacePadded=new mu(32)),this.DayOfMonthSpacePadded):new mu(t)}static weekday(t){return void 0!==t&&t!==uu.standard()?new yu(t):(null===this.Weekday&&(this.Weekday=new yu(uu.standard())),this.Weekday)}static shortWeekday(t){return void 0!==t&&t!==uu.standard()?new gu(t):(null===this.ShortWeekday&&(this.ShortWeekday=new gu(uu.standard())),this.ShortWeekday)}static hour24(){return null===this.Hour24&&(this.Hour24=new wu),this.Hour24}static hour12(t){return void 0===t||48===t?(null===this.Hour12ZeroPadded&&(this.Hour12ZeroPadded=new bu(48)),this.Hour12ZeroPadded):32===t?(null===this.Hour12SpacePadded&&(this.Hour12SpacePadded=new bu(32)),this.Hour12SpacePadded):new bu(t)}static period(t){return void 0!==t&&t!==uu.standard()?new vu(t):(null===this.Period&&(this.Period=new vu(uu.standard())),this.Period)}static minute(){return null===this.Minute&&(this.Minute=new xu),this.Minute}static second(){return null===this.Second&&(this.Second=new Su),this.Second}static millisecond(){return null===this.Millisecond&&(this.Millisecond=new Cu),this.Millisecond}static pattern(t,e){return(void 0===e||e instanceof uu)&&(e=hu.standard(e)),new ku(t,e)}static iso8601(){return null===this.Iso8601&&(this.Iso8601=new ku("%Y-%m-%dT%H:%M:%S.%LZ",hu.standard())),this.Iso8601}static parseDateNumber(t,e,r,i,n,s,o=0,a=0){let u=0;for(;a<n&&t.isCont()&&(u=t.head(),Ct.isDigit(u));)t.step(),o=10*o+Ct.decodeDigit(u),a+=1;return t.isEmpty()?e.cont(void 0!==s?s:{},o,a,t):a>=i?e.term(o,s||{},t):Nt.error(kt.expected(r,t))}static parseDateString(t,e,r,i,n){let s=0;for(n=void 0!==n?n:xt.stringOutput();;){if(!t.isCont()||(s=t.head(),!xt.isAlpha(s))){if(!t.isEmpty())return e.term(r,n.bind(),void 0!==i?i:{},t);break}t.step(),n.write(s)}return e.cont(r,void 0!==i?i:{},n,t)}static writeDateNumber2(t,e,r){void 0===r&&(r=48);const i=Math.floor(e%10);e/=10;const n=Math.floor(e%10);return t=(t=t.write(0!==n?48+n:r)).write(48+i)}static writeDateNumber3(t,e,r){void 0===r&&(r=48);const i=Math.floor(e%10);e/=10;const n=Math.floor(e%10);e/=10;const s=Math.floor(e%10);return t=(t=(t=t.write(0!==s?48+s:r)).write(0!==n?48+n:r)).write(48+i)}static writeDateNumber4(t,e,r){void 0===r&&(r=48);const i=Math.floor(e%10);e/=10;const n=Math.floor(e%10);e/=10;const s=Math.floor(e%10);e/=10;const o=Math.floor(e%10);return t=(t=(t=(t=t.write(0!==o?48+o:r)).write(0!==s?48+s:r)).write(0!==n?48+n:r)).write(48+i)}}lu.Year=null,lu.MonthOfYear=null,lu.Month=null,lu.ShortMonth=null,lu.DayOfMonthZeroPadded=null,lu.DayOfMonthSpacePadded=null,lu.Weekday=null,lu.ShortWeekday=null,lu.Hour24=null,lu.Hour12ZeroPadded=null,lu.Hour12SpacePadded=null,lu.Period=null,lu.Minute=null,lu.Second=null,lu.Millisecond=null,lu.Iso8601=null;class cu extends lu{writeDate(t,e){return t=lu.writeDateNumber4(t,e.year)}parseDateTime(t,e){return Mu.parse(t,e)}}class du extends lu{writeDate(t,e){return t=lu.writeDateNumber2(t,e.month+1)}parseDateTime(t,e){return Ou.parse(t,e)}}class fu extends lu{constructor(t){super(),this.locale=t}withLocale(t){return t===this.locale?this:new fu(t)}writeDate(t,e){return t=t.write(this.locale.months[e.month])}parseDateTime(t,e){return Eu.parse(t,this.locale,e)}}class pu extends lu{constructor(t){super(),this.locale=t}withLocale(t){return t===this.locale?this:new pu(t)}writeDate(t,e){return t=t.write(this.locale.shortMonths[e.month])}parseDateTime(t,e){return Tu.parse(t,this.locale,e)}}class mu extends lu{constructor(t){super(),this.padChar=t}writeDate(t,e){return t=lu.writeDateNumber2(t,e.day,this.padChar)}parseDateTime(t,e){return Pu.parse(t,e)}}class yu extends lu{constructor(t){super(),this.locale=t}withLocale(t){return t===this.locale?this:new yu(t)}writeDate(t,e){return t=t.write(this.locale.weekdays[e.weekday])}parseDateTime(t,e){return Iu.parse(t,this.locale,e)}}class gu extends lu{constructor(t){super(),this.locale=t}withLocale(t){return t===this.locale?this:new gu(t)}writeDate(t,e){return t=t.write(this.locale.shortWeekdays[e.weekday])}parseDateTime(t,e){return Du.parse(t,this.locale,e)}}class wu extends lu{writeDate(t,e){return t=lu.writeDateNumber2(t,e.hour)}parseDateTime(t,e){return Lu.parse(t,e)}}class bu extends lu{constructor(t){super(),this.padChar=t}writeDate(t,e){let r=e.hour%12;return 0===r&&(r=12),t=lu.writeDateNumber2(t,r,this.padChar)}parseDateTime(t,e){return qu.parse(t,e)}}class vu extends lu{constructor(t){super(),this.locale=t}withLocale(t){return t===this.locale?this:new vu(t)}writeDate(t,e){return t=t.write(this.locale.periods[e.hour>=12?1:0])}parseDateTime(t,e){return Au.parse(t,this.locale,e)}}class xu extends lu{writeDate(t,e){return t=lu.writeDateNumber2(t,e.minute)}parseDateTime(t,e){return Fu.parse(t,e)}}class Su extends lu{writeDate(t,e){return t=lu.writeDateNumber2(t,e.second)}parseDateTime(t,e){return Vu.parse(t,e)}}class Cu extends lu{writeDate(t,e){return t=lu.writeDateNumber3(t,e.millisecond)}parseDateTime(t,e){return zu.parse(t,e)}}class ku extends lu{constructor(t,e){super(),this.pattern=t,this.specifiers=e}writeDate(t,e){const r=this.pattern,i=this.specifiers;let n=0,s=0;for(;s<r.length;){if(37!==r.charCodeAt(s)){s+=1;continue}n!==s&&(t=t.write(r.slice(n,s)));const o=i[r.charAt(s+1)];void 0!==o&&(t=o.writeDate(t,e)),s+=2,n=s}return n!==s&&(t=t.write(r.slice(n,s))),t}parseDateTime(t,e){return ju.parse(t,this.pattern,this.specifiers,e)}}class Mu extends Nt{constructor(t,e,r){super(),this.date=t,this.year=e,this.step=r}feed(t){return Mu.parse(t,this.date,this.year,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,Mu,"full year",4,4,e,r,i)}static term(t,e){return e.year=t,Nt.done(e)}static cont(t,e,r){return new Mu(t,e,r)}}class Ou extends Nt{constructor(t,e,r){super(),this.date=t,this.month=e,this.step=r}feed(t){return Ou.parse(t,this.date,this.month,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,Ou,"month number",2,2,e,r,i)}static term(t,e){return e.month=t-1,Nt.done(e)}static cont(t,e,r){return new Ou(t,e,r)}}class Eu extends Nt{constructor(t,e,r){super(),this.locale=t,this.date=e,this.output=r}feed(t){return Eu.parse(t,this.locale,this.date,this.output)}static parse(t,e,r,i){return lu.parseDateString(t,Eu,e,r,i)}static term(t,e,r,i){const n=t.months.indexOf(e);return n<0?Nt.error(kt.message("expected month, but found "+e,i)):(r.month=n,Nt.done(r))}static cont(t,e,r){return new Eu(t,e,r)}}class Tu extends Nt{constructor(t,e,r){super(),this.locale=t,this.date=e,this.output=r}feed(t){return Tu.parse(t,this.locale,this.date,this.output)}static parse(t,e,r,i){return lu.parseDateString(t,Tu,e,r,i)}static term(t,e,r,i){const n=t.shortMonths.indexOf(e);return n<0?Nt.error(kt.message("expected short month, but found "+e,i)):(r.month=n,Nt.done(r))}static cont(t,e,r){return new Tu(t,e,r)}}class Pu extends Nt{constructor(t,e,r){super(),this.date=t,this.day=e,this.step=r}feed(t){return Pu.parse(t,this.date,this.day,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,Pu,"day of month",2,2,e,r,i)}static term(t,e){return e.day=t,Nt.done(e)}static cont(t,e,r){return new Pu(t,e,r)}}class Iu extends Nt{constructor(t,e,r){super(),this.locale=t,this.date=e,this.output=r}feed(t){return Iu.parse(t,this.locale,this.date,this.output)}static parse(t,e,r,i){return lu.parseDateString(t,Iu,e,r,i)}static term(t,e,r,i){return t.weekdays.indexOf(e)<0?Nt.error(kt.message("expected weekday, but found "+e,i)):Nt.done(r)}static cont(t,e,r){return new Iu(t,e,r)}}class Du extends Nt{constructor(t,e,r){super(),this.locale=t,this.date=e,this.output=r}feed(t){return Du.parse(t,this.locale,this.date,this.output)}static parse(t,e,r,i){return lu.parseDateString(t,Du,e,r,i)}static term(t,e,r,i){return t.shortWeekdays.indexOf(e)<0?Nt.error(kt.message("expected short weekday, but found "+e,i)):Nt.done(r)}static cont(t,e,r){return new Du(t,e,r)}}class Lu extends Nt{constructor(t,e,r){super(),this.date=t,this.hour=e,this.step=r}feed(t){return Lu.parse(t,this.date,this.hour,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,Lu,"hour (24)",2,2,e,r,i)}static term(t,e){return e.hour=t,Nt.done(e)}static cont(t,e,r){return new Lu(t,e,r)}}class qu extends Nt{constructor(t,e,r){super(),this.date=t,this.hour=e,this.step=r}feed(t){return qu.parse(t,this.date,this.hour,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,qu,"hour (12)",2,2,e,r,i)}static term(t,e){return e.hour=(void 0!==e.hour?e.hour:0)+t,Nt.done(e)}static cont(t,e,r){return new qu(t,e,r)}}class Au extends Nt{constructor(t,e,r){super(),this.locale=t,this.date=e,this.output=r}feed(t){return Au.parse(t,this.locale,this.date,this.output)}static parse(t,e,r,i){return lu.parseDateString(t,Au,e,r,i)}static term(t,e,r,i){const n=t.months.indexOf(e);return n<0?Nt.error(kt.message("expected period of day, but found "+e,i)):(r.hour=(r.hour||0)+12*n,Nt.done(r))}static cont(t,e,r){return new Au(t,e,r)}}class Fu extends Nt{constructor(t,e,r){super(),this.date=t,this.minute=e,this.step=r}feed(t){return Fu.parse(t,this.date,this.minute,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,Fu,"minute",2,2,e,r,i)}static term(t,e){return e.minute=t,Nt.done(e)}static cont(t,e,r){return new Fu(t,e,r)}}class Vu extends Nt{constructor(t,e,r){super(),this.date=t,this.second=e,this.step=r}feed(t){return Vu.parse(t,this.date,this.second,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,Vu,"second",2,2,e,r,i)}static term(t,e){return e.second=t,Nt.done(e)}static cont(t,e,r){return new Vu(t,e,r)}}class zu extends Nt{constructor(t,e,r){super(),this.date=t,this.millisecond=e,this.step=r}feed(t){return zu.parse(t,this.date,this.millisecond,this.step)}static parse(t,e,r,i){return lu.parseDateNumber(t,zu,"millisecond",1,3,e,r,i)}static term(t,e){return e.millisecond=t,Nt.done(e)}static cont(t,e,r){return new zu(t,e,r)}}class ju extends Nt{constructor(t,e,r,i,n){super(),this.pattern=t,this.specifiers=e,this.date=r,this.dateParser=i,this.step=n}feed(t){return ju.parse(t,this.pattern,this.specifiers,this.date,this.dateParser,this.step)}static parse(t,e,r,i={},n,s=0){let o=0;const a=e.length;for(;s<a;){const a=e.charCodeAt(s);if(37===a){if(void 0===n){const o=e.charAt(s+1),a=r[o];if(void 0===a)return Nt.error(kt.message("unknown format specifier: "+o,t));n=a.parseDateTime(t,i)}else n=n.feed(t);if(n.isDone()){i=n.bind(),n=void 0,s+=2;continue}if(n.isError())return n.asError()}else{if(t.isCont()){if(o=t.head(),o===a){t.step(),s+=1;continue}return Nt.error(kt.expected(a,t))}if(!t.isEmpty())return Nt.error(kt.unexpected(t))}break}return s===a?Nt.done(i):new ju(e,r,i,n,s)}}var Nu;class Uu{next(t,e){return this.floor(this.offset(t,e))}ceil(t){return t=t instanceof nu?new nu(t.time-1,t.zone):nu.time(t)-1,this.next(this.floor(t),1)}round(t){const e=nu.fromLike(t),r=this.floor(e),i=this.ceil(e);return e.time-r.time<i.time-e.time?r:i}range(t,e,r){let i=this.ceil(t);const n=nu.time(e),s=[];if((r="number"==typeof r?Math.floor(r):1)>0)for(;i.isDefined()&&i.time<n;)s.push(i),i=this.next(i,r);return s}filter(t){return new Bu(this,t)}static get year(){return null===this.Year&&(this.Year=new Yu),this.Year}static get month(){return null===this.Month&&(this.Month=new Wu),this.Month}static get week(){return null===this.Week&&(this.Week=new Xu),this.Week}static get day(){return null===this.Day&&(this.Day=new Ku),this.Day}static get hour(){return null===this.Hour&&(this.Hour=new Gu),this.Hour}static get minute(){return null===this.Minute&&(this.Minute=new Zu),this.Minute}static get second(){return null===this.Second&&(this.Second=new Qu),this.Second}static get millisecond(){return null===this.Millisecond&&(this.Millisecond=new Ju),this.Millisecond}static years(t,e,r){return Nu.year.range(t,e,r)}static months(t,e,r){return Nu.month.range(t,e,r)}static weeks(t,e,r){return Nu.week.range(t,e,r)}static days(t,e,r){return Nu.day.range(t,e,r)}static hours(t,e,r){return Nu.hour.range(t,e,r)}static minutes(t,e,r){return Nu.minute.range(t,e,r)}static seconds(t,e,r){return Nu.second.range(t,e,r)}static milliseconds(t,e,r){return Nu.millisecond.range(t,e,r)}}Nu=Uu,Uu.Year=null,Uu.Month=null,Uu.Week=null,Uu.Day=null,Uu.Hour=null,Uu.Minute=null,Uu.Second=null,Uu.Millisecond=null,Uu.MillisPerSecond=1e3,Uu.MillisPerMinute=60*Nu.MillisPerSecond,Uu.MillisPerHour=60*Nu.MillisPerMinute;class Ru extends Uu{}class Bu extends Uu{constructor(t,e){super(),this.unit=t,this.predicate=e}offset(t,e){let r=nu.fromLike(t);for(e=Math.max(1,"number"==typeof e?Math.floor(e):1);e<0;){do{r=this.unit.offset(r,-1)}while(r.isDefined()&&!this.predicate(r));e+=1}for(;e>0;){do{r=this.unit.offset(r,1)}while(r.isDefined()&&!this.predicate(r));e-=1}return r}floor(t){let e=nu.fromLike(t);for(;e=this.unit.floor(e),e.isDefined()&&!this.predicate(e);)e=new nu(e.time-1,e.zone);return e}}class Yu extends Ru{offset(t,e){let r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r=r.withYear(r.year+e),r}next(t,e){const r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withYear(r.year+e).withMonth(0,1).withHour(0,0,0,0)}floor(t){return nu.fromLike(t).withMonth(0,1).withHour(0,0,0,0)}ceil(t){let e=nu.fromLike(t);return e=new nu(e.time-1,e.zone),e=e.withMonth(0,1).withHour(0,0,0,0),e=e.withYear(e.year+1),e.withMonth(0,1).withHour(0,0,0,0)}every(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Hu(t);throw new Error(""+t)}}class Hu extends Uu{constructor(t){super(),this.stride=t}offset(t,e){const r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withYear(r.year+e*this.stride)}next(t,e){let r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r=r.withYear(Math.floor((r.year+e*this.stride)/this.stride)*this.stride),r.withMonth(0,1).withHour(0,0,0,0)}floor(t){let e=nu.fromLike(t);return e=e.withYear(Math.floor(e.year/this.stride)*this.stride),e.withMonth(0,1).withHour(0,0,0,0)}ceil(t){let e=nu.fromLike(t);return e=new nu(e.time-1,e.zone),e=e.withYear(Math.floor(e.year/this.stride)*this.stride),e=e.withMonth(0,1).withHour(0,0,0,0),e=e.withYear(Math.floor((e.year+this.stride)/this.stride)*this.stride),e.withMonth(0,1).withHour(0,0,0,0)}}class Wu extends Ru{offset(t,e){const r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withMonth(r.month+e)}next(t,e){let r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r=r.withMonth(r.month+e),r.withDay(1).withHour(0,0,0,0)}floor(t){return nu.fromLike(t).withDay(1).withHour(0,0,0,0)}ceil(t){let e=nu.fromLike(t);return e=new nu(e.time-1,e.zone),e=e.withDay(1).withHour(0,0,0,0),e=e.withMonth(e.month+1),e.withDay(1).withHour(0,0,0,0)}every(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Bu(this,Wu.modulo.bind(void 0,t));throw new Error(""+t)}static modulo(t,e){const r=e.month;return isFinite(r)&&r%t==0}}class Xu extends Uu{constructor(t=0){super(),this.day=t}offset(t,e){const r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withDay(r.day+7*e)}next(t,e){let r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r=r.withDay(r.day+7*e),r=r.withDay(r.day-(r.weekday+7-this.day)%7),r.withHour(0,0,0,0)}floor(t){let e=nu.fromLike(t);return e=e.withDay(e.day-(e.weekday+7-this.day)%7),e.withHour(0,0,0,0)}ceil(t){let e=nu.fromLike(t);return e=new nu(e.time-1,e.zone),e=e.withDay(e.day-(e.weekday+7-this.day)%7),e=e.withHour(0,0,0,0),e=e.withDay(e.day+7),e.withHour(0,0,0,0)}}class Ku extends Ru{offset(t,e){const r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withDay(r.day+e)}next(t,e){let r=nu.fromLike(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r=r.withDay(r.day+e),r.withHour(0,0,0,0)}floor(t){return nu.fromLike(t).withHour(0,0,0,0)}ceil(t){let e=nu.fromLike(t);return e=new nu(e.time-1,e.zone),e=e.withHour(0,0,0,0),e=e.withDay(e.day+1),e.withHour(0,0,0,0)}every(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Bu(this,Ku.modulo.bind(void 0,t));throw new Error(""+t)}static modulo(t,e){const r=e.day;return isFinite(r)&&r%t==0}}class Gu extends Ru{offset(t,e){const r=nu.zone(t);return t=nu.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*Uu.MillisPerHour,new nu(t,r)}next(t,e){const r=nu.zone(t);t=nu.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*Uu.MillisPerHour;let i=r.offset*Uu.MillisPerMinute%Uu.MillisPerHour;return i<0&&(i+=Uu.MillisPerHour),t=Math.floor((t-i)/Uu.MillisPerHour)*Uu.MillisPerHour+i,new nu(t,r)}floor(t){const e=nu.zone(t);t=nu.time(t);let r=e.offset*Uu.MillisPerMinute%Uu.MillisPerHour;return r<0&&(r+=Uu.MillisPerHour),t=Math.floor((t-r)/Uu.MillisPerHour)*Uu.MillisPerHour+r,new nu(t,e)}ceil(t){const e=nu.zone(t);t=nu.time(t),t-=1;let r=e.offset*Uu.MillisPerMinute%Uu.MillisPerHour;return r<0&&(r+=Uu.MillisPerHour),t=Math.floor((t-r)/Uu.MillisPerHour)*Uu.MillisPerHour+r+Uu.MillisPerHour,t=Math.floor((t-r)/Uu.MillisPerHour)*Uu.MillisPerHour+r,new nu(t,e)}every(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Bu(this,Gu.modulo.bind(void 0,t));throw new Error(""+t)}static modulo(t,e){const r=e.hour;return isFinite(r)&&r%t==0}}class Zu extends Ru{offset(t,e){const r=nu.zone(t);return t=nu.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*Uu.MillisPerMinute,new nu(t,r)}next(t,e){const r=nu.zone(t);return t=nu.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t=Math.floor((t+e*Uu.MillisPerMinute)/Uu.MillisPerMinute)*Uu.MillisPerMinute,new nu(t,r)}floor(t){const e=nu.zone(t);return t=nu.time(t),t=Math.floor(t/Uu.MillisPerMinute)*Uu.MillisPerMinute,new nu(t,e)}ceil(t){const e=nu.zone(t);return t=nu.time(t),t=Math.floor((Math.floor((t-1)/Uu.MillisPerMinute)*Uu.MillisPerMinute+Uu.MillisPerMinute)/Uu.MillisPerMinute)*Uu.MillisPerMinute,new nu(t,e)}every(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Bu(this,Zu.modulo.bind(void 0,t));throw new Error(""+t)}static modulo(t,e){const r=e.minute;return isFinite(r)&&r%t==0}}class Qu extends Ru{offset(t,e){const r=nu.zone(t);return t=nu.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*Uu.MillisPerSecond,new nu(t,r)}next(t,e){const r=nu.zone(t);return t=nu.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*Uu.MillisPerSecond,t=Math.floor(t/Uu.MillisPerSecond)*Uu.MillisPerSecond,new nu(t,r)}floor(t){const e=nu.zone(t);return t=nu.time(t),t=Math.floor(t/Uu.MillisPerSecond)*Uu.MillisPerSecond,new nu(t,e)}ceil(t){const e=nu.zone(t);return t=nu.time(t),t=Math.floor((Math.floor((t-1)/Uu.MillisPerSecond)*Uu.MillisPerSecond+Uu.MillisPerSecond)/Uu.MillisPerSecond)*Uu.MillisPerSecond,new nu(t,e)}every(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Bu(this,Qu.modulo.bind(void 0,t));throw new Error(""+t)}static modulo(t,e){const r=e.second;return isFinite(r)&&r%t==0}}class Ju extends Ru{offset(t,e){const r=nu.zone(t);return t=nu.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new nu(t+=e,r)}next(t,e){const r=nu.zone(t);return t=nu.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new nu(t+=e,r)}floor(t){return nu.fromLike(t)}ceil(t){return nu.fromLike(t)}every(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new $u(t);throw new Error(""+t)}}class $u extends Uu{constructor(t){super(),isFinite(t)||(t=1),this.stride=t}offset(t,e){const r=nu.zone(t);return t=nu.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*this.stride,new nu(t,r)}next(t,e){const r=nu.zone(t);t=nu.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1);const i=this.stride;return t=Math.floor((t+e*i)/i)*i,new nu(t,r)}floor(t){const e=nu.zone(t);t=nu.time(t);const r=this.stride;return t=Math.floor(t/r)*r,new nu(t,e)}ceil(t){const e=nu.zone(t);t=nu.time(t);const r=this.stride;return t=Math.floor((Math.floor((t-1)/r)*r+r)/r)*r,new nu(t,e)}}const _u=function(t){const e=function(t,r){const i=function(t){const e=i[0].time,r=i[1].time-e;return 0!==r?(t.time-e)/r:0};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"inverse",{get(){return eh(this[0],this[1])},configurable:!0}),e.prototype.contains=function(t){return t=nu.time(t),this[0].time<=t&&t<=this[1].time},e.prototype.union=function(t){const r=this[0],i=this[1],n=t[0],s=t[1],o=r.time<=n.time?r:n,a=i.time>=s.time?i:s;return e(o,a)},e.prototype.interpolateTo=function(t){return t instanceof e?th(this,t):null},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this[0].equals(t[0])&&this[1].equals(t[1]))},e.prototype.toString=function(){return"TimeDomain("+this[0]+", "+this[1]+")"},e}(A),th=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=e[0],n=e[1],s=i[1],o=s[0],a=s[1];return _u(new nu(r.time+t*(o.time-r.time),0===t?r.zone:o.zone),new nu(n.time+t*(a.time-n.time),0===t?n.zone:a.zone))};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),eh=function(t){const e=function(t,r){const i=function(t){const e=i[0].time,r=i[1].time;return new nu(e+t*(r-e),0===t?i[0].zone:i[1].zone)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"inverse",{get(){return _u(this[0],this[1])},configurable:!0}),e.prototype.union=function(t){const r=this[0],i=this[1],n=t[0],s=t[1];let o,a;return r.time<=i.time&&n.time<=s.time?(o=r.time<=n.time?r:n,a=i.time>=s.time?i:s):r.time>=i.time&&n.time>=s.time?(o=r.time>=n.time?r:n,a=i.time<=s.time?i:s):r.time<=i.time&&n.time>=s.time?(o=r.time<=s.time?r:s,a=i.time>=n.time?i:n):(o=i.time<=n.time?i:n,a=r.time>=s.time?r:s),e(o,a)},e.prototype.interpolateTo=function(t){return t instanceof e?rh(this,t):null},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this[0].equals(t[0])&&this[1].equals(t[1]))},e.prototype.toString=function(){return"TimeRange("+this[0]+", "+this[1]+")"},e}(F),rh=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=e[0],n=e[1],s=i[1],o=s[0],a=s[1];return eh(new nu(r.time+t*(o.time-r.time),0===t?r.zone:o.zone),new nu(n.time+t*(a.time-n.time),0===t?n.zone:a.zone))};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j),ih=function(t){const e=function(t,r){const i=function(t){return i.range(i.domain(t))};return Object.setPrototypeOf(i,e.prototype),i.domain=t,i.range=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"inverse",{get(){return L(this.range.inverse,this.domain.inverse)},configurable:!0}),e.prototype.withDomain=function(t,r){let i;return 1===arguments.length?i=t:(t=nu.fromLike(t),r=nu.fromLike(r),i=_u(t,r)),e(i,this.range)},e.prototype.overRange=function(t,r){let i;return i=1===arguments.length?t:$(t,r),e(this.domain,i)},e.prototype.clampDomain=function(t,r,i,n,s){void 0===s&&(s=h.Epsilon);const o=this.domain[0],a=this.domain[1];let u=o.time,l=a.time;const c=void 0!==t?t.time:void 0,d=void 0!==r?r.time:void 0;void 0!==c&&void 0!==d&&Math.abs(l-u)>d-c?u<l?(u=c,l=d):(l=c,u=d):void 0!==c&&(u<l&&u<c?(l+=c-u,u=c):l<u&&l<c&&(u+=c-l,l=c)),void 0!==d&&(u<l&&l>d?(u-=l-d,l=d):l<u&&u>d&&(l-=u-d,u=d));const f=this(o),p=this(a),m=f<p?p-f:f-p,y=Math.abs(m/(l-u));if(void 0!==i&&y<1/i){const t=m*i,e=u+l;u=(e-t)/2,l=(e+t)/2}else if(void 0!==n&&y>1/n){const t=m*n,e=u+l;u=(e-t)/2,l=(e+t)/2}return Math.abs(u-o.time)<s&&Math.abs(l-a.time)<s?this:e(_u(new nu(u,o.zone),new nu(l,a.zone)),this.range)},e.prototype.solveDomain=function(t,r,i,n,s,o){void 0===o&&(o=h.Epsilon);const a=this.domain[1].time-this.domain[0].time,u=this.range[0],l=this.range[1],c=t.time,d=void 0!==i?i.time:void 0;let f;void 0===d||void 0===n||Math.abs(d-c)<o||Math.abs(n-r)<o?f=(l-u)/(0!==a?a:o):(f=(n-r)/(d-c),void 0!==s&&s||f<0==(l-u)/a<0||(f=-f));const p=r-f*c,m=(u-p)/f,y=(l-p)/f;return Math.abs(m-this.domain[0].time)<o&&Math.abs(y-this.domain[1].time)<o?this:e(_u(new nu(m,this.domain[0].zone),new nu(y,this.domain[1].zone)),this.range)},e.prototype.interpolateTo=function(t){return t instanceof e?nh(this,t):null},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},e.prototype.toString=function(){return"TimeScale("+this.domain+", "+this.range+")"},e}(Z),nh=function(t){const e=function(t,r){const i=function(t){const e=i[0],r=i[1],n=e.domain,s=n[0].time,o=n[1].time,a=r.domain,u=a[0].time,h=a[1].time,l=_u(new nu(s+t*(u-s),0===t?n[0].zone:a[0].zone),new nu(o+t*(h-o),0===t?n[1].zone:a[1].zone)),c=e.range,d=c[0],f=c[1],p=r.range,m=p[0],y=p[1],g=$(d+t*(m-d),f+t*(y-f));return ih(l,g)};return Object.setPrototypeOf(i,e.prototype),i[0]=t,i[1]=r,i};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(j);t.Absent=Ir,t.AffineTransform=na,t.AffineTransformInterpolator=sa,t.AffineTransformLike=ia,t.AffineTransformParser=oa,t.Affinity=pe,t.AndOperator=Yr,t.Angle=Us,t.AngleForm=Xs,t.AngleInterpolator=Ws,t.AngleLike=Ns,t.AngleParser=Ks,t.Animator=be,t.AnyForm=Li,t.ArrayCursor=P,t.ArrayInterpolator=Y,t.Arrays=w,t.Assert=it,t.AssertException=rt,t.Attr=cr,t.AttrInterpolator=dr,t.BTree=Le,t.BTreeContext=De,t.BTreeLeaf=Ae,t.BTreeNode=Fe,t.BTreeNodeCursor=Ve,t.BTreePage=qe,t.Base10=Ct,t.Base10IntegerWriter=se,t.Base10NumberParser=ie,t.Base16=_t,t.Base16IntegerWriter=ue,t.Base16Parser=oe,t.Base16Writer=ae,t.Base64=he,t.Base64Parser=de,t.Base64Writer=fe,t.Binary=Zt,t.BinaryOperator=qr,t.BinaryOperatorInterpolator=Ar,t.BitwiseAndOperator=Xr,t.BitwiseNotOperator=si,t.BitwiseOrOperator=Hr,t.BitwiseXorOperator=Wr,t.Bool=Tr,t.BooleanForm=Di,t.Booleans=d,t.BridgeFunc=Ci,t.ByteOrder=n,t.ByteOutput=Xt,t.ByteOutputBuffer=Gt,t.ByteOutputUint8Array=Kt,t.ChildrenSelector=gi,t.Compare=l,t.Component=Me,t.ComponentRef=Ee,t.ComponentRelation=Oe,t.ComponentSet=Te,t.ConditionalOperator=zr,t.ConditionalOperatorInterpolator=jr,t.Constant=V,t.Constraint=ir,t.ConstraintAnimator=er,t.ConstraintConstant=_e,t.ConstraintContext=sr,t.ConstraintDummy=We,t.ConstraintError=Xe,t.ConstraintExpression=Ze,t.ConstraintExpressionLike=Ge,t.ConstraintGroup=class{constructor(t){this.scope=t,this.constraints=[],this.constrained=!1}constraint(t,e,r,i){t=Ze.fromLike(t);const n=void 0!==(r=Ze.fromLike(r))?t.minus(r):t;i=void 0===i?rr.Required:rr.fromLike(i);const s=new ir(this.scope,n,e,i);return this.addConstraint(s),s}hasConstraint(t){return this.constraints.indexOf(t)>=0}addConstraint(t){const e=this.constraints;e.indexOf(t)<0&&(e.push(t),t.constrain(this.constrained))}removeConstraint(t){const e=this.constraints;if(void 0===e)return;const r=e.indexOf(t);r>=0&&(e.splice(r,1),t.constrain(!1))}enableConstraints(){const t=this.constraints;for(let e=0;e<t.length;e+=1)t[e].constrain(!0)}disableConstraints(){const t=this.constraints;for(let e=0;e<t.length;e+=1)t[e].constrain(!1)}isConstrained(){return this.constrained}constrain(t=!0){return t&&!this.constrained?(this.constrained=!0,this.enableConstraints()):!t&&this.constrained&&(this.constrained=!1,this.disableConstraints()),this}},t.ConstraintInvalid=Ke,t.ConstraintProduct=$e,t.ConstraintProperty=tr,t.ConstraintRow=or,t.ConstraintScope=nr,t.ConstraintSlack=He,t.ConstraintSolver=class{constructor(){this.constraints=new Map,this.constraintVariables=new Map,this.rows=new Map,this.infeasible=[],this.objective=new or(this,null,new Map,0),this.artificial=null,this.invalidated=new Map}constraint(t,e,r,i){t=Ze.fromLike(t);const n=void 0!==(r=Ze.fromLike(r))?t.minus(r):t;i=void 0===i?rr.Required:rr.fromLike(i);const s=new ir(this,n,e,i);return this.addConstraint(s),s}hasConstraint(t){return this.constraints.has(t)}addConstraint(t){if(this.constraints.has(t))return;for(const e of t.expression.terms.keys())e.addConstraintCondition(t,this);const{row:e,tag:r}=this.createRow(t);this.addConstraintRow(t,e,r)}addConstraintRow(t,e,r){this.willAddConstraint(t);let i=this.chooseSubject(e,r);if(i.isInvalid()&&e.isDummy()){if(Math.abs(e.constant)>=h.Epsilon)throw new Error("unsatisfiable constraint");i=r.marker}if(i.isInvalid()){if(!this.addWithArtificialVariable(e))throw new Error("unsatisfiable constraint")}else e.setSymbol(i),e.solveFor(i),this.substitute(i,e),this.rows.set(i,e);this.constraints.set(t,r),this.optimize(this.objective),this.didAddConstraint(t),this.updateSolution()}willAddConstraint(t){}didAddConstraint(t){}removeConstraint(t){if(void 0!==this.constraints.get(t)){this.removeConstraintRow(t);for(const e of t.expression.terms.keys())e.removeConstraintCondition(t,this)}}removeConstraintRow(t){const e=this.constraints.get(t);if(void 0===e)return;this.willRemoveConstraint(t),this.constraints.delete(t),this.removeConstraintEffects(t,e);const r=e.marker;if(!this.rows.delete(r)){const t=this.getMarkerLeavingSymbol(r);if(t.isInvalid())throw new Error("failed to find leaving row");const e=this.rows.get(t);this.rows.delete(t),e.solveForEx(t,r),this.substitute(r,e)}this.optimize(this.objective),this.didRemoveConstraint(t),this.updateSolution()}willRemoveConstraint(t){}didRemoveConstraint(t){}constraintVariable(t,e,r){void 0===e&&(e=0),r=void 0!==r?rr.fromLike(r):rr.Strong;const i=tr.create(this);return Object.defineProperty(i,"name",{value:t,configurable:!0}),void 0!==e&&i.setValue(e),i.setStrength(r),i.mount(),i}hasConstraintVariable(t){return this.constraintVariables.has(t)}addConstraintVariable(t){if(this.constraintVariables.has(t))return;const e=rr.clip(t.strength);if(e===rr.Required)throw new Error("invalid variable strength");this.willAddConstraintVariable(t);const r=new ir(this,t,"eq",e),{row:i,tag:n}=this.createRow(r);this.constraintVariables.set(t,{constraint:r,tag:n,state:0}),this.addConstraintRow(r,i,n),this.didAddConstraintVariable(t)}willAddConstraintVariable(t){}didAddConstraintVariable(t){}removeConstraintVariable(t){const e=this.constraintVariables.get(t);void 0!==e&&(this.willRemoveConstraintVariable(t),this.constraintVariables.delete(t),this.removeConstraintRow(e.constraint),this.didRemoveConstraintVariable(t))}willRemoveConstraintVariable(t){}didRemoveConstraintVariable(t){}setConstraintVariable(t,e){const r=this.constraintVariables.get(t);if(void 0===r)throw new Error("unbound variable");const i=r.state;if(i===e)return;r.state=e;const n=e-i;this.willSetConstraintVariable(t,e,i);const s=r.tag.marker;let o=this.rows.get(s);if(void 0!==o)return o.add(-n)<0&&this.infeasible.push(s),void this.dualOptimize();const a=r.tag.other;if(o=this.rows.get(a),void 0!==o)return o.add(n)<0&&this.infeasible.push(a),void this.dualOptimize();for(const[t,e]of this.rows){const r=e.coefficientFor(s);0!==r&&e.add(n*r)<0&&!t.isExternal()&&this.infeasible.push(t)}this.dualOptimize(),this.didSetConstraintVariable(t,e,i),this.updateSolution()}willSetConstraintVariable(t,e,r){}didSetConstraintVariable(t,e,r){}invalidate(t,e=null){t.isExternal()&&this.invalidated.set(t,e)}updateSolution(){const t=this.invalidated;if(0!==t.size){this.invalidated=new Map;for(const e of t.keys()){const t=this.rows.get(e);void 0!==t&&e.updateConstraintSolution(t.constant)}}}createRow(t){const e=t.expression,r=new or(this,null,new Map,e.constant);for(const[t,i]of e.terms){if(Math.abs(i)<h.Epsilon)continue;const e=this.rows.get(t);void 0!==e?r.insertRow(e,i):r.insertSymbol(t,i)}const i=this.objective,n=t.relation,s=t.strength,o={marker:Ye.invalid(),other:Ye.invalid()};if("le"===n||"ge"===n){const t="le"===n?1:-1,e=new He;if(o.marker=e,r.insertSymbol(e,t),s<rr.Required){const e=new Xe;o.other=e,r.insertSymbol(e,-t),i.insertSymbol(e,s)}}else if(s<rr.Required){const t=new Xe,e=new Xe;o.marker=t,o.other=e,r.insertSymbol(t,-1),r.insertSymbol(e,1),i.insertSymbol(t,s),i.insertSymbol(e,s)}else{const t=new We;o.marker=t,r.insertSymbol(t)}return r.constant<0&&r.negate(),{row:r,tag:o}}chooseSubject(t,e){for(const e of t.cells.keys())if(e.isExternal())return e;return(e.marker instanceof He||e.marker instanceof Xe)&&t.coefficientFor(e.marker)<0?e.marker:(e.other instanceof He||e.other instanceof Xe)&&t.coefficientFor(e.other)<0?e.other:Ye.invalid()}addWithArtificialVariable(t){const e=new He;this.rows.set(e,t.clone()),this.artificial=t.clone(),this.optimize(this.artificial);const r=Math.abs(this.artificial.constant)<h.Epsilon;this.artificial=null;const i=this.rows.get(e);if(void 0!==i){if(this.rows.delete(e),i.isConstant())return r;const t=this.anyPivotableSymbol(i);if(t.isInvalid())return!1;i.setSymbol(t),i.solveForEx(e,t),this.substitute(t,i),this.rows.set(t,i)}for(const t of this.rows.values())t.removeSymbol(e);return this.objective.removeSymbol(e),r}substitute(t,e){for(const[r,i]of this.rows)i.substitute(t,e),i.constant<0&&!r.isExternal()&&this.infeasible.push(r);this.objective.substitute(t,e),null!==this.artificial&&this.artificial.substitute(t,e)}optimize(t){for(;;){const e=this.getEnteringSymbol(t);if(e.isInvalid())return;const r=this.getLeavingSymbol(e);if(r.isInvalid())throw new Error("objective is unbounded");const i=this.rows.get(r);this.rows.delete(r),i.setSymbol(e),i.solveForEx(r,e),this.substitute(e,i),this.rows.set(e,i)}}dualOptimize(){let t;for(;t=this.infeasible.pop(),void 0!==t;){const e=this.rows.get(t);if(void 0===e||e.constant>=0)continue;const r=this.getDualEnteringSymbol(e);if(r.isInvalid())throw new Error("dual optimize failed");this.rows.delete(t),e.setSymbol(r),e.solveForEx(t,r),this.substitute(r,e),this.rows.set(r,e)}}getEnteringSymbol(t){for(const[e,r]of t.cells)if(r<0&&!e.isDummy())return e;return Ye.invalid()}getDualEnteringSymbol(t){let e=Number.MAX_VALUE,r=Ye.invalid();for(const[i,n]of t.cells){if(n<=0||i.isDummy())continue;const t=this.objective.coefficientFor(i)/n;t<e&&(e=t,r=i)}return r}getLeavingSymbol(t){let e=Number.MAX_VALUE,r=Ye.invalid();for(const[i,n]of this.rows){if(i.isExternal())continue;const s=n.coefficientFor(t);if(s>=0)continue;const o=-n.constant/s;o<e&&(e=o,r=i)}return r}getMarkerLeavingSymbol(t){let e=Number.MAX_VALUE,r=Number.MAX_VALUE,i=Ye.invalid(),n=Ye.invalid(),s=Ye.invalid();for(const[o,a]of this.rows){const u=a.coefficientFor(t);if(0!==u)if(o.isExternal())s=o;else if(u<0){const t=-a.constant/u;t<e&&(e=t,i=o)}else{const t=a.constant/u;t<r&&(r=t,n=o)}}return i.isInvalid()?n.isInvalid()?s:n:i}removeConstraintEffects(t,e){e.marker instanceof Xe&&this.removeMarkerEffects(e.marker,t.strength),e.other instanceof Xe&&this.removeMarkerEffects(e.other,t.strength)}removeMarkerEffects(t,e){const r=this.rows.get(t);void 0!==r?this.objective.insertRow(r,-e):this.objective.insertSymbol(t,-e)}anyPivotableSymbol(t){for(const e of t.cells.keys())if(e instanceof He||e instanceof Xe)return e;return Ye.invalid()}},t.ConstraintStrength=rr,t.ConstraintSum=Qe,t.ConstraintSymbol=Ye,t.ConstraintTerm=Je,t.Constructors=g,t.Consumable=M,t.ContinuousScale=Z,t.Creatable=C,t.Cursor=O,t.Data=Sr,t.DataOutput=Cr,t.DateTime=nu,t.DateTimeForm=ou,t.DateTimeFormat=lu,t.DateTimeInit=iu,t.DateTimeInterpolator=su,t.DateTimeLike=ru,t.DateTimeLocale=uu,t.DateTimeParser=au,t.DateTimeSpecifiers=hu,t.DayInterval=Ku,t.DayOfMonthFormat=mu,t.DayOfMonthParser=Pu,t.DegAngle=Rs,t.DescendantsSelector=wi,t.Diagnostic=kt,t.DivideOperator=ri,t.Domain=A,t.Easing=X,t.EmLength=Ls,t.EmptyCursor=E,t.EqOperator=Zr,t.Equals=a,t.Equivalent=h,t.EventHandler=xe,t.EventTimer=Se,t.Expression=Dr,t.Extant=Pr,t.Fastener=ge,t.FastenerContext=me,t.FastenerContextMetaclass=ye,t.Field=hr,t.FieldInterpolator=lr,t.FilterSelector=bi,t.FilterTimeInterval=Bu,t.Form=Oi,t.FormException=Mi,t.Format=St,t.FromLike=x,t.Func=xi,t.Functions=y,t.GeOperator=Jr,t.GeoBox=ja,t.GeoBoxInit=za,t.GeoBoxInterpolator=Na,t.GeoBoxLike=Va,t.GeoCurve=ba,t.GeoGroup=Ua,t.GeoJson=Ba,t.GeoJsonFeature=Ja,t.GeoJsonFeatureCollection=$a,t.GeoJsonGeometry=Ya,t.GeoJsonGeometryCollection=Qa,t.GeoJsonLineString=Xa,t.GeoJsonMultiLineString=Ka,t.GeoJsonMultiPoint=Wa,t.GeoJsonMultiPolygon=Za,t.GeoJsonPoint=Ha,t.GeoJsonPolygon=Ga,t.GeoJsonPosition=Ra,t.GeoPath=Ia,t.GeoPathBuilder=Da,t.GeoPathLike=Ta,t.GeoPathSplines=Pa,t.GeoPoint=ga,t.GeoPointInit=ma,t.GeoPointInterpolator=wa,t.GeoPointLike=pa,t.GeoPointTuple=ya,t.GeoProjection=ca,t.GeoSegment=Sa,t.GeoSegmentInit=xa,t.GeoSegmentInterpolator=Ca,t.GeoSegmentLike=va,t.GeoShape=fa,t.GeoShapeLike=da,t.GeoSpline=Oa,t.GeoSplineBuilder=Ea,t.GeoSplineLike=ka,t.GeoSplinePoints=Ma,t.GeoTile=Fa,t.GeoTileInit=qa,t.GeoTileLike=La,t.GeoTileTuple=Aa,t.GetAttrSelector=fi,t.GetItemSelector=pi,t.GetSelector=di,t.GradAngle=Ys,t.GtOperator=$r,t.HashCode=u,t.Hour12Format=bu,t.Hour12Parser=qu,t.Hour24Format=wu,t.Hour24Parser=Lu,t.HourInterval=Gu,t.Identifiers=m,t.Identity=c,t.IdentityInterpolator=U,t.IdentitySelector=ci,t.IdentityTransform=Uo,t.Input=dt,t.InputBuffer=Et,t.InputBufferDone=Pt,t.InputBufferEmpty=Tt,t.InputBufferError=It,t.InputDone=Ot,t.InputEmpty=Mt,t.InputError=ft,t.InputException=lt,t.InputSettings=ct,t.Interpolate=z,t.Interpolator=j,t.InterpolatorInterpolator=H,t.InterpolatorMap=N,t.Interpreter=Rr,t.InterpreterException=Nr,t.InterpreterSettings=Ur,t.InvokeOperator=ui,t.InvokeOperatorInterpolator=hi,t.Item=ar,t.ItemForm=qi,t.ItemInterpolator=ur,t.KeysCursor=I,t.KeysSelector=mi,t.LambdaFunc=Si,t.Lazy=o,t.LeOperator=Gr,t.Length=Is,t.LengthForm=zs,t.LengthInterpolator=Vs,t.LengthLike=Ps,t.LengthParser=js,t.LinearDomain=Q,t.LinearDomainInterpolator=J,t.LinearRange=$,t.LinearRangeInterpolator=_,t.LinearScale=tt,t.LinearScaleInterpolator=et,t.LiteralSelector=vi,t.LtOperator=Kr,t.Mapping=L,t.Mark=ot,t.MathModule=ki,t.MillisecondFormat=Cu,t.MillisecondInterval=Ju,t.MillisecondParser=zu,t.MillisecondsInterval=$u,t.MinusOperator=ti,t.MinuteFormat=xu,t.MinuteInterval=Zu,t.MinuteParser=Fu,t.ModuloOperator=ii,t.MonthFormat=fu,t.MonthInterval=Wu,t.MonthOfYearFormat=du,t.MonthOfYearParser=Ou,t.MonthParser=Eu,t.Murmur3=s,t.NeOperator=Qr,t.NegativeOperator=oi,t.NodeCursor=Ie,t.NotOperator=ni,t.Num=Or,t.NumInterpolator=Er,t.NumberForm=Ii,t.NumberInterpolator=B,t.Numbers=f,t.Objects=b,t.Observable=k,t.Operator=Lr,t.OrOperator=Br,t.Output=yt,t.OutputBuffer=At,t.OutputBufferDone=Vt,t.OutputBufferError=zt,t.OutputBufferFull=Ft,t.OutputDone=Lt,t.OutputError=qt,t.OutputException=mt,t.OutputFull=Dt,t.OutputSettings=ht,t.OutputStyle=ut,t.Parser=Nt,t.ParserDone=Ut,t.ParserError=Rt,t.ParserException=jt,t.PatternFormat=ku,t.PatternParser=ju,t.PctLength=As,t.PeriodFormat=vu,t.PeriodParser=Au,t.Piecewise=q,t.PlusOperator=_r,t.PositiveOperator=ai,t.Property=we,t.Provider=Ce,t.PxLength=Ds,t.R2BezierCurve=oo,t.R2Box=qo,t.R2BoxInit=Lo,t.R2BoxInterpolator=Ao,t.R2BoxLike=Do,t.R2Circle=Po,t.R2CircleInit=To,t.R2CircleInterpolator=Io,t.R2CircleLike=Eo,t.R2CubicCurve=yo,t.R2CubicCurveParser=go,t.R2Curve=so,t.R2CurveParser=ao,t.R2EllipticCurve=wo,t.R2EllipticCurveParser=bo,t.R2Group=Fo,t.R2Path=ko,t.R2PathBuilder=Mo,t.R2PathLike=Co,t.R2PathParser=Oo,t.R2Point=io,t.R2PointInit=eo,t.R2PointInterpolator=no,t.R2PointLike=to,t.R2PointTuple=ro,t.R2QuadraticCurve=po,t.R2QuadraticCurveParser=mo,t.R2Segment=lo,t.R2SegmentInit=ho,t.R2SegmentInterpolator=co,t.R2SegmentLike=uo,t.R2SegmentParser=fo,t.R2Shape=_s,t.R2ShapeLike=$s,t.R2Spline=vo,t.R2SplineBuilder=xo,t.R2SplineParser=So,t.R2Vector=Qs,t.R2VectorInit=Zs,t.R2VectorInterpolator=Js,t.R2VectorLike=Gs,t.RadAngle=Bs,t.Random=i,t.Range=F,t.Recon=Fi,t.ReconParser=dn,t.ReconStructureParser=fn,t.ReconStructureWriter=zn,t.ReconWriter=Vn,t.Record=gr,t.RecordCursor=br,t.RecordInterpolator=wr,t.RecordMap=vr,t.RecordMapView=xr,t.RemLength=qs,t.RotateTransform=Qo,t.RotateTransformInterpolator=Jo,t.RotateTransformLike=Zo,t.RotateTransformParser=$o,t.STree=je,t.STreeContext=ze,t.STreeLeaf=Ue,t.STreeNode=Re,t.STreeNodeCursor=Be,t.STreePage=Ne,t.Scale=G,t.ScaleTransform=Xo,t.ScaleTransformInterpolator=Ko,t.ScaleTransformLike=Wo,t.ScaleTransformParser=Go,t.SecondFormat=Su,t.SecondInterval=Qu,t.SecondParser=Vu,t.Selector=li,t.Service=Pe,t.Severity=nt,t.ShortMonthFormat=pu,t.ShortMonthParser=Tu,t.ShortWeekdayFormat=gu,t.ShortWeekdayParser=Du,t.SkewTransform=ta,t.SkewTransformInterpolator=ea,t.SkewTransformLike=_o,t.SkewTransformParser=ra,t.Slot=fr,t.SlotInterpolator=pr,t.Span=at,t.StepInterpolator=R,t.StringForm=Pi,t.StringInput=pt,t.StringOutput=gt,t.StringWriter=vt,t.Strings=p,t.Tag=st,t.TagForm=Ei,t.Text=kr,t.TextOutput=Mr,t.TimeDomain=_u,t.TimeDomainInterpolator=th,t.TimeInterval=Uu,t.TimeRange=eh,t.TimeRangeInterpolator=rh,t.TimeScale=ih,t.TimeScaleInterpolator=nh,t.TimeZone=tu,t.TimeZoneForm=eu,t.TimeZoneLike=_a,t.Timer=ve,t.TimesOperator=ei,t.Timing=W,t.ToLike=S,t.Transform=zo,t.TransformForm=jo,t.TransformLike=Vo,t.TransformList=ua,t.TransformListInterpolator=ha,t.TransformListLike=aa,t.TransformListParser=la,t.TransformParser=No,t.TranslateTransform=Bo,t.TranslateTransformInterpolator=Yo,t.TranslateTransformLike=Ro,t.TranslateTransformParser=Ho,t.TurnAngle=Hs,t.Tweening=K,t.UnaryCursor=T,t.UnaryOperator=Fr,t.UnaryOperatorInterpolator=Vr,t.Unicode=xt,t.UnitForm=Ti,t.UnitTimeInterval=Ru,t.UnitlessLength=Fs,t.Uri=Un,t.UriAuthority=Gn,t.UriAuthorityInit=Kn,t.UriAuthorityLike=Xn,t.UriAuthorityParser=Zn,t.UriCache=class{constructor(t,e=128){this.base=t,this.capacity=e,this.resolveCache=new Map,this.unresolveCache=new Map}resolve(t){"string"!=typeof t&&(t=Un.fromLike(t).toString());const e=this.resolveCache;let r=e.get(t);void 0===r?r=this.base.resolve(t):e.delete(t),e.set(t,r);const i=this.capacity;let n=e.size;if(n>i){const t=e.keys();let r;for(;n>i&&!0!==(r=t.next()).done;)e.delete(r.value),n-=1}return r}unresolve(t){"string"!=typeof t&&(t=Un.fromLike(t).toString());const e=this.unresolveCache;let r=e.get(t);void 0===r?r=this.base.unresolve(t):e.delete(t),e.set(t,r);const i=this.capacity;let n=e.size;if(n>i){const t=e.keys();let r;for(;n>i&&!0!==(r=t.next()).done;)e.delete(r.value),n-=1}return r}},t.UriForm=Rn,t.UriFragment=Es,t.UriFragmentLike=Os,t.UriFragmentParser=Ts,t.UriHost=es,t.UriHostAddressParser=as,t.UriHostIPv4=ns,t.UriHostIPv6=ss,t.UriHostLike=ts,t.UriHostLiteralParser=us,t.UriHostName=is,t.UriHostParser=os,t.UriHostUndefined=rs,t.UriInit=Nn,t.UriLike=jn,t.UriParser=Bn,t.UriPath=fs,t.UriPathBuilder=gs,t.UriPathEmpty=ps,t.UriPathForm=ws,t.UriPathLike=ds,t.UriPathParser=bs,t.UriPathSegment=ys,t.UriPathSlash=ms,t.UriPort=ls,t.UriPortLike=hs,t.UriPortParser=cs,t.UriQuery=xs,t.UriQueryBuilder=ks,t.UriQueryLike=vs,t.UriQueryParam=Cs,t.UriQueryParser=Ms,t.UriQueryUndefined=Ss,t.UriScheme=Hn,t.UriSchemeLike=Yn,t.UriSchemeParser=Wn,t.UriUser=$n,t.UriUserInit=Jn,t.UriUserLike=Qn,t.UriUserParser=_n,t.Utf8=re,t.Utf8DecodedOutput=te,t.Utf8EncodedOutput=ee,t.UtfErrorMode=Qt,t.UtfErrorModeFatal=Jt,t.UtfErrorModeReplacement=$t,t.Value=mr,t.ValueBuilder=yr,t.ValueCursor=class extends O{constructor(t,e){super(),this.cursor=t,this.form=e}isEmpty(){return this.cursor.isEmpty()}head(){return this.cursor.head().coerce(this.form)}step(){this.cursor.step()}skip(t){this.cursor.skip(t)}hasNext(){return this.cursor.hasNext()}nextIndex(){return this.cursor.nextIndex()}next(){const t=this.cursor.next();return!0===t.done?t:{done:!1,value:t.value.coerce(this.form)}}hasPrevious(){return this.cursor.hasPrevious()}previousIndex(){return this.cursor.previousIndex()}previous(){const t=this.cursor.previous();return!0===t.done?t:{done:!1,value:t.value.coerce(this.form)}}delete(){this.cursor.delete()}},t.ValueEntryCursor=class extends O{constructor(t,e,r){super(),this.cursor=t,this.keyForm=e,this.valueForm=r}isEmpty(){return this.cursor.isEmpty()}head(){const t=this.cursor.head();return[t[0].coerce(this.keyForm),t[1].coerce(this.valueForm)]}step(){this.cursor.step()}skip(t){this.cursor.skip(t)}hasNext(){return this.cursor.hasNext()}nextIndex(){return this.cursor.nextIndex()}next(){const t=this.cursor.next();return!0===t.done?t:{done:!1,value:[t.value[0].coerce(this.keyForm),t.value[1].coerce(this.valueForm)]}}hasPrevious(){return this.cursor.hasPrevious()}previousIndex(){return this.cursor.previousIndex()}previous(){const t=this.cursor.previous();return!0===t.done?t:{done:!1,value:[t.value[0].coerce(this.keyForm),t.value[1].coerce(this.valueForm)]}}delete(){this.cursor.delete()}},t.ValueForm=Ai,t.Values=v,t.ValuesCursor=D,t.ValuesSelector=yi,t.WeekInterval=Xu,t.WeekdayFormat=yu,t.WeekdayParser=Iu,t.Writer=bt,t.WriterDone=Yt,t.WriterEnd=Bt,t.WriterError=Ht,t.WriterException=wt,t.WriterSequence=Wt,t.YearFormat=cu,t.YearInterval=Yu,t.YearParser=Mu,t.YearsInterval=Hu,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=swim-core.min.js.map
