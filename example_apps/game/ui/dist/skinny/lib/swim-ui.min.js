// @swim/ui v4.0.0-dev.20220527.3 (c) 2015-2023 Nstream, inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@swim/core"),require("@swim/core"),require("@swim/core"),require("@swim/host"),require("@swim/core"),require("@swim/core"),require("@swim/core"),require("@swim/core"),require("@swim/core")):"function"==typeof define&&define.amd?define(["exports","@swim/core","@swim/core","@swim/core","@swim/host","@swim/core","@swim/core","@swim/core","@swim/core","@swim/core"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).swim=t.swim||{},t.swim,t.swim,t.swim,t.swim,t.swim,t.swim,t.swim,t.swim,t.swim)}(this,(function(t,e,i,s,n,r,o,l,a,h){"use strict";function d(t,e,i,s,n,r){function o(t){if(void 0!==t&&"function"!=typeof t)throw new TypeError("Function expected");return t}for(var l,a=s.kind,h="getter"===a?"get":"setter"===a?"set":"value",d=!e&&t?s.static?t:t.prototype:null,u=e||(d?Object.getOwnPropertyDescriptor(d,s.name):{}),c=!1,f=i.length-1;f>=0;f--){var p={};for(var g in s)p[g]="access"===g?{}:s[g];for(var g in s.access)p.access[g]=s.access[g];p.addInitializer=function(t){if(c)throw new TypeError("Cannot add initializers after decoration has completed");r.push(o(t||null))};var m=(0,i[f])("accessor"===a?{get:u.get,set:u.set}:u[h],p);if("accessor"===a){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(l=o(m.get))&&(u.get=l),(l=o(m.set))&&(u.set=l),(l=o(m.init))&&n.unshift(l)}else(l=o(m))&&("field"===a?n.unshift(l):u[h]=l)}d&&Object.defineProperty(d,s.name,u),c=!0}function u(t,e,i){for(var s=arguments.length>2,n=0;n<e.length;n++)i=s?e[n].call(t,i):e[n].call(t);return s?i:void 0}"function"==typeof SuppressedError&&SuppressedError;let c=(()=>{var t;let r,o,l,a,h,p,g=e.Component,w=[],y=[];return t=class extends g{constructor(){super(),this.firstTrait=void u(this,w),this.updater=u(this,y,void 0),this.consumers=null,this.firstTrait=null,this.lastTrait=null,this.traitMap=null}get componentType(){return t}willAttachParent(t){this.callObservers("modelWillAttachParent",t,this);let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.willAttachParent(t),e=null!==i&&i.model===this?i:null}}onAttachParent(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.onAttachParent(t),e=null!==i&&i.model===this?i:null}}didAttachParent(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.didAttachParent(t),e=null!==i&&i.model===this?i:null}this.callObservers("modelDidAttachParent",t,this)}willDetachParent(t){this.callObservers("modelWillDetachParent",t,this);let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.willDetachParent(t),e=null!==i&&i.model===this?i:null}}onDetachParent(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.onDetachParent(t),e=null!==i&&i.model===this?i:null}}didDetachParent(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.didDetachParent(t),e=null!==i&&i.model===this?i:null}this.callObservers("modelDidDetachParent",t,this)}willInsertChild(t,e){super.willInsertChild(t,e),this.callObservers("modelWillInsertChild",t,e,this);let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i.willInsertChild(t,e),i=null!==s&&s.model===this?s:null}}onInsertChild(t,e){super.onInsertChild(t,e);let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i.onInsertChild(t,e),i=null!==s&&s.model===this?s:null}}didInsertChild(t,e){let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i.didInsertChild(t,e),i=null!==s&&s.model===this?s:null}this.callObservers("modelDidInsertChild",t,e,this),super.didInsertChild(t,e)}cascadeInsert(e){0!=(this.flags&t.MountedFlag)&&(void 0===e&&(e=0),0!=((e|=this.flags&t.UpdateMask)&t.AnalyzeMask)&&this.cascadeAnalyze(e))}willRemoveChild(t){super.willRemoveChild(t),this.callObservers("modelWillRemoveChild",t,this);let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.willRemoveChild(t),e=null!==i&&i.model===this?i:null}}onRemoveChild(t){super.onRemoveChild(t);let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.onRemoveChild(t),e=null!==i&&i.model===this?i:null}}didRemoveChild(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.didRemoveChild(t),e=null!==i&&i.model===this?i:null}this.callObservers("modelDidRemoveChild",t,this),super.didRemoveChild(t)}willReinsertChild(t,e){super.willReinsertChild(t,e),this.callObservers("modelWillReinsertChild",t,e,this);let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i.willReinsertChild(t,e),i=null!==s&&s.model===this?s:null}}onReinsertChild(t,e){super.onReinsertChild(t,e)}didReinsertChild(t,e){let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i.didReinsertChild(t,e),i=null!==s&&s.model===this?s:null}this.callObservers("modelDidReinsertChild",t,e,this),super.didReinsertChild(t,e)}cascadeMount(){if(0!=(this.flags&t.MountedFlag))throw new Error("already mounted");this.willMount(),this.setFlags(this.flags|t.MountedFlag),this.onMount(),this.mountTraits(),this.mountChildren(),this.didMount()}willMount(){super.willMount(),this.callObservers("modelWillMount",this)}didMount(){this.requestUpdate(this,this.flags&t.UpdateMask,!1),this.requireUpdate(this.mountFlags),null!==this.decoherent&&0!==this.decoherent.length&&this.requireUpdate(t.NeedsMutate),this.mountFasteners(),null!==this.consumers&&0!==this.consumers.size&&this.startConsuming(),this.callObservers("modelDidMount",this),super.didMount()}cascadeUnmount(){if(0==(this.flags&t.MountedFlag))throw new Error("already unmounted");this.willUnmount(),this.setFlags(this.flags&~t.MountedFlag),this.unmountChildren(),this.unmountTraits(),this.onUnmount(),this.didUnmount()}willUnmount(){super.willUnmount(),this.callObservers("modelWillUnmount",this),this.stopConsuming()}didUnmount(){this.callObservers("modelDidUnmount",this),super.didUnmount()}getTraitFastener(t,e,i){let s=this.firstTrait;for(;null!==s;){const n=s.getFastener(t,e,i);if(null!==n)return n;s=s.nextTrait}return null}requireUpdate(e,i=!1){const s=this.flags,n=e&~s&t.UpdateMask;0!==n&&(this.setFlags(s|n),this.requestUpdate(this,n,i))}needsUpdate(t,e){let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;t=i.needsUpdate(t,e),i=null!==s&&s.model===this?s:null}return t}requestUpdate(e,i,s){i=this.needsUpdate(i,s);let n=this.flags&~i&t.UpdateMask;if(0!=(i&t.AnalyzeMask)&&(n|=t.NeedsAnalyze),0!=(i&t.RefreshMask)&&(n|=t.NeedsRefresh),0===n&&!s)return;this.setFlags(this.flags|n);const r=this.parent;if(null!==r)r.requestUpdate(e,i,s);else if(this.mounted){const t=this.updater.service;null!==t&&t.requestUpdate(e,i,s)}}get updating(){return 0!=(this.flags&t.UpdatingMask)}get analyzing(){return 0!=(this.flags&t.AnalyzingFlag)}needsAnalyze(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;t=e.needsAnalyze(t),e=null!==i&&i.model===this?i:null}return t}cascadeAnalyze(e){try{if(e&=~t.NeedsAnalyze,e|=this.flags&t.UpdateMask,0==((e=this.needsAnalyze(e))&t.AnalyzeMask))return;let i=e;this.setFlags(this.flags&~t.NeedsAnalyze|t.AnalyzingFlag),this.willAnalyze(i),0!=((this.flags|e)&t.NeedsMutate)&&(i|=t.NeedsMutate,this.setFlags(this.flags&~t.NeedsMutate),this.willMutate()),0!=((this.flags|e)&t.NeedsAggregate)&&(i|=t.NeedsAggregate,this.setFlags(this.flags&~t.NeedsAggregate),this.willAggregate()),0!=((this.flags|e)&t.NeedsCorrelate)&&(i|=t.NeedsCorrelate,this.setFlags(this.flags&~t.NeedsCorrelate),this.willCorrelate()),this.onAnalyze(i),0!=(i&t.NeedsMutate)&&this.onMutate(),0!=(i&t.NeedsAggregate)&&this.onAggregate(),0!=(i&t.NeedsCorrelate)&&this.onCorrelate(),0!=(i&t.AnalyzeMask)&&this.analyzeChildren(i,this.analyzeChild),0!=(i&t.NeedsCorrelate)&&this.didCorrelate(),0!=(i&t.NeedsAggregate)&&this.didAggregate(),0!=(i&t.NeedsMutate)&&this.didMutate(),this.didAnalyze(i)}finally{this.setFlags(this.flags&~t.AnalyzingFlag)}}willAnalyze(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.willAnalyze(t),e=null!==i&&i.model===this?i:null}}onAnalyze(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.onAnalyze(t),e=null!==i&&i.model===this?i:null}}didAnalyze(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.didAnalyze(t),e=null!==i&&i.model===this?i:null}}willMutate(){this.callObservers("modelWillMutate",this);let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.willMutate(),t=null!==e&&e.model===this?e:null}}onMutate(){this.recohereFasteners(this.updateTime);let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.onMutate(),t=null!==e&&e.model===this?e:null}}didMutate(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.didMutate(),t=null!==e&&e.model===this?e:null}this.callObservers("modelDidMutate",this)}willAggregate(){this.callObservers("modelWillAggregate",this);let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.willAggregate(),t=null!==e&&e.model===this?e:null}}onAggregate(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.onAggregate(),t=null!==e&&e.model===this?e:null}}didAggregate(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.didAggregate(),t=null!==e&&e.model===this?e:null}this.callObservers("modelDidAggregate",this)}willCorrelate(){this.callObservers("modelWillCorrelate",this);let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.willCorrelate(),t=null!==e&&e.model===this?e:null}}onCorrelate(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.onCorrelate(),t=null!==e&&e.model===this?e:null}}didCorrelate(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.didCorrelate(),t=null!==e&&e.model===this?e:null}this.callObservers("modelDidCorrelate",this)}analyzeChildren(t,e){const i=this.firstTrait;null!==i?this.analyzeTraitChildren(i,t,e):this.analyzeOwnChildren(t,e)}analyzeTraitChildren(t,e,i){const s=t.nextTrait;null!==s?t.analyzeChildren(e,i,this.analyzeTraitChildren.bind(this,s)):t.analyzeChildren(e,i,this.analyzeOwnChildren)}analyzeOwnChildren(t,e){let i=this.firstChild;for(;null!==i;){const s=i.nextSibling;if(e.call(this,i,t),null!==s&&s.parent!==this)throw new Error("inconsistent analyze pass");i=s}}analyzeChild(t,e){t.cascadeAnalyze(e)}get refreshing(){return 0!=(this.flags&t.RefreshingFlag)}needsRefresh(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;t=e.needsRefresh(t),e=null!==i&&i.model===this?i:null}return t}cascadeRefresh(e){try{if(e&=~t.NeedsRefresh,e|=this.flags&t.UpdateMask,0==((e=this.needsRefresh(e))&t.RefreshMask))return;let i=e;this.setFlags(this.flags&~t.NeedsRefresh|t.RefreshingFlag),this.willRefresh(i),0!=((this.flags|e)&t.NeedsValidate)&&(i|=t.NeedsValidate,this.setFlags(this.flags&~t.NeedsValidate),this.willValidate()),0!=((this.flags|e)&t.NeedsReconcile)&&(i|=t.NeedsReconcile,this.setFlags(this.flags&~t.NeedsReconcile),this.willReconcile()),this.onRefresh(i),0!=(i&t.NeedsValidate)&&this.onValidate(),0!=(i&t.NeedsReconcile)&&this.onReconcile(),i&t.RefreshMask&&this.refreshChildren(i,this.refreshChild),0!=(i&t.NeedsReconcile)&&this.didReconcile(),0!=(i&t.NeedsValidate)&&this.didValidate(),this.didRefresh(i)}finally{this.setFlags(this.flags&~t.RefreshingFlag)}}willRefresh(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.willRefresh(t),e=null!==i&&i.model===this?i:null}}onRefresh(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.onRefresh(t),e=null!==i&&i.model===this?i:null}}didRefresh(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e.didRefresh(t),e=null!==i&&i.model===this?i:null}}willValidate(){this.callObservers("modelWillValidate",this);let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.willValidate(),t=null!==e&&e.model===this?e:null}}onValidate(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.onValidate(),t=null!==e&&e.model===this?e:null}}didValidate(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.didValidate(),t=null!==e&&e.model===this?e:null}this.callObservers("modelDidValidate",this)}willReconcile(){this.callObservers("modelWillReconcile",this);let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.willReconcile(),t=null!==e&&e.model===this?e:null}}onReconcile(){this.recohereDownlinks(this.updateTime);let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.onReconcile(),t=null!==e&&e.model===this?e:null}}didReconcile(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;t.didReconcile(),t=null!==e&&e.model===this?e:null}this.callObservers("modelDidReconcile",this)}refreshChildren(t,e){const i=this.firstTrait;null!==i?this.refreshTraitChildren(i,t,e):this.refreshOwnChildren(t,e)}refreshTraitChildren(t,e,i){const s=t.nextTrait;null!==s?t.refreshChildren(e,i,this.refreshTraitChildren.bind(this,s)):t.refreshChildren(e,i,this.refreshOwnChildren)}refreshOwnChildren(t,e){let i=this.firstChild;for(;null!==i;){const s=i.nextSibling;if(e.call(this,i,t),null!==s&&s.parent!==this)throw new Error("inconsistent refresh pass");i=s}}refreshChild(t,e){t.cascadeRefresh(e)}setFirstTrait(t){this.firstTrait=t}setLastTrait(t){this.lastTrait=t}forEachTrait(t,e){let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;if(void 0!==t.call(e,i))break;i=null!==s&&s.model===this?s:null}}insertTraitMap(t){const e=t.key;if(void 0!==e){let i=this.traitMap;null===i&&(i={},this.traitMap=i),i[e]=t}}removeTraitMap(t){const e=t.key;if(void 0===e)return;const i=this.traitMap;null!==i&&delete i[e]}findTrait(t,e){if(void 0!==t){const i=this.traitMap;if(null!==i){const s=i[t];if(void 0!==s&&(null==e||s instanceof e))return s}}if(null!=e){let t=this.firstTrait;for(;null!==t;){if(t instanceof e)return t;t=t.nextTrait}}return null}hasTrait(t,e){if("string"==typeof t){const i=this.traitMap;if(null!==i){const s=i[t];if(void 0!==s&&(void 0===e||s instanceof e))return!0}}else{let e=this.firstTrait;for(;null!==e;){if(e instanceof t)return!0;e=e.nextTrait}}return!1}getTrait(t,e){if("string"==typeof t){const i=this.traitMap;if(null!==i){const s=i[t];if(void 0!==s&&(void 0===e||s instanceof e))return s}}else{let e=this.firstTrait;for(;null!==e;){if(e instanceof t)return e;e=e.nextTrait}}return null}setTrait(t,e){null!==e&&(e=m.fromLike(e));const i=this.getTrait(t);let s;return null!==i&&null!==e&&i!==e?(e.remove(),s=i.nextTrait,this.willRemoveTrait(i),i.detachModel(this),this.removeTraitMap(i),this.onRemoveTrait(i),this.didRemoveTrait(i),i.setKey(void 0),e.setFlags(e.flags|m.InsertingFlag),e.setKey(i.key),this.willInsertTrait(e,s),this.insertTraitMap(e),e.attachModel(this,s),this.onInsertTrait(e,s),this.didInsertTrait(e,s),e.setFlags(e.flags&~m.InsertingFlag)):(i!==e||null!==e&&e.key!==t)&&(null!==i?(s=i.nextTrait,this.willRemoveTrait(i),i.detachModel(this),this.removeTraitMap(i),this.onRemoveTrait(i),this.didRemoveTrait(i),i.setKey(void 0)):s=null,null!==e&&(e.remove(),e.setFlags(e.flags|m.InsertingFlag),e.setKey(t),this.willInsertTrait(e,s),this.insertTraitMap(e),e.attachModel(this,s),this.onInsertTrait(e,s),this.didInsertTrait(e,s),e.setFlags(e.flags&~m.InsertingFlag))),i}appendTrait(t,e){return(t=m.fromLike(t)).remove(),void 0!==e&&this.removeChild(e),t.setFlags(t.flags|m.InsertingFlag),t.setKey(e),this.willInsertTrait(t,null),this.insertTraitMap(t),t.attachModel(this,null),this.onInsertTrait(t,null),this.didInsertTrait(t,null),t.setFlags(t.flags&~m.InsertingFlag),t}prependTrait(t,e){(t=m.fromLike(t)).remove(),void 0!==e&&this.removeChild(e);const i=this.firstTrait;return t.setFlags(t.flags|m.InsertingFlag),t.setKey(e),this.willInsertTrait(t,i),this.insertTraitMap(t),t.attachModel(this,i),this.onInsertTrait(t,i),this.didInsertTrait(t,i),t.setFlags(t.flags&~m.InsertingFlag),t}insertTrait(t,e,i){if(null!==e&&e.model!==this)throw new Error("insert target is not a member trait");return(t=m.fromLike(t)).remove(),void 0!==i&&this.removeChild(i),t.setFlags(t.flags|m.InsertingFlag),t.setKey(i),this.willInsertTrait(t,e),this.insertTraitMap(t),t.attachModel(this,e),this.onInsertTrait(t,e),this.didInsertTrait(t,e),t.setFlags(t.flags&~m.InsertingFlag),t}replaceTrait(t,e){if(e.model!==this)throw new Error("replacement target is not a member trait");if(e!==(t=m.fromLike(t))){t.remove();const i=e.nextTrait;this.willRemoveTrait(e),e.detachModel(this),this.removeTraitMap(e),this.onRemoveTrait(e),this.didRemoveTrait(e),e.setKey(void 0),t.setFlags(t.flags|m.InsertingFlag),t.setKey(e.key),this.willInsertTrait(t,i),this.insertTraitMap(t),t.attachModel(this,i),this.onInsertTrait(t,i),this.didInsertTrait(t,i),t.setFlags(t.flags&~m.InsertingFlag)}return e}get insertTraitFlags(){return this.constructor.InsertTraitFlags}willInsertTrait(t,e){this.callObservers("modelWillInsertTrait",t,e,this);let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i!==t&&i.willInsertTrait(t,e),i=null!==s&&s.model===this?s:null}}onInsertTrait(t,e){this.requireUpdate(this.insertTraitFlags),this.bindTraitFasteners(t,e);let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i!==t&&i.onInsertTrait(t,e),i=null!==s&&s.model===this?s:null}}didInsertTrait(t,e){let i=this.firstTrait;for(;null!==i;){const s=i.nextTrait;i!==t&&i.didInsertTrait(t,e),i=null!==s&&s.model===this?s:null}this.callObservers("modelDidInsertTrait",t,e,this)}removeTrait(t){let e;if("string"==typeof t){if(e=this.getTrait(t),null===e)return null}else if(e=t,e.model!==this)throw new Error("not a member trait");return this.willRemoveTrait(e),e.detachModel(this),this.removeTraitMap(e),this.onRemoveTrait(e),this.didRemoveTrait(e),e.setKey(void 0),e}get removeTraitFlags(){return this.constructor.RemoveTraitFlags}willRemoveTrait(t){this.callObservers("modelWillRemoveTrait",t,this);let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e!==t&&e.willRemoveTrait(t),e=null!==i&&i.model===this?i:null}}onRemoveTrait(t){this.requireUpdate(this.removeTraitFlags);let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e!==t&&e.onRemoveTrait(t),e=null!==i&&i.model===this?i:null}this.unbindTraitFasteners(t)}didRemoveTrait(t){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;e!==t&&e.didRemoveTrait(t),e=null!==i&&i.model===this?i:null}this.callObservers("modelDidRemoveTrait",t,this)}sortTraits(t){let e=this.firstTrait;if(null===e)return;const i=[];do{i.push(e),e=e.nextTrait}while(null!==e);i.sort(t),e=i[0],this.setFirstTrait(e),e.setPreviousTrait(null);for(let t=1;t<i.length;t+=1){const s=i[t];e.setNextTrait(s),s.setPreviousTrait(e),e=s}e.setNextTrait(null),this.setLastTrait(e)}mountTraits(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;if(t.mountTrait(),null!==e&&e.model!==this)throw new Error("inconsistent mount");t=e}}unmountTraits(){let t=this.firstTrait;for(;null!==t;){const e=t.nextTrait;if(t.unmountTrait(),null!==e&&e.model!==this)throw new Error("inconsistent unmount");t=e}}getAncestorTrait(t){let e=this.parent;for(;null!==e;){const i=e.getTrait(t);if(null!==i)return i;e=e.parent}return null}getRootTrait(t){let e=null,i=this.parent;for(;null!==i;){const s=i.getTrait(t);null!==s&&(e=s),i=i.parent}return e}bindFastener(t){if(super.bindFastener(t),t instanceof v&&t.binds){let e=this.firstTrait;for(;null!==e;){const i=e.nextTrait;t.bindTrait(e,i),e=null!==i&&i.model===this?i:null}}this.consuming&&(t instanceof n.WarpDownlink&&!0===t.consumed||t instanceof v&&!0===t.consumed||t instanceof f&&!0===t.consumed)&&t.consume(this)}bindChildFastener(t,e,i){super.bindChildFastener(t,e,i),(t instanceof f||t instanceof v)&&t.bindModel(e,i)}unbindChildFastener(t,e){(t instanceof f||t instanceof v)&&t.unbindModel(e),super.unbindChildFastener(t,e)}bindTraitFasteners(t,i){const s=e.FastenerContext.getMetaclass(this);if(null===s)return;const n=s.slots;for(let s=0;s<n.length;s+=1){const r=this[n[s]];r instanceof e.Fastener&&this.bindTraitFastener(r,t,i)}}bindTraitFastener(t,e,i){t instanceof v&&t.bindTrait(e,i)}unbindTraitFasteners(t){const i=e.FastenerContext.getMetaclass(this);if(null===i)return;const s=i.slots;for(let i=0;i<s.length;i+=1){const n=this[s[i]];n instanceof e.Fastener&&this.unbindTraitFastener(n,t)}}unbindTraitFastener(t,e){t instanceof v&&t.unbindTrait(e)}enqueueFastener(e){super.enqueueFastener(e),e instanceof n.WarpDownlink?this.requireUpdate(t.NeedsReconcile):this.requireUpdate(t.NeedsMutate)}recohereFasteners(t){const e=this.decoherent;if(null!==e&&0!==e.length){void 0===t&&(t=performance.now()),this.coherentTime=t,this.decoherent=null,this.recohering=e;try{for(let i=0;i<e.length;i+=1){const s=e[i];s instanceof n.WarpDownlink?this.enqueueFastener(s):s.recohere(t)}}finally{this.recohering=null}}}recohereDownlinks(t){const e=this.decoherent;if(null===e||0===e.length)return;let i=!1;this.coherentTime=t,this.decoherent=null,this.recohering=e;try{for(let s=0;s<e.length;s+=1){const r=e[s];r instanceof n.WarpDownlink?(i||(i=!0,this.hostUri.recohere(t),this.nodeUri.recohere(t),this.laneUri.recohere(t)),r.recohere(t)):this.enqueueFastener(r)}}finally{this.recohering=null}}consume(t){let e=this.consumers;if(null===e)e=new Set,this.consumers=e;else if(e.has(t))return;this.willConsume(t),e.add(t),this.onConsume(t),this.didConsume(t),1===e.size&&this.mounted&&this.startConsuming()}willConsume(t){}onConsume(t){}didConsume(t){}unconsume(t){const e=this.consumers;null!==e&&e.has(t)&&(this.willUnconsume(t),e.delete(t),this.onUnconsume(t),this.didUnconsume(t),0===e.size&&this.stopConsuming())}willUnconsume(t){}onUnconsume(t){}didUnconsume(t){}get consuming(){return 0!=(this.flags&t.ConsumingFlag)}get startConsumingFlags(){return this.constructor.StartConsumingFlags}startConsuming(){0==(this.flags&t.ConsumingFlag)&&(this.willStartConsuming(),this.setFlags(this.flags|t.ConsumingFlag),this.onStartConsuming(),this.didStartConsuming())}willStartConsuming(){this.callObservers("modelWillStartConsuming",this)}onStartConsuming(){this.requireUpdate(this.startConsumingFlags),this.startConsumingFasteners()}didStartConsuming(){this.callObservers("modelDidStartConsuming",this)}get stopConsumingFlags(){return this.constructor.StopConsumingFlags}stopConsuming(){0!=(this.flags&t.ConsumingFlag)&&(this.willStopConsuming(),this.setFlags(this.flags&~t.ConsumingFlag),this.onStopConsuming(),this.didStopConsuming())}willStopConsuming(){this.callObservers("modelWillStopConsuming",this)}onStopConsuming(){this.requireUpdate(this.stopConsumingFlags),this.stopConsumingFasteners()}didStopConsuming(){this.callObservers("modelDidStopConsuming",this)}startConsumingFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const e=this[i[t]];(e instanceof n.WarpDownlink&&!0===e.consumed||e instanceof v&&!0===e.consumed||e instanceof f&&!0===e.consumed)&&e.consume(this)}}stopConsumingFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const e=this[i[t]];(e instanceof n.WarpDownlink&&!0===e.consumed||e instanceof v&&!0===e.consumed||e instanceof f&&!0===e.consumed)&&e.unconsume(this)}}get updateTime(){return this.updater.getService().updateTime}get selection(){return e.Provider.getter()}get hostUri(){return e.Property.getter()}get nodeUri(){return e.Property.getter()}get laneUri(){return e.Property.getter()}downlink(t){let e=n.EventDownlink;return void 0!==t&&(e=e.define("downlink",t)),e.create(this)}downlinkValue(t){let e=n.ValueDownlink;return void 0!==t&&(e=e.define("downlinkValue",t)),e.create(this)}downlinkList(t){let e=n.ListDownlink;return void 0!==t&&(e=e.define("downlinkList",t)),e.create(this)}downlinkMap(t){let e=n.MapDownlink;return void 0!==t&&(e=e.define("downlinkMap",t)),e.create(this)}command(t,e,n,r){void 0===e?(r=i.Value.fromLike(t),n=this.laneUri.getValue(),e=this.nodeUri.getValue(),t=this.hostUri.value):void 0===n?(r=i.Value.fromLike(e),n=s.Uri.fromLike(t),e=this.nodeUri.getValue(),t=this.hostUri.value):void 0===r?(r=i.Value.fromLike(n),n=s.Uri.fromLike(e),e=s.Uri.fromLike(t),t=this.hostUri.value):(r=i.Value.fromLike(r),n=s.Uri.fromLike(n),e=s.Uri.fromLike(e),t=s.Uri.fromLike(t)),null===t&&(t=e.endpoint(),e=t.unresolve(e));this.warpRef.value.command(t,e,n,r)}authenticate(t,e){void 0===e?(e=i.Value.fromLike(t),t=this.hostUri.getValue()):(e=i.Value.fromLike(e),t=s.Uri.fromLike(t));this.warpRef.value.authenticate(t,e)}hostRef(e){e=s.Uri.fromLike(e);const i=new t;return i.hostUri.set(e),this.appendChild(i),i}nodeRef(e,i){void 0===i?(e=(i=s.Uri.fromLike(e)).endpoint()).isDefined()?i=e.unresolve(i):e=void 0:(i=s.Uri.fromLike(i),e=s.Uri.fromLike(e));const n=new t;return void 0!==e&&n.hostUri.set(e),void 0!==i&&n.nodeUri.set(i),this.appendChild(n),n}laneRef(e,i,n){void 0===i?(n=s.Uri.fromLike(e),i=void 0,e=void 0):void 0===n?(n=s.Uri.fromLike(i),(e=(i=s.Uri.fromLike(e)).endpoint()).isDefined()?i=e.unresolve(i):e=void 0):(n=s.Uri.fromLike(n),i=s.Uri.fromLike(i),e=s.Uri.fromLike(e));const r=new t;return void 0!==e&&r.hostUri.set(e),void 0!==i&&r.nodeUri.set(i),void 0!==n&&r.laneUri.set(n),this.appendChild(r),r}getDownlink(t,e,i){return this.warpRef.value.getDownlink(t,e,i)}openDownlink(t){this.warpRef.value.openDownlink(t)}get warpRef(){return e.Property.getter()}},(()=>{var i;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(i=g[Symbol.metadata])&&void 0!==i?i:null):void 0;r=[e.Provider({get serviceType(){return T},mountRootService(t){super.mountRootService(t),t.roots.addModel(this.owner)},unmountRootService(t){super.unmountRootService(t),t.roots.removeModel(this.owner)}})],o=[e.Provider({get serviceType(){return A}})],l=[e.Property({valueType:s.Uri,value:null,inherits:!0,get updateFlags(){return c.NeedsReconcile}})],a=[e.Property({valueType:s.Uri,value:null,inherits:!0,get updateFlags(){return c.NeedsReconcile}})],h=[e.Property({valueType:s.Uri,value:null,inherits:!0,get updateFlags(){return c.NeedsReconcile}})],p=[e.Property({valueType:n.WarpRef,inherits:!0,get updateFlags(){return c.NeedsReconcile},initValue:()=>n.WarpClient.global(),equalValues:(t,e)=>t===e})],d(t,null,o,{kind:"getter",name:"selection",static:!1,private:!1,access:{has:t=>"selection"in t,get:t=>t.selection},metadata:u},null,w),d(t,null,l,{kind:"getter",name:"hostUri",static:!1,private:!1,access:{has:t=>"hostUri"in t,get:t=>t.hostUri},metadata:u},null,w),d(t,null,a,{kind:"getter",name:"nodeUri",static:!1,private:!1,access:{has:t=>"nodeUri"in t,get:t=>t.nodeUri},metadata:u},null,w),d(t,null,h,{kind:"getter",name:"laneUri",static:!1,private:!1,access:{has:t=>"laneUri"in t,get:t=>t.laneUri},metadata:u},null,w),d(t,null,p,{kind:"getter",name:"warpRef",static:!1,private:!1,access:{has:t=>"warpRef"in t,get:t=>t.warpRef},metadata:u},null,w),d(null,null,r,{kind:"field",name:"updater",static:!1,private:!1,access:{has:t=>"updater"in t,get:t=>t.updater,set:(t,e)=>{t.updater=e}},metadata:u},y,w),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u})})(),t.uid=function(){let t=1;return function(){const e=~~t;return t+=1,"model"+e}}(),t.MountedFlag=e.Component.MountedFlag,t.InsertingFlag=e.Component.InsertingFlag,t.RemovingFlag=e.Component.RemovingFlag,t.AnalyzingFlag=1<<e.Component.FlagShift+0,t.RefreshingFlag=1<<e.Component.FlagShift+1,t.ConsumingFlag=1<<e.Component.FlagShift+2,t.UpdatingMask=t.AnalyzingFlag|t.RefreshingFlag,t.StatusMask=t.MountedFlag|t.InsertingFlag|t.RemovingFlag|t.AnalyzingFlag|t.RefreshingFlag|t.ConsumingFlag,t.NeedsAnalyze=1<<e.Component.FlagShift+3,t.NeedsMutate=1<<e.Component.FlagShift+4,t.NeedsAggregate=1<<e.Component.FlagShift+5,t.NeedsCorrelate=1<<e.Component.FlagShift+6,t.AnalyzeMask=t.NeedsAnalyze|t.NeedsMutate|t.NeedsAggregate|t.NeedsCorrelate,t.NeedsRefresh=1<<e.Component.FlagShift+7,t.NeedsValidate=1<<e.Component.FlagShift+8,t.NeedsReconcile=1<<e.Component.FlagShift+9,t.RefreshMask=t.NeedsRefresh|t.NeedsValidate|t.NeedsReconcile,t.UpdateMask=t.AnalyzeMask|t.RefreshMask,t.FlagShift=e.Component.FlagShift+10,t.FlagMask=(1<<t.FlagShift)-1,t.MountFlags=0,t.InsertChildFlags=0,t.RemoveChildFlags=0,t.ReinsertChildFlags=0,t.InsertTraitFlags=0,t.RemoveTraitFlags=0,t.StartConsumingFlags=0,t.StopConsumingFlags=0,t})();const f=e.Fastener.extend("ModelRelation",{get fastenerType(){return f},consumed:!1,modelType:null,observes:!1,attachOutlet(t){let e=this.outlets;null===e&&(e=new Set,this.outlets=e),e.add(t)},detachOutlet(t){const e=this.outlets;null!==e&&e.delete(t)},decohereOutlets(){const t=this.outlets;if(null!==t)for(const e of t)e.decohere(this)},initModel(t){},willAttachModel(t,e){},onAttachModel(t,e){this.observes&&t.observe(this),0!=(this.flags&f.ConsumingFlag)&&t.consume(this)},didAttachModel(t,e){},deinitModel(t){},willDetachModel(t){},onDetachModel(t){0!=(this.flags&f.ConsumingFlag)&&t.unconsume(this),this.observes&&t.unobserve(this)},didDetachModel(t){},get parentModel(){const t=this.owner;return t instanceof c?t:t instanceof m?t.model:null},insertChild(t,e,i,s){t.insertChild(e,i,s)},bindModel(t,e){},unbindModel(t){},detectModel:t=>null,createModel(){let t;const e=this.modelType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="model",new Error(t)}return t},fromLike(t){const e=this.modelType;return null!==e?e.fromLike(t):c.fromLike(t)},consume(t){let e=this.consumers;if(null===e)e=new Set,this.consumers=e;else if(e.has(t))return;this.willConsume(t),e.add(t),this.onConsume(t),this.didConsume(t),1===e.size&&this.mounted&&this.startConsuming()},willConsume(t){},onConsume(t){},didConsume(t){},unconsume(t){const e=this.consumers;null!==e&&e.has(t)&&(this.willUnconsume(t),e.delete(t),this.onUnconsume(t),this.didUnconsume(t),0===e.size&&this.stopConsuming())},willUnconsume(t){},onUnconsume(t){},didUnconsume(t){},get consuming(){return 0!=(this.flags&f.ConsumingFlag)},startConsuming(){0==(this.flags&f.ConsumingFlag)&&(this.willStartConsuming(),this.setFlags(this.flags|f.ConsumingFlag),this.onStartConsuming(),this.didStartConsuming())},willStartConsuming(){},onStartConsuming(){},didStartConsuming(){},stopConsuming(){0!=(this.flags&f.ConsumingFlag)&&(this.willStopConsuming(),this.setFlags(this.flags&~f.ConsumingFlag),this.onStopConsuming(),this.didStopConsuming())},willStopConsuming(){},onStopConsuming(){},didStopConsuming(){},onMount(){super.onMount(),null!==this.consumers&&0!==this.consumers.size&&this.startConsuming()},onUnmount(){super.onUnmount(),this.stopConsuming()}},{construct(t,e){return(t=super.construct(t,e)).outlets=null,t.consumers=null,t},ConsumingFlag:1<<e.Fastener.FlagShift+0,FlagShift:e.Fastener.FlagShift+1,FlagMask:(1<<e.Fastener.FlagShift+1)-1}),p=f.extend("ModelRef",{get fastenerType(){return p},get inletModel(){const t=this.inlet;return t instanceof p?t.model:null},getInletModel(){const t=this.inletModel;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="inlet model",new TypeError(e)}return t},get(){return this.model},set(t){return t instanceof e.Fastener?this.bindInlet(t):this.setModel(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):this.setModel(t),this.owner},modelKey:void 0,getModel(){const t=this.model;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="model",new TypeError(e)}return t},setModel(t,e,i){null!==t&&(t=this.fromLike(t));let s,n=this.model;return n===t?(this.setCoherent(!0),n):(void 0===e&&(e=null),this.binds&&(s=this.parentModel,null!==s)&&(null!==n&&n.parent===s&&(null===e&&(e=n.nextSibling),n.remove()),null!==t&&(void 0===i&&(i=this.modelKey),this.insertChild(s,t,e,i)),n=this.model,n===t)||(null!==n&&(this.model=null,this.willDetachModel(n),this.onDetachModel(n),this.deinitModel(n),this.didDetachModel(n)),null!==t&&(this.model=t,this.willAttachModel(t,e),this.onAttachModel(t,e),this.initModel(t),this.didAttachModel(t,e)),this.setCoherent(!0),this.decohereOutlets()),n)},attachModel(t,e){const i=this.model;return void 0===e&&(e=null),i===(t=null!=t?this.fromLike(t):null===i?this.createModel():i)||(null!==i&&(this.model=null,this.willDetachModel(i),this.onDetachModel(i),this.deinitModel(i),this.didDetachModel(i)),this.model=t,this.willAttachModel(t,e),this.onAttachModel(t,e),this.initModel(t),this.didAttachModel(t,e),this.setCoherent(!0),this.decohereOutlets()),t},detachModel(){const t=this.model;return null===t?null:(this.model=null,this.willDetachModel(t),this.onDetachModel(t),this.deinitModel(t),this.didDetachModel(t),this.setCoherent(!0),this.decohereOutlets(),t)},insertModel(t,e,i,s){let n=this.model;return e=null!=e?this.fromLike(e):null===n?this.createModel():n,void 0===t&&(t=null),this.binds||n!==e||null===e.parent||null!==t||void 0!==s?(null===t&&(t=this.parentModel),void 0===i&&(i=null),void 0===s&&(s=this.modelKey),null===t||e.parent===t&&e.key===s||this.insertChild(t,e,i,s),n=this.model,n===e||(null!==n&&(this.model=null,this.willDetachModel(n),this.onDetachModel(n),this.deinitModel(n),this.didDetachModel(n),this.binds&&null!==t&&n.parent===t&&n.remove()),this.model=e,this.willAttachModel(e,i),this.onAttachModel(e,i),this.initModel(e),this.didAttachModel(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},removeModel(){const t=this.model;return null===t?null:(t.remove(),t)},deleteModel(){const t=this.detachModel();return null===t?null:(t.remove(),t)},bindModel(t,e){if(!this.binds||null!==this.model)return;const i=this.detectModel(t);null!==i&&(this.model=i,this.willAttachModel(i,e),this.onAttachModel(i,e),this.initModel(i),this.didAttachModel(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindModel(t){if(!this.binds)return;const e=this.detectModel(t);null!==e&&this.model===e&&(this.model=null,this.willDetachModel(e),this.onDetachModel(e),this.deinitModel(e),this.didDetachModel(e),this.setCoherent(!0),this.decohereOutlets())},detectModel(t){const e=this.modelKey;return void 0!==e&&e===t.key?t:null},onStartConsuming(){const t=this.model;null!==t&&t.consume(this)},onStopConsuming(){const t=this.model;null!==t&&t.unconsume(this)},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof p?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setModel(i.model)):this.setDerived(!1)}},{tryModel(t,i){const s=e.FastenerContext.getMetaclass(t),n=null!==s?s.tryFastener(t,i):null;return n instanceof p?n.model:null},construct(t,e){return(t=super.construct(t,e)).model=null,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"modelKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"modelKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"modelKey",i)))}}),g=f.extend("ModelSet",{get fastenerType(){return g},modelKey(t){},insertModelMap(t,e){const i=this.models;null!==e&&0!=(this.flags&g.OrderedFlag)?this.models=r.Objects.inserted(i,t.uid,t,e):i[t.uid]=t},removeModelMap(t){delete this.models[t.uid]},hasModel(t){return void 0!==this.models[t.uid]},addModel(t,e,i){let s;return t=null!=t?this.fromLike(t):this.createModel(),void 0===e&&(e=null),this.binds&&(s=this.parentModel,null!==s)&&(null===e&&(e=t.parent===s?t.nextSibling:this.getTargetChild(s,t)),void 0===i&&(i=this.modelKey(t)),t.parent===s&&t.nextSibling===e&&t.key===i||this.insertChild(s,t,e,i)),void 0!==this.models[t.uid]||(this.insertModelMap(t,e),this.modelCount+=1,this.willAttachModel(t,e),this.onAttachModel(t,e),this.initModel(t),this.didAttachModel(t,e),this.setCoherent(!0),this.decohereOutlets()),t},addModels(t,e){for(const i in t)this.addModel(t[i],e)},setModels(t,e){const i=this.binds,s=i?this.parentModel:null,n=this.models;for(const e in n)if(void 0===t[e]){const t=this.detachModel(n[e]);null!==t&&i&&null!==s&&t.parent===s&&t.remove()}if(0!=(this.flags&g.OrderedFlag)){const i=new Array;for(const e in t)i.push(t[e]);for(let t=0,s=i.length;t<s;t+=1){const r=i[t];if(void 0===n[r.uid]){const n=t<s+1?i[t+1]:e;this.addModel(r,n)}}}else for(const i in t)void 0===n[i]&&this.addModel(t[i],e)},attachModel(t,e){return t=null!=t?this.fromLike(t):this.createModel(),void 0!==this.models[t.uid]||(void 0===e&&(e=null),this.insertModelMap(t,e),this.modelCount+=1,this.willAttachModel(t,e),this.onAttachModel(t,e),this.initModel(t),this.didAttachModel(t,e),this.setCoherent(!0),this.decohereOutlets()),t},attachModels(t,e){for(const i in t)this.attachModel(t[i],e)},detachModel(t){return void 0===this.models[t.uid]?null:(this.modelCount-=1,this.removeModelMap(t),this.willDetachModel(t),this.onDetachModel(t),this.deinitModel(t),this.didDetachModel(t),this.setCoherent(!0),this.decohereOutlets(),t)},detachModels(t){void 0===t&&(t=this.models);for(const e in t)this.detachModel(t[e])},insertModel(t,e,i,s){return e=null!=e?this.fromLike(e):this.createModel(),void 0===t&&(t=null),this.binds||void 0===this.models[e.uid]||null===e.parent||null!==t||void 0!==s?(null===t&&(t=this.parentModel),void 0===i&&(i=null),void 0===s&&(s=this.modelKey(e)),null===t||e.parent===t&&e.key===s||(null===i&&(i=this.getTargetChild(t,e)),this.insertChild(t,e,i,s)),void 0!==this.models[e.uid]||(this.insertModelMap(e,i),this.modelCount+=1,this.willAttachModel(e,i),this.onAttachModel(e,i),this.initModel(e),this.didAttachModel(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},insertModels(t,e,i){for(const s in e)this.insertModel(t,e[s],i)},removeModel(t){return this.hasModel(t)?(t.remove(),t):t},removeModels(t){void 0===t&&(t=this.models);for(const e in t)this.removeModel(t[e])},deleteModel(t){const e=this.detachModel(t);return null===e?null:(e.remove(),e)},deleteModels(t){void 0===t&&(t=this.models);for(const e in t)this.deleteModel(t[e])},reinsertModel(t,e){if(void 0===this.models[t.uid]||void 0===e&&0==(this.flags&g.SortedFlag))return;const i=t.parent;null!==i&&(void 0===e&&(e=this.getTargetChild(i,t)),i.reinsertChild(t,e))},bindModel(t,e){if(!this.binds)return;const i=this.detectModel(t);null!==i&&void 0===this.models[i.uid]&&(this.insertModelMap(i,e),this.modelCount+=1,this.willAttachModel(i,e),this.onAttachModel(i,e),this.initModel(i),this.didAttachModel(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindModel(t){if(!this.binds)return;const e=this.detectModel(t);null!==e&&void 0!==this.models[e.uid]&&(this.modelCount-=1,this.removeModelMap(e),this.willDetachModel(e),this.onDetachModel(e),this.deinitModel(e),this.didDetachModel(e),this.setCoherent(!0),this.decohereOutlets())},detectModel(t){return"function"==typeof this.modelType&&t instanceof this.modelType?t:null},consumeModels(t){const e=this.models;for(const i in e)e[i].consume(t)},unconsumeModels(t){const e=this.models;for(const i in e)e[i].unconsume(t)},onStartConsuming(){this.consumeModels(this)},onStopConsuming(){this.unconsumeModels(this)},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof g?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setModels(i.models)):this.setDerived(!1)},get ordered(){return 0!=(this.flags&g.OrderedFlag)},order(t){return void 0===t&&(t=!0),t?this.setFlags(this.flags|g.OrderedFlag):this.setFlags(this.flags&~g.OrderedFlag),this},get sorted(){return 0!=(this.flags&g.SortedFlag)},sort(t){if(void 0===t&&(t=!0),t){const t=this.parentModel;this.willSort(t),this.setFlags(this.flags|g.SortedFlag),this.onSort(t),this.didSort(t)}else this.setFlags(this.flags&~g.SortedFlag);return this},willSort(t){},onSort(t){null!==t&&this.sortChildren(t)},didSort(t){},sortChildren(t,e){t.sortChildren(this.compareChildren.bind(this))},getTargetChild(t,e){return 0!=(this.flags&g.SortedFlag)?t.getTargetChild(e,this.compareTargetChild.bind(this)):null},compareChildren(t,e){const i=this.models,s=i[t.uid],n=i[e.uid];return void 0!==s&&void 0!==n?this.compare(s,n):void 0!==s?1:void 0!==n?-1:0},compareTargetChild(t,e){const i=this.models[e.uid];return void 0!==i?this.compare(t,i):void 0!==i?-1:0},compare:(t,e)=>t.uid<e.uid?-1:t.uid>e.uid?1:0},{construct(t,e){return(t=super.construct(t,e)).models={},t.modelCount=0,t},refine(t){super.refine(t);const e=t.prototype;let i=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"ordered")&&(e.ordered?i|=g.OrderedFlag:i&=~g.OrderedFlag,delete e.ordered),Object.prototype.hasOwnProperty.call(e,"sorted")&&(e.sorted?i|=g.SortedFlag:i&=~g.SortedFlag,delete e.sorted),Object.defineProperty(e,"flagsInit",{value:i,enumerable:!0,configurable:!0})},OrderedFlag:1<<f.FlagShift+0,SortedFlag:1<<f.FlagShift+1,FlagShift:f.FlagShift+2,FlagMask:(1<<f.FlagShift+2)-1});let m=(()=>{var t;let o,l,a,h,p=[];return t=class{constructor(){this.uid=void u(this,p),this.uid=this.constructor.uid(),this.key=void 0,this.flags=0,this.model=null,this.nextTrait=null,this.previousTrait=null,this.coherentTime=0,this.decoherent=null,this.recohering=null,this.observers=null,this.consumers=null}setKey(t){this.key=t}setFlags(t){this.flags=t}getModel(){const t=this.model;if(null===t)throw new TypeError("no model");return t}attachModel(t,e){let i;this.willAttachModel(t),this.model=t,null!==e?(i=e.previousTrait,this.setNextTrait(e),e.setPreviousTrait(this)):(i=t.lastTrait,t.setLastTrait(this)),null!==i?(i.setNextTrait(this),this.setPreviousTrait(i)):t.setFirstTrait(this),t.mounted&&this.mountTrait(),this.onAttachModel(t),this.didAttachModel(t)}willAttachModel(t){this.callObservers("traitWillAttachModel",t,this)}onAttachModel(t){this.bindModelFasteners(t)}didAttachModel(t){this.callObservers("traitDidAttachModel",t,this)}detachModel(t){this.willDetachModel(t),this.mounted&&this.unmountTrait(),this.onDetachModel(t);const e=this.nextTrait,i=this.previousTrait;null!==e?(this.setNextTrait(null),e.setPreviousTrait(i)):t.setLastTrait(i),null!==i?(i.setNextTrait(e),this.setPreviousTrait(null)):t.setFirstTrait(e),this.model=null,this.didDetachModel(t)}willDetachModel(t){this.callObservers("traitWillDetachModel",t,this)}onDetachModel(t){this.unbindModelFasteners(t)}didDetachModel(t){this.callObservers("traitDidDetachModel",t,this)}get modelFlags(){const t=this.model;return null!==t?t.flags:0}setModelFlags(t){const e=this.model;if(null===e)throw new Error("no model");e.setFlags(t)}remove(){const t=this.model;null!==t&&t.removeTrait(this)}get parent(){const t=this.model;return null!==t?t.parent:null}willAttachParent(t){this.callObservers("traitWillAttachParent",t,this)}onAttachParent(t){}didAttachParent(t){this.callObservers("traitDidAttachParent",t,this)}willDetachParent(t){this.callObservers("traitWillDetachParent",t,this)}onDetachParent(t){}didDetachParent(t){this.callObservers("traitDidDetachParent",t,this)}get nextSibling(){const t=this.model;return null!==t?t.nextSibling:null}get previousSibling(){const t=this.model;return null!==t?t.previousSibling:null}get firstChild(){const t=this.model;return null!==t?t.firstChild:null}get lastChild(){const t=this.model;return null!==t?t.lastChild:null}forEachChild(t,e){const i=this.model;return null!==i?i.forEachChild(t,e):void 0}getChild(t,e){const i=this.model;return null!==i?i.getChild(t,e):null}setChild(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.setChild(t,e)}appendChild(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.appendChild(t,e)}prependChild(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.prependChild(t,e)}insertChild(t,e,i){const s=this.model;if(null===s)throw new Error("no model");return s.insertChild(t,e,i)}reinsertChild(t,e){const i=this.model;if(null===i)throw new Error("no model");i.reinsertChild(t,e)}replaceChild(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.replaceChild(t,e)}get insertChildFlags(){return this.constructor.InsertChildFlags}willInsertChild(t,e){this.callObservers("traitWillInsertChild",t,e,this)}onInsertChild(t,e){this.requireUpdate(this.insertChildFlags),this.bindChildFasteners(t,e)}didInsertChild(t,e){this.callObservers("traitDidInsertChild",t,e,this)}removeChild(t){const e=this.model;return null!==e?e.removeChild(t):null}get removeChildFlags(){return this.constructor.RemoveChildFlags}willRemoveChild(t){this.callObservers("traitWillRemoveChild",t,this),this.requireUpdate(this.removeChildFlags)}onRemoveChild(t){this.unbindChildFasteners(t)}didRemoveChild(t){this.callObservers("traitDidRemoveChild",t,this)}get reinsertChildFlags(){return this.constructor.ReinsertChildFlags}willReinsertChild(t,e){this.callObservers("traitWillReinsertChild",t,e,this)}onReinsertChild(t,e){this.requireUpdate(this.reinsertChildFlags)}didReinsertChild(t,e){this.callObservers("traitDidReinsertChild",t,e,this)}removeChildren(){const t=this.model;if(null!==t)return t.removeChildren()}sortChildren(t){const e=this.model;if(null!==e)return e.sortChildren(t)}getTargetChild(t,e){const i=this.model;return null!==i?i.getTargetChild(t,e):null}getAncestor(t){const e=this.model;return null!==e?e.getAncestor(t):null}getRoot(t){const e=this.model;return null!==e?e.getRoot(t):null}setNextTrait(t){this.nextTrait=t}setPreviousTrait(t){this.previousTrait=t}get firstTrait(){const t=this.model;return null!==t?t.firstTrait:null}get lastTrait(){const t=this.model;return null!==t?t.lastTrait:null}forEachTrait(t,e){const i=this.model;return null!==i?i.forEachTrait(t,e):void 0}findTrait(t,e){const i=this.model;return null!==i?i.findTrait(t,e):null}getTrait(t,e){const i=this.model;return null!==i?i.getTrait(t,e):null}setTrait(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.setTrait(t,e)}appendTrait(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.appendTrait(t,e)}prependTrait(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.prependTrait(t,e)}insertTrait(t,e,i){const s=this.model;if(null===s)throw new Error("no model");return s.insertTrait(t,e,i)}replaceTrait(t,e){const i=this.model;if(null===i)throw new Error("no model");return i.replaceTrait(t,e)}get insertTraitFlags(){return this.constructor.InsertTraitFlags}get inserting(){return 0!=(this.flags&t.InsertingFlag)}willInsertTrait(t,e){this.callObservers("traitWillInsertTrait",t,e,this)}onInsertTrait(t,e){this.requireUpdate(this.insertTraitFlags),this.bindTraitFasteners(t,e)}didInsertTrait(t,e){this.callObservers("traitDidInsertTrait",t,e,this)}removeTrait(t){const e=this.model;return null!==e?e.removeTrait(t):null}get removeTraitFlags(){return this.constructor.RemoveTraitFlags}get removing(){return 0!=(this.flags&t.RemovingFlag)}willRemoveTrait(t){this.callObservers("traitWillRemoveTrait",t,this)}onRemoveTrait(t){this.requireUpdate(this.removeTraitFlags),this.unbindTraitFasteners(t)}didRemoveTrait(t){this.callObservers("traitDidRemoveTrait",t,this)}sortTraits(t){const e=this.model;null!==e&&e.sortTraits(t)}getAncestorTrait(t){const e=this.model;return null!==e?e.getAncestorTrait(t):null}getRootTrait(t){const e=this.model;return null!==e?e.getRootTrait(t):null}get hostUri(){return e.Property.getter()}get nodeUri(){return e.Property.getter()}get laneUri(){return e.Property.getter()}downlink(t){let e=n.EventDownlink;return void 0!==t&&(e=e.define("downlink",t)),e.create(this)}downlinkValue(t){let e=n.ValueDownlink;return void 0!==t&&(e=e.define("downlinkValue",t)),e.create(this)}downlinkList(t){let e=n.ListDownlink;return void 0!==t&&(e=e.define("downlinkList",t)),e.create(this)}downlinkMap(t){let e=n.MapDownlink;return void 0!==t&&(e=e.define("downlinkMap",t)),e.create(this)}command(t,e,n,r){void 0===e?(r=i.Value.fromLike(t),n=this.laneUri.getValue(),e=this.nodeUri.getValue(),t=this.hostUri.value):void 0===n?(r=i.Value.fromLike(e),n=s.Uri.fromLike(t),e=this.nodeUri.getValue(),t=this.hostUri.value):void 0===r?(r=i.Value.fromLike(n),n=s.Uri.fromLike(e),e=s.Uri.fromLike(t),t=this.hostUri.value):(r=i.Value.fromLike(r),n=s.Uri.fromLike(n),e=s.Uri.fromLike(e),t=s.Uri.fromLike(t)),null===t&&(t=e.endpoint(),e=t.unresolve(e));this.warpRef.value.command(t,e,n,r)}authenticate(t,e){void 0===e?(e=i.Value.fromLike(t),t=this.hostUri.getValue()):(e=i.Value.fromLike(e),t=s.Uri.fromLike(t));this.warpRef.value.authenticate(t,e)}hostRef(t){t=s.Uri.fromLike(t);const e=new c;return e.hostUri.set(t),this.appendChild(e),e}nodeRef(t,e){void 0===e?(t=(e=s.Uri.fromLike(t)).endpoint()).isDefined()?e=t.unresolve(e):t=void 0:(e=s.Uri.fromLike(e),t=s.Uri.fromLike(t));const i=new c;return void 0!==t&&i.hostUri.set(t),void 0!==e&&i.nodeUri.set(e),this.appendChild(i),i}laneRef(t,e,i){void 0===e?(i=s.Uri.fromLike(t),e=void 0,t=void 0):void 0===i?(i=s.Uri.fromLike(e),(t=(e=s.Uri.fromLike(t)).endpoint()).isDefined()?e=t.unresolve(e):t=void 0):(i=s.Uri.fromLike(i),e=s.Uri.fromLike(e),t=s.Uri.fromLike(t));const n=new c;return void 0!==t&&n.hostUri.set(t),void 0!==e&&n.nodeUri.set(e),void 0!==i&&n.laneUri.set(i),this.appendChild(n),n}getDownlink(t,e,i){return this.warpRef.value.getDownlink(t,e,i)}openDownlink(t){this.warpRef.value.openDownlink(t)}get warpRef(){return e.Property.getter()}get mounted(){return 0!=(this.flags&t.MountedFlag)}get mountFlags(){return this.constructor.MountFlags}mountTrait(){if(0!=(this.flags&t.MountedFlag))throw new Error("already mounted");this.setFlags(this.flags|t.MountedFlag),this.willMount(),this.onMount(),this.didMount()}willMount(){this.callObservers("traitWillMount",this)}onMount(){}didMount(){this.requireUpdate(this.mountFlags),null!==this.decoherent&&0!==this.decoherent.length&&this.requireUpdate(c.NeedsMutate),this.mountFasteners(),null!==this.consumers&&0!==this.consumers.size&&this.startConsuming(),this.callObservers("traitDidMount",this)}unmountTrait(){if(0==(this.flags&t.MountedFlag))throw new Error("already unmounted");this.setFlags(this.flags&~t.MountedFlag),this.willUnmount(),this.onUnmount(),this.didUnmount()}willUnmount(){this.callObservers("traitWillUnmount",this),this.stopConsuming(),this.unmountFasteners()}onUnmount(){}didUnmount(){this.callObservers("traitDidUnmount",this)}requireUpdate(t,e=!1){const i=this.model;null!==i&&i.requireUpdate(t,e)}needsUpdate(t,e){return t}requestUpdate(t,e,i){const s=this.model;if(null===s)throw new TypeError("no model");s.requestUpdate(t,e,i)}get updating(){const t=this.model;return null!==t&&t.updating}get analyzing(){const t=this.model;return null!==t&&t.analyzing}needsAnalyze(t){return t}willAnalyze(t){}onAnalyze(t){}didAnalyze(t){}willMutate(){this.callObservers("traitWillMutate",this)}onMutate(){this.recohereFasteners(this.updateTime)}didMutate(){this.callObservers("traitDidMutate",this)}willAggregate(){this.callObservers("traitWillAggregate",this)}onAggregate(){}didAggregate(){this.callObservers("traitDidAggregate",this)}willCorrelate(){this.callObservers("traitWillCorrelate",this)}onCorrelate(){}didCorrelate(){this.callObservers("traitDidCorrelate",this)}analyzeChildren(t,e,i){i.call(this.model,t,e)}get refreshing(){const t=this.model;return null!==t&&t.refreshing}needsRefresh(t){return t}willRefresh(t){}onRefresh(t){}didRefresh(t){}willValidate(){this.callObservers("traitWillValidate",this)}onValidate(){}didValidate(){this.callObservers("traitDidValidate",this)}willReconcile(){this.callObservers("traitWillReconcile",this)}onReconcile(){this.recohereDownlinks(this.updateTime)}didReconcile(){this.callObservers("traitDidReconcile",this)}refreshChildren(t,e,i){i.call(this.model,t,e)}tryFastener(t){const i=e.FastenerContext.getMetaclass(this);return null!==i?i.tryFastener(this,t):null}getFastener(t,e,i){if(null!=i&&!(this instanceof i))return null;const s=this[t];return void 0!==s&&(null==e||s instanceof e)?s:null}getParentFastener(e,i,s){let n,r=this.model;if(null===r)return null;if(null!=s&&(s===t||s.prototype instanceof t)){for(r=r.parent;null!==r;){if(n=r.getTraitFastener(e,i,s),null!==n)return n;r=r.parent}return null}do{if(n=r.getFastener(e,i,s),null!==n)return n;r=r.parent}while(null!==r);return null}attachFastener(t){this.mounted&&t.mount(),this.bindFastener(t)}mountFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const s=this[i[t]];s instanceof e.Fastener&&s.mount()}}unmountFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const s=this[i[t]];s instanceof e.Fastener&&s.unmount()}}bindFastener(t){(t instanceof f||t instanceof v)&&t.binds&&this.forEachChild((function(e){t.bindModel(e,null)}),this),t instanceof v&&t.binds&&this.forEachTrait((function(e){t.bindTrait(e,null)}),this),this.consuming&&(t instanceof n.WarpDownlink&&!0===t.consumed||t instanceof v&&!0===t.consumed||t instanceof f&&!0===t.consumed)&&t.consume(this)}bindModelFasteners(t){const i=e.FastenerContext.getMetaclass(this);if(null===i)return;const s=i.slots;t.forEachChild((function(t){for(let i=0;i<s.length;i+=1){const n=this[s[i]];n instanceof e.Fastener&&this.bindChildFastener(n,t,null)}}),this),t.forEachTrait((function(t){for(let i=0;i<s.length;i+=1){const n=this[s[i]];n instanceof e.Fastener&&this.bindTraitFastener(n,t,null)}}),this)}unbindModelFasteners(t){const i=e.FastenerContext.getMetaclass(this);if(null===i)return;const s=i.slots;t.forEachTrait((function(t){for(let i=0;i<s.length;i+=1){const n=this[s[i]];n instanceof e.Fastener&&this.unbindTraitFastener(n,t)}}),this),t.forEachChild((function(t){for(let i=0;i<s.length;i+=1){const n=this[s[i]];n instanceof e.Fastener&&this.unbindChildFastener(n,t)}}),this)}bindChildFasteners(t,i){const s=e.FastenerContext.getMetaclass(this);if(null===s)return;const n=s.slots;for(let s=0;s<n.length;s+=1){const r=this[n[s]];r instanceof e.Fastener&&this.bindChildFastener(r,t,i)}}bindChildFastener(t,e,i){(t instanceof f||t instanceof v)&&t.bindModel(e,i)}unbindChildFasteners(t){const i=e.FastenerContext.getMetaclass(this);if(null===i)return;const s=i.slots;for(let i=0;i<s.length;i+=1){const n=this[s[i]];n instanceof e.Fastener&&this.unbindChildFastener(n,t)}}unbindChildFastener(t,e){(t instanceof f||t instanceof v)&&t.unbindModel(e)}bindTraitFasteners(t,i){const s=e.FastenerContext.getMetaclass(this);if(null===s)return;const n=s.slots;for(let s=0;s<n.length;s+=1){const r=this[n[s]];r instanceof e.Fastener&&this.bindTraitFastener(r,t,i)}}bindTraitFastener(t,e,i){t instanceof v&&t.bindTrait(e,i)}unbindTraitFasteners(t){const i=e.FastenerContext.getMetaclass(this);if(null===i)return;const s=i.slots;for(let i=0;i<s.length;i+=1){const n=this[s[i]];n instanceof e.Fastener&&this.unbindTraitFastener(n,t)}}unbindTraitFastener(t,e){t instanceof v&&t.unbindTrait(e)}set(t,i){for(const s in t){const n=t[s],r=this[s];if(null==r)throw new Error("unknown property "+s);if(void 0===r.set)throw new Error("unsettable property "+s);r instanceof e.Animator?r.set(n,i):r.set(n)}return this}setIntrinsic(t,i){for(const s in t){const n=t[s],r=this[s];if(null==r)throw new Error("unknown property "+s);if(void 0===r.setIntrinsic)throw new Error("unsettable property "+s);r instanceof e.Animator?r.setIntrinsic(n,i):r.setIntrinsic(n)}return this}decohereFastener(t){const e=this.recohering;null===e||t.coherentTime===this.coherentTime?this.enqueueFastener(t):e.push(t)}enqueueFastener(t){let e=this.decoherent;null===e&&(e=[],this.decoherent=e),e.push(t),t instanceof n.WarpDownlink?this.requireUpdate(c.NeedsReconcile):this.requireUpdate(c.NeedsMutate)}recohereFasteners(t){const e=this.decoherent;if(null!==e&&0!==e.length){void 0===t&&(t=performance.now()),this.coherentTime=t,this.decoherent=null,this.recohering=e;try{for(let i=0;i<e.length;i+=1){const s=e[i];s instanceof n.WarpDownlink?this.enqueueFastener(s):s.recohere(t)}}finally{this.recohering=null}}}recohereDownlinks(t){const e=this.decoherent;if(null===e||0===e.length)return;let i=!1;this.coherentTime=t,this.decoherent=null,this.recohering=e;try{for(let s=0;s<e.length;s+=1){const r=e[s];r instanceof n.WarpDownlink?(i||(i=!0,this.hostUri.recohere(t),this.nodeUri.recohere(t),this.laneUri.recohere(t)),r.recohere(t)):this.enqueueFastener(r)}}finally{this.recohering=null}}observe(t){let e=this.observers;if(null===e)e=new Set,this.observers=e;else if(e.has(t))return;this.willObserve(t),e.add(t),this.onObserve(t),this.didObserve(t)}willObserve(t){}onObserve(t){}didObserve(t){}unobserve(t){const e=this.observers;null!==e&&e.has(t)&&(this.willUnobserve(t),e.delete(t),this.onUnobserve(t),this.didUnobserve(t))}willUnobserve(t){}onUnobserve(t){}didUnobserve(t){}callObservers(t,...e){const i=this.observers;if(null!==i)for(const s of i){const i=s[t];"function"==typeof i&&i.call(s,...e)}}consume(t){let e=this.consumers;if(null===e)e=new Set,this.consumers=e;else if(e.has(t))return;this.willConsume(t),e.add(t),this.onConsume(t),this.didConsume(t),1===e.size&&this.mounted&&this.startConsuming()}willConsume(t){}onConsume(t){}didConsume(t){}unconsume(t){const e=this.consumers;null!==e&&e.has(t)&&(this.willUnconsume(t),e.delete(t),this.onUnconsume(t),this.didUnconsume(t),0===e.size&&this.stopConsuming())}willUnconsume(t){}onUnconsume(t){}didUnconsume(t){}get consuming(){return 0!=(this.flags&t.ConsumingFlag)}get startConsumingFlags(){return this.constructor.StartConsumingFlags}startConsuming(){0==(this.flags&t.ConsumingFlag)&&(this.willStartConsuming(),this.setFlags(this.flags|t.ConsumingFlag),this.onStartConsuming(),this.didStartConsuming())}willStartConsuming(){this.callObservers("traitWillStartConsuming",this)}onStartConsuming(){this.requireUpdate(this.startConsumingFlags),this.startConsumingFasteners()}didStartConsuming(){this.callObservers("traitDidStartConsuming",this)}get stopConsumingFlags(){return this.constructor.StopConsumingFlags}stopConsuming(){0!=(this.flags&t.ConsumingFlag)&&(this.willStopConsuming(),this.setFlags(this.flags&~t.ConsumingFlag),this.onStopConsuming(),this.didStopConsuming())}willStopConsuming(){this.callObservers("traitWillStopConsuming",this)}onStopConsuming(){this.requireUpdate(this.stopConsumingFlags),this.stopConsumingFasteners()}didStopConsuming(){this.callObservers("traitDidStopConsuming",this)}startConsumingFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const e=this[i[t]];(e instanceof n.WarpDownlink&&!0===e.consumed||e instanceof v&&!0===e.consumed||e instanceof f&&!0===e.consumed)&&e.consume(this)}}stopConsumingFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const e=this[i[t]];(e instanceof n.WarpDownlink&&!0===e.consumed||e instanceof v&&!0===e.consumed||e instanceof f&&!0===e.consumed)&&e.unconsume(this)}}get updateTime(){return this.getModel().updateTime}equals(t){return this===t}hashCode(){return r.Murmur3.mash(r.Murmur3.mixString(0,this.uid))}static create(){return new this}static fromLike(e){if(null==e)return e;if(e instanceof t){if(!(e instanceof this))throw new TypeError(e+" not an instance of "+this);return e}if(r.Creatable[Symbol.hasInstance](e))return e.create();throw new TypeError(""+this)}static initDecorators(){if(!Object.hasOwnProperty.call(this,Symbol.metadata)){const t=Object.getPrototypeOf(this)[Symbol.metadata];Object.defineProperty(this,Symbol.metadata,{value:Object.create(void 0!==t?t:null),writable:!0,enumerable:!0,configurable:!0})}Object.hasOwnProperty.call(this,"fieldInitializers")||Object.defineProperty(this,"fieldInitializers",{value:{},enumerable:!0,configurable:!0}),Object.hasOwnProperty.call(this,"instanceInitializers")||Object.defineProperty(this,"instanceInitializers",{value:[],enumerable:!0,configurable:!0})}static defineField(t,e){const i=this;i.initDecorators(),d(null,null,e,{kind:"field",name:t,static:!1,private:!1,access:{has:e=>t in e,get:e=>e[t],set(e,i){e[t]=i}},metadata:i[Symbol.metadata]},i.fieldInitializers[t]=[],i.instanceInitializers)}static defineGetter(t,i){const s=this;s.initDecorators(),Object.defineProperty(s.prototype,t,{get:e.Fastener.getter,enumerable:!0,configurable:!0}),d(s,null,i,{kind:"getter",name:t,static:!1,private:!1,access:{has:e=>t in e,get:e=>e[t],set(e,i){e[t]=i}},metadata:s[Symbol.metadata]},null,s.instanceInitializers)}static initFasteners(t){const e=this;if(Object.hasOwnProperty.call(e,"fieldInitializers")&&Object.hasOwnProperty.call(e,"instanceInitializers")){u(t,e.instanceInitializers);for(const i in e.fieldInitializers)t[i]=u(t,e.fieldInitializers[i],void 0)}}},(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;o=[e.Property({valueType:s.Uri,value:null,inherits:!0,get parentType(){return m},updateFlags:c.NeedsReconcile})],l=[e.Property({valueType:s.Uri,value:null,inherits:!0,get parentType(){return m},updateFlags:c.NeedsReconcile})],a=[e.Property({valueType:s.Uri,value:null,inherits:!0,get parentType(){return m},updateFlags:c.NeedsReconcile})],h=[e.Property({valueType:n.WarpRef,inherits:!0,updateFlags:c.NeedsReconcile,initValue:()=>n.WarpClient.global(),equalValues:(t,e)=>t===e})],d(t,null,o,{kind:"getter",name:"hostUri",static:!1,private:!1,access:{has:t=>"hostUri"in t,get:t=>t.hostUri},metadata:i},null,p),d(t,null,l,{kind:"getter",name:"nodeUri",static:!1,private:!1,access:{has:t=>"nodeUri"in t,get:t=>t.nodeUri},metadata:i},null,p),d(t,null,a,{kind:"getter",name:"laneUri",static:!1,private:!1,access:{has:t=>"laneUri"in t,get:t=>t.laneUri},metadata:i},null,p),d(t,null,h,{kind:"getter",name:"warpRef",static:!1,private:!1,access:{has:t=>"warpRef"in t,get:t=>t.warpRef},metadata:i},null,p),i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.uid=function(){let t=1;return function(){const e=~~t;return t+=1,"trait"+e}}(),t.MountedFlag=1,t.InsertingFlag=2,t.RemovingFlag=4,t.ConsumingFlag=8,t.FlagShift=4,t.FlagMask=(1<<t.FlagShift)-1,t.MountFlags=0,t.InsertChildFlags=0,t.RemoveChildFlags=0,t.ReinsertChildFlags=0,t.InsertTraitFlags=0,t.RemoveTraitFlags=0,t.StartConsumingFlags=0,t.StopConsumingFlags=0,t})();const v=e.Fastener.extend("TraitRelation",{get fastenerType(){return v},consumed:!1,traitType:null,observes:!1,attachOutlet(t){let e=this.outlets;null===e&&(e=new Set,this.outlets=e),e.add(t)},detachOutlet(t){const e=this.outlets;null!==e&&e.delete(t)},decohereOutlets(){const t=this.outlets;if(null!==t)for(const e of t)e.decohere(this)},initTrait(t){},willAttachTrait(t,e){},onAttachTrait(t,e){this.observes&&t.observe(this),0!=(this.flags&v.ConsumingFlag)&&t.consume(this)},didAttachTrait(t,e){},deinitTrait(t){},willDetachTrait(t){},onDetachTrait(t){0!=(this.flags&v.ConsumingFlag)&&t.unconsume(this),this.observes&&t.unobserve(this)},didDetachTrait(t){},get parentModel(){const t=this.owner;return t instanceof c?t:t instanceof m?t.model:null},insertChild(t,e,i,s){t.insertTrait(e,i,s)},bindModel(t,e){},unbindModel(t){},detectModel:t=>null,bindTrait(t,e){},unbindTrait(t){},detectTrait:t=>null,createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t},fromLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},consume(t){let e=this.consumers;if(null===e)e=new Set,this.consumers=e;else if(e.has(t))return;this.willConsume(t),e.add(t),this.onConsume(t),this.didConsume(t),1===e.size&&this.mounted&&this.startConsuming()},willConsume(t){},onConsume(t){},didConsume(t){},unconsume(t){const e=this.consumers;null!==e&&e.has(t)&&(this.willUnconsume(t),e.delete(t),this.onUnconsume(t),this.didUnconsume(t),0===e.size&&this.stopConsuming())},willUnconsume(t){},onUnconsume(t){},didUnconsume(t){},get consuming(){return 0!=(this.flags&v.ConsumingFlag)},startConsuming(){0==(this.flags&v.ConsumingFlag)&&(this.willStartConsuming(),this.setFlags(this.flags|v.ConsumingFlag),this.onStartConsuming(),this.didStartConsuming())},willStartConsuming(){},onStartConsuming(){},didStartConsuming(){},stopConsuming(){0!=(this.flags&v.ConsumingFlag)&&(this.willStopConsuming(),this.setFlags(this.flags&~v.ConsumingFlag),this.onStopConsuming(),this.didStopConsuming())},willStopConsuming(){},onStopConsuming(){},didStopConsuming(){},onMount(){super.onMount(),null!==this.consumers&&0!==this.consumers.size&&this.startConsuming()},onUnmount(){super.onUnmount(),this.stopConsuming()}},{construct(t,e){return(t=super.construct(t,e)).outlets=null,t.consumers=null,t},ConsumingFlag:1<<e.Fastener.FlagShift+0,FlagShift:e.Fastener.FlagShift+1,FlagMask:(1<<e.Fastener.FlagShift+1)-1}),w=v.extend("TraitRef",{get fastenerType(){return w},get inletTrait(){const t=this.inlet;return t instanceof w?t.trait:null},getInletTrait(){const t=this.inletTrait;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="inlet trait",new TypeError(e)}return t},get(){return this.trait},set(t){return t instanceof e.Fastener?this.bindInlet(t):this.setTrait(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):this.setTrait(t),this.owner},traitKey:void 0,getTrait(){const t=this.trait;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="trait",new TypeError(e)}return t},setTrait(t,e,i){null!==t&&(t=this.fromLike(t));let s,n=this.trait;return n===t?(this.setCoherent(!0),n):(void 0===e&&(e=null),this.binds&&(s=this.parentModel,null!==s)&&(null!==n&&n.model===s&&(null===e&&(e=n.nextTrait),n.remove()),null!==t&&(void 0===i&&(i=this.traitKey),this.insertChild(s,t,e,i)),n=this.trait,n===t)||(null!==n&&(this.trait=null,this.willDetachTrait(n),this.onDetachTrait(n),this.deinitTrait(n),this.didDetachTrait(n)),null!==t&&(this.trait=t,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e)),this.setCoherent(!0),this.decohereOutlets()),n)},attachTrait(t,e){const i=this.trait;return void 0===e&&(e=null),i===(t=null!=t?this.fromLike(t):null===i?this.createTrait():i)||(null!==i&&(this.trait=null,this.willDetachTrait(i),this.onDetachTrait(i),this.deinitTrait(i),this.didDetachTrait(i)),this.trait=t,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e),this.setCoherent(!0),this.decohereOutlets()),t},detachTrait(){const t=this.trait;return null===t?null:(this.trait=null,this.willDetachTrait(t),this.onDetachTrait(t),this.deinitTrait(t),this.didDetachTrait(t),this.setCoherent(!0),this.decohereOutlets(),t)},insertTrait(t,e,i,s){let n=this.trait;return e=null!=e?this.fromLike(e):null===n?this.createTrait():n,void 0===t&&(t=null),this.binds||n!==e||null===e.model||null!==t||void 0!==s?(null===t&&(t=this.parentModel),void 0===i&&(i=null),void 0===s&&(s=this.traitKey),null===t||e.model===t&&e.key===s||this.insertChild(t,e,i,s),n=this.trait,n===e||(null!==n&&(this.trait=null,this.willDetachTrait(n),this.onDetachTrait(n),this.deinitTrait(n),this.didDetachTrait(n),this.binds&&null!==t&&n.model===t&&n.remove()),this.trait=e,this.willAttachTrait(e,i),this.onAttachTrait(e,i),this.initTrait(e),this.didAttachTrait(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},removeTrait(){const t=this.trait;return null===t?null:(t.remove(),t)},deleteTrait(){const t=this.detachTrait();return null===t?null:(t.remove(),t)},bindModel(t,e){if(!this.binds||null!==this.trait)return;const i=this.detectModel(t);null!==i&&(this.trait=i,this.willAttachTrait(i,null),this.onAttachTrait(i,null),this.initTrait(i),this.didAttachTrait(i,null),this.setCoherent(!0),this.decohereOutlets())},unbindModel(t){if(!this.binds)return;const e=this.detectModel(t);null!==e&&this.trait===e&&(this.trait=null,this.willDetachTrait(e),this.onDetachTrait(e),this.deinitTrait(e),this.didDetachTrait(e),this.setCoherent(!0),this.decohereOutlets())},detectModel:t=>null,bindTrait(t,e){if(!this.binds||null!==this.trait)return;const i=this.detectTrait(t);null!==i&&(this.trait=i,this.willAttachTrait(i,e),this.onAttachTrait(i,e),this.initTrait(i),this.didAttachTrait(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindTrait(t){if(!this.binds)return;const e=this.detectTrait(t);null!==e&&this.trait===e&&(this.trait=null,this.willDetachTrait(e),this.onDetachTrait(e),this.deinitTrait(e),this.didDetachTrait(e),this.setCoherent(!0),this.decohereOutlets())},detectTrait(t){const e=this.traitKey;return void 0!==e&&e===t.key?t:null},onStartConsuming(){const t=this.trait;null!==t&&t.consume(this)},onStopConsuming(){const t=this.trait;null!==t&&t.unconsume(this)},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof w?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setTrait(i.trait)):this.setDerived(!1)}},{tryTrait(t,i){const s=e.FastenerContext.getMetaclass(t),n=null!==s?s.tryFastener(t,i):null;return n instanceof w?n.trait:null},construct(t,e){return(t=super.construct(t,e)).trait=null,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"traitKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"traitKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"traitKey",i)))}}),y=v.extend("TraitSet",{get fastenerType(){return y},traitKey(t){},insertTraitMap(t,e){const i=this.traits;null!==e&&0!=(this.flags&y.OrderedFlag)?this.traits=r.Objects.inserted(i,t.uid,t,e):i[t.uid]=t},removeTraitMap(t){delete this.traits[t.uid]},hasTrait(t){return void 0!==this.traits[t.uid]},addTrait(t,e,i){let s;return t=null!=t?this.fromLike(t):this.createTrait(),void 0===e&&(e=null),this.binds&&(s=this.parentModel,null!==s)&&(null===e&&(e=t.model===s?t.nextTrait:this.getTargetChild(s,t)),void 0===i&&(i=this.traitKey(t)),t.model===s&&t.nextTrait===e&&t.key===i||this.insertChild(s,t,e,i)),void 0!==this.traits[t.uid]||(this.insertTraitMap(t,e),this.traitCount+=1,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e),this.setCoherent(!0),this.decohereOutlets()),t},addTraits(t,e){for(const i in t)this.addTrait(t[i],e)},setTraits(t,e){const i=this.binds,s=i?this.parentModel:null,n=this.traits;for(const e in n)if(void 0===t[e]){const t=this.detachTrait(n[e]);null!==t&&i&&null!==s&&t.model===s&&t.remove()}if(0!=(this.flags&y.OrderedFlag)){const i=new Array;for(const e in t)i.push(t[e]);for(let t=0,s=i.length;t<s;t+=1){const r=i[t];if(void 0===n[r.uid]){const n=t<s+1?i[t+1]:e;this.addTrait(r,n)}}}else for(const i in t)void 0===n[i]&&this.addTrait(t[i],e)},attachTrait(t,e){return t=null!=t?this.fromLike(t):this.createTrait(),void 0!==this.traits[t.uid]||(void 0===e&&(e=null),this.insertTraitMap(t,e),this.traitCount+=1,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e),this.setCoherent(!0),this.decohereOutlets()),t},attachTraits(t,e){for(const i in t)this.attachTrait(t[i],e)},detachTrait(t){return void 0===this.traits[t.uid]?null:(this.traitCount-=1,this.removeTraitMap(t),this.willDetachTrait(t),this.onDetachTrait(t),this.deinitTrait(t),this.didDetachTrait(t),this.setCoherent(!0),this.decohereOutlets(),t)},detachTraits(t){void 0===t&&(t=this.traits);for(const e in t)this.detachTrait(t[e])},insertTrait(t,e,i,s){return e=null!=e?this.fromLike(e):this.createTrait(),void 0===t&&(t=null),this.binds||void 0===this.traits[e.uid]||null===e.model||null!==t||void 0!==s?(null===t&&(t=this.parentModel),void 0===i&&(i=null),void 0===s&&(s=this.traitKey(e)),null===t||e.model===t&&e.key===s||(null===i&&(i=this.getTargetChild(t,e)),this.insertChild(t,e,i,s)),void 0!==this.traits[e.uid]||(this.insertTraitMap(e,i),this.traitCount+=1,this.willAttachTrait(e,i),this.onAttachTrait(e,i),this.initTrait(e),this.didAttachTrait(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},insertTraits(t,e,i){for(const s in e)this.insertTrait(t,e[s],i)},removeTrait(t){return this.hasTrait(t)?(t.remove(),t):null},removeTraits(t){void 0===t&&(t=this.traits);for(const e in t)this.removeTrait(t[e])},deleteTrait(t){const e=this.detachTrait(t);return null===e?null:(e.remove(),e)},deleteTraits(t){void 0===t&&(t=this.traits);for(const e in t)this.deleteTrait(t[e])},reinsertTrait(t,e){if(void 0===this.traits[t.uid]||void 0===e&&0==(this.flags&y.SortedFlag))return;const i=t.model;if(null===i)return;const s=t.parent;null!==s&&(void 0===e&&(e=this.getTargetChild(s,t)),s.reinsertChild(i,null!==e?e.model:null))},bindModel(t,e){if(!this.binds)return;const i=this.detectModel(t);null!==i&&void 0===this.traits[i.uid]&&(this.insertTraitMap(i,null),this.traitCount+=1,this.willAttachTrait(i,null),this.onAttachTrait(i,null),this.initTrait(i),this.didAttachTrait(i,null),this.setCoherent(!0),this.decohereOutlets())},unbindModel(t){if(!this.binds)return;const e=this.detectModel(t);null!==e&&void 0!==this.traits[e.uid]&&(this.traitCount-=1,this.removeTraitMap(e),this.willDetachTrait(e),this.onDetachTrait(e),this.deinitTrait(e),this.didDetachTrait(e),this.setCoherent(!0),this.decohereOutlets())},detectModel:t=>null,bindTrait(t,e){if(!this.binds)return;const i=this.detectTrait(t);null!==i&&void 0===this.traits[i.uid]&&(this.insertTraitMap(i,e),this.traitCount+=1,this.willAttachTrait(i,e),this.onAttachTrait(i,e),this.initTrait(i),this.didAttachTrait(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindTrait(t){if(!this.binds)return;const e=this.detectTrait(t);null!==e&&void 0!==this.traits[e.uid]&&(this.traitCount-=1,this.removeTraitMap(e),this.willDetachTrait(e),this.onDetachTrait(e),this.deinitTrait(e),this.didDetachTrait(e),this.setCoherent(!0),this.decohereOutlets())},detectTrait(t){return"function"==typeof this.traitType&&t instanceof this.traitType?t:null},consumeTraits(t){const e=this.traits;for(const i in e)e[i].consume(t)},unconsumeTraits(t){const e=this.traits;for(const i in e)e[i].unconsume(t)},onStartConsuming(){this.consumeTraits(this)},onStopConsuming(){this.unconsumeTraits(this)},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof y?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setTraits(i.traits)):this.setDerived(!1)},get ordered(){return 0!=(this.flags&y.OrderedFlag)},order(t){return void 0===t&&(t=!0),t?this.setFlags(this.flags|y.OrderedFlag):this.setFlags(this.flags&~y.OrderedFlag),this},get sorted(){return 0!=(this.flags&y.SortedFlag)},sort(t){if(void 0===t&&(t=!0),t){const t=this.parentModel;this.willSort(t),this.setFlags(this.flags|y.SortedFlag),this.onSort(t),this.didSort(t)}else this.setFlags(this.flags&~y.SortedFlag);return this},willSort(t){},onSort(t){null!==t&&this.sortChildren(t)},didSort(t){},sortChildren(t,e){t.sortChildren(this.compareChildren.bind(this))},getTargetChild(t,e){if(0!=(this.flags&y.SortedFlag)&&null!==e.model){const i=t.getTargetChild(e.model,this.compareTargetChild.bind(this));if(null!==i)return this.detectModel(i)}return null},compareChildren(t,e){const i=this.traits,s=this.detectModel(t),n=this.detectModel(e),r=null!==s?i[s.uid]:void 0,o=null!==n?i[n.uid]:void 0;return void 0!==r&&void 0!==o?this.compare(r,o):void 0!==r?1:void 0!==o?-1:0},compareTargetChild(t,e){const i=this.traits,s=this.detectModel(t),n=this.detectModel(e),r=null!==s?s:void 0,o=null!==n?i[n.uid]:void 0;return void 0!==r&&void 0!==o?this.compare(r,o):void 0!==r?1:void 0!==o?-1:0},compare:(t,e)=>t.uid<e.uid?-1:t.uid>e.uid?1:0},{construct(t,e){return(t=super.construct(t,e)).traits={},t.traitCount=0,t},refine(t){super.refine(t);const e=t.prototype;let i=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"ordered")&&(e.ordered?i|=y.OrderedFlag:i&=~y.OrderedFlag,delete e.ordered),Object.prototype.hasOwnProperty.call(e,"sorted")&&(e.sorted?i|=y.SortedFlag:i&=~y.SortedFlag,delete e.sorted),Object.defineProperty(e,"flagsInit",{value:i,enumerable:!0,configurable:!0})},OrderedFlag:1<<v.FlagShift+0,SortedFlag:1<<v.FlagShift+1,FlagShift:v.FlagShift+2,FlagMask:(1<<v.FlagShift+2)-1}),b=p.extend("TraitModelRef",{set(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof m?this.setTrait(t):this.setModel(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof m?this.setTrait(t):this.setModel(t),this.owner},traitType:null,traitKey:void 0,observesTrait:!1,getTrait(){const t=this.trait;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="trait",new TypeError(e)}return t},setTrait(t,e,i){null!==t&&(t=this.fromTraitLike(t));let s=this.trait;if(s===t)return s;void 0===e&&(e=null);let n=this.model;if(null===n&&null!==t){n=this.createModel(t);const s=null!==e?e.model:null;this.setModel(n,s,i)}return null!==n&&(null!==s&&s.model===n&&(null===e&&(e=s.nextTrait),s.remove()),null!==t&&this.insertModelTrait(n,t,e,this.traitKey),s=this.trait,s===t)||(null!==s&&(this.trait=null,this.willDetachTrait(s),this.onDetachTrait(s),this.deinitTrait(s),this.didDetachTrait(s)),null!==t&&(this.trait=t,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e))),s},attachTrait(t,e){let i=this.trait;t=null!=t?this.fromTraitLike(t):null===i?this.createTrait():i,void 0===e&&(e=null);let s=this.model;if(null===s){s=this.createModel(t);const n=null!==e?e.model:null;this.attachModel(s,n),i=this.trait}return i===t||(null!==i&&(this.trait=null,this.willDetachTrait(i),this.onDetachTrait(i),this.deinitTrait(i),this.didDetachTrait(i)),this.trait=t,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e)),t},initTrait(t){},willAttachTrait(t,e){},onAttachTrait(t,e){this.observesTrait&&t.observe(this)},didAttachTrait(t,e){},detachTrait(){const t=this.trait;return null===t?null:(this.trait=null,this.willDetachTrait(t),this.onDetachTrait(t),this.deinitTrait(t),this.didDetachTrait(t),t)},deinitTrait(t){},willDetachTrait(t){},onDetachTrait(t){this.observesTrait&&t.unobserve(this)},didDetachTrait(t){},insertTrait(t,e,i,s){let n=this.trait;if(void 0===t&&(t=null),n===(e=null!=e?this.fromTraitLike(e):null===n?this.createTrait():n)&&null!==e.model&&null===t)return e;if(void 0===i&&(i=null),null===t){t=this.createModel(e);const n=null!==i?i.model:null;this.insertModel(null,t,n,s)}return null!==t&&e.model!==t&&this.insertModelTrait(t,e,i,this.traitKey),n=this.trait,n===e||(null!==n&&(this.trait=null,this.willDetachTrait(n),this.onDetachTrait(n),this.deinitTrait(n),this.didDetachTrait(n),n.remove()),this.trait=e,this.willAttachTrait(e,i),this.onAttachTrait(e,i),this.initTrait(e),this.didAttachTrait(e,i)),e},removeTrait(){const t=this.trait;return null===t?null:(t.remove(),t)},deleteTrait(){const t=this.detachTrait();return null===t?null:(t.remove(),t)},createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t},fromTraitLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},detectModelTrait(t){return t.findTrait(this.traitKey,this.traitType)},insertModelTrait(t,e,i,s){t.insertTrait(e,i,s)},onAttachModel(t,e){const i=this.detectModelTrait(t);if(null!==i){const t=null!==e?this.detectModelTrait(e):null;this.attachTrait(i,t)}super.onAttachModel(t,e)},onDetachModel(t){super.onDetachModel(t),this.detachTrait()},createModel(t){const e=super.createModel();return void 0===t&&(t=this.createTrait()),this.insertModelTrait(e,t,null,this.traitKey),e}},{construct(t,e){return(t=super.construct(t,e)).trait=null,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"traitKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"traitKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"traitKey",i)))}}),C=g.extend("TraitModelSet",{traitType:null,traitKey:void 0,observesTrait:!1,hasTrait(t){return void 0!==this.traits[t.uid]},addTrait(t,e,i){let s=(t=null!=t?this.fromTraitLike(t):this.createTrait()).model;return null===s&&(s=this.createModel(t)),this.addModel(s,e,i),t},addTraits(t,e){for(const i in t)this.addTrait(t[i],e)},setTraits(t,e){const i=this.traits;for(const e in i)void 0===t[e]&&this.detachTrait(i[e]);for(const s in t)void 0===i[s]&&this.attachTrait(t[s],e)},attachTrait(t,e){t=null!=t?this.fromTraitLike(t):this.createTrait();const i=this.traits;if(void 0!==i[t.uid])return t;void 0===e&&(e=null),i[t.uid]=t,this.traitCount+=1;let s=t.model;return null===s&&(s=this.createModel(t)),this.attachModel(s,e),this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e),t},initTrait(t){},willAttachTrait(t,e){},onAttachTrait(t,e){this.observesTrait&&t.observe(this)},didAttachTrait(t,e){},attachTraits(t,e){for(const i in t)this.attachTrait(t[i],e)},detachTrait(t){const e=this.traits;if(void 0===e[t.uid])return null;this.traitCount-=1,delete e[t.uid],this.willDetachTrait(t),this.onDetachTrait(t),this.deinitTrait(t),this.didDetachTrait(t);const i=t.model;return null!==i&&this.detachModel(i),t},deinitTrait(t){},willDetachTrait(t){},onDetachTrait(t){this.observesTrait&&t.unobserve(this)},didDetachTrait(t){},detachTraits(t){void 0===t&&(t=this.traits);for(const e in t)this.detachTrait(t[e])},insertTrait(t,e,i,s){let n=(e=null!=e?this.fromTraitLike(e):this.createTrait()).model;return null===n&&(n=this.createModel(e)),this.insertModel(t,n,i,s),e},insertTraits(t,e,i){for(const s in e)this.insertTrait(t,e[s],i)},removeTrait(t){return this.hasTrait(t)?(t.remove(),t):null},removeTraits(t){void 0===t&&(t=this.traits);for(const e in t)this.removeTrait(t[e])},deleteTrait(t){const e=this.detachTrait(t);return null===e?null:(e.remove(),e)},deleteTraits(t){void 0===t&&(t=this.traits);for(const e in t)this.deleteTrait(t[e])},reinsertTrait(t,e){const i=t.model;if(null===i)return;const s=null!==e?e.model:null;this.reinsertModel(i,s)},consumeTraits(t){const e=this.traits;for(const i in e)e[i].consume(t)},unconsumeTraits(t){const e=this.traits;for(const i in e)e[i].unconsume(t)},createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t},fromTraitLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},detectModelTrait(t){return t.findTrait(this.traitKey,this.traitType)},insertModelTrait(t,e,i,s){t.insertTrait(e,i,s)},detectModel(t){return null!==this.detectModelTrait(t)?t:null},onAttachModel(t,e){const i=this.detectModelTrait(t);null!==i&&this.attachTrait(i,e),super.onAttachModel(t,e)},onDetachModel(t){super.onDetachModel(t);const e=this.detectModelTrait(t);null!==e&&this.detachTrait(e)},createModel(t){const e=super.createModel();return void 0===t&&(t=this.createTrait()),this.insertModelTrait(e,t,null,this.traitKey),e},compare(t,e){const i=this.detectModelTrait(t),s=this.detectModelTrait(e);return null!==i&&null!==s?this.compareTraits(i,s):null!==i?1:null!==s?-1:0},compareTraits:(t,e)=>t.uid<e.uid?-1:t.uid>e.uid?1:0},{construct(t,e){return(t=super.construct(t,e)).traits={},t.traitCount=0,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"traitKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"traitKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"traitKey",i)))}});let T=(()=>{var t;let i,s,n=e.Service,r=[],o=[],l=[];return t=class extends n{constructor(){super(),this.roots=(u(this,r),u(this,o,void 0)),this.visibilityChange=u(this,l,void 0),this.updateFlags=0,this.updateTime=performance.now(),this.updateDelay=t.MinUpdateDelay,this.analyzeTimer=0,this.refreshTimer=0,this.runAnalyzePass=this.runAnalyzePass.bind(this),this.runRefreshPass=this.runRefreshPass.bind(this)}setUpdateFlags(t){this.updateFlags=t}needsUpdate(t,e){return t}requestUpdate(e,i,s){i=this.needsUpdate(i,s);let n=this.updateFlags&~i&c.UpdateMask;0!=(i&c.AnalyzeMask)&&(n|=c.NeedsAnalyze),0!=(i&c.RefreshMask)&&(n|=c.NeedsRefresh),this.setUpdateFlags(this.updateFlags|n),s&&0==(this.updateFlags&(c.AnalyzingFlag|c.RefreshingFlag))&&this.updateDelay<=t.MaxAnalyzeInterval?this.runImmediatePass():this.scheduleUpdate()}scheduleUpdate(){const e=this.updateFlags;0==(e&c.AnalyzingFlag)&&0!=(e&c.AnalyzeMask)?this.scheduleAnalyzePass(this.updateDelay):0==(e&c.RefreshingFlag)&&0!=(e&c.RefreshMask)&&this.scheduleRefreshPass(t.MinAnalyzeInterval)}cancelUpdate(){this.cancelAnalyzePass(),this.cancelRefreshPass()}runImmediatePass(){0!=(this.updateFlags&c.AnalyzeMask)&&(this.cancelUpdate(),this.runAnalyzePass(!0)),0!=(this.updateFlags&c.RefreshMask)&&this.updateDelay<=t.MaxAnalyzeInterval&&(this.cancelUpdate(),this.runRefreshPass(!0))}scheduleAnalyzePass(t){0===this.analyzeTimer&&(this.analyzeTimer=setTimeout(this.runAnalyzePass,t))}cancelAnalyzePass(){0!==this.analyzeTimer&&(clearTimeout(this.analyzeTimer),this.analyzeTimer=0)}runAnalyzePass(e=!1){e||(this.analyzeTimer=0),this.setUpdateFlags(this.updateFlags&~c.AnalyzeMask|c.AnalyzingFlag);try{const i=performance.now();this.updateTime=i;const s=this.roots.models;for(const t in s){const e=s[t];0!=(e.flags&c.AnalyzeMask)&&e.cascadeAnalyze(0)}const n=performance.now();let r=Math.max(t.MinAnalyzeInterval,this.updateDelay);this.updateDelay=n-i>r?Math.min(Math.max(2,2*this.updateDelay),t.MaxUpdateDelay):Math.min(t.MinUpdateDelay,this.updateDelay/2),this.cancelAnalyzePass(),0!=(this.updateFlags&c.RefreshMask)?this.scheduleRefreshPass(t.MinRefreshInterval):0!=(this.updateFlags&c.AnalyzeMask)&&(e&&(r=Math.max(t.MaxAnalyzeInterval,r)),this.cancelRefreshPass(),this.scheduleAnalyzePass(r))}finally{this.setUpdateFlags(this.updateFlags&~c.AnalyzingFlag)}}scheduleRefreshPass(t){0===this.refreshTimer&&(this.refreshTimer=setTimeout(this.runRefreshPass,t))}cancelRefreshPass(){0!==this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=0)}runRefreshPass(e=!1){e||(this.refreshTimer=0),this.setUpdateFlags(this.updateFlags&~c.RefreshMask|c.RefreshingFlag);try{const i=performance.now();this.updateTime=i;const s=this.roots.models;for(const t in s){const e=s[t];0!=(e.flags&c.RefreshMask)&&e.cascadeRefresh(0)}if(this.cancelRefreshPass(),0!=(this.updateFlags&c.AnalyzeMask)){let i=this.updateDelay;e&&(i=Math.max(t.MaxAnalyzeInterval,i)),this.scheduleAnalyzePass(i)}else 0!=(this.updateFlags&c.RefreshMask)&&(this.cancelAnalyzePass(),this.scheduleRefreshPass(t.MaxRefreshInterval))}finally{this.setUpdateFlags(this.updateFlags&~c.RefreshingFlag)}}get powerFlags(){return 0}power(){const t=this.roots.models;for(const e in t){t[e].requireUpdate(this.powerFlags)}}unpower(){this.cancelUpdate(),this.updateDelay=t.MinUpdateDelay}},(()=>{var a;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[g({initModel(t){this.owner.requestUpdate(t,t.flags&c.UpdateMask,!1)},willAttachModel(t){this.owner.callObservers("serviceWillAttachRoot",t,this.owner)},didAttachModel(t){this.owner.callObservers("serviceDidAttachRoot",t,this.owner)},willDetachModel(t){this.owner.callObservers("serviceWillDetachRoot",t,this.owner)},didDetachModel(t){this.owner.callObservers("serviceDidDetachRoot",t,this.owner)}})],s=[e.EventHandler({eventType:"visibilitychange",target:"undefined"!=typeof document?document:null,handle(t){"visible"===document.visibilityState?this.owner.power():this.owner.unpower()}})],d(null,null,i,{kind:"field",name:"roots",static:!1,private:!1,access:{has:t=>"roots"in t,get:t=>t.roots,set:(t,e)=>{t.roots=e}},metadata:h},o,r),d(null,null,s,{kind:"field",name:"visibilityChange",static:!1,private:!1,access:{has:t=>"visibilityChange"in t,get:t=>t.visibilityChange,set:(t,e)=>{t.visibilityChange=e}},metadata:h},l,r),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h})})(),t.MinUpdateDelay=0,t.MaxUpdateDelay=167,t.MinAnalyzeInterval=12,t.MaxAnalyzeInterval=33,t.MinRefreshInterval=4,t.MaxRefreshInterval=16,t})();class S extends e.Service{willSet(t,e,i){this.callObservers("serviceWillStore",t,e,i,this)}onSet(t,e,i){}didSet(t,e,i){this.callObservers("serviceDidStore",t,e,i,this)}willClear(){this.callObservers("serviceWillClear",this)}onClear(){}didClear(){this.callObservers("serviceDidClear",this)}static create(){let t=x.local();return null===t&&(t=new M),t}}let x=(()=>{var t;let i,s=S,n=[],r=[];return t=class extends s{constructor(t){super(),this.storageArea=void u(this,n),this.storageEvent=u(this,r,void 0),this.storageArea=t}get(t){const e=this.storageArea.getItem(t);return null!==e?e:void 0}set(t,i){if("string"!=typeof t)return e.Service.prototype.set.call(this,t,i),this;let s=this.storageArea.getItem(t);return null===s&&(s=void 0),i===s||(this.willSet(t,i,s),void 0!==i?this.storageArea.setItem(t,i):this.storageArea.removeItem(t),this.onSet(t,i,s),this.didSet(t,i,s)),s}clear(){this.willClear(),this.storageArea.clear(),this.onClear(),this.didClear()}static local(){if(void 0===this.Local)try{this.Local=new t(window.localStorage)}catch(t){this.Local=null}return this.Local}static session(){if(void 0===this.Session)try{this.Session=new t(window.sessionStorage)}catch(t){this.Session=null}return this.Session}},(()=>{var o;const l="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(o=s[Symbol.metadata])&&void 0!==o?o:null):void 0;i=[e.EventHandler({eventType:"storage",target:"undefined"!=typeof window?window:null,handle(t){if(t.storageArea!==this.owner.storageArea)return;const e=t.key;if(null===e)return this.owner.willClear(),this.owner.onClear(),void this.owner.didClear();let i=t.newValue;null===i&&(i=void 0);let s=t.oldValue;null===s&&(s=void 0),i!==s&&(this.owner.willSet(e,i,s),this.owner.onSet(e,i,s),this.owner.didSet(e,i,s))}})],d(null,null,i,{kind:"field",name:"storageEvent",static:!1,private:!1,access:{has:t=>"storageEvent"in t,get:t=>t.storageEvent,set:(t,e)=>{t.storageEvent=e}},metadata:l},r,n),l&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})})(),t.Local=void 0,t.Session=void 0,t})();class M extends S{constructor(t){super(),void 0===t&&(t={}),this.storageArea=t}get(t){return this.storageArea[t]}set(t,i){if("string"!=typeof t)return e.Service.prototype.set.call(this,t,i),this;const s=this.storageArea,n=s[t];return i===n||(this.willSet(t,i,n),void 0!==i?s[t]=i:delete s[t],this.onSet(t,i,n),this.didSet(t,i,n)),n}clear(){this.willClear(),this.storageArea={},this.onClear(),this.didClear()}}class A extends e.Service{constructor(){super(),this.selections=[]}isSelected(t){return this.selections.indexOf(t)>=0}select(t,e,i){const s=this.selections;if(s.indexOf(t)>=0)return;void 0===e&&(e=null),null!==e&&e.multi||this.unselectAll(!0),void 0===i?i=s.length:(i<0&&(i=s.length+1+i),i=Math.min(Math.max(0,i,s.length)));const n=t.getTrait(F);this.willSelect(t,i,e),null!==n&&n.willSelect(e),s.splice(i,0,t),this.onSelect(t,i,e),null!==n&&(n.onSelect(e),n.didSelect(e)),this.didSelect(t,i,e)}willSelect(t,e,i){this.callObservers("serviceWillSelect",t,e,i,this)}onSelect(t,e,i){}didSelect(t,e,i){this.callObservers("serviceDidSelect",t,e,i,this)}unselect(t,e){const i=this.selections,s=i.indexOf(t);if(s<0)return;const n=t.getTrait(F);this.willUnselect(t),null!==n&&n.willUnselect(),i.splice(s,1),this.onUnselect(t),null!==n&&(n.onUnselect(),n.didUnselect()),this.didUnselect(t),!0!==e&&0===i.length&&this.didUnselectAll()}willUnselect(t){this.callObservers("serviceWillUnselect",t,this)}onUnselect(t){}didUnselect(t){this.callObservers("serviceDidUnselect",t,this)}unselectAll(t){const e=this.selections;if(0!==e.length){for(;0!==e.length;)this.unselect(e[0],!0);!0!==t&&this.didUnselectAll()}}didUnselectAll(){this.callObservers("serviceDidUnselectAll",this)}toggle(t,e,i){const s=this.selections,n=s.indexOf(t);if(n<0){void 0===e&&(e=null),null!==e&&e.multi||this.unselectAll(!0),void 0===i?i=s.length:(i<0&&(i=s.length+1+i),i=Math.min(Math.max(0,i,s.length)));const n=t.getTrait(F);this.willSelect(t,i,e),null!==n&&n.willSelect(e),s.splice(i,0,t),this.onSelect(t,i,e),null!==n&&(n.onSelect(e),n.didSelect(e)),this.didSelect(t,i,e)}else{const e=t.getTrait(F);this.willUnselect(t),null!==e&&e.willUnselect(),s.splice(n,1),this.onUnselect(t),null!==e&&(e.onUnselect(),e.didUnselect()),this.didUnselect(t),0===s.length&&this.didUnselectAll()}}}let F=(()=>{var t;let i,s=m,n=[],r=[];return t=class extends s{constructor(){super(),this.selected=void u(this,n),this.selection=u(this,r,void 0),this.selected=!1}select(t){this.selected||(this.selected=!0,this.mounted&&this.selection.getService().select(this.model,t))}willSelect(t){this.callObservers("traitWillSelect",t,this)}onSelect(t){this.selected=!0}didSelect(t){this.callObservers("traitDidSelect",t,this)}unselect(){this.selected&&(this.selected=!1,this.mounted&&this.selection.getService().unselect(this.model))}willUnselect(){this.callObservers("traitWillUnselect",this)}onUnselect(){this.selected=!1}didUnselect(){this.callObservers("traitDidUnselect",this)}unselectAll(){this.selection.getService().unselectAll()}toggle(t){this.selected?this.unselect():this.select(t)}didMount(){this.selected&&this.selection.getService().select(this.model),super.didMount()}willUnmount(){super.willUnmount(),this.selection.getService().unselect(this.model)}},(()=>{var o;const l="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(o=s[Symbol.metadata])&&void 0!==o?o:null):void 0;i=[e.Provider({serviceType:A})],d(null,null,i,{kind:"field",name:"selection",static:!1,private:!1,access:{has:t=>"selection"in t,get:t=>t.selection,set:(t,e)=>{t.selection=e}},metadata:l},r,n),l&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})})(),t})();const k={fromLike:t=>null==t?t:"string"!=typeof t||"large"!==t&&"larger"!==t&&"medium"!==t&&"small"!==t&&"smaller"!==t&&"x-large"!==t&&"x-small"!==t&&"xx-large"!==t&&"xx-small"!==t?l.Length.fromLike(t):t,fromValue(t){const e=t.stringValue(null);if(null!==e)return k.fromLike(e);const i=l.Length.form().cast(t);return void 0!==i?i:null}},P={fromLike:t=>null==t||"string"==typeof t&&"normal"===t?t:l.Length.fromLike(t),fromValue(t){const e=t.stringValue(null);if(null!==e)return P.fromLike(e);const i=l.Length.form().cast(t);return void 0!==i?i:null}},V={fromValue(t){let e=null;return t.forEach((function(t){let s;t instanceof i.Value&&void 0!==(s=t.stringValue(void 0))&&(null===e?e=s:"string"==typeof e?e=[e,s]:e.push(s))})),e},format(t){let e=!1;if(0!==t.length){e=o.Unicode.isAlpha(t.charCodeAt(0));for(let i=r.Strings.offsetByCodePoints(t,0,1);e&&i<t.length;i=r.Strings.offsetByCodePoints(t,i,1)){const s=t.charCodeAt(i);e=o.Unicode.isAlpha(s)||45===s}}if(e)return t;let i=o.Unicode.stringOutput();i=i.write(34);for(let e=0;e<t.length;e=r.Strings.offsetByCodePoints(t,e,1)){const s=t.charCodeAt(e);if(10===s||34===s||39===s)i=i.write(92).write(s);else if(s>=32)i=i.write(s);else{const t=o.Base16.uppercase;i=i.write(92).write(t.encodeDigit(s>>>20&15)).write(t.encodeDigit(s>>>16&15)).write(t.encodeDigit(s>>>12&15)).write(t.encodeDigit(s>>>8&15)).write(t.encodeDigit(s>>>4&15)).write(t.encodeDigit(15&s))}}return i=i.write(34),i.toString()}},L={[Symbol.hasInstance]:t=>t instanceof I||R[Symbol.hasInstance](t)},R={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"family")};let I=(()=>{var t;let e,i=[];return t=class{constructor(t,e,i,s,n,r,o){this.style=t,this.variant=e,this.weight=i,this.stretch=s,this.size=n,this.height=r,this.family=o,this.stringValue=void 0}withStyle(e){return e===this.style?this:new t(e,this.variant,this.weight,this.stretch,this.size,this.height,this.family)}withVariant(e){return e===this.variant?this:new t(this.style,e,this.weight,this.stretch,this.size,this.height,this.family)}withWeight(e){return e===this.weight?this:new t(this.style,this.variant,e,this.stretch,this.size,this.height,this.family)}withStretch(e){return e===this.stretch?this:new t(this.style,this.variant,this.weight,e,this.size,this.height,this.family)}withSize(e){return e=k.fromLike(e),r.Values.equal(e,this.size)?this:new t(this.style,this.variant,this.weight,this.stretch,e,this.height,this.family)}withHeight(e){return e=P.fromLike(e),r.Values.equal(e,this.height)?this:new t(this.style,this.variant,this.weight,this.stretch,this.size,e,this.family)}withFamily(e){return Array.isArray(e)&&1===e.length&&(e=e[0]),r.Values.equal(e,this.family)?this:new t(this.style,this.variant,this.weight,this.stretch,this.size,this.height,e)}toLike(){return{style:this.style,variant:this.variant,weight:this.weight,stretch:this.stretch,size:this.size,height:this.height,family:Array.isArray(this.family)?this.family.slice(0):this.family}}interpolateTo(e){return e instanceof t?O(this,e):null}equivalentTo(e,i){return this===e||e instanceof t&&(this.style===e.style&&this.variant===e.variant&&this.weight===e.weight&&this.stretch===e.stretch&&r.Values.equivalent(this.size,e.size,i)&&r.Values.equivalent(this.height,e.height,i)&&r.Values.equivalent(this.family,e.family,i))}equals(e){return this===e||e instanceof t&&(this.style===e.style&&this.variant===e.variant&&this.weight===e.weight&&this.stretch===e.stretch&&r.Values.equal(this.size,e.size)&&r.Values.equal(this.height,e.height)&&r.Values.equal(this.family,e.family))}debug(t){if(t=t.write("Font").write(46).write("family").write(40),"string"==typeof this.family)t=t.debug(this.family);else if(Array.isArray(this.family)&&0!==this.family.length){t=t.debug(this.family[0]);for(let e=1;e<this.family.length;e+=1)t=t.write(", ").debug(this.family[e])}return t=t.write(41),void 0!==this.style&&(t=t.write(46).write("style").write(40).debug(this.style).write(41)),void 0!==this.variant&&(t=t.write(46).write("variant").write(40).debug(this.variant).write(41)),void 0!==this.weight&&(t=t.write(46).write("weight").write(40).debug(this.weight).write(41)),void 0!==this.stretch&&(t=t.write(46).write("stretch").write(40).debug(this.stretch).write(41)),void 0!==this.size&&(t=t.write(46).write("size").write(40).debug(this.size).write(41)),void 0!==this.height&&(t=t.write(46).write("height").write(40).debug(this.height).write(41)),t}toString(){var t,e,i;let s=this.stringValue;if(void 0===s){if(s="",void 0===this.style&&"normal"!==this.variant&&"normal"!==this.weight&&"normal"!==this.stretch||(s+=null!==(t=this.style)&&void 0!==t?t:"normal"),void 0===this.variant&&"normal"!==this.weight&&"normal"!==this.stretch||(0!==s.length&&(s+=" "),s+=null!==(e=this.variant)&&void 0!==e?e:"normal"),void 0===this.weight&&"normal"!==this.stretch||(0!==s.length&&(s+=" "),s+=null!==(i=this.weight)&&void 0!==i?i:"normal"),void 0!==this.stretch&&(0!==s.length&&(s+=" "),s+=this.stretch),null!==this.size&&(0!==s.length&&(s+=" "),s+=this.size.toString(),null!==this.height&&(s+="/",s+=this.height.toString())),"string"==typeof this.family)0!==s.length&&(s+=" "),s+=V.format(this.family);else if(Array.isArray(this.family)&&0!==this.family.length){0!==s.length&&(s+=" "),s+=V.format(this.family[0]);for(let t=1;t<this.family.length;t+=1)s+=", ",s+=V.format(this.family[t])}this.stringValue=s}return s}static style(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(e,void 0,void 0,void 0,null,null,i)}static variant(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(void 0,e,void 0,void 0,null,null,i)}static weight(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(void 0,void 0,e,void 0,null,null,i)}static stretch(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(void 0,void 0,void 0,e,null,null,i)}static size(e,i){return e=null!==e?k.fromLike(e):null,Array.isArray(i)&&1===i.length&&(i=i[0]),new t(void 0,void 0,void 0,void 0,e,null,i)}static family(e){return Array.isArray(e)&&1===e.length&&(e=e[0]),new t(void 0,void 0,void 0,void 0,null,null,e)}static create(e,i,s,n,r,o,l){return r=null!=r?k.fromLike(r):null,o=null!=o?P.fromLike(o):null,Array.isArray(l)&&1===l.length&&(l=l[0]),new t(e,i,s,n,r,o,l)}static fromLike(e){if(null==e||e instanceof t)return e;if("object"==typeof e&&null!==e)return t.fromInit(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)}static fromInit(e){return t.create(e.style,e.variant,e.weight,e.stretch,e.size,e.height,e.family)}static fromValue(e){const i=e.header("font");if(!i.isDefined())return null;const s=i.get("style").stringValue(void 0),n=i.get("variant").stringValue(void 0),r=i.get("weight").stringValue(void 0),o=i.get("stretch").stringValue(void 0),l=k.fromValue(i.get("size")),a=P.fromValue(i.get("height")),h=V.fromValue(i.get("family"));return null===h?null:t.create(s,n,r,o,l,a,h)}static parse(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=U.parse(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}static form(){return new D(void 0)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:s},null,i),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),u(t,i)})(),t})();const O=function(t){const e=function(t,i){const s=function(t){const e=s.styleInterpolator(t),i=s.variantInterpolator(t),n=s.weightInterpolator(t),r=s.stretchInterpolator(t),o=s.sizeInterpolator(t),l=s.heightInterpolator(t),a=s.familyInterpolator(t);return new I(e,i,n,r,o,l,a)};return Object.setPrototypeOf(s,e.prototype),s.styleInterpolator=r.Interpolator(t.style,i.style),s.variantInterpolator=r.Interpolator(t.variant,i.variant),s.weightInterpolator=r.Interpolator(t.weight,i.weight),s.stretchInterpolator=r.Interpolator(t.stretch,i.stretch),s.sizeInterpolator=r.Interpolator(t.size,i.size),s.heightInterpolator=r.Interpolator(t.height,i.height),s.familyInterpolator=r.Interpolator(t.family,i.family),s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.styleInterpolator[0],e=this.variantInterpolator[0],i=this.weightInterpolator[0],s=this.stretchInterpolator[0],n=this.sizeInterpolator[0],r=this.heightInterpolator[0],o=this.familyInterpolator[0];return new I(t,e,i,s,n,r,o)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.styleInterpolator[1],e=this.variantInterpolator[1],i=this.weightInterpolator[1],s=this.stretchInterpolator[1],n=this.sizeInterpolator[1],r=this.heightInterpolator[1],o=this.familyInterpolator[1];return new I(t,e,i,s,n,r,o)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.styleInterpolator.equals(t.styleInterpolator)&&this.variantInterpolator.equals(t.variantInterpolator)&&this.weightInterpolator.equals(t.weightInterpolator)&&this.stretchInterpolator.equals(t.stretchInterpolator)&&this.sizeInterpolator.equals(t.sizeInterpolator)&&this.heightInterpolator.equals(t.heightInterpolator)&&this.familyInterpolator.equals(t.familyInterpolator))},e}(r.Interpolator);class D extends i.Form{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new D(t)}mold(t){t=I.fromLike(t);const e=i.Record.create(7);if(void 0!==t.style&&e.slot("style",t.style),void 0!==t.variant&&e.slot("variant",t.variant),void 0!==t.weight&&e.slot("weight",t.weight),void 0!==t.stretch&&e.slot("stretch",t.stretch),t.size instanceof l.Length?e.slot("size",l.Length.form().mold(t.size)):void 0!==t.size&&e.slot("size",t.size),t.height instanceof l.Length?e.slot("height",l.Length.form().mold(t.height)):void 0!==t.height&&e.slot("height",t.height),Array.isArray(t.family)){const s=i.Record.create(t.family.length);for(let e=0;e<t.family.length;e+=1)s.push(t.family[e]);e.slot("family",s)}else e.slot("family",t.family);return i.Record.of(i.Attr.of("font",e))}cast(t){const e=t.toValue();let i=null;try{if(i=I.fromValue(e),null===i){const t=e.stringValue();void 0!==t&&(i=I.parse(t))}}catch(t){}return null!==i?i:void 0}}class E extends o.Parser{constructor(t,e,i,s){super(),this.output=t,this.quote=e,this.code=i,this.step=s}feed(t){return E.parse(t,this.output,this.quote,this.code,this.step)}static parse(t,e,i=0,s=0,n=1){let r=0;if(1===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t=t.step();if(t.isCont())if(o.Unicode.isAlpha(r)||45===r)e=e||o.Unicode.stringOutput(),n=2;else{if(34!==r&&(39!==r||i!==r&&0!==i))return o.Parser.error(o.Diagnostic.expected("font family",t));t=t.step(),e=e||o.Unicode.stringOutput(),i=r,n=3}else if(t.isDone())return o.Parser.error(o.Diagnostic.expected("font family",t))}if(2===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r)||45===r);)t=t.step(),e.write(r);if(!t.isEmpty())return o.Parser.done(e.bind())}t:for(;;){if(3===n){for(;t.isCont()&&(r=t.head(),r>=32&&r!==i&&92!==r);)t=t.step(),e.write(r);if(t.isCont()){if(r===i)return t=t.step(),o.Parser.done(e.bind());if(92!==r)return o.Parser.error(o.Diagnostic.expected(i,t));t=t.step(),n=4}else if(t.isDone())return o.Parser.error(o.Diagnostic.expected(i,t))}if(4===n)if(t.isCont()){if(r=t.head(),!o.Base16.isDigit(r)){if(10===r){t.step(),n=3;continue}t.step(),e.write(r),n=3;continue}n=5}else if(t.isDone())return o.Parser.error(o.Diagnostic.expected("escape character",t));if(n>=5)for(;;){if(t.isCont()&&(r=t.head(),o.Base16.isDigit(r))){if(t=t.step(),s=16*s+o.Base16.decodeDigit(r),n<=11){n+=1;continue}if(0===s)return o.Parser.error(o.Diagnostic.message("zero escape",t));e.write(s),s=0,n=3;continue t}if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t));break}break}return new E(e,i,s,n)}}class U extends o.Parser{constructor(t,e,i,s,n,r,o,l,a,h,d){super(),this.style=t,this.variant=e,this.weight=i,this.stretch=s,this.size=n,this.height=r,this.family=o,this.identOutput=l,this.lengthParser=a,this.familyParser=h,this.step=d}feed(t){return U.parse(t,this.style,this.variant,this.weight,this.stretch,this.size,this.height,this.family,this.identOutput,this.lengthParser,this.familyParser,this.step)}static parse(t,e,i,s,n,r,a,h,d,u,c,f=1){let p=0;for(;;){if(1===f){for(;t.isCont()&&(p=t.head(),o.Unicode.isSpace(p));)t.step();if(t.isCont())f=o.Unicode.isAlpha(p)?2:34===p||39===p?11:4;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(2===f){for(d=d||o.Unicode.stringOutput();t.isCont()&&(p=t.head(),o.Unicode.isAlpha(p)||45===p);)t=t.step(),d.write(p);if(!t.isEmpty()){const l=d.bind();switch(d=void 0,l){case"italic":case"oblique":if(void 0!==e)return o.Parser.error(o.Diagnostic.message("reapeated font style: "+l,t));e=l,f=3;break;case"small-caps":if(void 0!==i)return o.Parser.error(o.Diagnostic.message("reapeated font variant: "+l,t));i=l,f=3;break;case"bold":case"bolder":case"lighter":if(void 0!==s)return o.Parser.error(o.Diagnostic.message("reapeated font weight: "+l,t));s=l,f=3;break;case"ultra-condensed":case"extra-condensed":case"semi-condensed":case"condensed":case"expanded":case"semi-expanded":case"extra-expanded":case"ultra-expanded":if(void 0!==n)return o.Parser.error(o.Diagnostic.message("reapeated font stretch: "+l,t));n=l,f=3;break;case"normal":if(void 0===e)e=l;else if(void 0===i)i=l;else if(void 0===s)s=l;else{if(void 0!==n)return o.Parser.error(o.Diagnostic.message("reapeated font property: "+l,t));n=l}f=3;break;case"large":case"larger":case"medium":case"small":case"smaller":case"x-large":case"x-small":case"xx-large":case"xx-small":r=l,f=5;break;default:h=l,f=12}}}if(3===f){if(t.isCont()){if(p=t.head(),o.Unicode.isSpace(p)){t.step(),f=1;continue}return o.Parser.error(o.Diagnostic.expected("font property, size, or family",t))}if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(4===f)if((u=void 0===u?l.LengthParser.parse(t):u.feed(t)).isDone()){const e=u.bind();if(""===e.units){const i=e.value;switch(i){case 100:case 200:case 300:case 400:case 500:case 600:case 700:case 800:case 900:if(void 0!==s)return o.Parser.error(o.Diagnostic.message("reapeated font weight: "+i,t));s=String(i);break;default:return o.Parser.error(o.Diagnostic.message("unknown font property: "+i,t))}f=3;continue}r=e,u=void 0,f=5}else if(u.isError())return u.asError();if(5===f)if(t.isCont())if(p=t.head(),o.Unicode.isSpace(p))t.step(),f=6;else{if(47!==p)return o.Parser.error(o.Diagnostic.expected("font family",t));t.step(),f=7}else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t));if(6===f){for(;t.isCont()&&(p=t.head(),o.Unicode.isSpace(p));)t.step();if(t.isCont())47===p?(t.step(),f=7):f=11;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(7===f){for(;t.isCont()&&(p=t.head(),o.Unicode.isSpace(p));)t.step();if(t.isCont())f=o.Unicode.isAlpha(p)?8:9;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(8===f){for(d=d||o.Unicode.stringOutput();t.isCont()&&(p=t.head(),o.Unicode.isAlpha(p));)t=t.step(),d.write(p);if(!t.isEmpty()){const e=d.bind();if(d=void 0,"normal"!==e)return o.Parser.error(o.Diagnostic.message("unknown line height: "+e,t));a=e,f=10}}if(9===f)if((u=void 0===u?l.LengthParser.parse(t):u.feed(t)).isDone())a=u.bind(),u=void 0,f=10;else if(u.isError())return u.asError();if(10===f)if(t.isCont()){if(p=t.head(),!o.Unicode.isSpace(p))return o.Parser.error(o.Diagnostic.expected("font family",t));t.step(),f=11}else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t));if(11===f)if((c=void 0===c?E.parse(t):c.feed(t)).isDone())Array.isArray(h)?h.push(c.bind()):h=void 0!==h?[h,c.bind()]:c.bind(),c=void 0,f=12;else if(c.isError())return c.asError();if(12===f){for(;t.isCont()&&(p=t.head(),o.Unicode.isSpace(p));)t.step();if(t.isCont()&&44===p){t.step(),f=11;continue}if(!t.isEmpty())return o.Parser.done(I.create(e,i,s,n,r,a,h))}break}return new U(e,i,s,n,r,a,h,d,u,c,f)}static parseRest(t,e,i,s,n,r,o,l){const a=void 0!==l?12:void 0!==r?5:3;return U.parse(t,e,i,s,n,r,o,l,void 0,void 0,void 0,a)}}const N={[Symbol.hasInstance]:t=>t instanceof z||q[Symbol.hasInstance](t)||"string"==typeof t},q={[Symbol.hasInstance]:t=>G[Symbol.hasInstance](t)||Z[Symbol.hasInstance](t)};let z=(()=>{var t;let e,i=[];return t=class{contrast(t){return this.lightness<.67?this.lighter(t):this.darker(t)}interpolateTo(e){return e instanceof t?X(this.rgb(),e.rgb()):null}static transparent(){return Y.transparent()}static black(t){return Y.black(t)}static white(t){return Y.white(t)}static rgb(t,e,i,s){return new Y(t,e,i,s)}static hsl(t,e,i,s){return"number"!=typeof t&&(t=l.Angle.fromLike(t).degValue()),new $(t,e,i,s)}static forName(e){switch(e){case"transparent":return t.transparent();case"black":return t.black();case"white":return t.white();default:return null}}static fromLike(e){return null==e||e instanceof t?e:"string"==typeof e?t.parse(e):t.fromInit(e)}static fromInit(t){if(G[Symbol.hasInstance](t))return Y.fromInit(t);if(Z[Symbol.hasInstance](t))return $.fromInit(t);throw new TypeError(""+t)}static fromValue(t){let e;return e=Y.fromValue(t),void 0===e&&(e=$.fromValue(t)),e}static parse(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=W.parse(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}static form(){return new j(t.transparent())}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:s},null,i),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),u(t,i)})(),t.Darker=.7,t.Brighter=1/t.Darker,t})();class j extends i.Form{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new j(t)}mold(t){return t=z.fromLike(t),i.Text.from(t.toString())}cast(t){const e=t.toValue();let i=null;try{if(i=z.fromValue(e),void 0===i){const t=e.stringValue(void 0);void 0!==t&&(i=z.parse(t))}}catch(t){}return null!==i?i:void 0}}class W extends o.Parser{constructor(t,e){super(),this.identOutput=t,this.step=e}feed(t){return W.parse(t,this.identOutput,this.step)}static parse(t,e,i=1){let s=0;if(1===i)if(t.isCont()){if(35===t.head())return Q.parse(t);i=2}else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t));if(2===i){for(e=e||o.Unicode.stringOutput();t.isCont()&&(s=t.head(),o.Unicode.isAlpha(s));)t=t.step(),e.write(s);if(!t.isEmpty()){const i=e.bind();switch(i){case"rgb":case"rgba":return _.parseRest(t);case"hsl":case"hsla":return et.parseRest(t);default:{const e=z.forName(i);return null!==e?o.Parser.done(e):o.Parser.error(o.Diagnostic.message("unknown color: "+i,t))}}}}return new W(e,i)}}class H{constructor(t,e){this.value=t,this.units=void 0!==e?e:""}scale(t){return"%"===this.units?this.value*t/100:this.value}}class K extends o.Parser{constructor(t,e){super(),this.valueParser=t,this.step=e}feed(t){return K.parse(t,this.valueParser,this.step)}static parse(t,e,i=1){if(1===i)if((e=void 0===e?o.Base10.parseNumber(t):e.feed(t)).isDone())i=2;else if(e.isError())return e.asError();if(2===i){if(t.isCont()&&37===t.head())return t=t.step(),o.Parser.done(new H(e.bind(),"%"));if(!t.isEmpty())return o.Parser.done(new H(e.bind()))}return new K(e,i)}}const B={[Symbol.hasInstance]:t=>t instanceof Y||G[Symbol.hasInstance](t)||"string"==typeof t},G={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"r","g","b")};let Y=(()=>{var t;let e,s=z,n=[];return t=class extends s{constructor(t,e,i,s=1){super(),this.r=t,this.g=e,this.b=i,this.a=s,this.stringValue=void 0}isDefined(){return isFinite(this.r)&&isFinite(this.g)&&isFinite(this.b)&&isFinite(this.a)}alpha(e){return void 0===e?this.a:this.a===e?this:new t(this.r,this.g,this.b,e)}get lightness(){const t=this.r/255,e=this.g/255,i=this.b/255,s=Math.min(t,e,i);return(Math.max(t,e,i)+s)/2}plus(e){return e=z.fromLike(e).rgb(),new t(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)}times(e){return new t(this.r*e,this.g*e,this.b*e,this.a*e)}combine(e,i=1){return e=z.fromLike(e).rgb(),new t(this.r+e.r*i,this.g+e.g*i,this.b+e.b*i,this.a+e.a*i)}lighter(e){return 1!==(e=void 0===e?z.Brighter:Math.pow(z.Brighter,e))?new t(this.r*e,this.g*e,this.b*e,this.a):this}darker(e){return 1!==(e=void 0===e?z.Darker:Math.pow(z.Darker,e))?new t(this.r*e,this.g*e,this.b*e,this.a):this}rgb(){return this}hsl(){return $.fromRgb(this.r,this.g,this.b,this.a)}interpolateTo(t){return t instanceof z?X(this,t):super.interpolateTo(t)}equivalentTo(t,e){return this===t||t instanceof z&&(t=t.rgb(),r.Numbers.equivalent(this.r,t.r,e)&&r.Numbers.equivalent(this.g,t.g,e)&&r.Numbers.equivalent(this.b,t.b,e)&&r.Numbers.equivalent(this.a,t.a,e))}equals(e){return this===e||e instanceof t&&(this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a)}hashCode(){return r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Constructors.hash(t),r.Numbers.hash(this.r)),r.Numbers.hash(this.g)),r.Numbers.hash(this.b)),r.Numbers.hash(this.a)))}debug(t){return t=t.write("Color").write(46).write("rgb").write(40).debug(this.r).write(", ").debug(this.g).write(", ").debug(this.b),1!==this.a&&(t=t.write(", ").debug(this.a)),t=t.write(41)}toHexString(){const t=Math.min(Math.max(0,Math.round(this.r||0)),255),e=Math.min(Math.max(0,Math.round(this.g||0)),255),i=Math.min(Math.max(0,Math.round(this.b||0)),255);let s="#";const n=o.Base16.lowercase.alphabet;return s+=n.charAt(t>>>4&15),s+=n.charAt(15&t),s+=n.charAt(e>>>4&15),s+=n.charAt(15&e),s+=n.charAt(i>>>4&15),s+=n.charAt(15&i),s}toRgbString(){let t=this.a;t=isNaN(t)?1:Math.max(0,Math.min(this.a,1));let e=1===t?"rgb":"rgba";return e+="(",e+=Math.max(0,Math.min(Math.round(this.r||0),255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.g||0),255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.b||0),255)),1!==t&&(e+=",",e+=t),e+=")",e}toHslString(){return this.hsl().toHslString()}toString(){let t=this.stringValue;if(void 0===t){let e=this.a;e=isNaN(e)?1:Math.max(0,Math.min(this.a,1)),t=1===e?this.toHexString():this.toRgbString(),this.stringValue=t}return t}static transparent(){return new t(0,0,0,0)}static black(e=1){return new t(0,0,0,e)}static white(e=1){return new t(255,255,255,e)}static fromHsl(e,i,s,n){e=e%360+360*+(e<0);const r=s+(s<.5?s:1-s)*(i=isNaN(e)||isNaN(i)?0:i),o=2*s-r;return new t(t.fromHslChannel(e>=240?e-240:e+120,o,r),t.fromHslChannel(e,o,r),t.fromHslChannel(e<120?e+240:e-120,o,r),n)}static fromHslChannel(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);if(G[Symbol.hasInstance](e))return t.fromInit(e);throw new TypeError(""+e)}static fromInit(e){return new t(e.r,e.g,e.b,e.a)}static fromValue(e){const s=e.tag;let n,r,o,l,a;return"rgb"===s||"rgba"===s?(e=e.header(s),n=!0):n=!1,e.forEach((function(t,e){const s=t.key.stringValue();void 0!==s?"r"===s?r=t.toValue().numberValue(r):"g"===s?o=t.toValue().numberValue(o):"b"===s?l=t.toValue().numberValue(l):"a"===s&&(a=t.toValue().numberValue(a)):t instanceof i.Value&&n&&(0===e?r=t.numberValue(r):1===e?o=t.numberValue(o):2===e?l=t.numberValue(l):3===e&&(a=t.numberValue(a)))})),void 0!==r&&void 0!==o&&void 0!==l?new t(r,o,l,a):null}static parse(t){return z.parse(t).rgb()}},(()=>{var i;const o="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(i=s[Symbol.metadata])&&void 0!==i?i:null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"transparent",static:!0,private:!1,access:{has:t=>"transparent"in t,get:t=>t.transparent},metadata:o},null,n),o&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),u(t,n)})(),t})();const X=function(t){const e=function(t,i){const s=t.rgb(),n=i.rgb(),r=function(t){const e=r[0],i=r[1],s=e.r+t*(i.r-e.r),n=e.g+t*(i.g-e.g),o=e.b+t*(i.b-e.b),l=e.a+t*(i.a-e.a);return new Y(s,n,o,l)};return Object.setPrototypeOf(r,e.prototype),r[0]=s,r[1]=n,r};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(r.Interpolator);class _ extends o.Parser{constructor(t,e,i,s,n){super(),this.rParser=t,this.gParser=e,this.bParser=i,this.aParser=s,this.step=n}feed(t){return _.parse(t,this.rParser,this.gParser,this.bParser,this.aParser,this.step)}static parse(t,e,i,s,n,r){let l=0;if(1===r)if(t.isCont()&&114===t.head())t=t.step(),r=2;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("r",t));if(2===r)if(t.isCont()&&103===t.head())t=t.step(),r=3;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("g",t));if(3===r)if(t.isCont()&&98===t.head())t=t.step(),r=4;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("b",t));if(4===r&&(t.isCont()&&97===t.head()?(t=t.step(),r=5):t.isEmpty()||(r=5)),5===r){for(;t.isCont()&&(l=t.head(),o.Unicode.isSpace(l));)t=t.step();if(t.isCont()&&40===l)t=t.step(),r=6;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("(",t))}if(6===r){if(void 0===e){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(e=K.parse(t))}else e=e.feed(t);if(void 0!==e)if(e.isDone())r=7;else if(e.isError())return e.asError()}if(7===r){for(;t.isCont()&&(l=t.head(),o.Unicode.isSpace(l));)t=t.step();if(t.isCont())44===l&&(t=t.step()),r=8;else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t))}if(8===r){if(void 0===i){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(i=K.parse(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())r=9;else if(i.isError())return i.asError()}if(9===r){for(;t.isCont()&&(l=t.head(),o.Unicode.isSpace(l));)t=t.step();if(t.isCont())44===l&&(t=t.step()),r=10;else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t))}if(10===r){if(void 0===s){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(s=K.parse(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())r=11;else if(s.isError())return s.asError()}if(11===r){for(;t.isCont()&&(l=t.head(),o.Unicode.isSpace(l));)t=t.step();if(t.isCont()){if(41===l)return t=t.step(),o.Parser.done(new Y(e.bind().scale(255),i.bind().scale(255),s.bind().scale(255)));44!==l&&47!==l||(t=t.step()),r=12}else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t))}if(12===r){if(void 0===n){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(n=K.parse(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())r=13;else if(n.isError())return n.asError()}if(13===r){for(;t.isCont()&&(l=t.head(),o.Unicode.isSpace(l));)t=t.step();if(t.isCont()&&41===l)return t=t.step(),o.Parser.done(new Y(e.bind().scale(255),i.bind().scale(255),s.bind().scale(255),n.bind().scale(1)));if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected(")",t))}return new _(e,i,s,n,r)}static parseRest(t){return _.parse(t,void 0,void 0,void 0,void 0,5)}}class Q extends o.Parser{constructor(t,e){super(),this.value=t,this.step=e}feed(t){return Q.parse(t,this.value,this.step)}static parse(t,e=0,i=1){let s=0;if(1===i)if(t.isCont()&&35===t.head())t=t.step(),i=2;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("#",t));if(i>=2){for(;i<=9&&t.isCont()&&(s=t.head(),o.Base16.isDigit(s));)t=t.step(),e=e<<4|o.Base16.decodeDigit(s),i+=1;if(!t.isEmpty())return 5===i?o.Parser.done(new Y(e>>8&15|e>>4&240,e>>4&15|240&e,e<<4&240|15&e)):6===i?o.Parser.done(new Y(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,(e<<4&240|15&e)/255)):8===i?o.Parser.done(new Y(e>>16&255,e>>8&255,255&e)):10===i?o.Parser.done(new Y(e>>24&255,e>>16&255,e>>8&255,(255&e)/255)):o.Parser.error(o.Diagnostic.unexpected(t))}return new Q(e,i)}}const J={[Symbol.hasInstance]:t=>t instanceof $||Z[Symbol.hasInstance](t)||"string"==typeof t},Z={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"h","s","l")};let $=(()=>{var t;let e,s=z,n=[];return t=class extends s{constructor(t,e,i,s=1){super(),this.h=t,this.s=e,this.l=i,this.a=s,this.stringValue=void 0}isDefined(){return isFinite(this.h)&&isFinite(this.s)&&isFinite(this.l)&&isFinite(this.a)}alpha(e){return void 0===e?this.a:this.a===e?this:new t(this.h,this.s,this.l,e)}get lightness(){return this.l}plus(e){return e=z.fromLike(e).hsl(),new t(this.h+e.h,this.s+e.s,this.l+e.l,this.a+e.a)}times(e){return new t(this.h*e,this.s*e,this.l*e,this.a*e)}combine(e,i=1){return e=z.fromLike(e).hsl(),new t(this.h+e.h*i,this.s+e.s*i,this.l+e.l*i,this.a+e.a*i)}lighter(e){return 1!==(e=void 0===e?z.Brighter:Math.pow(z.Brighter,e))?new t(this.h,this.s,this.l*e,this.a):this}darker(e){return 1!==(e=void 0===e?z.Darker:Math.pow(z.Darker,e))?new t(this.h,this.s,this.l*e,this.a):this}rgb(){return Y.fromHsl(this.h,this.s,this.l,this.a)}hsl(){return this}interpolateTo(t){return t instanceof z?tt(this,t):super.interpolateTo(t)}equivalentTo(t,e){return this===t||t instanceof z&&(t=t.hsl(),r.Numbers.equivalent(this.h,t.h,e)&&r.Numbers.equivalent(this.s,t.s,e)&&r.Numbers.equivalent(this.l,t.l,e)&&r.Numbers.equivalent(this.a,t.a,e))}equals(e){return this===e||e instanceof t&&(this.h===e.h&&this.s===e.s&&this.l===e.l&&this.a===e.a)}hashCode(){return r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Constructors.hash(t),r.Numbers.hash(this.h)),r.Numbers.hash(this.s)),r.Numbers.hash(this.l)),r.Numbers.hash(this.a)))}debug(t){return t=t.write("Color").write(46).write("hsl").write(40).debug(this.h).write(", ").debug(this.s).write(", ").debug(this.l),1!==this.a&&(t=t.write(", ").debug(this.a)),t=t.write(41)}toHexString(){return this.rgb().toHexString()}toRgbString(){return this.rgb().toRgbString()}toHslString(){let t=this.a;t=isNaN(t)?1:Math.max(0,Math.min(this.a,1));let e=1===t?"hsl":"hsla";return e+="(",e+=Math.max(0,Math.min(Math.round(this.h||0),360)),e+=",",e+=Math.max(0,Math.min(Math.round(100*(this.s||0)),100))+"%",e+=",",e+=Math.max(0,Math.min(Math.round(100*(this.l||0)),100))+"%",1!==t&&(e+=",",e+=t),e+=")",e}toString(){let t=this.stringValue;return void 0===t&&(t=this.toHslString(),this.stringValue=t),t}static transparent(){return new t(0,0,0,0)}static black(e=1){return new t(0,0,0,e)}static white(e=1){return new t(0,1,1,e)}static fromRgb(e,i,s,n){e/=255,i/=255,s/=255;const r=Math.min(e,i,s),o=Math.max(e,i,s);let l=NaN,a=o-r;const h=(o+r)/2;return 0!==a?(l=e===o?(i-s)/a+6*+(i<s):i===o?(s-e)/a+2:(e-i)/a+4,a/=h<.5?o+r:2-(o+r),l*=60):a=h>0&&h<1?0:l,new t(l,a,h,n)}static fromLike(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);if(Z[Symbol.hasInstance](e))return t.fromInit(e);throw new TypeError(""+e)}static fromInit(e){const i="number"==typeof e.h?e.h:l.Angle.fromLike(e.h).degValue();return new t(i,e.s,e.l,e.a)}static fromValue(e){const s=e.tag;let n,r,o,a,h;return"hsl"===s||"hsla"===s?(e=e.header(s),n=!0):n=!1,e.forEach((function(t,e){const s=t.key.stringValue();void 0!==s?"h"===s?r=t.toValue().cast(l.Angle.form(),r):"s"===s?o=t.toValue().numberValue(o):"l"===s?a=t.toValue().numberValue(a):"a"===s&&(h=t.toValue().numberValue(h)):t instanceof i.Value&&n&&(0===e?r=t.cast(l.Angle.form(),r):1===e?o=t.numberValue(o):2===e?a=t.numberValue(a):3===e&&(h=t.numberValue(h)))})),void 0!==r&&void 0!==o&&void 0!==a?new t(r.degValue(),o,a,h):null}static parse(t){return z.parse(t).hsl()}},(()=>{var i;const o="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(i=s[Symbol.metadata])&&void 0!==i?i:null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"transparent",static:!0,private:!1,access:{has:t=>"transparent"in t,get:t=>t.transparent},metadata:o},null,n),o&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),u(t,n)})(),t})();const tt=function(t){const e=function(t,i){const s=t.hsl(),n=i.hsl(),r=function(t){const e=r[0],i=r[1],s=e.h+t*(i.h-e.h),n=e.s+t*(i.s-e.s),o=e.l+t*(i.l-e.l),l=e.a+t*(i.a-e.a);return new $(s,n,o,l)};return Object.setPrototypeOf(r,e.prototype),r[0]=s,r[1]=n,r};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(r.Interpolator);class et extends o.Parser{constructor(t,e,i,s,n){super(),this.hParser=t,this.sParser=e,this.lParser=i,this.aParser=s,this.step=n}feed(t){return et.parse(t,this.hParser,this.sParser,this.lParser,this.aParser,this.step)}static parse(t,e,i,s,n,r){let a=0;if(1===r)if(t.isCont()&&104===t.head())t=t.step(),r=2;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("h",t));if(2===r)if(t.isCont()&&115===t.head())t=t.step(),r=3;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("s",t));if(3===r)if(t.isCont()&&108===t.head())t=t.step(),r=4;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("l",t));if(4===r&&(t.isCont()&&97===t.head()?(t=t.step(),r=5):t.isEmpty()||(r=5)),5===r){for(;t.isCont()&&(a=t.head(),o.Unicode.isSpace(a));)t=t.step();if(t.isCont()&&40===a)t=t.step(),r=6;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("(",t))}if(6===r){if(void 0===e){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(e=l.AngleParser.parse(t,"deg"))}else e=e.feed(t);if(void 0!==e)if(e.isDone())r=7;else if(e.isError())return e.asError()}if(7===r){for(;t.isCont()&&(a=t.head(),o.Unicode.isSpace(a));)t=t.step();if(t.isCont())44===a&&(t=t.step()),r=8;else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t))}if(8===r){if(void 0===i){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(i=K.parse(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone()){if("%"!==i.bind().units)return o.Parser.error(o.Diagnostic.expected("%",t));r=9}else if(i.isError())return i.asError()}if(9===r){for(;t.isCont()&&(a=t.head(),o.Unicode.isSpace(a));)t=t.step();if(t.isCont())44===a&&(t=t.step()),r=10;else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t))}if(10===r){if(void 0===s){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isCont()&&(s=K.parse(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone()){if("%"!==s.bind().units)return o.Parser.error(o.Diagnostic.expected("%",t));r=11}else if(s.isError())return s.asError()}if(11===r){for(;t.isCont()&&(a=t.head(),o.Unicode.isSpace(a));)t=t.step();if(t.isCont()){if(41===a)return t=t.step(),o.Parser.done(new $(e.bind().degValue(),i.bind().scale(1),s.bind().scale(1)));44!==a&&47!==a||(t=t.step()),r=12}else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t))}if(12===r){if(void 0===n){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(n=K.parse(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())r=13;else if(n.isError())return n.asError()}if(13===r){for(;t.isCont()&&(a=t.head(),o.Unicode.isSpace(a));)t=t.step();if(t.isCont()&&41===a)return t=t.step(),o.Parser.done(new $(e.bind().degValue(),i.bind().scale(1),s.bind().scale(1),n.bind().scale(1)));if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected(")",t))}return new et(e,i,s,n,r)}static parseRest(t){return et.parse(t,void 0,void 0,void 0,void 0,5)}}const it={[Symbol.hasInstance]:t=>t instanceof rt||st[Symbol.hasInstance](t)||nt[Symbol.hasInstance](t)||"string"==typeof t},st={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"color")},nt={[Symbol.hasInstance]:t=>Array.isArray(t)&&2===t.length&&N[Symbol.hasInstance](t[0])&&(null===t[1]||l.LengthLike[Symbol.hasInstance](t[1]))};class rt{constructor(t,e,i){this.color=t,this.stop=e,this.hint=i}withColor(t){return t=z.fromLike(t),new rt(t,this.stop,this.hint)}withStop(t){return t=l.Length.fromLike(t,"%"),new rt(this.color,t,this.hint)}withHint(t){return t=l.Length.fromLike(t,"%"),new rt(this.color,this.stop,t)}interpolateTo(t){return t instanceof rt?ot(this,t):null}equivalentTo(t,e){return this===t||t instanceof rt&&(r.Equivalent(this.color,t.color,e)&&r.Equivalent(this.stop,t.stop,e)&&r.Equivalent(this.hint,t.hint,e))}equals(t){return this===t||t instanceof rt&&(this.color.equals(t.color)&&r.Equals(this.stop,t.stop)&&r.Equals(this.hint,t.hint))}toString(){let t="";return null!==this.hint&&(t+=this.hint.toString(),t+=", "),t+=this.color.toString(),null!==this.stop&&(t+=" ",t+=this.stop.toString()),t}static create(t,e=null,i=null){return t=z.fromLike(t),e=l.Length.fromLike(e,"%"),i=l.Length.fromLike(i,"%"),new rt(t,e,i)}static fromLike(t){if(null==t||t instanceof rt)return t;if("string"==typeof t)return rt.parse(t);if(st[Symbol.hasInstance](t))return rt.fromInit(t);if(nt[Symbol.hasInstance](t))return rt.fromTuple(t);throw new TypeError(""+t)}static fromInit(t){const e=z.fromLike(t.color),i=void 0!==t.stop?l.Length.fromLike(t.stop,"%"):null,s=void 0!==t.hint?l.Length.fromLike(t.hint,"%"):null;return new rt(e,i,s)}static fromTuple(t){const e=z.fromLike(t[0]),i=l.Length.fromLike(t[1],"%");return new rt(e,i,null)}static parse(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=lt.parse(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}static parseHint(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=lt.parseHint(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}static parseList(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=at.parse(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}}const ot=function(t){const e=function(t,i){const s=function(t){const e=s.colorInterpolator(t),i=s.stopInterpolator(t),n=s.hintInterpolator(t);return new rt(e,i,n)};return Object.setPrototypeOf(s,e.prototype),s.colorInterpolator=t.color.interpolateTo(i.color),s.stopInterpolator=r.Interpolator(t.stop,i.stop),s.hintInterpolator=r.Interpolator(t.hint,i.hint),s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.colorInterpolator[0],e=this.stopInterpolator[0],i=this.hintInterpolator[0];return new rt(t,e,i)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.colorInterpolator[1],e=this.stopInterpolator[1],i=this.hintInterpolator[1];return new rt(t,e,i)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.colorInterpolator.equals(t.colorInterpolator)&&this.stopInterpolator.equals(t.stopInterpolator)&&this.hintInterpolator.equals(t.hintInterpolator))},e}(r.Interpolator);class lt extends o.Parser{constructor(t,e,i,s){super(),this.colorParser=t,this.stopParser=e,this.hintParser=i,this.step=s}feed(t){return lt.parse(t,this.colorParser,this.stopParser,this.hintParser,this.step)}static parse(t,e,i,s,n=4){let r=0;if(1===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t.step();if(t.isCont())n=45===r||46===r||r>=48&&r<=57?2:7;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(2===n&&void 0!==(s=void 0===s?l.LengthParser.parse(t):s.feed(t)))if(s.isDone())n=3;else if(s.isError())return s.asError();if(3===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t.step();if(t.isCont())44===r?(t.step(),n=4):(i=s,s=void 0,n=7);else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t))}if(4===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t.step();if(t.isCont())n=45===r||46===r||r>=48&&r<=57?5:7;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(5===n&&void 0!==(i=void 0===i?l.LengthParser.parse(t):i.feed(t)))if(i.isDone())n=6;else if(i.isError())return i.asError();if(6===n)if(t.isCont()){if(!o.Unicode.isSpace(t.head()))return o.Parser.error(o.Diagnostic.expected("color",t));t.step(),n=7}else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t));if(7===n&&void 0!==(e=void 0===e?W.parse(t):e.feed(t)))if(e.isDone()){if(void 0!==i){const t=void 0!==s?s.bind():null;return o.Parser.done(new rt(e.bind(),i.bind(),t))}n=8}else if(e.isError())return e.asError();if(8===n)if(t.isCont()&&o.Unicode.isSpace(t.head()))t.step(),n=9;else if(!t.isEmpty()){const t=void 0!==s?s.bind():null;return o.Parser.done(new rt(e.bind(),null,t))}if(9===n&&void 0!==(i=void 0===i?l.LengthParser.parse(t):i.feed(t))){if(i.isDone()){const t=void 0!==s?s.bind():null;return o.Parser.done(new rt(e.bind(),i.bind(),t))}if(i.isError())return i.asError()}return new lt(e,i,s,n)}static parseHint(t){return lt.parse(t,void 0,void 0,void 0,1)}}class at extends o.Parser{constructor(t,e,i){super(),this.stops=t,this.stopParser=e,this.step=i}feed(t){return at.parse(t,void 0!==this.stops?this.stops.slice(0):void 0,this.stopParser,this.step)}static parse(t,e,i,s=1){let n=0;if(1===s){if(void 0===i){for(;t.isCont()&&(n=t.head(),o.Unicode.isSpace(n));)t.step();t.isEmpty()||(i=lt.parse(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())void 0===e&&(e=[]),e.push(i.bind()),i=void 0,s=2;else if(i.isError())return i.asError()}for(;;){if(2===s){for(;t.isCont()&&(n=t.head(),o.Unicode.isSpace(n));)t=t.step();if(!t.isCont()||44!==n)return o.Parser.done(e);t=t.step(),s=3}if(3===s){if(void 0===i){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(i=lt.parseHint(t))}else i=i.feed(t);if(void 0!==i){if(i.isDone()){e.push(i.bind()),i=void 0,s=2;continue}if(i.isError())return i.asError()}}break}return new at(e,i,s)}}const ht={[Symbol.hasInstance]:t=>t instanceof ut||dt[Symbol.hasInstance](t)||"string"==typeof t},dt={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"angle","stops")};class ut{constructor(t,e){this.angle=t,this.stops=e,this.stringValue=void 0}withAngle(t){return(t instanceof l.Angle||"number"==typeof t)&&(t=l.Angle.fromLike(t,"deg")),new ut(t,this.stops)}withStops(t){const e=t.length,i=new Array(e);for(let s=0;s<e;s+=1)i[s]=rt.fromLike(t[s]);return new ut(this.angle,i)}interpolateTo(t){return t instanceof ut?ct(this,t):null}equivalentTo(t,e){return this===t||t instanceof ut&&(r.Values.equivalent(this.angle,t.angle,e)&&r.Arrays.equivalent(this.stops,t.stops,e))}equals(t){return this===t||t instanceof ut&&(r.Values.equal(this.angle,t.angle)&&r.Arrays.equal(this.stops,t.stops))}toString(){let t=this.stringValue;if(void 0===t){if(t="linear-gradient(",this.angle instanceof l.Angle)t+=this.angle.toString();else if(t+="to","string"==typeof this.angle)t+=" ",t+=this.angle;else for(let e=0;e<this.angle.length;e+=1)t+=" ",t+=this.angle[e];for(let e=0;e<this.stops.length;e+=1)t+=", ",t+=this.stops[e].toString();t+=")",this.stringValue=t}return t}static create(t,...e){(t instanceof l.Angle||"number"==typeof t)&&(t=l.Angle.fromLike(t,"deg"));const i=e.length,s=new Array(i);for(let t=0;t<i;t+=1){const i=e[t];s[t]="string"==typeof i?0===t?rt.parse(i):rt.parseHint(i):rt.fromLike(e[t])}return new ut(t,s)}static fromLike(t){if(null==t||t instanceof ut)return t;if("string"==typeof t)return ut.parse(t);if("object"==typeof t)return ut.fromInit(t);throw new TypeError(""+t)}static fromInit(t){let e=t.angle;(e instanceof l.Angle||"number"==typeof e)&&(e=l.Angle.fromLike(e,"deg"));const i=t.stops.length,s=new Array(i);for(let e=0;e<i;e+=1)s[e]=rt.fromLike(t.stops[e]);return new ut(e,s)}static parse(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=pt.parse(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}static parseAngle(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=ft.parse(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}}const ct=function(t){const e=function(t,i){const s=function(t){const e=s.angleInterpolator(t),i=s.stopInterpolators,n=i.length,r=new Array(n);for(let e=0;e<n;e+=1)r[e]=i[e](t);return new ut(e,r)};Object.setPrototypeOf(s,e.prototype),s.angleInterpolator=r.Interpolator(t.angle,i.angle);const n=t.stops,o=i.stops,l=Math.min(n.length,o.length),a=new Array(l);for(let t=0;t<l;t+=1)a[t]=n[t].interpolateTo(o[t]);return s.stopInterpolators=a,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.angleInterpolator[0],e=this.stopInterpolators,i=e.length,s=new Array(i);for(let t=0;t<i;t+=1)s[t]=e[t][0];return new ut(t,s)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.angleInterpolator[1],e=this.stopInterpolators,i=e.length,s=new Array(i);for(let t=0;t<i;t+=1)s[t]=e[t][1];return new ut(t,s)},configurable:!0}),e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e&&this.angleInterpolator.equals(t.angleInterpolator)){const e=this.stopInterpolators.length;if(e!==t.stopInterpolators.length)return!1;for(let i=0;i<e;i+=1)if(!this.stopInterpolators[i].equals(t.stopInterpolators[i]))return!1;return!0}return!1},e}(r.Interpolator);class ft extends o.Parser{constructor(t,e,i,s){super(),this.identOutput=t,this.angleParser=e,this.side=i,this.step=s}feed(t){return ft.parse(t,this.identOutput,this.angleParser,this.side,this.step)}static parse(t,e,i,s,n=1){let r=0;if(1===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t.step();if(t.isCont())n=45===r||46===r||r>=48&&r<=57?2:3;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(2===n&&void 0!==(i=void 0===i?l.AngleParser.parse(t,"deg"):i.feed(t))){if(i.isDone())return i;if(i.isError())return i.asError()}if(3===n){for(void 0===e&&(e=o.Unicode.stringOutput());t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r));)t=t.step(),e.write(r);if(!t.isEmpty()){const i=e.bind();if("to"!==i)return o.Parser.error(o.Diagnostic.message("unexpected "+i,t));e=void 0,n=4}}if(4===n)if(t.isCont()){if(!o.Unicode.isSpace(t.head()))return o.Parser.error(o.Diagnostic.expected("side or corner",t));t.step(),n=5}else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t));if(5===n){for(void 0===e&&(e=o.Unicode.stringOutput());t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r));)t=t.step(),e.write(r);if(!t.isEmpty()){const i=e.bind();switch(e=void 0,i){case"left":case"right":s=i,n=6;break;case"top":case"bottom":s=i,n=7;break;default:return o.Parser.error(o.Diagnostic.message("unknown side: "+i,t))}}}if(6===n){if(void 0===e){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t=t.step();if(t.isCont()&&o.Unicode.isAlpha(r))e=o.Unicode.stringOutput();else if(!t.isEmpty())return o.Parser.done(s)}if(void 0!==e){for(;t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r));)t=t.step(),e.write(r);if(!t.isEmpty()){const i=e.bind();switch(e=void 0,i){case"top":case"bottom":return o.Parser.done([s,i]);default:return o.Parser.error(o.Diagnostic.message("unknown side: "+i,t))}}}}if(7===n){if(void 0===e){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t=t.step();if(t.isCont()&&o.Unicode.isAlpha(r))e=o.Unicode.stringOutput();else if(!t.isEmpty())return o.Parser.done(s)}if(void 0!==e){for(;t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r));)t=t.step(),e.write(r);if(!t.isEmpty()){const i=e.bind();switch(e=void 0,i){case"left":case"right":return o.Parser.done([s,i]);default:return o.Parser.error(o.Diagnostic.message("unknown side: "+i,t))}}}}return new ft(e,i,s,n)}}class pt extends o.Parser{constructor(t,e,i,s){super(),this.identOutput=t,this.angleParser=e,this.stopsParser=i,this.step=s}feed(t){return pt.parse(t,this.identOutput,this.angleParser,this.stopsParser,this.step)}static parse(t,e,i,s,n=1){let r=0;if(1===n){for(void 0===e&&(e=o.Unicode.stringOutput());t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r)||45===r);)t=t.step(),e.write(r);if(!t.isEmpty()){const i=e.bind();if("linear-gradient"!==i)return o.Parser.error(o.Diagnostic.message("unexpected "+i,t));e=void 0,n=2}}if(2===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t=t.step();if(t.isCont()&&40===r)t.step(),n=3;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected("(",t))}if(3===n&&void 0!==(i=void 0===i?ft.parse(t):i.feed(t)))if(i.isDone())n=4;else if(i.isError())return i.asError();if(4===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t=t.step();if(!t.isCont()||44!==r)return o.Parser.error(o.Diagnostic.expected("color stops",t));t=t.step(),n=5}if(5===n&&void 0!==(s=void 0===s?at.parse(t):s.feed(t)))if(s.isDone())n=6;else if(s.isError())return s.asError();if(6===n){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t.step();if(t.isCont()&&41===t.head())return t.step(),o.Parser.done(new ut(i.bind(),s.bind()));if(!t.isEmpty())return o.Parser.error(o.Diagnostic.expected(")",t))}return new pt(e,i,s,n)}static parseRest(t,e){return pt.parse(t,e,void 0,void 0,2)}}const gt={[Symbol.hasInstance]:t=>t instanceof vt||mt[Symbol.hasInstance](t)||"string"==typeof t||gt.isArray(t),isArray(t){if(!Array.isArray(t)||0===t.length)return!1;for(let e=0;e<t.length;e+=1)if(!gt[Symbol.hasInstance](t))return!1;return!0}},mt={[Symbol.hasInstance]:t=>r.Objects.hasAnyKey(t,"inset","offsetX","offsetY","blurRadius","spreadRadius","color")};let vt=(()=>{var t;let e,s=[];return t=class{constructor(t,e,i,s,n,r,o){this.inset=t,this.offsetX=e,this.offsetY=i,this.blurRadius=s,this.spreadRadius=n,this.color=r,this.next=o,this.stringValue=void 0}withInset(e){return e===this.inset?this:new t(e,this.offsetX,this.offsetY,this.blurRadius,this.spreadRadius,this.color,this.next)}withOffsetX(e){return(e=l.Length.fromLike(e)).equals(this.offsetX)?this:new t(this.inset,e,this.offsetY,this.blurRadius,this.spreadRadius,this.color,this.next)}withOffsetY(e){return(e=l.Length.fromLike(e)).equals(this.offsetY)?this:new t(this.inset,this.offsetX,e,this.blurRadius,this.spreadRadius,this.color,this.next)}withBlurRadius(e){return(e=l.Length.fromLike(e)).equals(this.blurRadius)?this:new t(this.inset,this.offsetX,this.offsetY,e,this.spreadRadius,this.color,this.next)}withSpreadRadius(e){return(e=l.Length.fromLike(e)).equals(this.spreadRadius)?this:new t(this.inset,this.offsetX,this.offsetY,this.blurRadius,e,this.color,this.next)}withColor(e){return(e=z.fromLike(e)).equals(this.color)?this:new t(this.inset,this.offsetX,this.offsetY,this.blurRadius,this.spreadRadius,e,this.next)}and(e,i,s,n,r,o){let l;return l=null!==this.next?this.next.and.apply(this.next,arguments):t.create.apply(t,arguments),new t(this.inset,this.offsetX,this.offsetY,this.blurRadius,this.spreadRadius,this.color,l)}interpolateTo(e){return e instanceof t?wt(this,e):null}equivalentTo(e,i){return this===e||e instanceof t&&(this.inset===e.inset&&this.offsetX.equivalentTo(e.offsetX,i)&&this.offsetY.equivalentTo(e.offsetY,i)&&this.blurRadius.equivalentTo(e.blurRadius,i)&&this.spreadRadius.equivalentTo(e.spreadRadius,i)&&this.color.equivalentTo(e.color,i)&&r.Equivalent(this.next,e.next,i))}equals(e){return this===e||e instanceof t&&(this.inset===e.inset&&this.offsetX.equals(e.offsetX)&&this.offsetY.equals(e.offsetY)&&this.blurRadius.equals(e.blurRadius)&&this.spreadRadius.equals(e.spreadRadius)&&this.color.equals(e.color)&&r.Equals(this.next,e.next))}toString(){let t=this.stringValue;return void 0===t&&(t="",this.inset&&(t+="inset",t+=" "),t+=this.offsetX.toString(),t+=" ",t+=this.offsetY.toString(),t+=" ",t+=this.blurRadius.toString(),t+=" ",t+=this.spreadRadius.toString(),t+=" ",t+=this.color.toString(),null!==this.next&&(t+=", ",t+=this.next.toString()),this.stringValue=t),t}static create(e,i,s,n,r,o){if(1===arguments.length)return t.fromLike(e);if("boolean"!=typeof e){if(3===arguments.length)o=z.fromLike(s),r=l.Length.zero(),n=l.Length.zero(),s=l.Length.fromLike(i),i=l.Length.fromLike(e);else if(4===arguments.length)o=z.fromLike(n),r=l.Length.zero(),n=l.Length.fromLike(s),s=l.Length.fromLike(i),i=l.Length.fromLike(e);else{if(5!==arguments.length)throw new Error(e+", "+i+", "+s+", "+n+", "+r+", "+o);o=z.fromLike(r),r=l.Length.fromLike(n),n=l.Length.fromLike(s),s=l.Length.fromLike(i),i=l.Length.fromLike(e)}e=!1}else if(4===arguments.length)o=z.fromLike(n),r=l.Length.zero(),n=l.Length.zero(),s=l.Length.fromLike(s),i=l.Length.fromLike(i);else if(5===arguments.length)o=z.fromLike(r),r=l.Length.zero(),n=l.Length.fromLike(n),s=l.Length.fromLike(s),i=l.Length.fromLike(i);else{if(6!==arguments.length)throw new Error(e+", "+i+", "+s+", "+n+", "+r+", "+o);o=z.fromLike(o),r=l.Length.fromLike(r),n=l.Length.fromLike(n),s=l.Length.fromLike(s),i=l.Length.fromLike(i)}return new t(e,i,s,n,r,o,null)}static fromLike(...e){let i;if(0===arguments.length)return null;if(i=1===arguments.length?e[0]:e,null==i||i instanceof t)return i;if("string"==typeof i)return t.parse(i);if("object"==typeof i&&void 0===i.length)return t.fromInit(i);if("object"==typeof i&&0!==i.length)return t.fromArray(i);throw new TypeError(""+i)}static fromInit(e){const i=e.inset||!1,s=void 0!==e.offsetX?l.Length.fromLike(e.offsetX):l.Length.zero(),n=void 0!==e.offsetY?l.Length.fromLike(e.offsetY):l.Length.zero(),r=void 0!==e.blurRadius?l.Length.fromLike(e.blurRadius):l.Length.zero(),o=void 0!==e.spreadRadius?l.Length.fromLike(e.spreadRadius):l.Length.zero(),a=void 0!==e.color?z.fromLike(e.color):z.black();return new t(i,s,n,r,o,a,null)}static fromArray(e){let i=t.fromLike(e[0]);for(let t=1;t<e.length;t+=1)i=i.and(e[t]);return i}static fromValue(e){let s=null;return e.forEach((function(e,n){const r=e.header("boxShadow");if(!r.isDefined())return;let o,a,h,d,u,c;r.forEach((function(t,e){const s=t.key.stringValue();void 0!==s?"inset"===s?o=t.toValue().booleanValue(o):"offsetX"===s?a=t.toValue().cast(l.Length.form(),a):"offsetY"===s?h=t.toValue().cast(l.Length.form(),h):"blurRadius"===s?d=t.toValue().cast(l.Length.form(),d):"spreadRadius"===s?u=t.toValue().cast(l.Length.form(),u):"color"===s&&(c=t.toValue().cast(z.form(),c)):t instanceof i.Value&&(0===e&&t instanceof i.Text&&"inset"===t.value?o=!0:0===e||1===e&&void 0!==o?a=t.cast(l.Length.form(),a):1===e||2===e&&void 0!==o?h=t.cast(l.Length.form(),h):2===e||3===e&&void 0!==o?(d=t.cast(l.Length.form(),d),void 0===d&&(c=t.cast(z.form(),c))):(3===e||4===e&&void 0===o)&&void 0===c?(u=t.cast(l.Length.form(),u),void 0===u&&(c=t.cast(z.form(),c))):(4===e||5===e&&void 0===o)&&void 0===c&&(c=t.cast(z.form(),c)))})),o=void 0!==o&&o,a=void 0!==a?a:l.Length.zero(),h=void 0!==h?h:l.Length.zero(),d=void 0!==d?d:l.Length.zero(),u=void 0!==u?u:l.Length.zero(),c=void 0!==c?c:z.black();const f=new t(o||!1,a,h,d,u,c,null);s=null!==s?s.and(f):f})),s}static parse(t){let e=o.Unicode.stringInput(t);for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();let i=bt.parse(e);if(i.isDone())for(;e.isCont()&&o.Unicode.isWhitespace(e.head());)e=e.step();return e.isCont()&&!i.isError()&&(i=o.Parser.error(o.Diagnostic.unexpected(e))),i.bind()}static form(){return new yt(null)}},(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"form",static:!0,private:!1,access:{has:t=>"form"in t,get:t=>t.form},metadata:i},null,s),i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i}),u(t,s)})(),t})();const wt=function(t){const e=function(t,i){const s=function(t){const e=s.insetInterpolator(t),i=s.offsetXInterpolator(t),n=s.offsetYInterpolator(t),r=s.blurRadiusInterpolator(t),o=s.spreadRadiusInterpolator(t),l=s.colorInterpolator(t),a=s.nextInterpolator(t);return new vt(e,i,n,r,o,l,a)};return Object.setPrototypeOf(s,e.prototype),s.insetInterpolator=r.Interpolator(t.inset,i.inset),s.offsetXInterpolator=t.offsetX.interpolateTo(i.offsetX),s.offsetYInterpolator=t.offsetY.interpolateTo(i.offsetY),s.blurRadiusInterpolator=t.blurRadius.interpolateTo(i.blurRadius),s.spreadRadiusInterpolator=t.spreadRadius.interpolateTo(i.spreadRadius),s.colorInterpolator=t.color.interpolateTo(i.color),s.nextInterpolator=r.Interpolator(t.next,i.next),s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.insetInterpolator[0],e=this.offsetXInterpolator[0],i=this.offsetYInterpolator[0],s=this.blurRadiusInterpolator[0],n=this.spreadRadiusInterpolator[0],r=this.colorInterpolator[0],o=this.nextInterpolator[0];return new vt(t,e,i,s,n,r,o)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.insetInterpolator[1],e=this.offsetXInterpolator[1],i=this.offsetYInterpolator[1],s=this.blurRadiusInterpolator[1],n=this.spreadRadiusInterpolator[1],r=this.colorInterpolator[1],o=this.nextInterpolator[1];return new vt(t,e,i,s,n,r,o)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.insetInterpolator.equals(t.insetInterpolator)&&this.offsetXInterpolator.equals(t.offsetXInterpolator)&&this.offsetYInterpolator.equals(t.offsetYInterpolator)&&this.blurRadiusInterpolator.equals(t.blurRadiusInterpolator)&&this.spreadRadiusInterpolator.equals(t.spreadRadiusInterpolator)&&this.colorInterpolator.equals(t.colorInterpolator)&&this.nextInterpolator.equals(t.nextInterpolator))},e}(r.Interpolator);class yt extends i.Form{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new yt(t)}mold(t){let e=vt.fromLike(t);const s=i.Record.create();for(;;){const t=i.Record.create(5);if(e.inset&&t.push("inset"),t.push(l.Length.form().mold(e.offsetX)),t.push(l.Length.form().mold(e.offsetY)),t.push(l.Length.form().mold(e.blurRadius)),t.push(l.Length.form().mold(e.spreadRadius)),t.push(z.form().mold(e.color)),s.attr("boxShadow",t),null===e.next)break;e=e.next}return s}cast(t){const e=t.toValue();let i;try{if(i=vt.fromValue(e),void 0===i){const t=e.stringValue();void 0!==t&&(i=vt.parse(t))}}catch(t){}return i}}class bt extends o.Parser{constructor(t,e,i,s,n,r,o,l){super(),this.boxShadow=t,this.identOutput=e,this.offsetXParser=i,this.offsetYParser=s,this.blurRadiusParser=n,this.spreadRadiusParser=r,this.colorParser=o,this.step=l}feed(t){return bt.parse(t,this.boxShadow,this.identOutput,this.offsetXParser,this.offsetYParser,this.blurRadiusParser,this.spreadRadiusParser,this.colorParser,this.step)}static parse(t,e,i,s,n,r,a,h,d=1){let u=0;for(;;){if(1===d){for(;t.isCont()&&(u=t.head(),o.Unicode.isSpace(u));)t.step();if(t.isCont())d=o.Unicode.isAlpha(u)?2:4;else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(2===d){for(i=i||o.Unicode.stringOutput();t.isCont()&&(u=t.head(),o.Unicode.isAlpha(u));)t=t.step(),i.write(u);if(!t.isEmpty()){const e=i.bind();switch(e){case"inset":d=3;break;case"none":return o.Parser.done(null);default:return o.Parser.error(o.Diagnostic.message("unknown box-shadow: "+e,t))}}}if(3===d)if(t.isCont()){if(!o.Unicode.isSpace(t.head()))return o.Parser.error(o.Diagnostic.expected("space",t));t.step(),d=4}else if(t.isDone())return o.Parser.error(o.Diagnostic.unexpected(t));if(4===d){if(void 0===s){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(s=l.LengthParser.parse(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())d=5;else if(s.isError())return s.asError()}if(5===d)if(t.isCont()){if(!o.Unicode.isSpace(t.head()))return o.Parser.error(o.Diagnostic.expected("space",t));t.step(),d=6}else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t));if(6===d){if(void 0===n){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(n=l.LengthParser.parse(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())d=7;else if(n.isError())return n.asError()}if(7===d)if(t.isCont()){if(!o.Unicode.isSpace(t.head()))return o.Parser.error(o.Diagnostic.expected("space",t));t.step(),d=8}else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t));if(8===d){if(void 0===r){for(;t.isCont()&&(u=t.head(),o.Unicode.isSpace(u));)t.step();t.isCont()&&(45===u||u>=48&&u<=57)?r=l.LengthParser.parse(t):t.isEmpty()||(d=12)}else r=r.feed(t);if(void 0!==r)if(r.isDone())d=9;else if(r.isError())return r.asError()}if(9===d)if(t.isCont()){if(!o.Unicode.isSpace(t.head()))return o.Parser.error(o.Diagnostic.expected("space",t));t.step(),d=10}else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t));if(10===d){if(void 0===a){for(;t.isCont()&&(u=t.head(),o.Unicode.isSpace(u));)t.step();t.isCont()&&(45===u||u>=48&&u<=57)?a=l.LengthParser.parse(t):t.isEmpty()||(d=12)}else a=a.feed(t);if(void 0!==a)if(a.isDone())d=11;else if(a.isError())return a.asError()}if(11===d)if(t.isCont()){if(!o.Unicode.isSpace(t.head()))return o.Parser.error(o.Diagnostic.expected("space",t));t.step(),d=12}else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t));if(12===d){if(void 0===h){for(;t.isCont()&&o.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(h=W.parse(t))}else h=h.feed(t);if(void 0!==h)if(h.isDone()){const t=void 0!==i&&"inset"===i.bind(),o=s.bind(),u=n.bind(),c=void 0!==r?r.bind():l.Length.zero(),f=void 0!==a?a.bind():l.Length.zero(),p=h.bind(),g=new vt(t,o,u,c,f,p,null);e=void 0===e?g:e.and(g),i=void 0,s=void 0,n=void 0,r=void 0,a=void 0,h=void 0,d=13}else if(h.isError())return h.asError()}if(13===d){for(;t.isCont()&&(u=t.head(),o.Unicode.isSpace(u));)t.step();if(t.isCont()&&44===u){t.step(),d=1;continue}if(!t.isEmpty())return o.Parser.done(e)}break}return new bt(e,i,s,n,r,a,h,d)}}const Ct={fromLike(t){if(null==t||t instanceof a.DateTime||t instanceof l.Angle||t instanceof l.Length||t instanceof z||t instanceof I||t instanceof vt||t instanceof ut||t instanceof l.Transform||t instanceof r.Interpolator||"number"==typeof t||"boolean"==typeof t)return t;if(a.DateTimeLike[Symbol.hasInstance](t))return a.DateTime.fromLike(t);if(N[Symbol.hasInstance](t))return z.fromLike(t);if(L[Symbol.hasInstance](t))return I.fromLike(t);if(gt[Symbol.hasInstance](t))return vt.fromLike(t);if(ht[Symbol.hasInstance](t))return ut.fromLike(t);if("string"==typeof t)return Ct.parse(t);throw new TypeError(""+t)},parse(t){for("string"==typeof t&&(t=o.Unicode.stringInput(t));t.isCont()&&o.Unicode.isWhitespace(t.head());)t=t.step();let e=St.parse(t);if(e.isDone())for(;t.isCont()&&o.Unicode.isWhitespace(t.head());)t=t.step();return t.isCont()&&!e.isError()&&(e=o.Parser.error(o.Diagnostic.unexpected(t))),e.bind()},form:r.Lazy((function(){return new Tt(void 0)}))};class Tt extends i.Form{constructor(t){super(),Object.defineProperty(this,"unit",{value:t,enumerable:!0,configurable:!0})}withUnit(t){return t===this.unit?this:new Tt(t)}mold(t){if(void 0===t)return i.Item.extant();if((t=Ct.fromLike(t))instanceof a.DateTime)return a.DateTime.form().mold(t);if(t instanceof l.Angle)return l.Angle.form().mold(t);if(t instanceof l.Length)return l.Length.form().mold(t);if(t instanceof I)return I.form().mold(t);if(t instanceof z)return z.form().mold(t);if(t instanceof vt)return vt.form().mold(t);if(t instanceof l.Transform)return l.Transform.form().mold(t);if("number"==typeof t)return i.Num.from(t);throw new TypeError(""+t)}cast(t){const e=t.toValue();if(e instanceof i.Num)return e.numberValue();if(e instanceof i.Bool)return e.booleanValue();const s=e.stringValue(void 0);if(void 0!==s)try{return Ct.parse(s)}catch(t){}if(e instanceof i.Record){const t=a.DateTime.fromValue(e);if(null!==t)return t;const i=l.Angle.fromValue(e);if(null!==i)return i;const s=l.Length.fromValue(e);if(null!==s)return s;const n=I.fromValue(e);if(null!==n)return n;const r=z.fromValue(e);if(null!==r)return r;const o=vt.fromValue(e);if(null!==o)return o;const h=l.Transform.fromValue(e);if(null!==h)return h}}}class St extends o.Parser{constructor(t,e,i,s){super(),this.identOutput=t,this.valueParser=e,this.unitsOutput=i,this.step=s}feed(t){return St.parse(t,this.identOutput,this.valueParser,this.unitsOutput,this.step)}static parse(t,e,i,s,n=1){let r=0;if(1===n){for(;t.isCont()&&(r=t.head(),o.Unicode.isSpace(r));)t.step();if(t.isCont()){if(35===r)return Q.parse(t);n=o.Unicode.isAlpha(r)?2:3}else if(!t.isEmpty())return o.Parser.error(o.Diagnostic.unexpected(t))}if(2===n){for(e=e||o.Unicode.stringOutput();t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r)||o.Unicode.isDigit(r)||45===r);)t=t.step(),e.write(r);if(!t.isEmpty()){const i=e.bind();switch(i){case"rgb":case"rgba":return _.parseRest(t);case"hsl":case"hsla":return et.parseRest(t);case"linear-gradient":return pt.parseRest(t,e);case"normal":case"italic":case"oblique":return U.parseRest(t,i);case"small-caps":return U.parseRest(t,void 0,i);case"bold":case"bolder":case"lighter":return U.parseRest(t,void 0,void 0,i);case"ultra-condensed":case"extra-condensed":case"semi-condensed":case"condensed":case"expanded":case"semi-expanded":case"extra-expanded":case"ultra-expanded":return U.parseRest(t,void 0,void 0,void 0,i);case"large":case"larger":case"medium":case"small":case"smaller":case"x-large":case"x-small":case"xx-large":case"xx-small":return U.parseRest(t,void 0,void 0,void 0,void 0,i);case"translate3d":case"translateX":case"translateY":case"translate":return l.TranslateTransformParser.parseRest(t,e);case"scaleX":case"scaleY":case"scale":return l.ScaleTransformParser.parseRest(t,e);case"rotate":return l.RotateTransformParser.parseRest(t,e);case"skewX":case"skewY":case"skew":return l.SkewTransformParser.parseRest(t,e);case"matrix":return l.AffineTransformParser.parseRest(t,e);case"none":return o.Parser.done(l.Transform.identity());case"true":return o.Parser.done(!0);case"false":return o.Parser.done(!1);default:{const e=z.forName(i);return null!==e?o.Parser.done(e):o.Parser.error(o.Diagnostic.message("unknown style value: "+i,t))}}}}if(3===n)if((i=void 0===i?o.Base10.parseDecimal(t):i.feed(t)).isDone())n=4;else if(i.isError())return i.asError();if(4===n){if(t.isCont()&&(r=t.head(),45===r)){t.step();const e={};return e.year=i.bind(),a.DateTimeFormat.pattern("%m-%dT%H:%M:%S.%LZ").parseDate(t,e)}t.isEmpty()||(n=5)}if(5===n){for(s=s||o.Unicode.stringOutput();t.isCont()&&(r=t.head(),o.Unicode.isAlpha(r)||37===r);)t.step(),s.push(r);t.isEmpty()||(n=6)}if(6===n&&!t.isEmpty()){const e=i.bind(),n=s.bind();let a;switch(n){case"deg":a=l.Angle.deg(e);break;case"rad":a=l.Angle.rad(e);break;case"grad":a=l.Angle.grad(e);break;case"turn":a=l.Angle.turn(e);break;case"px":a=l.Length.px(e);break;case"em":a=l.Length.em(e);break;case"rem":a=l.Length.rem(e);break;case"%":a=l.Length.pct(e);break;case"":a=e;break;default:return o.Parser.error(o.Diagnostic.message("unknown style units: "+n,t))}if(t.isCont()&&(r=t.head(),o.Unicode.isSpace(r)||47===r)){if(a instanceof l.Length)return U.parseRest(t,void 0,void 0,void 0,void 0,a);if("number"==typeof a)switch(e){case 100:case 200:case 300:case 400:case 500:case 600:case 700:case 800:case 900:return U.parseRest(t,void 0,void 0,String(e))}}return o.Parser.done(a)}return new St(e,i,s,n)}}function xt(t){return"object"==typeof t&&null!==t?"function"==typeof t.toAttributeString?t.toAttributeString():t.toString():""+t}function Mt(t){return"object"==typeof t&&null!==t?"function"==typeof t.toStyleString?t.toStyleString():t.toString():""+t}const At=function(){let t;return t="undefined"!=typeof CSSStyleValue?function(t){return"object"==typeof t&&null!==t&&"function"==typeof t.toCssValue?t.toCssValue():"number"==typeof t?new CSSUnitValue(t,"number"):null}:Mt,t}(),Ft={[Symbol.hasInstance]:t=>t instanceof Pt||kt[Symbol.hasInstance](t)||"boolean"==typeof t},kt={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"phase","direction")};let Pt=(()=>{var t;let e,i,s=[];return t=class{constructor(t,e){this.phase=t,this.direction=e}withPhase(e){return e===this.phase?this:t.create(e,this.direction)}withDirection(e){return e===this.direction?this:t.create(this.phase,e)}get unfocused(){return 0===this.phase&&0===this.direction}get focused(){return 1===this.phase&&0===this.direction}get focusing(){return this.direction>0}get unfocusing(){return this.direction<0}asFocusing(){return this.focusing?this:t.focusing(this.phase)}asUnfocusing(){return this.unfocusing?this:t.unfocusing(this.phase)}asToggling(){return this.direction>0||this.phase>=.5?t.unfocusing(this.phase):this.direction<0||this.phase<.5?t.focusing(this.phase):this}asToggled(){return this.direction>0||this.phase>=.5?t.unfocused():this.direction<0||this.phase<.5?t.focused():this}interpolateTo(e){return e instanceof t?Vt(this,e):null}equivalentTo(e,i){return this===e||e instanceof t&&(r.Numbers.equivalent(this.phase,e.phase,i)&&r.Numbers.equivalent(this.direction,e.direction,i))}equals(e){return this===e||e instanceof t&&(this.phase===e.phase&&this.direction===e.direction)}hashCode(){return r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Constructors.hash(t),r.Numbers.hash(this.phase)),r.Numbers.hash(this.direction)))}debug(t){return t=t.write("Focus").write(46),0===this.phase&&0===this.direction?t=t.write("unfocused").write(40):1===this.phase&&0===this.direction?t=t.write("focused").write(40):1===this.direction?(t=t.write("focusing").write(40),0!==this.phase&&(t=t.debug(this.phase))):-1===this.direction?(t=t.write("unfocusing").write(40),1!==this.phase&&(t=t.debug(this.phase))):(t=t.write("create").write(40).debug(this.phase),0!==this.direction&&(t=t.write(", ").debug(this.direction))),t=t.write(41)}toString(){return o.Format.debug(this)}static unfocused(){return new t(0,0)}static focused(){return new t(1,0)}static focusing(e){return void 0===e&&(e=0),new t(e,1)}static unfocusing(e){return void 0===e&&(e=1),new t(e,-1)}static create(e,i){return void 0===i&&(i=0),0===e&&0===i?t.unfocused():1===e&&0===i?t.focused():new t(e,i)}static fromLike(e){if(null==e||e instanceof t)return e;if(kt[Symbol.hasInstance](e))return t.fromInit(e);if(!0===e)return t.focused();if(!1===e)return t.unfocused();throw new TypeError(""+e)}static fromInit(e){return new t(e.phase,e.direction)}},(()=>{const n="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],i=[r.Lazy],d(t,null,e,{kind:"method",name:"unfocused",static:!0,private:!1,access:{has:t=>"unfocused"in t,get:t=>t.unfocused},metadata:n},null,s),d(t,null,i,{kind:"method",name:"focused",static:!0,private:!1,access:{has:t=>"focused"in t,get:t=>t.focused},metadata:n},null,s),n&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:n}),u(t,s)})(),t})();const Vt=function(t){const e=function(t,i){const s=function(t){const e=s[0],i=s[1],n=e.phase+t*(i.phase-e.phase),r=1!==t?e.direction:i.direction;return Pt.create(n,r)};return Object.setPrototypeOf(s,e.prototype),s[0]=t,s[1]=i,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(r.Interpolator),Lt=e.Animator.extend("FocusAnimator",{valueType:Pt,get phase(){const t=this.value;return null!=t?t.phase:void 0},getPhase(){return this.getValue().phase},getPhaseOr(t){const e=this.value;return null==e?t:e.phase},setPhase(t,e,i){const s=this.value;null!=s&&("number"==typeof e&&(i=e,e=void 0),this.setState(s.withPhase(t),e,i))},get direction(){const t=this.value;return null!=t?t.direction:0},setDirection(t,e,i){const s=this.value;null!=s&&("number"==typeof e&&(i=e,e=void 0),this.setState(s.withDirection(t),e,i))},get unfocused(){const t=this.value;return null!=t&&t.unfocused},get focused(){const t=this.value;return null!=t&&t.focused},get focusing(){const t=this.value;return null!=t&&t.focusing},get unfocusing(){const t=this.value;return null!=t&&t.unfocusing},focus(t,e){this.setState(Pt.focused(),t,e)},unfocus(t,e){this.setState(Pt.unfocused(),t,e)},toggle(t,e){const i=this.value;null!=i&&this.setState(i.asToggled(),t,e)},willSetState(t,i){super.willSetState(t,i);const s=this.value;null!=s&&null!=t&&(t.focused?this.setValue(s.asFocusing(),e.Affinity.Reflexive):t.unfocused&&this.setValue(s.asUnfocusing(),e.Affinity.Reflexive))},onSetValue(t,e){super.onSetValue(t,e),null!=t&&null!=e&&(t.focusing&&!e.focusing?this.willFocus():t.focused&&!e.focused?this.didFocus():t.unfocusing&&!e.unfocusing?this.willUnfocus():t.unfocused&&!e.unfocused&&this.didUnfocus())},willFocus(){},didFocus(){},willUnfocus(){},didUnfocus(){},equalValues:(t,e)=>null!=t?t.equals(e):t===e}),Rt={[Symbol.hasInstance]:t=>t instanceof Ot||It[Symbol.hasInstance](t)||"boolean"==typeof t},It={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"phase","direction")};let Ot=(()=>{var t;let e,i,s=[];return t=class{constructor(t,e){this.phase=t,this.direction=e}withPhase(e){return e===this.phase?this:t.create(e,this.direction)}withDirection(e){return e===this.direction?this:t.create(this.phase,e)}get dismissed(){return 0===this.phase&&0===this.direction}get presented(){return 1===this.phase&&0===this.direction}get presenting(){return this.direction>0}get dismissing(){return this.direction<0}asPresenting(){return this.presenting?this:t.presenting(this.phase)}asDismissing(){return this.dismissing?this:t.dismissing(this.phase)}asToggling(){return this.direction>0||this.phase>=.5?t.dismissing(this.phase):this.direction<0||this.phase<.5?t.presenting(this.phase):this}asToggled(){return this.direction>0||this.phase>=.5?t.dismissed():this.direction<0||this.phase<.5?t.presented():this}interpolateTo(e){return e instanceof t?Dt(this,e):null}equivalentTo(e,i){return this===e||e instanceof t&&(r.Numbers.equivalent(this.phase,e.phase,i)&&r.Numbers.equivalent(this.direction,e.direction,i))}equals(e){return this===e||e instanceof t&&(this.phase===e.phase&&this.direction===e.direction)}hashCode(){return r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Constructors.hash(t),r.Numbers.hash(this.phase)),r.Numbers.hash(this.direction)))}debug(t){return t=t.write("Presence").write(46),0===this.phase&&0===this.direction?t=t.write("dismissed").write(40):1===this.phase&&0===this.direction?t=t.write("presented").write(40):1===this.direction?(t=t.write("presenting").write(40),0!==this.phase&&(t=t.debug(this.phase))):-1===this.direction?(t=t.write("dismissing").write(40),1!==this.phase&&(t=t.debug(this.phase))):(t=t.write("create").write(40).debug(this.phase),0!==this.direction&&(t=t.write(", ").debug(this.direction))),t=t.write(41)}toString(){return o.Format.debug(this)}static dismissed(){return new t(0,0)}static presented(){return new t(1,0)}static presenting(e){return void 0===e&&(e=0),new t(e,1)}static dismissing(e){return void 0===e&&(e=1),new t(e,-1)}static create(e,i){return void 0===i&&(i=0),0===e&&0===i?t.dismissed():1===e&&0===i?t.presented():new t(e,i)}static fromLike(e){if(null==e||e instanceof t)return e;if(It[Symbol.hasInstance](e))return t.fromInit(e);if(!0===e)return t.presented();if(!1===e)return t.dismissed();throw new TypeError(""+e)}static fromInit(e){return new t(e.phase,e.direction)}},(()=>{const n="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],i=[r.Lazy],d(t,null,e,{kind:"method",name:"dismissed",static:!0,private:!1,access:{has:t=>"dismissed"in t,get:t=>t.dismissed},metadata:n},null,s),d(t,null,i,{kind:"method",name:"presented",static:!0,private:!1,access:{has:t=>"presented"in t,get:t=>t.presented},metadata:n},null,s),n&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:n}),u(t,s)})(),t})();const Dt=function(t){const e=function(t,i){const s=function(t){const e=s[0],i=s[1],n=e.phase+t*(i.phase-e.phase),r=1!==t?e.direction:i.direction;return Ot.create(n,r)};return Object.setPrototypeOf(s,e.prototype),s[0]=t,s[1]=i,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(r.Interpolator),Et=e.Animator.extend("PresenceAnimator",{valueType:Ot,get phase(){const t=this.value;return null!=t?t.phase:void 0},getPhase(){return this.getValue().phase},getPhaseOr(t){const e=this.value;return null==e?t:e.phase},setPhase(t,e,i){const s=this.value;null!=s&&("number"==typeof e&&(i=e,e=void 0),this.setState(s.withPhase(t),e,i))},get direction(){const t=this.value;return null!=t?t.direction:0},setDirection(t,e,i){const s=this.value;null!=s&&("number"==typeof e&&(i=e,e=void 0),this.setState(s.withDirection(t),e,i))},get dismissed(){const t=this.value;return null!=t&&t.dismissed},get presented(){const t=this.value;return null!=t&&t.presented},get presenting(){const t=this.value;return null!=t&&t.presenting},get dismissing(){const t=this.value;return null!=t&&t.dismissing},present(t,e){this.setState(Ot.presented(),t,e)},dismiss(t,e){this.setState(Ot.dismissed(),t,e)},toggle(t,e){const i=this.value;null!=i&&this.setState(i.asToggled(),t,e)},willSetState(t,i){super.willSetState(t,i);const s=this.value;null!=s&&null!=t&&(t.presented?this.setValue(s.asPresenting(),e.Affinity.Reflexive):t.dismissed&&this.setValue(s.asDismissing(),e.Affinity.Reflexive))},onSetValue(t,e){super.onSetValue(t,e),null!=t&&null!=e&&(t.presenting&&!e.presenting?this.willPresent():t.presented&&!e.presented?this.didPresent():t.dismissing&&!e.dismissing?this.willDismiss():t.dismissed&&!e.dismissed&&this.didDismiss())},willPresent(){},didPresent(){},willDismiss(){},didDismiss(){},equalValues:(t,e)=>null!=t?t.equals(e):t===e}),Ut={[Symbol.hasInstance]:t=>t instanceof qt||Nt[Symbol.hasInstance](t)||"boolean"==typeof t},Nt={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"phase","direction")};let qt=(()=>{var t;let e,i,s=[];return t=class{constructor(t,e){this.phase=t,this.direction=e}withPhase(e){return e===this.phase?this:t.create(e,this.direction)}withDirection(e){return e===this.direction?this:t.create(this.phase,e)}get collapsed(){return 0===this.phase&&0===this.direction}get expanded(){return 1===this.phase&&0===this.direction}get expanding(){return this.direction>0}get collapsing(){return this.direction<0}asExpanding(){return this.expanding?this:t.expanding(this.phase)}asCollapsing(){return this.collapsing?this:t.collapsing(this.phase)}asToggling(){return this.direction>0||this.phase>=.5?t.collapsing(this.phase):this.direction<0||this.phase<.5?t.expanding(this.phase):this}asToggled(){return this.direction>0||this.phase>=.5?t.collapsed():this.direction<0||this.phase<.5?t.expanded():this}interpolateTo(e){return e instanceof t?zt(this,e):null}equivalentTo(e,i){return this===e||e instanceof t&&(r.Numbers.equivalent(this.phase,e.phase,i)&&r.Numbers.equivalent(this.direction,e.direction,i))}equals(e){return this===e||e instanceof t&&(this.phase===e.phase&&this.direction===e.direction)}hashCode(){return r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Constructors.hash(t),r.Numbers.hash(this.phase)),r.Numbers.hash(this.direction)))}debug(t){return t=t.write("Expansion").write(46),0===this.phase&&0===this.direction?t=t.write("collapsed").write(40):1===this.phase&&0===this.direction?t=t.write("expanded").write(40):1===this.direction?(t=t.write("expanding").write(40),0!==this.phase&&(t=t.debug(this.phase))):-1===this.direction?(t=t.write("collapsing").write(40),1!==this.phase&&(t=t.debug(this.phase))):(t=t.write("create").write(40).debug(this.phase),0!==this.direction&&(t=t.write(", ").debug(this.direction))),t=t.write(41)}toString(){return o.Format.debug(this)}static collapsed(){return new t(0,0)}static expanded(){return new t(1,0)}static expanding(e){return void 0===e&&(e=0),new t(e,1)}static collapsing(e){return void 0===e&&(e=1),new t(e,-1)}static create(e,i){return void 0===i&&(i=0),0===e&&0===i?t.collapsed():1===e&&0===i?t.expanded():new t(e,i)}static fromLike(e){if(null==e||e instanceof t)return e;if(Nt[Symbol.hasInstance](e))return t.fromInit(e);if(!0===e)return t.expanded();if(!1===e)return t.collapsed();throw new TypeError(""+e)}static fromInit(e){return new t(e.phase,e.direction)}},(()=>{const n="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],i=[r.Lazy],d(t,null,e,{kind:"method",name:"collapsed",static:!0,private:!1,access:{has:t=>"collapsed"in t,get:t=>t.collapsed},metadata:n},null,s),d(t,null,i,{kind:"method",name:"expanded",static:!0,private:!1,access:{has:t=>"expanded"in t,get:t=>t.expanded},metadata:n},null,s),n&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:n}),u(t,s)})(),t})();const zt=function(t){const e=function(t,i){const s=function(t){const e=s[0],i=s[1],n=e.phase+t*(i.phase-e.phase),r=1!==t?e.direction:i.direction;return qt.create(n,r)};return Object.setPrototypeOf(s,e.prototype),s[0]=t,s[1]=i,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(r.Interpolator),jt=e.Animator.extend("ExpansionAnimator",{valueType:qt,get phase(){const t=this.value;return null!=t?t.phase:void 0},getPhase(){return this.getValue().phase},getPhaseOr(t){const e=this.value;return null==e?t:e.phase},setPhase(t,e,i){const s=this.value;null!=s&&("number"==typeof e&&(i=e,e=void 0),this.setState(s.withPhase(t),e,i))},get direction(){const t=this.value;return null!=t?t.direction:0},setDirection(t,e,i){const s=this.value;null!=s&&("number"==typeof e&&(i=e,e=void 0),this.setState(s.withDirection(t),e,i))},get collapsed(){const t=this.value;return null!=t&&t.collapsed},get expanded(){const t=this.value;return null!=t&&t.expanded},get expanding(){const t=this.value;return null!=t&&t.expanding},get collapsing(){const t=this.value;return null!=t&&t.collapsing},expand(t,e){this.setState(qt.expanded(),t,e)},collapse(t,e){this.setState(qt.collapsed(),t,e)},toggle(t,e){const i=this.value;null!=i&&this.setState(i.asToggled(),t,e)},willSetState(t,i){super.willSetState(t,i);const s=this.value;null!=s&&null!=t&&(t.expanded?this.setValue(s.asExpanding(),e.Affinity.Reflexive):t.collapsed&&this.setValue(s.asCollapsing(),e.Affinity.Reflexive))},onSetValue(t,e){super.onSetValue(t,e),null!=t&&null!=e&&(t.expanding&&!e.expanding?this.willExpand():t.expanded&&!e.expanded?this.didExpand():t.collapsing&&!e.collapsing?this.willCollapse():t.collapsed&&!e.collapsed&&this.didCollapse())},willExpand(){},didExpand(){},willCollapse(){},didCollapse(){},equalValues:(t,e)=>null!=t?t.equals(e):t===e});let Wt=(()=>{var t;let e,i=[];return t=class{constructor(t,e){this.array=t,this.index=e}get size(){return this.array.length}isEmpty(){return 0===this.array.length}has(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),void 0!==this.index[t]}get(t){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.index[t]);const e="number"==typeof t?this.array[t]:void 0;return void 0!==e?e[1]:void 0}getOr(t,e){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.index[t]);const i="number"==typeof t?this.array[t]:void 0;return void 0!==i?i[1]:e}updated(t,e){let i,s=this.array,n=this.index;const r=Array.isArray(t)?t.length:1;for(let o=0;o<r;o+=1){0!==o||Array.isArray(t)?[i,e]=t[o]:i=t;const r=n[i.name];if(void 0!==e&&void 0!==r){const t=s.slice(0);t[r]=[i,e],s=t}else if(void 0!==e){const t=s.slice(0),r={};for(const t in n)r[t]=n[t];r[i.name]=t.length,t.push([i,e]),s=t,n=r}else if(void 0!==r){const t=new Array,e={};let r=0;for(let n=0;n<s.length;n+=1){const o=s[n];o[0]!==i&&(t[r]=o,e[o[0].name]=r,r+=1)}s=t,n=e}}return this}copy(e,i){return t.fromArray(e,i)}forEach(t,e){const i=this.array;for(let s=0;s<i.length;s+=1){const n=i[s],r=t.call(e,n[1],n[0]);if(void 0!==r)return r}}equals(e){return this===e||e instanceof t&&r.Arrays.equal(this.array,e.array)}debug(t){const e=this.array,i=e.length;t=t.write("LookVector").write(46).write(0!==i?"of":"empty").write(40);for(let s=0;s<i;s+=1){const[i,n]=e[s];0!==s&&(t=t.write(", ")),t=t.write(91).debug(i).write(", ").debug(n).write(93)}return t=t.write(41)}toString(){return o.Format.debug(this)}static empty(){return new t(r.Arrays.empty(),{})}static of(...e){return new t(e,t.index(e))}static fromLike(e){if(null==e||e instanceof t)return e;if(Array.isArray(e))return t.fromArray(e);throw new TypeError(""+e)}static fromArray(e,i){return void 0===i&&(i=t.index(e)),new t(e,i)}static index(t){const e={};for(let i=0;i<t.length;i+=1){e[t[i][0].name]=i}return e}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,i),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),u(t,i)})(),t})(),Ht=(()=>{var t;let e,i=[];return t=class{constructor(t,e){this.array=t,this.index=e}get size(){return this.array.length}isEmpty(){return 0===this.array.length}has(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),void 0!==this.index[t]}get(t){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.index[t]);const e="number"==typeof t?this.array[t]:void 0;return void 0!==e?e[1]:void 0}getOr(t,e){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.index[t]);const i="number"==typeof t?this.array[t]:void 0;return void 0!==i?i[1]:e}updated(t,e){let i,s=this.array,n=this.index;const r=Array.isArray(t)?t.length:1;for(let o=0;o<r;o+=1){0!==o||Array.isArray(t)?[i,e]=t[o]:i=t;const r=n[i.name];if(void 0!==e&&void 0!==r){const t=s.slice(0);t[r]=[i,e],s=t}else if(void 0!==e){const t=s.slice(0),r={};for(const t in n)r[t]=n[t];r[i.name]=t.length,t.push([i,e]),s=t,n=r}else if(void 0!==r){const t=new Array,e={};let r=0;for(let n=0;n<s.length;n+=1){const o=s[n];o[0]!==i&&(t[r]=o,e[o[0].name]=r,r+=1)}s=t,n=e}}return this}plus(t){const e=this.array,i=t.array,s=new Array,n={};for(let i=0;i<e.length;i+=1){const r=e[i],o=r[0],l=t.get(o);n[o.name]=s.length,s.push(void 0===l?r:[o,o.combine(r[1],l)])}for(let t=0;t<i.length;t+=1){const e=i[t],r=e[0];void 0===n[r.name]&&(n[r.name]=s.length,s.push(e))}return this.copy(s,n)}negative(){const t=this.array,e=t.length,i=new Array(e);for(let s=0;s<e;s+=1){const[e,n]=t[s];i[s]=[e,e.combine(void 0,n,-1)]}return this.copy(i,this.index)}minus(t){const e=this.array,i=t.array,s=new Array,n={};for(let i=0;i<e.length;i+=1){const r=e[i],o=r[0],l=t.get(o);n[o.name]=s.length,s.push(void 0===l?r:[o,o.combine(r[1],l,-1)])}for(let t=0;t<i.length;t+=1){const[e,r]=i[t];void 0===n[e.name]&&(n[e.name]=s.length,s.push([e,e.combine(void 0,r,-1)]))}return this.copy(s,n)}times(t){const e=this.array,i=e.length,s=new Array(i);for(let n=0;n<i;n+=1){const[i,r]=e[n];s[n]=[i,i.combine(void 0,r,t)]}return this.copy(s,this.index)}copy(e,i){return t.fromArray(e,i)}forEach(t,e){const i=this.array;for(let s=0;s<i.length;s+=1){const n=i[s],r=t.call(e,n[1],n[0]);if(void 0!==r)return r}}interpolateTo(e){return e instanceof t?Kt(this,e):null}equals(e){return this===e||e instanceof t&&r.Arrays.equal(this.array,e.array)}debug(t){const e=this.array,i=e.length;t=t.write("FeelVector").write(46).write(0!==i?"of":"empty").write(40);for(let s=0;s<i;s+=1){const[i,n]=e[s];0!==s&&(t=t.write(", ")),t=t.write(91).debug(i).write(", ").debug(n).write(93)}return t=t.write(41)}toString(){return o.Format.debug(this)}static empty(){return new t(r.Arrays.empty(),{})}static of(...e){const i=e.length,s=new Array(i),n={};for(let t=0;t<i;t+=1){const[i,r]=e[t];s[t]=[i,i.coerce(r)],n[i.name]=t}return new t(s,n)}static fromLike(e){if(null==e||e instanceof t)return e;if(Array.isArray(e))return t.of(...e);throw new TypeError(""+e)}static fromArray(e,i){return void 0===i&&(i=t.index(e)),new t(e,i)}static index(t){const e={};for(let i=0;i<t.length;i+=1){e[t[i][0].name]=i}return e}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,i),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),u(t,i)})(),t})();const Kt=function(t){const e=function(t,i){const s=function(t){const e=s.interpolators,i=e.length,n=new Array(i),r=s.index;for(let s=0;s<i;s+=1){const[i,r]=e[s],o=r(t);n[s]=[i,o]}return Ht.fromArray(n,r)};Object.setPrototypeOf(s,e.prototype);const n=new Array,r={};return t.forEach((function(t,e){const s=i.get(e);if(void 0!==s){const i=e.between(t,s);r[e.name]=n.length,n.push([e,i])}})),s.interpolators=n,s.index=r,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.interpolators,e=t.length,i=new Array(e),s=this.index;for(let s=0;s<e;s+=1){const[e,n]=t[s],r=n[0];i[s]=[e,r]}return Ht.fromArray(i,s)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.interpolators,e=t.length,i=new Array(e),s=this.index;for(let s=0;s<e;s+=1){const[e,n]=t[s],r=n[1];i[s]=[e,r]}return Ht.fromArray(i,s)},configurable:!0}),e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){const e=this.interpolators.length;if(e!==t.interpolators.length)return!1;for(let i=0;i<e;i+=1)if(!r.Arrays.equal(this.interpolators[i],t.interpolators[i]))return!1;return!0}return!1},e}(r.Interpolator);let Bt=(()=>{var t;let e,i=[];return t=class{constructor(t,e){this.array=t,this.index=e}get size(){return this.array.length}isEmpty(){return 0===this.array.length}has(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),void 0!==this.index[t]}get(t){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.index[t]);const e="number"==typeof t?this.array[t]:void 0;return void 0!==e?e[1]:void 0}getOr(t,e){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.index[t]);const i="number"==typeof t?this.array[t]:void 0;return void 0!==i?i[1]:e}updated(t,e){let i,s,n,r=this.array,o=this.index;const l=Array.isArray(t)?t.length:1;for(let a=0;a<l;a+=1){0!==a||Array.isArray(t)?[i,e]=t[a]:i=t;const l=o[i.name];if(void 0!==e&&void 0!==l)s=r.slice(0),n=o,s[l]=[i,e],r=s;else if(void 0!==e){s=r.slice(0),n={};for(const t in o)n[t]=o[t];n[i.name]=s.length,s.push([i,e]),r=s,o=n}else if(void 0!==l){s=new Array,n={};let t=0;for(let e=0;e<r.length;e+=1){const o=r[e];o[0]!==i&&(s[t]=o,n[o[0].name]=t,t+=1)}r=s,o=n}}return void 0===s||void 0===n?this:this.copy(s,n)}plus(t){const e=this.array,i=t.array,s=new Array,n={};for(let i=0;i<e.length;i+=1){const r=e[i],o=r[0],l=t.get(o);n[o.name]=s.length,s.push(void 0===l?r:[o,r[1]+l])}for(let t=0;t<i.length;t+=1){const e=i[t],r=e[0];void 0===n[r.name]&&(n[r.name]=s.length,s.push(e))}return this.copy(s,n)}negative(){const t=this.array,e=t.length,i=new Array(e);for(let s=0;s<e;s+=1){const[e,n]=t[s];i[s]=[e,-n]}return this.copy(i,this.index)}minus(t){const e=this.array,i=t.array,s=new Array,n={};for(let i=0;i<e.length;i+=1){const r=e[i],o=r[0],l=t.get(o);n[o.name]=s.length,s.push(void 0===l?r:[o,r[1]-l])}for(let t=0;t<i.length;t+=1){const[e,r]=i[t];void 0===n[e.name]&&(n[e.name]=s.length,s.push([e,-r]))}return this.copy(s,n)}times(t){const e=this.array,i=e.length,s=new Array(i);for(let n=0;n<i;n+=1){const[i,r]=e[n];s[n]=[i,r*t]}return this.copy(s,this.index)}dot(t){const e=this.array;let i;for(let s=0;s<e.length;s+=1){const[n,r]=e[s],o=t.get(n);void 0!==o&&(void 0===i?i=r*o:i+=r*o)}return i}copy(e,i){return t.fromArray(e,i)}forEach(t,e){const i=this.array;for(let s=0;s<i.length;s+=1){const n=i[s],r=t.call(e,n[1],n[0]);if(void 0!==r)return r}}equals(e){return this===e||e instanceof t&&r.Arrays.equal(this.array,e.array)}debug(t){const e=this.array,i=e.length;t=t.write("MoodVector").write(46).write(0!==i?"of":"empty").write(40);for(let s=0;s<i;s+=1){const[i,n]=e[s];0!==s&&(t=t.write(", ")),t=t.write(91).debug(i).write(", ").debug(n).write(93)}return t=t.write(41)}toString(){return o.Format.debug(this)}static empty(){return new t(r.Arrays.empty(),{})}static of(...e){return new t(e,t.index(e))}static fromLike(e){if(null==e||e instanceof t)return e;if(Array.isArray(e))return t.fromArray(e);throw new TypeError(""+e)}static fromArray(e,i){return void 0===i&&(i=t.index(e)),new t(e,i)}static index(t){const e={};for(let i=0;i<t.length;i+=1){e[t[i][0].name]=i}return e}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,i),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),u(t,i)})(),t})(),Gt=(()=>{var t;let e,i=[];return t=class{constructor(t,e,i,s){this.rowArray=t,this.rowIndex=e,this.colArray=i,this.colIndex=s}get rowCount(){return this.rowArray.length}get colCount(){return this.colArray.length}hasRow(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),void 0!==this.rowIndex[t]}hasCol(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),void 0!==this.colIndex[t]}getRow(t){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.rowIndex[t]);const e="number"==typeof t?this.rowArray[t]:void 0;return void 0!==e?e[1]:void 0}getCol(t){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.colIndex[t]);const e="number"==typeof t?this.colArray[t]:void 0;return void 0!==e?e[1]:void 0}plus(e){const i=this.colArray,s=e.colArray,n=new Array,r={};for(let t=0;t<i.length;t+=1){const s=i[t],o=s[0],l=e.getCol(o);r[o.name]=n.length,n.push(void 0===l?s:[o,s[1].plus(l)])}for(let t=0;t<s.length;t+=1){const e=s[t],i=e[0];void 0===r[i.name]&&(r[i.name]=n.length,n.push(e))}return t.fromColArray(n,r)}negative(){const e=this.colArray,i=e.length,s=new Array(i);for(let t=0;t<i;t+=1){const[i,n]=e[t];s[t]=[i,n.negative()]}return t.fromColArray(s,this.colIndex)}minus(e){const i=this.colArray,s=e.colArray,n=new Array,r={};for(let t=0;t<i.length;t+=1){const s=i[t],o=s[0],l=e.getCol(o);r[o.name]=n.length,n.push(void 0===l?s:[o,s[1].minus(l)])}for(let t=0;t<s.length;t+=1){const[e,i]=s[t];void 0===r[e.name]&&(r[e.name]=n.length,n.push([e,i.negative()]))}return t.fromColArray(n,r)}times(e){const i=this.colArray,s=i.length,n=new Array(s);for(let t=0;t<s;t+=1){const[s,r]=i[t];n[t]=[s,r.times(e)]}return t.fromColArray(n,this.colIndex)}dot(t,e){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.rowIndex[t]);const i="number"==typeof t?this.rowArray[t]:void 0;if(void 0===i)return;t=i[0];return i[1].dot(e)}timesCol(t,e=!1){const i=this.rowArray,s=new Array,n={};for(let e=0;e<i.length;e+=1){const[r,o]=i[e],l=o.dot(t);void 0!==l&&(n[r.name]=s.length,s.push([r,l]))}if(e){const e=t.array;for(let t=0;t<e.length;t+=1){const i=e[t][0];this.hasRow(i)||(n[i.name]=s.length,s.push(e[t]))}}return Bt.fromArray(s,n)}timesRow(t,e=!1){const i=this.colArray,s=new Array,n={};for(let e=0;e<i.length;e+=1){const[r,o]=i[e],l=t.dot(o);void 0!==l&&(n[r.name]=s.length,s.push([r,l]))}if(e){const e=t.array;for(let t=0;t<e.length;t+=1){const i=e[t][0];this.hasCol(i)||(n[i.name]=s.length,s.push(e[t]))}}return Bt.fromArray(s,n)}transform(e,i=!0){const s=this.rowArray,n=this.colArray,r=new Array,o={},l=new Array,a={};for(let t=0;t<n.length;t+=1){const h=n[t][0];let d=e.getCol(h);if(void 0===d&&i&&(d=Bt.of([h,1])),void 0!==d)for(let t=0;t<s.length;t+=1){const[e,i]=s[t],n=i.dot(d);if(void 0===n)continue;const u=o[e.name];if(void 0===u)o[e.name]=r.length,r.push([e,Bt.of([h,n])]);else{const t=r[u][1];t.index[e.name]=t.array.length,t.array.push([h,n])}const c=a[h.name];if(void 0===c)a[h.name]=l.length,l.push([h,Bt.of([e,n])]);else{const t=l[c][1];t.index[h.name]=t.array.length,t.array.push([e,n])}}}return new t(r,o,l,a)}identityFor(e){const i=this.rowArray,s=e.colArray;let n,r;for(let t=0;t<s.length;t+=1){const e=s[t][0];if(!this.hasRow(e)){if(void 0===n&&(n=i.slice(0)),void 0===r){r={};for(const t in this.rowIndex)r[t]=this.rowIndex[t]}r[e.name]=n.length,n.push([e,Bt.of([e,1])])}}return void 0===n||void 0===r?this:t.fromRowArray(n,r)}row(e,i){void 0!==i&&(i=Bt.fromLike(i));const s=this.rowArray,n=this.rowIndex,r=n[e.name];if(void 0!==i&&void 0!==r){const o=s.slice(0);return o[r]=[e,i],t.fromRowArray(o,n)}if(void 0!==i){const r=s.slice(0),o={};for(const t in n)o[t]=n[t];return o[e.name]=r.length,r.push([e,i]),t.fromRowArray(r,o)}if(void 0!==r){const i=new Array,n={};let r=0;for(let t=0;t<s.length;t+=1){const o=s[t];o[0]!==e&&(i[r]=o,n[o[0].name]=r,r+=1)}return t.fromRowArray(i,n)}return this}col(e,i){void 0!==i&&(i=Bt.fromLike(i));const s=this.colArray,n=this.colIndex,r=n[e.name];if(void 0!==i&&void 0!==r){const o=s.slice(0);return o[r]=[e,i],t.fromColArray(o,n)}if(void 0!==i){const r=s.slice(0),o={};for(const t in n)o[t]=n[t];return o[e.name]=r.length,r.push([e,i]),t.fromColArray(r,o)}if(void 0!==r){const i=new Array,n={};let r=0;for(let t=0;t<s.length;t+=1){const o=s[t];o[0]!==e&&(i[r]=o,n[o[0].name]=r,r+=1)}return t.fromColArray(i,n)}return this}updatedRow(t,e,i){const s=this.getRow(t);let n=s;return void 0===n&&(!0===i?i=Bt.of([t,1]):!1===i&&(i=void 0),n=i=void 0===i?Bt.empty():Bt.fromLike(i)),n=n.updated(e),n.equals(s)?this:this.row(t,n)}updatedCol(t,e,i){const s=this.getCol(t);let n=s;return void 0===n&&(!0===i?i=Bt.of([t,1]):!1===i&&(i=void 0),n=i=void 0===i?Bt.empty():Bt.fromLike(i)),n=n.updated(e),n.equals(s)?this:this.col(t,n)}equals(e){if(this===e)return!0;if(e instanceof t){return r.Arrays.equal(this.colArray,e.colArray)}return!1}debug(t){const e=this.colArray,i=e.length;t=t.write("MoodMatrix").write(46).write(0!==i?"forCols":"empty").write(40);for(let s=0;s<i;s+=1){const[i,n]=e[s];0!==s&&(t=t.write(", ")),t=t.write(91).debug(i).write(", ").debug(n).write(93)}return t=t.write(41)}toString(){return o.Format.debug(this)}static empty(){return new t(r.Arrays.empty(),{},r.Arrays.empty(),{})}static forRows(...t){const e=t.length,i=new Array(e);for(let s=0;s<e;s+=1){const[e,n]=t[s];i[s]=[e,Bt.fromLike(n)]}return this.fromRowArray(i)}static forCols(...t){const e=t.length,i=new Array(e);for(let s=0;s<e;s+=1){const[e,n]=t[s];i[s]=[e,Bt.fromLike(n)]}return this.fromColArray(i)}static fromRowArray(e,i){void 0===i&&(i=Bt.index(e));const s=new Array,n={};for(let t=0;t<e.length;t+=1){e[t][1].forEach((function(t,e){void 0===n[e.name]&&(n[e.name]=s.length,s.push([e,void 0]))}),this)}for(let t=0;t<s.length;t+=1){const i=s[t],n=i[0],r=new Array,o={};for(let t=0;t<e.length;t+=1){const[i,s]=e[t],l=s.get(n);void 0!==l&&(o[i.name]=r.length,r.push([i,l]))}const l=Bt.fromArray(r,o);i[1]=l}return new t(e,i,s,n)}static fromColArray(e,i){void 0===i&&(i=Bt.index(e));const s=new Array,n={};for(let t=0;t<e.length;t+=1){e[t][1].forEach((function(t,e){void 0===n[e.name]&&(n[e.name]=s.length,s.push([e,void 0]))}),this)}for(let t=0;t<s.length;t+=1){const i=s[t],n=i[0],r=new Array,o={};for(let t=0;t<e.length;t+=1){const[i,s]=e[t],l=s.get(n);void 0!==l&&(o[i.name]=r.length,r.push([i,l]))}const l=Bt.fromArray(r,o);i[1]=l}return new t(s,n,e,i)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,i),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),u(t,i)})(),t})(),Yt=(()=>{var t;let e,i=[];return t=class{constructor(t,e,i,s){this.rowArray=t,this.rowIndex=e,this.colArray=i,this.colIndex=s}get rowCount(){return this.rowArray.length}get colCount(){return this.colArray.length}hasRow(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),void 0!==this.rowIndex[t]}hasCol(t){return("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),void 0!==this.colIndex[t]}getRow(t){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.rowIndex[t]);const e="number"==typeof t?this.rowArray[t]:void 0;return void 0!==e?e[1]:void 0}getCol(t){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.colIndex[t]);const e="number"==typeof t?this.colArray[t]:void 0;return void 0!==e?e[1]:void 0}get(t,e){return this.dot(t,e)}getOr(t,e,i){return this.dotOr(t,e,i)}plus(e){const i=this.colArray,s=e.colArray,n=new Array,r={};for(let t=0;t<i.length;t+=1){const s=i[t],o=s[0],l=e.getCol(o);r[o.name]=n.length,n.push(void 0===l?s:[o,s[1].plus(l)])}for(let t=0;t<s.length;t+=1){const e=s[t],i=e[0];void 0===r[i.name]&&(r[i.name]=n.length,n.push(e))}return t.fromColArray(n,r)}negative(){const e=this.colArray,i=e.length,s=new Array(i);for(let t=0;t<i;t+=1){const[i,n]=e[t];s[t]=[i,n.negative()]}return t.fromColArray(s,this.colIndex)}minus(e){const i=this.colArray,s=e.colArray,n=new Array,r={};for(let t=0;t<i.length;t+=1){const s=i[t],o=s[0],l=e.getCol(o);r[o.name]=n.length,n.push(void 0===l?s:[o,s[1].minus(l)])}for(let t=0;t<s.length;t+=1){const[e,i]=s[t];void 0===r[e.name]&&(r[e.name]=n.length,n.push([e,i.negative()]))}return t.fromColArray(n,r)}times(e){const i=this.colArray,s=i.length,n=new Array(s);for(let t=0;t<s;t+=1){const[s,r]=i[t];n[t]=[s,r.times(e)]}return t.fromColArray(n,this.colIndex)}dot(t,e){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.rowIndex[t]);const i="number"==typeof t?this.rowArray[t]:void 0;if(void 0===i)return;t=i[0];const s=i[1];return t.dot(s,e)}dotOr(t,e,i){("object"==typeof t&&null!==t||"function"==typeof t)&&(t=t.name),"string"==typeof t&&(t=this.rowIndex[t]);const s="number"==typeof t?this.rowArray[t]:void 0;if(void 0===s)return i;t=s[0];const n=s[1];return t.dotOr(n,e,i)}timesCol(t){const e=this.rowArray,i=new Array,s={};for(let n=0;n<e.length;n+=1){const[r,o]=e[n],l=r.dot(o,t);void 0!==l&&(s[r.name]=i.length,i.push([r,l]))}return Ht.fromArray(i,s)}transform(e,i=!0){const s=this.rowArray,n=this.colArray,r=new Array,o={},l=new Array,a={};for(let t=0;t<n.length;t+=1){const h=n[t][0];let d=e.getCol(h);if(void 0===d&&i&&(d=Bt.of([h,1])),void 0!==d)for(let t=0;t<s.length;t+=1){const[e,i]=s[t],n=e.dot(i,d);if(void 0===n)continue;const u=o[e.name];if(void 0===u)o[e.name]=r.length,r.push([e,Wt.of([h,n])]);else{const t=r[u][1];t.index[e.name]=t.array.length,t.array.push([h,n])}const c=a[h.name];if(void 0===c)a[h.name]=l.length,l.push([h,Ht.of([e,n])]);else{const t=l[c][1];t.index[h.name]=t.array.length,t.array.push([e,n])}}}return new t(r,o,l,a)}row(e,i){void 0!==i&&(i=Wt.fromLike(i));const s=this.rowArray,n=this.rowIndex,r=n[e.name];if(void 0!==i&&void 0!==r){const o=s.slice(0);return o[r]=[e,i],t.fromRowArray(o,n)}if(void 0!==i){const r=s.slice(0),o={};for(const t in n)o[t]=n[t];return o[e.name]=r.length,r.push([e,i]),t.fromRowArray(r,o)}if(void 0!==r){const i=new Array,n={};let r=0;for(let t=0;t<s.length;t+=1){const o=s[t];o[0]!==e&&(i[r]=o,n[o[0].name]=r,r+=1)}return t.fromRowArray(i,n)}return this}col(e,i){void 0!==i&&(i=Ht.fromLike(i));const s=this.colArray,n=this.colIndex,r=n[e.name];if(void 0!==i&&void 0!==r){const o=s.slice(0);return o[r]=[e,i],t.fromColArray(o,n)}if(void 0!==i){const r=s.slice(0),o={};for(const t in n)o[t]=n[t];return o[e.name]=r.length,r.push([e,i]),t.fromColArray(r,o)}if(void 0!==r){const i=new Array,n={};let r=0;for(let t=0;t<s.length;t+=1){const o=s[t];o[0]!==e&&(i[r]=o,n[o[0].name]=r,r+=1)}return t.fromColArray(i,n)}return this}updatedRow(t,e,i){const s=this.getRow(t);let n=s;return void 0===n&&(n=i=void 0!==i?Wt.fromLike(i):Wt.empty()),n=n.updated(e),n.equals(s)?this:this.row(t,n)}updatedCol(t,e,i){const s=this.getCol(t);let n=s;return void 0===n&&(n=i=void 0!==i?Ht.fromLike(i):Ht.empty()),n=n.updated(e),n.equals(s)?this:this.col(t,n)}equals(e){return this===e||e instanceof t&&r.Arrays.equal(this.colArray,e.colArray)}debug(t){const e=this.colArray,i=e.length;t=t.write("ThemeMatrix").write(46).write(0!==i?"forCols":"empty").write(40);for(let s=0;s<i;s+=1){const[i,n]=e[s];0!==s&&(t=t.write(", ")),t=t.write(91).debug(i).write(", ").debug(n).write(93)}return t=t.write(41)}toString(){return o.Format.debug(this)}static empty(){return new t(r.Arrays.empty(),{},r.Arrays.empty(),{})}static forRows(...t){const e=t.length,i=new Array(e);for(let s=0;s<e;s+=1){const[e,n]=t[s];i[s]=[e,Wt.fromLike(n)]}return this.fromRowArray(i)}static forCols(...t){const e=t.length,i=new Array(e);for(let s=0;s<e;s+=1){const[e,n]=t[s];i[s]=[e,Ht.fromLike(n)]}return this.fromColArray(i)}static fromRowArray(e,i){void 0===i&&(i=Ht.index(e));const s=new Array,n={};for(let t=0;t<e.length;t+=1){e[t][1].forEach((function(t,e){void 0===n[e.name]&&(n[e.name]=s.length,s.push([e,void 0]))}),this)}for(let t=0;t<s.length;t+=1){const i=s[t],n=i[0],r=new Array,o={};for(let t=0;t<e.length;t+=1){const[i,s]=e[t],l=s.get(n);void 0!==l&&(o[i.name]=r.length,r.push([i,l]))}const l=Ht.fromArray(r,o);i[1]=l}return new t(e,i,s,n)}static fromColArray(e,i){void 0===i&&(i=Wt.index(e));const s=new Array,n={};for(let t=0;t<e.length;t+=1){e[t][1].forEach((function(t,e){void 0===n[e.name]&&(n[e.name]=s.length,s.push([e,void 0]))}),this)}for(let t=0;t<s.length;t+=1){const i=s[t],n=i[0],r=new Array,o={};for(let t=0;t<e.length;t+=1){const[i,s]=e[t],l=s.get(n);void 0!==l&&(o[i.name]=r.length,r.push([i,l]))}const l=Wt.fromArray(r,o);i[1]=l}return new t(s,n,e,i)}},(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[r.Lazy],d(t,null,e,{kind:"method",name:"empty",static:!0,private:!1,access:{has:t=>"empty"in t,get:t=>t.empty},metadata:s},null,i),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s}),u(t,i)})(),t})();const Xt={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"getLook")},_t=e.Animator.extend("ThemeAnimator",{onSetAffinity(t,i){t>e.Affinity.Intrinsic&&this.setLook(null,t),super.onSetAffinity(t,i)},set(t,i){return t instanceof e.Fastener?this.bindInlet(t):t instanceof Jt?this.setLook(t,i,e.Affinity.Extrinsic):this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return t instanceof e.Fastener?this.bindInlet(t):t instanceof Jt?this.setLook(t,i,e.Affinity.Intrinsic):this.setState(t,i,e.Affinity.Intrinsic),this.owner},get inletLook(){const t=this.inlet;return t instanceof _t?t.look:null},getInletLook(){const t=this.inletLook;if(null===t)throw new TypeError(t+" "+this.name.toString()+" inlet look");return t},getInletLookOr(t){const e=this.inletLook;return null===e?t:e},look:null,initLook(){return Object.getPrototypeOf(this).look},getLook(){const t=this.look;if(null===t)throw new TypeError(t+" "+this.name.toString()+" look");return t},getLookOr(t){const e=this.look;return null===e?t:e},setLook(t,i,s){if("number"==typeof i&&(s=i,i=void 0),void 0===s&&(s=e.Affinity.Extrinsic),!this.minAffinity(s))return;const n=this.look;t!==n&&(!0===(i=void 0===i?this.transition:r.Timing.fromLike(i))?i=r.Objects.hasAllKeys(this.owner,"getTransition")?this.owner.getTransition(this):this.timing:!1===i&&(i=null),this.willSetLook(t,n,i),this.incrementVersion(),this.look=t,this.onSetLook(t,n,i),this.didSetLook(t,n,i))},willSetLook(t,e,i){},onSetLook(t,e,i){null!==t&&this.applyLook(t,i)},didSetLook(t,e,i){},applyLook(t,i){if(!this.mounted||!Xt[Symbol.hasInstance](this.owner))return;const s=this.owner.getLook(t);void 0!==s&&this.setState(s,i,e.Affinity.Reflexive)},applyTheme(t,i,s){const n=this.look;if(null===n)return;const o=t.get(n,i);void 0!==o&&(!0===(s=void 0===s?this.transition:r.Timing.fromLike(s))?s=r.Objects.hasAllKeys(this.owner,"getTransition")?this.owner.getTransition(this):this.timing:!1===s&&(s=null),this.setState(o,s,e.Affinity.Reflexive))},recohere(t){this.setCoherentTime(t);const i=this.inlet;if(i instanceof e.Animator)this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)?(i instanceof _t?this.setLook(i.look,i.timing,e.Affinity.Reflexive):this.setLook(null,e.Affinity.Reflexive),null===this.look?this.tweenInherited(t):0!=(this.flags&e.Animator.TweeningFlag)?this.tween(t):this.setCoherent(!0)):0!=(this.flags&e.Animator.TweeningFlag)?this.tween(t):this.setCoherent(!0);else if(i instanceof e.Property)if(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.inletVersion!==i.version){this.inletVersion=i.version;const s=i.getOutletValue(this);if(s instanceof Jt)this.setLook(s,e.Affinity.Reflexive);else{this.setLook(null,e.Affinity.Reflexive);const t=this.deriveValue(i.getOutletValue(this));this.setState(t,e.Affinity.Reflexive)}0!=(this.flags&e.Animator.TweeningFlag)?this.tween(t):this.setCoherent(!0)}else 0!=(this.flags&e.Animator.TweeningFlag)?this.tween(t):this.setCoherent(!0);else if(Array.isArray(i)){this.setDerived(!0);const s=this.inletVersion,n=new Array(i.length);for(let t=0;t<i.length;t+=1){if(!(i[t]instanceof e.Property))return this.setDerived(!1),void this.setCoherent(!0);s[t]=i[t].version,n[t]=i[t].getOutletValue(this)}const r=this.deriveValue(...n);this.setState(r,e.Affinity.Reflexive),0!=(this.flags&e.Animator.TweeningFlag)?this.tween(t):this.setCoherent(!0)}else this.setDerived(!1),0!=(this.flags&e.Animator.TweeningFlag)?this.tween(t):this.setCoherent(!0)},onMount(){super.onMount();const t=this.look;null!==t&&this.applyLook(t,!1)}},{construct(t,e){return(t=super.construct(t,e)).look=t.initLook(),t}}),Qt=_t.extend("ThemeConstraintAnimator",{isExternal:()=>!0,isDummy:()=>!1,isInvalid:()=>!1,isConstant:()=>!1,evaluateConstraintVariable(){},updateConstraintSolution(t){this.constrained&&this.toNumber(this.state)!==t&&this.setState(t,e.Affinity.Reflexive)},initStrength(){let t=Object.getPrototypeOf(this).strength;return void 0===t&&(t=h.ConstraintStrength.Strong),t},setStrength(t){this.strength=h.ConstraintStrength.fromLike(t)},get coefficient(){return 1},get variable(){return this},get terms(){const t=new Map;return t.set(this,1),t},get constant(){return 0},plus(t){return this===(t=h.ConstraintExpression.fromLike(t))?h.ConstraintExpression.product(2,this):h.ConstraintExpression.sum(this,t)},negative(){return h.ConstraintExpression.product(-1,this)},minus(t){return this===(t=h.ConstraintExpression.fromLike(t))?h.ConstraintExpression.zero():h.ConstraintExpression.sum(this,t.negative())},times(t){return h.ConstraintExpression.product(t,this)},divide(t){return h.ConstraintExpression.product(1/t,this)},get constrained(){return 0!=(this.flags&Qt.ConstrainedFlag)},constrain(t){void 0===t&&(t=!0);const e=this.flags;return t&&0==(e&Qt.ConstrainedFlag)?(this.setFlags(e|Qt.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&this.stopConstraining()):t||0==(e&Qt.ConstrainedFlag)||(this.setFlags(e&~Qt.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())),this},addConstraintCondition(t,e){this.conditionCount+=1,!this.constrained&&1===this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())},removeConstraintCondition(t,e){this.conditionCount-=1,!this.constrained&&0===this.conditionCount&&this.mounted&&this.stopConstraining()},get constraining(){return 0!=(this.flags&Qt.ConstrainingFlag)},startConstraining(){0==(this.flags&Qt.ConstrainingFlag)&&(this.willStartConstraining(),this.setFlags(this.flags|Qt.ConstrainingFlag),this.onStartConstraining(),this.didStartConstraining())},willStartConstraining(){},onStartConstraining(){const t=this.owner;h.ConstraintScope[Symbol.hasInstance](t)&&t.addConstraintVariable(this)},didStartConstraining(){},stopConstraining(){0!=(this.flags&Qt.ConstrainingFlag)&&(this.willStopConstraining(),this.setFlags(this.flags&~Qt.ConstrainingFlag),this.onStopConstraining(),this.didStopConstraining())},willStopConstraining(){},onStopConstraining(){const t=this.owner;h.ConstraintScope[Symbol.hasInstance](t)&&t.removeConstraintVariable(this)},didStopConstraining(){},updateConstraintVariable(){const t=this.owner,e=this.value;void 0!==e&&h.ConstraintScope[Symbol.hasInstance](t)&&t.setConstraintVariable(this,this.toNumber(e))},onSetValue(t,e){super.onSetValue(t,e);const i=this.owner;this.constraining&&h.ConstraintScope[Symbol.hasInstance](i)&&i.setConstraintVariable(this,null!=t?this.toNumber(t):0)},onMount(){super.onMount(),this.constrained||0===this.conditionCount||this.startConstraining()},onUnmount(){this.constrained||0===this.conditionCount||this.stopConstraining(),super.onUnmount()},toNumber:t=>null!=t?+t:0},{construct(t,e){return(t=super.construct(t,e)).strength=t.initStrength(),t.conditionCount=0,t},refine(t){super.refine(t);const e=t.prototype;let i=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"constrained")&&(e.constrained?i|=Qt.ConstrainedFlag:i&=~Qt.ConstrainedFlag,delete e.constrained),Object.defineProperty(e,"flagsInit",{value:i,enumerable:!0,configurable:!0});const s=Object.getOwnPropertyDescriptor(e,"strength");void 0!==s&&"value"in s&&(s.value=h.ConstraintStrength.fromLike(s.value),Object.defineProperty(e,"strength",s))},ConstrainedFlag:1<<_t.FlagShift+0,ConstrainingFlag:1<<_t.FlagShift+1,FlagShift:_t.FlagShift+2,FlagMask:(1<<_t.FlagShift+2)-1});class Jt{constructor(t){this.name=t}add(t,e){const i=t.array,s=e.array,n=new Array,r={};for(let t=0;t<i.length;t+=1){const s=i[t],o=s[0],l=e.get(o);r[o.name]=n.length,n.push(void 0===l?s:[o,o.combine(this,s[1],l)])}for(let t=0;t<s.length;t+=1){const e=s[t],i=e[0];void 0===r[i.name]&&(r[i.name]=n.length,n.push(e))}return this.fromArray(n,r)}negate(t){const e=t.array,i=e.length,s=new Array(i);for(let t=0;t<i;t+=1){const[i,n]=e[t];s[t]=[i,i.combine(this,void 0,n,-1)]}return this.fromArray(s,t.index)}subtract(t,e){const i=t.array,s=e.array,n=new Array,r={};for(let t=0;t<i.length;t+=1){const s=i[t],o=s[0],l=e.get(o);r[o.name]=n.length,n.push(void 0===l?s:[o,o.combine(this,s[1],l,-1)])}for(let t=0;t<s.length;t+=1){const[e,i]=s[t];void 0===r[e.name]&&(r[e.name]=n.length,n.push([e,e.combine(this,void 0,i,-1)]))}return this.fromArray(n,r)}multiply(t,e){const i=t.array,s=i.length,n=new Array(s);for(let t=0;t<s;t+=1){const[s,r]=i[t];n[t]=[s,s.combine(this,void 0,r,e)]}return this.fromArray(n,t.index)}dot(t,e){const i=t.array;let s;for(let t=0;t<i.length;t+=1){const[n,r]=i[t],o=e.get(n);void 0!==o&&0!==o&&(s=n.combine(this,s,r,o))}return s}dotOr(t,e,i){const s=t.array;if(0===s.length)return i;let n;for(let t=0;t<s.length;t+=1){const[i,r]=s[t],o=e.get(i);void 0!==o&&0!==o&&(n=i.combine(this,n,r,o))}return n}empty(){return Wt.empty()}of(...t){const e=t.length,i=new Array(e),s={};for(let n=0;n<e;n+=1){const[e,r]=t[n];i[n]=[e,this.coerce(r)],s[e.name]=n}return this.fromArray(i,s)}fromArray(t,e){return Wt.fromArray(t,e)}toString(){return"Look."+this.name}}class Zt extends Jt{combine(t,e,i){return void 0!==t?void 0===i||1===i?e:0===i?t:(1-i)*t+i*e:void 0!==i&&1!==i?e*i:e}between(t,e){return r.NumberInterpolator(t,e)}coerce(t){return t}static fromLike(t){return null==t||t instanceof Jt?t:r.Numbers.fromLike(t)}}class $t extends Jt{combine(t,e,i){return void 0!==t?void 0===i||1===i?e:0===i?t:l.LengthInterpolator(t,e)(i):void 0!==i&&1!==i?e.times(i):e}between(t,e){return l.LengthInterpolator(t,e)}coerce(t){return l.Length.fromLike(t)}static fromLike(t){return null==t||t instanceof Jt||t instanceof l.Length?t:l.Length.fromLike(t)}}class te extends Jt{combine(t,e,i){return void 0!==t?void 0===i||1===i?e:0===i?t:t.interpolateTo(e)(i):void 0!==i&&1!==i?e.times(i):e}between(t,e){return t.interpolateTo(e)}coerce(t){return z.fromLike(t)}static fromLike(t){return null==t||t instanceof Jt||t instanceof z?t:z.fromLike(t)}}class ee extends Jt{combine(t,e,i){return void 0===i||0!==i?e:void 0!==t?t:I.family(e.family)}between(t,e){return O(t,e)}coerce(t){return I.fromLike(t)}static fromLike(t){return null==t||t instanceof Jt||t instanceof I?t:I.fromLike(t)}}class ie extends Jt{combine(t,e,i){return void 0===i||0!==i?e:void 0!==t?t:e}between(t,e){return wt(t,e)}coerce(t){return vt.fromLike(t)}static fromLike(t){return null==t||t instanceof Jt||t instanceof vt?t:vt.fromLike(t)}}class se extends Jt{combine(t,e,i){return void 0===i||0!==i?e:void 0!==t?t:e}between(t,e){return r.Interpolator(t,e)}coerce(t){return r.Timing.fromLike(t)}static fromLike(t){return null==t||t instanceof Jt||t instanceof r.Timing?t:r.Timing.fromLike(t)}}Jt.font=new ee("font"),Jt.smallFont=new ee("smallFont"),Jt.largeFont=new ee("largeFont"),Jt.textColor=new te("textColor"),Jt.iconColor=new te("iconColor"),Jt.labelColor=new te("labelColor"),Jt.legendColor=new te("legendColor"),Jt.placeholderColor=new te("placeholderColor"),Jt.highlightColor=new te("highlightColor"),Jt.statusColor=new te("statusColor"),Jt.accentColor=new te("accentColor"),Jt.backgroundColor=new te("backgroundColor"),Jt.selectionColor=new te("selectionColor"),Jt.borderColor=new te("borderColor"),Jt.focusColor=new te("focusColor"),Jt.etchColor=new te("etchColor"),Jt.maskColor=new te("maskColor"),Jt.tickColor=new te("tickColor"),Jt.gridColor=new te("gridColor"),Jt.opacity=new Zt("opacity"),Jt.shadow=new ie("shadow"),Jt.spacing=new $t("spacing"),Jt.timing=new se("timing");class ne{constructor(t){this.name=t}empty(){return Ht.empty()}of(...t){return Ht.of(...t)}from(t,e){return Ht.fromArray(t,e)}toString(){return"Feel."+this.name}}class re extends ne{combine(t,e,i,s){return t.combine(e,i,s)}}class oe extends ne{combine(t,e,i,s){if(e instanceof z&&i instanceof z){const t=void 0===s?i.alpha():i.alpha()*s;return t>=0?e.darker(t):e.lighter(-t)}return t.combine(e,i,s)}}class le extends ne{combine(t,e,i,s){if(e instanceof z&&i instanceof z){void 0===s&&(s=1);const t=e.alpha(),n=(1-s)*t+s*(t*i.alpha());return e.alpha(n)}return t.combine(e,i,s)}}ne.ambient=new re("ambient"),ne.default=new re("default"),ne.primary=new re("primary"),ne.secondary=new re("secondary"),ne.disabled=new re("disabled"),ne.inactive=new re("inactive"),ne.warning=new re("warning"),ne.alert=new re("alert"),ne.unselected=new re("unselected"),ne.selected=new re("selected"),ne.darker=new oe("darker"),ne.lighter=new oe("lighter"),ne.contrasted=new oe("contrasted"),ne.raised=new re("raised"),ne.covered=new re("covered"),ne.opaque=new re("opaque"),ne.floating=new re("floating"),ne.embossed=new oe("embossed"),ne.nested=new oe("nested"),ne.hovering=new oe("hovering"),ne.translucent=new le("translucent"),ne.transparent=new le("transparent"),ne.navigating=new re("navigating");const ae={};ae.ambient=Bt.of([ne.ambient,1]),ae.default=Bt.of([ne.default,1]),ae.primary=Bt.of([ne.primary,1]),ae.secondary=Bt.of([ne.secondary,1]),ae.disabled=Bt.of([ne.disabled,1]),ae.inactive=Bt.of([ne.inactive,1]),ae.warning=Bt.of([ne.warning,1]),ae.alert=Bt.of([ne.alert,1]),ae.unselected=Bt.of([ne.unselected,1]),ae.selected=Bt.of([ne.selected,1]),ae.darker=Bt.of([ne.darker,1]),ae.lighter=Bt.of([ne.lighter,1]),ae.contrasted=Bt.of([ne.contrasted,1]),ae.raised=Bt.of([ne.raised,1]),ae.covered=Bt.of([ne.covered,1]),ae.opaque=Bt.of([ne.opaque,1]),ae.floating=Bt.of([ne.floating,1]),ae.transparent=Bt.of([ne.transparent,1]),ae.translucent=Bt.of([ne.translucent,1]),ae.embossed=Bt.of([ne.embossed,1]),ae.nested=Bt.of([ne.nested,1]),ae.hovering=Bt.of([ne.hovering,1]),ae.navigating=Bt.of([ne.navigating,1]);const he={};he.dark=function(){const t=I.parse("14px -apple-system, system-ui, sans-serif"),e=t.withSize(12),i=t.withSize(16),s=z.parse("#ffffff"),n=z.parse("#ffffff"),o=z.parse("#ffffff").alpha(.85),a=z.parse("#ffffff").alpha(.55),h=z.parse("#ffffff").alpha(.25),d=z.white(.1),u=z.parse("#a1a3a4"),c=z.parse("#66ffdd"),f=z.parse("#32c5ff"),p=z.parse("#7b7c7d"),g=z.parse("#7b7c7d"),m=z.parse("#f9f070"),v=z.parse("#f6511d"),w=z.parse("#5e5f5f"),y=z.parse("#2b6458"),b=z.parse("#326578"),C=z.parse("#67643b"),T=z.parse("#6a3423"),S=z.parse("#181818"),x=z.parse("#ffffff").alpha(.25),M=c.alpha(.5),A=z.parse("#212121"),F=z.parse("#363636"),k=z.parse("#262626"),P=z.parse("#343434"),V=z.parse("#c0c0c0"),L=z.parse("#3c3c3c"),R=l.Length.px(10),O=Ht.of([Jt.font,t],[Jt.smallFont,e],[Jt.largeFont,i],[Jt.textColor,s],[Jt.iconColor,n],[Jt.labelColor,o],[Jt.legendColor,a],[Jt.placeholderColor,h],[Jt.highlightColor,d],[Jt.statusColor,s],[Jt.accentColor,u],[Jt.backgroundColor,S],[Jt.selectionColor,w],[Jt.borderColor,x],[Jt.focusColor,M],[Jt.etchColor,k],[Jt.maskColor,P],[Jt.tickColor,V],[Jt.gridColor,L],[Jt.spacing,R],[Jt.timing,r.Easing.linear.withDuration(250)]),D=Ht.of([Jt.font,t],[Jt.smallFont,e],[Jt.largeFont,i],[Jt.textColor,s],[Jt.iconColor,n],[Jt.labelColor,o],[Jt.legendColor,a],[Jt.placeholderColor,h],[Jt.highlightColor,d],[Jt.statusColor,s],[Jt.accentColor,u],[Jt.backgroundColor,S],[Jt.selectionColor,w],[Jt.borderColor,x],[Jt.focusColor,M],[Jt.etchColor,k],[Jt.maskColor,P],[Jt.tickColor,V],[Jt.gridColor,L],[Jt.spacing,R],[Jt.timing,r.Easing.cubicOut.withDuration(250)]),E=Ht.of([Jt.accentColor,c],[Jt.selectionColor,y]),U=Ht.of([Jt.accentColor,f],[Jt.selectionColor,b]),N=Ht.of([Jt.textColor,p],[Jt.iconColor,p],[Jt.statusColor,p],[Jt.accentColor,p]),q=Ht.of([Jt.statusColor,g],[Jt.accentColor,g]),j=Ht.of([Jt.statusColor,m],[Jt.accentColor,m],[Jt.selectionColor,C]),W=Ht.of([Jt.statusColor,v],[Jt.accentColor,v],[Jt.selectionColor,T]),H=Ht.of([Jt.textColor,o],[Jt.iconColor,o],[Jt.backgroundColor,S.darker(1)]),K=Ht.of([Jt.textColor,s],[Jt.iconColor,n],[Jt.backgroundColor,w]),B=Ht.of([Jt.labelColor,o.darker(1/3)],[Jt.legendColor,a.darker(1/3)],[Jt.backgroundColor,A]),G=Ht.of([Jt.labelColor,o.darker(1/3)],[Jt.legendColor,a.darker(1/3)],[Jt.backgroundColor,F]),Y=Ht.of([Jt.backgroundColor,S],[Jt.borderColor,x]),X=Ht.of([Jt.shadow,vt.create(0,2,4,0,z.black(.5))]),_=Ht.of([Jt.backgroundColor,z.black(1)],[Jt.selectionColor,z.black(1)],[Jt.iconColor,z.black(1)],[Jt.statusColor,z.black(1)],[Jt.accentColor,z.black(1)],[Jt.etchColor,z.black(1)],[Jt.maskColor,z.black(1)]),Q=Ht.of([Jt.backgroundColor,z.black(-1)],[Jt.selectionColor,z.black(-1)],[Jt.iconColor,z.black(-1)],[Jt.statusColor,z.black(-1)],[Jt.accentColor,z.black(-1)],[Jt.etchColor,z.black(-1)],[Jt.maskColor,z.black(-1)]),J=Ht.of([Jt.backgroundColor,z.black(-1)],[Jt.selectionColor,z.black(-1)],[Jt.iconColor,z.black(-1)],[Jt.statusColor,z.black(-1)],[Jt.accentColor,z.black(-1)],[Jt.etchColor,z.black(-1)],[Jt.maskColor,z.black(-1)]),Z=Ht.of([Jt.iconColor,z.black(2)],[Jt.statusColor,z.black(2)],[Jt.accentColor,z.black(2)]),$=Ht.of([Jt.backgroundColor,z.black(1/3)],[Jt.borderColor,z.black(1/3)]),tt=Ht.of([Jt.backgroundColor,z.black(-2)],[Jt.etchColor,z.black(-1)],[Jt.maskColor,z.black(-1)]),et=Ht.of([Jt.iconColor,z.black(.8)],[Jt.statusColor,z.black(.8)],[Jt.accentColor,z.black(.8)],[Jt.backgroundColor,z.black(.8)],[Jt.selectionColor,z.black(.8)]),it=Ht.of([Jt.backgroundColor,z.black(0)],[Jt.selectionColor,z.black(0)]),st=Ht.of([Jt.timing,r.Easing.cubicOut.withDuration(350)]);return Yt.forCols([ne.ambient,O],[ne.default,D],[ne.primary,E],[ne.secondary,U],[ne.disabled,N],[ne.inactive,q],[ne.warning,j],[ne.alert,W],[ne.unselected,H],[ne.selected,K],[ne.darker,_],[ne.lighter,Q],[ne.contrasted,J],[ne.raised,B],[ne.covered,G],[ne.opaque,Y],[ne.floating,X],[ne.embossed,Z],[ne.nested,$],[ne.hovering,tt],[ne.translucent,et],[ne.transparent,it],[ne.navigating,st])}(),he.light=function(){const t=I.parse("14px -apple-system, system-ui, sans-serif"),e=t.withSize(12),i=t.withSize(16),s=z.parse("#000000"),n=z.parse("#4a4a4a"),o=z.parse("#000000").alpha(.85),a=z.parse("#000000").alpha(.5),h=z.parse("#000000").alpha(.25),d=z.black(.05),u=z.parse("#a1a3a4"),c=z.parse("#00b0a7"),f=z.parse("#008ec0"),p=z.parse("#7b7c7d"),g=z.parse("#7b7c7d"),m=z.parse("#f0b600"),v=z.parse("#e24214"),w=z.parse("#e0e0e1"),y=z.parse("#bae8e6"),b=z.parse("#b5e2f1"),C=z.parse("#f9ebc0"),T=z.parse("#fddad0"),S=z.parse("#f9f9f9"),x=z.parse("#000000").alpha(.25),M=c.alpha(.5),A=z.parse("#f1f1f1"),F=z.parse("#ffffff"),k=z.parse("#d8d8d8"),P=z.parse("#dcdcdc"),V=z.parse("#262626"),L=z.parse("#e0e0e0"),R=l.Length.px(10),O=Ht.of([Jt.font,t],[Jt.smallFont,e],[Jt.largeFont,i],[Jt.textColor,s],[Jt.iconColor,n],[Jt.labelColor,o],[Jt.legendColor,a],[Jt.placeholderColor,h],[Jt.highlightColor,d],[Jt.statusColor,s],[Jt.accentColor,u],[Jt.backgroundColor,S],[Jt.selectionColor,w],[Jt.borderColor,x],[Jt.focusColor,M],[Jt.etchColor,k],[Jt.maskColor,P],[Jt.tickColor,V],[Jt.gridColor,L],[Jt.spacing,R],[Jt.timing,r.Easing.linear.withDuration(250)]),D=Ht.of([Jt.font,t],[Jt.smallFont,e],[Jt.largeFont,i],[Jt.textColor,s],[Jt.iconColor,n],[Jt.labelColor,o],[Jt.legendColor,a],[Jt.placeholderColor,h],[Jt.highlightColor,d],[Jt.statusColor,s],[Jt.accentColor,u],[Jt.backgroundColor,S],[Jt.selectionColor,w],[Jt.borderColor,x],[Jt.focusColor,M],[Jt.etchColor,k],[Jt.maskColor,P],[Jt.tickColor,V],[Jt.gridColor,L],[Jt.spacing,R],[Jt.timing,r.Easing.cubicOut.withDuration(250)]),E=Ht.of([Jt.accentColor,c],[Jt.selectionColor,y]),U=Ht.of([Jt.accentColor,f],[Jt.selectionColor,b]),N=Ht.of([Jt.textColor,p],[Jt.iconColor,p],[Jt.statusColor,p],[Jt.accentColor,p]),q=Ht.of([Jt.statusColor,g],[Jt.accentColor,g]),j=Ht.of([Jt.statusColor,m],[Jt.accentColor,m],[Jt.selectionColor,C]),W=Ht.of([Jt.statusColor,v],[Jt.accentColor,v],[Jt.selectionColor,T]),H=Ht.of([Jt.textColor,o],[Jt.iconColor,o],[Jt.backgroundColor,S.darker(.5)]),K=Ht.of([Jt.textColor,s],[Jt.iconColor,n],[Jt.backgroundColor,w]),B=Ht.of([Jt.labelColor,o.darker(1/3)],[Jt.legendColor,a.darker(1/3)],[Jt.backgroundColor,A]),G=Ht.of([Jt.labelColor,o.darker(1/3)],[Jt.legendColor,a.darker(1/3)],[Jt.backgroundColor,F]),Y=Ht.of([Jt.backgroundColor,S],[Jt.borderColor,x]),X=Ht.of([Jt.shadow,vt.create(0,2,4,0,z.black(.5))]),_=Ht.of([Jt.backgroundColor,z.black(1)],[Jt.selectionColor,z.black(1)],[Jt.iconColor,z.black(1)],[Jt.statusColor,z.black(1)],[Jt.accentColor,z.black(1)],[Jt.etchColor,z.black(1)],[Jt.maskColor,z.black(1)]),Q=Ht.of([Jt.backgroundColor,z.black(-1)],[Jt.selectionColor,z.black(-1)],[Jt.iconColor,z.black(-1)],[Jt.statusColor,z.black(-1)],[Jt.accentColor,z.black(-1)],[Jt.etchColor,z.black(-1)],[Jt.maskColor,z.black(-1)]),J=Ht.of([Jt.backgroundColor,z.black(1)],[Jt.selectionColor,z.black(1)],[Jt.iconColor,z.black(1)],[Jt.statusColor,z.black(1)],[Jt.accentColor,z.black(1)],[Jt.etchColor,z.black(1)],[Jt.maskColor,z.black(1)]),Z=Ht.of([Jt.iconColor,z.black(1)],[Jt.statusColor,z.black(1)],[Jt.accentColor,z.black(1)]),$=Ht.of([Jt.backgroundColor,z.black(1/24)],[Jt.borderColor,z.black(1/24)]),tt=Ht.of([Jt.backgroundColor,z.black(1/4)],[Jt.etchColor,z.black(1/4)],[Jt.maskColor,z.black(1/4)]),et=Ht.of([Jt.iconColor,z.black(.8)],[Jt.statusColor,z.black(.8)],[Jt.accentColor,z.black(.8)],[Jt.backgroundColor,z.black(.8)],[Jt.selectionColor,z.black(.8)]),it=Ht.of([Jt.backgroundColor,z.black(0)],[Jt.selectionColor,z.black(0)]),st=Ht.of([Jt.timing,r.Easing.cubicOut.withDuration(350)]);return Yt.forCols([ne.ambient,O],[ne.default,D],[ne.primary,E],[ne.secondary,U],[ne.disabled,N],[ne.inactive,q],[ne.warning,j],[ne.alert,W],[ne.unselected,H],[ne.selected,K],[ne.raised,B],[ne.covered,G],[ne.opaque,Y],[ne.floating,X],[ne.embossed,Z],[ne.nested,$],[ne.hovering,tt],[ne.translucent,et],[ne.darker,_],[ne.lighter,Q],[ne.contrasted,J],[ne.transparent,it],[ne.navigating,st])}();const de={zero:r.Lazy((function(){return Object.freeze({insetTop:0,insetRight:0,insetBottom:0,insetLeft:0})})),equal:(t,e)=>t===e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&(t.insetTop===e.insetTop&&t.insetRight===e.insetRight&&t.insetBottom===e.insetBottom&&t.insetLeft===e.insetLeft)};let ue=(()=>{var t;let i,s,n,o,a,c,f,p,g,m=e.Component,v=[],w=[],y=[],b=[],C=[],T=[],S=[];return t=class extends m{constructor(){super(),this.willAttachParentObservers=void u(this,v),this.updater=u(this,w,void 0),this.styler=u(this,y,void 0),this.mood=u(this,b,void 0),this.theme=u(this,C,void 0),this.moodModifier=u(this,T,void 0),this.themeModifier=u(this,S,void 0),this.constraints=null,this.constraintVariables=null,this.willAttachParentObservers=null,this.didAttachParentObservers=null,this.willDetachParentObservers=null,this.didDetachParentObservers=null,this.willInsertChildObservers=null,this.didInsertChildObservers=null,this.willRemoveChildObservers=null,this.didRemoveChildObservers=null,this.willMountObservers=null,this.didMountObservers=null,this.willUnmountObservers=null,this.didUnmountObservers=null,this.willResizeObservers=null,this.didResizeObservers=null,this.willScrollObservers=null,this.didScrollObservers=null,this.willChangeObservers=null,this.didChangeObservers=null,this.willAnimateObservers=null,this.didAnimateObservers=null,this.willProjectObservers=null,this.didProjectObservers=null,this.willLayoutObservers=null,this.didLayoutObservers=null,this.willRenderObservers=null,this.didRenderObservers=null,this.willRasterizeObservers=null,this.didRasterizeObservers=null,this.willCompositeObservers=null,this.didCompositeObservers=null}get componentType(){return t}attachParent(t,e){let i;this.willAttachParent(t),this.parent=t,null!==e?(i=e.previousSibling,this.setNextSibling(e),e.setPreviousSibling(this)):(i=t.lastChild,t.setLastChild(this)),null!==i?(i.setNextSibling(this),this.setPreviousSibling(i)):t.setFirstChild(this),t.mounted&&(t.culled&&this.cascadeCull(),this.cascadeMount()),this.onAttachParent(t),this.didAttachParent(t)}willAttachParent(t){const e=this.willAttachParentObservers;if(null!==e)for(const i of e)i.viewWillAttachParent(t,this)}onAttachParent(t){}didAttachParent(t){const e=this.didAttachParentObservers;if(null!==e)for(const i of e)i.viewDidAttachParent(t,this)}willDetachParent(t){const e=this.willDetachParentObservers;if(null!==e)for(const i of e)i.viewWillDetachParent(t,this)}onDetachParent(t){}didDetachParent(t){const e=this.didDetachParentObservers;if(null!==e)for(const i of e)i.viewDidDetachParent(t,this)}willInsertChild(t,e){super.willInsertChild(t,e);const i=this.willInsertChildObservers;if(null!==i)for(const s of i)s.viewWillInsertChild(t,e,this)}onInsertChild(t,e){super.onInsertChild(t,e)}didInsertChild(t,e){const i=this.didInsertChildObservers;if(null!==i)for(const s of i)s.viewDidInsertChild(t,e,this);super.didInsertChild(t,e)}cascadeInsert(e){0!=(this.flags&t.MountedFlag)&&(void 0===e&&(e=0),0!=((e|=this.flags&t.UpdateMask)&t.ProcessMask)&&this.cascadeProcess(e))}willRemoveChild(t){super.willRemoveChild(t);const e=this.willRemoveChildObservers;if(null!==e)for(const i of e)i.viewWillRemoveChild(t,this)}onRemoveChild(t){super.onRemoveChild(t)}didRemoveChild(t){const e=this.didRemoveChildObservers;if(null!==e)for(const i of e)i.viewDidRemoveChild(t,this);super.didRemoveChild(t)}willReinsertChild(t,e){super.willReinsertChild(t,e),this.callObservers("viewWillReinsertChild",t,e,this)}onReinsertChild(t,e){super.onReinsertChild(t,e)}didReinsertChild(t,e){this.callObservers("viewDidReinsertChild",t,e,this),super.didReinsertChild(t,e)}mount(){throw new Error}willMount(){super.willMount();const t=this.willMountObservers;if(null!==t)for(const e of t)e.viewWillMount(this)}didMount(){this.requestUpdate(this,this.flags&t.UpdateMask,!1),this.requireUpdate(this.mountFlags),this.culled||null===this.decoherent||0===this.decoherent.length||this.requireUpdate(t.NeedsChange|t.NeedsAnimate),this.mountFasteners(),this.activateLayout();const e=this.didMountObservers;if(null!==e)for(const t of e)t.viewDidMount(this);super.didMount()}unmount(){throw new Error}willUnmount(){super.willUnmount();const t=this.willUnmountObservers;if(null!==t)for(const e of t)e.viewWillUnmount(this);this.deactivateLayout()}didUnmount(){const t=this.didUnmountObservers;if(null!==t)for(const e of t)e.viewDidUnmount(this);super.didUnmount()}get culled(){return 0!=(this.flags&t.CulledMask)}setCulled(e){const i=this.flags;e&&0==(i&t.CulledFlag)?0==(i&t.CullFlag)?(this.willCull(),this.setFlags(i|t.CulledFlag),this.onCull(),this.cullChildren(),this.didCull()):this.setFlags(i|t.CulledFlag):e||0==(i&t.CulledFlag)||(0==(i&t.CullFlag)?(this.willUncull(),this.setFlags(i&~t.CulledFlag),this.uncullChildren(),this.onUncull(),this.didUncull()):this.setFlags(i&~t.CulledFlag))}cascadeCull(){0==(this.flags&t.CullFlag)&&(0==(this.flags&t.CulledFlag)?(this.willCull(),this.setFlags(this.flags|t.CullFlag),this.onCull(),this.cullChildren(),this.didCull()):this.setFlags(this.flags|t.CullFlag))}willCull(){this.callObservers("viewWillCull",this)}onCull(){}didCull(){this.callObservers("viewDidCull",this)}cullChildren(){let t=this.firstChild;for(;null!==t;){const e=t.nextSibling;if(t.cascadeCull(),null!==e&&e.parent!==this)throw new Error("inconsistent cull");t=e}}cascadeUncull(){0!=(this.flags&t.CullFlag)&&(0==(this.flags&t.CulledFlag)?(this.willUncull(),this.setFlags(this.flags&~t.CullFlag),this.uncullChildren(),this.onUncull(),this.didUncull()):this.setFlags(this.flags&~t.CullFlag))}get uncullFlags(){return this.constructor.UncullFlags}willUncull(){this.callObservers("viewWillUncull",this)}onUncull(){this.requestUpdate(this,this.flags&t.UpdateMask,!1),this.requireUpdate(this.uncullFlags),null!==this.decoherent&&0!==this.decoherent.length&&this.requireUpdate(t.NeedsChange|t.NeedsAnimate),this.mood.derived&&this.mood.decohere(),this.theme.derived&&this.theme.decohere()}didUncull(){this.callObservers("viewDidUncull",this)}uncullChildren(){let t=this.firstChild;for(;null!==t;){const e=t.nextSibling;if(t.cascadeUncull(),null!==e&&e.parent!==this)throw new Error("inconsistent uncull");t=e}}get hidden(){return 0!=(this.flags&t.HiddenMask)}setHidden(e){const i=this.flags;e&&0==(i&t.HiddenFlag)?(this.setFlags(i|t.HiddenFlag),0==(i&t.HideFlag)&&(this.willHide(),this.onHide(),this.hideChildren(),this.didHide())):e||0==(i&t.HiddenFlag)||(this.setFlags(i&~t.HiddenFlag),0==(i&t.HideFlag)&&(this.willUnhide(),this.unhideChildren(),this.onUnhide(),this.didUnhide()))}cascadeHide(){0==(this.flags&t.HideFlag)&&(0==(this.flags&t.HiddenFlag)?(this.willHide(),this.setFlags(this.flags|t.HideFlag),this.onHide(),this.hideChildren(),this.didHide()):this.setFlags(this.flags|t.HideFlag))}willHide(){this.callObservers("viewWillHide",this)}onHide(){}didHide(){this.callObservers("viewDidHide",this)}hideChildren(){let t=this.firstChild;for(;null!==t;){const e=t.nextSibling;if(t.cascadeHide(),null!==e&&e.parent!==this)throw new Error("inconsistent hide");t=e}}cascadeUnhide(){0!=(this.flags&t.HideFlag)&&(0==(this.flags&t.HiddenFlag)?(this.willUnhide(),this.setFlags(this.flags&~t.HideFlag),this.unhideChildren(),this.onUnhide(),this.didUnhide()):this.setFlags(this.flags&~t.HideFlag))}get unhideFlags(){return this.constructor.UnhideFlags}willUnhide(){this.callObservers("viewWillUnhide",this)}onUnhide(){this.requestUpdate(this,this.flags&t.UpdateMask,!1),this.requireUpdate(this.uncullFlags)}didUnhide(){this.callObservers("viewDidUnhide",this)}unhideChildren(){let t=this.firstChild;for(;null!==t;){const e=t.nextSibling;if(t.cascadeUnhide(),null!==e&&e.parent!==this)throw new Error("inconsistent unhide");t=e}}get unbounded(){return 0!=(this.flags&t.UnboundedFlag)}setUnbounded(e){e!==(0!=(this.flags&t.UnboundedFlag))&&(this.willSetUnbounded(e),e?this.setFlags(this.flags|t.UnboundedFlag):this.setFlags(this.flags&~t.UnboundedFlag),this.onSetUnbounded(e),this.didSetUnbounded(e))}willSetUnbounded(t){}onSetUnbounded(t){}didSetUnbounded(t){}get intangible(){return 0!=(this.flags&t.IntangibleFlag)}setIntangible(e){e!==(0!=(this.flags&t.IntangibleFlag))&&(this.willSetIntangible(e),e?this.setFlags(this.flags|t.IntangibleFlag):this.setFlags(this.flags&~t.IntangibleFlag),this.onSetIntangible(e),this.didSetIntangible(e))}willSetIntangible(t){}onSetIntangible(t){}didSetIntangible(t){}requireUpdate(e,i=!1){const s=this.flags,n=e&~s&t.UpdateMask;0!==n&&(this.setFlags(s|n),this.requestUpdate(this,n,i))}needsUpdate(t,e){return t}requestUpdate(e,i,s){if((this.flags&t.CulledMask)===t.CulledFlag)return;i=this.needsUpdate(i,s);let n=this.flags&~i&t.UpdateMask;if(0!=(i&t.ProcessMask)&&(n|=t.NeedsProcess),0!=(i&t.DisplayMask)&&(n|=t.NeedsDisplay),0===n&&!s)return;this.setFlags(this.flags|n);const r=this.parent;if(null!==r)r.requestUpdate(e,i,s);else if(this.mounted){const t=this.updater.service;null!==t&&t.requestUpdate(e,i,s)}}get updating(){return 0!=(this.flags&t.UpdatingMask)}get processing(){return 0!=(this.flags&t.ProcessingFlag)}needsProcess(t){return t}cascadeProcess(e){try{if(e&=~t.NeedsProcess,e|=this.flags&t.UpdateMask,0==((e=this.needsProcess(e))&t.ProcessMask))return;let i=e;this.setFlags(this.flags&~t.NeedsProcess|t.ProcessingFlag),this.willProcess(i),0!=((this.flags|e)&t.NeedsResize)&&(i|=t.NeedsResize,this.setFlags(this.flags&~t.NeedsResize),this.willResize()),0!=((this.flags|e)&t.NeedsScroll)&&(i|=t.NeedsScroll,this.setFlags(this.flags&~t.NeedsScroll),this.willScroll()),0!=((this.flags|e)&t.NeedsChange)&&(i|=t.NeedsChange,this.setFlags(this.flags&~t.NeedsChange),this.willChange()),0!=((this.flags|e)&t.NeedsAnimate)&&(i|=t.NeedsAnimate,this.setFlags(this.flags&~t.NeedsAnimate),this.willAnimate()),0!=((this.flags|e)&t.NeedsProject)&&(i|=t.NeedsProject,this.setFlags(this.flags&~t.NeedsProject),this.willProject()),this.onProcess(i),0!=(i&t.NeedsResize)&&this.onResize(),0!=(i&t.NeedsScroll)&&this.onScroll(),0!=(i&t.NeedsChange)&&this.onChange(),0!=(i&t.NeedsAnimate)&&this.onAnimate(),0!=(i&t.NeedsProject)&&this.onProject(),0!=(i&t.ProcessMask)&&this.processChildren(i,this.processChild),0!=(i&t.NeedsProject)&&this.didProject(),0!=(i&t.NeedsAnimate)&&this.didAnimate(),0!=(i&t.NeedsChange)&&this.didChange(),0!=(i&t.NeedsScroll)&&this.didScroll(),0!=(i&t.NeedsResize)&&this.didResize(),this.didProcess(i)}finally{this.setFlags(this.flags&~t.ProcessingFlag)}}willProcess(t){}onProcess(t){}didProcess(t){}willResize(){const t=this.willResizeObservers;if(null!==t)for(const e of t)e.viewWillResize(this);this.evaluateConstraintVariables()}onResize(){}didResize(){const t=this.didResizeObservers;if(null!==t)for(const e of t)e.viewDidResize(this)}willScroll(){const t=this.willScrollObservers;if(null!==t)for(const e of t)e.viewWillScroll(this)}onScroll(){}didScroll(){const t=this.didScrollObservers;if(null!==t)for(const e of t)e.viewDidScroll(this)}willChange(){const t=this.willChangeObservers;if(null!==t)for(const e of t)e.viewWillChange(this)}onChange(){this.recohereFasteners(this.updateTime)}didChange(){const t=this.didChangeObservers;if(null!==t)for(const e of t)e.viewDidChange(this)}willAnimate(){const t=this.willAnimateObservers;if(null!==t)for(const e of t)e.viewWillAnimate(this)}onAnimate(){this.recohereAnimators(this.updateTime)}didAnimate(){const t=this.didAnimateObservers;if(null!==t)for(const e of t)e.viewDidAnimate(this)}willProject(){const t=this.willProjectObservers;if(null!==t)for(const e of t)e.viewWillProject(this)}onProject(){}didProject(){const t=this.didProjectObservers;if(null!==t)for(const e of t)e.viewDidProject(this)}processChildren(t,e){let i=this.firstChild;for(;null!==i;){const s=i.nextSibling;if(e.call(this,i,t),null!==s&&s.parent!==this)throw new Error("inconsistent process pass");i=s}}processChild(t,e){t.cascadeProcess(e)}get displaying(){return 0!=(this.flags&t.DisplayingFlag)}needsDisplay(t){return t}cascadeDisplay(e){try{if(e&=~t.NeedsDisplay,e|=this.flags&t.UpdateMask,0==((e=this.needsDisplay(e))&t.DisplayMask))return;let i=e;this.setFlags(this.flags&~t.NeedsDisplay|t.DisplayingFlag),this.willDisplay(i),0!=((this.flags|e)&t.NeedsLayout)&&(i|=t.NeedsLayout,this.setFlags(this.flags&~t.NeedsLayout),this.willLayout()),0!=((this.flags|e)&t.NeedsRender)&&(i|=t.NeedsRender,this.setFlags(this.flags&~t.NeedsRender),this.willRender()),0!=((this.flags|e)&t.NeedsRasterize)&&(i|=t.NeedsRasterize,this.setFlags(this.flags&~t.NeedsRasterize),this.willRasterize()),0!=((this.flags|e)&t.NeedsComposite)&&(i|=t.NeedsComposite,this.setFlags(this.flags&~t.NeedsComposite),this.willComposite()),this.onDisplay(i),0!=(i&t.NeedsLayout)&&this.onLayout(),0!=(i&t.NeedsRender)&&this.onRender(),0!=(i&t.NeedsRasterize)&&this.onRasterize(),0!=(i&t.NeedsComposite)&&this.onComposite(),0==(i&t.DisplayMask)||this.hidden||this.culled||this.displayChildren(i,this.displayChild),0!=(i&t.NeedsComposite)&&this.didComposite(),0!=(i&t.NeedsRasterize)&&this.didRasterize(),0!=(i&t.NeedsRender)&&this.didRender(),0!=(i&t.NeedsLayout)&&this.didLayout(),this.didDisplay(i)}finally{this.setFlags(this.flags&~t.DisplayingFlag)}}willDisplay(t){}onDisplay(t){}didDisplay(t){}willLayout(){const t=this.willLayoutObservers;if(null!==t)for(const e of t)e.viewWillLayout(this)}onLayout(){}didLayout(){const t=this.didLayoutObservers;if(null!==t)for(const e of t)e.viewDidLayout(this)}willRender(){const t=this.willRenderObservers;if(null!==t)for(const e of t)e.viewWillRender(this)}onRender(){}didRender(){const t=this.didRenderObservers;if(null!==t)for(const e of t)e.viewDidRender(this)}willRasterize(){const t=this.willRasterizeObservers;if(null!==t)for(const e of t)e.viewWillRasterize(this)}onRasterize(){}didRasterize(){const t=this.didRasterizeObservers;if(null!==t)for(const e of t)e.viewDidRasterize(this)}willComposite(){const t=this.willCompositeObservers;if(null!==t)for(const e of t)e.viewWillComposite(this)}onComposite(){}didComposite(){const t=this.didCompositeObservers;if(null!==t)for(const e of t)e.viewDidComposite(this)}displayChildren(t,e){let i=this.firstChild;for(;null!==i;){const s=i.nextSibling;if(e.call(this,i,t),null!==s&&s.parent!==this)throw new Error("inconsistent display pass");i=s}}displayChild(t,e){t.cascadeDisplay(e)}get updateTime(){return this.updater.getService().updateTime}get viewport(){return e.Provider.getter()}get solver(){return e.Provider.getter()}getLook(t,e){const i=this.theme.value;let s;return null!==i&&(null==e&&(e=this.mood.value),null!==e&&(s=i.get(t,e))),s}getLookOr(t,e,i){2===arguments.length&&(i=e,e=null);const s=this.theme.value;let n;return null!==s?(null==e&&(e=this.mood.value),n=null!==e?s.getOr(t,e,i):i):n=i,n}applyTheme(t,e,i){i=(void 0!==i||!this.inserting)&&(void 0===i||!0===i?t.getOr(Jt.timing,ae.ambient,!1):r.Timing.fromLike(i)),this.willApplyTheme(t,e,i),this.onApplyTheme(t,e,i),this.didApplyTheme(t,e,i)}willApplyTheme(t,e,i){this.callObservers("viewWillApplyTheme",t,e,i,this)}onApplyTheme(t,e,i){this.themeFsteners(t,e,i)}didApplyTheme(t,e,i){this.callObservers("viewDidApplyTheme",t,e,i,this)}themeFsteners(t,i,s){const n=e.FastenerContext.getMetaclass(this);if(null===n)return;const r=n.slots;for(let e=0;e<r.length;e+=1){const n=this[r[e]];void 0!==n&&"applyTheme"in n&&n.applyTheme(t,i,s)}}modifyMood(t,i,s){if(!this.moodModifier.hasAffinity(e.Affinity.Intrinsic))return;const n=this.moodModifier.getValueOr(Gt.empty()),r=n.updatedCol(t,i,!0);r.equals(n)||(this.mood.timing=s,this.moodModifier.setIntrinsic(r))}modifyTheme(t,i,s){if(!this.themeModifier.hasAffinity(e.Affinity.Intrinsic))return;const n=this.themeModifier.getValueOr(Gt.empty());let r;if(t instanceof ne)r=n.updatedCol(t,i,!0);else{r=n;const e=t;s=i,i=void 0;for(let s=0;s<e.length;s+=1)[t,i]=e[s],r=void 0!==i?r.updatedCol(t,i,!0):r.col(t,void 0)}r.equals(n)||(this.theme.timing=s,this.themeModifier.setIntrinsic(r))}getTransition(t){return this.getLookOr(Jt.timing,null)}bindChildFastener(t,e,i){super.bindChildFastener(t,e,i),(t instanceof ce||t instanceof me)&&t.bindView(e,i)}unbindChildFastener(t,e){(t instanceof ce||t instanceof me)&&t.unbindView(e),super.unbindChildFastener(t,e)}enqueueFastener(i){super.enqueueFastener(i),i instanceof e.Animator?this.requireUpdate(t.NeedsAnimate):this.requireUpdate(t.NeedsChange)}recohereFasteners(t){const i=this.decoherent;if(null!==i&&0!==i.length){void 0===t&&(t=performance.now()),this.coherentTime=t,this.decoherent=null,this.recohering=i;try{for(let s=0;s<i.length;s+=1){const n=i[s];n instanceof e.Animator?this.enqueueFastener(n):n.recohere(t)}}finally{this.recohering=null}}}recohereAnimators(t){const i=this.decoherent;if(null===i||0===i.length)return;const s=performance.now();s-t>=De.MaxProcessInterval&&(t=s),this.coherentTime=t,this.decoherent=null,this.recohering=i;try{for(let s=0;s<i.length;s+=1){const n=i[s];n instanceof e.Animator?n.recohere(t):this.enqueueFastener(n)}}finally{this.recohering=null}}constraint(t,e,i,s){t=h.ConstraintExpression.fromLike(t);const n=void 0!==(i=h.ConstraintExpression.fromLike(i))?t.minus(i):t;s=void 0===s?h.ConstraintStrength.Required:h.ConstraintStrength.fromLike(s);const r=new h.Constraint(this,n,e,s);return this.addConstraint(r),r}hasConstraint(t){const e=this.constraints;return null!==e&&e.has(t)}addConstraint(t){let e=this.constraints;if(null===e)e=new Set,this.constraints=e;else if(e.has(t))return;e.add(t),this.activateConstraint(t)}removeConstraint(t){const e=this.constraints;null!==e&&e.has(t)&&(this.deactivateConstraint(t),e.delete(t))}activateConstraint(e){const i=this.solver.service;null!==i&&(i.activateConstraint(e),this.requireUpdate(t.NeedsLayout))}deactivateConstraint(e){const i=this.solver.service;null!==i&&(i.deactivateConstraint(e),this.requireUpdate(t.NeedsLayout))}constraintVariable(t,e,i){void 0===e&&(e=0),i=void 0!==i?h.ConstraintStrength.fromLike(i):h.ConstraintStrength.Strong;const s=h.ConstraintProperty.create(this);return Object.defineProperty(s,"name",{value:t,configurable:!0}),void 0!==e&&s.set(e),s.setStrength(i),s.mount(),s}hasConstraintVariable(t){const e=this.constraintVariables;return null!==e&&e.has(t)}addConstraintVariable(t){let e=this.constraintVariables;if(null===e)e=new Set,this.constraintVariables=e;else if(e.has(t))return;e.add(t),this.activateConstraintVariable(t)}removeConstraintVariable(t){const e=this.constraintVariables;null!==e&&e.has(t)&&(this.deactivateConstraintVariable(t),e.delete(t))}activateConstraintVariable(e){const i=this.solver.service;null!==i&&(i.activateConstraintVariable(e),this.requireUpdate(t.NeedsLayout))}deactivateConstraintVariable(e){const i=this.solver.service;null!==i&&(i.deactivateConstraintVariable(e),this.requireUpdate(t.NeedsLayout))}setConstraintVariable(t,i){const s=e.Provider.tryService(this,"solver");null!==s&&s.setConstraintVariable(t,i)}evaluateConstraintVariables(){const t=this.constraintVariables;if(null!==t)for(const e of t)e.evaluateConstraintVariable()}activateLayout(){const t=this.constraints;if(null===t)return;const e=this.solver.service;if(null!==e&&null!==t)for(const i of t)e.activateConstraint(i)}deactivateLayout(){const t=this.constraints;if(null===t)return;const e=this.solver.service;if(null!==e)for(const i of t)e.deactivateConstraint(i)}get layoutViewport(){return this.viewport.getService().layoutViewport.value}get visualViewport(){return this.viewport.getService().visualViewport.value}get viewIdiom(){return this.viewport.getService().viewIdiom.value}get edgeInsets(){return e.Property.getter()}get parentTransform(){return l.Transform.identity()}get pageTransform(){const t=this.parent;return null!==t?t.pageTransform.transform(this.parentTransform):l.Transform.identity()}get pageBounds(){const t=this.clientBounds,e=this.clientTransform;return t.transform(e)}get popoverFrame(){return this.pageBounds}get clientTransform(){let t;const e=window.pageXOffset,i=window.pageYOffset;t=0!==e||0!==i?l.Transform.translate(e,i):l.Transform.identity();const s=this.pageTransform;return t.transform(s)}get clientBounds(){return l.R2Box.undefined()}intersectsViewport(){const t=this.clientBounds,e=document.documentElement.clientWidth,i=document.documentElement.clientHeight;return(t.top<=0&&0<t.bottom||0<=t.top&&t.top<i)&&(t.left<=0&&0<t.right||0<=t.left&&t.left<e)}dispatchEvent(t){return!0}addEventListener(t,e,i){}removeEventListener(t,e,i){}onObserve(t){super.onObserve(t),void 0!==t.viewWillAttachParent&&(null===this.willAttachParentObservers&&(this.willAttachParentObservers=new Set),this.willAttachParentObservers.add(t)),void 0!==t.viewDidAttachParent&&(null===this.didAttachParentObservers&&(this.didAttachParentObservers=new Set),this.didAttachParentObservers.add(t)),void 0!==t.viewWillDetachParent&&(null===this.willDetachParentObservers&&(this.willDetachParentObservers=new Set),this.willDetachParentObservers.add(t)),void 0!==t.viewDidDetachParent&&(null===this.didDetachParentObservers&&(this.didDetachParentObservers=new Set),this.didDetachParentObservers.add(t)),void 0!==t.viewWillInsertChild&&(null===this.willInsertChildObservers&&(this.willInsertChildObservers=new Set),this.willInsertChildObservers.add(t)),void 0!==t.viewDidInsertChild&&(null===this.didInsertChildObservers&&(this.didInsertChildObservers=new Set),this.didInsertChildObservers.add(t)),void 0!==t.viewWillRemoveChild&&(null===this.willRemoveChildObservers&&(this.willRemoveChildObservers=new Set),this.willRemoveChildObservers.add(t)),void 0!==t.viewDidRemoveChild&&(null===this.didRemoveChildObservers&&(this.didRemoveChildObservers=new Set),this.didRemoveChildObservers.add(t)),void 0!==t.viewWillMount&&(null===this.willMountObservers&&(this.willMountObservers=new Set),this.willMountObservers.add(t)),void 0!==t.viewDidMount&&(null===this.didMountObservers&&(this.didMountObservers=new Set),this.didMountObservers.add(t)),void 0!==t.viewWillUnmount&&(null===this.willUnmountObservers&&(this.willUnmountObservers=new Set),this.willUnmountObservers.add(t)),void 0!==t.viewDidUnmount&&(null===this.didUnmountObservers&&(this.didUnmountObservers=new Set),this.didUnmountObservers.add(t)),void 0!==t.viewWillResize&&(null===this.willResizeObservers&&(this.willResizeObservers=new Set),this.willResizeObservers.add(t)),void 0!==t.viewDidResize&&(null===this.didResizeObservers&&(this.didResizeObservers=new Set),this.didResizeObservers.add(t)),void 0!==t.viewWillScroll&&(null===this.willScrollObservers&&(this.willScrollObservers=new Set),this.willScrollObservers.add(t)),void 0!==t.viewDidScroll&&(null===this.didScrollObservers&&(this.didScrollObservers=new Set),this.didScrollObservers.add(t)),void 0!==t.viewWillChange&&(null===this.willChangeObservers&&(this.willChangeObservers=new Set),this.willChangeObservers.add(t)),void 0!==t.viewDidChange&&(null===this.didChangeObservers&&(this.didChangeObservers=new Set),this.didChangeObservers.add(t)),void 0!==t.viewWillAnimate&&(null===this.willAnimateObservers&&(this.willAnimateObservers=new Set),this.willAnimateObservers.add(t)),void 0!==t.viewDidAnimate&&(null===this.didAnimateObservers&&(this.didAnimateObservers=new Set),this.didAnimateObservers.add(t)),void 0!==t.viewWillProject&&(null===this.willProjectObservers&&(this.willProjectObservers=new Set),this.willProjectObservers.add(t)),void 0!==t.viewDidProject&&(null===this.didProjectObservers&&(this.didProjectObservers=new Set),this.didProjectObservers.add(t)),void 0!==t.viewWillLayout&&(null===this.willLayoutObservers&&(this.willLayoutObservers=new Set),this.willLayoutObservers.add(t)),void 0!==t.viewDidLayout&&(null===this.didLayoutObservers&&(this.didLayoutObservers=new Set),this.didLayoutObservers.add(t)),void 0!==t.viewWillRender&&(null===this.willRenderObservers&&(this.willRenderObservers=new Set),this.willRenderObservers.add(t)),void 0!==t.viewDidRender&&(null===this.didRenderObservers&&(this.didRenderObservers=new Set),this.didRenderObservers.add(t)),void 0!==t.viewWillRasterize&&(null===this.willRasterizeObservers&&(this.willRasterizeObservers=new Set),this.willRasterizeObservers.add(t)),void 0!==t.viewDidRasterize&&(null===this.didRasterizeObservers&&(this.didRasterizeObservers=new Set),this.didRasterizeObservers.add(t)),void 0!==t.viewWillComposite&&(null===this.willCompositeObservers&&(this.willCompositeObservers=new Set),this.willCompositeObservers.add(t)),void 0!==t.viewDidComposite&&(null===this.didCompositeObservers&&(this.didCompositeObservers=new Set),this.didCompositeObservers.add(t))}onUnobserve(t){super.onUnobserve(t),void 0!==t.viewWillAttachParent&&null!==this.willAttachParentObservers&&this.willAttachParentObservers.delete(t),void 0!==t.viewDidAttachParent&&null!==this.didAttachParentObservers&&this.didAttachParentObservers.delete(t),void 0!==t.viewWillDetachParent&&null!==this.willDetachParentObservers&&this.willDetachParentObservers.delete(t),void 0!==t.viewDidDetachParent&&null!==this.didDetachParentObservers&&this.didDetachParentObservers.delete(t),void 0!==t.viewWillInsertChild&&null!==this.willInsertChildObservers&&this.willInsertChildObservers.delete(t),void 0!==t.viewDidInsertChild&&null!==this.didInsertChildObservers&&this.didInsertChildObservers.delete(t),void 0!==t.viewWillRemoveChild&&null!==this.willRemoveChildObservers&&this.willRemoveChildObservers.delete(t),void 0!==t.viewDidRemoveChild&&null!==this.didRemoveChildObservers&&this.didRemoveChildObservers.delete(t),void 0!==t.viewWillMount&&null!==this.willMountObservers&&this.willMountObservers.delete(t),void 0!==t.viewDidMount&&null!==this.didMountObservers&&this.didMountObservers.delete(t),void 0!==t.viewWillUnmount&&null!==this.willUnmountObservers&&this.willUnmountObservers.delete(t),void 0!==t.viewDidUnmount&&null!==this.didUnmountObservers&&this.didUnmountObservers.delete(t),void 0!==t.viewWillResize&&null!==this.willResizeObservers&&this.willResizeObservers.delete(t),void 0!==t.viewDidResize&&null!==this.didResizeObservers&&this.didResizeObservers.delete(t),void 0!==t.viewWillScroll&&null!==this.willScrollObservers&&this.willScrollObservers.delete(t),void 0!==t.viewDidScroll&&null!==this.didScrollObservers&&this.didScrollObservers.delete(t),void 0!==t.viewWillChange&&null!==this.willChangeObservers&&this.willChangeObservers.delete(t),void 0!==t.viewDidChange&&null!==this.didChangeObservers&&this.didChangeObservers.delete(t),void 0!==t.viewWillAnimate&&null!==this.willAnimateObservers&&this.willAnimateObservers.delete(t),void 0!==t.viewDidAnimate&&null!==this.didAnimateObservers&&this.didAnimateObservers.delete(t),void 0!==t.viewWillProject&&null!==this.willProjectObservers&&this.willProjectObservers.delete(t),void 0!==t.viewDidProject&&null!==this.didProjectObservers&&this.didProjectObservers.delete(t),void 0!==t.viewWillLayout&&null!==this.willLayoutObservers&&this.willLayoutObservers.delete(t),void 0!==t.viewDidLayout&&null!==this.didLayoutObservers&&this.didLayoutObservers.delete(t),void 0!==t.viewWillRender&&null!==this.willRenderObservers&&this.willRenderObservers.delete(t),void 0!==t.viewDidRender&&null!==this.didRenderObservers&&this.didRenderObservers.delete(t),void 0!==t.viewWillRasterize&&null!==this.willRasterizeObservers&&this.willRasterizeObservers.delete(t),void 0!==t.viewDidRasterize&&null!==this.didRasterizeObservers&&this.didRasterizeObservers.delete(t),void 0!==t.viewWillComposite&&null!==this.willCompositeObservers&&this.willCompositeObservers.delete(t),void 0!==t.viewDidComposite&&null!==this.didCompositeObservers&&this.didCompositeObservers.delete(t)}},(()=>{var r;const l="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(r=m[Symbol.metadata])&&void 0!==r?r:null):void 0;i=[e.Provider({get serviceType(){return Oe}})],s=[e.Provider({get serviceType(){return De},mountRootService(t){super.mountRootService(t),t.roots.addView(this.owner)},unmountRootService(t){super.unmountRootService(t),t.roots.removeView(this.owner)}})],n=[e.Provider({get serviceType(){return Ee}})],o=[e.Provider({get serviceType(){return Ue},mountRootService(t){super.mountRootService(t),t.roots.addView(this.owner)},unmountRootService(t){super.unmountRootService(t),t.roots.removeView(this.owner)}})],a=[e.Property({valueType:Bt,value:null,affinity:e.Affinity.Inherited,inherits:!0,init(){this.timing=void 0},deriveValue(t){if(null!==t){const i=this.owner.moodModifier,s=i instanceof e.Property?i.value:null;null!==s&&(t=s.timesCol(t,!0))}return t},didSetValue(t){const e=this.owner.theme.value;null!==e&&null!==t&&(this.owner.applyTheme(e,t,this.timing),this.timing=void 0)}})],c=[e.Property({valueType:Yt,value:null,affinity:e.Affinity.Inherited,inherits:!0,init(){this.timing=void 0},deriveValue(t){if(null!==t){const i=this.owner.themeModifier,s=i instanceof e.Property?i.value:null;null!==s&&(t=t.transform(s,!0))}return t},didSetValue(t){const e=this.owner.mood.value;null!==t&&null!==e&&(this.owner.applyTheme(t,e,this.timing),this.timing=void 0)}})],f=[e.Property({valueType:Gt,value:null,didSetValue(t){if(null===t||!this.owner.mood.hasAffinity(e.Affinity.Inherited))return;let i=this.owner.mood.inletValue;if(null==i){const t=this.owner.styler.service;null!=t&&(i=t.mood.value)}if(null!=i){const s=t.timesCol(i,!0);this.owner.mood.setValue(s,e.Affinity.Reflexive)}}})],p=[e.Property({valueType:Gt,value:null,didSetValue(t){if(null===t||!this.owner.theme.hasAffinity(e.Affinity.Inherited))return;let i=this.owner.theme.inletValue;if(null==i){const t=this.owner.styler.service;null!=t&&(i=t.theme.value)}if(null!=i){const s=i.transform(t,!0);this.owner.theme.setValue(s,e.Affinity.Reflexive)}}})],g=[e.Property({valueType:de,value:de.zero(),inherits:!0,get updateFlags(){return ue.NeedsResize|ue.NeedsScroll|ue.NeedsLayout},equalValues:de.equal})],d(t,null,i,{kind:"getter",name:"viewport",static:!1,private:!1,access:{has:t=>"viewport"in t,get:t=>t.viewport},metadata:l},null,v),d(t,null,n,{kind:"getter",name:"solver",static:!1,private:!1,access:{has:t=>"solver"in t,get:t=>t.solver},metadata:l},null,v),d(t,null,g,{kind:"getter",name:"edgeInsets",static:!1,private:!1,access:{has:t=>"edgeInsets"in t,get:t=>t.edgeInsets},metadata:l},null,v),d(null,null,s,{kind:"field",name:"updater",static:!1,private:!1,access:{has:t=>"updater"in t,get:t=>t.updater,set:(t,e)=>{t.updater=e}},metadata:l},w,v),d(null,null,o,{kind:"field",name:"styler",static:!1,private:!1,access:{has:t=>"styler"in t,get:t=>t.styler,set:(t,e)=>{t.styler=e}},metadata:l},y,v),d(null,null,a,{kind:"field",name:"mood",static:!1,private:!1,access:{has:t=>"mood"in t,get:t=>t.mood,set:(t,e)=>{t.mood=e}},metadata:l},b,v),d(null,null,c,{kind:"field",name:"theme",static:!1,private:!1,access:{has:t=>"theme"in t,get:t=>t.theme,set:(t,e)=>{t.theme=e}},metadata:l},C,v),d(null,null,f,{kind:"field",name:"moodModifier",static:!1,private:!1,access:{has:t=>"moodModifier"in t,get:t=>t.moodModifier,set:(t,e)=>{t.moodModifier=e}},metadata:l},T,v),d(null,null,p,{kind:"field",name:"themeModifier",static:!1,private:!1,access:{has:t=>"themeModifier"in t,get:t=>t.themeModifier,set:(t,e)=>{t.themeModifier=e}},metadata:l},S,v),l&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})})(),t.uid=function(){let t=1;return function(){const e=~~t;return t+=1,"view"+e}}(),t.MountedFlag=e.Component.MountedFlag,t.InsertingFlag=e.Component.InsertingFlag,t.RemovingFlag=e.Component.RemovingFlag,t.ProcessingFlag=1<<e.Component.FlagShift+0,t.DisplayingFlag=1<<e.Component.FlagShift+1,t.CullFlag=1<<e.Component.FlagShift+2,t.CulledFlag=1<<e.Component.FlagShift+3,t.HideFlag=1<<e.Component.FlagShift+4,t.HiddenFlag=1<<e.Component.FlagShift+5,t.UnboundedFlag=1<<e.Component.FlagShift+6,t.IntangibleFlag=1<<e.Component.FlagShift+7,t.CulledMask=t.CullFlag|t.CulledFlag,t.HiddenMask=t.HideFlag|t.HiddenFlag,t.UpdatingMask=t.ProcessingFlag|t.DisplayingFlag,t.StatusMask=t.MountedFlag|t.InsertingFlag|t.RemovingFlag|t.ProcessingFlag|t.DisplayingFlag|t.CullFlag|t.CulledFlag|t.HiddenFlag|t.UnboundedFlag|t.IntangibleFlag,t.NeedsProcess=1<<e.Component.FlagShift+8,t.NeedsResize=1<<e.Component.FlagShift+9,t.NeedsScroll=1<<e.Component.FlagShift+10,t.NeedsChange=1<<e.Component.FlagShift+11,t.NeedsAnimate=1<<e.Component.FlagShift+12,t.NeedsProject=1<<e.Component.FlagShift+13,t.ProcessMask=t.NeedsProcess|t.NeedsResize|t.NeedsScroll|t.NeedsChange|t.NeedsAnimate|t.NeedsProject,t.NeedsDisplay=1<<e.Component.FlagShift+14,t.NeedsLayout=1<<e.Component.FlagShift+15,t.NeedsRender=1<<e.Component.FlagShift+16,t.NeedsRasterize=1<<e.Component.FlagShift+17,t.NeedsComposite=1<<e.Component.FlagShift+18,t.DisplayMask=t.NeedsDisplay|t.NeedsLayout|t.NeedsRender|t.NeedsRasterize|t.NeedsComposite,t.UpdateMask=t.ProcessMask|t.DisplayMask,t.FlagShift=e.Component.FlagShift+19,t.FlagMask=(1<<t.FlagShift)-1,t.MountFlags=e.Component.MountFlags|t.NeedsResize|t.NeedsChange|t.NeedsLayout,t.UncullFlags=t.NeedsResize|t.NeedsChange|t.NeedsLayout,t.UnhideFlags=t.NeedsLayout,t.InsertChildFlags=e.Component.InsertChildFlags|t.NeedsLayout,t.RemoveChildFlags=e.Component.RemoveChildFlags|t.NeedsLayout,t.ReinsertChildFlags=e.Component.InsertChildFlags|t.NeedsLayout,t})();const ce=e.Fastener.extend("ViewRelation",{get fastenerType(){return ce},viewType:null,observes:!1,attachOutlet(t){let e=this.outlets;null===e&&(e=new Set,this.outlets=e),e.add(t)},detachOutlet(t){const e=this.outlets;null!==e&&e.delete(t)},decohereOutlets(){const t=this.outlets;if(null!==t)for(const e of t)e.decohere(this)},initView(t){},willAttachView(t,e){},onAttachView(t,e){this.observes&&t.observe(this)},didAttachView(t,e){},deinitView(t){},willDetachView(t){},onDetachView(t){this.observes&&t.unobserve(this)},didDetachView(t){},get parentView(){const t=this.owner;return t instanceof ue?t:null},insertChild(t,e,i,s){t.insertChild(e,i,s)},bindView(t,e){},unbindView(t){},detectView:t=>null,createView(){let t;const e=this.viewType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="view",new Error(t)}return t},fromLike(t){const e=this.viewType;return null!==e?e.fromLike(t):ue.fromLike(t)}},{construct(t,e){return(t=super.construct(t,e)).outlets=null,t}}),fe=ce.extend("ViewRef",{get fastenerType(){return fe},get inletView(){const t=this.inlet;return t instanceof fe?t.view:null},getInletView(){const t=this.inletView;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="inlet view",new TypeError(e)}return t},get(){return this.view},set(t){return t instanceof e.Fastener?this.bindInlet(t):this.setView(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):this.setView(t),this.owner},viewKey:void 0,getView(){const t=this.view;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="view",new TypeError(e)}return t},setView(t,e,i){null!==t&&(t=this.fromLike(t));let s,n=this.view;return n===t?(this.setCoherent(!0),n):(void 0===e&&(e=null),this.binds&&(s=this.parentView,null!==s)&&(null!==n&&n.parent===s&&(null===e&&(e=n.nextSibling),n.remove()),null!==t&&(void 0===i&&(i=this.viewKey),this.insertChild(s,t,e,i)),n=this.view,n===t)||(null!==n&&(this.deactivateLayout(),this.view=null,this.willDetachView(n),this.onDetachView(n),this.deinitView(n),this.didDetachView(n)),null!==t&&(this.view=t,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e)),this.setCoherent(!0),this.decohereOutlets()),n)},attachView(t,e){const i=this.view;return void 0===e&&(e=null),i===(t=null!=t?this.fromLike(t):null===i?this.createView():i)||(null!==i&&(this.deactivateLayout(),this.view=null,this.willDetachView(i),this.onDetachView(i),this.deinitView(i),this.didDetachView(i)),this.view=t,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e),this.setCoherent(!0),this.decohereOutlets()),t},detachView(){const t=this.view;return null===t?null:(this.deactivateLayout(),this.view=null,this.willDetachView(t),this.onDetachView(t),this.deinitView(t),this.didDetachView(t),this.setCoherent(!0),this.decohereOutlets(),t)},insertView(t,e,i,s){let n=this.view;return e=null!=e?this.fromLike(e):null===n?this.createView():n,void 0===t&&(t=null),this.binds||n!==e||null===e.parent||null!==t||void 0!==s?(null===t&&(t=this.parentView),void 0===i&&(i=null),void 0===s&&(s=this.viewKey),null===t||e.parent===t&&e.key===s||this.insertChild(t,e,i,s),n=this.view,n===e||(null!==n&&(this.deactivateLayout(),this.view=null,this.willDetachView(n),this.onDetachView(n),this.deinitView(n),this.didDetachView(n),this.binds&&null!==t&&n.parent===t&&n.remove()),this.view=e,this.willAttachView(e,i),this.onAttachView(e,i),this.initView(e),this.didAttachView(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},removeView(){const t=this.view;return null===t?null:(t.remove(),t)},deleteView(){const t=this.detachView();return null===t?null:(t.remove(),t)},bindView(t,e){if(!this.binds||null!==this.view)return;const i=this.detectView(t);null!==i&&(this.view=i,this.willAttachView(i,e),this.onAttachView(i,e),this.initView(i),this.didAttachView(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindView(t){if(!this.binds)return;const e=this.detectView(t);null!==e&&this.view===e&&(this.deactivateLayout(),this.view=null,this.willDetachView(e),this.onDetachView(e),this.deinitView(e),this.didDetachView(e),this.setCoherent(!0),this.decohereOutlets())},detectView(t){const e=this.viewKey;return void 0!==e&&e===t.key?t:null},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof fe?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setView(i.view)):this.setDerived(!1)},constraint(t,e,i,s){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");t=h.ConstraintExpression.fromLike(t);const n=void 0!==(i=h.ConstraintExpression.fromLike(i))?t.minus(i):t;s=void 0===s?h.ConstraintStrength.Required:h.ConstraintStrength.fromLike(s);const r=new h.Constraint(this.owner,n,e,s);return this.addConstraint(r),r},hasConstraint(t){const e=this.constraints;return null!==e&&e.has(t)},addConstraint(t){let e=this.constraints;if(null===e)e=new Set,this.constraints=e;else if(e.has(t))return;e.add(t),this.activateConstraint(t)},removeConstraint(t){const e=this.constraints;null!==e&&e.has(t)&&(this.deactivateConstraint(t),e.delete(t))},activateConstraint(t){if(!h.ConstraintContext[Symbol.hasInstance](this.owner))throw new Error("no constraint context");this.owner.activateConstraint(t)},deactivateConstraint(t){if(!h.ConstraintContext[Symbol.hasInstance](this.owner))throw new Error("no constraint context");this.owner.deactivateConstraint(t)},constraintVariable(t,e,i){void 0===e&&(e=0),i=void 0!==i?h.ConstraintStrength.fromLike(i):h.ConstraintStrength.Strong;const s=h.ConstraintProperty.create(this);return Object.defineProperty(s,"name",{value:t,enumerable:!0,configurable:!0}),void 0!==e&&s.set(e),s.setStrength(i),s.mount(),s},hasConstraintVariable(t){const e=this.constraintVariables;return null!==e&&e.has(t)},addConstraintVariable(t){let e=this.constraintVariables;if(null===e)e=new Set,this.constraintVariables=e;else if(e.has(t))return;e.add(t),this.activateConstraintVariable(t)},removeConstraintVariable(t){const e=this.constraintVariables;null!==e&&e.has(t)&&(this.deactivateConstraintVariable(t),e.delete(t))},activateConstraintVariable(t){if(!h.ConstraintContext[Symbol.hasInstance](this.owner))throw new Error("no constraint context");this.owner.activateConstraintVariable(t)},deactivateConstraintVariable(t){if(!h.ConstraintContext[Symbol.hasInstance](this.owner))throw new Error("no constraint context");this.owner.deactivateConstraintVariable(t)},setConstraintVariable(t,e){if(!h.ConstraintContext[Symbol.hasInstance](this.owner))throw new Error("no constraint context");this.owner.setConstraintVariable(t,e)},activateLayout(){if(!h.ConstraintContext[Symbol.hasInstance](this.owner))return;const t=this.constraintVariables;if(null!==t)for(const e of t)this.owner.activateConstraintVariable(e);const e=this.constraints;if(null!==e)for(const t of e)this.owner.activateConstraint(t)},deactivateLayout(){if(!h.ConstraintContext[Symbol.hasInstance](this.owner))return;const t=this.constraints;if(null!==t)for(const e of t)this.owner.deactivateConstraint(e);const e=this.constraintVariables;if(null!==e)for(const t of e)this.owner.deactivateConstraintVariable(t)},onMount(){super.onMount(),this.activateLayout()},onUnmount(){this.deactivateLayout(),super.onUnmount()}},{tryView(t,i){const s=e.FastenerContext.getMetaclass(t),n=null!==s?s.tryFastener(t,i):null;return n instanceof fe?n.view:null},construct(t,e){return(t=super.construct(t,e)).constraints=null,t.constraintVariables=null,t.view=null,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"viewKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"viewKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"viewKey",i)))}}),pe=ce.extend("ViewSet",{get fastenerType(){return pe},viewKey(t){},insertViewMap(t,e){const i=this.views;null!==e&&0!=(this.flags&pe.OrderedFlag)?this.views=r.Objects.inserted(i,t.uid,t,e):i[t.uid]=t},removeViewMap(t){delete this.views[t.uid]},hasView(t){return void 0!==this.views[t.uid]},addView(t,e,i){let s;return t=null!=t?this.fromLike(t):this.createView(),void 0===e&&(e=null),this.binds&&(s=this.parentView,null!==s)&&(null===e&&(e=t.parent===s?t.nextSibling:this.getTargetChild(s,t)),void 0===i&&(i=this.viewKey(t)),t.parent===s&&t.nextSibling===e&&t.key===i||this.insertChild(s,t,e,i)),void 0!==this.views[t.uid]||(this.insertViewMap(t,e),this.viewCount+=1,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e),this.setCoherent(!0),this.decohereOutlets()),t},addViews(t,e){for(const i in t)this.addView(t[i],e)},setViews(t,e){const i=this.binds,s=i?this.parentView:null,n=this.views;for(const e in n)if(void 0===t[e]){const t=this.detachView(n[e]);null!==t&&i&&null!==s&&t.parent===s&&t.remove()}if(0!=(this.flags&pe.OrderedFlag)){const i=new Array;for(const e in t)i.push(t[e]);for(let t=0,s=i.length;t<s;t+=1){const r=i[t];if(void 0===n[r.uid]){const n=t<s+1?i[t+1]:e;this.addView(r,n)}}}else for(const i in t)void 0===n[i]&&this.addView(t[i],e)},attachView(t,e){return t=null!=t?this.fromLike(t):this.createView(),void 0!==this.views[t.uid]||(void 0===e&&(e=null),this.insertViewMap(t,e),this.viewCount+=1,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e),this.setCoherent(!0),this.decohereOutlets()),t},attachViews(t,e){for(const i in t)this.attachView(t[i],e)},detachView(t){return void 0===this.views[t.uid]?null:(this.viewCount-=1,this.removeViewMap(t),this.willDetachView(t),this.onDetachView(t),this.deinitView(t),this.didDetachView(t),this.setCoherent(!0),this.decohereOutlets(),t)},detachViews(t){void 0===t&&(t=this.views);for(const e in t)this.detachView(t[e])},insertView(t,e,i,s){return e=null!=e?this.fromLike(e):this.createView(),void 0===t&&(t=null),this.binds||void 0===this.views[e.uid]||null===e.parent||null!==t||void 0!==s?(null===t&&(t=this.parentView),void 0===i&&(i=null),void 0===s&&(s=this.viewKey(e)),null===t||e.parent===t&&e.key===s||(null===i&&(i=this.getTargetChild(t,e)),this.insertChild(t,e,i,s)),void 0!==this.views[e.uid]||(this.insertViewMap(e,i),this.viewCount+=1,this.willAttachView(e,i),this.onAttachView(e,i),this.initView(e),this.didAttachView(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},insertViews(t,e,i){for(const s in e)this.insertView(t,e[s],i)},removeView(t){return this.hasView(t)?(t.remove(),t):null},removeViews(t){void 0===t&&(t=this.views);for(const e in t)this.removeView(t[e])},deleteView(t){const e=this.detachView(t);return null===e?null:(e.remove(),e)},deleteViews(t){void 0===t&&(t=this.views);for(const e in t)this.deleteView(t[e])},reinsertView(t,e){if(void 0===this.views[t.uid]||void 0===e&&0==(this.flags&pe.SortedFlag))return;const i=t.parent;null!==i&&(void 0===e&&(e=this.getTargetChild(i,t)),i.reinsertChild(t,e))},bindView(t,e){if(!this.binds)return;const i=this.detectView(t);null!==i&&void 0===this.views[i.uid]&&(this.insertViewMap(i,e),this.viewCount+=1,this.willAttachView(i,e),this.onAttachView(i,e),this.initView(i),this.didAttachView(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindView(t){if(!this.binds)return;const e=this.detectView(t);null!==e&&void 0!==this.views[e.uid]&&(this.viewCount-=1,this.removeViewMap(e),this.willDetachView(e),this.onDetachView(e),this.deinitView(e),this.didDetachView(e),this.setCoherent(!0),this.decohereOutlets())},detectView(t){return"function"==typeof this.viewType&&t instanceof this.viewType?t:null},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof pe?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setViews(i.views)):this.setDerived(!1)},get ordered(){return 0!=(this.flags&pe.OrderedFlag)},order(t){return void 0===t&&(t=!0),t?this.setFlags(this.flags|pe.OrderedFlag):this.setFlags(this.flags&~pe.OrderedFlag),this},get sorted(){return 0!=(this.flags&pe.SortedFlag)},sort(t){if(void 0===t&&(t=!0),t){const t=this.parentView;this.willSort(t),this.setFlags(this.flags|pe.SortedFlag),this.onSort(t),this.didSort(t)}else this.setFlags(this.flags&~pe.SortedFlag);return this},willSort(t){},onSort(t){null!==t&&this.sortChildren(t)},didSort(t){},sortChildren(t,e){t.sortChildren(this.compareChildren.bind(this))},getTargetChild(t,e){return 0!=(this.flags&pe.SortedFlag)?t.getTargetChild(e,this.compareTargetChild.bind(this)):null},compareChildren(t,e){const i=this.views,s=i[t.uid],n=i[e.uid];return void 0!==s&&void 0!==n?this.compare(s,n):void 0!==s?1:void 0!==n?-1:0},compareTargetChild(t,e){const i=this.views[e.uid];return void 0!==i?this.compare(t,i):void 0!==i?-1:0},compare:(t,e)=>t.uid<e.uid?-1:t.uid>e.uid?1:0},{construct(t,e){return(t=super.construct(t,e)).views={},t.viewCount=0,t},refine(t){super.refine(t);const e=t.prototype;let i=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"ordered")&&(e.ordered?i|=pe.OrderedFlag:i&=~pe.OrderedFlag,delete e.ordered),Object.prototype.hasOwnProperty.call(e,"sorted")&&(e.sorted?i|=pe.SortedFlag:i&=~pe.SortedFlag,delete e.sorted),Object.defineProperty(e,"flagsInit",{value:i,enumerable:!0,configurable:!0})},OrderedFlag:1<<ce.FlagShift+0,SortedFlag:1<<ce.FlagShift+1,FlagShift:ce.FlagShift+2,FlagMask:(1<<ce.FlagShift+2)-1});class ge{constructor(t,e,i,s,n,r){this.inputId=t,this.inputType=e,this.isPrimary=i,this.target=null,this.button=0,this.buttons=0,this.altKey=!1,this.ctrlKey=!1,this.metaKey=!1,this.shiftKey=!1,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.twist=0,this.pressure=0,this.tangentialPressure=0,this.x0=s,this.y0=n,this.t0=r,this.dx=0,this.dy=0,this.dt=0,this.x=s,this.y=n,this.t=r,this.detail=void 0,this.defaultPrevented=!1}preventDefault(){this.defaultPrevented=!0}static pointerInputType(t){return"mouse"===t||"touch"===t||"pen"===t?t:"unknown"}}const me=e.Fastener.extend("Gesture",{get fastenerType(){return me},bindsOwner:!1,observes:!0,viewKey:void 0,getView(){const t=this.view;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="view",new TypeError(e)}return t},setView(t){const e=this.view;return e===t||(null!==e&&(this.view=null,this.willDetachView(e),this.onDetachView(e),this.deinitView(e),this.didDetachView(e)),null!==t&&(this.view=t,this.willAttachView(t),this.onAttachView(t),this.initView(t),this.didAttachView(t))),e},initView(t){},willAttachView(t){},onAttachView(t){0!=(this.flags&e.Fastener.MountedFlag)&&(this.attachEvents(t),this.observes&&t.observe(this))},didAttachView(t){},deinitView(t){},willDetachView(t){},onDetachView(t){this.clearInputs(),0!=(this.flags&e.Fastener.MountedFlag)&&(this.observes&&t.unobserve(this),this.detachEvents(t))},didDetachView(t){},attachEvents(t){},detachEvents(t){},getInput(t){"number"==typeof t&&(t=""+t);const e=this.inputs[t];return void 0!==e?e:null},createInput:(t,e,i,s,n,r)=>new ge(t,e,i,s,n,r),getOrCreateInput(t,e,i,s,n,r){"number"==typeof t&&(t=""+t);const o=this.inputs;let l=o[t];return void 0===l&&(l=this.createInput(t,e,i,s,n,r),o[t]=l,this.inputCount+=1),l},clearInput(t){delete this.inputs[t.inputId],this.inputCount-=1},clearInputs(){this.inputs={},this.inputCount=0},resetInput(t){this.clearInput(t)},resetInputs(){const t=this.inputs;for(const e in t){const i=t[e];this.resetInput(i)}},bindView(t){if(!this.binds||null!==this.view)return;const e=this.detectView(t);null!==e&&this.setView(e)},unbindView(t){this.binds&&this.view===t&&this.setView(null)},detectView(t){return void 0!==this.viewKey&&this.viewKey===t.key?t:null},viewWillUnmount(t){this.clearInputs()},onMount(){super.onMount();const t=this.view;null!==t&&(this.attachEvents(t),this.observes&&t.observe(this))},onUnmount(){super.onUnmount(),this.clearInputs();const t=this.view;null!==t&&(this.observes&&t.unobserve(this),this.detachEvents(t))}},{create(t){const e=super.create(t);return null===e.view&&!0===e.bindsOwner&&t instanceof ue&&e.setView(t),e},construct(t,e){return(t=super.construct(t,e)).view=null,t.inputs={},t.inputCount=0,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"viewKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"viewKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"viewKey",i)))}});class ve extends ge{constructor(t,e,i,s,n,r){super(t,e,i,s,n,r),this.hovering=!1,this.pressing=!1,this.holdTimer=0,this.holdDelay=400}isRunaway(){const t=this.x-this.x0,e=this.y-this.y0,i=this.t-this.t0;return"mouse"!==this.inputType&&i<100&&t*t+e*e>100}setHoldTimer(t){0!==this.holdDelay&&(this.clearHoldTimer(),this.holdTimer=setTimeout(t,this.holdDelay))}clearHoldTimer(){0!==this.holdTimer&&(clearTimeout(this.holdTimer),this.holdTimer=0)}}const we=me.extend("PositionGesture",{attachEvents(t){super.attachEvents(t),this.attachHoverEvents(t)},detachEvents(t){this.detachPressEvents(t),this.detachHoverEvents(t),super.detachEvents(t)},attachHoverEvents(t){},detachHoverEvents(t){},attachPressEvents(t){},detachPressEvents(t){},createInput:(t,e,i,s,n,r)=>new ve(t,e,i,s,n,r),clearInput(t){t.hovering||t.pressing||super.clearInput(t)},clearInputs(){super.clearInputs(),this.hoverCount=0,this.pressCount=0},resetInput(t){t.pressing&&this.cancelPress(t,null),t.hovering&&this.endHover(t,null),super.resetInput(t)},get hovering(){return 0!==this.hoverCount},startHovering(){this.willStartHovering(),this.onStartHovering(),this.didStartHovering()},willStartHovering(){},onStartHovering(){},didStartHovering(){},stopHovering(){this.willStopHovering(),this.onStopHovering(),this.didStopHovering()},willStopHovering(){},onStopHovering(){},didStopHovering(){},beginHover(t,e){t.hovering||(this.willBeginHover(t,e),t.hovering=!0,this.hoverCount+=1,this.onBeginHover(t,e),this.didBeginHover(t,e),1===this.hoverCount&&this.startHovering())},willBeginHover(t,e){},onBeginHover(t,e){},didBeginHover(t,e){},endHover(t,e){t.hovering&&(this.willEndHover(t,e),t.hovering=!1,this.hoverCount-=1,this.onEndHover(t,e),this.didEndHover(t,e),0===this.hoverCount&&this.stopHovering(),this.clearInput(t))},willEndHover(t,e){},onEndHover(t,e){},didEndHover(t,e){},get pressing(){return 0!==this.pressCount},startPressing(){this.willStartPressing(),this.onStartPressing(),this.didStartPressing()},willStartPressing(){},onStartPressing(){this.attachPressEvents(this.view)},didStartPressing(){},stopPressing(){this.willStopPressing(),this.onStopPressing(),this.didStopPressing()},willStopPressing(){},onStopPressing(){this.detachPressEvents(this.view)},didStopPressing(){},beginPress(t,e){if(t.pressing)return;let i=this.willBeginPress(t,e);void 0===i&&(i=!0),i&&(t.pressing=!0,t.defaultPrevented=!1,this.pressCount+=1,this.onBeginPress(t,e),t.setHoldTimer(this.longPress.bind(this,t)),this.didBeginPress(t,e),1===this.pressCount&&this.startPressing())},willBeginPress(t,e){},onBeginPress(t,e){t.x0=t.x,t.y0=t.y,t.t0=t.t,t.dx=0,t.dy=0,t.dt=0},didBeginPress(t,e){},movePress(t,e){t.pressing&&(this.willMovePress(t,e),this.onMovePress(t,e),this.didMovePress(t,e))},willMovePress(t,e){},onMovePress(t,e){},didMovePress(t,e){},endPress(t,e){t.clearHoldTimer(),t.pressing&&(this.willEndPress(t,e),t.pressing=!1,this.pressCount-=1,this.onEndPress(t,e),this.didEndPress(t,e),0===this.pressCount&&this.stopPressing(),this.clearInput(t))},willEndPress(t,e){},onEndPress(t,e){},didEndPress(t,e){},cancelPress(t,e){t.clearHoldTimer(),t.pressing&&(this.willCancelPress(t,e),t.pressing=!1,this.pressCount-=1,this.onCancelPress(t,e),this.didCancelPress(t,e),0===this.pressCount&&this.stopPressing(),this.clearInput(t))},willCancelPress(t,e){},onCancelPress(t,e){},didCancelPress(t,e){},press(t,e){this.willPress(t,e),this.onPress(t,e),this.didPress(t,e)},willPress(t,e){},onPress(t,e){},didPress(t,e){},longPress(t){t.clearHoldTimer(),performance.now()-t.t0>=1.5*t.holdDelay||!t.pressing||(this.willLongPress(t),this.onLongPress(t),this.didLongPress(t))},willLongPress(t){},onLongPress(t){const e=performance.now();t.dt=e-t.t,t.t=e},didLongPress(t){}},{construct(t,e){return(t=super.construct(t,e)).hoverCount=0,t.pressCount=0,t},specialize(t){let e=t.extends;if(null==e){const i=t.method;e="pointer"===i?ye:"touch"===i?be:"mouse"===i?Ce:"undefined"!=typeof PointerEvent?ye:"undefined"!=typeof TouchEvent?be:Ce}return e}}),ye=we.extend("PointerPositionGesture",{attachHoverEvents(t){t.addEventListener("pointerenter",this.onPointerEnter),t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerdown",this.onPointerDown)},detachHoverEvents(t){t.removeEventListener("pointerenter",this.onPointerEnter),t.removeEventListener("pointerleave",this.onPointerLeave),t.removeEventListener("pointerdown",this.onPointerDown)},attachPressEvents(t){document.body.addEventListener("pointermove",this.onPointerMove),document.body.addEventListener("pointerup",this.onPointerUp),document.body.addEventListener("pointercancel",this.onPointerCancel),document.body.addEventListener("pointerleave",this.onPointerLeaveDocument)},detachPressEvents(t){document.body.removeEventListener("pointermove",this.onPointerMove),document.body.removeEventListener("pointerup",this.onPointerUp),document.body.removeEventListener("pointercancel",this.onPointerCancel),document.body.removeEventListener("pointerleave",this.onPointerLeaveDocument)},updateInput(t,e){t.target=e.target,t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=e.clientX-t.x,t.dy=e.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=e.clientX,t.y=e.clientY,t.t=e.timeStamp,t.width=e.width,t.height=e.height,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure},onPointerEnter(t){if("mouse"!==t.pointerType||0!==t.buttons)return;const e=this.getOrCreateInput(t.pointerId,ge.pointerInputType(t.pointerType),t.isPrimary,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.hovering||this.beginHover(e,t)},onPointerLeave(t){if("mouse"!==t.pointerType)return;const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.endHover(e,t))},onPointerDown(t){const e=this.getOrCreateInput(t.pointerId,ge.pointerInputType(t.pointerType),t.isPrimary,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.pressing||this.beginPress(e,t),"mouse"===t.pointerType&&0!==t.button&&this.cancelPress(e,t)},onPointerMove(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.movePress(e,t))},onPointerUp(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.endPress(e,t),e.defaultPrevented||0!==t.button||this.press(e,t))},onPointerCancel(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.cancelPress(e,t))},onPointerLeaveDocument(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.cancelPress(e,t),this.endHover(e,t))}},{construct(t,e){return(t=super.construct(t,e)).onPointerEnter=t.onPointerEnter.bind(t),t.onPointerLeave=t.onPointerLeave.bind(t),t.onPointerDown=t.onPointerDown.bind(t),t.onPointerMove=t.onPointerMove.bind(t),t.onPointerUp=t.onPointerUp.bind(t),t.onPointerCancel=t.onPointerCancel.bind(t),t.onPointerLeaveDocument=t.onPointerLeaveDocument.bind(t),t}}),be=we.extend("TouchPositionGesture",{attachHoverEvents(t){t.addEventListener("touchstart",this.onTouchStart)},detachHoverEvents(t){t.removeEventListener("touchstart",this.onTouchStart)},attachPressEvents(t){t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("touchcancel",this.onTouchCancel)},detachPressEvents(t){t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel)},updateInput(t,e,i){t.target=i.target,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=i.clientX-t.x,t.dy=i.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=i.clientX,t.y=i.clientY,t.t=e.timeStamp},onTouchStart(t){const e=t.targetTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getOrCreateInput(s.identifier,"touch",!1,s.clientX,s.clientY,t.timeStamp);this.updateInput(n,t,s),n.pressing||this.beginPress(n,t)}},onTouchMove(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.movePress(n,t))}},onTouchEnd(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.endPress(n,t),n.defaultPrevented||this.press(n,t),this.endHover(n,t))}},onTouchCancel(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.cancelPress(n,t),this.endHover(n,t))}}},{construct(t,e){return(t=super.construct(t,e)).onTouchStart=t.onTouchStart.bind(t),t.onTouchMove=t.onTouchMove.bind(t),t.onTouchEnd=t.onTouchEnd.bind(t),t.onTouchCancel=t.onTouchCancel.bind(t),t}}),Ce=we.extend("MousePositionGesture",{attachHoverEvents(t){t.addEventListener("mouseenter",this.onMouseEnter),t.addEventListener("mouseleave",this.onMouseLeave),t.addEventListener("mousedown",this.onMouseDown)},detachHoverEvents(t){t.removeEventListener("mouseenter",this.onMouseEnter),t.removeEventListener("mouseleave",this.onMouseLeave),t.removeEventListener("mousedown",this.onMouseDown)},attachPressEvents(t){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp),document.body.addEventListener("mouseleave",this.onMouseLeaveDocument)},detachPressEvents(t){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp),document.body.removeEventListener("mouseleave",this.onMouseLeaveDocument)},updateInput(t,e){t.target=e.target,t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=e.clientX-t.x,t.dy=e.clientY-t.y,t.dt=e.timeStamp-t.y,t.x=e.clientX,t.y=e.clientY,t.t=e.timeStamp},onMouseEnter(t){if(0!==t.buttons)return;const e=this.getOrCreateInput("mouse","mouse",!0,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.hovering||this.beginHover(e,t)},onMouseLeave(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.endHover(e,t))},onMouseDown(t){const e=this.getOrCreateInput("mouse","mouse",!0,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.pressing||this.beginPress(e,t),0!==t.button&&this.cancelPress(e,t)},onMouseMove(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.movePress(e,t))},onMouseUp(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.endPress(e,t),e.defaultPrevented||0!==t.button||this.press(e,t))},onMouseLeaveDocument(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.cancelPress(e,t),this.endHover(e,t))}},{construct(t,e){return(t=super.construct(t,e)).onMouseEnter=t.onMouseEnter.bind(t),t.onMouseLeave=t.onMouseLeave.bind(t),t.onMouseDown=t.onMouseDown.bind(t),t.onMouseMove=t.onMouseMove.bind(t),t.onMouseUp=t.onMouseUp.bind(t),t.onMouseLeaveDocument=t.onMouseLeaveDocument.bind(t),t}});class Te extends ve{constructor(t,e,i,s,n,r){super(t,e,i,s,n,r),this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.path=[],this.coasting=!1}updatePosition(t){const e=this.path,i=this.x,s=this.y,n=this.t;for(e.push({x:i,y:s,t:n});e.length>1&&n-e[0].t>t;)e.shift()}deriveVelocity(t){const e=this.path[0],i=this.path[this.path.length-1];if(void 0!==i&&i!==e){const s=i.t-e.t;let n,r;if(0!==s){n=(i.x-e.x)/s,r=(i.y-e.y)/s;const o=n*n+r*r;if(t*t<o){const e=Math.sqrt(o);n=n*t/e,r=r*t/e}}else n=0,r=0;this.vx=n,this.vy=r}else void 0!==e&&(this.vx=0,this.vy=0)}integrateVelocity(t){const e=t-this.t;if(0===e)return;let i,s=this.vx+this.ax*e;s<0==this.vx<0?i=this.x+this.vx*e+this.ax*e*e*.5:(i=this.x-this.vx*this.vx/(2*this.ax),s=0,this.ax=0);let n,r=this.vy+this.ay*e;r<0==this.vy<0?n=this.y+this.vy*e+this.ay*e*e*.5:(n=this.y-this.vy*this.vy/(2*this.ay),r=0,this.ay=0),this.dx=i-this.x,this.dy=n-this.y,this.dt=e,this.x=i,this.y=n,this.t=t,this.vx=s,this.vy=r}}const Se=we.extend("MomentumGesture",{createInput:(t,e,i,s,n,r)=>new Te(t,e,i,s,n,r),clearInput(t){t.coasting||super.clearInput(t)},clearInputs(){super.clearInputs(),this.coastCount=0},resetInput(t){t.coasting&&this.endCoast(t,null),super.resetInput(t)},hysteresis:67,initHysteresis(){return Object.getPrototypeOf(this).hysteresis},acceleration:.00175,initAcceleration(){return Object.getPrototypeOf(this).acceleration},velocityMax:1.75,initVelocityMax(){return Object.getPrototypeOf(this).velocityMax},viewWillAnimate(t){this.doCoast(t.updateTime)},interrupt(t){const e=this.inputs;for(const i in e){const s=e[i];this.endCoast(s,t)}},cancel(t){const e=this.inputs;for(const i in e){const s=e[i];this.endPress(s,t),this.endCoast(s,t)}},startInteracting(){this.willStartInteracting(),this.onStartInteracting(),this.didStartInteracting()},willStartInteracting(){},onStartInteracting(){},didStartInteracting(){},stopInteracting(){this.willStopInteracting(),this.onStopInteracting(),this.didStopInteracting()},willStopInteracting(){},onStopInteracting(){},didStopInteracting(){},onStartPressing(){super.onStartPressing(),0===this.coastCount&&this.startInteracting()},onStopPressing(){super.onStopPressing(),0===this.coastCount&&this.stopInteracting()},beginPress(t,e){super.beginPress(t,e),this.interrupt(e)},onBeginPress(t,e){super.onBeginPress(t,e),t.updatePosition(this.hysteresis),t.deriveVelocity(this.velocityMax)},onMovePress(t,e){super.onMovePress(t,e),t.updatePosition(this.hysteresis),t.deriveVelocity(this.velocityMax)},willEndPress(t,e){super.willEndPress(t,e),this.beginCoast(t,e)},onEndPress(t,e){super.onEndPress(t,e),t.updatePosition(this.hysteresis),t.deriveVelocity(this.velocityMax)},onCancelPress(t,e){super.onCancelPress(t,e),t.updatePosition(this.hysteresis),t.deriveVelocity(this.velocityMax)},get coasting(){return 0!==this.coastCount},startCoasting(){this.willStartCoasting(),this.onStartCoasting(),this.didStartCoasting()},willStartCoasting(){},onStartCoasting(){0===this.pressCount&&this.startInteracting(),null!==this.view&&this.view.requireUpdate(ue.NeedsAnimate)},didStartCoasting(){},stopCoasting(){this.willStopCoasting(),this.onStopCoasting(),this.didStopCoasting()},willStopCoasting(){},onStopCoasting(){0===this.pressCount&&this.stopInteracting()},didStopCoasting(){},beginCoast(t,e){if(t.coasting||0===t.vx&&0===t.vy)return;const i=Math.atan2(Math.abs(t.vy),Math.abs(t.vx)),s=this.acceleration,n=(t.vx<0?s:t.vx>0?-s:0)*Math.cos(i),r=(t.vy<0?s:t.vy>0?-s:0)*Math.sin(i);if(0===n&&0===r)return;t.ax=n,t.ay=r;let o=this.willBeginCoast(t,e);void 0===o&&(o=!0),o&&(t.coasting=!0,this.coastCount+=1,this.onBeginCoast(t,e),this.didBeginCoast(t,e),1===this.coastCount&&this.startCoasting())},willBeginCoast(t,e){},onBeginCoast(t,e){t.x0=t.x,t.y0=t.y,t.t0=t.t,t.dx=0,t.dy=0,t.dt=0},didBeginCoast(t,e){},endCoast(t,e){t.coasting&&(this.willEndCoast(t,e),t.coasting=!1,this.coastCount-=1,this.onEndCoast(t,e),this.didEndCoast(t,e),0===this.coastCount&&this.stopCoasting(),this.clearInput(t))},willEndCoast(t,e){},onEndCoast(t,e){},didEndCoast(t,e){},doCoast(t){if(0===this.coastCount)return;this.willCoast(),this.integrate(t),this.onCoast();const e=this.inputs;for(const t in e){const i=e[t];i.coasting&&0===i.ax&&0===i.ay&&this.endCoast(i,null)}this.didCoast(),0!==this.coastCount&&null!==this.view&&this.view.requireUpdate(ue.NeedsAnimate)},willCoast(){},onCoast(){},didCoast(){},integrate(t){const e=this.inputs;for(const i in e){const s=e[i];s.coasting&&s.integrateVelocity(t)}}},{construct(t,e){return(t=super.construct(t,e)).coastCount=0,t.hysteresis=t.initHysteresis(),t.acceleration=t.initAcceleration(),t.velocityMax=t.initVelocityMax(),t},specialize(t){let e=t.extends;if(null==e){const i=t.method;e="pointer"===i?xe:"touch"===i?Me:"mouse"===i?Ae:"undefined"!=typeof PointerEvent?xe:"undefined"!=typeof TouchEvent?Me:Ae}return e}}),xe=Se.extend("PointerMomentumGesture",{attachHoverEvents(t){t.addEventListener("pointerenter",this.onPointerEnter),t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerdown",this.onPointerDown)},detachHoverEvents(t){t.removeEventListener("pointerenter",this.onPointerEnter),t.removeEventListener("pointerleave",this.onPointerLeave),t.removeEventListener("pointerdown",this.onPointerDown)},attachPressEvents(t){document.body.addEventListener("pointermove",this.onPointerMove),document.body.addEventListener("pointerup",this.onPointerUp),document.body.addEventListener("pointercancel",this.onPointerCancel),document.body.addEventListener("pointerleave",this.onPointerLeaveDocument)},detachPressEvents(t){document.body.removeEventListener("pointermove",this.onPointerMove),document.body.removeEventListener("pointerup",this.onPointerUp),document.body.removeEventListener("pointercancel",this.onPointerCancel),document.body.removeEventListener("pointerleave",this.onPointerLeaveDocument)},updateInput(t,e){t.target=e.target,t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=e.clientX-t.x,t.dy=e.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=e.clientX,t.y=e.clientY,t.t=e.timeStamp,t.width=e.width,t.height=e.height,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure},onPointerEnter(t){if("mouse"!==t.pointerType||0!==t.buttons)return;const e=this.getOrCreateInput(t.pointerId,ge.pointerInputType(t.pointerType),t.isPrimary,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.hovering||this.beginHover(e,t)},onPointerLeave(t){if("mouse"!==t.pointerType)return;const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.endHover(e,t))},onPointerDown(t){const e=this.getOrCreateInput(t.pointerId,ge.pointerInputType(t.pointerType),t.isPrimary,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.pressing||this.beginPress(e,t),"mouse"===t.pointerType&&0!==t.button&&this.cancelPress(e,t)},onPointerMove(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.movePress(e,t))},onPointerUp(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.endPress(e,t),e.defaultPrevented||0!==t.button||this.press(e,t))},onPointerCancel(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.cancelPress(e,t))},onPointerLeaveDocument(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.cancelPress(e,t),this.endHover(e,t))}},{construct(t,e){return(t=super.construct(t,e)).onPointerEnter=t.onPointerEnter.bind(t),t.onPointerLeave=t.onPointerLeave.bind(t),t.onPointerDown=t.onPointerDown.bind(t),t.onPointerMove=t.onPointerMove.bind(t),t.onPointerUp=t.onPointerUp.bind(t),t.onPointerCancel=t.onPointerCancel.bind(t),t.onPointerLeaveDocument=t.onPointerLeaveDocument.bind(t),t}}),Me=Se.extend("TouchMomentumGesture",{attachHoverEvents(t){t.addEventListener("touchstart",this.onTouchStart)},detachHoverEvents(t){t.removeEventListener("touchstart",this.onTouchStart)},attachPressEvents(t){t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("touchcancel",this.onTouchCancel)},detachPressEvents(t){t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel)},updateInput(t,e,i){t.target=i.target,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=i.clientX-t.x,t.dy=i.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=i.clientX,t.y=i.clientY,t.t=e.timeStamp},onTouchStart(t){const e=t.targetTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getOrCreateInput(s.identifier,"touch",!1,s.clientX,s.clientY,t.timeStamp);this.updateInput(n,t,s),n.pressing||this.beginPress(n,t)}},onTouchMove(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.movePress(n,t))}},onTouchEnd(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.endPress(n,t),n.defaultPrevented||this.press(n,t),this.endHover(n,t))}},onTouchCancel(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.cancelPress(n,t),this.endHover(n,t))}}},{construct(t,e){return(t=super.construct(t,e)).onTouchStart=t.onTouchStart.bind(t),t.onTouchMove=t.onTouchMove.bind(t),t.onTouchEnd=t.onTouchEnd.bind(t),t.onTouchCancel=t.onTouchCancel.bind(t),t}}),Ae=Se.extend("MouseMomentumGesture",{attachHoverEvents(t){t.addEventListener("mouseenter",this.onMouseEnter),t.addEventListener("mouseleave",this.onMouseLeave),t.addEventListener("mousedown",this.onMouseDown)},detachHoverEvents(t){t.removeEventListener("mouseenter",this.onMouseEnter),t.removeEventListener("mouseleave",this.onMouseLeave),t.removeEventListener("mousedown",this.onMouseDown)},attachPressEvents(t){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp),document.body.addEventListener("mouseleave",this.onMouseLeaveDocument)},detachPressEvents(t){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp),document.body.removeEventListener("mouseleave",this.onMouseLeaveDocument)},updateInput(t,e){t.target=e.target,t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=e.clientX-t.x,t.dy=e.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=e.clientX,t.y=e.clientY,t.t=e.timeStamp},onMouseEnter(t){if(0!==t.buttons)return;const e=this.getOrCreateInput("mouse","mouse",!0,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.hovering||this.beginHover(e,t)},onMouseLeave(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.endHover(e,t))},onMouseDown(t){const e=this.getOrCreateInput("mouse","mouse",!0,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.pressing||this.beginPress(e,t),0!==t.button&&this.cancelPress(e,t)},onMouseMove(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.movePress(e,t))},onMouseUp(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.endPress(e,t),e.defaultPrevented||0!==t.button||this.press(e,t))},onMouseLeaveDocument(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.cancelPress(e,t),this.endHover(e,t))}},{construct(t,e){return(t=super.construct(t,e)).onMouseEnter=t.onMouseEnter.bind(t),t.onMouseLeave=t.onMouseLeave.bind(t),t.onMouseDown=t.onMouseDown.bind(t),t.onMouseMove=t.onMouseMove.bind(t),t.onMouseUp=t.onMouseUp.bind(t),t.onMouseLeaveDocument=t.onMouseLeaveDocument.bind(t),t}});class Fe extends Te{constructor(t,e,i,s,n,r){super(t,e,i,s,n,r),this.xCoord=void 0,this.yCoord=void 0,this.disableX=!1,this.disableY=!1}}const ke=Se.extend("ScaleGesture",{createInput:(t,e,i,s,n,r)=>new Fe(t,e,i,s,n,r),clearInputs(){super.clearInputs(),this.setFlags(this.flags&~ke.NeedsRescale)},distanceMin:10,initDistanceMin(){return Object.getPrototypeOf(this).distanceMin},get preserveAspectRatio(){return 0!=(this.flags&ke.PreserveAspectRatioFlag)},set preserveAspectRatio(t){t?this.setFlags(this.flags|ke.PreserveAspectRatioFlag):this.setFlags(this.flags&~ke.PreserveAspectRatioFlag)},get wheel(){return 0!=(this.flags&ke.WheelFlag)},set wheel(t){t?this.setFlags(this.flags|ke.WheelFlag):this.setFlags(this.flags&~ke.WheelFlag)},getXScale:()=>null,setXScale(t,e){},getYScale:()=>null,setYScale(t,e){},clientToRangeX(t,e,i){const s=t-i.xMin,n=e.range;return n[0]<=n[1]?n[0]+s:i.xMax+s-n[0]},clientToRangeY(t,e,i){const s=t-i.yMin,n=e.range;return n[0]<=n[1]?n[0]+s:i.yMax+s-n[0]},unscaleX(t,e,i){return e.inverse(this.clientToRangeX(t,e,i))},unscaleY(t,e,i){return e.inverse(this.clientToRangeY(t,e,i))},viewWillAnimate(t){super.viewWillAnimate(t),0!=(this.flags&ke.NeedsRescale)&&this.rescale()},onBeginPress(t,e){super.onBeginPress(t,e),this.updateInputDomain(t),this.view.requireUpdate(ue.NeedsAnimate),this.setFlags(this.flags|ke.NeedsRescale)},onMovePress(t,e){super.onMovePress(t,e),this.view.requireUpdate(ue.NeedsAnimate),this.setFlags(this.flags|ke.NeedsRescale)},onEndPress(t,e){super.onEndPress(t,e),this.updateInputDomain(t),this.view.requireUpdate(ue.NeedsAnimate),this.setFlags(this.flags|ke.NeedsRescale)},onCancelPress(t,e){super.onCancelPress(t,e),this.updateInputDomain(t),this.view.requireUpdate(ue.NeedsAnimate),this.setFlags(this.flags|ke.NeedsRescale)},beginCoast(t,e){this.coastCount<2&&super.beginCoast(t,e)},onBeginCoast(t,e){super.onBeginCoast(t,e),this.updateInputDomain(t),this.conserveMomentum(t),this.view.requireUpdate(ue.NeedsAnimate),this.setFlags(this.flags|ke.NeedsRescale)},onEndCoast(t,e){super.onEndCoast(t,e),t.disableX=!1,t.disableY=!1,this.view.requireUpdate(ue.NeedsAnimate),this.setFlags(this.flags|ke.NeedsRescale)},onCoast(){super.onCoast(),this.view.requireUpdate(ue.NeedsAnimate),this.setFlags(this.flags|ke.NeedsRescale)},updateInputDomain(t,e,i,s){void 0===e&&(e=this.getXScale()),null!==e&&(void 0===s&&(s=this.view.clientBounds),t.xCoord=this.unscaleX(t.x0,e,s)),void 0===i&&(i=this.getYScale()),null!==i&&(void 0===s&&(s=this.view.clientBounds),t.yCoord=this.unscaleY(t.y0,i,s))},neutralizeX(){const t=this.inputs;for(const e in t){const i=t[e];i.coasting&&(i.disableX=!0,i.vx=0,i.ax=0)}},neutralizeY(){const t=this.inputs;for(const e in t){const i=t[e];i.coasting&&(i.disableY=!0,i.vy=0,i.ay=0)}},rescale(){let t,e;const i=this.inputs;for(const s in i){const n=i[s];(n.pressing||n.coasting)&&(void 0===t?t=n:void 0===e?e=n:n.t0<t.t0?t=n:n.t0<e.t0&&(e=n))}if(void 0!==t){const i=this.view.clientBounds,s=this.getXScale(),n=this.getYScale();null!==s&&null!==n?void 0!==e&&this.preserveAspectRatio?this.rescaleRadial(s,n,t,e,i):this.rescaleXY(s,n,t,e,i):null!==s?this.rescaleX(s,t,e,i):null!==n&&this.rescaleY(n,t,e,i)}this.setFlags(this.flags&~ke.NeedsRescale)},rescaleRadial(t,e,i,s,n){const r=i.xCoord,o=i.yCoord,l=this.clientToRangeX(i.x0,t,n),a=this.clientToRangeY(i.y0,e,n),h=this.clientToRangeX(i.x,t,n),d=this.clientToRangeY(i.y,e,n),u=i.vx,c=i.vy,f=i.ax,p=i.ay,g=s.xCoord,m=s.yCoord,v=this.clientToRangeX(s.x0,t,n),w=this.clientToRangeY(s.y0,e,n),y=this.clientToRangeX(s.x,t,n),b=this.clientToRangeY(s.y,e,n),C=s.vx,T=s.vy,S=s.ax,x=s.ay,M=v-l,A=w-a,F=Math.max(this.distanceMin,Math.sqrt(M*M+A*A)),k=M/F,P=A/F,V=h-l,L=d-a,R=y-v,I=b-w,O=V*k+L*P,D=R*k+I*P,E=V*P+L*-k,U=R*P+I*-k,N=(E*P+U*P)/2,q=(E*-k+U*-k)/2,z=l+O*k+N,j=a+O*P+q,W=v+D*k+N,H=w+D*P+q,K=u*k+c*P,B=C*k+T*P,G=u*P+c*-k,Y=C*P+T*-k,X=(G*P+Y*P)/2,_=(G*-k+Y*-k)/2;let Q=K*k+X,J=K*P+_,Z=B*k+X,$=B*P+_;const tt=Math.sqrt(Q*Q+J*J),et=Math.sqrt(Z*Z+$*$),it=0!==tt?Q/tt:0,st=0!==tt?J/tt:0,nt=0!==et?Z/et:0,rt=0!==et?$/et:0;Q=it*tt,J=st*tt,Z=nt*et,$=rt*et;const ot=Math.sqrt(f*f+p*p),lt=Math.sqrt(S*S+x*x),at=ot*-it,ht=ot*-st,dt=lt*-nt,ut=lt*-rt;let ct=null;const ft=t.solveDomain(r,z,g,W);ft.equals(t)||(ct=ft,this.setXScale(ct));let pt=null;const gt=e.solveDomain(o,j,m,H);if(gt.equals(e)||(pt=gt,this.setYScale(pt)),null===ct&&null===pt)return;if(null!==ct&&(i.x0=i.x,i.dx=0,i.vx=Q,i.ax=at,i.xCoord=this.unscaleX(i.x0,ct,n),s.x0=s.x,s.dx=0,s.vx=Z,s.ax=dt,s.xCoord=this.unscaleX(s.x0,ct,n)),null!==pt&&(i.y0=i.y,i.dy=0,i.vy=J,i.ay=ht,i.yCoord=this.unscaleY(i.y0,pt,n),s.y0=s.y,s.dy=0,s.vy=$,s.ay=ut,s.yCoord=this.unscaleY(s.y0,pt,n)),this.inputCount<=2)return;const mt=this.inputs;for(const t in mt){const e=mt[t];e!==i&&e!==s&&(null!==ct&&(e.x0=e.x,e.dx=0,e.xCoord=this.unscaleX(e.x0,ct,n)),null!==pt&&(e.y0=e.y,e.dy=0,e.yCoord=this.unscaleY(e.y0,pt,n)))}},rescaleXY(t,e,i,s,n){const r=i.xCoord,o=i.yCoord;let l,a,h,d,u=this.clientToRangeX(i.x,t,n),c=this.clientToRangeY(i.y,e,n),f=i.disableX,p=i.disableY;if(void 0!==s){l=s.xCoord,a=s.yCoord,h=this.clientToRangeX(s.x,t,n),d=this.clientToRangeY(s.y,e,n),f=f||s.disableX,p=p||s.disableY;const i=Math.abs(h-u),r=Math.abs(d-c),o=this.distanceMin;if(i<o){const t=(o-i)/2;u<=h?(u-=t,h+=t):(u+=t,h-=t)}if(r<o){const t=(o-r)/2;c<=d?(c-=t,d+=t):(c+=t,d-=t)}}let g=null;f||(g=t.solveDomain(r,u,l,h),g.equals(t)||this.setXScale(g));let m=null;if(p||(m=e.solveDomain(o,c,a,d),m.equals(e)||this.setYScale(m)),null===g&&null===m||!this.preserveAspectRatio)return;const v=this.inputs;for(const t in v){const e=v[t];null!==g&&(e.x0=e.x,e.dx=0,e.xCoord=this.unscaleX(e.x0,g,n)),null!==m&&(e.y0=e.y,e.dy=0,e.yCoord=this.unscaleY(e.y0,m,n))}},rescaleX(t,e,i,s){const n=e.xCoord;let r,o,l=this.clientToRangeX(e.x,t,s),a=e.disableX;if(void 0!==i){o=i.xCoord,r=this.clientToRangeX(i.x,t,s),a=a||i.disableX;const e=Math.abs(r-l),n=this.distanceMin;if(e<n){const t=(n-e)/2;l<=r?(l-=t,r+=t):(l+=t,r-=t)}}if(a)return;const h=t.solveDomain(n,l,o,r);h.equals(t)||this.setXScale(h)},rescaleY(t,e,i,s){const n=e.yCoord;let r,o,l=this.clientToRangeY(e.y,t,s),a=e.disableY;if(void 0!==i){o=i.yCoord,r=this.clientToRangeY(i.y,t,s),a=a||i.disableY;const e=Math.abs(r-l),n=this.distanceMin;if(e<n){const t=(n-e)/2;l<=r?(l-=t,r+=t):(l+=t,r-=t)}}if(a)return;const h=t.solveDomain(n,l,o,r);h.equals(t)||this.setYScale(h)},conserveMomentum(t){let e;const i=this.inputs;for(const t in i){const s=i[t];s.coasting&&(void 0===e||s.t0<e.t0)&&(e=s)}if(void 0===e)return;const s=this.getXScale(),n=this.getYScale();null!==s&&null!==n?this.distributeXYMomentum(t,e):null!==s?this.distributeXMomentum(t,e):null!==n&&this.distributeYMomentum(t,e)},distributeXYMomentum(t,e){const i=t.vx,s=t.vy,n=e.vx,r=e.vy,o=Math.sqrt(i*i+s*s),l=Math.sqrt(n*n+r*r),a=0!==o?i/o:0,h=0!==o?s/o:0,d=0!==l?n/l:0,u=0!==l?r/l:0,c=(o+l)/2;t.vx=a*c,t.vy=h*c,e.vx=d*c,e.vy=u*c;const f=t.ax,p=t.ay,g=e.ax,m=e.ay,v=Math.sqrt(f*f+p*p),w=Math.sqrt(g*g+m*m),y=0!==v?f/v:0,b=0!==v?p/v:0,C=0!==w?g/w:0,T=0!==w?m/w:0,S=(v+w)/2;t.ax=y*S,t.ay=b*S,e.ax=C*S,e.ay=T*S},distributeXMomentum(t,e){const i=t.vx,s=e.vx,n=Math.abs(i),r=Math.abs(s),o=0!==n?i/n:0,l=0!==r?s/r:0,a=(n+r)/2;t.vx=o*a,e.vx=l*a;const h=t.ax,d=e.ax,u=Math.abs(h),c=Math.abs(d),f=0!==u?h/u:0,p=0!==c?d/c:0,g=(u+c)/2;t.ax=f*g,e.ax=p*g},distributeYMomentum(t,e){const i=t.vy,s=e.vy,n=Math.sqrt(i),r=Math.sqrt(s),o=0!==n?i/n:0,l=0!==r?s/r:0,a=(n+r)/2;t.vy=o*a,e.vy=l*a;const h=t.ay,d=e.ay,u=Math.sqrt(h),c=Math.sqrt(d),f=0!==u?h/u:0,p=0!==c?d/c:0,g=(u+c)/2;t.ay=f*g,e.ay=p*g},integrate(t){let e,i;const s=this.inputs;for(const n in s){const r=s[n];if(r.coasting)if(void 0===e)e=r;else if(void 0===i){i=r;const s=i.x-e.x,n=i.y-e.y,o=Math.sqrt(s*s+n*n);e.integrateVelocity(t),i.integrateVelocity(t);const l=i.x-e.x,a=i.y-e.y,h=Math.sqrt(l*l+a*a)/o;e.vx*=h,e.vy*=h,e.ax*=h,e.ay*=h,i.vx*=h,i.vy*=h,i.ax*=h,i.ay*=h}else r.integrateVelocity(t)}void 0!==e&&void 0===i&&e.integrateVelocity(t)},zoom(t,e,i,s){if(0===i)return;const n=null!==s?s.timeStamp:performance.now(),r=this.acceleration;let o=r*Math.cos(Math.PI/4),l=r*Math.sin(Math.PI/4);const a=this.velocityMax,h=.5*a*Math.cos(Math.PI/4),d=.5*a*Math.sin(Math.PI/4),u=4*h*h/o,c=4*d*d/l,f=this.inputs;let p=f.zoom0,g=f.zoom1;if(void 0!==p&&void 0!==g){const t=n-p.t;if(t>0){const e=Math.abs(g.x-p.x)/2,s=Math.abs(g.y-p.y)/2,r=(i=Math.min(Math.max(-a*t,i),a*t))*e*Math.cos(Math.PI/4)/u,h=i*s*Math.sin(Math.PI/4)/c;o=o*e/u,l=l*s/c,p.x+=r,p.y+=h,p.t=n,p.dx=r,p.dy=h,p.dt=t,p.vx=r/t,p.vy=h/t,p.ax=p.vx<0?o:p.vx>0?-o:0,p.ay=p.vy<0?l:p.vy>0?-l:0,g.x-=r,g.y-=h,g.t=n,p.dx=-r,p.dy=-h,p.dt=t,g.vx=-r/t,g.vy=-h/t,g.ax=g.vx<0?o:g.vx>0?-o:0,g.ay=g.vy<0?l:g.vy>0?-l:0}}else this.interrupt(s),i<0?(p=this.createInput("zoom0","unknown",!1,t-u,e-c,n),p.vx=-h,p.vy=-d,p.ax=o,p.ay=l,g=this.createInput("zoom1","unknown",!1,t+u,e+c,n),g.vx=h,g.vy=d,g.ax=-o,g.ay=-l):(p=this.createInput("zoom0","unknown",!1,t-u,e-c,n),p.vx=h,p.vy=d,p.ax=-o,p.ay=-l,g=this.createInput("zoom1","unknown",!1,t+u,e+c,n),g.vx=-h,g.vy=-d,g.ax=o,g.ay=l),f.zoom0=p,f.zoom1=g,this.inputCount+=2,this.beginCoast(p,s),this.beginCoast(g,s)}},{construct(t,e){return(t=super.construct(t,e)).distanceMin=t.initDistanceMin(),t},specialize(t){let e=t.extends;if(null==e){const i=t.method;e="pointer"===i?Pe:"touch"===i?Ve:"mouse"===i?Le:"undefined"!=typeof PointerEvent?Pe:"undefined"!=typeof TouchEvent?Ve:Le}return e},refine(t){super.refine(t);const e=t.prototype;let i=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"preserveAspectRatio")&&(e.preserveAspectRatio?i|=ke.PreserveAspectRatioFlag:i&=~ke.PreserveAspectRatioFlag,delete e.preserveAspectRatio),Object.prototype.hasOwnProperty.call(e,"wheel")&&(e.wheel?i|=ke.WheelFlag:i&=~ke.WheelFlag,delete e.wheel),Object.defineProperty(e,"flagsInit",{value:i,enumerable:!0,configurable:!0})},PreserveAspectRatioFlag:1<<Se.FlagShift+0,WheelFlag:1<<Se.FlagShift+1,NeedsRescale:1<<Se.FlagShift+2,FlagShift:Se.FlagShift+3,FlagMask:(1<<Se.FlagShift+3)-1}),Pe=ke.extend("PointerScaleGesture",{wheel:!0,attachHoverEvents(t){t.addEventListener("pointerenter",this.onPointerEnter),t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("wheel",this.onWheel)},detachHoverEvents(t){t.removeEventListener("pointerenter",this.onPointerEnter),t.removeEventListener("pointerleave",this.onPointerLeave),t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("wheel",this.onWheel)},attachPressEvents(t){document.body.addEventListener("pointermove",this.onPointerMove),document.body.addEventListener("pointerup",this.onPointerUp),document.body.addEventListener("pointercancel",this.onPointerCancel),document.body.addEventListener("pointerleave",this.onPointerLeaveDocument)},detachPressEvents(t){document.body.removeEventListener("pointermove",this.onPointerMove),document.body.removeEventListener("pointerup",this.onPointerUp),document.body.removeEventListener("pointercancel",this.onPointerCancel),document.body.removeEventListener("pointerleave",this.onPointerLeaveDocument)},updateInput(t,e){t.target=e.target,t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=e.clientX-t.x,t.dy=e.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=e.clientX,t.y=e.clientY,t.t=e.timeStamp,t.width=e.width,t.height=e.height,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure},onPointerEnter(t){if("mouse"!==t.pointerType||0!==t.buttons)return;const e=this.getOrCreateInput(t.pointerId,ge.pointerInputType(t.pointerType),t.isPrimary,t.clientX,t.clientY,t.timeStamp);e.coasting||this.updateInput(e,t),e.hovering||this.beginHover(e,t)},onPointerLeave(t){if("mouse"!==t.pointerType)return;const e=this.getInput(t.pointerId);null!==e&&(e.coasting||this.updateInput(e,t),this.endHover(e,t))},onPointerDown(t){const e=this.getOrCreateInput(t.pointerId,ge.pointerInputType(t.pointerType),t.isPrimary,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.pressing||this.beginPress(e,t),"mouse"===t.pointerType&&0!==t.button&&this.cancelPress(e,t)},onPointerMove(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.movePress(e,t))},onPointerUp(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.endPress(e,t),e.defaultPrevented||0!==t.button||this.press(e,t))},onPointerCancel(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.cancelPress(e,t))},onPointerLeaveDocument(t){const e=this.getInput(t.pointerId);null!==e&&(this.updateInput(e,t),this.cancelPress(e,t),this.endHover(e,t))},onWheel(t){this.wheel&&(t.preventDefault(),this.zoom(t.clientX,t.clientY,t.deltaY,t))}},{construct(t,e){return(t=super.construct(t,e)).onPointerEnter=t.onPointerEnter.bind(t),t.onPointerLeave=t.onPointerLeave.bind(t),t.onPointerDown=t.onPointerDown.bind(t),t.onPointerMove=t.onPointerMove.bind(t),t.onPointerUp=t.onPointerUp.bind(t),t.onPointerCancel=t.onPointerCancel.bind(t),t.onPointerLeaveDocument=t.onPointerLeaveDocument.bind(t),t.onWheel=t.onWheel.bind(t),t}}),Ve=ke.extend("TouchScaleGesture",{attachHoverEvents(t){t.addEventListener("touchstart",this.onTouchStart)},detachHoverEvents(t){t.removeEventListener("touchstart",this.onTouchStart)},attachPressEvents(t){t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("touchcancel",this.onTouchCancel)},detachPressEvents(t){t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel)},updateInput(t,e,i){t.target=i.target,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=i.clientX-t.x,t.dy=i.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=i.clientX,t.y=i.clientY,t.t=e.timeStamp},onTouchStart(t){const e=t.targetTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getOrCreateInput(s.identifier,"touch",!1,s.clientX,s.clientY,t.timeStamp);this.updateInput(n,t,s),n.pressing||this.beginPress(n,t)}},onTouchMove(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.movePress(n,t))}},onTouchEnd(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.endPress(n,t),n.defaultPrevented||this.press(n,t),this.endHover(n,t))}},onTouchCancel(t){const e=t.changedTouches;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.getInput(s.identifier);null!==n&&(this.updateInput(n,t,s),this.cancelPress(n,t),this.endHover(n,t))}}},{construct(t,e){return(t=super.construct(t,e)).onTouchStart=t.onTouchStart.bind(t),t.onTouchMove=t.onTouchMove.bind(t),t.onTouchEnd=t.onTouchEnd.bind(t),t.onTouchCancel=t.onTouchCancel.bind(t),t}}),Le=ke.extend("MouseScaleGesture",{wheel:!0,attachHoverEvents(t){t.addEventListener("mouseenter",this.onMouseEnter),t.addEventListener("mouseleave",this.onMouseLeave),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("wheel",this.onWheel)},detachHoverEvents(t){t.removeEventListener("mouseenter",this.onMouseEnter),t.removeEventListener("mouseleave",this.onMouseLeave),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("wheel",this.onWheel)},attachPressEvents(t){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp),document.body.addEventListener("mouseleave",this.onMouseLeaveDocument)},detachPressEvents(t){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp),document.body.removeEventListener("mouseleave",this.onMouseLeaveDocument)},updateInput(t,e){t.target=e.target,t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.dx=e.clientX-t.x,t.dy=e.clientY-t.y,t.dt=e.timeStamp-t.t,t.x=e.clientX,t.y=e.clientY,t.t=e.timeStamp},onMouseEnter(t){if(0!==t.buttons)return;const e=this.getOrCreateInput("mouse","mouse",!0,t.clientX,t.clientY,t.timeStamp);e.coasting||this.updateInput(e,t),e.hovering||this.beginHover(e,t)},onMouseLeave(t){const e=this.getInput("mouse");null!==e&&(e.coasting||this.updateInput(e,t),this.endHover(e,t))},onMouseDown(t){const e=this.getOrCreateInput("mouse","mouse",!0,t.clientX,t.clientY,t.timeStamp);this.updateInput(e,t),e.pressing||this.beginPress(e,t),0!==t.button&&this.cancelPress(e,t)},onMouseMove(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.movePress(e,t))},onMouseUp(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.endPress(e,t),e.defaultPrevented||0!==t.button||this.press(e,t))},onMouseLeaveDocument(t){const e=this.getInput("mouse");null!==e&&(this.updateInput(e,t),this.cancelPress(e,t),this.endHover(e,t))},onWheel(t){this.wheel&&(t.preventDefault(),this.zoom(t.clientX,t.clientY,t.deltaY,t))}},{construct(t,e){return(t=super.construct(t,e)).onMouseEnter=t.onMouseEnter.bind(t),t.onMouseLeave=t.onMouseLeave.bind(t),t.onMouseDown=t.onMouseDown.bind(t),t.onMouseMove=t.onMouseMove.bind(t),t.onMouseUp=t.onMouseUp.bind(t),t.onMouseLeaveDocument=t.onMouseLeaveDocument.bind(t),t.onWheel=t.onWheel.bind(t),t}}),Re={equal:(t,e)=>t===e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&(t.width===e.width&&t.height===e.height&&t.pageLeft===e.pageLeft&&t.pageTop===e.pageTop)},Ie={equal:(t,e)=>t===e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&(t.width===e.width&&t.height===e.height&&t.pageLeft===e.pageLeft&&t.pageTop===e.pageTop&&t.offsetLeft===e.offsetLeft&&t.offsetTop===e.offsetTop&&t.scale===e.scale)};let Oe=(()=>{var t;let i,s,n,r,o,a,h,c,f,p,g,m=e.Service,v=[],w=[],y=[],b=[],C=[],T=[],S=[],x=[],M=[],A=[],F=[],k=[];return t=class extends m{constructor(){super(...arguments),this.layoutViewport=(u(this,v),u(this,w,void 0)),this.layoutViewportChange=u(this,y,void 0),this.visualViewport=u(this,b,void 0),this.visualViewportChange=u(this,C,void 0),this.safeArea=u(this,T,void 0),this.orientation=u(this,S,void 0),this.orientationChange=u(this,x,void 0),this.colorScheme=u(this,M,void 0),this.colorSchemeChange=u(this,A,void 0),this.viewIdiom=u(this,F,void 0),this.load=u(this,k,void 0)}},(()=>{var u;const P="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=m[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[e.Property({valueType:Re,initValue(){return this.detect()},update(){if(this.hasAffinity(e.Affinity.Intrinsic)){const t=this.detect();this.setIntrinsic(t)}},detect:()=>({width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,pageLeft:window.pageXOffset,pageTop:window.pageYOffset}),didSetValue(t,e){t.width!==e.width||t.height!==e.height?(this.owner.callObservers("serviceDidResizeLayoutViewport",t,this.owner),this.owner.safeArea.update(),this.owner.viewIdiom.update()):this.owner.callObservers("serviceDidScrollLayoutViewport",t,this.owner)},equalValues:Re.equal})],s=[e.EventTimer({delay:33,eventType:["resize","scroll"],initTarget:()=>"undefined"!=typeof window?window:null,handle(t){this.owner.layoutViewport.update()}})],n=[e.Property({valueType:Ie,initValue(){return this.detect()},update(){if(this.hasAffinity(e.Affinity.Intrinsic)){const t=this.detect();this.setIntrinsic(t)}},detect(){let t;return t=void 0!==window.visualViewport&&null!==window.visualViewport?{width:window.visualViewport.width,height:window.visualViewport.height,pageLeft:window.visualViewport.pageLeft,pageTop:window.visualViewport.pageTop,offsetLeft:window.visualViewport.offsetLeft,offsetTop:window.visualViewport.offsetTop,scale:window.visualViewport.scale}:{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,pageLeft:window.pageXOffset,pageTop:window.pageYOffset,offsetLeft:0,offsetTop:0,scale:1},t},didSetValue(t){this.owner.callObservers("serviceDidResizeVisualViewport",t,this.owner)},equalValues:Ie.equal})],r=[e.EventTimer({delay:33,eventType:"resize",initTarget:()=>"undefined"!=typeof window&&void 0!==window.visualViewport?window.visualViewport:null,handle(t){this.owner.visualViewport.update()}})],o=[e.Property({valueType:de,value:de.zero(),update(){if(this.hasAffinity(e.Affinity.Intrinsic)){const t=this.detect();this.setIntrinsic(t)}},detect(){let t;try{const e=getComputedStyle(document.documentElement),i=l.Length.parse(e.getPropertyValue("--safe-area-inset-top")).pxValue(),s=l.Length.parse(e.getPropertyValue("--safe-area-inset-right")).pxValue(),n=l.Length.parse(e.getPropertyValue("--safe-area-inset-bottom")).pxValue();t={insetTop:i,insetRight:s,insetBottom:n,insetLeft:l.Length.parse(e.getPropertyValue("--safe-area-inset-left")).pxValue()}}catch(e){t=de.zero()}return t},didSetValue(t){this.owner.callObservers("serviceDidResizeViewportSafeArea",t,this.owner)},equalValues:de.equal,didMount(){if("undefined"!=typeof CSS&&void 0!==CSS.supports&&CSS.supports("--safe-area-inset-top: env(safe-area-inset-top)")){const t=document.documentElement.style;t.setProperty("--safe-area-inset-top","env(safe-area-inset-top)"),t.setProperty("--safe-area-inset-right","env(safe-area-inset-right)"),t.setProperty("--safe-area-inset-bottom","env(safe-area-inset-bottom)"),t.setProperty("--safe-area-inset-left","env(safe-area-inset-left)"),this.update()}}})],a=[e.Property({valueType:String,initValue(){return this.detect()},update(){if(this.hasAffinity(e.Affinity.Intrinsic)){const t=this.detect();this.setIntrinsic(t)}},detect(){let t;return t="undefined"!=typeof window&&window.matchMedia("(orientation: portrait)").matches?"portrait":("undefined"!=typeof window&&window.matchMedia("(orientation: landscape)").matches,"landscape"),t},didSetValue(t){this.owner.callObservers("serviceDidSetViewportOrientation",t,this.owner),this.owner.safeArea.update(),this.owner.viewIdiom.update()}})],h=[e.EventHandler({eventType:"change",initTarget:()=>"undefined"!=typeof window?window.matchMedia("(orientation: landscape)"):null,handle(t){this.owner.orientation.update()}})],c=[e.Property({valueType:String,initValue(){return this.detect()},update(){if(this.hasAffinity(e.Affinity.Intrinsic)){const t=this.detect();this.setIntrinsic(t)}},detect(){let t;return t="undefined"!=typeof window&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"undefined"!=typeof window&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"no-preference",t},didSetValue(t){this.owner.callObservers("serviceDidSetViewportColorScheme",t,this.owner)}})],f=[e.EventHandler({eventType:"change",initTarget:()=>"undefined"!=typeof window?window.matchMedia("(prefers-color-scheme: dark)"):null,handle(t){this.owner.colorScheme.update()}})],p=[e.Property({valueType:String,initValue(){return this.detect()},update(){if(this.hasAffinity(e.Affinity.Intrinsic)){const t=this.detect();this.setIntrinsic(t)}},detect(){let t;const e=this.owner.layoutViewport.value;return t=e.width<600?"mobile":e.width<800?"tablet":"desktop",t},didSetValue(t){return this.owner.callObservers("serviceDidSetViewIdiom",t,this.owner)}})],g=[e.EventTimer({delay:100,eventType:"load",initTarget:()=>"undefined"!=typeof window?window:null,handle(t){this.owner.layoutViewport.update(),this.owner.visualViewport.update(),this.owner.safeArea.update(),this.owner.orientation.update(),this.owner.colorScheme.update()}})],d(null,null,i,{kind:"field",name:"layoutViewport",static:!1,private:!1,access:{has:t=>"layoutViewport"in t,get:t=>t.layoutViewport,set:(t,e)=>{t.layoutViewport=e}},metadata:P},w,v),d(null,null,s,{kind:"field",name:"layoutViewportChange",static:!1,private:!1,access:{has:t=>"layoutViewportChange"in t,get:t=>t.layoutViewportChange,set:(t,e)=>{t.layoutViewportChange=e}},metadata:P},y,v),d(null,null,n,{kind:"field",name:"visualViewport",static:!1,private:!1,access:{has:t=>"visualViewport"in t,get:t=>t.visualViewport,set:(t,e)=>{t.visualViewport=e}},metadata:P},b,v),d(null,null,r,{kind:"field",name:"visualViewportChange",static:!1,private:!1,access:{has:t=>"visualViewportChange"in t,get:t=>t.visualViewportChange,set:(t,e)=>{t.visualViewportChange=e}},metadata:P},C,v),d(null,null,o,{kind:"field",name:"safeArea",static:!1,private:!1,access:{has:t=>"safeArea"in t,get:t=>t.safeArea,set:(t,e)=>{t.safeArea=e}},metadata:P},T,v),d(null,null,a,{kind:"field",name:"orientation",static:!1,private:!1,access:{has:t=>"orientation"in t,get:t=>t.orientation,set:(t,e)=>{t.orientation=e}},metadata:P},S,v),d(null,null,h,{kind:"field",name:"orientationChange",static:!1,private:!1,access:{has:t=>"orientationChange"in t,get:t=>t.orientationChange,set:(t,e)=>{t.orientationChange=e}},metadata:P},x,v),d(null,null,c,{kind:"field",name:"colorScheme",static:!1,private:!1,access:{has:t=>"colorScheme"in t,get:t=>t.colorScheme,set:(t,e)=>{t.colorScheme=e}},metadata:P},M,v),d(null,null,f,{kind:"field",name:"colorSchemeChange",static:!1,private:!1,access:{has:t=>"colorSchemeChange"in t,get:t=>t.colorSchemeChange,set:(t,e)=>{t.colorSchemeChange=e}},metadata:P},A,v),d(null,null,p,{kind:"field",name:"viewIdiom",static:!1,private:!1,access:{has:t=>"viewIdiom"in t,get:t=>t.viewIdiom,set:(t,e)=>{t.viewIdiom=e}},metadata:P},F,v),d(null,null,g,{kind:"field",name:"load",static:!1,private:!1,access:{has:t=>"load"in t,get:t=>t.load,set:(t,e)=>{t.load=e}},metadata:P},k,v),P&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:P})})(),t})(),De=(()=>{var t;let i,s,n,r=e.Service,o=[],l=[],a=[],h=[];return t=class extends r{constructor(){super(),this.roots=(u(this,o),u(this,l,void 0)),this.viewport=u(this,a,void 0),this.visibilityChange=u(this,h,void 0),this.updateFlags=0,this.updateTime=performance.now(),this.updateDelay=t.MinUpdateDelay,this.processTimer=0,this.displayFrame=0,this.runProcessPass=this.runProcessPass.bind(this),this.runDisplayPass=this.runDisplayPass.bind(this)}setUpdateFlags(t){this.updateFlags=t}needsUpdate(t,e){return t}requestUpdate(e,i,s){i=this.needsUpdate(i,s);let n=this.updateFlags&~i&ue.UpdateMask;0!=(i&ue.ProcessMask)&&(n|=ue.NeedsProcess),0!=(i&ue.DisplayMask)&&(n|=ue.NeedsDisplay),this.setUpdateFlags(this.updateFlags|n),s&&0==(this.updateFlags&(ue.ProcessingFlag|ue.DisplayingFlag))&&this.updateDelay<=t.MaxProcessInterval?this.runImmediatePass():this.scheduleUpdate()}scheduleUpdate(){const t=this.updateFlags;0==(t&ue.ProcessingFlag)&&0!=(t&ue.ProcessMask)?this.scheduleProcessPass(this.updateDelay):0==(t&ue.DisplayingFlag)&&0!=(t&ue.DisplayMask)&&this.scheduleDisplayPass()}cancelUpdate(){this.cancelProcessPass(),this.cancelDisplayPass()}runImmediatePass(){0!=(this.updateFlags&ue.ProcessMask)&&(this.cancelUpdate(),this.runProcessPass(!0)),0!=(this.updateFlags&ue.DisplayMask)&&this.updateDelay<=t.MaxProcessInterval&&(this.cancelUpdate(),this.runDisplayPass(void 0,!0))}scheduleProcessPass(t){0===this.processTimer&&(this.processTimer=setTimeout(this.runProcessPass,t))}cancelProcessPass(){0!==this.processTimer&&(clearTimeout(this.processTimer),this.processTimer=0)}runProcessPass(e=!1){e||(this.processTimer=0),this.setUpdateFlags(this.updateFlags&~ue.ProcessMask|ue.ProcessingFlag);try{const i=performance.now();this.updateTime=i;const s=this.roots.views;for(const t in s){const e=s[t];0!=(e.flags&ue.ProcessMask)&&e.cascadeProcess(0)}const n=performance.now();let r=Math.max(t.MinProcessInterval,this.updateDelay);this.updateDelay=n-i>r?Math.min(Math.max(2,2*this.updateDelay),t.MaxUpdateDelay):Math.min(t.MinUpdateDelay,this.updateDelay/2),this.cancelProcessPass(),0!=(this.updateFlags&ue.DisplayMask)?this.scheduleDisplayPass():0!=(this.updateFlags&ue.ProcessMask)&&(e&&(r=Math.max(t.MaxProcessInterval,r)),this.cancelDisplayPass(),this.scheduleProcessPass(r))}finally{this.setUpdateFlags(this.updateFlags&~ue.ProcessingFlag)}}scheduleDisplayPass(){0===this.displayFrame&&(this.displayFrame=requestAnimationFrame(this.runDisplayPass))}cancelDisplayPass(){0!==this.displayFrame&&(cancelAnimationFrame(this.displayFrame),this.displayFrame=0)}runDisplayPass(e,i=!1){i||(this.displayFrame=0),this.setUpdateFlags(this.updateFlags&~ue.DisplayMask|ue.DisplayingFlag);try{void 0===e&&(e=performance.now()),this.updateTime=e;const s=this.roots.views;for(const t in s){const e=s[t];0!=(e.flags&ue.DisplayMask)&&e.cascadeDisplay(0)}if(this.cancelDisplayPass(),0!=(this.updateFlags&ue.ProcessMask)){let e=this.updateDelay;i&&(e=Math.max(t.MaxProcessInterval,e)),this.scheduleProcessPass(e)}else 0!=(this.updateFlags&ue.DisplayMask)&&(this.cancelProcessPass(),this.scheduleDisplayPass())}finally{this.setUpdateFlags(this.updateFlags&~ue.DisplayingFlag)}}get powerFlags(){return ue.NeedsResize|ue.NeedsScroll}power(){const t=this.roots.views;for(const e in t){t[e].requireUpdate(this.powerFlags)}}unpower(){this.cancelUpdate(),this.updateDelay=t.MinUpdateDelay}},(()=>{var u;const c="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=r[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[pe({initView(t){this.owner.requestUpdate(t,t.flags&ue.UpdateMask,!1);const i=this.owner.viewport.getService().safeArea.value;t.edgeInsets.setValue(i,e.Affinity.Inherited)},willAttachView(t){this.owner.callObservers("serviceWillAttachRoot",t,this.owner)},didAttachView(t){this.owner.callObservers("serviceDidAttachRoot",t,this.owner)},willDetachView(t){this.owner.callObservers("serviceWillDetachRoot",t,this.owner)},didDetachView(t){this.owner.callObservers("serviceDidDetachRoot",t,this.owner)},updateSafeArea(t){const i=this.owner.roots.views;for(const s in i){i[s].edgeInsets.setValue(t,e.Affinity.Inherited)}}})],s=[e.Provider({serviceType:Oe,observes:!0,initService(t){this.owner.roots.updateSafeArea(t.safeArea.value)},serviceDidScrollLayoutViewport(t){const e=this.owner.roots.views;for(const t in e){e[t].requireUpdate(ue.NeedsScroll)}},serviceDidResizeLayoutViewport(t){const e=this.owner.roots.views;for(const t in e){e[t].requireUpdate(ue.NeedsResize|ue.NeedsScroll)}},serviceDidResizeVisualViewport(t){},serviceDidResizeViewportSafeArea(t){this.owner.roots.updateSafeArea(t)},serviceDidSetViewportOrientation(t){const e=this.owner.roots.views;for(const t in e){e[t].requireUpdate(ue.NeedsResize|ue.NeedsScroll|ue.NeedsLayout)}},serviceDidSetViewIdiom(t){const e=this.owner.roots.views;for(const t in e){e[t].requireUpdate(ue.NeedsResize|ue.NeedsLayout)}}})],n=[e.EventHandler({eventType:"visibilitychange",target:"undefined"!=typeof document?document:null,handle(t){"visible"===document.visibilityState?this.owner.power():this.owner.unpower()}})],d(null,null,i,{kind:"field",name:"roots",static:!1,private:!1,access:{has:t=>"roots"in t,get:t=>t.roots,set:(t,e)=>{t.roots=e}},metadata:c},l,o),d(null,null,s,{kind:"field",name:"viewport",static:!1,private:!1,access:{has:t=>"viewport"in t,get:t=>t.viewport,set:(t,e)=>{t.viewport=e}},metadata:c},a,o),d(null,null,n,{kind:"field",name:"visibilityChange",static:!1,private:!1,access:{has:t=>"visibilityChange"in t,get:t=>t.visibilityChange,set:(t,e)=>{t.visibilityChange=e}},metadata:c},h,o),c&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:c})})(),t.MinUpdateDelay=0,t.MaxUpdateDelay=167,t.MinProcessInterval=12,t.MaxProcessInterval=33,t})();class Ee extends e.Service{constructor(){super(),this.solver=this.createSolver()}createSolver(){return new h.ConstraintSolver}activateConstraint(t){this.solver.addConstraint(t)}deactivateConstraint(t){this.solver.removeConstraint(t)}activateConstraintVariable(t){this.solver.addConstraintVariable(t)}deactivateConstraintVariable(t){this.solver.removeConstraintVariable(t)}setConstraintVariable(t,e){this.solver.setConstraintVariable(t,e)}}let Ue=(()=>{var t;let i,s,n,r,o=e.Service,l=[],a=[],h=[],c=[],f=[];return t=class extends o{constructor(){super(...arguments),this.roots=(u(this,l),u(this,a,void 0)),this.viewport=u(this,h,void 0),this.theme=u(this,c,void 0),this.mood=u(this,f,void 0)}},(()=>{var u;const p="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=o[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[pe({initView(t){t.mood.setValue(this.owner.mood.value,e.Affinity.Inherited),t.theme.setValue(this.owner.theme.value,e.Affinity.Inherited),t.requireUpdate(ue.NeedsChange)},willAttachView(t){this.owner.callObservers("serviceWillAttachRoot",t,this.owner)},didAttachView(t){this.owner.callObservers("serviceDidAttachRoot",t,this.owner)},willDetachView(t){this.owner.callObservers("serviceWillDetachRoot",t,this.owner)},didDetachView(t){this.owner.callObservers("serviceDidDetachRoot",t,this.owner)}})],s=[e.Provider({serviceType:Oe,observes:!0,serviceDidSetViewportColorScheme(t){this.owner.theme.update()}})],n=[e.Property({valueType:Yt,initValue(){return this.detect()},update(){if(this.hasAffinity(e.Affinity.Intrinsic)){const t=this.detect();this.setIntrinsic(t)}},detect(){return"dark"===this.owner.viewport.getService().colorScheme.value?he.dark:he.light},didSetValue(t){const i=this.owner.roots.views;for(const s in i){const n=i[s];n.theme.setValue(t,e.Affinity.Inherited),n.requireUpdate(ue.NeedsChange)}this.owner.callObservers("serviceDidSetTheme",t,this.owner)}})],r=[e.Property({valueType:Bt,initValue:()=>ae.default,didSetValue(t){const i=this.owner.roots.views;for(const s in i){const n=i[s];n.mood.setValue(t,e.Affinity.Inherited),n.requireUpdate(ue.NeedsChange)}this.owner.callObservers("serviceDidSetMood",t,this.owner)}})],d(null,null,i,{kind:"field",name:"roots",static:!1,private:!1,access:{has:t=>"roots"in t,get:t=>t.roots,set:(t,e)=>{t.roots=e}},metadata:p},a,l),d(null,null,s,{kind:"field",name:"viewport",static:!1,private:!1,access:{has:t=>"viewport"in t,get:t=>t.viewport,set:(t,e)=>{t.viewport=e}},metadata:p},h,l),d(null,null,n,{kind:"field",name:"theme",static:!1,private:!1,access:{has:t=>"theme"in t,get:t=>t.theme,set:(t,e)=>{t.theme=e}},metadata:p},c,l),d(null,null,r,{kind:"field",name:"mood",static:!1,private:!1,access:{has:t=>"mood"in t,get:t=>t.mood,set:(t,e)=>{t.mood=e}},metadata:p},f,l),p&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p})})(),t})();const Ne={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"getAttribute","setAttribute")},qe=_t.extend("AttributeAnimator",{get attributeName(){throw new Error("no attribute name")},get attributeValue(){if(Ne[Symbol.hasInstance](this.owner)){const t=this.owner.getAttribute(this.attributeName);if(null!==t)try{return this.parse(t)}catch(t){}}return Object.getPrototypeOf(this).value},getAttributeValue(){const t=this.attributeValue;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="attribute value",new TypeError(e)}return t},onSetValue(t,e){Ne[Symbol.hasInstance](this.owner)&&this.owner.setAttribute(this.attributeName,t),super.onSetValue(t,e)},parse(){throw new Error}},{construct(t,e){return t=super.construct(t,e)},specialize(t){let e=t.extends;if(null==e){const i=t.valueType;e=i===String?ze:i===Number?je:i===Boolean?We:i===l.Length?He:i===z?Ke:i===l.Transform?Be:this}return e}}),ze=qe.extend("StringAttributeAnimator",{valueType:String,equalValues:(t,e)=>t===e,parse:t=>t,fromLike:t=>t}),je=qe.extend("NumberAttributeAnimator",{valueType:Number,equalValues:(t,e)=>t===e,parse(t){const e=+t;return isFinite(e)?e:void 0},fromLike(t){if("number"==typeof t)return t;const e=+t;return isFinite(e)?e:void 0}}),We=qe.extend("BooleanAttributeAnimator",{valueType:Boolean,equalValues:(t,e)=>t===e,parse:t=>!!t,fromLike:t=>!!t}),He=qe.extend("LengthAttributeAnimator",{valueType:l.Length,value:null,equalValues:(t,e)=>null!=t?t.equals(e):t===e,parse:t=>l.Length.parse(t),fromLike(t){try{return l.Length.fromLike(t)}catch(t){return null}}}),Ke=qe.extend("ColorAttributeAnimator",{valueType:z,value:null,equalValues:(t,e)=>null!=t?t.equals(e):t===e,parse:t=>z.parse(t),fromLike(t){try{return z.fromLike(t)}catch(t){return null}}}),Be=qe.extend("TransformAttributeAnimator",{valueType:l.Transform,value:null,equalValues:(t,e)=>null!=t?t.equals(e):t===e,parse:t=>l.Transform.parse(t),fromLike(t){try{return l.Transform.fromLike(t)}catch(t){return null}}}),Ge={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"getStyle","setStyle")},Ye=_t.extend("StyleAnimator",{get propertyNames(){throw new Error("no property names")},get propertyValue(){if(Ge[Symbol.hasInstance](this.owner)){let t=this.owner.getStyle(this.propertyNames);if("undefined"!=typeof CSSStyleValue&&t instanceof CSSStyleValue)try{t=this.fromCssValue(t)}catch(e){t=""+t}if("string"==typeof t&&0!==t.length)try{return this.parse(t)}catch(t){}}return Object.getPrototypeOf(this).value},getPropertyValue(){const t=this.propertyValue;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="property value",new TypeError(e)}return t},get computedValue(){let t;const e=Ge[Symbol.hasInstance](this.owner)?this.owner.node:void 0;if(e instanceof Element){const i=getComputedStyle(e),s=this.propertyNames;let n="";if("string"==typeof s)n=i.getPropertyValue(s);else for(let t=0;t<s.length&&0===n.length;t+=1)n=i.getPropertyValue(s[t]);if(0!==n.length)try{t=this.parse(n)}catch(t){}}return void 0===t&&(t=Object.getPrototypeOf(this).value),t},get cssValue(){const t=this.value;return this.definedValue(t)?t:this.computedValue},getCssValue(){const t=this.cssValue;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="css value",new TypeError(e)}return t},get cssState(){const t=this.state;return this.definedValue(t)?t:this.computedValue},getCssState(){const t=this.cssState;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="css state",new TypeError(e)}return t},onSetValue(t,e){this.applyStyle(t,this.priority),super.onSetValue(t,e)},priority:void 0,initPriority(){return Object.getPrototypeOf(this).priority},setPriority(t){this.priority=t,this.applyStyle(this.value,t)},applyStyle(t,e){if(!Ge[Symbol.hasInstance](this.owner))return;const i=this.propertyNames;if("string"==typeof i)this.owner.setStyle(i,t,e);else for(let s=0;s<i.length;s+=1)this.owner.setStyle(i[s],t,e)},parse(){throw new Error("abstract")},fromCssValue(t){throw new Error("unsupported")}},{construct(t,e){return(t=super.construct(t,e)).priority=t.initPriority(),t},specialize(t){let e=t.extends;if(null==e){const i=t.valueType;e=i===String?Xe:i===Number?_e:i===l.Length?Qe:i===z?Je:i===V?Ze:i===vt?$e:i===l.Transform?ti:this}return e}}),Xe=Ye.extend("StringStyleAnimator",{valueType:String,equalValues:(t,e)=>t===e,parse:t=>t,fromCssValue:t=>t.toString(),fromLike:t=>t}),_e=Ye.extend("NumberStyleAnimator",{valueType:Number,equalValues:(t,e)=>t===e,parse(t){const e=+t;return isFinite(e)?e:void 0},fromCssValue(t){if(t instanceof CSSNumericValue)return t.to("number").value},fromLike(t){if("number"==typeof t)return t;const e=+t;return isFinite(e)?e:void 0}}),Qe=Ye.extend("LengthStyleAnimator",{valueType:l.Length,value:null,get units(){const t=this.cssValue;return null!=t?t.units:void 0},pxValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pxValue(t))},emValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.emValue(t))},remValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.remValue(t))},pctValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pctValue(t))},pxState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pxValue(t))},emState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.emValue(t))},remState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.remValue(t))},pctState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pctValue(t))},px(t,e){const i=this.cssValue;return null==i?l.PxLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.px(t))},em(t,e){const i=this.cssValue;return null==i?l.EmLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.em(t))},rem(t,e){const i=this.cssValue;return null==i?l.RemLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.rem(t))},pct(t,e){const i=this.cssValue;return null==i?l.PctLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.pct(t))},to(t,e,i){const s=this.cssValue;return null==s?l.Length.of(void 0!==i?i:0,t):(void 0===e&&(e=this),s.to(t,e))},get emUnit(){if(Ge[Symbol.hasInstance](this.owner)){const t=this.owner.node;if(void 0!==t)return t}return 0},get remUnit(){return 0},get pctUnit(){return 0},equalValues:(t,e)=>null!=t?t.equals(e):t===e,parse:t=>l.Length.parse(t),fromCssValue:t=>l.Length.fromCssValue(t),fromLike(t){try{return l.Length.fromLike(t)}catch(t){return null}}}),Je=Ye.extend("ColorStyleAnimator",{valueType:z,value:null,equalValues:(t,e)=>null!=t?t.equals(e):t===e,parse:t=>z.parse(t),fromLike(t){try{return z.fromLike(t)}catch(t){return null}}}),Ze=Ye.extend("FontFamilyStyleAnimator",{valueType:V,parse:t=>I.parse(t).family,fromLike:t=>I.family(t).family}),$e=Ye.extend("BoxShadowStyleAnimator",{valueType:vt,value:null,equalValues:(t,e)=>null!=t?t.equals(e):t===e,parse:t=>vt.parse(t),fromLike(t){try{return vt.fromLike(t)}catch(t){return null}}}),ti=Ye.extend("TransformStyleAnimator",{valueType:l.Transform,value:null,equalValues:(t,e)=>null!=t?t.equals(e):t===e,parse:t=>l.Transform.parse(t),fromCssValue:t=>l.Transform.fromCssValue(t),fromLike(t){try{return l.Transform.fromLike(t)}catch(t){return null}}}),ei=Ye.extend("StyleConstraintAnimator",{isExternal:()=>!0,isDummy:()=>!1,isInvalid:()=>!1,isConstant:()=>!1,get constraintValue(){return this.computedValue},evaluateConstraintVariable(){const t=this.owner;if(!h.ConstraintScope[Symbol.hasInstance](t)||this.constrained||!this.constraining)return;const e=this.constraintValue;this.definedValue(e)&&t.setConstraintVariable(this,this.toNumber(e))},updateConstraintSolution(t){this.constrained&&this.toNumber(this.state)!==t&&this.setState(t,e.Affinity.Reflexive)},initStrength(){let t=Object.getPrototypeOf(this).strength;return void 0===t&&(t=h.ConstraintStrength.Strong),t},setStrength(t){this.strength=h.ConstraintStrength.fromLike(t)},get coefficient(){return 1},get variable(){return this},get terms(){const t=new Map;return t.set(this,1),t},get constant(){return 0},plus(t){return this===(t=h.ConstraintExpression.fromLike(t))?h.ConstraintExpression.product(2,this):h.ConstraintExpression.sum(this,t)},negative(){return h.ConstraintExpression.product(-1,this)},minus(t){return this===(t=h.ConstraintExpression.fromLike(t))?h.ConstraintExpression.zero():h.ConstraintExpression.sum(this,t.negative())},times(t){return h.ConstraintExpression.product(t,this)},divide(t){return h.ConstraintExpression.product(1/t,this)},get constrained(){return 0!=(this.flags&ei.ConstrainedFlag)},constrain(t){void 0===t&&(t=!0);const e=this.flags;return t&&0==(e&ei.ConstrainedFlag)?(this.setFlags(e|ei.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&this.stopConstraining()):t||0==(e&ei.ConstrainedFlag)||(this.setFlags(e&~ei.ConstrainedFlag),0!==this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())),this},addConstraintCondition(t,e){this.conditionCount+=1,!this.constrained&&1===this.conditionCount&&this.mounted&&(this.startConstraining(),this.updateConstraintVariable())},removeConstraintCondition(t,e){this.conditionCount-=1,!this.constrained&&0===this.conditionCount&&this.mounted&&this.stopConstraining()},get constraining(){return 0!=(this.flags&ei.ConstrainingFlag)},startConstraining(){0==(this.flags&ei.ConstrainingFlag)&&(this.willStartConstraining(),this.setFlags(this.flags|ei.ConstrainingFlag),this.onStartConstraining(),this.didStartConstraining())},willStartConstraining(){},onStartConstraining(){const t=this.owner;h.ConstraintScope[Symbol.hasInstance](t)&&t.addConstraintVariable(this)},didStartConstraining(){},stopConstraining(){0!=(this.flags&ei.ConstrainingFlag)&&(this.willStopConstraining(),this.setFlags(this.flags&~ei.ConstrainingFlag),this.onStopConstraining(),this.didStopConstraining())},willStopConstraining(){},onStopConstraining(){const t=this.owner;h.ConstraintScope[Symbol.hasInstance](t)&&t.removeConstraintVariable(this)},didStopConstraining(){},updateConstraintVariable(){const t=this.owner;if(h.ConstraintScope[Symbol.hasInstance](t)){let e=this.value;this.definedValue(e)||(e=this.constraintValue),t.setConstraintVariable(this,this.toNumber(e))}},onSetValue(t,e){super.onSetValue(t,e);const i=this.owner;this.constraining&&h.ConstraintScope[Symbol.hasInstance](i)&&i.setConstraintVariable(this,null!=t?this.toNumber(t):0)},onMount(){super.onMount(),this.constrained||0===this.conditionCount||this.startConstraining()},onUnmount(){this.constrained||0===this.conditionCount||this.stopConstraining(),super.onUnmount()},toNumber:t=>null!=t?+t:0},{construct(t,e){return(t=super.construct(t,e)).strength=t.initStrength(),t.conditionCount=0,t},specialize(t){let e=t.extends;if(null==e){const i=t.valueType;e=i===Number?ii:i===l.Length?si:this}return e},refine(t){super.refine(t);const e=t.prototype;let i=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"constrained")&&(e.constrained?i|=ei.ConstrainedFlag:i&=~ei.ConstrainedFlag,delete e.constrained),Object.defineProperty(e,"flagsInit",{value:i,enumerable:!0,configurable:!0});const s=Object.getOwnPropertyDescriptor(e,"strength");void 0!==s&&"value"in s&&(s.value=h.ConstraintStrength.fromLike(s.value),Object.defineProperty(e,"strength",s))},ConstrainedFlag:1<<Ye.FlagShift+0,ConstrainingFlag:1<<Ye.FlagShift+1,FlagShift:Ye.FlagShift+2,FlagMask:(1<<Ye.FlagShift+2)-1}),ii=ei.extend("NumberStyleConstraintAnimator",{valueType:Number,toNumber:t=>"number"==typeof t?t:0,equalValues:(t,e)=>t===e,parse(t){const e=+t;return isFinite(e)?e:void 0},fromCssValue(t){if(t instanceof CSSNumericValue)return t.to("number").value},fromLike(t){if("number"==typeof t)return t;const e=+t;return isFinite(e)?e:void 0}}),si=ei.extend("LengthStyleConstraintAnimator",{valueType:l.Length,value:null,get units(){const t=this.cssValue;return null!=t?t.units:void 0},pxValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pxValue(t))},emValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.emValue(t))},remValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.remValue(t))},pctValue(t,e){const i=this.cssValue;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pctValue(t))},pxState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pxValue(t))},emState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.emValue(t))},remState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.remValue(t))},pctState(t,e){const i=this.cssState;return null==i?void 0!==e?e:0:(void 0===t&&(t=this),i.pctValue(t))},px(t,e){const i=this.cssValue;return null==i?l.PxLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.px(t))},em(t,e){const i=this.cssValue;return null==i?l.EmLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.em(t))},rem(t,e){const i=this.cssValue;return null==i?l.RemLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.rem(t))},pct(t,e){const i=this.cssValue;return null==i?l.PctLength.of(void 0!==e?e:0):(void 0===t&&(t=this),i.pct(t))},to(t,e,i){const s=this.cssValue;return null==s?l.Length.of(void 0!==i?i:0,t):(void 0===e&&(e=this),s.to(t,e))},get emUnit(){const t=this.owner;if(Ge[Symbol.hasInstance](t)){const e=t.node;if(void 0!==e)return e}return 0},get remUnit(){return 0},get pctUnit(){return 0},toNumber:t=>null!=t?t.pxValue():0,equalValues:(t,e)=>t===e,parse:t=>l.Length.parse(t),fromCssValue:t=>l.Length.fromCssValue(t),fromLike(t){try{return l.Length.fromLike(t)}catch(t){return null}}}),ni=e.Fastener.extend("StyleAttribute",{get fastenerType(){return ni},set(t,i){for(const s in t){const n=t[s],r=this[s];if(null==r)throw new Error("unknown property "+s);if(void 0===r.set)throw new Error("unsettable property "+s);r instanceof e.Animator?r.set(n,i):r.set(n)}return this.owner},setIntrinsic(t,i){for(const s in t){const n=t[s],r=this[s];if(null==r)throw new Error("unknown property "+s);if(void 0===r.setIntrinsic)throw new Error("unsettable property "+s);r instanceof e.Animator?r.setIntrinsic(n,i):r.setIntrinsic(n)}return this.owner},get node(){return this.owner.node},getStyle(t){return this.owner.getStyle(t)},setStyle(t,e,i){return this.owner.setStyle(t,e,i),this},willSetStyle(t,e,i){},onSetStyle(t,e,i){},didSetStyle(t,e,i){},applyStyles(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const e=this[i[t]];e instanceof Ye&&e.applyStyle(e.value,e.priority)}},constraint(t,e,i,s){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.constraint(t,e,i,s)},hasConstraint(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.hasConstraint(t)},addConstraint(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.addConstraint(t)},removeConstraint(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.removeConstraint(t)},constraintVariable(t,e,i){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.constraintVariable(t,e,i)},hasConstraintVariable(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.hasConstraintVariable(t)},addConstraintVariable(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.addConstraintVariable(t)},removeConstraintVariable(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.removeConstraintVariable(t)},setConstraintVariable(t,e){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.setConstraintVariable(t,e)},getLook(t,e){if(Xt[Symbol.hasInstance](this.owner))return this.owner.getLook(t,e)},getLookOr(t,e,i){return Xt[Symbol.hasInstance](this.owner)?2===arguments.length?this.owner.getLookOr(t,e):this.owner.getLookOr(t,e,i):2===arguments.length?e:i},applyTheme(t,i,s){const n=e.FastenerContext.getMetaclass(this);if(null===n)return;s=null==s||!0===s?t.getOr(Jt.timing,ae.ambient,!1):r.Timing.fromLike(s);const o=n.slots;for(let e=0;e<o.length;e+=1){const n=this[o[e]];void 0!==n&&"applyTheme"in n&&n.applyTheme(t,i,s)}}},{pctWidthUnit(t){if(t instanceof HTMLElement){const e=t.offsetParent;if(e instanceof HTMLElement)return e.offsetWidth}return t===document.body||t===document.documentElement?window.innerWidth:0},pctHeightUnit(t){if(t instanceof HTMLElement){const e=t.offsetParent;if(e instanceof HTMLElement)return e.offsetHeight}return t===document.body||t===document.documentElement?window.innerHeight:0},construct(t,e){return t=super.construct(t,e),ni.initFasteners(t),t}});ni.defineGetter("alignContent",[Ye({propertyNames:"align-content",valueType:String})]),ni.defineGetter("alignItems",[Ye({propertyNames:"align-items",valueType:String})]),ni.defineGetter("alignSelf",[Ye({propertyNames:"align-self",valueType:String})]),ni.defineGetter("appearance",[Ye({propertyNames:["appearance","-webkit-appearance"],valueType:String})]),ni.defineGetter("backdropFilter",[Ye({propertyNames:["backdrop-filter","-webkit-backdrop-filter"],valueType:String})]),ni.defineGetter("backgroundClip",[Ye({propertyNames:["background-clip","-webkit-background-clip"],valueType:String})]),ni.defineGetter("backgroundColor",[Ye({propertyNames:"background-color",valueType:z,value:null})]),ni.defineGetter("backgroundImage",[Ye({propertyNames:"background-image",value:null,parse(t){try{return ut.parse(t)}catch(e){return t}},fromLike(t){if("string"!=typeof t)return ut.fromLike(t);try{return ut.parse(t)}catch(e){return t}}})]),ni.defineGetter("borderCollapse",[Ye({propertyNames:"border-collapse",valueType:String})]),ni.defineGetter("borderColor",[e.Fastener({get(){const t=this.owner.borderTopColor.value,e=this.owner.borderRightColor.value,i=this.owner.borderBottomColor.value,s=this.owner.borderLeftColor.value;return r.Values.equal(t,e)&&r.Values.equal(e,i)&&r.Values.equal(i,s)?t:[t,e,i,s]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){let s,n,r,o;if(Array.isArray(t))if(1===t.length)s=t[0],n=t[0],r=t[0],o=t[0];else if(2===t.length)s=t[0],n=t[1],r=t[0],o=t[1];else if(3===t.length)s=t[0],n=t[1],r=t[2],o=t[1];else{if(4!==t.length)throw new TypeError(""+t);s=t[0],n=t[1],r=t[2],o=t[3]}else s=t,n=t,r=t,o=t;s instanceof Jt?this.owner.borderTopColor.setLook(s,e,i):this.owner.borderTopColor.setState(s,e,i),n instanceof Jt?this.owner.borderRightColor.setLook(n,e,i):this.owner.borderRightColor.setState(n,e,i),r instanceof Jt?this.owner.borderBottomColor.setLook(r,e,i):this.owner.borderBottomColor.setState(r,e,i),o instanceof Jt?this.owner.borderLeftColor.setLook(o,e,i):this.owner.borderLeftColor.setState(o,e,i)}})]),ni.defineGetter("borderTopColor",[Ye({propertyNames:"border-top-color",valueType:z,value:null})]),ni.defineGetter("borderRightColor",[Ye({propertyNames:"border-right-color",valueType:z,value:null})]),ni.defineGetter("borderBottomColor",[Ye({propertyNames:"border-bottom-color",valueType:z,value:null})]),ni.defineGetter("borderLeftColor",[Ye({propertyNames:"border-left-color",valueType:z,value:null})]),ni.defineGetter("borderRadius",[e.Fastener({get(){const t=this.owner.borderTopLeftRadius.value,e=this.owner.borderTopRightRadius.value,i=this.owner.borderBottomRightRadius.value,s=this.owner.borderBottomLeftRadius.value;return r.Equals(t,e)&&r.Equals(e,i)&&r.Equals(i,s)?t:[t,e,i,s]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){let s,n,r,o;if(Array.isArray(t))if(1===t.length)s=t[0],n=t[0],r=t[0],o=t[0];else if(2===t.length)s=t[0],n=t[1],r=t[0],o=t[1];else if(3===t.length)s=t[0],n=t[1],r=t[2],o=t[1];else{if(4!==t.length)throw new TypeError(""+t);s=t[0],n=t[1],r=t[2],o=t[3]}else s=t,n=t,r=t,o=t;s instanceof Jt?this.owner.borderTopLeftRadius.setLook(s,e,i):this.owner.borderTopLeftRadius.setState(s,e,i),n instanceof Jt?this.owner.borderTopRightRadius.setLook(n,e,i):this.owner.borderTopRightRadius.setState(n,e,i),r instanceof Jt?this.owner.borderBottomRightRadius.setLook(r,e,i):this.owner.borderBottomRightRadius.setState(r,e,i),o instanceof Jt?this.owner.borderBottomLeftRadius.setLook(o,e,i):this.owner.borderBottomLeftRadius.setState(o,e,i)}})]),ni.defineGetter("borderTopLeftRadius",[Qe({propertyNames:"border-top-left-radius",valueType:l.Length,value:null})]),ni.defineGetter("borderTopRightRadius",[Qe({propertyNames:"border-top-right-radius",valueType:l.Length,value:null})]),ni.defineGetter("borderBottomRightRadius",[Qe({propertyNames:"border-bottom-right-radius",valueType:l.Length,value:null})]),ni.defineGetter("borderBottomLeftRadius",[Qe({propertyNames:"border-bottom-left-radius",valueType:l.Length,value:null})]),ni.defineGetter("borderSpacing",[Ye({propertyNames:"border-spacing",valueType:String})]),ni.defineGetter("borderStyle",[e.Fastener({get(){const t=this.owner.borderTopStyle.value,e=this.owner.borderRightStyle.value,i=this.owner.borderBottomStyle.value,s=this.owner.borderLeftStyle.value;return t===e&&e===i&&i===s?t:[t,e,i,s]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){Array.isArray(t)?1===t.length?(this.owner.borderTopStyle.setState(t[0],e,i),this.owner.borderRightStyle.setState(t[0],e,i),this.owner.borderBottomStyle.setState(t[0],e,i),this.owner.borderLeftStyle.setState(t[0],e,i)):2===t.length?(this.owner.borderTopStyle.setState(t[0],e,i),this.owner.borderRightStyle.setState(t[1],e,i),this.owner.borderBottomStyle.setState(t[0],e,i),this.owner.borderLeftStyle.setState(t[1],e,i)):3===t.length?(this.owner.borderTopStyle.setState(t[0],e,i),this.owner.borderRightStyle.setState(t[1],e,i),this.owner.borderBottomStyle.setState(t[2],e,i),this.owner.borderLeftStyle.setState(t[1],e,i)):4===t.length&&(this.owner.borderTopStyle.setState(t[0],e,i),this.owner.borderRightStyle.setState(t[1],e,i),this.owner.borderBottomStyle.setState(t[2],e,i),this.owner.borderLeftStyle.setState(t[3],e,i)):(this.owner.borderTopStyle.setState(t,e,i),this.owner.borderRightStyle.setState(t,e,i),this.owner.borderBottomStyle.setState(t,e,i),this.owner.borderLeftStyle.setState(t,e,i))}})]),ni.defineGetter("borderTopStyle",[Ye({propertyNames:"border-top-style",valueType:String})]),ni.defineGetter("borderRightStyle",[Ye({propertyNames:"border-right-style",valueType:String})]),ni.defineGetter("borderBottomStyle",[Ye({propertyNames:"border-bottom-style",valueType:String})]),ni.defineGetter("borderLeftStyle",[Ye({propertyNames:"border-left-style",valueType:String})]),ni.defineGetter("borderWidth",[e.Fastener({get(){const t=this.owner.borderTopWidth.value,e=this.owner.borderRightWidth.value,i=this.owner.borderBottomWidth.value,s=this.owner.borderLeftWidth.value;return r.Values.equal(t,e)&&r.Values.equal(e,i)&&r.Values.equal(i,s)?t:[t,e,i,s]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){let s,n,r,o;if(Array.isArray(t))if(1===t.length)s=t[0],n=t[0],r=t[0],o=t[0];else if(2===t.length)s=t[0],n=t[1],r=t[0],o=t[1];else if(3===t.length)s=t[0],n=t[1],r=t[2],o=t[1];else{if(4!==t.length)throw new TypeError(""+t);s=t[0],n=t[1],r=t[2],o=t[3]}else s=t,n=t,r=t,o=t;s instanceof Jt?this.owner.borderTopWidth.setLook(s,e,i):this.owner.borderTopWidth.setState(s,e,i),n instanceof Jt?this.owner.borderRightWidth.setLook(n,e,i):this.owner.borderRightWidth.setState(n,e,i),r instanceof Jt?this.owner.borderBottomWidth.setLook(r,e,i):this.owner.borderBottomWidth.setState(r,e,i),o instanceof Jt?this.owner.borderLeftWidth.setLook(o,e,i):this.owner.borderLeftWidth.setState(o,e,i)}})]),ni.defineGetter("borderTopWidth",[Qe({propertyNames:"border-top-width",valueType:l.Length,value:null})]),ni.defineGetter("borderRightWidth",[Qe({propertyNames:"border-right-width",valueType:l.Length,value:null})]),ni.defineGetter("borderBottomWidth",[Qe({propertyNames:"border-bottom-width",valueType:l.Length,value:null})]),ni.defineGetter("borderLeftWidth",[Qe({propertyNames:"border-left-width",valueType:l.Length,value:null})]),ni.defineGetter("bottom",[si({propertyNames:"bottom",valueType:l.Length,value:null,get pctUnit(){return ni.pctHeightUnit(this.owner.node)}})]),ni.defineGetter("boxShadow",[Ye({propertyNames:"box-shadow",valueType:vt,value:null})]),ni.defineGetter("boxSizing",[Ye({propertyNames:"box-sizing",valueType:String})]),ni.defineGetter("color",[Ye({propertyNames:"color",valueType:z,value:null})]),ni.defineGetter("cursor",[Ye({propertyNames:"cursor",valueType:String})]),ni.defineGetter("display",[Ye({propertyNames:"display",valueType:String})]),ni.defineGetter("filter",[Ye({propertyNames:"filter",valueType:String})]),ni.defineGetter("flexBasis",[Ye({propertyNames:"flex-basis",valueType:l.Length,value:null})]),ni.defineGetter("flexDirection",[Ye({propertyNames:"flex-direction",valueType:String})]),ni.defineGetter("flexGrow",[Ye({propertyNames:"flex-grow",valueType:Number})]),ni.defineGetter("flexShrink",[Ye({propertyNames:"flex-shrink",valueType:Number})]),ni.defineGetter("flexWrap",[Ye({propertyNames:"flex-wrap",valueType:Number})]),ni.defineGetter("font",[e.Fastener({get(){const t=this.owner.fontStyle.value,e=this.owner.fontVariant.value,i=this.owner.fontWeight.value,s=this.owner.fontStretch.value,n=this.owner.fontSize.value,r=this.owner.lineHeight.value,o=this.owner.fontFamily.value;return void 0===o?null:I.create(t,e,i,s,n,r,o)},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){if(null===t)return this.owner.fontStyle.setState(void 0,e,i),this.owner.fontVariant.setState(void 0,e,i),this.owner.fontWeight.setState(void 0,e,i),this.owner.fontStretch.setState(void 0,e,i),this.owner.fontSize.setState(null,e,i),this.owner.lineHeight.setState(null,e,i),void this.owner.fontFamily.setState(void 0,e,i);t=I.fromLike(t),this.owner.fontStyle.setState(t.style,e,i),this.owner.fontVariant.setState(t.variant,e,i),this.owner.fontWeight.setState(t.weight,e,i),this.owner.fontStretch.setState(t.stretch,e,i),this.owner.fontSize.setState(t.size,e,i),this.owner.lineHeight.setState(t.height,e,i),this.owner.fontFamily.setState(t.family,e,i)}})]),ni.defineGetter("fontFamily",[Ye({propertyNames:"font-family",valueType:V})]),ni.defineGetter("fontSize",[Qe({propertyNames:"font-size",valueType:l.Length,value:null})]),ni.defineGetter("fontStretch",[Ye({propertyNames:"font-stretch",valueType:String})]),ni.defineGetter("fontStyle",[Ye({propertyNames:"font-style",valueType:String})]),ni.defineGetter("fontVariant",[Ye({propertyNames:"font-variant",valueType:String})]),ni.defineGetter("fontWeight",[Ye({propertyNames:"font-weight",valueType:String})]),ni.defineGetter("height",[si({propertyNames:"height",valueType:l.Length,value:null,get pctUnit(){return ni.pctHeightUnit(this.owner.node)}})]),ni.defineGetter("justifyContent",[Ye({propertyNames:"justify-content",valueType:String})]),ni.defineGetter("left",[si({propertyNames:"left",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("lineHeight",[Qe({propertyNames:"line-height",valueType:l.Length,value:null})]),ni.defineGetter("margin",[e.Fastener({get(){const t=this.owner.marginTop.value,e=this.owner.marginRight.value,i=this.owner.marginBottom.value,s=this.owner.marginLeft.value;return r.Values.equal(t,e)&&r.Values.equal(e,i)&&r.Values.equal(i,s)?t:[t,e,i,s]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){let s,n,r,o;if(Array.isArray(t))if(1===t.length)s=t[0],n=t[0],r=t[0],o=t[0];else if(2===t.length)s=t[0],n=t[1],r=t[0],o=t[1];else if(3===t.length)s=t[0],n=t[1],r=t[2],o=t[1];else{if(4!==t.length)throw new TypeError(""+t);s=t[0],n=t[1],r=t[2],o=t[3]}else s=t,n=t,r=t,o=t;s instanceof Jt?this.owner.marginTop.setLook(s,e,i):this.owner.marginTop.setState(s,e,i),n instanceof Jt?this.owner.marginRight.setLook(n,e,i):this.owner.marginRight.setState(n,e,i),r instanceof Jt?this.owner.marginBottom.setLook(r,e,i):this.owner.marginBottom.setState(r,e,i),o instanceof Jt?this.owner.marginLeft.setLook(o,e,i):this.owner.marginLeft.setState(o,e,i)}})]),ni.defineGetter("marginTop",[si({propertyNames:"margin-top",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("marginRight",[si({propertyNames:"margin-right",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("marginBottom",[si({propertyNames:"margin-bottom",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("marginLeft",[si({propertyNames:"margin-left",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("maxHeight",[Qe({propertyNames:"max-height",valueType:l.Length,value:null})]),ni.defineGetter("maxWidth",[Qe({propertyNames:"max-width",valueType:l.Length,value:null})]),ni.defineGetter("minHeight",[Qe({propertyNames:"min-height",valueType:l.Length,value:null})]),ni.defineGetter("minWidth",[Qe({propertyNames:"min-width",valueType:l.Length,value:null})]),ni.defineGetter("opacity",[Ye({propertyNames:"opacity",valueType:Number})]),ni.defineGetter("order",[Ye({propertyNames:"order",valueType:Number})]),ni.defineGetter("outlineColor",[Ye({propertyNames:"outline-color",valueType:z,value:null})]),ni.defineGetter("outlineOffset",[Qe({propertyNames:"outline-offset",valueType:l.Length,value:null})]),ni.defineGetter("outlineStyle",[Ye({propertyNames:"outline-style",valueType:String})]),ni.defineGetter("outlineWidth",[Qe({propertyNames:"outline-width",valueType:l.Length,value:null})]),ni.defineGetter("overflow",[e.Fastener({get(){const t=this.owner.overflowX.value,e=this.owner.overflowY.value;return t===e?t:[t,e]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){Array.isArray(t)?1===t.length?(this.owner.overflowX.setState(t[0],e,i),this.owner.overflowY.setState(t[0],e,i)):2===t.length&&(this.owner.overflowX.setState(t[0],e,i),this.owner.overflowY.setState(t[1],e,i)):(this.owner.overflowX.setState(t,e,i),this.owner.overflowY.setState(t,e,i))}})]),ni.defineGetter("overflowX",[Ye({propertyNames:"overflow-x",valueType:String})]),ni.defineGetter("overflowY",[Ye({propertyNames:"overflow-y",valueType:String})]),ni.defineGetter("overflowScrolling",[Ye({propertyNames:"-webkit-overflow-scrolling",valueType:String})]),ni.defineGetter("overscrollBehavior",[e.Fastener({get(){const t=this.owner.overscrollBehaviorX.value,e=this.owner.overscrollBehaviorY.value;return t===e?t:[t,e]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){Array.isArray(t)?1===t.length?(this.owner.overscrollBehaviorX.setState(t[0],e,i),this.owner.overscrollBehaviorY.setState(t[0],e,i)):2===t.length&&(this.owner.overscrollBehaviorX.setState(t[0],e,i),this.owner.overscrollBehaviorY.setState(t[1],e,i)):(this.owner.overscrollBehaviorX.setState(t,e,i),this.owner.overscrollBehaviorY.setState(t,e,i))}})]),ni.defineGetter("overscrollBehaviorX",[Ye({propertyNames:"overscroll-behavior-x",valueType:String})]),ni.defineGetter("overscrollBehaviorY",[Ye({propertyNames:"overscroll-behavior-y",valueType:String})]),ni.defineGetter("padding",[e.Fastener({get(){const t=this.owner.paddingTop.value,e=this.owner.paddingRight.value,i=this.owner.paddingBottom.value,s=this.owner.paddingLeft.value;return r.Values.equal(t,e)&&r.Values.equal(e,i)&&r.Values.equal(i,s)?t:[t,e,i,s]},set(t,i){return this.setState(t,i,e.Affinity.Extrinsic),this.owner},setIntrinsic(t,i){return this.setState(t,i,e.Affinity.Intrinsic),this.owner},setState(t,e,i){let s,n,r,o;if(Array.isArray(t))if(1===t.length)s=t[0],n=t[0],r=t[0],o=t[0];else if(2===t.length)s=t[0],n=t[1],r=t[0],o=t[1];else if(3===t.length)s=t[0],n=t[1],r=t[2],o=t[1];else{if(4!==t.length)throw new TypeError(""+t);s=t[0],n=t[1],r=t[2],o=t[3]}else s=t,n=t,r=t,o=t;s instanceof Jt?this.owner.paddingTop.setLook(s,e,i):this.owner.paddingTop.setState(s,e,i),n instanceof Jt?this.owner.paddingRight.setLook(n,e,i):this.owner.paddingRight.setState(n,e,i),r instanceof Jt?this.owner.paddingBottom.setLook(r,e,i):this.owner.paddingBottom.setState(r,e,i),o instanceof Jt?this.owner.paddingLeft.setLook(o,e,i):this.owner.paddingLeft.setState(o,e,i)}})]),ni.defineGetter("paddingTop",[si({propertyNames:"padding-top",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("paddingRight",[si({propertyNames:"padding-right",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("paddingBottom",[si({propertyNames:"padding-bottom",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("paddingLeft",[si({propertyNames:"padding-left",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("pointerEvents",[Ye({propertyNames:"pointer-events",valueType:String})]),ni.defineGetter("position",[Ye({propertyNames:"position",valueType:String})]),ni.defineGetter("right",[si({propertyNames:"right",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("textAlign",[Ye({propertyNames:"text-align",valueType:String})]),ni.defineGetter("textDecorationColor",[Ye({propertyNames:"text-decoration-color",valueType:z,value:null})]),ni.defineGetter("textDecorationLine",[Ye({propertyNames:"text-decoration-line",valueType:String})]),ni.defineGetter("textDecorationStyle",[Ye({propertyNames:"text-decoration-style",valueType:String})]),ni.defineGetter("textOverflow",[Ye({propertyNames:"text-overflow",valueType:String})]),ni.defineGetter("textTransform",[Ye({propertyNames:"text-transform",valueType:String})]),ni.defineGetter("top",[si({propertyNames:"top",valueType:l.Length,value:null,get pctUnit(){return ni.pctHeightUnit(this.owner.node)}})]),ni.defineGetter("touchAction",[Ye({propertyNames:"touch-action",valueType:String})]),ni.defineGetter("transform",[Ye({propertyNames:"transform",valueType:l.Transform,value:null})]),ni.defineGetter("userSelect",[Ye({propertyNames:["user-select","-webkit-user-select","-moz-user-select","-ms-user-select"],valueType:String})]),ni.defineGetter("verticalAlign",[Ye({propertyNames:"vertical-align",valueType:String})]),ni.defineGetter("visibility",[Ye({propertyNames:"visibility",valueType:String})]),ni.defineGetter("whiteSpace",[Ye({propertyNames:"white-space",valueType:String})]),ni.defineGetter("width",[si({propertyNames:"width",valueType:l.Length,value:null,get pctUnit(){return ni.pctWidthUnit(this.owner.node)}})]),ni.defineGetter("zIndex",[Ye({propertyNames:"z-index",valueType:Number})]);const ri=e.Fastener.extend("CssScope",{get fastenerType(){return ri},onUnbindInlet(t){super.onUnbindInlet(t),this.detachCss()},attachOutlet(t){let e=this.outlets;null===e&&(e=new Set,this.outlets=e),e.add(t)},detachOutlet(t){const e=this.outlets;null!==e&&e.delete(t)},decohereOutlets(){const t=this.outlets;if(null!==t)for(const e of t)e.decohere(this)},getOutletCss(t){return this.css},get inletCss(){const t=this.inlet;return t instanceof ri?t.getOutletCss(this):null},getInletCss(){const t=this.inletCss;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="inlet css",new TypeError(e)}return t},transformInletCss:t=>null,getCss(){const t=this.css;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="css",new TypeError(e)}return t},setCss(t){const e=this.css;return e===t?(this.setCoherent(!0),e):(null!==e&&(this.css=null,this.willDetachCss(e),this.onDetachCss(e),this.deinitCss(e),this.didDetachCss(e)),null!==t&&(this.css=t,this.willAttachCss(t),this.onAttachCss(t),this.initCss(t),this.didAttachCss(t)),this.setCoherent(!0),this.decohereOutlets(),e)},attachCss(t){const e=this.css;return e===t||(null!==e&&(this.css=null,this.willDetachCss(e),this.onDetachCss(e),this.deinitCss(e),this.didDetachCss(e)),this.css=t,this.willAttachCss(t),this.onAttachCss(t),this.initCss(t),this.didAttachCss(t),this.setCoherent(!0),this.decohereOutlets()),t},initCss(t){},willAttachCss(t){},onAttachCss(t){},didAttachCss(t){},detachCss(){const t=this.css;return null===t||(this.css=null,this.willDetachCss(t),this.onDetachCss(t),this.deinitCss(t),this.didDetachCss(t),this.setCoherent(!0),this.decohereOutlets()),t},deinitCss(t){},willDetachCss(t){},onDetachCss(t){},didDetachCss(t){},applyTheme(t,e,i){const s=this.outlets;if(null!==s)for(const n of s)n instanceof ri&&n.applyTheme(t,e,i)},recohere(t){this.setCoherentTime(t);const i=this.inlet;if(i instanceof ri){if(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)){const t=i.getOutletCss(this);null!==t&&null===this.css?this.setCss(this.transformInletCss(t)):null===t&&null!==this.css?this.setCss(null):this.setDerived(!1)}}else this.setDerived(!1)}},{construct(t,e){return(t=super.construct(t,e)).outlets=null,t.css=null,t}}),oi=ri.extend("StyleSheet",{get fastenerType(){return oi},transformInletCss:t=>t instanceof CSSStyleSheet?t:null},{construct(t,e){return t=super.construct(t,e)}}),li=ri.extend("CssRule",{get fastenerType(){return li},selector:"*",get cssText(){return this.selector+" {}"},transformInletCss(t){return t instanceof CSSStyleSheet||t instanceof CSSGroupingRule?this.createRule(t):null},createRule(t){const e=t.insertRule(this.cssText);return t.cssRules.item(e)}},{construct(t,e){return t=super.construct(t,e)}}),ai=li.extend("StyleRule",{get fastenerType(){return ai},selector:"*",transformInletCss(t){return null!==t&&(t.RANDOM_MARKER_ID=Math.random()),t instanceof CSSStyleRule?t:t instanceof CSSStyleSheet||t instanceof CSSGroupingRule?this.createRule(t):null},createRule(t){const e=t.insertRule(this.cssText),i=t.cssRules.item(e);if(!(i instanceof CSSStyleRule))throw new TypeError("not a style rule: "+i);return i},onAttachCss(t){this.mounted&&this.style.applyStyles()},getStyle(t){const e=this.css;if(null===e)return;if("undefined"!=typeof CSSStyleValue){const i=e.styleMap;if("string"==typeof t)return i.get(t);for(let e=0;e<t.length;e+=1){const s=i.get(t[e]);if(void 0!==s)return s}return""}const i=e.style;if("string"==typeof t)return i.getPropertyValue(t);for(let e=0;e<t.length;e+=1){const s=i.getPropertyValue(t[e]);if(0!==s.length)return s}return""},setStyle(t,e,i){const s=this.css;if(null===s)return this;if(this.willSetStyle(t,e,i),"undefined"!=typeof CSSStyleValue)if(null!=e){const n=At(e);if(null!==n)try{s.styleMap.set(t,n)}catch(t){}else s.style.setProperty(t,Mt(e),i)}else try{s.styleMap.delete(t)}catch(t){}else null!=e?s.style.setProperty(t,Mt(e),i):s.style.removeProperty(t);return this.onSetStyle(t,e,i),this.didSetStyle(t,e,i),this},willSetStyle(t,e,i){},onSetStyle(t,e,i){},didSetStyle(t,e,i){},constraint(t,e,i,s){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.constraint(t,e,i,s)},hasConstraint(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.hasConstraint(t)},addConstraint(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.addConstraint(t)},removeConstraint(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.removeConstraint(t)},constraintVariable(t,e,i){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.constraintVariable(t,e,i)},hasConstraintVariable(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");return this.owner.hasConstraintVariable(t)},addConstraintVariable(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.addConstraintVariable(t)},removeConstraintVariable(t){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.removeConstraintVariable(t)},setConstraintVariable(t,e){if(!h.ConstraintScope[Symbol.hasInstance](this.owner))throw new Error("no constraint scope");this.owner.setConstraintVariable(t,e)},getLook(t,e){if(Xt[Symbol.hasInstance](this.owner))return this.owner.getLook(t,e)},getLookOr(t,e,i){return Xt[Symbol.hasInstance](this.owner)?2===arguments.length?this.owner.getLookOr(t,e):this.owner.getLookOr(t,e,i):2===arguments.length?e:i},applyTheme(t,i,s){const n=e.FastenerContext.getMetaclass(this);if(null===n)return;s=null==s||!0===s?t.getOr(Jt.timing,ae.ambient,!1):r.Timing.fromLike(s);const o=n.slots;for(let e=0;e<o.length;e+=1){const n=this[o[e]];void 0!==n&&"applyTheme"in n&&n.applyTheme(t,i,s)}super.applyTheme(t,i,s)},didMount(){super.didMount(),null!==this.css&&this.style.applyStyles()}},{construct(t,e){return t=super.construct(t,e),ai.initFasteners(t),t}});ai.defineField("style",[ni({})]);const hi=li.extend("MediaRule",{get fastenerType(){return hi},selector:"@media",transformInletCss(t){return t instanceof CSSMediaRule?t:t instanceof CSSStyleSheet||t instanceof CSSGroupingRule?this.createRule(t):null},createRule(t){const e=t.insertRule(this.cssText),i=t.cssRules.item(e);if(!(i instanceof CSSMediaRule))throw new TypeError("not a media rule: "+i);return i}},{construct(t,e){return t=super.construct(t,e)}}),di=e.Fastener.extend("ClassList",{get fastenerType(){return di},get value(){return this.owner.node.classList.value},get(){return this.owner.node.classList},set(t){return this.add(...t)},setIntrinsic(t){return this.add(...t)},contains(t){return this.owner.node.classList.contains(t)},add(...t){const e=this.owner.node.classList;for(let i=0;i<t.length;i+=1){const s=t[i];e.contains(s)||(this.willAdd(s),e.add(s),this.onAdd(s),this.didAdd(s))}return this.owner},willAdd(t){},onAdd(t){},didAdd(t){},remove(...t){const e=this.owner.node.classList;for(let i=0;i<t.length;i+=1){const s=t[i];e.contains(s)&&(this.willRemove(s),e.remove(s),this.onRemove(s),this.didRemove(s))}return this.owner},willRemove(t){},onRemove(t){},didRemove(t){},replace(t,e){const i=this.owner.node.classList;return!!i.contains(t)&&(this.willRemove(t),i.remove(t),this.onRemove(t),this.didRemove(t),this.willAdd(e),i.add(e),this.onAdd(e),this.didAdd(e),!0)},toggle(t,e){const i=this.owner.node.classList;return!0===e?(i.contains(t)||(this.willAdd(t),i.add(t),this.onAdd(t),this.didAdd(t)),!0):!1===e?(i.contains(t)&&(this.willRemove(t),i.remove(t),this.onRemove(t),this.didRemove(t)),!1):i.contains(t)?(this.willRemove(t),i.remove(t),this.onRemove(t),this.didRemove(t),!1):(this.willAdd(t),i.add(t),this.onAdd(t),this.didAdd(t),!0)},forEach(t,e){const i=this.owner.node.classList;for(let s=0;s<i.length;s+=1){const n=i[s],r=t.call(e,n,s,this);if(void 0!==r)return r}}}),ui={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"textContent")},ci=e.Animator.extend("TextAnimator",{get textContent(){if(ui[Symbol.hasInstance](this.owner))return this.owner.textContent},set textContent(t){ui[Symbol.hasInstance](this.owner)&&(this.owner.textContent=t)},onSetValue(t,e){ui[Symbol.hasInstance](this.owner)&&(this.owner.textContent=this.format(t)),super.onSetValue(t,e)},format:t=>String(t)},{construct(t,e){return(t=super.construct(t,e)).format=Object.getPrototypeOf(t).format,t}});let fi=(()=>{var t;let e,i=ue,s=[];return t=class extends i{constructor(e){if(super(),this.node=void u(this,s),this.node=e,t.nodeMap.has(e))throw new Error(e+" already has an associated view");t.nodeMap.set(e,this)}get textContent(){return this.node.textContent}set textContent(t){void 0===t&&(t=null),this.node.textContent=t}get text(){return ci.getter()}setChild(e,i){i instanceof Node?i=t.fromNode(i):null!==i&&(i=ue.fromLike(i));const s=this.getChild(e);let n;if(null!==s&&null!==i&&s!==i){if(i.remove(),n=s.nextSibling,0==(s.flags&ue.RemovingFlag)&&(s.setFlags(s.flags|ue.RemovingFlag),this.willRemoveChild(s),s.detachParent(this),this.removeChildMap(s),this.onRemoveChild(s),this.didRemoveChild(s),s.setKey(void 0),s.setFlags(s.flags&~ue.RemovingFlag)),i.setFlags(i.flags|ue.InsertingFlag),i.setKey(s.key),this.willInsertChild(i,n),i instanceof t)if(s instanceof t)this.node.replaceChild(i.node,s.node);else if(null!==n){let e=null,s=n;do{if(s instanceof t){e=s.node;break}s=s.nextSibling}while(null!==s);this.node.insertBefore(i.node,e)}else this.node.appendChild(i.node);else s instanceof t&&this.node.removeChild(s.node);this.insertChildMap(i),i.attachParent(this,n),this.onInsertChild(i,n),this.didInsertChild(i,n),i.cascadeInsert(),i.setFlags(i.flags&~ue.InsertingFlag)}else if((i!==s||null!==i&&i.key!==e)&&(null!==s?(n=s.nextSibling,0==(s.flags&ue.RemovingFlag)&&(s.setFlags(s.flags|ue.RemovingFlag),this.willRemoveChild(s),s.detachParent(this),this.removeChildMap(s),s instanceof t&&this.node.removeChild(s.node),this.onRemoveChild(s),this.didRemoveChild(s),s.setKey(void 0),s.setFlags(s.flags&~ue.RemovingFlag))):n=null,null!==i)){if(i.remove(),i.setFlags(i.flags|ue.InsertingFlag),i.setKey(e),this.willInsertChild(i,n),i instanceof t){let e=null;if(null!==n){let i=n;do{if(i instanceof t){e=i.node;break}i=i.nextSibling}while(null!==i)}this.node.insertBefore(i.node,e)}this.insertChildMap(i),i.attachParent(this,n),this.onInsertChild(i,n),this.didInsertChild(i,n),i.cascadeInsert(),i.setFlags(i.flags&~ue.InsertingFlag)}return s}appendChild(e,i){return(e=e instanceof Node?t.fromNode(e):ue.fromLike(e)).remove(),void 0!==i&&this.removeChild(i),e.setFlags(e.flags|ue.InsertingFlag),e.setKey(i),this.willInsertChild(e,null),e instanceof t&&this.node.appendChild(e.node),this.insertChildMap(e),e.attachParent(this,null),this.onInsertChild(e,null),this.didInsertChild(e,null),e.cascadeInsert(),e.setFlags(e.flags&~ue.InsertingFlag),e}prependChild(e,i){(e=e instanceof Node?t.fromNode(e):ue.fromLike(e)).remove(),void 0!==i&&this.removeChild(i);const s=this.firstChild;return e.setFlags(e.flags|ue.InsertingFlag),e.setKey(i),this.willInsertChild(e,s),e instanceof t&&this.node.insertBefore(e.node,this.node.firstChild),this.insertChildMap(e),e.attachParent(this,s),this.onInsertChild(e,s),this.didInsertChild(e,s),e.cascadeInsert(),e.setFlags(e.flags&~ue.InsertingFlag),e}insertChild(e,i,s){let n,r;if((i instanceof ue&&i.parent!==this||i instanceof Node&&i.parentNode!==this.node)&&(i=null),(e=e instanceof Node?t.fromNode(e):ue.fromLike(e)).remove(),void 0!==s&&this.removeChild(s),i instanceof Node){n=null,r=i;let e=i;do{const i=t.get(e);if(null!==i){n=i;break}e=e.nextSibling}while(null!==e)}else n=i,r=null;if(e.setFlags(e.flags|ue.InsertingFlag),e.setKey(s),this.willInsertChild(e,n),e instanceof t){if(null===r&&null!==n){let e=n;do{if(e instanceof t){r=e.node;break}e=e.nextSibling}while(null!==e)}this.node.insertBefore(e.node,r)}return this.insertChildMap(e),e.attachParent(this,n),this.onInsertChild(e,n),this.didInsertChild(e,n),e.cascadeInsert(),e.setFlags(e.flags&~ue.InsertingFlag),e}injectChild(e,i,s){if(i instanceof ue&&i.parent!==this||i instanceof Node&&i.parentNode!==this.node)throw new TypeError(""+i);if(e=t.fromLike(e),void 0!==s&&this.removeChild(s),i instanceof Node){let e=i;i=null;do{const s=t.get(e);if(null!==s){i=s;break}e=e.nextSibling}while(null!==e)}return e.setFlags(e.flags|ue.InsertingFlag),e.setKey(s),this.willInsertChild(e,i),this.insertChildMap(e),e.attachParent(this,i),this.onInsertChild(e,i),this.didInsertChild(e,i),e.cascadeInsert(),e.setFlags(e.flags&~ue.InsertingFlag),e}replaceChild(e,i){if(i.parent!==this)throw new TypeError(""+i);if((e=e instanceof Node?t.fromNode(e):ue.fromLike(e))===i)return i;e.remove();const s=i.nextSibling;if(0==(i.flags&ue.RemovingFlag)&&(i.setFlags(i.flags|ue.RemovingFlag),this.willRemoveChild(i),i.detachParent(this),this.removeChildMap(i),this.onRemoveChild(i),this.didRemoveChild(i),i.setKey(void 0),i.setFlags(i.flags&~ue.RemovingFlag)),e.setFlags(e.flags|ue.InsertingFlag),e.setKey(i.key),this.willInsertChild(e,s),e instanceof t)if(i instanceof t)this.node.replaceChild(e.node,i.node);else if(null!==s){let i=null,n=s;do{if(n instanceof t){i=n.node;break}n=n.nextSibling}while(null!==n);this.node.insertBefore(e.node,i)}else this.node.appendChild(e.node);else i instanceof t&&this.node.removeChild(i.node);return this.insertChildMap(e),e.attachParent(this,s),this.onInsertChild(e,s),this.didInsertChild(e,s),e.cascadeInsert(),e.setFlags(e.flags&~ue.InsertingFlag),i}removeChild(e){let i;if("string"==typeof e){if(i=this.getChild(e),null===i)return null}else if(e instanceof Node){if(e.parentNode!==this.node)throw new Error("not a child node");const s=t.get(e);if(null===s)return this.node.removeChild(e),e;i=s}else if(i=e,i.parent!==this)throw new Error("not a child");return 0==(i.flags&ue.RemovingFlag)&&(i.setFlags(i.flags|ue.RemovingFlag),this.willRemoveChild(i),i.detachParent(this),this.removeChildMap(i),i instanceof t&&this.node.removeChild(i.node),this.onRemoveChild(i),this.didRemoveChild(i),i.setKey(void 0),i.setFlags(i.flags&~ue.RemovingFlag)),i}removeChildren(){let e;for(;e=this.lastChild,null!==e;){if(0!=(e.flags&ue.RemovingFlag))throw new Error("inconsistent removeChildren");this.willRemoveChild(e),e.detachParent(this),this.removeChildMap(e),e instanceof t&&this.node.removeChild(e.node),this.onRemoveChild(e),this.didRemoveChild(e),e.setKey(void 0),e.setFlags(e.flags&~ue.RemovingFlag)}}reinsertChild(e,i){if(e.parent!==this)throw new Error("not a child");if(null!==i&&i.parent!==this)throw new Error("reinsert target is not a child");e.nextSibling!==i&&(this.willReinsertChild(e,i),e instanceof t&&(this.node.removeChild(e.node),this.node.insertBefore(e.node,i instanceof t?i.node:null)),e.reattachParent(i),this.onReinsertChild(e,i),this.didReinsertChild(e,i))}static isRootView(e){for(;;){const i=e.parentNode;if(null===i)return!0;if(null!==t.get(i))return!1;e=i}}static isNodeMounted(t){let e=t.isConnected;if("boolean"!=typeof e){const i=t.ownerDocument;if(null===i)e=!1;else{e=0==(i.compareDocumentPosition(t)&t.DOCUMENT_POSITION_DISCONNECTED)}}return e}static mount(e){if(null!==e.parent)return;const i=t.get(e.node.parentNode);if(null===i)return void e.mount();let s=null,n=e.node.nextSibling;for(;null!==n&&(s=t.get(n),null===s);)n=n.nextSibling;e.setFlags(e.flags|ue.InsertingFlag),e.attachParent(i,s),e.cascadeInsert(),e.setFlags(e.flags&~ue.InsertingFlag)}mount(){!this.mounted&&t.isNodeMounted(this.node)&&t.isRootView(this.node)&&(this.setFlags(this.flags|ue.InsertingFlag),this.cascadeMount(),this.cascadeInsert(),this.setFlags(this.flags&~ue.InsertingFlag))}get parentTransform(){return l.Transform.identity()}get clientBounds(){const t=document.createRange();t.selectNode(this.node);const e=t.getBoundingClientRect();return t.detach(),new l.R2Box(e.left,e.top,e.right,e.bottom)}get pageBounds(){const t=document.createRange();t.selectNode(this.node);const e=t.getBoundingClientRect();t.detach();const i=window.pageXOffset,s=window.pageYOffset;return new l.R2Box(e.left+i,e.top+s,e.right+i,e.bottom+s)}dispatchEvent(t){return this.node.dispatchEvent(t)}addEventListener(t,e,i){this.node.addEventListener(t,e,i)}removeEventListener(t,e,i){this.node.removeEventListener(t,e,i)}static get(e){const i=null!=e?t.nodeMap.get(e):void 0;if(void 0===i)return null;if(!(i instanceof this))throw new TypeError(e+" not an instance of "+this.name);return i}static fromLike(t){if(null==t)return t;if(t instanceof ue){if(!(t instanceof this))throw new TypeError(t+" not an instance of "+this);return t}if(t instanceof Node)return this.fromNode(t);if(r.Creatable[Symbol.hasInstance](t))return t.create();throw new TypeError(""+t)}static fromNode(e){let i=this.get(e);return null===i&&(i=e instanceof HTMLElement?new wi(e):e instanceof SVGElement?new Ti(e):e instanceof Element?new mi(e):e instanceof Text?new pi(e):new t(e),this.mount(i)),i}},(()=>{var n;const r="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(n=i[Symbol.metadata])&&void 0!==n?n:null):void 0;e=[ci({})],d(t,null,e,{kind:"getter",name:"text",static:!1,private:!1,access:{has:t=>"text"in t,get:t=>t.text},metadata:r},null,s),r&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})})(),t.nodeMap=new WeakMap,t})();class pi extends fi{constructor(t){super(t)}static create(t){void 0===t&&(t="");return new this(document.createTextNode(t))}static fromLike(t){if(null==t)return t;if(t instanceof ue){if(!(t instanceof this))throw new TypeError(t+" not an instance of "+this);return t}if(t instanceof Text)return this.fromNode(t);if(r.Creatable[Symbol.hasInstance](t))return t.create();if("string"==typeof t)return this.create(t);throw new TypeError(""+t)}static fromNode(t){let e=this.get(t);return null===e&&(e=new this(t),this.mount(e)),e}}const gi=e.Fastener.extend("ElementAttributes",{get fastenerType(){return gi},set(t,i){for(const s in t){const n=t[s],r=this[s];if(null==r)throw new Error("unknown property "+s);if(void 0===r.set)throw new Error("unsettable property "+s);r instanceof e.Animator?r.set(n,i):r.set(n)}return this.owner},setIntrinsic(t,i){for(const s in t){const n=t[s],r=this[s];if(null==r)throw new Error("unknown property "+s);if(void 0===r.setIntrinsic)throw new Error("unsettable property "+s);r instanceof e.Animator?r.setIntrinsic(n,i):r.setIntrinsic(n)}return this.owner},getAttribute(t){return this.owner.getAttribute(t)},setAttribute(t,e){return this.owner.setAttribute(t,e),this}},{construct(t,e){return t=super.construct(t,e),gi.initFasteners(t),t}});gi.defineGetter("id",[qe({attributeName:"id",valueType:String})]);let mi=(()=>{var t;let i,s,n,o,a,h,c=fi,f=[];return t=class extends c{constructor(t){super(t),this.willSetAttributeObservers=void u(this,f),this.willSetAttributeObservers=null,this.didSetAttributeObservers=null,this.willSetStyleObservers=null,this.didSetStyleObservers=null}get attributes(){return gi.getter()}getAttribute(t){return this.node.getAttribute(t)}setAttribute(t,e){return this.willSetAttribute(t,e),null!=e?this.node.setAttribute(t,xt(e)):this.node.removeAttribute(t),this.onSetAttribute(t,e),this.didSetAttribute(t,e),this}willSetAttribute(t,e){const i=this.willSetAttributeObservers;if(null!==i)for(const s of i)s.viewWillSetAttribute(t,e,this)}onSetAttribute(t,e){}didSetAttribute(t,e){const i=this.didSetAttributeObservers;if(null!==i)for(const s of i)s.viewDidSetAttribute(t,e,this)}get style(){return ni.getter()}getStyle(t){if("undefined"==typeof CSSStyleValue){const e=this.node.style;if("string"==typeof t)return e.getPropertyValue(t);for(let i=0;i<t.length;i+=1){const s=e.getPropertyValue(t[i]);if(0!==s.length)return s}return""}{const e=this.node.attributeStyleMap;if("string"!=typeof t){for(let i=0;i<t.length;i+=1){const s=e.get(t[i]);if(void 0!==s)return s}return""}try{return e.get(t)}catch(t){return}}}setStyle(t,e,i){if(this.willSetStyle(t,e,i),"undefined"!=typeof CSSStyleValue)if(null!=e){const s=At(e);if(null!==s)try{this.node.attributeStyleMap.set(t,s)}catch(t){}else this.node.style.setProperty(t,Mt(e),i)}else try{this.node.attributeStyleMap.delete(t)}catch(t){}else null!=e?this.node.style.setProperty(t,Mt(e),i):this.node.style.removeProperty(t);return this.onSetStyle(t,e,i),this.didSetStyle(t,e,i),this}willSetStyle(t,e,i){const s=this.willSetStyleObservers;if(null!==s)for(const n of s)n.viewWillSetStyle(t,e,i,this)}onSetStyle(t,e,i){}didSetStyle(t,e,i){const s=this.didSetStyleObservers;if(null!==s)for(const n of s)n.viewDidSetStyle(t,e,i,this)}get classList(){return di.getter()}detectTheme(){let t,e=this.node.getAttribute("swim-theme");if(""===e&&(e="auto"),null!==e){if("auto"===e){t="dark"===this.viewport.getService().colorScheme.value?he.dark:he.light}else t=e.indexOf(".")<0?he[e]:xi.eval(e);if(!(t instanceof Yt))throw new TypeError("unknown swim-theme: "+e);this.theme.set(t)}}get viewport(){return e.Provider.getter()}get dom(){return e.Provider.getter()}get modal(){return e.Provider.getter()}get clientBounds(){const t=this.node.getBoundingClientRect();return new l.R2Box(t.left,t.top,t.right,t.bottom)}get pageBounds(){const t=this.node.getBoundingClientRect(),e=window.pageXOffset,i=window.pageYOffset;return new l.R2Box(t.left+e,t.top+i,t.right+e,t.bottom+i)}addEventListener(t,e,i){this.node.addEventListener(t,e,i)}removeEventListener(t,e,i){this.node.removeEventListener(t,e,i)}onObserve(t){super.onObserve(t),void 0!==t.viewWillSetAttribute&&(null===this.willSetAttributeObservers&&(this.willSetAttributeObservers=new Set),this.willSetAttributeObservers.add(t)),void 0!==t.viewDidSetAttribute&&(null===this.didSetAttributeObservers&&(this.didSetAttributeObservers=new Set),this.didSetAttributeObservers.add(t)),void 0!==t.viewWillSetStyle&&(null===this.willSetStyleObservers&&(this.willSetStyleObservers=new Set),this.willSetStyleObservers.add(t)),void 0!==t.viewDidSetStyle&&(null===this.didSetStyleObservers&&(this.didSetStyleObservers=new Set),this.didSetStyleObservers.add(t))}onUnobserve(t){super.onUnobserve(t),void 0!==t.viewWillSetAttribute&&null!==this.willSetAttributeObservers&&this.willSetAttributeObservers.delete(t),void 0!==t.viewDidSetAttribute&&null!==this.didSetAttributeObservers&&this.didSetAttributeObservers.delete(t),void 0!==t.viewWillSetStyle&&null!==this.willSetStyleObservers&&this.willSetStyleObservers.delete(t),void 0!==t.viewDidSetStyle&&null!==this.didSetStyleObservers&&this.didSetStyleObservers.delete(t)}onMount(){super.onMount(),this.node.hasAttribute("swim-theme")&&(this.detectTheme(),this.viewport.getService().observe(this.viewport))}onUnmount(){super.onUnmount(),this.node.hasAttribute("swim-theme")&&this.viewport.getService().unobserve(this.viewport)}static create(){let t=this.tag;return void 0===t&&(t="div"),this.fromTag(t)}static fromLike(t){if(null==t)return t;if(t instanceof ue){if(!(t instanceof this))throw new TypeError(t+" not an instance of "+this);return t}if(t instanceof Element)return this.fromNode(t);if(r.Creatable[Symbol.hasInstance](t))return t.create();if("string"==typeof t)return this.fromTag(t);throw new TypeError(""+t)}static fromNode(e){let i=this.get(e);return null===i&&(i=e instanceof HTMLElement?new wi(e):e instanceof SVGElement?new Ti(e):new t(e),this.mount(i)),i}static fromTag(t,e){let i;return void 0===e&&"svg"===t&&(e=Ti.namespace),i=void 0!==e?document.createElementNS(e,t):document.createElement(t),this.fromNode(i)}},(()=>{var r;const l="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(r=c[Symbol.metadata])&&void 0!==r?r:null):void 0;i=[gi({})],s=[ni({})],n=[di({})],o=[e.Provider({extends:!0,observes:!0,serviceDidSetViewportColorScheme(t){this.owner.detectTheme()}})],a=[e.Provider({get serviceType(){return xi},mountRootService(t){super.mountRootService(t),t.roots.addView(this.owner)},unmountRootService(t){super.unmountService(t),t.roots.removeView(this.owner)}})],h=[e.Provider({get serviceType(){return Ai},present(t,e){void 0===t&&Mi[Symbol.hasInstance](this.owner)&&(t=this.owner),void 0!==t&&this.getService().presentModal(t,e)},dismiss(t){void 0===t&&Mi[Symbol.hasInstance](this.owner)&&(t=this.owner),void 0!==t&&this.getService().dismissModal(t)},toggle(t,e){void 0===t&&Mi[Symbol.hasInstance](this.owner)&&(t=this.owner),void 0!==t&&this.getService().toggleModal(t,e)}})],d(t,null,i,{kind:"getter",name:"attributes",static:!1,private:!1,access:{has:t=>"attributes"in t,get:t=>t.attributes},metadata:l},null,f),d(t,null,s,{kind:"getter",name:"style",static:!1,private:!1,access:{has:t=>"style"in t,get:t=>t.style},metadata:l},null,f),d(t,null,n,{kind:"getter",name:"classList",static:!1,private:!1,access:{has:t=>"classList"in t,get:t=>t.classList},metadata:l},null,f),d(t,null,o,{kind:"getter",name:"viewport",static:!1,private:!1,access:{has:t=>"viewport"in t,get:t=>t.viewport},metadata:l},null,f),d(t,null,a,{kind:"getter",name:"dom",static:!1,private:!1,access:{has:t=>"dom"in t,get:t=>t.dom},metadata:l},null,f),d(t,null,h,{kind:"getter",name:"modal",static:!1,private:!1,access:{has:t=>"modal"in t,get:t=>t.modal},metadata:l},null,f),l&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})})(),t})();const vi=gi.extend("HtmlAttributes",{},{construct(t,e){return t=super.construct(t,e),vi.initFasteners(t),t}});vi.defineGetter("autocomplete",[qe({attributeName:"autocomplete",valueType:String})]),vi.defineGetter("checked",[qe({attributeName:"checked",valueType:Boolean})]),vi.defineGetter("colspan",[qe({attributeName:"colspan",valueType:Number})]),vi.defineGetter("disabled",[qe({attributeName:"disabled",valueType:Boolean})]),vi.defineGetter("href",[qe({attributeName:"href",valueType:String})]),vi.defineGetter("placeholder",[qe({attributeName:"placeholder",valueType:String})]),vi.defineGetter("rowspan",[qe({attributeName:"rowspan",valueType:Number})]),vi.defineGetter("selected",[qe({attributeName:"selected",valueType:Boolean})]),vi.defineGetter("title",[qe({attributeName:"title",valueType:String})]),vi.defineGetter("type",[qe({attributeName:"type",valueType:String})]),vi.defineGetter("value",[qe({attributeName:"value",valueType:String})]);let wi=(()=>{var t;let i,s=mi,n=[];return t=class extends s{constructor(t){super(t),u(this,n)}get attributes(){return vi.getter()}setChild(e,i){return"string"==typeof i&&(i=t.fromTag(i)),super.setChild(e,i)}appendChild(e,i){return"string"==typeof e&&(e=t.fromTag(e)),super.appendChild(e,i)}prependChild(e,i){return"string"==typeof e&&(e=t.fromTag(e)),super.prependChild(e,i)}insertChild(e,i,s){return"string"==typeof e&&(e=t.fromTag(e)),super.insertChild(e,i,s)}replaceChild(e,i){return"string"==typeof e&&(e=t.fromTag(e)),super.replaceChild(e,i)}onApplyTheme(t,e,i){super.onApplyTheme(t,e,i),this.node.hasAttribute("swim-theme")&&this.applyRootTheme(t,e,i)}applyRootTheme(t,i,s){const n=t.getOr(Jt.font,ae.ambient,null);null!==n&&(void 0!==n.style&&this.style.fontStyle.setState(n.style,void 0,e.Affinity.Transient),void 0!==n.variant&&this.style.fontVariant.setState(n.variant,void 0,e.Affinity.Transient),void 0!==n.weight&&this.style.fontWeight.setState(n.weight,void 0,e.Affinity.Transient),void 0!==n.stretch&&this.style.fontStretch.setState(n.stretch,void 0,e.Affinity.Transient),null!==n.size&&this.style.fontSize.setState(n.size,void 0,e.Affinity.Transient),null!==n.height&&this.style.lineHeight.setState(n.height,void 0,e.Affinity.Transient),this.style.fontFamily.setState(n.family,void 0,e.Affinity.Transient)),this.style.backgroundColor.setIntrinsic(t.getOr(Jt.backgroundColor,ae.ambient,null),s),this.style.color.setIntrinsic(t.getOr(Jt.textColor,ae.ambient,null),s)}static isPositioned(t){const e=window.getComputedStyle(t);return"relative"===e.position||"absolute"===e.position}isPositioned(){return t.isPositioned(this.node)}static parentTransform(e){if(t.isPositioned(e)){const t=e.offsetLeft,i=e.offsetTop;if(0!==t||0!==i)return l.Transform.translate(-t,-i)}return l.Transform.identity()}static pageTransform(e){const i=e.parentNode;return i instanceof HTMLElement?t.pageTransform(i).transform(t.parentTransform(e)):l.Transform.identity()}get parentTransform(){const t=this.style.transform.value;if(null!==t)return t;if(this.isPositioned()){const t=this.node.offsetLeft,e=this.node.offsetTop;if(0!==t||0!==e)return l.Transform.translate(-t,-e)}return l.Transform.identity()}get pageTransform(){const e=this.parent;if(null!==e)return e.pageTransform.transform(this.parentTransform);const i=this.node.parentNode;return i instanceof HTMLElement?t.pageTransform(i).transform(this.parentTransform):l.Transform.identity()}addEventListener(t,e,i){this.node.addEventListener(t,e,i)}removeEventListener(t,e,i){this.node.removeEventListener(t,e,i)}static create(){return this.fromTag(this.tag)}static fromLike(t){if(null==t)return t;if(t instanceof ue){if(!(t instanceof this))throw new TypeError(t+" not an instance of "+this);return t}if(t instanceof HTMLElement)return this.fromNode(t);if(r.Creatable[Symbol.hasInstance](t))return t.create();if("string"==typeof t)return this.fromTag(t);throw new TypeError(""+t)}static fromNode(t){let e=this.get(t);return null===e&&(e=new this(t),this.mount(e)),e}static fromTag(t){if("style"===t&&this!==bi)return bi.create();if("svg"===t)return Ti.create();const e=document.createElement(t);return this.fromNode(e)}static forTag(t){return t===this.tag?this:new yi(this,t)}},(()=>{var e;const r="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(e=s[Symbol.metadata])&&void 0!==e?e:null):void 0;i=[vi({})],d(t,null,i,{kind:"getter",name:"attributes",static:!1,private:!1,access:{has:t=>"attributes"in t,get:t=>t.attributes},metadata:r},null,n),r&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})})(),t.tag="div",t})();class yi{constructor(t,e){this.factory=t,this.tag=e}create(){return this.fromTag(this.tag)}fromLike(t){return this.factory.fromLike(t)}fromNode(t){return this.factory.fromNode(t)}fromTag(t){const e=document.createElement(t);return this.fromNode(e)}}let bi=(()=>{var t;let e,i=wi,s=[],n=[];return t=class extends i{constructor(t){super(t),this.sheet=(u(this,s),u(this,n,void 0))}onMount(){super.onMount(),this.sheet.attachCss(this.node.sheet)}onUnmount(){this.sheet.detachCss(),super.onUnmount()}},(()=>{var r;const o="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(r=i[Symbol.metadata])&&void 0!==r?r:null):void 0;e=[oi({})],d(null,null,e,{kind:"field",name:"sheet",static:!1,private:!1,access:{has:t=>"sheet"in t,get:t=>t.sheet,set:(t,e)=>{t.sheet=e}},metadata:o},n,s),o&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o})})(),t.tag="style",t})();const Ci=gi.extend("SvgAttributes",{},{construct(t,e){return t=super.construct(t,e),Ci.initFasteners(t),t}});Ci.defineGetter("alignmentBaseline",[qe({attributeName:"alignment-baseline",valueType:String})]),Ci.defineGetter("clipPath",[qe({attributeName:"clip-path",valueType:String})]),Ci.defineGetter("cursor",[qe({attributeName:"cursor",valueType:String})]),Ci.defineGetter("cx",[qe({attributeName:"cx",valueType:Number})]),Ci.defineGetter("cy",[qe({attributeName:"cy",valueType:Number})]),Ci.defineGetter("d",[qe({attributeName:"d",valueType:String})]),Ci.defineGetter("dx",[qe({attributeName:"dx",valueType:l.Length,value:null})]),Ci.defineGetter("dy",[qe({attributeName:"dy",valueType:l.Length,value:null})]),Ci.defineGetter("edgeMode",[qe({attributeName:"edgeMode",valueType:String})]),Ci.defineGetter("fill",[qe({attributeName:"fill",valueType:z,value:null})]),Ci.defineGetter("fillOpacity",[qe({attributeName:"fill-opacity",valueType:Number})]),Ci.defineGetter("fillRule",[qe({attributeName:"fill-rule",valueType:String})]),Ci.defineGetter("floodColor",[qe({attributeName:"flood-color",valueType:z,value:null})]),Ci.defineGetter("floodOpacity",[qe({attributeName:"flood-opacity",valueType:Number})]),Ci.defineGetter("height",[qe({attributeName:"height",valueType:l.Length,value:null})]),Ci.defineGetter("in",[qe({attributeName:"in",valueType:String})]),Ci.defineGetter("in2",[qe({attributeName:"in2",valueType:String})]),Ci.defineGetter("lengthAdjust",[qe({attributeName:"lengthAdjust",valueType:String})]),Ci.defineGetter("mode",[qe({attributeName:"mode",valueType:String})]),Ci.defineGetter("opacity",[qe({attributeName:"opacity",valueType:Number})]),Ci.defineGetter("pointerEvents",[qe({attributeName:"pointer-events",valueType:String})]),Ci.defineGetter("points",[qe({attributeName:"points",valueType:String})]),Ci.defineGetter("preserveAspectRatio",[qe({attributeName:"preserveAspectRatio",valueType:Boolean})]),Ci.defineGetter("r",[qe({attributeName:"r",valueType:Number})]),Ci.defineGetter("result",[qe({attributeName:"result",valueType:String})]),Ci.defineGetter("stdDeviation",[qe({attributeName:"stdDeviation",valueType:Number})]),Ci.defineGetter("stroke",[qe({attributeName:"stroke",valueType:z,value:null})]),Ci.defineGetter("strokeDasharray",[qe({attributeName:"stroke-dasharray",valueType:String})]),Ci.defineGetter("strokeDashoffset",[qe({attributeName:"stroke-dashoffset",valueType:Number})]),Ci.defineGetter("strokeLinecap",[qe({attributeName:"stroke-linecap",valueType:String})]),Ci.defineGetter("strokeLinejoin",[qe({attributeName:"stroke-linejoin",valueType:String})]),Ci.defineGetter("strokeMiterlimit",[qe({attributeName:"stroke-miterlimit",valueType:Number})]),Ci.defineGetter("strokeOpacity",[qe({attributeName:"stroke-opacity",valueType:Number})]),Ci.defineGetter("strokeWidth",[qe({attributeName:"stroke-width",valueType:Number})]),Ci.defineGetter("textAnchor",[qe({attributeName:"text-anchor",valueType:String})]),Ci.defineGetter("textLength",[qe({attributeName:"textLength",valueType:l.Length,value:null})]),Ci.defineGetter("transform",[qe({attributeName:"transform",valueType:l.Transform,value:null})]),Ci.defineGetter("type",[qe({attributeName:"type",valueType:String})]),Ci.defineGetter("values",[qe({attributeName:"values",valueType:String})]),Ci.defineGetter("viewBox",[qe({attributeName:"viewBox",valueType:String})]),Ci.defineGetter("width",[qe({attributeName:"width",valueType:l.Length,value:null})]),Ci.defineGetter("x",[qe({attributeName:"x",valueType:Number})]),Ci.defineGetter("x1",[qe({attributeName:"x1",valueType:Number})]),Ci.defineGetter("x2",[qe({attributeName:"x2",valueType:Number})]),Ci.defineGetter("y",[qe({attributeName:"y",valueType:Number})]),Ci.defineGetter("y1",[qe({attributeName:"y1",valueType:Number})]),Ci.defineGetter("y2",[qe({attributeName:"y2",valueType:Number})]);let Ti=(()=>{var t;let e,i=mi,s=[];return t=class extends i{constructor(t){super(t),u(this,s)}get attributes(){return Ci.getter()}setChild(e,i){return"string"==typeof i&&(i=t.fromTag(i)),super.setChild(e,i)}appendChild(e,i){return"string"==typeof e&&(e=t.fromTag(e)),super.appendChild(e,i)}prependChild(e,i){return"string"==typeof e&&(e=t.fromTag(e)),super.prependChild(e,i)}insertChild(e,i,s){return"string"==typeof e&&(e=t.fromTag(e)),super.insertChild(e,i,s)}replaceChild(e,i){return"string"==typeof e&&(e=t.fromTag(e)),super.replaceChild(e,i)}get parentTransform(){const t=this.attributes.transform.value;return null!==t?t:l.Transform.identity()}addEventListener(t,e,i){this.node.addEventListener(t,e,i)}removeEventListener(t,e,i){this.node.removeEventListener(t,e,i)}static create(){return this.fromTag(this.tag)}static fromLike(t){if(null==t)return t;if(t instanceof ue){if(!(t instanceof this))throw new TypeError(t+" not an instance of "+this);return t}if(t instanceof SVGElement)return this.fromNode(t);if(r.Creatable[Symbol.hasInstance](t))return t.create();if("string"==typeof t)return this.fromTag(t);throw new TypeError(""+t)}static fromNode(t){let e=this.get(t);return null===e&&(e=new this(t),this.mount(e)),e}static fromTag(t){const e=document.createElementNS(this.namespace,t);return this.fromNode(e)}static forTag(t){return t===this.tag?this:new Si(this,t)}},(()=>{var n;const r="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(n=i[Symbol.metadata])&&void 0!==n?n:null):void 0;e=[Ci({})],d(t,null,e,{kind:"getter",name:"attributes",static:!1,private:!1,access:{has:t=>"attributes"in t,get:t=>t.attributes},metadata:r},null,s),r&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})})(),t.tag="svg",t.namespace="http://www.w3.org/2000/svg",t})();class Si{constructor(t,e){this.factory=t,this.tag=e}get namespace(){return Ti.namespace}create(){return this.fromTag(this.tag)}fromLike(t){return this.factory.fromLike(t)}fromNode(t){return this.factory.fromNode(t)}fromTag(t){const e=document.createElementNS(this.namespace,t);return this.fromNode(e)}}let xi=(()=>{var t;let i,s=e.Service,n=[],r=[];return t=class extends s{constructor(){super(...arguments),this.roots=(u(this,n),u(this,r,void 0))}materializeView(t){const e=t.node.childNodes;for(let i=0;i<e.length;i+=1){const s=e[i],n=this.materializeNode(t,s);null!==n&&this.materializeView(n)}}materializeNode(t,e){const i=fi.get(e);return null!==i?i:e instanceof Element?this.materializeElement(t,e):e instanceof Text?this.materializeText(t,e):null}materializeElement(e,i){let s;const n=i.getAttribute("swim-view");if(null!==n&&(s=t.eval(n),"function"!=typeof s))throw new TypeError(n);void 0===s&&(s=i instanceof HTMLElement?wi:i instanceof SVGElement?Ti:mi);const r=new s(i),o=i.getAttribute("key");return e.injectChild(r,null,null!==o?o:void 0),r}materializeText(t,e){return null}static boot(){const e=[],i=document.querySelectorAll("[swim-app]");for(let s=0;s<i.length;s+=1){const n=i[s];if(n instanceof HTMLElement){const i=t.bootElement(n);e.push(i)}}return e}static bootElement(e){let i,s=mi.get(e);if(null!==s)return s;const n=e.getAttribute("swim-app");if(null!==n&&""!==n&&(i=t.eval(n),"function"!=typeof i))throw new TypeError(n);return void 0===i&&(i=e instanceof HTMLElement?wi:e instanceof SVGElement?Ti:mi),s=new i(e),i.mount(s),s}static eval(t){let e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;const i=t.split(".");for(let t=0;"object"==typeof e&&null!==e&&t<i.length;t+=1){e=e[i[t]]}return e}},(()=>{var e;const o="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(e=s[Symbol.metadata])&&void 0!==e?e:null):void 0;i=[pe({initView(t){t.node.hasAttribute("swim-app")&&this.owner.materializeView(t)},willAttachView(t){this.owner.callObservers("serviceWillAttachRoot",t,this.owner)},didAttachView(t){this.owner.callObservers("serviceDidAttachRoot",t,this.owner)},willDetachView(t){this.owner.callObservers("serviceWillDetachRoot",t,this.owner)},didDetachView(t){this.owner.callObservers("serviceDidDetachRoot",t,this.owner)}})],d(null,null,i,{kind:"field",name:"roots",static:!1,private:!1,access:{has:t=>"roots"in t,get:t=>t.roots,set:(t,e)=>{t.roots=e}},metadata:o},r,n),o&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o})})(),t})();const Mi={[Symbol.hasInstance]:t=>t instanceof mi&&"presence"in t&&"modality"in t};let Ai=(()=>{var t;let i,s,n,r,o=e.Service,l=[],a=[],h=[],c=[],f=[];return t=class extends o{constructor(){super(...arguments),this.matte=(u(this,l),u(this,a,void 0)),this.modals=u(this,h,void 0),this.modality=u(this,c,void 0),this.fallthrough=u(this,f,void 0)}presentModal(t,e={}){e.multi||this.dismissModals(),this.modals.insertView(null,t),t.presence.present(!0)}dismissModal(t){this.modals.hasView(t)&&t.presence.dismiss(!0)}dismissModals(){const t=this.modals.views;for(const e in t){const i=t[e];this.dismissModal(i)}}displaceModals(){const t=this.modals.views;for(const e in t){const i=t[e];i.presence.presented&&this.dismissModal(i)}}toggleModal(t,e){const i=t.presence.value;i.dismissed||i.dismissing?this.presentModal(t,e):(i.presented||i.presenting)&&this.dismissModal(t)}},(()=>{var u;const p="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=o[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[fe({viewType:mi})],s=[pe({observes:!0,get parentView(){const t=this.owner.matte.view;return null!==t?t:mi.get(document.body)},insertChild(t,e,i,s){super.insertChild(t,e,i,s),null!==e.parent||e.mounted||(document.body.appendChild(e.node),e.mount())},initView(t){this.owner.modality.update()},willAttachView(t){this.owner.callObservers("serviceWillAttachModal",t,this.owner)},didAttachView(t){this.owner.callObservers("serviceDidAttachModal",t,this.owner)},deinitView(t){this.owner.modality.update()},willDetachView(t){this.owner.callObservers("serviceWillDetachModal",t,this.owner)},didDetachView(t){this.owner.callObservers("serviceDidDetachModal",t,this.owner)},viewWillPresent(t){this.owner.callObservers("serviceWillPresentModal",t,this.owner)},viewDidPresent(t){this.owner.callObservers("serviceDidPresentModal",t,this.owner)},viewWillDismiss(t){this.owner.callObservers("serviceWillDismissModal",t,this.owner)},viewDidDismiss(t){this.owner.callObservers("serviceDidDismissModal",t,this.owner),this.detachView(t)},viewDidSetModality(t,e){this.owner.modality.update()}})],n=[e.Property({valueType:Number,value:0,update(){if(!this.hasAffinity(e.Affinity.Intrinsic))return;let t=0;const i=this.owner.modals.views;for(const e in i){const s=i[e];t=Math.min(Math.max(t,s.modality.value),1)}this.setIntrinsic(t)},didSetValue(t,e){this.owner.callObservers("serviceDidSetModality",t,e,this.owner)}})],r=[e.EventHandler({eventType:"click",target:"undefined"!=typeof document?document:null,handle(t){this.owner.displaceModals()}})],d(null,null,i,{kind:"field",name:"matte",static:!1,private:!1,access:{has:t=>"matte"in t,get:t=>t.matte,set:(t,e)=>{t.matte=e}},metadata:p},a,l),d(null,null,s,{kind:"field",name:"modals",static:!1,private:!1,access:{has:t=>"modals"in t,get:t=>t.modals,set:(t,e)=>{t.modals=e}},metadata:p},h,l),d(null,null,n,{kind:"field",name:"modality",static:!1,private:!1,access:{has:t=>"modality"in t,get:t=>t.modality,set:(t,e)=>{t.modality=e}},metadata:p},c,l),d(null,null,r,{kind:"field",name:"fallthrough",static:!1,private:!1,access:{has:t=>"fallthrough"in t,get:t=>t.fallthrough,set:(t,e)=>{t.fallthrough=e}},metadata:p},f,l),p&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p})})(),t})();class Fi{}const ki={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"render")};let Pi=(()=>{var t;let i,s,n=ue,r=[],o=[];return t=class extends n{constructor(){super(),this.renderer=(u(this,r),u(this,o,void 0)),this.ownViewFrame=null,this.eventHandlers=null}needsProcess(t){return 0==(this.flags&ue.NeedsAnimate)&&(t&=~ue.NeedsAnimate),t}renderViewOutline(t,e,i,s){if(!t.isDefined())return;const n=e.lineWidth,r=e.strokeStyle;e.beginPath(),e.moveTo(t.xMin,t.yMin),e.lineTo(t.xMin,t.yMax),e.lineTo(t.xMax,t.yMax),e.lineTo(t.xMax,t.yMin),e.closePath(),e.lineWidth=s,e.strokeStyle=i.toString(),e.stroke(),e.lineWidth=n,e.strokeStyle=r}get sprites(){return e.Provider.getter()}get viewFrame(){let t=this.ownViewFrame;return null===t&&(t=this.deriveViewFrame()),t}setViewFrame(t){this.ownViewFrame=t}deriveViewFrame(){const e=this.parent;return e instanceof t||e instanceof ji?e.viewFrame:l.R2Box.undefined()}cullViewFrame(t=this.viewFrame){this.setCulled(!t.intersects(this.viewBounds))}get ownViewBounds(){return null}deriveViewBounds(){let e,i=this.firstChild;for(;null!==i;){if(i instanceof t&&!i.hidden&&!i.unbounded){const t=i.viewBounds;t.isDefined()&&(e=void 0!==e?e.union(t):t)}i=i.nextSibling}return void 0===e&&(e=this.viewFrame),e}get hitBounds(){return this.viewBounds}deriveHitBounds(){let e,i=this.firstChild;for(;null!==i;){if(i instanceof t&&!i.hidden&&!i.intangible){const t=i.hitBounds;e=void 0===e?t:e.union(t)}i=i.nextSibling}return void 0===e&&(e=this.viewBounds),e}cascadeHitTest(t,e){if(this.hidden||this.culled||this.intangible||!this.hitBounds.contains(t,e))return null;let i=this.hitTestChildren(t,e);return null===i&&(i=this.hitTest(t,e)),i}hitTest(t,e){return null}hitTestChildren(e,i){let s=this.firstChild;for(;null!==s;){if(s instanceof t){const t=this.hitTestChild(s,e,i);if(null!==t)return t}s=s.nextSibling}return null}hitTestChild(t,e,i){return t.cascadeHitTest(e,i)}get parentTransform(){return l.Transform.identity()}get clientBounds(){const t=this.clientTransform.inverse();return this.viewBounds.transform(t)}get popoverFrame(){const t=this.pageTransform.inverse();return this.viewBounds.transform(t)}addEventListener(t,e,i){let s=this.eventHandlers;null===s&&(s={},this.eventHandlers=s);let n=s[t];const r="boolean"==typeof i?i:"object"==typeof i&&null!==i&&i.capture||!1,o=i&&"object"==typeof i&&i.passive||!1,l=i&&"object"==typeof i&&i.once||!1;let a;if(void 0===n)return a={listener:e,capture:r,passive:o,once:l},n=[a],void(s[t]=n);const h=n.length;let d=0;for(;d<h&&(a=n[d],a.listener!==e||a.capture!==r);)d+=1;d<h?(a.passive=o,a.once=l):(a={listener:e,capture:r,passive:o,once:l},n.push(a))}removeEventListener(t,e,i){const s=this.eventHandlers;if(null===s)return;const n=s[t];if(void 0===n)return;const r="boolean"==typeof i?i:"object"==typeof i&&null!==i&&i.capture||!1,o=n.length;let l=0;for(;l<o;){const i=n[l];if(i.listener===e&&i.capture===r){n.splice(l,1),0===n.length&&delete s[t];break}l+=1}}handleEvent(t){const e=t.type,i=this.eventHandlers;if(null===i)return;const s=i[e];if(void 0===s)return;let n=0;for(;n<s.length;){const e=s[n];if(!e.capture){const i=e.listener;if("function"==typeof i?"function"==typeof i.call?i.call(this,t):i(t):"object"==typeof i&&null!==i&&i.handleEvent(t),e.once){s.splice(n,1);continue}}n+=1}0===s.length&&delete i[e]}bubbleEvent(e){if(this.handleEvent(e),!e.bubbles||e.cancelBubble)return null;const i=this.parent;return i instanceof t||i instanceof ji?i.bubbleEvent(e):i}dispatchEvent(t){t.targetView=this;const e=this.bubbleEvent(t);return null===e?!t.cancelBubble:e.dispatchEvent(t)}},(()=>{var l;const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(l=n[Symbol.metadata])&&void 0!==l?l:null):void 0;i=[e.Property({valueType:Fi,value:null,inherits:!0})],s=[e.Provider({get serviceType(){return zi}})],d(t,null,s,{kind:"getter",name:"sprites",static:!1,private:!1,access:{has:t=>"sprites"in t,get:t=>t.sprites},metadata:a},null,r),d(null,null,i,{kind:"field",name:"renderer",static:!1,private:!1,access:{has:t=>"renderer"in t,get:t=>t.renderer,set:(t,e)=>{t.renderer=e}},metadata:a},o,r),a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.UncullFlags=ue.UncullFlags|ue.NeedsRender,t.UnhideFlags=ue.UnhideFlags|ue.NeedsRender,t.InsertChildFlags=ue.InsertChildFlags|ue.NeedsRender,t.RemoveChildFlags=ue.RemoveChildFlags|ue.NeedsRender,t})();Object.defineProperty(Pi.prototype,"viewBounds",{get(){return this.viewFrame},configurable:!0});class Vi extends Fi{}class Li{constructor(){this.precision=-1,this.x0=NaN,this.y0=NaN,this.x1=NaN,this.y1=NaN,this.d=""}setPrecision(t){this.precision=t}get anglePrecision(){const t=this.precision;return t>0?Math.max(5,t):t}moveTo(t,e){this.d+="M"+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision),this.x0=t,this.y0=e,this.x1=t,this.y1=e}lineTo(t,e){this.d+="L"+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision),this.x1=t,this.y1=e}quadraticCurveTo(t,e,i,s){this.d+="Q"+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision)+","+o.Format.decimal(i,this.precision)+","+o.Format.decimal(s,this.precision),this.x1=i,this.y1=s}bezierCurveTo(t,e,i,s,n,r){this.d+="C"+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision)+","+o.Format.decimal(i,this.precision)+","+o.Format.decimal(s,this.precision)+","+o.Format.decimal(n,this.precision)+","+o.Format.decimal(r,this.precision),this.x1=n,this.y1=r}arcTo(t,e,i,s,n){const r=this.x1,l=this.y1,a=i-t,h=s-e,d=r-t,u=l-e,c=d*d+u*u;if(n<0)throw new Error("negative radius: "+n);if(isNaN(this.x1))this.d+="M"+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision),this.x1=t,this.y1=e;else if(c>Li.Epsilon)if(Math.abs(u*a-h*d)>Li.Epsilon&&0!==n){const f=i-r,p=s-l,g=a*a+h*h,m=f*f+p*p,v=Math.sqrt(g),w=Math.sqrt(c),y=n*Math.tan((Math.PI-Math.acos((g+c-m)/(2*v*w)))/2),b=y/w,C=y/v;Math.abs(b-1)>Li.Epsilon&&(this.d+="L"+o.Format.decimal(t+b*d,this.precision)+","+o.Format.decimal(e+b*u,this.precision)),t+=C*a,e+=C*h;const T=o.Format.decimal(n,this.precision);this.d+="A"+T+","+T+",0,0,"+(u*f>d*p?"1":"0")+","+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision),this.x1=t,this.y1=e}else this.d+="L"+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision),this.x1=t,this.y1=e;else;}arc(t,e,i,s,n,r=!1){const l=t+i*Math.cos(s),a=e+i*Math.sin(s),h=1^+r;let d=r?s-n:n-s;if(i<0)throw new Error("negative radius: "+i);if(isNaN(this.x1)?this.d+="M"+o.Format.decimal(l,this.precision)+","+o.Format.decimal(a,this.precision):(Math.abs(this.x1-l)>Li.Epsilon||Math.abs(this.y1-a)>Li.Epsilon)&&(this.d+="L"+o.Format.decimal(l,this.precision)+","+o.Format.decimal(a,this.precision)),0===i)return;d<0&&(d=d%(2*Math.PI)+2*Math.PI);const u=o.Format.decimal(i,this.precision);if(d>2*Math.PI-Li.Epsilon)this.d+="A"+u+","+u+",0,1,"+(h?"1":"0")+","+o.Format.decimal(l,this.precision)+","+o.Format.decimal(a,this.precision),this.x1=l,this.y1=a;else if(d>Li.Epsilon){const s=t+i*Math.cos(n),r=e+i*Math.sin(n);this.d+="A"+u+","+u+",0,"+(d>=Math.PI?"1":"0")+","+(h?"1":"0")+","+o.Format.decimal(s,this.precision)+","+o.Format.decimal(r,this.precision),this.x1=s,this.y1=r}}rect(t,e,i,s){this.d+="M"+o.Format.decimal(t,this.precision)+","+o.Format.decimal(e,this.precision)+"h"+o.Format.decimal(i,this.precision)+"v"+o.Format.decimal(s,this.precision)+"h"+o.Format.decimal(-i,this.precision)+"Z",this.x0=t,this.y0=e,this.x1=t,this.y1=e}ellipse(t,e,i,s,n,r,l,a=!1){const h=Math.cos(n),d=Math.sin(n),u=Math.cos(l),c=Math.sin(l),f=h*i*u-d*s*c+t,p=d*i*u+h*s*c+e,g=l-r,m=Math.abs(g)>Math.PI,v=!a;this.d+="A"+o.Format.decimal(i,this.precision)+","+o.Format.decimal(s,this.precision)+","+o.Format.decimal(n,this.anglePrecision)+","+(m?"1":"0")+","+(v?"1":"0")+","+o.Format.decimal(f,this.precision)+","+o.Format.decimal(p,this.precision),this.x1=f,this.y1=p}closePath(){isNaN(this.x1)||(this.d+="Z",this.x1=this.x0,this.y1=this.y0)}toString(){return this.d}}Li.Epsilon=1e-6;class Ri extends Vi{constructor(t){super(),this.context=t}get transform(){return l.Transform.identity()}get pixelRatio(){return 1}}class Ii extends Vi{}class Oi{constructor(t){this.view=t,this.precision=-1,this.pathContext=null,this.pathView=null,this.pathFlags=0,this.globalAlpha=1,this.globalCompositeOperation="source-over",this.fillStyle="",this.strokeStyle="",this.lineWidth=1,this.lineCap="butt",this.lineJoin="miter",this.miterLimit=10,this.lineDashOffset=0,this.lineDash=[]}setPrecision(t){this.precision=t}getPathContext(){const t=this.pathContext;if(null===t)throw new Error("no path");return t}getOrCreatePathContext(){let t=this.pathContext;if(null===t){if(t=this.createPathContext(),this.pathContext=t,null===this.pathView||0!==this.pathFlags){this.finalizePath();const t=this.nextPathView();this.setPathView(t)}this.setPathFlags(0)}return t}createPathContext(){const t=new Li;return t.setPrecision(this.precision),t}setPathView(t){this.pathView=t}nextPathView(){const t=this.pathView;if(null===t)return null;let e=t.node.nextSibling;for(;null!==e;){if(e instanceof SVGPathElement)return Ti.fromNode(e);e=e.nextSibling}return null}finalizePath(){const t=this.pathView;if(null===t)return;const e=this.pathFlags;0==(e&Oi.FillFlag)&&t.attributes.fill.setIntrinsic(null),0==(e&Oi.FillRuleFlag)&&t.attributes.fillRule.setIntrinsic(void 0),0==(e&Oi.StrokeFlag)&&t.attributes.stroke.setIntrinsic(null),0==(e&Oi.PathFlag)&&t.attributes.d.setIntrinsic(void 0)}setPathFlags(t){this.pathFlags=t}getLineDash(){return this.lineDash}setLineDash(t){this.lineDash=t}beginPath(){this.pathContext=null}moveTo(t,e){this.getOrCreatePathContext().moveTo(t,e)}lineTo(t,e){this.getPathContext().lineTo(t,e)}quadraticCurveTo(t,e,i,s){this.getPathContext().quadraticCurveTo(t,e,i,s)}bezierCurveTo(t,e,i,s,n,r){this.getPathContext().bezierCurveTo(t,e,i,s,n,r)}arcTo(t,e,i,s,n){this.getPathContext().arcTo(t,e,i,s,n)}arc(t,e,i,s,n,r){this.getOrCreatePathContext().arc(t,e,i,s,n,r)}ellipse(t,e,i,s,n,r,o,l){this.getOrCreatePathContext().ellipse(t,e,i,s,n,r,o,l)}rect(t,e,i,s){this.getOrCreatePathContext().rect(t,e,i,s)}closePath(){const t=this.pathContext;null!==t&&t.closePath()}fill(t){const e=this.fillStyle;if("string"!=typeof e)throw new Error("unsupported fill style: "+e);let i=this.pathView;null!==i&&0!=(this.pathFlags&Oi.FillFlag)&&(this.finalizePath(),i=this.nextPathView(),this.setPathView(i));let s=!1;if(null===i&&(i=Ti.fromTag("path"),this.setPathView(i),s=!0),i.attributes.fill.setIntrinsic(e),i.attributes.fillOpacity.setIntrinsic(1!==this.globalAlpha?this.globalAlpha:void 0),this.setPathFlags(this.pathFlags|Oi.FillFlag),void 0!==t&&(i.attributes.fillRule.setIntrinsic(t),this.setPathFlags(this.pathFlags|Oi.FillRuleFlag)),0==(this.pathFlags&Oi.PathFlag)){const t=this.getPathContext().toString();i.attributes.d.setIntrinsic(t),this.setPathFlags(this.pathFlags|Oi.PathFlag)}s&&this.view.appendChild(i)}stroke(){const t=this.strokeStyle,e=this.lineWidth;if("string"!=typeof t||0===e||!isFinite(e))throw new Error("unsupported stroke style: "+t);let i=this.pathView;null!==i&&0!=(this.pathFlags&Oi.StrokeFlag)&&(this.finalizePath(),i=this.nextPathView(),this.setPathView(i));let s=!1;if(null===i&&(i=Ti.fromTag("path"),this.setPathView(i),s=!0),i.attributes.setIntrinsic({stroke:t,strokeWidth:e,strokeLinecap:this.lineCap,strokeLinejoin:this.lineJoin,strokeOpacity:1!==this.globalAlpha?this.globalAlpha:void 0,strokeMiterlimit:"miter"===this.lineJoin?this.miterLimit:void 0}),0!==this.lineDash.length){let t="";for(let e=0;e<this.lineDash.length;e+=1)0!==e&&(t+=" "),t+=this.lineDash[e];i.attributes.setIntrinsic({strokeDasharray:t,strokeDashoffset:0!==this.lineDashOffset?this.lineDashOffset:void 0})}else i.attributes.setIntrinsic({strokeDasharray:void 0,strokeDashoffset:void 0});if(this.setPathFlags(this.pathFlags|Oi.StrokeFlag),0==(this.pathFlags&Oi.PathFlag)){const t=this.getPathContext().toString();i.attributes.d.setIntrinsic(t),this.setPathFlags(this.pathFlags|Oi.PathFlag)}s&&this.view.appendChild(i)}beginSvg(){let t=null,e=this.view.node.firstChild;for(;null!==e;){if(e instanceof SVGPathElement){t=Ti.fromNode(e);break}e=e.nextSibling}this.setPathView(t),this.setPathFlags(0)}finalizeSvg(){let t=this.pathView;if(null===t)return;let e=t.node.nextSibling;for(null===t.attributes.fill.state&&null===t.attributes.stroke.state&&(this.pathView=null,t.remove()),t=null;null!==e;){const t=fi.get(e);e=e.nextSibling,null!==t&&t.remove()}}}Oi.FillFlag=1,Oi.FillRuleFlag=2,Oi.StrokeFlag=4,Oi.PathFlag=8;class Di extends Ii{constructor(t){super(),this.context=t}get transform(){return l.Transform.identity()}get pixelRatio(){return 1}}class Ei extends Ii{constructor(t,e,i){super(),this.context=t,this.transform=e,this.pixelRatio=i}setTransform(t){this.transform=t}}class Ui extends Fi{constructor(t,e){super(),this.context=t,this.pixelRatio=void 0!==e?e:window.devicePixelRatio||1}}class Ni{constructor(t,e,i){this.sheet=t,this.rowIndex=e,this.colIndex=i}get width(){return this.sheet.spriteWidth}get height(){return this.sheet.spriteHeight}get pixelRatio(){return this.sheet.pixelRatio}getRenderer(){return this.sheet.getSpriteRenderer(this.rowIndex,this.colIndex)}clear(){return this.sheet.clearSprite(this.rowIndex,this.colIndex)}draw(t,e){this.sheet.drawSprite(t,e,this.rowIndex,this.colIndex)}release(){this.sheet.releaseSprite(this)}}class qi{constructor(t,e,i,s,n){const r=Math.floor(s/e),o=Math.floor(i/t),a=r*o,h=new Array(a),d=new Array(a),u=document.createElement("canvas");u.width=i*n,u.height=s*n,u.style.width=i+"px",u.style.height=s+"px";const c=u.getContext("2d"),f=new Ei(c,l.Transform.identity(),n);this.spriteWidth=t,this.spriteHeight=e,this.sprites=h,this.freeSprites=d,this.canvas=u,this.renderer=f,this.nextSheet=null,this.createSprites(h,r,o);for(let t=0;t<a;t+=1)d[t]=h[a-t-1]}createSprites(t,e,i){let s=0;for(let n=0;n<e;n+=1)for(let e=0;e<i;e+=1){const i=this.createSprite(n,e);t[s]=i,s+=1}}createSprite(t,e){return new Ni(this,t,e)}get pixelRatio(){return this.renderer.pixelRatio}get canvasWidth(){return this.canvas.width/this.pixelRatio}get canvasHeight(){return this.canvas.height/this.pixelRatio}get rowCount(){return Math.floor(this.canvasHeight/this.spriteHeight)}get colCount(){return Math.floor(this.canvasWidth/this.spriteWidth)}get spriteCount(){return this.rowCount*this.colCount}get freeCount(){return this.freeSprites.length}static acquireNextFreeSheet(t){for(;;){const e=t.nextSheet;if(null===e)return null;if(0!==e.freeCount)return t.nextSheet=e.nextSheet,e.nextSheet=null,e;t=e}}acquireSprite(){const t=this.freeSprites.pop();return void 0!==t?t:null}releaseSprite(t){this.clearSprite(t.rowIndex,t.colIndex),this.freeSprites.push(t)}clearSprite(t,e){this.getSpriteRenderer(t,e).context.clearRect(0,0,this.spriteWidth,this.spriteHeight)}getSpriteRenderer(t,e){const i=this.renderer,s=i.context,n=i.pixelRatio,r=t*this.spriteWidth*n,o=e*this.spriteHeight*n;return s.setTransform(n,0,0,n,r,o),i.setTransform(l.Transform.affine(n,0,0,n,r,o)),i}drawSprite(t,e,i,s){const n=this.renderer.pixelRatio,r=this.spriteWidth*n,o=this.spriteHeight*n,l=i*r,a=s*o;t.drawImage(this.canvas,l,a,r,o,e.x,e.y,this.spriteWidth,this.spriteHeight)}}class zi extends e.Service{constructor(t,e,i,s,n){super(),void 0===i&&(i=window.devicePixelRatio||1),void 0===t&&(t=Math.floor(zi.TextureWidth/i)),void 0===e&&(e=Math.floor(zi.TextureHeight/i)),void 0===n&&(n=Math.floor(Math.log2(Math.min(t,e)/4))),void 0===s&&(s=Math.min(4,n)),this.canvasWidth=t,this.canvasHeight=e,this.minSizeClass=s,this.maxSizeClass=n,this.pixelRatio=i;const r=n-s+1,o=new Array(r);for(let t=0;t<r;t+=1)o[t]=null;this.slabs=o}createSlab(t){const e=1<<t;return new qi(e,e,this.canvasWidth,this.canvasHeight,this.pixelRatio)}getFreeSlab(t){if((t=Math.max(this.minSizeClass,t))>this.maxSizeClass)return null;const e=t-this.minSizeClass,i=this.slabs;let s=i[e];if(null===s)s=this.createSlab(t),i[e]=s;else if(0===s.freeCount){let n=qi.acquireNextFreeSheet(s);null===n&&(n=this.createSlab(t)),n.nextSheet=s,s=n,i[e]=s}return s}createSheet(t,e){return new qi(t,e,t,e,this.pixelRatio)}getFreeSheet(t,e){const i=Math.ceil(Math.log2(t)),s=Math.ceil(Math.log2(e)),n=Math.max(i,s);let r=this.getFreeSlab(n);return null===r&&(r=this.createSheet(t,e)),r}acquireSprite(t,e){return this.getFreeSheet(t,e).acquireSprite()}}zi.TextureWidth=512,zi.TextureHeight=512;let ji=(()=>{var t;let i,s,n,r,o,a,h,c,f,p,g,m,v,w,y,b,C,T,S,x,M,A,F,k,P,V,L=wi,R=[],I=[],O=[],D=[],E=[],U=[],N=[],q=[],z=[],j=[],W=[],H=[],K=[],B=[],G=[],Y=[],X=[],_=[],Q=[],J=[],Z=[],$=[],tt=[],et=[],it=[],st=[];return t=class extends L{constructor(t){super(t),this.renderer=(u(this,R),u(this,I,void 0)),this.clickEvents=u(this,O,void 0),this.wheelEvents=u(this,D,void 0),this.mouseEvents=u(this,E,void 0),this.pointerEvents=u(this,U,void 0),this.touchEvents=u(this,N,void 0),this.click=u(this,q,void 0),this.dblclick=u(this,z,void 0),this.contextmenu=u(this,j,void 0),this.wheel=u(this,W,void 0),this.mouseenter=u(this,H,void 0),this.mouseleave=u(this,K,void 0),this.mousedown=u(this,B,void 0),this.mousemove=u(this,G,void 0),this.mouseup=u(this,Y,void 0),this.pointerenter=u(this,X,void 0),this.pointerleave=u(this,_,void 0),this.pointerdown=u(this,Q,void 0),this.pointermove=u(this,J,void 0),this.pointerup=u(this,Z,void 0),this.pointercancel=u(this,$,void 0),this.touchstart=u(this,tt,void 0),this.touchmove=u(this,et,void 0),this.touchend=u(this,it,void 0),this.touchcancel=u(this,st,void 0),this.viewFrame=l.R2Box.undefined(),this.mouse=null,this.pointers=null,this.touches=null,this.style.setIntrinsic({position:"absolute",left:0,top:0})}needsUpdate(t,e){return t=super.needsUpdate(t,e),t|=ue.NeedsRender|ue.NeedsComposite,this.setFlags(this.flags|ue.NeedsRender|ue.NeedsComposite),t}needsProcess(t){return 0!=(t&ue.ProcessMask)&&this.requireUpdate(ue.NeedsRender|ue.NeedsComposite),t}onResize(){super.onResize(),this.resizeCanvas(this.node),this.resetRenderer(),this.requireUpdate(ue.NeedsLayout|ue.NeedsRender|ue.NeedsComposite)}onScroll(){super.onScroll(),this.setCulled(!this.intersectsViewport())}didDisplay(t){this.detectHitTargets(),super.didDisplay(t)}onRender(){this.clearCanvas()}needsDisplay(t){return t|=ue.NeedsRender|ue.NeedsComposite}get sprites(){return e.Provider.getter()}get pixelRatio(){return window.devicePixelRatio||1}createRenderer(t="canvas"){if("canvas"===t){const t=this.node.getContext("2d");if(null===t)throw new Error("Failed to create canvas rendering context");const e=this.pixelRatio,i=l.Transform.affine(e,0,0,e,0,0);return new Ei(t,i,e)}if("webgl"===t){const t=this.node.getContext("webgl");if(null===t)throw new Error("Failed to create webgl rendering context");return new Ui(t,this.pixelRatio)}throw new Error("Failed to create "+t+" renderer")}setViewFrame(t){}get viewBounds(){return this.viewFrame}get hitBounds(){return this.viewFrame}cascadeHitTest(t,e){if(this.hidden||this.culled||this.intangible||!this.hitBounds.contains(t,e))return null;let i=this.hitTestChildren(t,e);return null===i&&(i=this.hitTest(t,e)),i}hitTest(t,e){return null}hitTestChildren(t,e){let i=this.firstChild;for(;null!==i;){if(i instanceof Pi){const s=this.hitTestChild(i,t,e);if(null!==s)return s}i=i.nextSibling}return null}hitTestChild(t,e,i){return t.cascadeHitTest(e,i)}detectHitTargets(t){if(this.mouseEvents.value){const e=this.mouse;null!==e&&(void 0===t&&(t=this.clientBounds),this.detectMouseTarget(e,this.clientBounds))}if(this.pointerEvents.value){const e=this.pointers;for(const i in e){const s=e[i];void 0===t&&(t=this.clientBounds),this.detectPointerTarget(s,t)}}}setEventTarget(t){null===t&&(t=this),this.click.setTarget(t),this.dblclick.setTarget(t),this.contextmenu.setTarget(t),this.wheel.setTarget(t),this.mouseenter.setTarget(t),this.mouseleave.setTarget(t),this.mousedown.setTarget(t),this.pointerenter.setTarget(t),this.pointerleave.setTarget(t),this.pointerdown.setTarget(t),this.touchstart.setTarget(t),this.touchmove.setTarget(t),this.touchend.setTarget(t),this.touchcancel.setTarget(t)}handleEvent(t){}bubbleEvent(t){return this.handleEvent(t),this}fireEvent(t,e,i){const s=this.clientBounds;if(!s.contains(e,i))return null;const n=e-s.x,r=i-s.y,o=this.cascadeHitTest(n,r);return null===o?null:(t.targetView=o,o.bubbleEvent(t),o)}updateMouse(t,e){t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenY=e.screenY,t.movementX=e.movementX,t.movementY=e.movementY,t.view=e.view,t.detail=e.detail,t.relatedTarget=e.relatedTarget}fireMouseEvent(t){return this.fireEvent(t,t.clientX,t.clientY)}onMouseTargetChange(t,e,i){t.bubbles=!0;let s=null;if(null!==i&&null!==e&&(s=i.commonAncestor(e)),null!==i){const n=new MouseEvent("mouseout",t);n.targetView=i,n.relatedTargetView=e,i.bubbleEvent(n);let r=i;do{const i=new MouseEvent("mouseleave",Object.assign({bubbles:!1},t));i.targetView=r,i.relatedTargetView=e,r.handleEvent(i),r=r.parent}while(r instanceof Pi&&r!==s)}if(t.targetView=null!==e?e:void 0,null!==e){const n=new MouseEvent("mouseover",t);n.targetView=e,n.relatedTargetView=i,e.bubbleEvent(n);let r=e;do{const e=new MouseEvent("mouseenter",Object.assign({bubbles:!1},t));e.targetView=r,e.relatedTargetView=i,r.handleEvent(e),r=r.parent}while(r instanceof Pi&&r!==s)}}detectMouseTarget(t,e){const i=t.clientX,s=t.clientY;if(e.contains(i,s)){const n=i-e.x,r=s-e.y;let o=t.targetView;void 0===o&&(o=null);const l=this.cascadeHitTest(n,r);l!==o&&this.onMouseTargetChange(t,l,o)}}updatePointer(t,e){t.pointerId=e.pointerId,t.pointerType=e.pointerType,t.isPrimary=e.isPrimary,t.button=e.button,t.buttons=e.buttons,t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenY=e.screenY,t.movementX=e.movementX,t.movementY=e.movementY,t.width=e.width,t.height=e.height,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.view=e.view,t.detail=e.detail,t.relatedTarget=e.relatedTarget}firePointerEvent(t){return this.fireEvent(t,t.clientX,t.clientY)}onPointerTargetChange(t,e,i){t.bubbles=!0;let s=null;if(null!==i&&null!==e&&(s=i.commonAncestor(e)),null!==i){const n=new PointerEvent("pointerout",t);n.targetView=i,n.relatedTargetView=e,i.bubbleEvent(n);let r=i;do{const i=new PointerEvent("pointerleave",Object.assign({bubbles:!1},t));i.targetView=r,i.relatedTargetView=e,r.handleEvent(i),r=r.parent}while(r instanceof Pi&&r!==s)}if(t.targetView=null!==e?e:void 0,null!==e){const n=new PointerEvent("pointerover",t);n.targetView=e,n.relatedTargetView=i,e.bubbleEvent(n);let r=e;do{const e=new PointerEvent("pointerenter",Object.assign({bubbles:!1},t));e.targetView=r,e.relatedTargetView=i,r.handleEvent(e),r=r.parent}while(r instanceof Pi&&r!==s)}}detectPointerTarget(t,e){const i=t.clientX,s=t.clientY;if(e.contains(i,s)){const n=i-e.x,r=s-e.y;let o=t.targetView;void 0===o&&(o=null);const l=this.cascadeHitTest(n,r);l!==o&&this.onPointerTargetChange(t,l,o)}}updateTouch(t,e){t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenY=e.screenY,t.pageX=e.pageX,t.pageY=e.pageY,t.radiusX=e.radiusX,t.radiusY=e.radiusY,t.rotationAngle=e.rotationAngle,t.force=e.force}fireTouchEvent(t,e){const i=e.changedTouches,s=[];for(let n=0;n<i.length;n+=1){const r=i[n],o=r.targetView;if(void 0!==o&&s.indexOf(o)<0){const l=new TouchEvent(t,{changedTouches:i,targetTouches:e.targetTouches,touches:e.touches,bubbles:!0});l.targetView=o;const a=[r];for(let t=n+1;t<i.length;t+=1){const e=i[t];e.targetView===o&&a.push(e)}const h=document;void 0!==h.createTouchList?l.targetViewTouches=h.createTouchList(...a):(a.item=function(t){return a[t]},l.targetViewTouches=a),o.bubbleEvent(l),s.push(o)}}}resizeCanvas(t){let e,i,s,n=t.parentNode;if(n instanceof HTMLElement){do{if(e=Math.floor(n.offsetWidth),i=Math.floor(n.offsetHeight),0!==e&&0!==i)break;0!==e&&0!==i||!wi.isPositioned(n)||this.requireUpdate(ue.NeedsResize),n=n.parentNode}while(n instanceof HTMLElement);s=this.pixelRatio,t.width=e*s,t.height=i*s,t.style.width=e+"px",t.style.height=i+"px"}else e=Math.floor(t.width),i=Math.floor(t.height),s=1;this.viewFrame=new l.R2Box(0,0,e,i)}clearCanvas(){const t=this.renderer.value;if(t instanceof Ei){const e=this.viewFrame;t.context.clearRect(0,0,e.width,e.height)}else if(t instanceof Ui){const e=t.context;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}}resetRenderer(){const t=this.renderer.value;if(t instanceof Ei){const e=this.pixelRatio;t.context.setTransform(e,0,0,e,0,0)}else if(t instanceof Ui){const e=this.viewFrame;t.context.viewport(0,0,e.width,e.height)}}},(()=>{var l;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(l=L[Symbol.metadata])&&void 0!==l?l:null):void 0;i=[e.Provider({serviceType:zi,inherits:!1,createService:()=>new zi})],s=[e.Property({valueType:Fi,inherits:!0,initValue(){return this.owner.createRenderer()},didSetValue(t){this.owner.resetRenderer()},fromLike(t){return"string"==typeof t&&(t=this.owner.createRenderer(t)),t}})],n=[e.Property({valueType:Boolean,value:!0,didSetValue(t){this.owner.click.enabled=t,this.owner.dblclick.enabled=t,this.owner.contextmenu.enabled=t}})],r=[e.Property({valueType:Boolean,value:!1,didSetValue(t){this.owner.wheel.enabled=t}})],o=[e.Property({valueType:Boolean,value:!1,didSetValue(t){this.owner.mouseenter.enabled=t,this.owner.mouseleave.enabled=t,this.owner.mousedown.enabled=t}})],a=[e.Property({valueType:Boolean,value:!1,didSetValue(t){this.owner.pointerenter.enabled=t,this.owner.pointerleave.enabled=t,this.owner.pointerdown.enabled=t}})],h=[e.Property({valueType:Boolean,value:!1,didSetValue(t){this.owner.touchstart.enabled=t}})],c=[e.EventHandler({eventType:"click",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.clickEvents.value},handle(t){const e=this.owner.mouse;null!==e&&this.owner.updateMouse(e,t),this.owner.fireMouseEvent(t)}})],f=[e.EventHandler({eventType:"dblclick",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.clickEvents.value},handle(t){const e=this.owner.mouse;null!==e&&this.owner.updateMouse(e,t),this.owner.fireMouseEvent(t)}})],p=[e.EventHandler({eventType:"contextmenu",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.clickEvents.value},handle(t){const e=this.owner.mouse;null!==e&&this.owner.updateMouse(e,t),this.owner.fireMouseEvent(t)}})],g=[e.EventHandler({eventType:"wheel",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.wheelEvents.value},handle(t){const e=this.owner.mouse;null!==e&&this.owner.updateMouse(e,t),this.owner.fireMouseEvent(t)}})],m=[e.EventHandler({eventType:"mouseenter",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.mouseEvents.value},handle(t){let e=this.owner.mouse;null===e&&(e={},this.owner.mouse=e),this.owner.mousemove.enabled=!0,this.owner.updateMouse(e,t)}})],v=[e.EventHandler({eventType:"mouseleave",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.mouseEvents.value},handle(t){this.owner.mouse=null,this.owner.mousemove.enabled=!1}})],w=[e.EventHandler({eventType:"mousedown",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.mouseEvents.value},handle(t){let e=this.owner.mouse;null===e&&(e={},this.owner.mouse=e),this.owner.mouseup.enabled=!0,this.owner.updateMouse(e,t),this.owner.fireMouseEvent(t)}})],y=[e.EventHandler({eventType:"mousemove",enabled:!1,initTarget:()=>document.body,handle(t){let e=this.owner.mouse;null===e&&(e={},this.owner.mouse=e),this.owner.updateMouse(e,t);let i=e.targetView;void 0===i&&(i=null);const s=this.owner.fireMouseEvent(t);s!==i&&this.owner.onMouseTargetChange(e,s,i)},didUnmount(){this.enabled=!1,super.didUnmount()}})],b=[e.EventHandler({eventType:"mouseup",enabled:!1,initTarget:()=>document.body,handle(t){const e=this.owner.mouse;null!==e&&this.owner.updateMouse(e,t),this.owner.fireMouseEvent(t),this.owner.mouseup.enabled=!1},didUnmount(){this.enabled=!1,super.didUnmount()}})],C=[e.EventHandler({eventType:"pointerenter",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.pointerEvents.value},handle(t){const e=""+t.pointerId;let i=this.owner.pointers;null===i&&(i={},this.owner.pointers=i);let s=i[e];void 0===s&&(s={},i[e]=s),this.owner.pointermove.enabled=!0,this.owner.pointerup.enabled=!0,this.owner.pointercancel.enabled=!0,this.owner.updatePointer(s,t)}})],T=[e.EventHandler({eventType:"pointerleave",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.pointerEvents.value},handle(t){const e=""+t.pointerId;let i=this.owner.pointers;null===i&&(i={},this.owner.pointers=i);const s=i[e];void 0!==s&&(void 0!==s.targetView&&this.owner.onPointerTargetChange(s,null,s.targetView),delete i[e],0===Object.keys(i).length&&(this.owner.pointermove.enabled=!1,this.owner.pointerup.enabled=!1,this.owner.pointercancel.enabled=!1))}})],S=[e.EventHandler({eventType:"pointerdown",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.pointerEvents.value},handle(t){const e=""+t.pointerId;let i=this.owner.pointers;null===i&&(i={},this.owner.pointers=i);let s=i[e];void 0===s&&(s={},i[e]=s),this.owner.pointermove.enabled=!0,this.owner.pointerup.enabled=!0,this.owner.pointercancel.enabled=!0,this.owner.updatePointer(s,t),this.owner.firePointerEvent(t)}})],x=[e.EventHandler({eventType:"pointermove",enabled:!1,initTarget:()=>document.body,handle(t){const e=""+t.pointerId;let i=this.owner.pointers;null===i&&(i={},this.owner.pointers=i);let s=i[e];void 0===s&&(s={},i[e]=s),this.owner.pointermove.enabled=!0,this.owner.pointerup.enabled=!0,this.owner.pointercancel.enabled=!0,this.owner.updatePointer(s,t);let n=s.targetView;void 0===n&&(n=null);const r=this.owner.firePointerEvent(t);r!==n&&this.owner.onPointerTargetChange(s,r,n)},didUnmount(){this.enabled=!1,super.didUnmount()}})],M=[e.EventHandler({eventType:"pointerup",enabled:!1,initTarget:()=>document.body,handle(t){const e=""+t.pointerId;let i=this.owner.pointers;null===i&&(i={},this.owner.pointers=i);const s=i[e];void 0!==s&&this.owner.updatePointer(s,t),this.owner.firePointerEvent(t),void 0!==s&&"mouse"!==t.pointerType&&(void 0!==s.targetView&&this.owner.onPointerTargetChange(s,null,s.targetView),delete i[e],0===Object.keys(i).length&&(this.owner.pointermove.enabled=!1,this.owner.pointerup.enabled=!1,this.owner.pointercancel.enabled=!1))},didUnmount(){this.enabled=!1,super.didUnmount()}})],A=[e.EventHandler({eventType:"pointercancel",enabled:!1,initTarget:()=>document.body,handle(t){const e=""+t.pointerId;let i=this.owner.pointers;null===i&&(i={},this.owner.pointers=i);const s=i[e];void 0!==s&&this.owner.updatePointer(s,t),this.owner.firePointerEvent(t),void 0!==s&&"mouse"!==t.pointerType&&(void 0!==s.targetView&&this.owner.onPointerTargetChange(s,null,s.targetView),delete i[e],0===Object.keys(i).length&&(this.owner.pointermove.enabled=!1,this.owner.pointerup.enabled=!1,this.owner.pointercancel.enabled=!1))},didUnmount(){this.enabled=!1,super.didUnmount()}})],F=[e.EventHandler({eventType:"touchstart",bindsOwner:!0,enabled:!1,init(){this.enabled=this.owner.touchEvents.value},handle(t){let e,i=this.owner.touches;null===i&&(i={},this.owner.touches=i);const s=t.changedTouches;for(let t=0;t<s.length;t+=1){const n=s[t],r=""+n.identifier;let o=i[r];void 0===o&&(o={identifier:n.identifier,target:n.target},i[r]=o),this.owner.touchmove.enabled=!0,this.owner.touchend.enabled=!0,this.owner.touchcancel.enabled=!0,this.owner.updateTouch(o,n);const l=o.clientX,a=o.clientY;if(void 0===e&&(e=this.owner.clientBounds),e.contains(l,a)){const t=l-e.x,i=a-e.y,s=this.owner.cascadeHitTest(t,i);null!==s&&(o.targetView=s,n.targetView=s)}}this.owner.fireTouchEvent("touchstart",t)}})],k=[e.EventHandler({eventType:"touchmove",bindsOwner:!0,enabled:!1,handle(t){let e=this.owner.touches;null===e&&(e={},this.owner.touches=e);const i=t.changedTouches;for(let t=0;t<i.length;t+=1){const s=i[t],n=""+s.identifier;let r=e[n];void 0===r&&(r={identifier:s.identifier,target:s.target},e[n]=r),this.owner.updateTouch(r,s),s.targetView=r.targetView}this.owner.fireTouchEvent("touchmove",t)},didUnmount(){this.enabled=!1,super.didUnmount()}})],P=[e.EventHandler({eventType:"touchend",bindsOwner:!0,enabled:!1,handle(t){let e=this.owner.touches;null===e&&(e={},this.owner.touches=e);const i=t.changedTouches;for(let t=0;t<i.length;t+=1){const s=i[t],n=""+s.identifier;let r=e[n];void 0===r&&(r={identifier:s.identifier,target:s.target},e[n]=r),this.owner.updateTouch(r,s),s.targetView=r.targetView}this.owner.fireTouchEvent("touchend",t);for(let t=0;t<i.length;t+=1){delete e[""+i[t].identifier],0===Object.keys(e).length&&(this.owner.touchmove.enabled=!1,this.owner.touchend.enabled=!1,this.owner.touchcancel.enabled=!1)}},didUnmount(){this.enabled=!1,super.didUnmount()}})],V=[e.EventHandler({eventType:"touchcancel",bindsOwner:!0,enabled:!1,handle(t){let e=this.owner.touches;null===e&&(e={},this.owner.touches=e);const i=t.changedTouches;for(let t=0;t<i.length;t+=1){const s=i[t],n=""+s.identifier;let r=e[n];void 0===r&&(r={identifier:s.identifier,target:s.target},e[n]=r),this.owner.updateTouch(r,s),s.targetView=r.targetView}this.owner.fireTouchEvent("touchcancel",t);for(let t=0;t<i.length;t+=1){delete e[""+i[t].identifier],0===Object.keys(e).length&&(this.owner.touchmove.enabled=!1,this.owner.touchend.enabled=!1,this.owner.touchcancel.enabled=!1)}},didUnmount(){this.enabled=!1,super.didUnmount()}})],d(t,null,i,{kind:"getter",name:"sprites",static:!1,private:!1,access:{has:t=>"sprites"in t,get:t=>t.sprites},metadata:u},null,R),d(null,null,s,{kind:"field",name:"renderer",static:!1,private:!1,access:{has:t=>"renderer"in t,get:t=>t.renderer,set:(t,e)=>{t.renderer=e}},metadata:u},I,R),d(null,null,n,{kind:"field",name:"clickEvents",static:!1,private:!1,access:{has:t=>"clickEvents"in t,get:t=>t.clickEvents,set:(t,e)=>{t.clickEvents=e}},metadata:u},O,R),d(null,null,r,{kind:"field",name:"wheelEvents",static:!1,private:!1,access:{has:t=>"wheelEvents"in t,get:t=>t.wheelEvents,set:(t,e)=>{t.wheelEvents=e}},metadata:u},D,R),d(null,null,o,{kind:"field",name:"mouseEvents",static:!1,private:!1,access:{has:t=>"mouseEvents"in t,get:t=>t.mouseEvents,set:(t,e)=>{t.mouseEvents=e}},metadata:u},E,R),d(null,null,a,{kind:"field",name:"pointerEvents",static:!1,private:!1,access:{has:t=>"pointerEvents"in t,get:t=>t.pointerEvents,set:(t,e)=>{t.pointerEvents=e}},metadata:u},U,R),d(null,null,h,{kind:"field",name:"touchEvents",static:!1,private:!1,access:{has:t=>"touchEvents"in t,get:t=>t.touchEvents,set:(t,e)=>{t.touchEvents=e}},metadata:u},N,R),d(null,null,c,{kind:"field",name:"click",static:!1,private:!1,access:{has:t=>"click"in t,get:t=>t.click,set:(t,e)=>{t.click=e}},metadata:u},q,R),d(null,null,f,{kind:"field",name:"dblclick",static:!1,private:!1,access:{has:t=>"dblclick"in t,get:t=>t.dblclick,set:(t,e)=>{t.dblclick=e}},metadata:u},z,R),d(null,null,p,{kind:"field",name:"contextmenu",static:!1,private:!1,access:{has:t=>"contextmenu"in t,get:t=>t.contextmenu,set:(t,e)=>{t.contextmenu=e}},metadata:u},j,R),d(null,null,g,{kind:"field",name:"wheel",static:!1,private:!1,access:{has:t=>"wheel"in t,get:t=>t.wheel,set:(t,e)=>{t.wheel=e}},metadata:u},W,R),d(null,null,m,{kind:"field",name:"mouseenter",static:!1,private:!1,access:{has:t=>"mouseenter"in t,get:t=>t.mouseenter,set:(t,e)=>{t.mouseenter=e}},metadata:u},H,R),d(null,null,v,{kind:"field",name:"mouseleave",static:!1,private:!1,access:{has:t=>"mouseleave"in t,get:t=>t.mouseleave,set:(t,e)=>{t.mouseleave=e}},metadata:u},K,R),d(null,null,w,{kind:"field",name:"mousedown",static:!1,private:!1,access:{has:t=>"mousedown"in t,get:t=>t.mousedown,set:(t,e)=>{t.mousedown=e}},metadata:u},B,R),d(null,null,y,{kind:"field",name:"mousemove",static:!1,private:!1,access:{has:t=>"mousemove"in t,get:t=>t.mousemove,set:(t,e)=>{t.mousemove=e}},metadata:u},G,R),d(null,null,b,{kind:"field",name:"mouseup",static:!1,private:!1,access:{has:t=>"mouseup"in t,get:t=>t.mouseup,set:(t,e)=>{t.mouseup=e}},metadata:u},Y,R),d(null,null,C,{kind:"field",name:"pointerenter",static:!1,private:!1,access:{has:t=>"pointerenter"in t,get:t=>t.pointerenter,set:(t,e)=>{t.pointerenter=e}},metadata:u},X,R),d(null,null,T,{kind:"field",name:"pointerleave",static:!1,private:!1,access:{has:t=>"pointerleave"in t,get:t=>t.pointerleave,set:(t,e)=>{t.pointerleave=e}},metadata:u},_,R),d(null,null,S,{kind:"field",name:"pointerdown",static:!1,private:!1,access:{has:t=>"pointerdown"in t,get:t=>t.pointerdown,set:(t,e)=>{t.pointerdown=e}},metadata:u},Q,R),d(null,null,x,{kind:"field",name:"pointermove",static:!1,private:!1,access:{has:t=>"pointermove"in t,get:t=>t.pointermove,set:(t,e)=>{t.pointermove=e}},metadata:u},J,R),d(null,null,M,{kind:"field",name:"pointerup",static:!1,private:!1,access:{has:t=>"pointerup"in t,get:t=>t.pointerup,set:(t,e)=>{t.pointerup=e}},metadata:u},Z,R),d(null,null,A,{kind:"field",name:"pointercancel",static:!1,private:!1,access:{has:t=>"pointercancel"in t,get:t=>t.pointercancel,set:(t,e)=>{t.pointercancel=e}},metadata:u},$,R),d(null,null,F,{kind:"field",name:"touchstart",static:!1,private:!1,access:{has:t=>"touchstart"in t,get:t=>t.touchstart,set:(t,e)=>{t.touchstart=e}},metadata:u},tt,R),d(null,null,k,{kind:"field",name:"touchmove",static:!1,private:!1,access:{has:t=>"touchmove"in t,get:t=>t.touchmove,set:(t,e)=>{t.touchmove=e}},metadata:u},et,R),d(null,null,P,{kind:"field",name:"touchend",static:!1,private:!1,access:{has:t=>"touchend"in t,get:t=>t.touchend,set:(t,e)=>{t.touchend=e}},metadata:u},it,R),d(null,null,V,{kind:"field",name:"touchcancel",static:!1,private:!1,access:{has:t=>"touchcancel"in t,get:t=>t.touchcancel,set:(t,e)=>{t.touchcancel=e}},metadata:u},st,R),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u})})(),t.tag="canvas",t.UncullFlags=wi.UncullFlags|ue.NeedsRender|ue.NeedsComposite,t.UnhideFlags=wi.UnhideFlags|ue.NeedsRender|ue.NeedsComposite,t})(),Wi=(()=>{var t;let i,s,n,r,o=Pi,a=[],h=[],c=[],f=[],p=[];return t=class extends o{constructor(){super(),this.opacity=(u(this,a),u(this,h,void 0)),this.compositeOperation=u(this,c,void 0),this.compositor=u(this,f,void 0),this.renderer=u(this,p,void 0),this.canvas=this.createCanvas(),this.ownRasterFrame=null,this.renderer.value=this.createRenderer()}get pixelRatio(){return window.devicePixelRatio||1}createRenderer(t="canvas"){if("canvas"===t){const t=this.canvas.getContext("2d");if(null===t)throw new Error("Failed to create canvas rendering context");return new Ei(t,l.Transform.identity(),this.pixelRatio)}if("webgl"===t){const t=this.canvas.getContext("webgl");if(null===t)throw new Error("Failed to create webgl rendering context");return new Ui(t,this.pixelRatio)}throw new Error("Failed to create "+t+" renderer")}needsUpdate(t,e){const i=(t=super.needsUpdate(t,e))&(ue.NeedsRender|ue.NeedsComposite);return 0!==i&&(t|=ue.NeedsComposite,this.setFlags(this.flags|ue.NeedsDisplay|ue.NeedsComposite|i)),t}needsProcess(t){return 0==(this.flags&ue.ProcessMask)&&0==(t&ue.NeedsResize)&&(t=0),t}onResize(){super.onResize(),this.requireUpdate(ue.NeedsRender|ue.NeedsComposite)}needsDisplay(t){return 0!=(this.flags&ue.DisplayMask)?t|=ue.NeedsComposite:t=0!=(t&ue.NeedsComposite)?ue.NeedsDisplay|ue.NeedsComposite:0,t}onRender(){const t=this.rasterFrame;this.resizeCanvas(this.canvas,t),this.resetRenderer(t),this.clearCanvas(t),super.onRender()}didComposite(){this.compositeImage(),super.didComposite()}get rasterFrame(){let t=this.ownRasterFrame;return null===t&&(t=this.deriveRasterFrame()),t}setRasterFrame(t){this.ownRasterFrame=t}deriveRasterFrame(){return this.viewBounds}createCanvas(){return document.createElement("canvas")}resizeCanvas(t,e){const i=this.pixelRatio,s=e.width,n=e.height,r=s*i,o=n*i,l=t.width,a=t.height;r===l&&o===a||(t.width=r,t.height=o,t.style.width=s+"px",t.style.height=n+"px")}clearCanvas(t){const e=this.renderer.value;if(e instanceof Ei)e.context.clearRect(0,0,t.xMax,t.yMax);else if(e instanceof Ui){const t=e.context;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}}resetRenderer(t){const e=this.renderer.value;if(e instanceof Ei){const i=this.pixelRatio,s=t.xMin*i,n=t.yMin*i;e.context.setTransform(i,0,0,i,-s,-n),e.setTransform(l.Transform.affine(i,0,0,i,-s,-n))}else e instanceof Ui&&e.context.viewport(t.x,t.y,t.xMax,t.yMax)}compositeImage(){const t=this.compositor.value;if(t instanceof Ei){const e=t.context,i=this.rasterFrame,s=this.canvas;if(i.isDefined()&&0!==i.width&&0!==i.height&&0!==s.width&&0!==s.height){const t=e.globalAlpha,n=e.globalCompositeOperation;e.globalAlpha=this.opacity.getValue(),e.globalCompositeOperation=this.compositeOperation.getValue(),e.drawImage(s,i.x,i.y,i.width,i.height),e.globalAlpha=t,e.globalCompositeOperation=n}}}},(()=>{var l;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(l=o[Symbol.metadata])&&void 0!==l?l:null):void 0;i=[Qt({valueType:Number,value:1,updateFlags:ue.NeedsComposite})],s=[e.Property({valueType:String,value:"source-over",updateFlags:ue.NeedsComposite})],n=[e.Property({valueType:Fi,value:null,inherits:"renderer"})],r=[e.Property({extends:!0,inherits:!1,updateFlags:ue.NeedsRender|ue.NeedsComposite,fromLike(t){return"string"==typeof t&&(t=this.owner.createRenderer(t)),t}})],d(null,null,i,{kind:"field",name:"opacity",static:!1,private:!1,access:{has:t=>"opacity"in t,get:t=>t.opacity,set:(t,e)=>{t.opacity=e}},metadata:u},h,a),d(null,null,s,{kind:"field",name:"compositeOperation",static:!1,private:!1,access:{has:t=>"compositeOperation"in t,get:t=>t.compositeOperation,set:(t,e)=>{t.compositeOperation=e}},metadata:u},c,a),d(null,null,n,{kind:"field",name:"compositor",static:!1,private:!1,access:{has:t=>"compositor"in t,get:t=>t.compositor,set:(t,e)=>{t.compositor=e}},metadata:u},f,a),d(null,null,r,{kind:"field",name:"renderer",static:!1,private:!1,access:{has:t=>"renderer"in t,get:t=>t.renderer,set:(t,e)=>{t.renderer=e}},metadata:u},p,a),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u})})(),t.MountFlags=Pi.MountFlags|ue.NeedsComposite,t.UncullFlags=Pi.UncullFlags|ue.NeedsComposite,t.UnhideFlags=Pi.UnhideFlags|ue.NeedsComposite,t})();Object.defineProperty(Wi.prototype,"viewBounds",{get(){return this.deriveViewBounds()},configurable:!0});const Hi={[Symbol.hasInstance]:t=>t instanceof Pi&&"fill"in t},Ki={[Symbol.hasInstance]:t=>t instanceof Pi&&"stroke"in t&&"strokeWidth"in t};class Bi{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}withX(t){return t=l.Length.fromLike(t),this.x.equals(t)?this:this.copy(t,this.y,this.width,this.height)}withY(t){return t=l.Length.fromLike(t),this.y.equals(t)?this:this.copy(this.x,t,this.width,this.height)}withWidth(t){return t=l.Length.fromLike(t),this.width.equals(t)?this:this.copy(this.x,this.y,t,this.height)}withHeight(t){return t=l.Length.fromLike(t),this.height.equals(t)?this:this.copy(this.x,this.y,this.width,t)}render(t,e){if(void 0===t){const t=new Li;return t.setPrecision(3),this.draw(t,e),t.toString()}t instanceof Ri&&this.draw(t.context,e)}draw(t,e=null){this.renderRect(t,e)}renderRect(t,e){t.rect(this.x.pxValue(),this.y.pxValue(),this.width.pxValue(),this.height.pxValue())}copy(t,e,i,s){return new Bi(t,e,i,s)}toLike(){return{x:this.x,y:this.y,width:this.width,height:this.height}}equals(t){return this===t||t instanceof Bi&&(this.x.equals(t.x)&&this.y.equals(t.y)&&this.width.equals(t.width)&&this.height.equals(t.height))}debug(t){return t=t.write("Rect").write(46).write("create").write(40).debug(this.x).write(", ").debug(this.y).write(", ").debug(this.width).write(", ").debug(this.height).write(41)}toString(){return o.Format.debug(this)}static create(t,e,i,s){return t=l.Length.fromLike(t),e=l.Length.fromLike(e),i=l.Length.fromLike(i),s=l.Length.fromLike(s),new Bi(t,e,i,s)}static fromLike(t){if(null==t||t instanceof Bi)return t;if("object"==typeof t)return Bi.create(t.x,t.y,t.width,t.height);throw new TypeError(""+t)}}let Gi=(()=>{var t;let i,s,n,r,o,a,h,c=Pi,f=[],p=[],g=[],m=[],v=[],w=[],y=[],b=[];return t=class extends c{constructor(){super(...arguments),this.x=(u(this,f),u(this,p,void 0)),this.y=u(this,g,void 0),this.width=u(this,m,void 0),this.height=u(this,v,void 0),this.fill=u(this,w,void 0),this.stroke=u(this,y,void 0),this.strokeWidth=u(this,b,void 0)}get value(){return new Bi(this.x.getValue(),this.y.getValue(),this.width.getValue(),this.height.getValue())}get state(){return new Bi(this.x.getState(),this.y.getState(),this.width.getState(),this.height.getState())}setState(t,e){t instanceof Bi&&(t=t.toLike()),void 0!==t.x&&this.x.setState(t.x,e),void 0!==t.y&&this.y.setState(t.y,e),void 0!==t.width&&this.width.setState(t.width,e),void 0!==t.height&&this.height.setState(t.height,e)}onRender(){super.onRender();const t=this.renderer.value;t instanceof Ii&&!this.hidden&&!this.culled&&this.renderRect(t.context,this.viewFrame)}renderRect(t,e){const i=this.x.getValue().pxValue(e.width),s=this.y.getValue().pxValue(e.height),n=this.width.getValue().pxValue(e.width),r=this.height.getValue().pxValue(e.height),o=t.fillStyle,l=t.lineWidth,a=t.strokeStyle;t.beginPath(),t.rect(i,s,n,r);const h=this.fill.value;null!==h&&(t.fillStyle=h.toString(),t.fill());const d=this.stroke.value;if(null!==d){const i=this.strokeWidth.value;if(null!==i){const s=Math.min(e.width,e.height);t.lineWidth=i.pxValue(s)}t.strokeStyle=d.toString(),t.stroke()}t.fillStyle=o,t.lineWidth=l,t.strokeStyle=a}hitTest(t,e){const i=this.renderer.value;if(i instanceof Ei){const s=i.transform.transform(t,e);return this.hitTestRect(s.x,s.y,i.context,this.viewFrame)}return null}hitTestRect(t,e,i,s){const n=this.x.getValue().pxValue(s.width),r=this.y.getValue().pxValue(s.height),o=this.width.getValue().pxValue(s.width),l=this.height.getValue().pxValue(s.height);if(i.beginPath(),i.rect(n,r,o,l),null!==this.fill.value&&i.isPointInPath(t,e))return this;let a;if(null===this.stroke.value||null===(a=this.strokeWidth.value))return null;const h=i.lineWidth,d=Math.min(s.width,s.height);i.lineWidth=a.pxValue(d);const u=i.isPointInStroke(t,e);return i.lineWidth=h,u?this:null}},(()=>{var u;const C="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=c[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[e.Animator({valueType:l.Length,value:l.Length.zero(),updateFlags:ue.NeedsRender})],s=[e.Animator({valueType:l.Length,value:l.Length.zero(),updateFlags:ue.NeedsRender})],n=[e.Animator({valueType:l.Length,value:l.Length.zero(),updateFlags:ue.NeedsRender})],r=[e.Animator({valueType:l.Length,value:l.Length.zero(),updateFlags:ue.NeedsRender})],o=[_t({valueType:z,value:null,inherits:!0,updateFlags:ue.NeedsRender})],a=[_t({valueType:z,value:null,inherits:!0,updateFlags:ue.NeedsRender})],h=[_t({valueType:l.Length,value:null,inherits:!0,updateFlags:ue.NeedsRender})],d(null,null,i,{kind:"field",name:"x",static:!1,private:!1,access:{has:t=>"x"in t,get:t=>t.x,set:(t,e)=>{t.x=e}},metadata:C},p,f),d(null,null,s,{kind:"field",name:"y",static:!1,private:!1,access:{has:t=>"y"in t,get:t=>t.y,set:(t,e)=>{t.y=e}},metadata:C},g,f),d(null,null,n,{kind:"field",name:"width",static:!1,private:!1,access:{has:t=>"width"in t,get:t=>t.width,set:(t,e)=>{t.width=e}},metadata:C},m,f),d(null,null,r,{kind:"field",name:"height",static:!1,private:!1,access:{has:t=>"height"in t,get:t=>t.height,set:(t,e)=>{t.height=e}},metadata:C},v,f),d(null,null,o,{kind:"field",name:"fill",static:!1,private:!1,access:{has:t=>"fill"in t,get:t=>t.fill,set:(t,e)=>{t.fill=e}},metadata:C},w,f),d(null,null,a,{kind:"field",name:"stroke",static:!1,private:!1,access:{has:t=>"stroke"in t,get:t=>t.stroke,set:(t,e)=>{t.stroke=e}},metadata:C},y,f),d(null,null,h,{kind:"field",name:"strokeWidth",static:!1,private:!1,access:{has:t=>"strokeWidth"in t,get:t=>t.strokeWidth,set:(t,e)=>{t.strokeWidth=e}},metadata:C},b,f),C&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:C})})(),t})();Object.defineProperty(Gi.prototype,"viewBounds",{get(){const t=this.viewFrame,e=this.x.getValue().pxValue(t.width),i=this.y.getValue().pxValue(t.height),s=this.width.getValue().pxValue(t.width),n=this.height.getValue().pxValue(t.height);return new l.R2Box(e,i,e+s,i+n)},configurable:!0});class Yi{constructor(t,e,i,s,n,r,o,l){this.center=t,this.innerRadius=e,this.outerRadius=i,this.startAngle=s,this.sweepAngle=n,this.padAngle=r,this.padRadius=o,this.cornerRadius=l}withCenter(t){return t=l.R2Point.fromLike(t),this.center.equals(t)?this:this.copy(t,this.innerRadius,this.outerRadius,this.startAngle,this.sweepAngle,this.padAngle,this.padRadius,this.cornerRadius)}withInnerRadius(t){return t=l.Length.fromLike(t),this.innerRadius.equals(t)?this:this.copy(this.center,t,this.outerRadius,this.startAngle,this.sweepAngle,this.padAngle,this.padRadius,this.cornerRadius)}withOuterRadius(t){return t=l.Length.fromLike(t),this.outerRadius.equals(t)?this:this.copy(this.center,this.innerRadius,t,this.startAngle,this.sweepAngle,this.padAngle,this.padRadius,this.cornerRadius)}withStartAngle(t){return t=l.Angle.fromLike(t),this.startAngle.equals(t)?this:this.copy(this.center,this.innerRadius,this.outerRadius,t,this.sweepAngle,this.padAngle,this.padRadius,this.cornerRadius)}withSweepAngle(t){return t=l.Angle.fromLike(t),this.sweepAngle.equals(t)?this:this.copy(this.center,this.innerRadius,this.outerRadius,this.startAngle,t,this.padAngle,this.padRadius,this.cornerRadius)}withPadAngle(t){return t=l.Angle.fromLike(t),this.padAngle.equals(t)?this:this.copy(this.center,this.innerRadius,this.outerRadius,this.startAngle,this.sweepAngle,t,this.padRadius,this.cornerRadius)}withPadRadius(t){return null!==t&&(t=l.Length.fromLike(t)),r.Equals(this.padRadius,t)?this:this.copy(this.center,this.innerRadius,this.outerRadius,this.startAngle,this.sweepAngle,this.padAngle,t,this.cornerRadius)}withCornerRadius(t){return t=l.Length.fromLike(t),this.cornerRadius.equals(t)?this:this.copy(this.center,this.innerRadius,this.outerRadius,this.startAngle,this.sweepAngle,this.padAngle,this.padRadius,t)}render(t,e){if(void 0===t){const t=new Li;return t.setPrecision(3),this.draw(t,e),t.toString()}t instanceof Ri&&this.draw(t.context,e)}draw(t,e){this.renderArc(t,e)}renderArc(t,e){let i;void 0!==e&&(i=Math.min(e.width,e.height));const s=this.center,n=s.x,r=s.y;let o=this.innerRadius.pxValue(i),l=this.outerRadius.pxValue(i);const a=this.startAngle.radValue(),h=this.sweepAngle.radValue(),d=a+h,u=h>=0;if(l<o){const t=l;l=o,o=t}if(l>Yi.Epsilon)if(h>2*Math.PI-Yi.Epsilon)t.moveTo(n+l*Math.cos(a),r+l*Math.sin(a)),t.arc(n,r,l,a,d,!u),o>Yi.Epsilon&&(t.moveTo(n+o*Math.cos(d),r+o*Math.sin(d)),t.arc(n,r,o,d,a,u));else{let e=a,s=d,c=a,f=d,p=h,g=h;const m=this.padAngle.radValue()/2,v=+(m>Yi.Epsilon)&&(null!==this.padRadius?this.padRadius.pxValue(i):Math.sqrt(o*o+l*l)),w=Math.min(Math.abs(l-o)/2,this.cornerRadius.pxValue(i));let y,b,C=w,T=w;if(v>Yi.Epsilon){let t=Math.asin(v/o*Math.sin(m)),i=Math.asin(v/l*Math.sin(m));(p-=2*t)>Yi.Epsilon?(t*=u?1:-1,c+=t,f-=t):(p=0,c=f=(a+d)/2),(g-=2*i)>Yi.Epsilon?(i*=u?1:-1,e+=i,s-=i):(g=0,e=s=(a+d)/2)}const S=l*Math.cos(e),x=l*Math.sin(e),M=o*Math.cos(f),A=o*Math.sin(f);let F,k;if(w>Yi.Epsilon&&(F=l*Math.cos(s),k=l*Math.sin(s),y=o*Math.cos(c),b=o*Math.sin(c),h<Math.PI)){const t=p>Yi.Epsilon?Yi.intersect(S,x,y,b,F,k,M,A):[M,A],e=S-t[0],i=x-t[1],s=F-t[0],n=k-t[1],r=1/Math.sin(.5*Math.acos((e*s+i*n)/(Math.sqrt(e*e+i*i)*Math.sqrt(s*s+n*n)))),a=Math.sqrt(t[0]*t[0]+t[1]*t[1]);C=Math.min(w,(o-a)/(r-1)),T=Math.min(w,(l-a)/(r+1))}if(g>Yi.Epsilon)if(T>Yi.Epsilon){const e=Yi.cornerTangents(y,b,S,x,l,T,u),i=Yi.cornerTangents(F,k,M,A,l,T,u);t.moveTo(n+e.cx+e.x01,r+e.cy+e.y01),T<w?t.arc(n+e.cx,r+e.cy,T,Math.atan2(e.y01,e.x01),Math.atan2(i.y01,i.x01),!u):(t.arc(n+e.cx,r+e.cy,T,Math.atan2(e.y01,e.x01),Math.atan2(e.y11,e.x11),!u),t.arc(n,r,l,Math.atan2(e.cy+e.y11,e.cx+e.x11),Math.atan2(i.cy+i.y11,i.cx+i.x11),!u),t.arc(n+i.cx,r+i.cy,T,Math.atan2(i.y11,i.x11),Math.atan2(i.y01,i.x01),!u))}else t.moveTo(n+S,r+x),t.arc(n,r,l,e,s,!u);else t.moveTo(n+S,r+x);if(o>Yi.Epsilon&&p>Yi.Epsilon)if(C>Yi.Epsilon){const e=Yi.cornerTangents(M,A,F,k,o,-C,u),i=Yi.cornerTangents(S,x,y,b,o,-C,u);t.lineTo(n+e.cx+e.x01,r+e.cy+e.y01),C<w?t.arc(n+e.cx,r+e.cy,C,Math.atan2(e.y01,e.x01),Math.atan2(i.y01,i.x01),!u):(t.arc(n+e.cx,r+e.cy,C,Math.atan2(e.y01,e.x01),Math.atan2(e.y11,e.x11),!u),t.arc(n,r,o,Math.atan2(e.cy+e.y11,e.cx+e.x11),Math.atan2(i.cy+i.y11,i.cx+i.x11),u),t.arc(n+i.cx,r+i.cy,C,Math.atan2(i.y11,i.x11),Math.atan2(i.y01,i.x01),!u))}else t.arc(n,r,o,f,c,u);else t.lineTo(n+M,r+A)}else t.moveTo(n,r);t.closePath()}copy(t,e,i,s,n,r,o,l){return new Yi(t,e,i,s,n,r,o,l)}toLike(){return{center:this.center,innerRadius:this.innerRadius,outerRadius:this.outerRadius,startAngle:this.startAngle,sweepAngle:this.sweepAngle,padAngle:this.padAngle,padRadius:this.padRadius,cornerRadius:this.cornerRadius}}equals(t){return this===t||t instanceof Yi&&(this.center.equals(t.center)&&this.innerRadius.equals(t.innerRadius)&&this.outerRadius.equals(t.outerRadius)&&this.startAngle.equals(t.startAngle)&&this.sweepAngle.equals(t.sweepAngle)&&this.padAngle.equals(t.padAngle)&&r.Equals(this.padRadius,t.padRadius)&&this.cornerRadius.equals(t.cornerRadius))}debug(t){return t=t.write("Arc").write(46).write("create").write(40).write(41),this.center.isDefined()&&(t=t.write(46).write("center").write(40).debug(this.center).write(41)),this.innerRadius.isDefined()&&(t=t.write(46).write("innerRadius").write(40).debug(this.innerRadius).write(41)),this.outerRadius.isDefined()&&(t=t.write(46).write("outerRadius").write(40).debug(this.outerRadius).write(41)),this.startAngle.isDefined()&&(t=t.write(46).write("startAngle").write(40).debug(this.startAngle).write(41)),this.sweepAngle.isDefined()&&(t=t.write(46).write("sweepAngle").write(40).debug(this.sweepAngle).write(41)),this.padAngle.isDefined()&&(t=t.write(46).write("padAngle").write(40).debug(this.padAngle).write(41)),null!==this.padRadius&&(t=t.write(46).write("padRadius").write(40).debug(this.padRadius).write(41)),this.cornerRadius.isDefined()&&(t=t.write(46).write("cornerRadius").write(40).debug(this.cornerRadius).write(41)),t}toString(){return o.Format.debug(this)}static create(t=l.R2Point.origin(),e=l.Length.zero(),i=l.Length.zero(),s=l.Angle.zero(),n=l.Angle.zero(),r=l.Angle.zero(),o=null,a=l.Length.zero()){return t=l.R2Point.fromLike(t),e=l.Length.fromLike(e),i=l.Length.fromLike(i),s=l.Angle.fromLike(s),n=l.Angle.fromLike(n),r=l.Angle.fromLike(r),o=null!==o?l.Length.fromLike(o):null,a=l.Length.fromLike(a),new Yi(t,e,i,s,n,r,o,a)}static fromLike(t){if(null==t||t instanceof Yi)return t;if("object"==typeof t)return Yi.create(t.center,t.innerRadius,t.outerRadius,t.startAngle,t.sweepAngle,t.padAngle,t.padRadius,t.cornerRadius);throw new TypeError(""+t)}static intersect(t,e,i,s,n,r,o,l){const a=i-t,h=s-e,d=o-n,u=l-r,c=(d*(e-r)-u*(t-n))/(u*a-d*h);return[t+c*a,e+c*h]}static cornerTangents(t,e,i,s,n,r,o){const l=t-i,a=e-s,h=(o?r:-r)/Math.sqrt(l*l+a*a),d=h*a,u=-h*l,c=t+d,f=e+u,p=i+d,g=s+u,m=(c+p)/2,v=(f+g)/2,w=p-c,y=g-f,b=w*w+y*y,C=n-r,T=c*g-p*f,S=(y<0?-1:1)*Math.sqrt(Math.max(0,C*C*b-T*T));let x=(T*y-w*S)/b,M=(-T*w-y*S)/b;const A=(T*y+w*S)/b,F=(-T*w+y*S)/b,k=x-m,P=M-v,V=A-m,L=F-v;return k*k+P*P>V*V+L*L&&(x=A,M=F),{cx:x,cy:M,x01:-d,y01:-u,x11:x*(n/C-1),y11:M*(n/C-1)}}}Yi.Epsilon=1e-12;let Xi=(()=>{var t;let i,s,n,r,o,a,h,c,f,p,g,m,v,w=Pi,y=[],b=[],C=[],T=[],S=[],x=[],M=[],A=[],F=[],k=[],P=[],V=[],L=[],R=[];return t=class extends w{constructor(){super(...arguments),this.xAlign=(u(this,y),u(this,b,void 0)),this.yAlign=u(this,C,void 0),this.center=u(this,T,void 0),this.innerRadius=u(this,S,void 0),this.outerRadius=u(this,x,void 0),this.startAngle=u(this,M,void 0),this.sweepAngle=u(this,A,void 0),this.padAngle=u(this,F,void 0),this.padRadius=u(this,k,void 0),this.cornerRadius=u(this,P,void 0),this.fill=u(this,V,void 0),this.stroke=u(this,L,void 0),this.strokeWidth=u(this,R,void 0)}get value(){return new Yi(this.center.value,this.innerRadius.value,this.outerRadius.value,this.startAngle.value,this.sweepAngle.value,this.padAngle.value,this.padRadius.value,this.cornerRadius.value)}get state(){return new Yi(this.center.state,this.innerRadius.state,this.outerRadius.state,this.startAngle.state,this.sweepAngle.state,this.padAngle.state,this.padRadius.state,this.cornerRadius.state)}setState(t,e){t instanceof Yi&&(t=t.toLike()),void 0!==t.center&&this.center.setState(t.center,e),void 0!==t.innerRadius&&this.innerRadius.setState(t.innerRadius,e),void 0!==t.outerRadius&&this.outerRadius.setState(t.outerRadius,e),void 0!==t.startAngle&&this.startAngle.setState(t.startAngle,e),void 0!==t.sweepAngle&&this.sweepAngle.setState(t.sweepAngle,e),void 0!==t.padAngle&&this.padAngle.setState(t.padAngle,e),void 0!==t.padRadius&&this.padRadius.setState(t.padRadius,e),void 0!==t.cornerRadius&&this.cornerRadius.setState(t.cornerRadius,e)}layoutArc(){if(this.center.hasAffinity(e.Affinity.Intrinsic)){const t=this.viewFrame,e=t.xMin+t.width*this.xAlign.getValue(),i=t.yMin+t.height*this.yAlign.getValue();this.center.setIntrinsic(new l.R2Point(e,i))}}onRender(){super.onRender();const t=this.renderer.value;t instanceof Ii&&!this.hidden&&!this.culled&&(this.layoutArc(),this.renderArc(t.context,this.viewFrame))}renderArc(t,e){const i=t.fillStyle,s=t.lineWidth,n=t.strokeStyle,r=this.value;t.beginPath(),r.draw(t,e);const o=this.fill.value;null!==o&&(t.fillStyle=o.toString(),t.fill());const l=this.stroke.value;if(null!==l){const i=this.strokeWidth.value;if(null!==i){const s=Math.min(e.width,e.height);t.lineWidth=i.pxValue(s)}t.strokeStyle=l.toString(),t.stroke()}t.fillStyle=i,t.lineWidth=s,t.strokeStyle=n}get popoverFrame(){const t=this.viewFrame,e=Math.min(t.width,t.height),i=this.pageTransform.inverse(),s=this.center.getValue(),n=i.transformX(s.x,s.y),r=i.transformY(s.x,s.y),o=(this.innerRadius.getValue().pxValue(e)+this.outerRadius.getValue().pxValue(e))/2,a=this.startAngle.getValue().radValue()+this.sweepAngle.getValue().radValue()/2,h=n+o*Math.cos(a),d=r+o*Math.sin(a);return new l.R2Box(h,d,h,d)}hitTest(t,e){const i=this.renderer.value;if(i instanceof Ei){const s=i.transform.transform(t,e);return this.layoutArc(),this.hitTestArc(s.x,s.y,i.context,this.viewFrame)}return null}hitTestArc(t,e,i,s){const n=this.value;let r;if(i.beginPath(),n.draw(i,s),null!==this.fill.value&&i.isPointInPath(t,e))return this;if(null===this.stroke.value||null===(r=this.strokeWidth.value))return null;const o=i.lineWidth,l=Math.min(s.width,s.height);i.lineWidth=r.pxValue(l);const a=i.isPointInStroke(t,e);return i.lineWidth=o,a?this:null}},(()=>{var u;const I="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=w[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[e.Animator({valueType:Number,value:.5,updateFlags:ue.NeedsRender})],s=[e.Animator({valueType:Number,value:.5,updateFlags:ue.NeedsRender})],n=[e.Animator({valueType:l.R2Point,value:l.R2Point.origin(),updateFlags:ue.NeedsRender})],r=[_t({valueType:l.Length,value:l.Length.zero(),updateFlags:ue.NeedsRender})],o=[_t({valueType:l.Length,value:l.Length.zero(),updateFlags:ue.NeedsRender})],a=[_t({valueType:l.Angle,value:l.Angle.zero(),updateFlags:ue.NeedsRender})],h=[_t({valueType:l.Angle,value:l.Angle.zero(),updateFlags:ue.NeedsRender})],c=[_t({valueType:l.Angle,value:l.Angle.zero(),updateFlags:ue.NeedsRender})],f=[_t({valueType:l.Length,value:null,updateFlags:ue.NeedsRender})],p=[_t({valueType:l.Length,value:l.Length.zero(),updateFlags:ue.NeedsRender})],g=[_t({valueType:z,value:null,inherits:!0,updateFlags:ue.NeedsRender})],m=[_t({valueType:z,value:null,inherits:!0,updateFlags:ue.NeedsRender})],v=[_t({valueType:l.Length,value:null,inherits:!0,updateFlags:ue.NeedsRender})],d(null,null,i,{kind:"field",name:"xAlign",static:!1,private:!1,access:{has:t=>"xAlign"in t,get:t=>t.xAlign,set:(t,e)=>{t.xAlign=e}},metadata:I},b,y),d(null,null,s,{kind:"field",name:"yAlign",static:!1,private:!1,access:{has:t=>"yAlign"in t,get:t=>t.yAlign,set:(t,e)=>{t.yAlign=e}},metadata:I},C,y),d(null,null,n,{kind:"field",name:"center",static:!1,private:!1,access:{has:t=>"center"in t,get:t=>t.center,set:(t,e)=>{t.center=e}},metadata:I},T,y),d(null,null,r,{kind:"field",name:"innerRadius",static:!1,private:!1,access:{has:t=>"innerRadius"in t,get:t=>t.innerRadius,set:(t,e)=>{t.innerRadius=e}},metadata:I},S,y),d(null,null,o,{kind:"field",name:"outerRadius",static:!1,private:!1,access:{has:t=>"outerRadius"in t,get:t=>t.outerRadius,set:(t,e)=>{t.outerRadius=e}},metadata:I},x,y),d(null,null,a,{kind:"field",name:"startAngle",static:!1,private:!1,access:{has:t=>"startAngle"in t,get:t=>t.startAngle,set:(t,e)=>{t.startAngle=e}},metadata:I},M,y),d(null,null,h,{kind:"field",name:"sweepAngle",static:!1,private:!1,access:{has:t=>"sweepAngle"in t,get:t=>t.sweepAngle,set:(t,e)=>{t.sweepAngle=e}},metadata:I},A,y),d(null,null,c,{kind:"field",name:"padAngle",static:!1,private:!1,access:{has:t=>"padAngle"in t,get:t=>t.padAngle,set:(t,e)=>{t.padAngle=e}},metadata:I},F,y),d(null,null,f,{kind:"field",name:"padRadius",static:!1,private:!1,access:{has:t=>"padRadius"in t,get:t=>t.padRadius,set:(t,e)=>{t.padRadius=e}},metadata:I},k,y),d(null,null,p,{kind:"field",name:"cornerRadius",static:!1,private:!1,access:{has:t=>"cornerRadius"in t,get:t=>t.cornerRadius,set:(t,e)=>{t.cornerRadius=e}},metadata:I},P,y),d(null,null,g,{kind:"field",name:"fill",static:!1,private:!1,access:{has:t=>"fill"in t,get:t=>t.fill,set:(t,e)=>{t.fill=e}},metadata:I},V,y),d(null,null,m,{kind:"field",name:"stroke",static:!1,private:!1,access:{has:t=>"stroke"in t,get:t=>t.stroke,set:(t,e)=>{t.stroke=e}},metadata:I},L,y),d(null,null,v,{kind:"field",name:"strokeWidth",static:!1,private:!1,access:{has:t=>"strokeWidth"in t,get:t=>t.strokeWidth,set:(t,e)=>{t.strokeWidth=e}},metadata:I},R,y),I&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:I})})(),t})();Object.defineProperty(Xi.prototype,"viewBounds",{get(){const t=this.viewFrame,e=Math.min(t.width,t.height),i=this.center.getValue(),s=this.outerRadius.getValue().pxValue(e);return new l.R2Box(i.x-s,i.y-s,i.x+s,i.y+s)},configurable:!0});const _i={[Symbol.hasInstance]:t=>t instanceof Pi&&"font"in t&&"textAlign"in t&&"textBaseline"in t&&"textOrigin"in t&&"textColor"in t};class Qi{constructor(t,e,i,s,n,r){this.text=t,this.font=e,this.textAlign=i,this.textBaseline=s,this.textOrigin=n,this.textColor=r}withText(t){return this.text===t?this:this.copy(t,this.font,this.textAlign,this.textBaseline,this.textOrigin,this.textColor)}withFont(t){return t=I.fromLike(t),this.font===t?this:this.copy(this.text,t,this.textAlign,this.textBaseline,this.textOrigin,this.textColor)}withTextAlign(t){return this.textAlign===t?this:this.copy(this.text,this.font,t,this.textBaseline,this.textOrigin,this.textColor)}withTextBaseline(t){return this.textBaseline===t?this:this.copy(this.text,this.font,this.textAlign,t,this.textOrigin,this.textColor)}withTextOrigin(t){return t=l.R2Point.fromLike(t),r.Equals(this.textOrigin,t)?this:this.copy(this.text,this.font,this.textAlign,this.textBaseline,t,this.textColor)}withTextColor(t){return t=z.fromLike(t),r.Equals(this.textColor,t)?this:this.copy(this.text,this.font,this.textAlign,this.textBaseline,this.textOrigin,t)}render(t,e){t instanceof Ei&&this.draw(t.context,e)}draw(t,e){this.renderText(t,e)}renderText(t,e){const i=t.font,s=t.textAlign,n=t.textBaseline,r=t.fillStyle;null!==this.font&&(t.font=this.font.toString()),null!==this.textAlign&&(t.textAlign=this.textAlign),null!==this.textBaseline&&(t.textBaseline=this.textBaseline),null!==this.textColor&&(t.fillStyle=this.textColor.toString());let o=this.textOrigin;null===o&&(o=l.R2Point.origin()),t.fillText(this.text,o.x,o.y),t.font=i,t.textAlign=s,t.textBaseline=n,t.fillStyle=r}copy(t,e,i,s,n,r){return new Qi(t,e,i,s,n,r)}toLike(){const t={text:this.text};return t.text=this.text,null!==this.font&&(t.font=this.font),null!==this.font&&(t.font=this.font),null!==this.textAlign&&(t.textAlign=this.textAlign),null!==this.textBaseline&&(t.textBaseline=this.textBaseline),null!==this.textOrigin&&(t.textOrigin=this.textOrigin),null!==this.textColor&&(t.textColor=this.textColor),t}equals(t){return this===t||t instanceof Qi&&(this.text===t.text&&r.Equals(this.font,t.font)&&this.textAlign===t.textAlign&&this.textBaseline===t.textBaseline&&r.Equals(this.textOrigin,t.textOrigin)&&r.Equals(this.textColor,t.textColor))}debug(t){return t=t.write("TextRun").write(46).write("create").write(40).debug(this.text).write(41),null!==this.font&&(t=t.write(46).write("font").write(40).debug(this.font).write(41)),null!==this.textAlign&&(t=t.write(46).write("textAlign").write(40).debug(this.textAlign).write(41)),null!==this.textBaseline&&(t=t.write(46).write("textBaseline").write(40).debug(this.textBaseline).write(41)),null!==this.textOrigin&&(t=t.write(46).write("textOrigin").write(40).debug(this.textOrigin).write(41)),null!==this.textColor&&(t=t.write(46).write("textColor").write(40).debug(this.textColor).write(41)),t}toString(){return o.Format.debug(this)}static create(t,e=null,i=null,s=null,n=null,r=null){return e=I.fromLike(e),n=l.R2Point.fromLike(n),r=z.fromLike(r),new Qi(t,e,i,s,n,r)}static fromLike(t){if(null==t||t instanceof Qi)return t;if("string"==typeof t)return Qi.create(t);if("object"==typeof t)return Qi.create(t.text,t.font,t.textAlign,t.textBaseline,t.textOrigin,t.textColor);throw new TypeError(""+t)}}let Ji=(()=>{var t;let i,s,n,r,o,a,h=Pi,c=[],f=[],p=[],g=[],m=[],v=[],w=[];return t=class extends h{constructor(){super(...arguments),this.text=(u(this,c),u(this,f,void 0)),this.font=u(this,p,void 0),this.textAlign=u(this,g,void 0),this.textBaseline=u(this,m,void 0),this.textOrigin=u(this,v,void 0),this.textColor=u(this,w,void 0)}get value(){return new Qi(this.text.getValue(),this.font.getValue(),this.textAlign.getValue(),this.textBaseline.getValue(),this.textOrigin.getValue(),this.textColor.getValue())}get state(){return new Qi(this.text.getState(),this.font.getState(),this.textAlign.getState(),this.textBaseline.getState(),this.textOrigin.getState(),this.textColor.getState())}setState(t,e){"string"==typeof t?this.text.setState(t,e):(t instanceof Qi&&(t=t.toLike()),void 0!==t.text&&this.text.setState(t.text,e),void 0!==t.font&&this.font.setState(t.font,e),void 0!==t.textAlign&&this.textAlign.setState(t.textAlign,e),void 0!==t.textBaseline&&this.textBaseline.setState(t.textBaseline,e),void 0!==t.textOrigin&&this.textOrigin.setState(t.textOrigin,e),void 0!==t.textColor&&this.textColor.setState(t.textColor,e))}onRender(){super.onRender();const t=this.renderer.value;t instanceof Ei&&!this.hidden&&!this.culled&&this.renderText(t.context)}renderText(t){const e=t.font,i=t.textAlign,s=t.textBaseline,n=t.fillStyle,r=this.font.value;null!==r&&(t.font=r.toString());const o=this.textAlign.value;void 0!==o&&(t.textAlign=o);const a=this.textBaseline.value;void 0!==a&&(t.textBaseline=a);const h=this.textColor.value;null!==h&&(t.fillStyle=h.toString());let d=this.textOrigin.value;null===d&&(d=l.R2Point.origin()),t.fillText(this.text.getValue(),d.x,d.y),t.font=e,t.textAlign=i,t.textBaseline=s,t.fillStyle=n}},(()=>{var u;const y="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=h[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[e.Animator({valueType:String,value:"",updateFlags:ue.NeedsRender})],s=[_t({valueType:I,value:null,inherits:!0,updateFlags:ue.NeedsRender})],n=[_t({valueType:String,inherits:!0,updateFlags:ue.NeedsRender})],r=[_t({valueType:String,inherits:!0,updateFlags:ue.NeedsRender})],o=[_t({valueType:l.R2Point,value:null,inherits:!0,updateFlags:ue.NeedsRender})],a=[_t({valueType:z,value:null,inherits:!0,updateFlags:ue.NeedsRender})],d(null,null,i,{kind:"field",name:"text",static:!1,private:!1,access:{has:t=>"text"in t,get:t=>t.text,set:(t,e)=>{t.text=e}},metadata:y},f,c),d(null,null,s,{kind:"field",name:"font",static:!1,private:!1,access:{has:t=>"font"in t,get:t=>t.font,set:(t,e)=>{t.font=e}},metadata:y},p,c),d(null,null,n,{kind:"field",name:"textAlign",static:!1,private:!1,access:{has:t=>"textAlign"in t,get:t=>t.textAlign,set:(t,e)=>{t.textAlign=e}},metadata:y},g,c),d(null,null,r,{kind:"field",name:"textBaseline",static:!1,private:!1,access:{has:t=>"textBaseline"in t,get:t=>t.textBaseline,set:(t,e)=>{t.textBaseline=e}},metadata:y},m,c),d(null,null,o,{kind:"field",name:"textOrigin",static:!1,private:!1,access:{has:t=>"textOrigin"in t,get:t=>t.textOrigin,set:(t,e)=>{t.textOrigin=e}},metadata:y},v,c),d(null,null,a,{kind:"field",name:"textColor",static:!1,private:!1,access:{has:t=>"textColor"in t,get:t=>t.textColor,set:(t,e)=>{t.textColor=e}},metadata:y},w,c),y&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:y})})(),t})();const Zi={[Symbol.hasInstance]:t=>t instanceof ts||$i[Symbol.hasInstance](t)},$i={[Symbol.hasInstance]:t=>r.Objects.hasAllKeys(t,"width","height")};class ts{constructor(t,e,i,s){this.width=t,this.height=e,this.xAlign=i,this.yAlign=s}withWidth(t){return(t=l.Length.fromLike(t)).equals(this.width)?this:this.copy(t,this.height,this.xAlign,this.yAlign)}withHeight(t){return(t=l.Length.fromLike(t)).equals(this.height)?this:this.copy(this.width,t,this.xAlign,this.yAlign)}withSize(t,e){return t=l.Length.fromLike(t),e=l.Length.fromLike(e),t.equals(this.width)&&e.equals(this.height)?this:this.copy(t,e,this.xAlign,this.yAlign)}withXAlign(t){return t===this.xAlign?this:this.copy(this.width,this.height,t,this.yAlign)}withYAlign(t){return t===this.yAlign?this:this.copy(this.width,this.height,this.xAlign,t)}withAlign(t,e){return t===this.xAlign&&e===this.yAlign?this:this.copy(this.width,this.height,t,e)}toLike(){return{width:this.width,height:this.height,xAlign:this.xAlign,yAlign:this.yAlign}}copy(t,e,i,s){return new ts(t,e,i,s)}interpolateTo(t){return t instanceof ts?es(this,t):null}equivalentTo(t,e){return this===t||t instanceof ts&&(this.width.equivalentTo(t.width,e)&&this.height.equivalentTo(t.height,e)&&r.Numbers.equivalent(this.xAlign,t.xAlign,e)&&r.Numbers.equivalent(this.yAlign,t.yAlign,e))}equals(t){return this===t||t instanceof ts&&(this.width.equals(t.width)&&this.height.equals(t.height)&&this.xAlign===t.xAlign&&this.yAlign===t.yAlign)}hashCode(){return r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Constructors.hash(ts),this.width.hashCode()),this.height.hashCode()),r.Numbers.hash(this.xAlign)),r.Numbers.hash(this.yAlign)))}debug(t){return t=t.write("IconLayout").write(46).write("of").write(40).debug(this.width).write(", ").debug(this.height).write(", ").debug(this.xAlign).write(", ").debug(this.yAlign).write(41)}toString(){return o.Format.debug(this)}static of(t,e,i,s){return t=l.Length.fromLike(t),e=l.Length.fromLike(e),void 0===i&&(i=.5),void 0===s&&(s=.5),new ts(t,e,i,s)}static fromLike(t){if(null==t||t instanceof ts)return t;if($i[Symbol.hasInstance](t))return ts.fromInit(t);throw new TypeError(""+t)}static fromInit(t){const e=l.Length.fromLike(t.width),i=l.Length.fromLike(t.height);let s=t.xAlign,n=t.yAlign;return void 0===s&&(s=.5),void 0===n&&(n=.5),new ts(e,i,s,n)}}const es=function(t){const e=function(t,i){const s=function(t){const e=s[0],i=s[1],n=l.Length.of(e.width.value+t*(i.width.value-e.width.value),i.width.units),r=l.Length.of(e.height.value+t*(i.height.value-e.height.value),i.height.units),o=e.xAlign+t*(i.xAlign-e.xAlign),a=e.yAlign+t*(i.yAlign-e.yAlign);return new ts(n,r,o,a)};return Object.setPrototypeOf(s,e.prototype),s[0]=t.width.units===i.width.units&&t.height.units===i.height.units?t:new ts(t.width.to(i.width.units),t.height.to(i.height.units),t.xAlign,t.yAlign),s[1]=i,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}(r.Interpolator);class is{}class ss extends is{}class ns extends ss{constructor(t,e,i,s,n){super(),this.path=t,this.fillRule=e,this.fillColor=i,this.fillLook=s,this.moodModifier=n}withFillRule(t){return r.Equals(this.fillRule,t)?this:this.copy(this.path,t,this.fillColor,this.fillLook,this.moodModifier)}withFillColor(t){return r.Equals(this.fillColor,t)?this:this.copy(this.path,this.fillRule,t,this.fillLook,this.moodModifier)}withFillLook(t){return this.fillLook===t?this:this.copy(this.path,this.fillRule,this.fillColor,t,this.moodModifier)}withMoodModifier(t){return r.Equals(this.moodModifier,t)?this:this.copy(this.path,this.fillRule,this.fillColor,this.fillLook,t)}modifyMood(t,e){let i=this.moodModifier;null===i&&(i=Gt.empty());const s=i.updatedCol(t,e,!0);return s.equals(i)?this:this.withMoodModifier(s)}isThemed(){return null!==this.fillColor}withTheme(t,e){const i=this.fillLook;if(null===i)return this;const s=this.moodModifier;return null!==s&&(e=s.timesCol(e,!0)),this.withFillColor(t.getOr(i,e,null))}render(t,e){t instanceof Ii?this.paint(t.context,e):t instanceof Vi&&this.draw(t.context,e)}paint(t,e){const i=t.globalAlpha,s=t.fillStyle;t.beginPath(),this.draw(t,e),null!==this.fillColor&&(t.globalAlpha=this.fillColor.alpha(),t.fillStyle=this.fillColor.toHexString()),t.fill(this.fillRule),t.globalAlpha=i,t.fillStyle=s}draw(t,e){const i=l.Transform.scale(e.width,e.height).translate(e.x,e.y);this.path.transformDraw(t,i)}copy(t,e,i,s,n){return new ns(t,e,i,s,n)}interpolateTo(t){return t instanceof ns?rs(this,t):null}equivalentTo(t,e){return this===t||t instanceof ns&&(this.path.equivalentTo(t.path,e)&&this.fillRule===t.fillRule&&r.Equivalent(this.fillColor,t.fillColor,e)&&this.fillLook===t.fillLook&&r.Equivalent(this.moodModifier,t.moodModifier,e))}equals(t){return this===t||t instanceof ns&&(this.path.equals(t.path)&&this.fillRule===t.fillRule&&r.Equals(this.fillColor,t.fillColor)&&this.fillLook===t.fillLook&&r.Equals(this.moodModifier,t.moodModifier))}debug(t){return t=t.write("new").write(32).write("VectorIcon").write(40).debug(this.path).write(", ").debug(this.fillRule).write(", ").debug(this.fillColor).write(", ").debug(this.fillLook).write(", ").debug(this.moodModifier).write(41)}toString(){return o.Format.debug(this)}static create(t,e,i,s){return i=l.R2Path.fromLike(i),1===t&&1===e||(i=i.transform(l.Transform.scale(1/t,1/e))),void 0===s&&(s="nonzero"),new ns(i,s,null,Jt.iconColor,null)}}const rs=function(t){const e=function(t,i){const s=function(t){const e=s.path,i=s.fillRule,n=s.fillColorInterpolator(t),r=s.fillLook,o=s.moodModifier;return new ns(e,i,n,r,o)};return Object.setPrototypeOf(s,e.prototype),s.path=i.path,s.fillRule=i.fillRule,s.fillColorInterpolator=r.Interpolator(t.fillColor,i.fillColor),s.fillLook=i.fillLook,s.moodModifier=i.moodModifier,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.path,e=this.fillRule,i=this.fillColorInterpolator[0],s=this.fillLook,n=this.moodModifier;return new ns(t,e,i,s,n)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.path,e=this.fillRule,i=this.fillColorInterpolator[1],s=this.fillLook,n=this.moodModifier;return new ns(t,e,i,s,n)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.path.equals(t.path)&&this.fillRule===t.fillRule&&this.fillColorInterpolator.equals(t.fillColorInterpolator)&&this.fillLook===t.fillLook&&r.Equals(this.moodModifier,t.moodModifier))},e}(r.Interpolator);class os extends ss{constructor(t,e,i){super(),this.fillColor=t,this.fillLook=e,this.moodModifier=i}withFillColor(t){return r.Equals(this.fillColor,t)?this:this.copy(t,this.fillLook,this.moodModifier)}withFillLook(t){return this.fillLook===t?this:this.copy(this.fillColor,t,this.moodModifier)}withMoodModifier(t){return r.Equals(this.moodModifier,t)?this:this.copy(this.fillColor,this.fillLook,t)}modifyMood(t,e){let i=this.moodModifier;null===i&&(i=Gt.empty());const s=i.updatedCol(t,e,!0);return s.equals(i)?this:this.withMoodModifier(s)}isThemed(){return null!==this.fillColor}withTheme(t,e){const i=this.fillLook;if(null===i)return this;const s=this.moodModifier;return null!==s&&(e=s.timesCol(e,!0)),this.withFillColor(t.getOr(i,e,null))}render(t,e){t instanceof Ii?this.paint(t.context,e):t instanceof Vi&&this.draw(t.context,e)}paint(t,e){const i=t.globalAlpha,s=t.fillStyle;t.beginPath(),this.draw(t,e),null!==this.fillColor&&(t.globalAlpha=this.fillColor.alpha(),t.fillStyle=this.fillColor.toHexString()),t.fill(),t.globalAlpha=i,t.fillStyle=s}draw(t,e){const i=(e.xMin+e.xMax)/2,s=(e.yMin+e.yMax)/2,n=e.width,r=e.height,o=Math.min(n,r)/2;t.arc(i,s,o,0,2*Math.PI),t.closePath()}copy(t,e,i){return new os(t,e,i)}interpolateTo(t){return t instanceof os?ls(this,t):null}equivalentTo(t,e){return this===t||t instanceof os&&(r.Equivalent(this.fillColor,t.fillColor,e)&&this.fillLook===t.fillLook&&r.Equivalent(this.moodModifier,t.moodModifier,e))}equals(t){return this===t||t instanceof os&&(r.Equals(this.fillColor,t.fillColor)&&this.fillLook===t.fillLook&&r.Equals(this.moodModifier,t.moodModifier))}debug(t){return t=t.write("new").write(32).write("CircleIcon").write(40).debug(this.fillColor).write(", ").debug(this.fillLook).write(", ").debug(this.moodModifier).write(41)}toString(){return o.Format.debug(this)}static create(){return new os(null,Jt.accentColor,null)}}const ls=function(t){const e=function(t,i){const s=function(t){const e=s.fillColorInterpolator(t),i=s.fillLook,n=s.moodModifier;return new os(e,i,n)};return Object.setPrototypeOf(s,e.prototype),s.fillColorInterpolator=r.Interpolator(t.fillColor,i.fillColor),s.fillLook=i.fillLook,s.moodModifier=i.moodModifier,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.fillColorInterpolator[0],e=this.fillLook,i=this.moodModifier;return new os(t,e,i)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.fillColorInterpolator[1],e=this.fillLook,i=this.moodModifier;return new os(t,e,i)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.fillColorInterpolator.equals(t.fillColorInterpolator)&&this.fillLook===t.fillLook&&r.Equals(this.moodModifier,t.moodModifier))},e}(r.Interpolator);class as extends ss{constructor(t,e,i,s,n){super(),this.sides=t,this.rotation=e,this.fillColor=i,this.fillLook=s,this.moodModifier=n}withFillColor(t){return r.Equals(this.fillColor,t)?this:this.copy(this.sides,this.rotation,t,this.fillLook,this.moodModifier)}withFillLook(t){return this.fillLook===t?this:this.copy(this.sides,this.rotation,this.fillColor,t,this.moodModifier)}withMoodModifier(t){return r.Equals(this.moodModifier,t)?this:this.copy(this.sides,this.rotation,this.fillColor,this.fillLook,t)}modifyMood(t,e){let i=this.moodModifier;null===i&&(i=Gt.empty());const s=i.updatedCol(t,e,!0);return s.equals(i)?this:this.withMoodModifier(s)}isThemed(){return null!==this.fillColor}withTheme(t,e){const i=this.fillLook;if(null===i)return this;const s=this.moodModifier;return null!==s&&(e=s.timesCol(e,!0)),this.withFillColor(t.getOr(i,e,null))}render(t,e){t instanceof Ii?this.paint(t.context,e):t instanceof Vi&&this.draw(t.context,e)}paint(t,e){const i=t.globalAlpha,s=t.fillStyle;t.beginPath(),this.draw(t,e),null!==this.fillColor&&(t.globalAlpha=this.fillColor.alpha(),t.fillStyle=this.fillColor.toHexString()),t.fill(),t.globalAlpha=i,t.fillStyle=s}draw(t,e){const i=this.sides;if(i<3)return;const s=(e.xMin+e.xMax)/2,n=(e.yMin+e.yMax)/2,r=e.width,o=e.height,l=Math.min(r,o)/2,a=2*Math.PI/i;let h=this.rotation.radValue();t.moveTo(s+l*Math.cos(h),n+l*Math.sin(h)),h+=a;for(let e=1;e<i;e+=1)t.lineTo(s+l*Math.cos(h),n+l*Math.sin(h)),h+=a;t.closePath()}copy(t,e,i,s,n){return new as(t,e,i,s,n)}interpolateTo(t){return t instanceof as?hs(this,t):null}equivalentTo(t,e){return this===t||t instanceof as&&(this.sides===t.sides&&this.rotation.equivalentTo(t.rotation,e)&&r.Equivalent(this.fillColor,t.fillColor,e)&&this.fillLook===t.fillLook&&r.Equivalent(this.moodModifier,t.moodModifier,e))}equals(t){return this===t||t instanceof as&&(this.sides===t.sides&&this.rotation.equals(t.rotation)&&r.Equals(this.fillColor,t.fillColor)&&this.fillLook===t.fillLook&&r.Equals(this.moodModifier,t.moodModifier))}debug(t){return t=t.write("new").write(32).write("PolygonIcon").write(40).debug(this.sides).write(", ").debug(this.rotation).write(", ").debug(this.fillColor).write(", ").debug(this.fillLook).write(", ").debug(this.moodModifier).write(41)}toString(){return o.Format.debug(this)}static create(t,e){return e=void 0!==e?l.Angle.fromLike(e):l.Angle.zero(),new as(t,e,null,Jt.accentColor,null)}}const hs=function(t){const e=function(t,i){const s=function(t){const e=s.sides,i=s.rotationInterpolator(t),n=s.fillColorInterpolator(t),r=s.fillLook,o=s.moodModifier;return new as(e,i,n,r,o)};return Object.setPrototypeOf(s,e.prototype),s.sides=i.sides,s.rotationInterpolator=t.rotation.interpolateTo(i.rotation),s.fillColorInterpolator=r.Interpolator(t.fillColor,i.fillColor),s.fillLook=i.fillLook,s.moodModifier=i.moodModifier,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.sides,e=this.rotationInterpolator[0],i=this.fillColorInterpolator[0],s=this.fillLook,n=this.moodModifier;return new as(t,e,i,s,n)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.sides,e=this.rotationInterpolator[1],i=this.fillColorInterpolator[1],s=this.fillLook,n=this.moodModifier;return new as(t,e,i,s,n)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.sides===t.sides&&this.rotationInterpolator.equals(t.rotationInterpolator)&&this.fillColorInterpolator.equals(t.fillColorInterpolator)&&this.fillLook===t.fillLook&&r.Equals(this.moodModifier,t.moodModifier))},e}(r.Interpolator);let ds=(()=>{var t;let e,i=is,s=[];return t=class extends i{constructor(t,e,i,s,n,r){super(),this.outer=t,this.inner=e,this.innerScale=i,this.moodModifier=s,this.outerMoodModifier=n,this.innerMoodModifier=r}withOuter(t){return this.outer===t?this:this.copy(t,this.inner,this.innerScale,this.moodModifier,this.outerMoodModifier,this.innerMoodModifier)}withInner(t){return this.inner===t?this:this.copy(this.outer,t,this.innerScale,this.moodModifier,this.outerMoodModifier,this.innerMoodModifier)}withInnerScale(t){return this.innerScale===t?this:this.copy(this.outer,this.inner,t,this.moodModifier,this.outerMoodModifier,this.innerMoodModifier)}withMoodModifier(t){return r.Equals(this.moodModifier,t)?this:this.copy(this.outer,this.inner,this.innerScale,t,this.outerMoodModifier,this.innerMoodModifier)}modifyMood(t,e){let i=this.moodModifier;null===i&&(i=Gt.empty());const s=i.updatedCol(t,e,!0);return s.equals(i)?this:this.withMoodModifier(s)}withOuterMoodModifier(t){return r.Equals(this.outerMoodModifier,t)?this:this.copy(this.outer,this.inner,this.innerScale,this.moodModifier,t,this.innerMoodModifier)}modifyOuterMood(t,e){let i=this.outerMoodModifier;null===i&&(i=Gt.empty());const s=i.updatedCol(t,e,!0);return s.equals(i)?this:this.withOuterMoodModifier(s)}withInnerMoodModifier(t){return r.Equals(this.innerMoodModifier,t)?this:this.copy(this.outer,this.inner,this.innerScale,this.moodModifier,this.outerMoodModifier,t)}modifyInnerMood(t,e){let i=this.innerMoodModifier;null===i&&(i=Gt.empty());const s=i.updatedCol(t,e,!0);return s.equals(i)?this:this.withInnerMoodModifier(s)}isThemed(){const t=this.outer,e=this.inner;return(null===t||t.isThemed())&&(null===e||e.isThemed())}withTheme(t,e){const i=this.moodModifier,s=this.outerMoodModifier,n=this.innerMoodModifier;let r=e;null!==i&&(r=i.timesCol(r,!0));const o=this.outer;let l;if(null===o)l=null;else{let e=r;null!==s&&(e=s.timesCol(e,!0)),l=o.withTheme(t,e)}const a=this.inner;let h;if(null===a)h=null;else{let e=r;null!==n&&(e=n.timesCol(e,!0)),h=a.withTheme(t,e)}return l===o&&h===a?this:this.copy(l,h,this.innerScale,i,s,n)}render(t,e){t instanceof Ii?this.paint(t.context,e):t instanceof Vi&&this.draw(t.context,e)}paint(t,e){const i=this.outer;null!==i&&i.paint(t,this.outerFrame(e));const s=this.inner;null!==s&&s.paint(t,this.innerFrame(e))}draw(t,e){const i=this.outer;null!==i&&i.draw(t,this.outerFrame(e));const s=this.inner;null!==s&&s.draw(t,this.innerFrame(e))}outerFrame(t){return t}innerFrame(t){let{xMin:e,xMax:i,yMin:s,yMax:n}=t,r=i-e,o=n-s;const a=this.innerScale;if(1!==a){const t=(e+i)/2,l=(s+n)/2;r*=a,o*=a,e=t-r/2,s=l-o/2,i=t+r/2,n=l+o/2}if(r>o){const t=(r-o)/2;e+=t,i-=t}else if(r<o){const t=(o-r)/2;s+=t,n-=t}return r===o&&1===a?t:new l.R2Box(e,s,i,n)}copy(e,i,s,n,r,o){return new t(e,i,s,n,r,o)}interpolateTo(e){return e instanceof t?us(this,e):null}equivalentTo(e,i){return this===e||e instanceof t&&(r.Equivalent(this.outer,e.outer,i)&&r.Equivalent(this.inner,e.inner,i)&&r.Equivalent(this.innerScale,e.innerScale,i)&&r.Equivalent(this.moodModifier,e.moodModifier,i)&&r.Equivalent(this.outerMoodModifier,e.outerMoodModifier,i)&&r.Equivalent(this.innerMoodModifier,e.innerMoodModifier,i))}equals(e){return this===e||e instanceof t&&(r.Equals(this.outer,e.outer)&&r.Equals(this.inner,e.inner)&&r.Equals(this.innerScale,e.innerScale)&&r.Equals(this.moodModifier,e.moodModifier)&&r.Equals(this.outerMoodModifier,e.outerMoodModifier)&&r.Equals(this.innerMoodModifier,e.innerMoodModifier))}debug(t){return t=t.write("new").write(32).write("EnclosedIcon").write(40).debug(this.outer).write(", ").debug(this.inner).write(", ").debug(this.innerScale).write(", ").debug(this.moodModifier).write(", ").debug(this.outerMoodModifier).write(", ").debug(this.innerMoodModifier).write(41)}toString(){return o.Format.debug(this)}static create(e,i){return new t(e,i,1,null,null,null)}static embossed(e,i){return new t(e,i,1,null,null,t.embossedMoodModifier)}static get embossedMoodModifier(){return Gt.empty().updatedCol(ne.default,[[ne.embossed,1]],!0)}},(()=>{var n;const o="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(n=i[Symbol.metadata])&&void 0!==n?n:null):void 0;e=[r.Lazy],d(t,null,e,{kind:"getter",name:"embossedMoodModifier",static:!0,private:!1,access:{has:t=>"embossedMoodModifier"in t,get:t=>t.embossedMoodModifier},metadata:o},null,s),o&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),u(t,s)})(),t})();const us=function(t){const e=function(t,i){const s=function(t){const e=s.outerInterpolator(t),i=s.innerInterpolator(t),n=s.innerScaleInterpolator(t),r=s.moodModifier,o=s.outerMoodModifier,l=s.innerMoodModifier;return new ds(e,i,n,r,o,l)};return Object.setPrototypeOf(s,e.prototype),s.outerInterpolator=r.Interpolator(t.outer,i.outer),s.innerInterpolator=r.Interpolator(t.inner,i.inner),s.innerScaleInterpolator=r.Interpolator(t.innerScale,i.innerScale),s.moodModifier=i.moodModifier,s.outerMoodModifier=i.outerMoodModifier,s.innerMoodModifier=i.innerMoodModifier,s};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,0,{get(){const t=this.outerInterpolator[0],e=this.innerInterpolator[0],i=this.innerScaleInterpolator[0],s=this.moodModifier,n=this.outerMoodModifier,r=this.innerMoodModifier;return new ds(t,e,i,s,n,r)},configurable:!0}),Object.defineProperty(e.prototype,1,{get(){const t=this.outerInterpolator[1],e=this.innerInterpolator[1],i=this.innerScaleInterpolator[1],s=this.moodModifier,n=this.outerMoodModifier,r=this.innerMoodModifier;return new ds(t,e,i,s,n,r)},configurable:!0}),e.prototype.equals=function(t){return this===t||t instanceof e&&(this.outerInterpolator.equals(t.outerInterpolator)&&this.innerInterpolator.equals(t.innerInterpolator)&&this.innerScaleInterpolator.equals(t.innerScaleInterpolator)&&r.Equals(this.moodModifier,t.moodModifier)&&r.Equals(this.outerMoodModifier,t.outerMoodModifier)&&r.Equals(this.innerMoodModifier,t.innerMoodModifier))},e}(r.Interpolator),cs={[Symbol.hasInstance]:t=>t instanceof ue&&"iconLayout"in t&&"iconColor"in t&&"graphics"in t},fs=_t.extend("IconGraphicsAnimator",{valueType:ki,deriveValue(t){const e=this.owner;if(!(cs[Symbol.hasInstance](e)&&t instanceof is))return t;const i=e.iconColor.state;return null!==i&&t instanceof ss&&t.fillLook!==e.iconColor.look&&(t=t.withFillColor(i)),t},transformState(t){const e=this.owner;if(!(cs[Symbol.hasInstance](e)&&t instanceof is))return t;const i=e.iconColor.state;if(null!==i&&t instanceof ss)t=t.withFillColor(i);else{const i=e.theme.value,s=e.mood.value;null!==i&&null!==s&&(t=t.withTheme(i,s))}return t}});let ps=(()=>{var t;let i,s,n,r=Pi,o=[],l=[],a=[];return t=class extends r{constructor(){super(...arguments),this.iconLayout=(u(this,o),u(this,l,void 0)),this.graphics=u(this,a,void 0)}get iconColor(){return _t.getter()}onApplyTheme(t,i,s){if(super.onApplyTheme(t,i,s),!this.graphics.derived){const n=this.graphics.value;if(n instanceof is){const r=n.withTheme(t,i);this.graphics.setState(r,!!n.isThemed()&&s,e.Affinity.Reflexive)}}}onRender(){super.onRender();const t=this.renderer.value;t instanceof Ii&&!this.hidden&&!this.culled&&this.renderIcon(t,this.viewBounds)}renderIcon(t,e){const i=this.graphics.value;if(null!==i){t.context.beginPath(),i.render(t,e)}}hitTest(t,e){const i=this.renderer.value;return i instanceof Ei?this.hitTestIcon(t,e,i,this.viewBounds):null}hitTestIcon(t,e,i,s){return this.hitBounds.contains(t,e)?this:null}},(()=>{var h;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(h=r[Symbol.metadata])&&void 0!==h?h:null):void 0;i=[e.Animator({valueType:ts,value:null,updateFlags:ue.NeedsRender})],s=[_t({valueType:z,value:null,updateFlags:ue.NeedsRender,didSetState(t){const i=null!==this.timing&&this.timing;this.owner.graphics.setState(this.owner.graphics.state,i,e.Affinity.Reflexive)}})],n=[_t({extends:fs,valueType:ki,value:null,updateFlags:ue.NeedsRender})],d(t,null,s,{kind:"getter",name:"iconColor",static:!1,private:!1,access:{has:t=>"iconColor"in t,get:t=>t.iconColor},metadata:u},null,o),d(null,null,i,{kind:"field",name:"iconLayout",static:!1,private:!1,access:{has:t=>"iconLayout"in t,get:t=>t.iconLayout,set:(t,e)=>{t.iconLayout=e}},metadata:u},l,o),d(null,null,n,{kind:"field",name:"graphics",static:!1,private:!1,access:{has:t=>"graphics"in t,get:t=>t.graphics,set:(t,e)=>{t.graphics=e}},metadata:u},a,o),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u})})(),t})();Object.defineProperty(ps.prototype,"viewBounds",{get(){const t=this.viewFrame,e=t.width,i=t.height,s=Math.min(e,i),n=this.iconLayout.value,r=null!==n?n.width.pxValue(s):s,o=null!==n?n.height.pxValue(s):s,a=null!==n?n.xAlign:.5,h=null!==n?n.yAlign:.5,d=t.x+(e-r)*a,u=t.y+(i-o)*h;return new l.R2Box(d,u,d+r,u+o)},configurable:!0});let gs=(()=>{var t;let i,s,n,r=Ti,o=[],a=[],h=[];return t=class extends r{constructor(){super(...arguments),this.iconLayout=(u(this,o),u(this,a,void 0)),this.graphics=u(this,h,void 0)}get iconColor(){return _t.getter()}onApplyTheme(t,i,s){if(super.onApplyTheme(t,i,s),!this.graphics.derived){const n=this.graphics.value;if(n instanceof is){const r=n.withTheme(t,i);this.graphics.setState(r,!!n.isThemed()&&s,e.Affinity.Reflexive)}}}onResize(){super.onResize(),this.requireUpdate(ue.NeedsLayout)}needsDisplay(t){return 0==(this.flags&ue.NeedsLayout)&&(t&=~ue.NeedsLayout),t}onLayout(){super.onLayout(),this.renderIcon()}renderIcon(){const t=new Oi(this);t.setPrecision(3),t.beginSvg();const e=this.graphics.value;if(null!==e){const i=this.iconBounds;if(i.isDefined()&&i.width>0&&i.height>0){t.beginPath();const s=new Di(t);e.render(s,i)}}t.finalizeSvg()}get iconBounds(){let t=this.node.viewportElement;if(null===t&&(t=this.node),!(t instanceof SVGSVGElement))return l.R2Box.undefined();const e=t.viewBox.animVal,i=e.width,s=e.height,n=Math.min(i,s),r=this.iconLayout.value,o=null!==r?r.width.pxValue(n):n,a=null!==r?r.height.pxValue(n):n,h=null!==r?r.xAlign:.5,d=null!==r?r.yAlign:.5,u=e.x+(i-o)*h,c=e.y+(s-a)*d;return new l.R2Box(u,c,u+o,c+a)}},(()=>{var l;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(l=r[Symbol.metadata])&&void 0!==l?l:null):void 0;i=[e.Animator({valueType:ts,value:null,updateFlags:ue.NeedsLayout})],s=[_t({valueType:z,value:null,updateFlags:ue.NeedsLayout,didSetState(t){const i=null!==this.timing&&this.timing;this.owner.graphics.setState(this.owner.graphics.state,i,e.Affinity.Reflexive)}})],n=[_t({extends:fs,valueType:ki,value:null,updateFlags:ue.NeedsLayout})],d(t,null,s,{kind:"getter",name:"iconColor",static:!1,private:!1,access:{has:t=>"iconColor"in t,get:t=>t.iconColor},metadata:u},null,o),d(null,null,i,{kind:"field",name:"iconLayout",static:!1,private:!1,access:{has:t=>"iconLayout"in t,get:t=>t.iconLayout,set:(t,e)=>{t.iconLayout=e}},metadata:u},a,o),d(null,null,n,{kind:"field",name:"graphics",static:!1,private:!1,access:{has:t=>"graphics"in t,get:t=>t.graphics,set:(t,e)=>{t.graphics=e}},metadata:u},h,o),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u})})(),t.MountFlags=Ti.MountFlags|ue.NeedsAnimate,t})(),ms=(()=>{var t;let i,s,n,r,o=wi,l=[],a=[],h=[],c=[];return t=class extends o{constructor(t){super(t),this.iconLayout=(u(this,l),u(this,a,void 0)),this.graphics=u(this,h,void 0),this.svg=u(this,c,void 0),this.initIcon()}initIcon(){this.style.position.setIntrinsic("relative")}get iconColor(){return _t.getter()}onApplyTheme(t,i,s){if(super.onApplyTheme(t,i,s),!this.graphics.derived){const n=this.graphics.value;if(n instanceof is){const r=n.withTheme(t,i);this.graphics.setState(r,!!n.isThemed()&&s,e.Affinity.Reflexive)}}}onResize(){super.onResize(),this.requireUpdate(ue.NeedsLayout)}needsDisplay(t){return 0==(this.flags&ue.NeedsLayout)&&(t&=~ue.NeedsLayout),t}onLayout(){super.onLayout(),this.layoutIcon()}layoutIcon(){const t=this.svg.view;if(null===t||!t.attributes.width.hasAffinity(e.Affinity.Intrinsic)&&!t.attributes.height.hasAffinity(e.Affinity.Intrinsic)&&!t.attributes.viewBox.hasAffinity(e.Affinity.Intrinsic))return;const i=this.style.width.pxValue(),s=this.style.height.pxValue();t.attributes.setIntrinsic({width:i,height:s,viewBox:"0 0 "+i+" "+s})}},(()=>{var u;const f="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(u=o[Symbol.metadata])&&void 0!==u?u:null):void 0;i=[e.Animator({valueType:ts,value:null,updateFlags:ue.NeedsLayout})],s=[_t({valueType:z,value:null,updateFlags:ue.NeedsLayout,didSetState(t){const i=null!==this.timing&&this.timing;this.owner.graphics.setState(this.owner.graphics.state,i,e.Affinity.Reflexive)}})],n=[_t({extends:fs,valueType:ki,value:null,updateFlags:ue.NeedsLayout})],r=[fe({viewType:gs,viewKey:!0,binds:!0,init(){this.insertView()},initView(t){t.style.position.set("absolute"),t.iconLayout.setInherits(!0),t.iconColor.setInherits(!0),t.graphics.setInherits(!0)}})],d(t,null,s,{kind:"getter",name:"iconColor",static:!1,private:!1,access:{has:t=>"iconColor"in t,get:t=>t.iconColor},metadata:f},null,l),d(null,null,i,{kind:"field",name:"iconLayout",static:!1,private:!1,access:{has:t=>"iconLayout"in t,get:t=>t.iconLayout,set:(t,e)=>{t.iconLayout=e}},metadata:f},a,l),d(null,null,n,{kind:"field",name:"graphics",static:!1,private:!1,access:{has:t=>"graphics"in t,get:t=>t.graphics,set:(t,e)=>{t.graphics=e}},metadata:f},h,l),d(null,null,r,{kind:"field",name:"svg",static:!1,private:!1,access:{has:t=>"svg"in t,get:t=>t.svg,set:(t,e)=>{t.svg=e}},metadata:f},c,l),f&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f})})(),t})(),vs=(()=>{var t;let r,o,l,a,h,c=e.Component,p=[],g=[];return t=class extends c{constructor(){super(),this.consumers=void u(this,p),this.updater=u(this,g,void 0),this.consumers=null}get componentType(){return t}willAttachParent(t){this.callObservers("controllerWillAttachParent",t,this)}onAttachParent(t){}didAttachParent(t){this.callObservers("controllerDidAttachParent",t,this)}willDetachParent(t){this.callObservers("controllerWillDetachParent",t,this)}onDetachParent(t){}didDetachParent(t){this.callObservers("controllerDidDetachParent",t,this)}willInsertChild(t,e){super.willInsertChild(t,e),this.callObservers("controllerWillInsertChild",t,e,this)}onInsertChild(t,e){super.onInsertChild(t,e)}didInsertChild(t,e){this.callObservers("controllerDidInsertChild",t,e,this),super.didInsertChild(t,e)}cascadeInsert(e){0!=(this.flags&t.MountedFlag)&&(void 0===e&&(e=0),0!=((e|=this.flags&t.UpdateMask)&t.CompileMask)&&this.cascadeCompile(e))}willRemoveChild(t){super.willRemoveChild(t),this.callObservers("controllerWillRemoveChild",t,this)}onRemoveChild(t){super.onRemoveChild(t)}didRemoveChild(t){this.callObservers("controllerDidRemoveChild",t,this),super.didRemoveChild(t)}willReinsertChild(t,e){super.willReinsertChild(t,e),this.callObservers("controllerWillReinsertChild",t,e,this)}onReinsertChild(t,e){super.onReinsertChild(t,e)}didReinsertChild(t,e){this.callObservers("controllerDidReinsertChild",t,e,this),super.didReinsertChild(t,e)}willMount(){super.willMount(),this.callObservers("controllerWillMount",this)}didMount(){this.requestUpdate(this,this.flags&t.UpdateMask,!1),this.requireUpdate(this.mountFlags),null!==this.decoherent&&0!==this.decoherent.length&&this.requireUpdate(t.NeedsRevise),this.mountFasteners(),null!==this.consumers&&0!==this.consumers.size&&this.startConsuming(),this.callObservers("controllerDidMount",this),super.didMount()}willUnmount(){super.willUnmount(),this.callObservers("controllerWillUnmount",this),this.stopConsuming()}didUnmount(){this.callObservers("controllerDidUnmount",this),super.didUnmount()}requireUpdate(e,i=!1){const s=this.flags,n=e&~s&t.UpdateMask;0!==n&&(this.setFlags(s|n),this.requestUpdate(this,n,i))}needsUpdate(t,e){return t}requestUpdate(e,i,s){i=this.needsUpdate(i,s);let n=this.flags&~i&t.UpdateMask;if(0!=(i&t.CompileMask)&&(n|=t.NeedsCompile),0!=(i&t.ExecuteMask)&&(n|=t.NeedsExecute),0===n&&!s)return;this.setFlags(this.flags|n);const r=this.parent;if(null!==r)r.requestUpdate(e,i,s);else if(this.mounted){const t=this.updater.service;null!==t&&t.requestUpdate(e,i,s)}}get updating(){return 0!=(this.flags&t.UpdatingMask)}get compiling(){return 0!=(this.flags&t.CompilingFlag)}needsCompile(t){return t}cascadeCompile(e){try{if(e&=~t.NeedsCompile,e|=this.flags&t.UpdateMask,0==((e=this.needsCompile(e))&t.CompileMask))return;let i=e;this.setFlags(this.flags&~t.NeedsCompile|t.CompilingFlag),this.willCompile(i),0!=((this.flags|e)&t.NeedsResolve)&&(i|=t.NeedsResolve,this.setFlags(this.flags&~t.NeedsResolve),this.willResolve()),0!=((this.flags|e)&t.NeedsGenerate)&&(i|=t.NeedsGenerate,this.setFlags(this.flags&~t.NeedsGenerate),this.willGenerate()),0!=((this.flags|e)&t.NeedsAssemble)&&(i|=t.NeedsAssemble,this.setFlags(this.flags&~t.NeedsAssemble),this.willAssemble()),this.onCompile(i),0!=(i&t.NeedsResolve)&&this.onResolve(),0!=(i&t.NeedsGenerate)&&this.onGenerate(),0!=(i&t.NeedsAssemble)&&this.onAssemble(),0!=(i&t.CompileMask)&&this.compileChildren(i,this.compileChild),0!=(i&t.NeedsAssemble)&&this.didAssemble(),0!=(i&t.NeedsGenerate)&&this.didGenerate(),0!=(i&t.NeedsResolve)&&this.didResolve(),this.didCompile(i)}finally{this.setFlags(this.flags&~t.CompilingFlag)}}willCompile(t){}onCompile(t){}didCompile(t){}willResolve(){this.callObservers("controllerWillResolve",this)}onResolve(){}didResolve(){this.callObservers("controllerDidResolve",this)}willGenerate(){this.callObservers("controllerWillGenerate",this)}onGenerate(){}didGenerate(){this.callObservers("controllerDidGenerate",this)}willAssemble(){this.callObservers("controllerWillAssemble",this)}onAssemble(){}didAssemble(){this.callObservers("controllerDidAssemble",this)}compileChildren(t,e){let i=this.firstChild;for(;null!==i;){const s=i.nextSibling;if(e.call(this,i,t),null!==s&&s.parent!==this)throw new Error("inconsistent compile pass");i=s}}compileChild(t,e){t.cascadeCompile(e)}get executing(){return 0!=(this.flags&t.ExecutingFlag)}needsExecute(t){return t}cascadeExecute(e){try{if(e&=~t.NeedsExecute,e|=this.flags&t.UpdateMask,0==((e=this.needsExecute(e))&t.ExecuteMask))return;let i=e;this.setFlags(this.flags&~t.NeedsExecute|t.ExecutingFlag),this.willExecute(i),0!=((this.flags|e)&t.NeedsRevise)&&(i|=t.NeedsRevise,this.setFlags(this.flags&~t.NeedsRevise),this.willRevise()),0!=((this.flags|e)&t.NeedsCompute)&&(i|=t.NeedsCompute,this.setFlags(this.flags&~t.NeedsCompute),this.willCompute()),this.onExecute(i),0!=(i&t.NeedsRevise)&&this.onRevise(),0!=(i&t.NeedsCompute)&&this.onCompute(),0!=(i&t.ExecuteMask)&&this.executeChildren(i,this.executeChild),0!=(i&t.NeedsCompute)&&this.didCompute(),0!=(i&t.NeedsRevise)&&this.didRevise(),this.didExecute(i)}finally{this.setFlags(this.flags&~t.ExecutingFlag)}}willExecute(t){}onExecute(t){}didExecute(t){}willRevise(){this.callObservers("controllerWillRevise",this)}onRevise(){this.recohereFasteners(this.updateTime)}didRevise(){this.callObservers("controllerDidRevise",this)}willCompute(){this.callObservers("controllerWillCompute",this)}onCompute(){}didCompute(){this.callObservers("controllerDidCompute",this)}executeChildren(t,e){let i=this.firstChild;for(;null!==i;){const s=i.nextSibling;if(e.call(this,i,t),null!==s&&s.parent!==this)throw new Error("inconsistent execute pass");i=s}}executeChild(t,e){t.cascadeExecute(e)}bindFastener(t){super.bindFastener(t),this.consuming&&(t instanceof n.WarpDownlink&&!0===t.consumed||t instanceof ws&&!0===t.consumed||t instanceof Cs&&!0===t.consumed||t instanceof v&&!0===t.consumed||t instanceof f&&!0===t.consumed)&&t.consume(this)}bindChildFastener(t,e,i){super.bindChildFastener(t,e,i),t instanceof ws&&t.bindController(e,i)}unbindChildFastener(t,e){t instanceof ws&&t.unbindController(e),super.unbindChildFastener(t,e)}enqueueFastener(e){super.enqueueFastener(e),this.requireUpdate(t.NeedsRevise)}recohereFasteners(t){const e=this.decoherent;if(null===e||0===e.length)return;void 0===t&&(t=performance.now());let i=!1;this.coherentTime=t,this.decoherent=null,this.recohering=e;try{for(let s=0;s<e.length;s+=1){const r=e[s];r instanceof n.WarpDownlink&&!i&&(i=!0,this.hostUri.recohere(t),this.nodeUri.recohere(t),this.laneUri.recohere(t)),r.recohere(t)}}finally{this.recohering=null}}consume(t){let e=this.consumers;if(null===e)e=new Set,this.consumers=e;else if(e.has(t))return;this.willConsume(t),e.add(t),this.onConsume(t),this.didConsume(t),1===e.size&&this.mounted&&this.startConsuming()}willConsume(t){}onConsume(t){}didConsume(t){}unconsume(t){const e=this.consumers;null!==e&&e.has(t)&&(this.willUnconsume(t),e.delete(t),this.onUnconsume(t),this.didUnconsume(t),0===e.size&&this.stopConsuming())}willUnconsume(t){}onUnconsume(t){}didUnconsume(t){}get consuming(){return 0!=(this.flags&t.ConsumingFlag)}get startConsumingFlags(){return this.constructor.StartConsumingFlags}startConsuming(){0==(this.flags&t.ConsumingFlag)&&(this.willStartConsuming(),this.setFlags(this.flags|t.ConsumingFlag),this.onStartConsuming(),this.didStartConsuming())}willStartConsuming(){this.callObservers("controllerWillStartConsuming",this)}onStartConsuming(){this.requireUpdate(this.startConsumingFlags),this.startConsumingFasteners()}didStartConsuming(){this.callObservers("controllerDidStartConsuming",this)}get stopConsumingFlags(){return this.constructor.StopConsumingFlags}stopConsuming(){0!=(this.flags&t.ConsumingFlag)&&(this.willStopConsuming(),this.setFlags(this.flags&~t.ConsumingFlag),this.onStopConsuming(),this.didStopConsuming())}willStopConsuming(){this.callObservers("controllerWillStopConsuming",this)}onStopConsuming(){this.requireUpdate(this.stopConsumingFlags),this.stopConsumingFasteners()}didStopConsuming(){this.callObservers("controllerDidStopConsuming",this)}startConsumingFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const e=this[i[t]];(e instanceof n.WarpDownlink&&!0===e.consumed||e instanceof ws&&!0===e.consumed||e instanceof Cs&&!0===e.consumed||e instanceof v&&!0===e.consumed||e instanceof f&&!0===e.consumed)&&e.consume(this)}}stopConsumingFasteners(){const t=e.FastenerContext.getMetaclass(this);if(null===t)return;const i=t.slots;for(let t=0;t<i.length;t+=1){const e=this[i[t]];(e instanceof n.WarpDownlink&&!0===e.consumed||e instanceof ws&&!0===e.consumed||e instanceof Cs&&!0===e.consumed||e instanceof v&&!0===e.consumed||e instanceof f&&!0===e.consumed)&&e.unconsume(this)}}get updateTime(){return this.updater.getService().updateTime}get hostUri(){return e.Property.getter()}get nodeUri(){return e.Property.getter()}get laneUri(){return e.Property.getter()}downlink(t){let e=n.EventDownlink;return void 0!==t&&(e=e.define("downlink",t)),e.create(this)}downlinkValue(t){let e=n.ValueDownlink;return void 0!==t&&(e=e.define("downlinkValue",t)),e.create(this)}downlinkList(t){let e=n.ListDownlink;return void 0!==t&&(e=e.define("downlinkList",t)),e.create(this)}downlinkMap(t){let e=n.MapDownlink;return void 0!==t&&(e=e.define("downlinkMap",t)),e.create(this)}command(t,e,n,r){void 0===e?(r=i.Value.fromLike(t),n=this.laneUri.getValue(),e=this.nodeUri.getValue(),t=this.hostUri.value):void 0===n?(r=i.Value.fromLike(e),n=s.Uri.fromLike(t),e=this.nodeUri.getValue(),t=this.hostUri.value):void 0===r?(r=i.Value.fromLike(n),n=s.Uri.fromLike(e),e=s.Uri.fromLike(t),t=this.hostUri.value):(r=i.Value.fromLike(r),n=s.Uri.fromLike(n),e=s.Uri.fromLike(e),t=s.Uri.fromLike(t)),null===t&&(t=e.endpoint(),e=t.unresolve(e));this.warpRef.value.command(t,e,n,r)}authenticate(t,e){void 0===e?(e=i.Value.fromLike(t),t=this.hostUri.getValue()):(e=i.Value.fromLike(e),t=s.Uri.fromLike(t));this.warpRef.value.authenticate(t,e)}hostRef(e){e=s.Uri.fromLike(e);const i=new t;return i.hostUri.set(e),this.appendChild(i),i}nodeRef(e,i){void 0===i?(e=(i=s.Uri.fromLike(e)).endpoint()).isDefined()?i=e.unresolve(i):e=void 0:(i=s.Uri.fromLike(i),e=s.Uri.fromLike(e));const n=new t;return void 0!==e&&n.hostUri.set(e),void 0!==i&&n.nodeUri.set(i),this.appendChild(n),n}laneRef(e,i,n){void 0===i?(n=s.Uri.fromLike(e),i=void 0,e=void 0):void 0===n?(n=s.Uri.fromLike(i),(e=(i=s.Uri.fromLike(e)).endpoint()).isDefined()?i=e.unresolve(i):e=void 0):(n=s.Uri.fromLike(n),i=s.Uri.fromLike(i),e=s.Uri.fromLike(e));const r=new t;return void 0!==e&&r.hostUri.set(e),void 0!==i&&r.nodeUri.set(i),void 0!==n&&r.laneUri.set(n),this.appendChild(r),r}getDownlink(t,e,i){return this.warpRef.value.getDownlink(t,e,i)}openDownlink(t){this.warpRef.value.openDownlink(t)}get warpRef(){return e.Property.getter()}},(()=>{var i;const u="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(i=c[Symbol.metadata])&&void 0!==i?i:null):void 0;r=[e.Provider({get serviceType(){return ks},mountRootService(t){super.mountRootService(t),t.roots.addController(this.owner)},unmountRootService(t){super.unmountRootService(t),t.roots.removeController(this.owner)}})],o=[e.Property({valueType:s.Uri,value:null,inherits:!0,get updateFlags(){return vs.NeedsRevise}})],l=[e.Property({valueType:s.Uri,value:null,inherits:!0,get updateFlags(){return vs.NeedsRevise}})],a=[e.Property({valueType:s.Uri,value:null,inherits:!0,get updateFlags(){return vs.NeedsRevise}})],h=[e.Property({valueType:n.WarpRef,inherits:!0,get updateFlags(){return vs.NeedsRevise},initValue:()=>n.WarpClient.global(),equalValues:(t,e)=>t===e})],d(t,null,o,{kind:"getter",name:"hostUri",static:!1,private:!1,access:{has:t=>"hostUri"in t,get:t=>t.hostUri},metadata:u},null,p),d(t,null,l,{kind:"getter",name:"nodeUri",static:!1,private:!1,access:{has:t=>"nodeUri"in t,get:t=>t.nodeUri},metadata:u},null,p),d(t,null,a,{kind:"getter",name:"laneUri",static:!1,private:!1,access:{has:t=>"laneUri"in t,get:t=>t.laneUri},metadata:u},null,p),d(t,null,h,{kind:"getter",name:"warpRef",static:!1,private:!1,access:{has:t=>"warpRef"in t,get:t=>t.warpRef},metadata:u},null,p),d(null,null,r,{kind:"field",name:"updater",static:!1,private:!1,access:{has:t=>"updater"in t,get:t=>t.updater,set:(t,e)=>{t.updater=e}},metadata:u},g,p),u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u})})(),t.uid=function(){let t=1;return function(){const e=~~t;return t+=1,"controller"+e}}(),t.MountedFlag=e.Component.MountedFlag,t.InsertingFlag=e.Component.InsertingFlag,t.RemovingFlag=e.Component.RemovingFlag,t.CompilingFlag=1<<e.Component.FlagShift+0,t.ExecutingFlag=1<<e.Component.FlagShift+1,t.ConsumingFlag=1<<e.Component.FlagShift+2,t.UpdatingMask=t.CompilingFlag|t.ExecutingFlag,t.StatusMask=t.MountedFlag|t.InsertingFlag|t.RemovingFlag|t.CompilingFlag|t.ExecutingFlag,t.NeedsCompile=1<<e.Component.FlagShift+3,t.NeedsResolve=1<<e.Component.FlagShift+4,t.NeedsGenerate=1<<e.Component.FlagShift+5,t.NeedsAssemble=1<<e.Component.FlagShift+6,t.CompileMask=t.NeedsCompile|t.NeedsResolve|t.NeedsGenerate|t.NeedsAssemble,t.NeedsExecute=1<<e.Component.FlagShift+7,t.NeedsRevise=1<<e.Component.FlagShift+8,t.NeedsCompute=1<<e.Component.FlagShift+9,t.ExecuteMask=t.NeedsExecute|t.NeedsRevise|t.NeedsCompute,t.UpdateMask=t.CompileMask|t.ExecuteMask,t.FlagShift=e.Component.FlagShift+10,t.FlagMask=(1<<t.FlagShift)-1,t.MountFlags=0,t.InsertChildFlags=0,t.RemoveChildFlags=0,t.ReinsertChildFlags=0,t.StartConsumingFlags=0,t.StopConsumingFlags=0,t})();const ws=e.Fastener.extend("ControllerRelation",{get fastenerType(){return ws},consumed:!1,controllerType:null,observes:!1,attachOutlet(t){let e=this.outlets;null===e&&(e=new Set,this.outlets=e),e.add(t)},detachOutlet(t){const e=this.outlets;null!==e&&e.delete(t)},decohereOutlets(){const t=this.outlets;if(null!==t)for(const e of t)e.decohere(this)},initController(t){},willAttachController(t,e){},onAttachController(t,e){!0===this.observes&&t.observe(this),0!=(this.flags&ws.ConsumingFlag)&&t.consume(this)},didAttachController(t,e){},deinitController(t){},willDetachController(t){},onDetachController(t){0!=(this.flags&ws.ConsumingFlag)&&t.unconsume(this),!0===this.observes&&t.unobserve(this)},didDetachController(t){},get parentController(){const t=this.owner;return t instanceof vs?t:null},insertChild(t,e,i,s){t.insertChild(e,i,s)},bindController(t,e){},unbindController(t){},detectController:t=>null,createController(){let t;const e=this.controllerType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="controller",new Error(t)}return t},fromLike(t){const e=this.controllerType;return null!==e?e.fromLike(t):vs.fromLike(t)},consume(t){let e=this.consumers;if(null===e)e=new Set,this.consumers=e;else if(e.has(t))return;this.willConsume(t),e.add(t),this.onConsume(t),this.didConsume(t),1===e.size&&this.mounted&&this.startConsuming()},willConsume(t){},onConsume(t){},didConsume(t){},unconsume(t){const e=this.consumers;null!==e&&e.has(t)&&(this.willUnconsume(t),e.delete(t),this.onUnconsume(t),this.didUnconsume(t),0===e.size&&this.stopConsuming())},willUnconsume(t){},onUnconsume(t){},didUnconsume(t){},get consuming(){return 0!=(this.flags&ws.ConsumingFlag)},startConsuming(){0==(this.flags&ws.ConsumingFlag)&&(this.willStartConsuming(),this.setFlags(this.flags|ws.ConsumingFlag),this.onStartConsuming(),this.didStartConsuming())},willStartConsuming(){},onStartConsuming(){},didStartConsuming(){},stopConsuming(){0!=(this.flags&ws.ConsumingFlag)&&(this.willStopConsuming(),this.setFlags(this.flags&~ws.ConsumingFlag),this.onStopConsuming(),this.didStopConsuming())},willStopConsuming(){},onStopConsuming(){},didStopConsuming(){},onMount(){super.onMount(),null!==this.consumers&&0!==this.consumers.size&&this.startConsuming()},onUnmount(){super.onUnmount(),this.stopConsuming()}},{construct(t,e){return(t=super.construct(t,e)).outlets=null,t.consumers=null,t},ConsumingFlag:1<<e.Fastener.FlagShift+0,FlagShift:e.Fastener.FlagShift+1,FlagMask:(1<<e.Fastener.FlagShift+1)-1}),ys=ws.extend("ControllerRef",{get fastenerType(){return ys},get inletController(){const t=this.inlet;return t instanceof ys?t.controller:null},getInletController(){const t=this.inletController;if(null==t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="inlet controller",new TypeError(e)}return t},get(){return this.controller},set(t){return t instanceof e.Fastener?this.bindInlet(t):this.setController(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):this.setController(t),this.owner},controllerKey:void 0,getController(){const t=this.controller;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="controller",new TypeError(e)}return t},setController(t,e,i){null!==t&&(t=this.fromLike(t));let s,n=this.controller;return n===t?(this.setCoherent(!0),n):(void 0===e&&(e=null),this.binds&&(s=this.parentController,null!==s)&&(null!==n&&n.parent===s&&(null===e&&(e=n.nextSibling),n.remove()),null!==t&&(void 0===i&&(i=this.controllerKey),this.insertChild(s,t,e,i)),n=this.controller,n===t)||(null!==n&&(this.controller=null,this.willDetachController(n),this.onDetachController(n),this.deinitController(n),this.didDetachController(n)),null!==t&&(this.controller=t,this.willAttachController(t,e),this.onAttachController(t,e),this.initController(t),this.didAttachController(t,e)),this.setCoherent(!0),this.decohereOutlets()),n)},attachController(t,e){const i=this.controller;return void 0===e&&(e=null),i===(t=null!=t?this.fromLike(t):null===i?this.createController():i)||(null!==i&&(this.controller=null,this.willDetachController(i),this.onDetachController(i),this.deinitController(i),this.didDetachController(i)),this.controller=t,this.willAttachController(t,e),this.onAttachController(t,e),this.initController(t),this.didAttachController(t,e),this.setCoherent(!0),this.decohereOutlets()),t},detachController(){const t=this.controller;return null===t?null:(this.controller=null,this.willDetachController(t),this.onDetachController(t),this.deinitController(t),this.didDetachController(t),this.setCoherent(!0),this.decohereOutlets(),t)},insertController(t,e,i,s){let n=this.controller;return e=null!=e?this.fromLike(e):null===n?this.createController():n,void 0===t&&(t=null),this.binds||n!==e||null===e.parent||null!==t||void 0!==s?(null===t&&(t=this.parentController),void 0===i&&(i=null),void 0===s&&(s=this.controllerKey),null===t||e.parent===t&&e.key===s||this.insertChild(t,e,i,s),n=this.controller,n===e||(null!==n&&(this.controller=null,this.willDetachController(n),this.onDetachController(n),this.deinitController(n),this.didDetachController(n),this.binds&&null!==t&&n.parent===t&&n.remove()),this.controller=e,this.willAttachController(e,i),this.onAttachController(e,i),this.initController(e),this.didAttachController(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},removeController(){const t=this.controller;return null===t?null:(t.remove(),t)},deleteController(){const t=this.detachController();return null===t?null:(t.remove(),t)},bindController(t,e){if(!this.binds||null!==this.controller)return;const i=this.detectController(t);null!==i&&(this.controller=i,this.willAttachController(i,e),this.onAttachController(i,e),this.initController(i),this.didAttachController(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindController(t){if(!this.binds)return;const e=this.detectController(t);null!==e&&this.controller===e&&(this.controller=null,this.willDetachController(e),this.onDetachController(e),this.deinitController(e),this.didDetachController(e),this.setCoherent(!0),this.decohereOutlets())},detectController(t){const e=this.controllerKey;return void 0!==e&&e===t.key?t:null},onStartConsuming(){const t=this.controller;null!==t&&t.consume(this)},onStopConsuming(){const t=this.controller;null!==t&&t.unconsume(this)},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof ys?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setController(i.controller)):this.setDerived(!1)}},{tryController(t,i){const s=e.FastenerContext.getMetaclass(t),n=null!==s?s.tryFastener(t,i):null;return n instanceof ys?n.controller:null},construct(t,e){return(t=super.construct(t,e)).controller=null,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"controllerKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"controllerKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"controllerKey",i)))}}),bs=ws.extend("ControllerSet",{get fastenerType(){return bs},controllerKey(t){},insertControllerMap(t,e){const i=this.controllers;null!==e&&0!=(this.flags&bs.OrderedFlag)?this.controllers=r.Objects.inserted(i,t.uid,t,e):i[t.uid]=t},removeControllerMap(t){delete this.controllers[t.uid]},hasController(t){return void 0!==this.controllers[t.uid]},addController(t,e,i){let s;return t=null!=t?this.fromLike(t):this.createController(),void 0===e&&(e=null),this.binds&&(s=this.parentController,null!==s)&&(null===e&&(e=t.parent===s?t.nextSibling:this.getTargetChild(s,t)),void 0===i&&(i=this.controllerKey(t)),t.parent===s&&t.nextSibling===e&&t.key===i||this.insertChild(s,t,e,i)),void 0!==this.controllers[t.uid]||(this.insertControllerMap(t,e),this.controllerCount+=1,this.willAttachController(t,e),this.onAttachController(t,e),this.initController(t),this.didAttachController(t,e),this.setCoherent(!0),this.decohereOutlets()),t},addControllers(t,e){for(const i in t)this.addController(t[i],e)},setControllers(t,e){const i=this.binds,s=i?this.parentController:null,n=this.controllers;for(const e in n)if(void 0===t[e]){const t=this.detachController(n[e]);null!==t&&i&&null!==s&&t.parent===s&&t.remove()}if(0!=(this.flags&bs.OrderedFlag)){const i=new Array;for(const e in t)i.push(t[e]);for(let t=0,s=i.length;t<s;t+=1){const r=i[t];if(void 0===n[r.uid]){const n=t<s+1?i[t+1]:e;this.addController(r,n)}}}else for(const i in t)void 0===n[i]&&this.addController(t[i],e)},attachController(t,e){return t=null!=t?this.fromLike(t):this.createController(),void 0!==this.controllers[t.uid]||(void 0===e&&(e=null),this.insertControllerMap(t,e),this.controllerCount+=1,this.willAttachController(t,e),this.onAttachController(t,e),this.initController(t),this.didAttachController(t,e),this.setCoherent(!0),this.decohereOutlets()),t},attachControllers(t,e){for(const i in t)this.attachController(t[i],e)},detachController(t){return void 0===this.controllers[t.uid]?null:(this.controllerCount-=1,this.removeControllerMap(t),this.willDetachController(t),this.onDetachController(t),this.deinitController(t),this.didDetachController(t),this.setCoherent(!0),this.decohereOutlets(),t)},detachControllers(t){void 0===t&&(t=this.controllers);for(const e in t)this.detachController(t[e])},insertController(t,e,i,s){return e=null!=e?this.fromLike(e):this.createController(),void 0===t&&(t=null),this.binds||void 0===this.controllers[e.uid]||null===e.parent||null!==t||void 0!==s?(null===t&&(t=this.parentController),void 0===i&&(i=null),void 0===s&&(s=this.controllerKey(e)),null===t||e.parent===t&&e.key===s||(null===i&&(i=this.getTargetChild(t,e)),this.insertChild(t,e,i,s)),void 0!==this.controllers[e.uid]||(this.insertControllerMap(e,i),this.controllerCount+=1,this.willAttachController(e,i),this.onAttachController(e,i),this.initController(e),this.didAttachController(e,i),this.setCoherent(!0),this.decohereOutlets()),e):e},insertControllers(t,e,i){for(const s in e)this.insertController(t,e[s],i)},removeController(t){return this.hasController(t)?(t.remove(),t):null},removeControllers(t){void 0===t&&(t=this.controllers);for(const e in t)this.removeController(t[e])},deleteController(t){const e=this.detachController(t);return null===e?null:(e.remove(),e)},deleteControllers(t){void 0===t&&(t=this.controllers);for(const e in t)this.deleteController(t[e])},reinsertController(t,e){if(void 0===this.controllers[t.uid]||void 0===e&&0==(this.flags&bs.SortedFlag))return;const i=t.parent;null!==i&&(void 0===e&&(e=this.getTargetChild(i,t)),i.reinsertChild(t,e))},bindController(t,e){if(!this.binds)return;const i=this.detectController(t);null!==i&&void 0===this.controllers[i.uid]&&(this.insertControllerMap(i,e),this.controllerCount+=1,this.willAttachController(i,e),this.onAttachController(i,e),this.initController(i),this.didAttachController(i,e),this.setCoherent(!0),this.decohereOutlets())},unbindController(t){if(!this.binds)return;const e=this.detectController(t);null!==e&&void 0!==this.controllers[e.uid]&&(this.controllerCount-=1,this.removeControllerMap(e),this.willDetachController(e),this.onDetachController(e),this.deinitController(e),this.didDetachController(e),this.setCoherent(!0),this.decohereOutlets())},detectController(t){return"function"==typeof this.controllerType&&t instanceof this.controllerType?t:null},consumeControllers(t){const e=this.controllers;for(const i in e)e[i].consume(t)},unconsumeControllers(t){const e=this.controllers;for(const i in e)e[i].unconsume(t)},onStartConsuming(){this.consumeControllers(this)},onStopConsuming(){this.unconsumeControllers(this)},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof bs?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&this.setControllers(i.controllers)):this.setDerived(!1)},get ordered(){return 0!=(this.flags&bs.OrderedFlag)},order(t){return void 0===t&&(t=!0),t?this.setFlags(this.flags|bs.OrderedFlag):this.setFlags(this.flags&~bs.OrderedFlag),this},get sorted(){return 0!=(this.flags&bs.SortedFlag)},sort(t){if(void 0===t&&(t=!0),t){const t=this.parentController;this.willSort(t),this.setFlags(this.flags|bs.SortedFlag),this.onSort(t),this.didSort(t)}else this.setFlags(this.flags&~bs.SortedFlag);return this},willSort(t){},onSort(t){null!==t&&this.sortChildren(t)},didSort(t){},sortChildren(t,e){t.sortChildren(this.compareChildren.bind(this))},getTargetChild(t,e){return 0!=(this.flags&bs.SortedFlag)?t.getTargetChild(e,this.compareTargetChild.bind(this)):null},compareChildren(t,e){const i=this.controllers,s=i[t.uid],n=i[e.uid];return void 0!==s&&void 0!==n?this.compare(s,n):void 0!==s?1:void 0!==n?-1:0},compareTargetChild(t,e){const i=this.controllers[e.uid];return void 0!==i?this.compare(t,i):void 0!==i?-1:0},compare:(t,e)=>t.uid<e.uid?-1:t.uid>e.uid?1:0},{construct(t,e){return(t=super.construct(t,e)).controllers={},t.controllerCount=0,t},refine(t){super.refine(t);const e=t.prototype;let i=e.flagsInit;Object.prototype.hasOwnProperty.call(e,"ordered")&&(e.ordered?i|=bs.OrderedFlag:i&=~bs.OrderedFlag,delete e.ordered),Object.prototype.hasOwnProperty.call(e,"sorted")&&(e.sorted?i|=bs.SortedFlag:i&=~bs.SortedFlag,delete e.sorted),Object.defineProperty(e,"flagsInit",{value:i,enumerable:!0,configurable:!0})},OrderedFlag:1<<ws.FlagShift+0,SortedFlag:1<<ws.FlagShift+1,FlagShift:ws.FlagShift+2,FlagMask:(1<<ws.FlagShift+2)-1}),Cs=e.Fastener.extend("TraitViewRef",{get fastenerType(){return Cs},consumed:!1,traitType:null,traitKey:void 0,bindsTrait:!1,observesTrait:!1,getTrait(){const t=this.trait;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="trait",new TypeError(e)}return t},setTrait(t,e,i){let s,n=this.trait;return null!==t&&(t=this.fromTraitLike(t)),n===t||(void 0===e&&(e=null),this.bindsTrait&&(s=this.parentModel,null!==s)&&(null!==n&&n.model===s&&(null===e&&(e=n.nextTrait),n.remove()),null!==t&&(void 0===i&&(i=this.traitKey),this.insertChildTrait(s,t,e,i)),n=this.trait,n===t)||(null!==n&&(this.trait=null,this.willDetachTrait(n),this.onDetachTrait(n),this.deinitTrait(n),this.didDetachTrait(n)),null!==t&&(this.trait=t,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e)))),n},attachTrait(t,e){const i=this.trait;return void 0===e&&(e=null),i===(t=null!=t?this.fromTraitLike(t):null===i?this.createTrait():i)||(null!==i&&(this.trait=null,this.willDetachTrait(i),this.onDetachTrait(i),this.deinitTrait(i),this.didDetachTrait(i)),this.trait=t,this.willAttachTrait(t,e),this.onAttachTrait(t,e),this.initTrait(t),this.didAttachTrait(t,e)),t},detachTrait(){const t=this.trait;return null===t?null:(this.trait=null,this.willDetachTrait(t),this.onDetachTrait(t),this.deinitTrait(t),this.didDetachTrait(t),t)},initTrait(t){},willAttachTrait(t,e){},onAttachTrait(t,e){this.observesTrait&&t.observe(this),0!=(this.flags&Cs.ConsumingFlag)&&t.consume(this)},didAttachTrait(t,e){},deinitTrait(t){},willDetachTrait(t){},onDetachTrait(t){0!=(this.flags&Cs.ConsumingFlag)&&t.unconsume(this),this.observesTrait&&t.unobserve(this)},didDetachTrait(t){},insertTrait(t,e,i,s){let n=this.trait;return e=null!=e?this.fromTraitLike(e):null===n?this.createTrait():n,void 0===t&&(t=null),this.bindsTrait||n!==e||null===e.model||null!==t||void 0!==s?(null===t&&(t=this.parentModel),void 0===i&&(i=null),void 0===s&&(s=this.traitKey),null===t||e.model===t&&e.key===s||this.insertChildTrait(t,e,i,s),n=this.trait,n===e||(null!==n&&(this.trait=null,this.willDetachTrait(n),this.onDetachTrait(n),this.deinitTrait(n),this.didDetachTrait(n),this.bindsTrait&&null!==t&&n.parent===t&&n.remove()),this.trait=e,this.willAttachTrait(e,i),this.onAttachTrait(e,i),this.initTrait(e),this.didAttachTrait(e,i)),e):e},removeTrait(){const t=this.trait;return null===t?null:(t.remove(),t)},deleteTrait(){const t=this.detachTrait();return null===t?null:(t.remove(),t)},get parentModel(){const t=this.owner;return t instanceof c?t:t instanceof m?t.model:null},insertChildTrait(t,e,i,s){t.insertTrait(e,i,s)},bindModel(t,e){if(!this.bindsTrait||null!==this.trait)return;const i=this.detectModel(t);null!==i&&(this.trait=i,this.willAttachTrait(i,null),this.onAttachTrait(i,null),this.initTrait(i),this.didAttachTrait(i,null))},unbindModel(t){if(!this.bindsTrait)return;const e=this.detectModel(t);null!==e&&this.trait===e&&(this.trait=null,this.willDetachTrait(e),this.onDetachTrait(e),this.deinitTrait(e),this.didDetachTrait(e))},detectModel:t=>null,bindTrait(t,e){if(!this.bindsTrait||null!==this.trait)return;const i=this.detectTrait(t);null!==i&&(this.trait=i,this.willAttachTrait(i,e),this.onAttachTrait(i,e),this.initTrait(i),this.didAttachTrait(i,e))},unbindTrait(t){if(!this.bindsTrait)return;const e=this.detectTrait(t);null!==e&&this.trait===e&&(this.trait=null,this.willDetachTrait(e),this.onDetachTrait(e),this.deinitTrait(e),this.didDetachTrait(e))},detectTrait(t){const e=this.traitKey;return void 0!==e&&e===t.key?t:null},createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t},fromTraitLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},viewType:null,viewKey:void 0,bindsView:!1,observesView:!1,getView(){const t=this.view;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="view",new TypeError(e)}return t},setView(t,e,i){null!==t&&(t=this.fromViewLike(t));let s,n=this.view;return n===t||(void 0===e&&(e=null),this.bindsView&&(s=this.parentView,null!==s)&&(null!==n&&n.parent===s&&(null===e&&(e=n.nextSibling),n.remove()),null!==t&&(void 0===i&&(i=this.viewKey),this.insertChildView(s,t,e,i)),n=this.view,n===t)||(null!==n&&(this.view=null,this.willDetachView(n),this.onDetachView(n),this.deinitView(n),this.didDetachView(n)),null!==t&&(this.view=t,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e)))),n},attachView(t,e){const i=this.view;return void 0===e&&(e=null),i===(t=null!=t?this.fromViewLike(t):null===i?this.createView():i)||(null!==i&&(this.view=null,this.willDetachView(i),this.onDetachView(i),this.deinitView(i),this.didDetachView(i)),this.view=t,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e)),t},detachView(){const t=this.view;return null===t?null:(this.view=null,this.willDetachView(t),this.onDetachView(t),this.deinitView(t),this.didDetachView(t),t)},initView(t){},willAttachView(t,e){},onAttachView(t,e){this.observesView&&t.observe(this)},didAttachView(t,e){},deinitView(t){},willDetachView(t){},onDetachView(t){this.observesView&&t.unobserve(this)},didDetachView(t){},insertView(t,e,i,s){let n=this.view;return e=null!=e?this.fromViewLike(e):null===n?this.createView():n,void 0===t&&(t=null),this.bindsView||n!==e||null===e.parent||null!==t||void 0!==s?(null===t&&(t=this.parentView),void 0===i&&(i=null),void 0===s&&(s=this.viewKey),null===t||e.parent===t&&e.key===s||this.insertChildView(t,e,i,s),n=this.view,n===e||(null!==n&&(this.view=null,this.willDetachView(n),this.onDetachView(n),this.deinitView(n),this.didDetachView(n),this.bindsView&&null!==t&&n.parent===t&&n.remove()),this.view=e,this.willAttachView(e,i),this.onAttachView(e,i),this.initView(e),this.didAttachView(e,i)),e):e},removeView(){const t=this.view;return null===t?null:(t.remove(),t)},deleteView(){const t=this.detachView();return null===t?null:(t.remove(),t)},get parentView(){const t=this.owner;return t instanceof ue?t:null},insertChildView(t,e,i,s){t.insertChild(e,i,s)},bindView(t,e){if(!this.bindsView||null!==this.view)return;const i=this.detectView(t);null!==i&&(this.view=i,this.willAttachView(i,e),this.onAttachView(i,e),this.initView(i),this.didAttachView(i,e))},unbindView(t){if(!this.bindsView)return;const e=this.detectView(t);null!==e&&this.view===e&&(this.view=null,this.willDetachView(e),this.onDetachView(e),this.deinitView(e),this.didDetachView(e))},detectView(t){const e=this.viewKey;return void 0!==e&&e===t.key?t:null},createView(){let t;const e=this.viewType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="view",new Error(t)}return t},fromViewLike(t){const e=this.viewType;return null!==e?e.fromLike(t):ue.fromLike(t)},recohere(t){this.setCoherentTime(t);const i=this.inlet;i instanceof Cs?(this.setDerived((this.flags&e.Affinity.Mask)<=Math.min(i.flags&e.Affinity.Mask,e.Affinity.Intrinsic)),0!=(this.flags&e.Fastener.DerivedFlag)&&(this.setTrait(i.trait),this.setView(i.view),this.setCoherent(!0))):this.setDerived(!1)},consume(t){let e=this.consumers;if(null===e)e=new Set,this.consumers=e;else if(e.has(t))return;this.willConsume(t),e.add(t),this.onConsume(t),this.didConsume(t),1===e.size&&this.mounted&&this.startConsuming()},willConsume(t){},onConsume(t){},didConsume(t){},unconsume(t){const e=this.consumers;null!==e&&e.has(t)&&(this.willUnconsume(t),e.delete(t),this.onUnconsume(t),this.didUnconsume(t),0===e.size&&this.stopConsuming())},willUnconsume(t){},onUnconsume(t){},didUnconsume(t){},get consuming(){return 0!=(this.flags&Cs.ConsumingFlag)},startConsuming(){0==(this.flags&Cs.ConsumingFlag)&&(this.willStartConsuming(),this.setFlags(this.flags|Cs.ConsumingFlag),this.onStartConsuming(),this.didStartConsuming())},willStartConsuming(){},onStartConsuming(){const t=this.trait;null!==t&&t.consume(this)},didStartConsuming(){},stopConsuming(){0!=(this.flags&Cs.ConsumingFlag)&&(this.willStopConsuming(),this.setFlags(this.flags&~Cs.ConsumingFlag),this.onStopConsuming(),this.didStopConsuming())},willStopConsuming(){},onStopConsuming(){const t=this.trait;null!==t&&t.unconsume(this)},didStopConsuming(){},onMount(){super.onMount(),null!==this.consumers&&0!==this.consumers.size&&this.startConsuming()},onUnmount(){super.onUnmount(),this.stopConsuming()}},{construct(t,e){return(t=super.construct(t,e)).consumers=null,t.trait=null,t.view=null,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"traitKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"traitKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"traitKey",i)));const s=Object.getOwnPropertyDescriptor(e,"viewKey");void 0!==s&&"value"in s&&(!0===s.value?(s.value=t.name,Object.defineProperty(e,"viewKey",s)):!1===s.value&&(s.value=void 0,Object.defineProperty(e,"viewKey",s)))},ConsumingFlag:1<<e.Fastener.FlagShift+0,FlagShift:e.Fastener.FlagShift+1,FlagMask:(1<<e.Fastener.FlagShift+1)-1}),Ts=ys.extend("ViewControllerRef",{set(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof ue?this.setView(t):this.setController(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof ue?this.setView(t):this.setController(t),this.owner},viewType:null,viewKey:void 0,observesView:!1,getView(){const t=this.view;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="view",new TypeError(e)}return t},setView(t,e,i){null!==t&&(t=this.fromViewLike(t));let s=this.view;if(s===t)return s;void 0===e&&(e=null);let n=this.controller;return null===n&&null!==t&&(n=this.createController(t),this.setController(n,null,i)),null!==n&&(null!==s&&(null===e&&(e=s.nextSibling),s.remove()),null!==t&&this.insertControllerView(n,t,e,this.viewKey),s=this.view,s===t)||(null!==s&&(this.view=null,this.willDetachView(s),this.onDetachView(s),this.deinitView(s),this.didDetachView(s)),null!==t&&(this.view=t,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e))),s},attachView(t,e){let i=this.view;t=null!=t?this.fromViewLike(t):null===i?this.createView():i;let s=this.controller;return null===s&&(s=this.createController(t),this.attachController(s),i=this.view),void 0===e&&(e=null),i===t||(null!==i&&(this.view=null,this.willDetachView(i),this.onDetachView(i),this.deinitView(i),this.didDetachView(i)),this.view=t,this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e)),t},initView(t){},willAttachView(t,e){},onAttachView(t,e){this.observesView&&t.observe(this)},didAttachView(t,e){},detachView(){const t=this.view;return null===t?null:(this.view=null,this.willDetachView(t),this.onDetachView(t),this.deinitView(t),this.didDetachView(t),t)},deinitView(t){},willDetachView(t){},onDetachView(t){this.observesView&&t.unobserve(this)},didDetachView(t){},insertView(t,e,i,s){let n=this.view;return void 0===t&&(t=null),n===(e=null!=e?this.fromViewLike(e):null===n?this.createView():n)&&null===t||(null===t&&(t=this.createController(e),this.insertController(null,t)),void 0===i&&(i=null),null!==t&&this.insertControllerView(t,e,i,this.viewKey),n=this.view,n===e||(null!==n&&(this.view=null,this.willDetachView(n),this.onDetachView(n),this.deinitView(n),this.didDetachView(n),n.remove()),this.view=e,this.willAttachView(e,i),this.onAttachView(e,i),this.initView(e),this.didAttachView(e,i))),e},removeView(){const t=this.view;return null===t?null:(t.remove(),t)},deleteView(){const t=this.detachView();return null===t?null:(t.remove(),t)},createView(){let t;const e=this.viewType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="view",new Error(t)}return t},fromViewLike(t){const e=this.viewType;return null!==e?e.fromLike(t):ue.fromLike(t)},detectControllerView:t=>null,insertControllerView(t,e,i,s){},onAttachController(t,e){const i=this.detectControllerView(t);if(null!==i){const t=null!==e?this.detectControllerView(e):null;this.attachView(i,t)}super.onAttachController(t,e)},onDetachController(t){super.onDetachController(t);const e=this.detectControllerView(t);null!==e&&e===this.view&&this.detachView()},createController(t){const e=super.createController();return void 0===t&&(t=this.createView()),this.insertControllerView(e,t,null,this.viewKey),e}},{construct(t,e){return(t=super.construct(t,e)).view=null,t},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"viewKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"viewKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"viewKey",i)))}}),Ss=bs.extend("ViewControllerSet",{viewType:null,viewKey(t){},observesView:!1,getViewController(t){const e=this.viewControllers[t.uid];return void 0!==e?e:null},associateViewController(t,e){this.viewControllers[t.uid]=e},dissociateViewController(t,e){delete this.viewControllers[t.uid]},hasView(t){return void 0!==this.views[t.uid]},addView(t,e,i){t=null!=t?this.fromViewLike(t):this.createView();let s=this.getViewController(t);return null===s&&(s=this.createController(t)),this.addController(s,e,i),t},addViews(t,e){for(const i in t)this.addView(t[i],e)},setViews(t,e){const i=this.views;for(const e in i)void 0===t[e]&&this.detachView(i[e]);for(const s in t)void 0===i[s]&&this.attachView(t[s],e)},attachView(t,e){t=null!=t?this.fromViewLike(t):this.createView();const i=this.views;if(void 0!==i[t.uid])return t;i[t.uid]=t,this.viewCount+=1,void 0===e&&(e=null);let s=this.getViewController(t);return null===s&&(s=this.createController(t)),this.attachController(s,e),this.willAttachView(t,e),this.onAttachView(t,e),this.initView(t),this.didAttachView(t,e),t},initView(t){},willAttachView(t,e){},onAttachView(t,e){this.observesView&&t.observe(this)},didAttachView(t,e){},attachViews(t,e){for(const i in t)this.attachView(t[i],e)},detachView(t){const e=this.views;if(void 0===e[t.uid])return null;this.viewCount-=1,delete e[t.uid],this.willDetachView(t),this.onDetachView(t),this.deinitView(t),this.didDetachView(t);const i=this.getViewController(t);return null!==i&&this.detachController(i),t},deinitView(t){},willDetachView(t){},onDetachView(t){this.observesView&&t.unobserve(this)},didDetachView(t){},detachViews(t){void 0===t&&(t=this.views);for(const e in t)this.detachView(t[e])},insertView(t,e,i,s){e=null!=e?this.fromViewLike(e):this.createView();let n=this.getViewController(e);return null===n&&(n=this.createController(e)),this.insertController(t,n,i,s),e},insertViews(t,e,i){for(const s in e)this.insertView(t,e[s],i)},removeView(t){return this.hasView(t)?(t.remove(),t):null},removeViews(t){void 0===t&&(t=this.views);for(const e in t)this.removeView(t[e])},deleteView(t){const e=this.detachView(t);return null===e?null:(e.remove(),e)},deleteViews(t){void 0===t&&(t=this.views);for(const e in t)this.deleteView(t[e])},reinsertView(t,e){const i=this.getViewController(t);if(null===i)return;const s=null!==e?this.getViewController(e):null;this.reinsertController(i,s)},createView(){let t;const e=this.viewType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="view",new Error(t)}return t},fromViewLike(t){const e=this.viewType;return null!==e?e.fromLike(t):ue.fromLike(t)},detectControllerView:t=>null,insertControllerView(t,e,i,s){},detectController(t){return null!==this.detectControllerView(t)?t:null},onAttachController(t,e){const i=this.detectControllerView(t);null!==i&&(this.associateViewController(i,t),this.attachView(i,e)),super.onAttachController(t,e)},onDetachController(t){super.onDetachController(t);const e=this.detectControllerView(t);null!==e&&(this.detachView(e),this.dissociateViewController(e,t))},createController(t){const e=super.createController();void 0===t&&(t=this.createView());const i=this.viewKey(t);return this.insertControllerView(e,t,null,i),e},compare(t,e){const i=this.detectControllerView(t),s=this.detectControllerView(e);return null!==i&&null!==s?this.compareViews(i,s):null!==i?1:null!==s?-1:0},compareViews:(t,e)=>t.uid<e.uid?-1:t.uid>e.uid?1:0},{construct(t,e){return(t=super.construct(t,e)).viewControllers={},t.views={},t.viewCount=0,t}}),xs=ys.extend("TraitControllerRef",{getTraitRef(t){throw new Error("missing implementation")},set(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof m?this.setTrait(t):this.setController(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof m?this.setTrait(t):this.setController(t),this.owner},traitType:null,traitKey:void 0,get trait(){const t=this.controller;return null===t?null:this.getTraitRef(t).trait},getTrait(){const t=this.trait;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="trait",new TypeError(e)}return t},setTrait(t,e,i){let s=this.controller;return null!==t?(t=this.fromTraitLike(t),null===s&&(s=this.createController(t)),this.getTraitRef(s).setTrait(t,e,this.traitKey),this.setController(s,null,i)):null!==s&&this.getTraitRef(s).setTrait(null),s},attachTrait(t,e){t=null==t?this.createTrait():this.fromTraitLike(t);let i=this.controller;return null===i&&(i=this.createController(t)),this.getTraitRef(i).setTrait(t,e,this.traitKey),this.attachController(i,null),i},initTrait(t,e){},willAttachTrait(t,e,i){},onAttachTrait(t,e,i){},didAttachTrait(t,e,i){},detachTrait(t){const e=this.controller;return null===e||this.getTraitRef(e).trait!==t?null:(this.willDetachTrait(t,e),this.onDetachTrait(t,e),this.deinitTrait(t,e),this.didDetachTrait(t,e),e)},deinitTrait(t,e){},willDetachTrait(t,e){},onDetachTrait(t,e){},didDetachTrait(t,e){},insertTrait(t,e,i,s){e=null==e?this.createTrait():this.fromTraitLike(e);let n=this.controller;return null===n&&(n=this.createController(e)),this.getTraitRef(n).setTrait(e,i,this.traitKey),this.insertController(t,n),n},removeTrait(t){const e=this.controller;return null===e||this.getTraitRef(e).trait!==t?null:(e.remove(),e)},deleteTrait(t){const e=this.controller;return null===e||this.getTraitRef(e).trait!==t?null:(e.remove(),this.setController(null),e)},fromTraitLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},onAttachController(t,e){const i=this.getTraitRef(t).trait;if(null!==i){const t=null!==e?this.getTraitRef(e).trait:null;this.attachTrait(i,t)}super.onAttachController(t,e)},onDetachController(t){super.onDetachController(t);const e=this.getTraitRef(t).trait;null!==e&&this.detachTrait(e)},createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t}},{construct(t,e){return t=super.construct(t,e)},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"traitKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"traitKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"traitKey",i)))}}),Ms=bs.extend("TraitControllerSet",{getTraitRef(t){throw new Error("missing implementation")},traitType:null,hasTrait(t){return void 0!==this.traitControllers[t.uid]},addTrait(t,e,i){t=this.fromTraitLike(t);const s=this.traitControllers;let n=s[t.uid];if(void 0!==n)return n;void 0===e&&(e=null),n=this.createController(t),this.getTraitRef(n).setTrait(t,e,i);const r=null!==e?s[e.uid]:void 0;return this.addController(n,r,i),n},addTraits(t,e){for(const i in t)this.addTrait(t[i],e)},setTraits(t,e){const i=this.binds,s=i?this.parentController:null,n=this.traitControllers;for(const e in n)if(void 0===t[e]){const t=this.detachController(n[e]);null!==t&&i&&null!==s&&t.parent===s&&t.remove()}if(0!=(this.flags&bs.OrderedFlag)){const i=new Array;for(const e in t)i.push(t[e]);for(let t=0,s=i.length;t<s;t+=1){const r=i[t];if(void 0===n[r.uid]){const n=t<s+1?i[t+1]:e;this.addTrait(r,n)}}}else for(const i in t)void 0===n[i]&&this.addTrait(t[i],e)},attachTrait(t,e,i){t=this.fromTraitLike(t);const s=this.traitControllers;if(void 0===i&&(i=s[t.uid]),void 0===e&&(e=null),void 0===i){i=this.createController(),this.getTraitRef(i).setTrait(t,e);const n=null!==e?s[e.uid]:void 0;this.attachController(i,n)}return void 0!==s[t.uid]||(s[t.uid]=i,this.willAttachTrait(t,e,i),this.onAttachTrait(t,e,i),this.initTrait(t,i),this.didAttachTrait(t,e,i)),i},initTrait(t,e){},willAttachTrait(t,e,i){},onAttachTrait(t,e,i){},didAttachTrait(t,e,i){},attachTraits(t,e){for(const i in t)this.attachTrait(t[i],e)},detachTrait(t){const e=this.traitControllers,i=e[t.uid];return void 0===i?null:(delete e[t.uid],this.willDetachTrait(t,i),this.onDetachTrait(t,i),this.deinitTrait(t,i),this.didDetachTrait(t,i),i)},deinitTrait(t,e){},willDetachTrait(t,e){},onDetachTrait(t,e){},didDetachTrait(t,e){},detachTraits(t){for(const e in t)this.detachTrait(t[e])},insertTrait(t,e,i,s){e=this.fromTraitLike(e);const n=this.traitControllers;let r=n[e.uid];if(void 0!==r)return r;void 0===i&&(i=null),r=this.createController(),this.getTraitRef(r).setTrait(e,i);const o=null!==i?n[i.uid]:void 0;return this.insertController(t,r,o,s),r},insertTraits(t,e,i,s){for(const n in e)this.insertTrait(t,e[n],i,s)},removeTrait(t){const e=this.controllers;for(const i in e){const s=e[i];if(this.getTraitRef(s).trait===t)return this.removeController(s),s}return null},removeTraits(t){for(const e in t)this.removeTrait(t[e])},deleteTrait(t){const e=this.controllers;for(const i in e){const s=e[i];if(this.getTraitRef(s).trait===t)return this.deleteController(s),s}return null},deleteTraits(t){for(const e in t)this.deleteTrait(t[e])},reinsertTrait(t,e){const i=this.traitControllers[t.uid];if(void 0===i)return;const s=null!==e?this.traitControllers[e.uid]:void 0;this.reinsertController(i,void 0!==s?s:null)},consumeTraits(t){const e=this.controllers;for(const i in e){const s=e[i],n=this.getTraitRef(s).trait;null!==n&&n.consume(t)}},unconsumeTraits(t){const e=this.controllers;for(const i in e){const s=e[i],n=this.getTraitRef(s).trait;null!==n&&n.unconsume(t)}},createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t},fromTraitLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},onAttachController(t,e){const i=this.getTraitRef(t).trait;if(null!==i){const s=null!==e&&this.hasController(e)?this.getTraitRef(e).trait:null;this.attachTrait(i,s,t)}super.onAttachController(t,e)},onDetachController(t){super.onDetachController(t);const e=this.getTraitRef(t).trait;null!==e&&this.detachTrait(e)}},{construct(t,e){return(t=super.construct(t,e)).traitControllers={},t}}),As=ys.extend("TraitViewControllerRef",{getTraitViewRef(t){throw new Error("missing implementation")},set(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof m?this.setTrait(t):t instanceof ue?this.setView(t):this.setController(t),this.owner},setIntrinsic(t){return t instanceof e.Fastener?this.bindInlet(t):t instanceof m?this.setTrait(t):t instanceof ue?this.setView(t):this.setController(t),this.owner},traitType:null,traitKey:void 0,get trait(){const t=this.controller;return null===t?null:this.getTraitViewRef(t).trait},getTrait(){const t=this.trait;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="trait",new TypeError(e)}return t},setTrait(t,e,i){let s=this.controller;if(null!==t){t=this.fromTraitLike(t),null===s&&(s=this.createController(t));const i=this.getTraitViewRef(s);i.setTrait(t,e,this.traitKey),this.setController(s),null===i.view&&i.insertView(this.parentView,null,null,this.viewKey)}else null!==s&&this.getTraitViewRef(s).setTrait(null);return s},attachTrait(t,e){t=null==t?this.createTrait():this.fromTraitLike(t);let i=this.controller;return null===i&&(i=this.createController(t)),this.getTraitViewRef(i).setTrait(t,e,this.traitKey),this.attachController(i,null),i},initTrait(t,e){},willAttachTrait(t,e,i){},onAttachTrait(t,e,i){},didAttachTrait(t,e,i){},detachTrait(t){const e=this.controller;return null===e||this.getTraitViewRef(e).trait!==t?null:(this.willDetachTrait(t,e),this.onDetachTrait(t,e),this.deinitTrait(t,e),this.didDetachTrait(t,e),e)},deinitTrait(t,e){},willDetachTrait(t,e){},onDetachTrait(t,e){},didDetachTrait(t,e){},insertTrait(t,e,i,s){e=null==e?this.createTrait():this.fromTraitLike(e);let n=this.controller;return null===n&&(n=this.createController(e)),this.getTraitViewRef(n).setTrait(e,i,this.traitKey),this.insertController(t,n),n},removeTrait(t){const e=this.controller;return null===e||this.getTraitViewRef(e).trait!==t?null:(e.remove(),e)},deleteTrait(t){const e=this.controller;return null===e||this.getTraitViewRef(e).trait!==t?null:(e.remove(),this.setController(null),e)},createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t},fromTraitLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},viewType:null,viewKey:void 0,get view(){const t=this.controller;return null===t?null:this.getTraitViewRef(t).view},getView(){const t=this.view;if(null===t){let e=t+" ";const i=this.name.toString();throw 0!==i.length&&(e+=i+" "),e+="view",new TypeError(e)}return t},setView(t,e,i){null!==t&&(t=this.fromViewLike(t));const s=this.attachController(),n=this.getTraitViewRef(s);return void 0===i&&(i=this.viewKey),n.setView(t,e,i)},attachView(t,e){t=null!=t?this.fromViewLike(t):this.createView();const i=this.attachController();return this.getTraitViewRef(i).attachView(t,e)},detachView(){const t=this.controller;return null===t?null:this.getTraitViewRef(t).detachView()},get parentView(){return null},insertView(t,e,i,s){const n=this.attachController(),r=this.getTraitViewRef(n);return null==t&&(t=this.parentView),void 0===s&&(s=this.viewKey),r.insertView(t,e,i,s)},removeView(){const t=this.controller;return null===t?null:this.getTraitViewRef(t).removeView()},deleteView(){const t=this.controller;return null===t?null:this.getTraitViewRef(t).deleteView()},createView(){const t=this.viewType;return null===t?null:t.create()},fromViewLike(t){const e=this.viewType;return null===e?t:e.fromLike(t)}},{construct(t,e){return t=super.construct(t,e)},refine(t){super.refine(t);const e=t.prototype,i=Object.getOwnPropertyDescriptor(e,"traitKey");void 0!==i&&"value"in i&&(!0===i.value?(i.value=t.name,Object.defineProperty(e,"traitKey",i)):!1===i.value&&(i.value=void 0,Object.defineProperty(e,"traitKey",i)));const s=Object.getOwnPropertyDescriptor(e,"viewKey");void 0!==s&&"value"in s&&(!0===s.value?(s.value=t.name,Object.defineProperty(e,"viewKey",s)):!1===s.value&&(s.value=void 0,Object.defineProperty(e,"viewKey",s)))}}),Fs=bs.extend("TraitViewControllerSet",{getTraitViewRef(t){throw new Error("missing implementation")},traitType:null,hasTrait(t){return void 0!==this.traitControllers[t.uid]},addTrait(t,e,i){t=this.fromTraitLike(t);const s=this.traitControllers;let n=s[t.uid];if(void 0!==n)return n;void 0===e&&(e=null),n=this.createController(t);const r=this.getTraitViewRef(n);r.setTrait(t,e,i);const o=null!==e?s[e.uid]:void 0;if(this.addController(n,o,i),null===r.view){const t=r.createView(),e=void 0!==o?this.getTraitViewRef(o).view:null;r.insertView(this.parentView,t,e,i)}return n},addTraits(t,e){for(const i in t)this.addTrait(t[i],e)},setTraits(t,e){const i=this.binds,s=i?this.parentController:null,n=this.traitControllers;for(const e in n)if(void 0===t[e]){const t=this.detachController(n[e]);null!==t&&i&&null!==s&&t.parent===s&&t.remove()}if(0!=(this.flags&bs.OrderedFlag)){const i=new Array;for(const e in t)i.push(t[e]);for(let t=0,s=i.length;t<s;t+=1){const r=i[t];if(void 0===n[r.uid]){const n=t<s+1?i[t+1]:e;this.addTrait(r,n)}}}else for(const i in t)void 0===n[i]&&this.addTrait(t[i],e)},attachTrait(t,e,i){t=this.fromTraitLike(t);const s=this.traitControllers;if(void 0===i&&(i=s[t.uid]),void 0===e&&(e=null),void 0===i){i=this.createController(),this.getTraitViewRef(i).setTrait(t,e);const n=null!==e?s[e.uid]:void 0;this.attachController(i,n)}return void 0===s[t.uid]&&(s[t.uid]=i,this.willAttachTrait(t,e,i),this.onAttachTrait(t,e,i),this.initTrait(t,i),this.didAttachTrait(t,e,i)),i},initTrait(t,e){},willAttachTrait(t,e,i){},onAttachTrait(t,e,i){},didAttachTrait(t,e,i){},attachTraits(t,e){for(const i in t)this.attachTrait(t[i],e)},detachTrait(t){const e=this.traitControllers,i=e[t.uid];return void 0===i?null:(delete e[t.uid],this.willDetachTrait(t,i),this.onDetachTrait(t,i),this.deinitTrait(t,i),this.didDetachTrait(t,i),i)},deinitTrait(t,e){},willDetachTrait(t,e){},onDetachTrait(t,e){},didDetachTrait(t,e){},detachTraits(t){for(const e in t)this.detachTrait(t[e])},insertTrait(t,e,i,s){e=this.fromTraitLike(e);const n=this.traitControllers;let r=n[e.uid];if(void 0!==r)return r;void 0===i&&(i=null),r=this.createController();const o=this.getTraitViewRef(r);o.setTrait(e,i);const l=null!==i?n[i.uid]:void 0;if(this.insertController(t,r,l,s),null===o.view){const t=o.createView(),e=void 0!==l?this.getTraitViewRef(l).view:null;o.insertView(this.parentView,t,e,s)}return r},insertTraits(t,e,i,s){for(const n in e)this.insertTrait(t,e[n],i,s)},removeTrait(t){const e=this.controllers;for(const i in e){const s=e[i];if(this.getTraitViewRef(s).trait===t)return this.removeController(s),s}return null},removeTraits(t){for(const e in t)this.removeTrait(t[e])},deleteTrait(t){const e=this.controllers;for(const i in e){const s=e[i];if(this.getTraitViewRef(s).trait===t)return this.deleteController(s),s}return null},deleteTraits(t){for(const e in t)this.deleteTrait(t[e])},reinsertTrait(t,e){const i=this.traitControllers[t.uid];if(void 0===i)return;const s=null!==e?this.traitControllers[e.uid]:void 0;this.reinsertController(i,void 0!==s?s:null)},consumeTraits(t){const e=this.controllers;for(const i in e){const s=e[i],n=this.getTraitViewRef(s).trait;null!==n&&n.consume(t)}},unconsumeTraits(t){const e=this.controllers;for(const i in e){const s=e[i],n=this.getTraitViewRef(s).trait;null!==n&&n.unconsume(t)}},createTrait(){let t;const e=this.traitType;if(null!==e&&(t=e.create()),null==t){let t="unable to create ";const e=this.name.toString();throw 0!==e.length&&(t+=e+" "),t+="trait",new Error(t)}return t},fromTraitLike(t){const e=this.traitType;return null!==e?e.fromLike(t):m.fromLike(t)},get parentView(){return null},getTargetView(t){if(0==(this.flags&bs.SortedFlag))return null;const e=t.nextSibling;return null===e||void 0===this.controllers[e.uid]?null:this.getTraitViewRef(e).view},onAttachController(t,e){const i=this.getTraitViewRef(t).trait;if(null!==i){const s=null!==e&&this.hasController(e)?this.getTraitViewRef(e).trait:null;this.attachTrait(i,s,t)}super.onAttachController(t,e)},onDetachController(t){super.onDetachController(t);const e=this.getTraitViewRef(t).trait;null!==e&&this.detachTrait(e)}},{construct(t,e){return(t=super.construct(t,e)).traitControllers={},t}});let ks=(()=>{var t;let i,s,n=e.Service,r=[],o=[],l=[];return t=class extends n{constructor(){super(),this.roots=(u(this,r),u(this,o,void 0)),this.visibilityChange=u(this,l,void 0),this.updateFlags=0,this.updateTime=performance.now(),this.updateDelay=t.MinUpdateDelay,this.compileTimer=0,this.executeTimer=0,this.runCompilePass=this.runCompilePass.bind(this),this.runExecutePass=this.runExecutePass.bind(this)}setUpdateFlags(t){this.updateFlags=t}needsUpdate(t,e){return t}requestUpdate(e,i,s){i=this.needsUpdate(i,s);let n=this.updateFlags&~i&vs.UpdateMask;0!=(i&vs.CompileMask)&&(n|=vs.NeedsCompile),0!=(i&vs.ExecuteMask)&&(n|=vs.NeedsExecute),this.setUpdateFlags(this.updateFlags|n),s&&0==(this.updateFlags&(vs.CompilingFlag|vs.ExecutingFlag))&&this.updateDelay<=t.MaxCompileInterval?this.runImmediatePass():this.scheduleUpdate()}scheduleUpdate(){const e=this.updateFlags;0==(e&vs.CompilingFlag)&&0!=(e&vs.CompileMask)?this.scheduleCompilePass(this.updateDelay):0==(e&vs.ExecutingFlag)&&0!=(e&vs.ExecuteMask)&&this.scheduleExecutePass(t.MinExecuteInterval)}cancelUpdate(){this.cancelCompilePass(),this.cancelExecutePass()}runImmediatePass(){0!=(this.updateFlags&vs.CompileMask)&&(this.cancelUpdate(),this.runCompilePass(!0)),0!=(this.updateFlags&vs.ExecuteMask)&&this.updateDelay<=t.MaxCompileInterval&&(this.cancelUpdate(),this.runExecutePass(!0))}scheduleCompilePass(t){0===this.compileTimer&&(this.compileTimer=setTimeout(this.runCompilePass,t))}cancelCompilePass(){0!==this.compileTimer&&(clearTimeout(this.compileTimer),this.compileTimer=0)}runCompilePass(e=!1){e||(this.compileTimer=0),this.setUpdateFlags(this.updateFlags&~vs.CompileMask|vs.CompilingFlag);try{const i=performance.now();this.updateTime=i;const s=this.roots.controllers;for(const t in s){const e=s[t];0!=(e.flags&vs.CompileMask)&&e.cascadeCompile(0)}const n=performance.now();let r=Math.max(t.MinCompileInterval,this.updateDelay);this.updateDelay=n-i>r?Math.min(Math.max(2,2*this.updateDelay),t.MaxUpdateDelay):Math.min(t.MinUpdateDelay,this.updateDelay/2),this.cancelCompilePass(),0!=(this.updateFlags&vs.ExecuteMask)?this.scheduleExecutePass(t.MinExecuteInterval):0!=(this.updateFlags&vs.CompileMask)&&(e&&(r=Math.max(t.MaxCompileInterval,r)),this.cancelExecutePass(),this.scheduleCompilePass(r))}finally{this.setUpdateFlags(this.updateFlags&~vs.CompilingFlag)}}scheduleExecutePass(t){0===this.executeTimer&&(this.executeTimer=setTimeout(this.runExecutePass,t))}cancelExecutePass(){0!==this.executeTimer&&(clearTimeout(this.executeTimer),this.executeTimer=0)}runExecutePass(e=!1){e||(this.executeTimer=0),this.setUpdateFlags(this.updateFlags&~vs.ExecuteMask|vs.ExecutingFlag);try{const i=performance.now();this.updateTime=i;const s=this.roots.controllers;for(const t in s){const e=s[t];0!=(e.flags&vs.ExecuteMask)&&e.cascadeExecute(0)}if(this.cancelExecutePass(),0!=(this.updateFlags&vs.CompileMask)){let i=this.updateDelay;e&&(i=Math.max(t.MaxCompileInterval,i)),this.scheduleCompilePass(i)}else 0!=(this.updateFlags&vs.ExecuteMask)&&(this.cancelCompilePass(),this.scheduleExecutePass(t.MaxExecuteInterval))}finally{this.setUpdateFlags(this.updateFlags&~vs.ExecutingFlag)}}get powerFlags(){return 0}power(){const t=this.roots.controllers;for(const e in t){t[e].requireUpdate(this.powerFlags)}}unpower(){this.cancelUpdate(),this.updateDelay=t.MinUpdateDelay}},(()=>{var a;const h="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(a=n[Symbol.metadata])&&void 0!==a?a:null):void 0;i=[bs({initController(t){this.owner.requestUpdate(t,t.flags&vs.UpdateMask,!1)},willAttachController(t){this.owner.callObservers("serviceWillAttachRoot",t,this.owner)},didAttachController(t){this.owner.callObservers("serviceDidAttachRoot",t,this.owner)},willDetachController(t){this.owner.callObservers("serviceWillDetachRoot",t,this.owner)},didDetachController(t){this.owner.callObservers("serviceDidDetachRoot",t,this.owner)}})],s=[e.EventHandler({eventType:"visibilitychange",target:"undefined"!=typeof document?document:null,handle(t){"visible"===document.visibilityState?this.owner.power():this.owner.unpower()}})],d(null,null,i,{kind:"field",name:"roots",static:!1,private:!1,access:{has:t=>"roots"in t,get:t=>t.roots,set:(t,e)=>{t.roots=e}},metadata:h},o,r),d(null,null,s,{kind:"field",name:"visibilityChange",static:!1,private:!1,access:{has:t=>"visibilityChange"in t,get:t=>t.visibilityChange,set:(t,e)=>{t.visibilityChange=e}},metadata:h},l,r),h&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h})})(),t.MinUpdateDelay=0,t.MaxUpdateDelay=167,t.MinCompileInterval=12,t.MaxCompileInterval=33,t.MinExecuteInterval=4,t.MaxExecuteInterval=16,t})();const Ps={empty:r.Lazy((function(){return Object.freeze({fragment:void 0,parameters:{},environment:{}})})),current(){try{return Ps.fromUri(window.location.href)}catch(t){return console.error(t),Ps.empty()}},updated(t,e){void 0===e&&(e=Ps.current()),"fragment"in t&&(e.fragment=t.fragment);for(const i in t.parameters){const s=t.parameters[i];void 0!==s?e.parameters[i]=s:delete e.parameters[i]}for(const i in t.environment){const s=t.environment[i];void 0!==s?e.environment[i]=s:delete e.environment[i]}return e},cloned(t){const e={fragment:t.fragment,parameters:{},environment:{}};for(const i in t.parameters)e.parameters[i]=t.parameters[i];for(const i in t.environment)e.environment[i]=t.environment[i];return e},fromUri(t){const e=(t=s.Uri.fromLike(t)).fragment;return e.isDefined()?Ps.fromUriFragment(e):Ps.empty()},fromUriFragment(t){let e=void 0!==(t=s.UriFragment.fromLike(t)).identifier?s.UriQuery.parse(t.identifier):s.UriQuery.undefined();const i={fragment:void 0,parameters:{},environment:{}};for(;!e.isEmpty();){const t=e.key,s=e.value;void 0!==t?i.parameters[t]=s:i.fragment=s,e=e.tail()}return i},toUri(t){const e=s.UriQuery.builder();void 0!==t.fragment&&e.add(void 0,t.fragment);for(const i in t.parameters){const s=t.parameters[i];e.add(i,s)}return s.Uri.fragment(s.UriFragment.create(e.build().toString()))}};let Vs=(()=>{var t;let i,s=e.Service,n=[],o=[];return t=class extends s{constructor(){super(),this.historyState=void u(this,n),this.popstate=u(this,o,void 0),this.historyState=Ps.current()}get historyUri(){return Ps.toUri(this.historyState)}pushHistory(t){const e=this.historyState,i=Ps.updated(t,Ps.cloned(e)),s=Ps.toUri(i);this.willPushHistory(i,e),this.historyState=i,window.history.pushState(i.environment,"",s.toString()),this.onPushHistory(i,e),this.didPushHistory(i,e)}willPushHistory(t,e){this.callObservers("serviceWillPushHistory",t,e,this)}onPushHistory(t,e){}didPushHistory(t,e){this.callObservers("serviceDidPushHistory",t,e,this)}replaceHistory(t){const e=this.historyState,i=Ps.updated(t,Ps.cloned(e));if(r.Objects.equal(e,i))return;const s=Ps.toUri(i);this.willReplaceHistory(i,e),this.historyState=i,window.history.replaceState(i.environment,"",s.toString()),this.onReplaceHistory(i,e),this.didReplaceHistory(i,e)}willReplaceHistory(t,e){this.callObservers("serviceWillReplaceHistory",t,e,this)}onReplaceHistory(t,e){}didReplaceHistory(t,e){this.callObservers("serviceDidReplaceHistory",t,e,this)}willPopHistory(t,e){this.callObservers("serviceWillPopHistory",t,e,this)}onPopHistory(t,e){}didPopHistory(t,e){this.callObservers("serviceDidPopHistory",t,e,this)}},(()=>{var r;const l="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(r=s[Symbol.metadata])&&void 0!==r?r:null):void 0;i=[e.EventHandler({eventType:"popstate",target:"undefined"!=typeof window?window:null,handle(t){const e={};"object"==typeof t.state&&null!==t.state&&(e.environment=t.state);const i=this.owner.historyState,s=Ps.updated(e,Ps.current());this.owner.willPopHistory(s,i),this.owner.historyState=s,this.owner.onPopHistory(s,i),this.owner.didPopHistory(s,i)}})],d(null,null,i,{kind:"field",name:"popstate",static:!1,private:!1,access:{has:t=>"popstate"in t,get:t=>t.popstate,set:(t,e)=>{t.popstate=e}},metadata:l},o,n),l&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})})(),t})();class Ls{toString(){return o.Format.debug(this)}static history(t,e,i){return new Rs(t,e,i)}static location(t,e){return new Is(t,e)}static fromLike(t){return null==t||t instanceof Ls?t:"string"==typeof t?new Is(t,void 0):"state"in t||"href"in t?this.fromInit(t):new Rs(t,void 0,void 0)}static fromInit(t){if("fragment"in t||"parameters"in t||"environment"in t){const e={};return void 0!==t.fragment&&(e.fragment=t.fragment),void 0!==t.parameters&&(e.parameters=t.parameters),void 0!==t.environment&&(e.environment=t.environment),new Rs(e,t.href,t.title)}if(void 0!==t.href)return new Is(t.href,t.title);throw new TypeError("invalid hyperlink")}}class Rs extends Ls{constructor(t,e,i){super(),this.state=t,this.href=e,this.title=i}activate(t){null!=t&&t.preventDefault(),Vs.global().pushHistory(this.state)}equals(t){return this===t||t instanceof Rs&&(r.Objects.equal(this.state,t.state)&&this.href===t.href&&this.title===t.title)}debug(t){return t=t.write("Hyperlink").write(46).write("history").write(40).debug(this.state),void 0!==this.href&&(t=t.write(", ").debug(this.href)),void 0!==this.title&&(t=t.write(", ").debug(this.title)),t=t.write(41)}}class Is extends Ls{constructor(t,e){super(),this.href=t,this.title=e}get state(){return null}activate(t){null!=t&&t.preventDefault(),window.location.assign(this.href)}equals(t){return this===t||t instanceof Is&&(this.href===t.href&&this.title===t.title)}debug(t){return t=t.write("Hyperlink").write(46).write("location").write(40).debug(this.href),void 0!==this.title&&(t=t.write(", ").debug(this.title)),t=t.write(41)}}t.Arc=Yi,t.ArcView=Xi,t.AttributeAnimator=qe,t.AttributeContext=Ne,t.BooleanAttributeAnimator=We,t.BoxShadow=vt,t.BoxShadowForm=yt,t.BoxShadowInit=mt,t.BoxShadowInterpolator=wt,t.BoxShadowLike=gt,t.BoxShadowParser=bt,t.BoxShadowStyleAnimator=$e,t.BrightnessFeel=oe,t.CanvasRenderer=Ei,t.CanvasView=ji,t.CircleIcon=os,t.CircleIconInterpolator=ls,t.ClassList=di,t.Color=z,t.ColorAttributeAnimator=Ke,t.ColorChannel=H,t.ColorChannelParser=K,t.ColorForm=j,t.ColorInit=q,t.ColorLike=N,t.ColorLook=te,t.ColorParser=W,t.ColorStop=rt,t.ColorStopInit=st,t.ColorStopInterpolator=ot,t.ColorStopLike=it,t.ColorStopListParser=at,t.ColorStopParser=lt,t.ColorStopTuple=nt,t.ColorStyleAnimator=Je,t.Controller=vs,t.ControllerRef=ys,t.ControllerRelation=ws,t.ControllerSet=bs,t.CssRule=li,t.CssScope=ri,t.DisplayerService=De,t.DomService=xi,t.DrawingRenderer=Vi,t.ElementAttributes=gi,t.ElementView=mi,t.EnclosedIcon=ds,t.EnclosedIconInterpolator=us,t.EphemeralStorageService=M,t.ExecutorService=ks,t.Expansion=qt,t.ExpansionAnimator=jt,t.ExpansionInit=Nt,t.ExpansionInterpolator=zt,t.ExpansionLike=Ut,t.Feel=ne,t.FeelVector=Ht,t.FeelVectorInterpolator=Kt,t.FillView=Hi,t.FilledIcon=ss,t.Focus=Pt,t.FocusAnimator=Lt,t.FocusInit=kt,t.FocusInterpolator=Vt,t.FocusLike=Ft,t.Font=I,t.FontFamily=V,t.FontFamilyParser=E,t.FontFamilyStyleAnimator=Ze,t.FontInit=R,t.FontInterpolator=O,t.FontLike=L,t.FontLook=ee,t.FontParser=U,t.FontSize=k,t.Gesture=me,t.GestureInput=ge,t.Graphics=ki,t.GraphicsIconView=ps,t.GraphicsRenderer=Fi,t.GraphicsView=Pi,t.HexColorParser=Q,t.HistoryHyperlink=Rs,t.HistoryService=Vs,t.HistoryState=Ps,t.HslColor=$,t.HslColorInit=Z,t.HslColorInterpolator=tt,t.HslColorLike=J,t.HslColorParser=et,t.HtmlAttributes=vi,t.HtmlIconView=ms,t.HtmlView=wi,t.HtmlViewTagFactory=yi,t.Hyperlink=Ls,t.Icon=is,t.IconGraphicsAnimator=fs,t.IconLayout=ts,t.IconLayoutInit=$i,t.IconLayoutInterpolator=es,t.IconLayoutLike=Zi,t.IconView=cs,t.InterpolatedFeel=re,t.LayoutViewport=Re,t.LengthAttributeAnimator=He,t.LengthLook=$t,t.LengthStyleAnimator=Qe,t.LengthStyleConstraintAnimator=si,t.LineHeight=P,t.LinearGradient=ut,t.LinearGradientAngleParser=ft,t.LinearGradientInit=dt,t.LinearGradientInterpolator=ct,t.LinearGradientLike=ht,t.LinearGradientParser=pt,t.LocationHyperlink=Is,t.Look=Jt,t.LookVector=Wt,t.MediaRule=hi,t.ModalService=Ai,t.ModalView=Mi,t.Model=c,t.ModelRef=p,t.ModelRelation=f,t.ModelSet=g,t.MomentumGesture=Se,t.MomentumGestureInput=Te,t.Mood=ae,t.MoodMatrix=Gt,t.MoodVector=Bt,t.MouseMomentumGesture=Ae,t.MousePositionGesture=Ce,t.MouseScaleGesture=Le,t.NodeView=fi,t.NumberAttributeAnimator=je,t.NumberLook=Zt,t.NumberStyleAnimator=_e,t.NumberStyleConstraintAnimator=ii,t.OpacityFeel=le,t.PaintingRenderer=Ii,t.PathContext=Li,t.PathRenderer=Ri,t.PointerMomentumGesture=xe,t.PointerPositionGesture=ye,t.PointerScaleGesture=Pe,t.PolygonIcon=as,t.PolygonIconInterpolator=hs,t.PositionGesture=we,t.PositionGestureInput=ve,t.Presence=Ot,t.PresenceAnimator=Et,t.PresenceInit=It,t.PresenceInterpolator=Dt,t.PresenceLike=Rt,t.RasterView=Wi,t.Rect=Bi,t.RectView=Gi,t.RefresherService=T,t.RgbColor=Y,t.RgbColorInit=G,t.RgbColorInterpolator=X,t.RgbColorLike=B,t.RgbColorParser=_,t.ScaleGesture=ke,t.ScaleGestureInput=Fe,t.SelectableTrait=F,t.SelectionService=A,t.ShadowLook=ie,t.SolverService=Ee,t.Sprite=Ni,t.SpriteService=zi,t.SpriteSheet=qi,t.StorageService=S,t.StringAttributeAnimator=ze,t.StringStyleAnimator=Xe,t.StrokeView=Ki,t.StyleAnimator=Ye,t.StyleAttribute=ni,t.StyleConstraintAnimator=ei,t.StyleContext=Ge,t.StyleRule=ai,t.StyleSheet=oi,t.StyleValue=Ct,t.StyleValueForm=Tt,t.StyleValueParser=St,t.StyleView=bi,t.StylerService=Ue,t.SvgAttributes=Ci,t.SvgContext=Oi,t.SvgIconView=gs,t.SvgRenderer=Di,t.SvgView=Ti,t.SvgViewTagFactory=Si,t.TextAnimator=ci,t.TextContext=ui,t.TextRun=Qi,t.TextRunView=Ji,t.TextView=pi,t.Theme=he,t.ThemeAnimator=_t,t.ThemeConstraintAnimator=Qt,t.ThemeContext=Xt,t.ThemeMatrix=Yt,t.TimingLook=se,t.ToAttributeString=xt,t.ToCssValue=At,t.ToStyleString=Mt,t.TouchMomentumGesture=Me,t.TouchPositionGesture=be,t.TouchScaleGesture=Ve,t.Trait=m,t.TraitControllerRef=xs,t.TraitControllerSet=Ms,t.TraitModelRef=b,t.TraitModelSet=C,t.TraitRef=w,t.TraitRelation=v,t.TraitSet=y,t.TraitViewControllerRef=As,t.TraitViewControllerSet=Fs,t.TraitViewRef=Cs,t.TransformAttributeAnimator=Be,t.TransformStyleAnimator=ti,t.TypesetView=_i,t.VectorIcon=ns,t.VectorIconInterpolator=rs,t.View=ue,t.ViewControllerRef=Ts,t.ViewControllerSet=Ss,t.ViewInsets=de,t.ViewRef=fe,t.ViewRelation=ce,t.ViewSet=pe,t.ViewportService=Oe,t.VisualViewport=Ie,t.WebGLRenderer=Ui,t.WebStorageService=x,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=swim-ui.min.js.map
