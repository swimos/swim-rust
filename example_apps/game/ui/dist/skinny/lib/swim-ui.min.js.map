{"version":3,"file":"swim-ui.min.js","sources":["../../../../node_modules/tslib/tslib.es6.mjs","../../swim-model/main/Model.ts","../../swim-model/main/ModelRelation.ts","../../swim-model/main/ModelRef.ts","../../swim-model/main/ModelSet.ts","../../swim-model/main/Trait.ts","../../swim-model/main/TraitRelation.ts","../../swim-model/main/TraitRef.ts","../../swim-model/main/TraitSet.ts","../../swim-model/main/TraitModelRef.ts","../../swim-model/main/TraitModelSet.ts","../../swim-model/main/RefresherService.ts","../../swim-model/main/StorageService.ts","../../swim-model/main/SelectionService.ts","../../swim-model/main/SelectableTrait.ts","../../swim-style/main/Font.ts","../../swim-style/main/Color.ts","../../swim-style/main/RgbColor.ts","../../swim-style/main/HslColor.ts","../../swim-style/main/ColorStop.ts","../../swim-style/main/LinearGradient.ts","../../swim-style/main/BoxShadow.ts","../../swim-style/main/StyleValue.ts","../../swim-style/main/ToAttributeString.ts","../../swim-style/main/ToStyleString.ts","../../swim-style/main/ToCssValue.ts","../../swim-style/main/Focus.ts","../../swim-style/main/Presence.ts","../../swim-style/main/Expansion.ts","../../swim-theme/main/LookVector.ts","../../swim-theme/main/FeelVector.ts","../../swim-theme/main/MoodVector.ts","../../swim-theme/main/MoodMatrix.ts","../../swim-theme/main/ThemeMatrix.ts","../../swim-theme/main/ThemeContext.ts","../../swim-theme/main/ThemeAnimator.ts","../../swim-theme/main/ThemeConstraintAnimator.ts","../../swim-theme/main/Look.ts","../../swim-theme/main/Feel.ts","../../swim-theme/main/Mood.ts","../../swim-theme/main/Theme.ts","../../swim-view/main/View.ts","../../swim-view/main/ViewRelation.ts","../../swim-view/main/ViewRef.ts","../../swim-view/main/ViewSet.ts","../../swim-view/main/Gesture.ts","../../swim-view/main/PositionGesture.ts","../../swim-view/main/MomentumGesture.ts","../../swim-view/main/ScaleGesture.ts","../../swim-view/main/Viewport.ts","../../swim-view/main/ViewportService.ts","../../swim-view/main/DisplayerService.ts","../../swim-view/main/SolverService.ts","../../swim-view/main/StylerService.ts","../../swim-dom/main/AttributeAnimator.ts","../../swim-dom/main/StyleAnimator.ts","../../swim-dom/main/StyleConstraintAnimator.ts","../../swim-dom/main/StyleAttribute.ts","../../swim-dom/main/CssScope.ts","../../swim-dom/main/StyleSheet.ts","../../swim-dom/main/CssRule.ts","../../swim-dom/main/StyleRule.ts","../../swim-dom/main/MediaRule.ts","../../swim-dom/main/ClassList.ts","../../swim-dom/main/TextAnimator.ts","../../swim-dom/main/NodeView.ts","../../swim-dom/main/TextView.ts","../../swim-dom/main/ElementView.ts","../../swim-dom/main/HtmlView.ts","../../swim-dom/main/StyleView.ts","../../swim-dom/main/SvgView.ts","../../swim-dom/main/DomService.ts","../../swim-dom/main/ModalView.ts","../../swim-dom/main/ModalService.ts","../../swim-graphics/main/GraphicsRenderer.ts","../../swim-graphics/main/Graphics.ts","../../swim-graphics/main/GraphicsView.ts","../../swim-graphics/main/DrawingRenderer.ts","../../swim-graphics/main/PathContext.ts","../../swim-graphics/main/PathRenderer.ts","../../swim-graphics/main/PaintingRenderer.ts","../../swim-graphics/main/SvgContext.ts","../../swim-graphics/main/SvgRenderer.ts","../../swim-graphics/main/CanvasRenderer.ts","../../swim-graphics/main/WebGLRenderer.ts","../../swim-graphics/main/Sprite.ts","../../swim-graphics/main/SpriteSheet.ts","../../swim-graphics/main/SpriteService.ts","../../swim-graphics/main/CanvasView.ts","../../swim-graphics/main/RasterView.ts","../../swim-graphics/main/FillView.ts","../../swim-graphics/main/StrokeView.ts","../../swim-graphics/main/Rect.ts","../../swim-graphics/main/RectView.ts","../../swim-graphics/main/Arc.ts","../../swim-graphics/main/ArcView.ts","../../swim-graphics/main/TypesetView.ts","../../swim-graphics/main/TextRun.ts","../../swim-graphics/main/TextRunView.ts","../../swim-graphics/main/IconLayout.ts","../../swim-graphics/main/Icon.ts","../../swim-graphics/main/FilledIcon.ts","../../swim-graphics/main/VectorIcon.ts","../../swim-graphics/main/CircleIcon.ts","../../swim-graphics/main/PolygonIcon.ts","../../swim-graphics/main/EnclosedIcon.ts","../../swim-graphics/main/IconView.ts","../../swim-graphics/main/GraphicsIconView.ts","../../swim-graphics/main/SvgIconView.ts","../../swim-graphics/main/HtmlIconView.ts","../../swim-controller/main/Controller.ts","../../swim-controller/main/ControllerRelation.ts","../../swim-controller/main/ControllerRef.ts","../../swim-controller/main/ControllerSet.ts","../../swim-controller/main/TraitViewRef.ts","../../swim-controller/main/ViewControllerRef.ts","../../swim-controller/main/ViewControllerSet.ts","../../swim-controller/main/TraitControllerRef.ts","../../swim-controller/main/TraitControllerSet.ts","../../swim-controller/main/TraitViewControllerRef.ts","../../swim-controller/main/TraitViewControllerSet.ts","../../swim-controller/main/ExecutorService.ts","../../swim-controller/main/HistoryState.ts","../../swim-controller/main/HistoryService.ts","../../swim-controller/main/Hyperlink.ts"],"sourcesContent":["/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n        if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n        dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n        if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n        dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  function next() {\n    while (env.stack.length) {\n      var rec = env.stack.pop();\n      try {\n        var result = rec.dispose && rec.dispose.call(rec.value);\n        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n      }\n      catch (e) {\n          fail(e);\n      }\n    }\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {Instance} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {Comparator} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {FromLike} from \"@swim/util\";\nimport type {Dictionary} from \"@swim/util\";\nimport type {MutableDictionary} from \"@swim/util\";\nimport type {Creatable} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Consumable} from \"@swim/util\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerTemplate} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport type {ComponentFlags} from \"@swim/component\";\nimport type {ComponentObserver} from \"@swim/component\";\nimport {Component} from \"@swim/component\";\nimport type {ValueLike} from \"@swim/structure\";\nimport {Value} from \"@swim/structure\";\nimport type {UriLike} from \"@swim/uri\";\nimport {Uri} from \"@swim/uri\";\nimport type {WarpDownlinkModel} from \"@swim/client\";\nimport {WarpDownlink} from \"@swim/client\";\nimport {EventDownlink} from \"@swim/client\";\nimport {ValueDownlink} from \"@swim/client\";\nimport {ListDownlink} from \"@swim/client\";\nimport {MapDownlink} from \"@swim/client\";\nimport {WarpRef} from \"@swim/client\";\nimport {WarpClient} from \"@swim/client\";\nimport {ModelRelation} from \"./\"; // forward import\nimport {Trait} from \"./\"; // forward import\nimport {TraitRelation} from \"./\"; // forward import\nimport {RefresherService} from \"./\"; // forward import\nimport {SelectionService} from \"./\"; // forward import\n\n/** @public */\nexport type ModelFlags = ComponentFlags;\n\n/** @public */\nexport interface ModelFactory<M extends Model = Model> extends Creatable<M>, FromLike<M> {\n}\n\n/** @public */\nexport interface ModelClass<M extends Model = Model> extends Function, ModelFactory<M> {\n  readonly prototype: M;\n}\n\n/** @public */\nexport interface ModelConstructor<M extends Model = Model> extends ModelClass<M> {\n  new(): M;\n}\n\n/** @public */\nexport interface ModelObserver<M extends Model = Model> extends ComponentObserver<M> {\n  modelWillAttachParent?(parent: Model, model: M): void;\n\n  modelDidAttachParent?(parent: Model, model: M): void;\n\n  modelWillDetachParent?(parent: Model, model: M): void;\n\n  modelDidDetachParent?(parent: Model, model: M): void;\n\n  modelWillInsertChild?(child: Model, target: Model | null, model: M): void;\n\n  modelDidInsertChild?(child: Model, target: Model | null, model: M): void;\n\n  modelWillRemoveChild?(child: Model, model: M): void;\n\n  modelDidRemoveChild?(child: Model, model: M): void;\n\n  modelWillReinsertChild?(child: Model, target: Model | null, model: M): void;\n\n  modelDidReinsertChild?(child: Model, target: Model | null, model: M): void;\n\n  modelWillInsertTrait?(trait: Trait, target: Trait | null, model: M): void;\n\n  modelDidInsertTrait?(trait: Trait, target: Trait | null, model: M): void;\n\n  modelWillRemoveTrait?(trait: Trait, model: M): void;\n\n  modelDidRemoveTrait?(trait: Trait, model: M): void;\n\n  modelWillMount?(model: M): void;\n\n  modelDidMount?(model: M): void;\n\n  modelWillUnmount?(model: M): void;\n\n  modelDidUnmount?(model: M): void;\n\n  modelWillMutate?(model: M): void;\n\n  modelDidMutate?(model: M): void;\n\n  modelWillAggregate?(model: M): void;\n\n  modelDidAggregate?(model: M): void;\n\n  modelWillCorrelate?(model: M): void;\n\n  modelDidCorrelate?(model: M): void;\n\n  modelWillValidate?(model: M): void;\n\n  modelDidValidate?(model: M): void;\n\n  modelWillReconcile?(model: M): void;\n\n  modelDidReconcile?(model: M): void;\n\n  modelWillStartConsuming?(model: M): void;\n\n  modelDidStartConsuming?(model: M): void;\n\n  modelWillStopConsuming?(model: M): void;\n\n  modelDidStopConsuming?(model: M): void;\n}\n\n/** @public */\nexport class Model extends Component<Model> implements Consumable, WarpRef {\n  constructor() {\n    super();\n    this.consumers = null;\n    this.firstTrait = null;\n    this.lastTrait = null;\n    this.traitMap = null;\n  }\n\n  /** @override */\n  declare readonly observerType?: Class<ModelObserver>;\n\n  override get componentType(): Class<Model> {\n    return Model;\n  }\n\n  protected override willAttachParent(parent: Model): void {\n    this.callObservers(\"modelWillAttachParent\", parent, this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willAttachParent(parent);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override onAttachParent(parent: Model): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onAttachParent(parent);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override didAttachParent(parent: Model): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didAttachParent(parent);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidAttachParent\", parent, this);\n  }\n\n  protected override willDetachParent(parent: Model): void {\n    this.callObservers(\"modelWillDetachParent\", parent, this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willDetachParent(parent);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override onDetachParent(parent: Model): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onDetachParent(parent);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override didDetachParent(parent: Model): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didDetachParent(parent);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidDetachParent\", parent, this);\n  }\n\n  protected override willInsertChild(child: Model, target: Model | null): void {\n    super.willInsertChild(child, target);\n    this.callObservers(\"modelWillInsertChild\", child, target, this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willInsertChild(child, target);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override onInsertChild(child: Model, target: Model | null): void {\n    super.onInsertChild(child, target);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onInsertChild(child, target);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override didInsertChild(child: Model, target: Model | null): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didInsertChild(child, target);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidInsertChild\", child, target, this);\n    super.didInsertChild(child, target);\n  }\n\n  /** @internal */\n  override cascadeInsert(updateFlags?: ModelFlags): void {\n    if ((this.flags & Model.MountedFlag) !== 0) {\n      if (updateFlags === void 0) {\n        updateFlags = 0;\n      }\n      updateFlags |= this.flags & Model.UpdateMask;\n      if ((updateFlags & Model.AnalyzeMask) !== 0) {\n        this.cascadeAnalyze(updateFlags);\n      }\n    }\n  }\n\n  protected override willRemoveChild(child: Model): void {\n    super.willRemoveChild(child);\n    this.callObservers(\"modelWillRemoveChild\", child, this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willRemoveChild(child);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override onRemoveChild(child: Model): void {\n    super.onRemoveChild(child);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onRemoveChild(child);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override didRemoveChild(child: Model): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didRemoveChild(child);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidRemoveChild\", child, this);\n    super.didRemoveChild(child);\n  }\n\n  protected override willReinsertChild(child: Model, target: Model | null): void {\n    super.willReinsertChild(child, target);\n    this.callObservers(\"modelWillReinsertChild\", child, target, this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willReinsertChild(child, target);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected override onReinsertChild(child: Model, target: Model | null): void {\n    super.onReinsertChild(child, target);\n  }\n\n  protected override didReinsertChild(child: Model, target: Model | null): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didReinsertChild(child, target);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidReinsertChild\", child, target, this);\n    super.didReinsertChild(child, target);\n  }\n\n  /** @internal */\n  override cascadeMount(): void {\n    if ((this.flags & Model.MountedFlag) !== 0) {\n      throw new Error(\"already mounted\");\n    }\n    this.willMount();\n    this.setFlags(this.flags | Model.MountedFlag);\n    this.onMount();\n    this.mountTraits();\n    this.mountChildren();\n    this.didMount();\n  }\n\n  protected override willMount(): void {\n    super.willMount();\n    this.callObservers(\"modelWillMount\", this);\n  }\n\n  protected override didMount(): void {\n    // subsume super\n    this.requestUpdate(this, this.flags & Model.UpdateMask, false);\n    this.requireUpdate(this.mountFlags);\n\n    if (this.decoherent !== null && this.decoherent.length !== 0) {\n      this.requireUpdate(Model.NeedsMutate);\n    }\n\n    this.mountFasteners();\n\n    if (this.consumers !== null && this.consumers.size !== 0) {\n      this.startConsuming();\n    }\n\n    this.callObservers(\"modelDidMount\", this);\n    super.didMount();\n  }\n\n  /** @internal */\n  override cascadeUnmount(): void {\n    if ((this.flags & Model.MountedFlag) === 0) {\n      throw new Error(\"already unmounted\");\n    }\n    this.willUnmount();\n    this.setFlags(this.flags & ~Model.MountedFlag);\n    this.unmountChildren();\n    this.unmountTraits();\n    this.onUnmount();\n    this.didUnmount();\n  }\n\n  protected override willUnmount(): void {\n    super.willUnmount();\n    this.callObservers(\"modelWillUnmount\", this);\n\n    this.stopConsuming();\n  }\n\n  protected override didUnmount(): void {\n    this.callObservers(\"modelDidUnmount\", this);\n    super.didUnmount();\n  }\n\n  getTraitFastener<F extends Fastener>(fastenerName: PropertyKey, fastenerType?: Proto<F>, contextType?: Proto<any> | null): F | null {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const fastener = trait.getFastener(fastenerName, fastenerType, contextType);\n      if (fastener !== null) {\n        return fastener;\n      }\n      trait = trait.nextTrait;\n    }\n    return null;\n  }\n\n  override requireUpdate(updateFlags: ModelFlags, immediate: boolean = false): void {\n    const flags = this.flags;\n    const deltaUpdateFlags = updateFlags & ~flags & Model.UpdateMask;\n    if (deltaUpdateFlags === 0) {\n      return;\n    }\n    this.setFlags(flags | deltaUpdateFlags);\n    this.requestUpdate(this, deltaUpdateFlags, immediate);\n  }\n\n  protected needsUpdate(updateFlags: ModelFlags, immediate: boolean): ModelFlags {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      updateFlags = trait.needsUpdate(updateFlags, immediate);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    return updateFlags;\n  }\n\n  requestUpdate(target: Model, updateFlags: ModelFlags, immediate: boolean): void {\n    updateFlags = this.needsUpdate(updateFlags, immediate);\n    let deltaUpdateFlags = this.flags & ~updateFlags & Model.UpdateMask;\n    if ((updateFlags & Model.AnalyzeMask) !== 0) {\n      deltaUpdateFlags |= Model.NeedsAnalyze;\n    }\n    if ((updateFlags & Model.RefreshMask) !== 0) {\n      deltaUpdateFlags |= Model.NeedsRefresh;\n    }\n    if (deltaUpdateFlags === 0 && !immediate) {\n      return;\n    }\n    this.setFlags(this.flags | deltaUpdateFlags);\n    const parent = this.parent;\n    if (parent !== null) {\n      parent.requestUpdate(target, updateFlags, immediate);\n    } else if (this.mounted) {\n      const updaterService = this.updater.service;\n      if (updaterService !== null) {\n        updaterService.requestUpdate(target, updateFlags, immediate);\n      }\n    }\n  }\n\n  get updating(): boolean {\n    return (this.flags & Model.UpdatingMask) !== 0;\n  }\n\n  get analyzing(): boolean {\n    return (this.flags & Model.AnalyzingFlag) !== 0;\n  }\n\n  protected needsAnalyze(analyzeFlags: ModelFlags): ModelFlags {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      analyzeFlags = trait.needsAnalyze(analyzeFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    return analyzeFlags;\n  }\n\n  cascadeAnalyze(analyzeFlags: ModelFlags): void {\n    try {\n      analyzeFlags &= ~Model.NeedsAnalyze;\n      analyzeFlags |= this.flags & Model.UpdateMask;\n      analyzeFlags = this.needsAnalyze(analyzeFlags);\n      if ((analyzeFlags & Model.AnalyzeMask) === 0) {\n        return;\n      }\n      let cascadeFlags = analyzeFlags;\n      this.setFlags(this.flags & ~Model.NeedsAnalyze | Model.AnalyzingFlag);\n      this.willAnalyze(cascadeFlags);\n      if (((this.flags | analyzeFlags) & Model.NeedsMutate) !== 0) {\n        cascadeFlags |= Model.NeedsMutate;\n        this.setFlags(this.flags & ~Model.NeedsMutate);\n        this.willMutate();\n      }\n      if (((this.flags | analyzeFlags) & Model.NeedsAggregate) !== 0) {\n        cascadeFlags |= Model.NeedsAggregate;\n        this.setFlags(this.flags & ~Model.NeedsAggregate);\n        this.willAggregate();\n      }\n      if (((this.flags | analyzeFlags) & Model.NeedsCorrelate) !== 0) {\n        cascadeFlags |= Model.NeedsCorrelate;\n        this.setFlags(this.flags & ~Model.NeedsCorrelate);\n        this.willCorrelate();\n      }\n\n      this.onAnalyze(cascadeFlags);\n      if ((cascadeFlags & Model.NeedsMutate) !== 0) {\n        this.onMutate();\n      }\n      if ((cascadeFlags & Model.NeedsAggregate) !== 0) {\n        this.onAggregate();\n      }\n      if ((cascadeFlags & Model.NeedsCorrelate) !== 0) {\n        this.onCorrelate();\n      }\n\n      if ((cascadeFlags & Model.AnalyzeMask) !== 0) {\n        this.analyzeChildren(cascadeFlags, this.analyzeChild);\n      }\n\n      if ((cascadeFlags & Model.NeedsCorrelate) !== 0) {\n        this.didCorrelate();\n      }\n      if ((cascadeFlags & Model.NeedsAggregate) !== 0) {\n        this.didAggregate();\n      }\n      if ((cascadeFlags & Model.NeedsMutate) !== 0) {\n        this.didMutate();\n      }\n      this.didAnalyze(cascadeFlags);\n    } finally {\n      this.setFlags(this.flags & ~Model.AnalyzingFlag);\n    }\n  }\n\n  protected willAnalyze(analyzeFlags: ModelFlags): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willAnalyze(analyzeFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onAnalyze(analyzeFlags: ModelFlags): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onAnalyze(analyzeFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didAnalyze(analyzeFlags: ModelFlags): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didAnalyze(analyzeFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected willMutate(): void {\n    this.callObservers(\"modelWillMutate\", this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willMutate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onMutate(): void {\n    this.recohereFasteners(this.updateTime);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onMutate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didMutate(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didMutate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidMutate\", this);\n  }\n\n  protected willAggregate(): void {\n    this.callObservers(\"modelWillAggregate\", this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willAggregate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onAggregate(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onAggregate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didAggregate(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didAggregate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidAggregate\", this);\n  }\n\n  protected willCorrelate(): void {\n    this.callObservers(\"modelWillCorrelate\", this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willCorrelate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onCorrelate(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onCorrelate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didCorrelate(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didCorrelate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidCorrelate\", this);\n  }\n\n  protected analyzeChildren(analyzeFlags: ModelFlags, analyzeChild: (this: this, child: Model, analyzeFlags: ModelFlags) => void): void {\n    const trait = this.firstTrait;\n    if (trait !== null) {\n      this.analyzeTraitChildren(trait, analyzeFlags, analyzeChild);\n    } else {\n      this.analyzeOwnChildren(analyzeFlags, analyzeChild);\n    }\n  }\n\n  protected analyzeTraitChildren(trait: Trait, analyzeFlags: ModelFlags, analyzeChild: (this: this, child: Model, analyzeFlags: ModelFlags) => void): void {\n    const next = trait.nextTrait;\n    if (next !== null) {\n      trait.analyzeChildren(analyzeFlags, analyzeChild as any, this.analyzeTraitChildren.bind(this, next) as any);\n    } else {\n      trait.analyzeChildren(analyzeFlags, analyzeChild as any, this.analyzeOwnChildren as any);\n    }\n  }\n\n  protected analyzeOwnChildren(analyzeFlags: ModelFlags,\n                               analyzeChild: (this: this, child: Model, analyzeFlags: ModelFlags) => void): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      analyzeChild.call(this, child, analyzeFlags);\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent analyze pass\");\n      }\n      child = next;\n    }\n  }\n\n  protected analyzeChild(child: Model, analyzeFlags: ModelFlags): void {\n    child.cascadeAnalyze(analyzeFlags);\n  }\n\n  get refreshing(): boolean {\n    return (this.flags & Model.RefreshingFlag) !== 0;\n  }\n\n  protected needsRefresh(refreshFlags: ModelFlags): ModelFlags {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      refreshFlags = trait.needsRefresh(refreshFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n    return refreshFlags;\n  }\n\n  cascadeRefresh(refreshFlags: ModelFlags): void {\n    try {\n      refreshFlags &= ~Model.NeedsRefresh;\n      refreshFlags |= this.flags & Model.UpdateMask;\n      refreshFlags = this.needsRefresh(refreshFlags);\n      if ((refreshFlags & Model.RefreshMask) === 0) {\n        return;\n      }\n      let cascadeFlags = refreshFlags;\n      this.setFlags(this.flags & ~Model.NeedsRefresh | Model.RefreshingFlag);\n      this.willRefresh(cascadeFlags);\n      if (((this.flags | refreshFlags) & Model.NeedsValidate) !== 0) {\n        cascadeFlags |= Model.NeedsValidate;\n        this.setFlags(this.flags & ~Model.NeedsValidate);\n        this.willValidate();\n      }\n      if (((this.flags | refreshFlags) & Model.NeedsReconcile) !== 0) {\n        cascadeFlags |= Model.NeedsReconcile;\n        this.setFlags(this.flags & ~Model.NeedsReconcile);\n        this.willReconcile();\n      }\n\n      this.onRefresh(cascadeFlags);\n      if ((cascadeFlags & Model.NeedsValidate) !== 0) {\n        this.onValidate();\n      }\n      if ((cascadeFlags & Model.NeedsReconcile) !== 0) {\n        this.onReconcile();\n      }\n\n      if ((cascadeFlags & Model.RefreshMask)) {\n        this.refreshChildren(cascadeFlags, this.refreshChild);\n      }\n\n      if ((cascadeFlags & Model.NeedsReconcile) !== 0) {\n        this.didReconcile();\n      }\n      if ((cascadeFlags & Model.NeedsValidate) !== 0) {\n        this.didValidate();\n      }\n      this.didRefresh(cascadeFlags);\n    } finally {\n      this.setFlags(this.flags & ~Model.RefreshingFlag);\n    }\n  }\n\n  protected willRefresh(refreshFlags: ModelFlags): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willRefresh(refreshFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onRefresh(refreshFlags: ModelFlags): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onRefresh(refreshFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didRefresh(refreshFlags: ModelFlags): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didRefresh(refreshFlags);\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected willValidate(): void {\n    this.callObservers(\"modelWillValidate\", this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willValidate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onValidate(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onValidate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didValidate(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didValidate();\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidValidate\", this);\n  }\n\n  protected willReconcile(): void {\n    this.callObservers(\"modelWillReconcile\", this);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.willReconcile();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onReconcile(): void {\n    this.recohereDownlinks(this.updateTime);\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.onReconcile();\n      trait = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didReconcile(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.didReconcile();\n      trait = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidReconcile\", this);\n  }\n\n  protected refreshChildren(refreshFlags: ModelFlags, refreshChild: (this: this, child: Model, refreshFlags: ModelFlags) => void): void {\n    const trait = this.firstTrait;\n    if (trait !== null) {\n      this.refreshTraitChildren(trait, refreshFlags, refreshChild);\n    } else {\n      this.refreshOwnChildren(refreshFlags, refreshChild);\n    }\n  }\n\n  protected refreshTraitChildren(trait: Trait, refreshFlags: ModelFlags, refreshChild: (this: this, child: Model, refreshFlags: ModelFlags) => void): void {\n    const next = trait.nextTrait;\n    if (next !== null) {\n      trait.refreshChildren(refreshFlags, refreshChild as any, this.refreshTraitChildren.bind(this, next) as any);\n    } else {\n      trait.refreshChildren(refreshFlags, refreshChild as any, this.refreshOwnChildren as any);\n    }\n  }\n\n  protected refreshOwnChildren(refreshFlags: ModelFlags, refreshChild: (this: this, child: Model, refreshFlags: ModelFlags) => void): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      refreshChild.call(this, child, refreshFlags);\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent refresh pass\");\n      }\n      child = next;\n    }\n  }\n\n  protected refreshChild(child: Model, refreshFlags: ModelFlags): void {\n    child.cascadeRefresh(refreshFlags);\n  }\n\n  readonly firstTrait: Trait | null;\n\n  /** @internal */\n  setFirstTrait(firstTrait: Trait | null): void {\n    (this as Mutable<this>).firstTrait = firstTrait;\n  }\n\n  readonly lastTrait: Trait | null;\n\n  /** @internal */\n  setLastTrait(lastTrait: Trait | null): void {\n    (this as Mutable<this>).lastTrait = lastTrait;\n  }\n\n  forEachTrait<T>(callback: (trait: Trait) => T | void): T | undefined;\n  forEachTrait<T, S>(callback: (this: S, trait: Trait) => T | void, thisArg: S): T | undefined;\n  forEachTrait<T, S>(callback: (this: S | undefined, trait: Trait) => T | void, thisArg?: S): T | undefined {\n    let result: T | undefined;\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      const result = callback.call(thisArg, trait);\n      if (result !== void 0) {\n        break;\n      }\n      trait = next !== null && next.model === this ? next : null;\n    }\n    return result;\n  }\n\n  /** @internal */\n  readonly traitMap: Dictionary<Trait> | null;\n\n  /** @internal */\n  protected insertTraitMap(trait: Trait): void {\n    const key = trait.key;\n    if (key !== void 0) {\n      let traitMap = this.traitMap as MutableDictionary<Trait>;\n      if (traitMap === null) {\n        traitMap = {};\n        (this as Mutable<this>).traitMap = traitMap;\n      }\n      traitMap[key] = trait;\n    }\n  }\n\n  /** @internal */\n  protected removeTraitMap(trait: Trait): void {\n    const key = trait.key;\n    if (key === void 0) {\n      return;\n    }\n    const traitMap = this.traitMap as MutableDictionary<Trait>;\n    if (traitMap !== null) {\n      delete traitMap[key];\n    }\n  }\n\n  findTrait<F extends Class<Trait>>(key: string | undefined, traitClass: F | null | undefined): InstanceType<F> | null;\n  findTrait(key: string | undefined, traitClass: Class<Trait> | null | undefined): Trait | null;\n  findTrait(key: string | undefined, traitClass: Class<Trait> | null | undefined): Trait | null {\n    if (key !== void 0) {\n      const traitMap = this.traitMap;\n      if (traitMap !== null) {\n        const trait = traitMap[key];\n        if (trait !== void 0 && (traitClass === void 0 || traitClass === null || trait instanceof traitClass)) {\n          return trait;\n        }\n      }\n    }\n    if (traitClass !== void 0 && traitClass !== null) {\n      let trait = this.firstTrait;\n      while (trait !== null) {\n        if (trait instanceof traitClass) {\n          return trait;\n        }\n        trait = (trait as Trait).nextTrait;\n      }\n    }\n    return null;\n  }\n\n  hasTrait(key: string, traitClass?: Class<Trait>): boolean;\n  hasTrait(traitClass: Class<Trait>): boolean;\n  hasTrait(key: string | Class<Trait>, traitClass?: Class<Trait>): boolean {\n    if (typeof key === \"string\") {\n      const traitMap = this.traitMap;\n      if (traitMap !== null) {\n        const trait = traitMap[key];\n        if (trait !== void 0 && (traitClass === void 0 || trait instanceof traitClass)) {\n          return true;\n        }\n      }\n    } else {\n      let trait = this.firstTrait;\n      while (trait !== null) {\n        if (trait instanceof key) {\n          return true;\n        }\n        trait = (trait as Trait).nextTrait;\n      }\n    }\n    return false;\n  }\n\n  getTrait<F extends Class<Trait>>(key: string, traitClass: F): InstanceType<F> | null;\n  getTrait(key: string, traitClass?: Class<Trait>): Trait | null;\n  getTrait<F extends Class<Trait>>(traitClass: F): InstanceType<F> | null;\n  getTrait(key: string | Class<Trait>, traitClass?: Class<Trait>): Trait | null {\n    if (typeof key === \"string\") {\n      const traitMap = this.traitMap;\n      if (traitMap !== null) {\n        const trait = traitMap[key];\n        if (trait !== void 0 && (traitClass === void 0 || trait instanceof traitClass)) {\n          return trait;\n        }\n      }\n    } else {\n      let trait = this.firstTrait;\n      while (trait !== null) {\n        if (trait instanceof key) {\n          return trait;\n        }\n        trait = (trait as Trait).nextTrait;\n      }\n    }\n    return null;\n  }\n\n  setTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(key: string, newChildFactory: F): Trait | null;\n  setTrait(key: string, newTrait: Trait | LikeType<Trait> | null): Trait | null;\n  setTrait(key: string, newTrait: Trait | LikeType<Trait> | null): Trait | null {\n    if (newTrait !== null) {\n      newTrait = Trait.fromLike(newTrait);\n    }\n    const oldTrait = this.getTrait(key);\n    let target: Trait | null;\n\n    if (oldTrait !== null && newTrait !== null && oldTrait !== newTrait) { // replace\n      newTrait.remove();\n      target = oldTrait.nextTrait;\n\n      this.willRemoveTrait(oldTrait);\n      oldTrait.detachModel(this);\n      this.removeTraitMap(oldTrait);\n      this.onRemoveTrait(oldTrait);\n      this.didRemoveTrait(oldTrait);\n      oldTrait.setKey(void 0);\n\n      newTrait.setFlags(newTrait.flags | Trait.InsertingFlag);\n      newTrait.setKey(oldTrait.key);\n      this.willInsertTrait(newTrait, target);\n      this.insertTraitMap(newTrait);\n      newTrait.attachModel(this, target);\n      this.onInsertTrait(newTrait, target);\n      this.didInsertTrait(newTrait, target);\n      newTrait.setFlags(newTrait.flags & ~Trait.InsertingFlag);\n    } else if (oldTrait !== newTrait || newTrait !== null && newTrait.key !== key) {\n      if (oldTrait !== null) { // remove\n        target = oldTrait.nextTrait;\n        this.willRemoveTrait(oldTrait);\n        oldTrait.detachModel(this);\n        this.removeTraitMap(oldTrait);\n        this.onRemoveTrait(oldTrait);\n        this.didRemoveTrait(oldTrait);\n        oldTrait.setKey(void 0);\n      } else {\n        target = null;\n      }\n\n      if (newTrait !== null) { // insert\n        newTrait.remove();\n\n        newTrait.setFlags(newTrait.flags | Trait.InsertingFlag);\n        newTrait.setKey(key);\n        this.willInsertTrait(newTrait, target);\n        this.insertTraitMap(newTrait);\n        newTrait.attachModel(this, target);\n        this.onInsertTrait(newTrait, target);\n        this.didInsertTrait(newTrait, target);\n        newTrait.setFlags(newTrait.flags & ~Trait.InsertingFlag);\n      }\n    }\n\n    return oldTrait;\n  }\n\n  appendTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(childFactory: F, key?: string): InstanceType<F>;\n  appendTrait<T extends Trait>(trait: T | LikeType<T>, key?: string): T;\n  appendTrait(trait: Trait | LikeType<Trait>, key?: string): Trait;\n  appendTrait(trait: Trait | LikeType<Trait>, key?: string): Trait {\n    trait = Trait.fromLike(trait);\n\n    trait.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n    }\n\n    trait.setFlags(trait.flags | Trait.InsertingFlag);\n    trait.setKey(key);\n    this.willInsertTrait(trait, null);\n    this.insertTraitMap(trait);\n    trait.attachModel(this, null);\n    this.onInsertTrait(trait, null);\n    this.didInsertTrait(trait, null);\n    trait.setFlags(trait.flags & ~Trait.InsertingFlag);\n\n    return trait;\n  }\n\n  prependTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(childFactory: F, key?: string): InstanceType<F>;\n  prependTrait<T extends Trait>(trait: T | LikeType<T>, key?: string): T;\n  prependTrait(trait: Trait | LikeType<Trait>, key?: string): Trait;\n  prependTrait(trait: Trait | LikeType<Trait>, key?: string): Trait {\n    trait = Trait.fromLike(trait);\n\n    trait.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n    }\n    const target = this.firstTrait;\n\n    trait.setFlags(trait.flags | Trait.InsertingFlag);\n    trait.setKey(key);\n    this.willInsertTrait(trait, target);\n    this.insertTraitMap(trait);\n    trait.attachModel(this, target);\n    this.onInsertTrait(trait, target);\n    this.didInsertTrait(trait, target);\n    trait.setFlags(trait.flags & ~Trait.InsertingFlag);\n\n    return trait;\n  }\n\n  insertTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(childFactory: F, target: Trait | null, key?: string): InstanceType<F>;\n  insertTrait<T extends Trait>(trait: T | LikeType<T>, target: Trait | null, key?: string): T;\n  insertTrait(trait: Trait | LikeType<Trait>, target: Trait | null, key?: string): Trait;\n  insertTrait(trait: Trait | LikeType<Trait>, target: Trait | null, key?: string): Trait {\n    if (target !== null && target.model !== this) {\n      throw new Error(\"insert target is not a member trait\");\n    }\n    trait = Trait.fromLike(trait);\n\n    trait.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n    }\n\n    trait.setFlags(trait.flags | Trait.InsertingFlag);\n    trait.setKey(key);\n    this.willInsertTrait(trait, target);\n    this.insertTraitMap(trait);\n    trait.attachModel(this, target);\n    this.onInsertTrait(trait, target);\n    this.didInsertTrait(trait, target);\n    trait.setFlags(trait.flags & ~Trait.InsertingFlag);\n\n    return trait;\n  }\n\n  replaceTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(newChildFactory: F, oldTrait: Trait): Trait;\n  replaceTrait<T extends Trait>(newTrait: Trait | LikeType<Trait>, oldTrait: T): T;\n  replaceTrait(newTrait: Trait | LikeType<Trait>, oldTrait: Trait): Trait;\n  replaceTrait(newTrait: Trait | LikeType<Trait>, oldTrait: Trait): Trait {\n    if (oldTrait.model !== this) {\n      throw new Error(\"replacement target is not a member trait\");\n    }\n    newTrait = Trait.fromLike(newTrait);\n\n    if (oldTrait !== newTrait) {\n      newTrait.remove();\n      const target = oldTrait.nextTrait;\n\n      this.willRemoveTrait(oldTrait);\n      oldTrait.detachModel(this);\n      this.removeTraitMap(oldTrait);\n      this.onRemoveTrait(oldTrait);\n      this.didRemoveTrait(oldTrait);\n      oldTrait.setKey(void 0);\n\n      newTrait.setFlags(newTrait.flags | Trait.InsertingFlag);\n      newTrait.setKey(oldTrait.key);\n      this.willInsertTrait(newTrait, target);\n      this.insertTraitMap(newTrait);\n      newTrait.attachModel(this, target);\n      this.onInsertTrait(newTrait, target);\n      this.didInsertTrait(newTrait, target);\n      newTrait.setFlags(newTrait.flags & ~Trait.InsertingFlag);\n    }\n\n    return oldTrait;\n  }\n\n  get insertTraitFlags(): ModelFlags {\n    return (this.constructor as typeof Model).InsertTraitFlags;\n  }\n\n  protected willInsertTrait(trait: Trait, target: Trait | null): void {\n    this.callObservers(\"modelWillInsertTrait\", trait, target, this);\n    let prev = this.firstTrait;\n    while (prev !== null) {\n      const next = prev.nextTrait;\n      if (prev !== trait) {\n        prev.willInsertTrait(trait, target);\n      }\n      prev = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onInsertTrait(trait: Trait, target: Trait | null): void {\n    this.requireUpdate(this.insertTraitFlags);\n    this.bindTraitFasteners(trait, target);\n    let prev = this.firstTrait;\n    while (prev !== null) {\n      const next = prev.nextTrait;\n      if (prev !== trait) {\n        prev.onInsertTrait(trait, target);\n      }\n      prev = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected didInsertTrait(trait: Trait, target: Trait | null): void {\n    let prev = this.firstTrait;\n    while (prev !== null) {\n      const next = prev.nextTrait;\n      if (prev !== trait) {\n        prev.didInsertTrait(trait, target);\n      }\n      prev = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidInsertTrait\", trait, target, this);\n  }\n\n  removeTrait<T extends Trait>(trait: T): T;\n  removeTrait(key: string | Trait): Trait | null;\n  removeTrait(key: string | Trait): Trait | null {\n    let trait: Trait | null;\n    if (typeof key === \"string\") {\n      trait = this.getTrait(key);\n      if (trait === null) {\n        return null;\n      }\n    } else {\n      trait = key;\n      if (trait.model !== this) {\n        throw new Error(\"not a member trait\");\n      }\n    }\n\n    this.willRemoveTrait(trait);\n    trait.detachModel(this);\n    this.removeTraitMap(trait);\n    this.onRemoveTrait(trait);\n    this.didRemoveTrait(trait);\n    trait.setKey(void 0);\n\n    return trait;\n  }\n\n  get removeTraitFlags(): ModelFlags {\n    return (this.constructor as typeof Model).RemoveTraitFlags;\n  }\n\n  protected willRemoveTrait(trait: Trait): void {\n    this.callObservers(\"modelWillRemoveTrait\", trait, this);\n    let prev = this.firstTrait;\n    while (prev !== null) {\n      const next = prev.nextTrait;\n      if (prev !== trait) {\n        prev.willRemoveTrait(trait);\n      }\n      prev = next !== null && next.model === this ? next : null;\n    }\n  }\n\n  protected onRemoveTrait(trait: Trait): void {\n    this.requireUpdate(this.removeTraitFlags);\n    let prev = this.firstTrait;\n    while (prev !== null) {\n      const next = prev.nextTrait;\n      if (prev !== trait) {\n        prev.onRemoveTrait(trait);\n      }\n      prev = next !== null && next.model === this ? next : null;\n    }\n    this.unbindTraitFasteners(trait);\n  }\n\n  protected didRemoveTrait(trait: Trait): void {\n    let prev = this.firstTrait;\n    while (prev !== null) {\n      const next = prev.nextTrait;\n      if (prev !== trait) {\n        prev.didRemoveTrait(trait);\n      }\n      prev = next !== null && next.model === this ? next : null;\n    }\n    this.callObservers(\"modelDidRemoveTrait\", trait, this);\n  }\n\n  sortTraits(comparator: Comparator<Trait>): void {\n    let trait = this.firstTrait;\n    if (trait === null) {\n      return;\n    }\n\n    const traits: Trait[] = [];\n    do {\n      traits.push(trait);\n      trait = trait.nextTrait;\n    } while (trait !== null);\n    traits.sort(comparator);\n\n    trait = traits[0]!;\n    this.setFirstTrait(trait);\n    trait.setPreviousTrait(null);\n    for (let i = 1; i < traits.length; i += 1) {\n      const next = traits[i]!;\n      trait.setNextTrait(next);\n      next.setPreviousTrait(trait);\n      trait = next;\n    }\n    trait.setNextTrait(null);\n    this.setLastTrait(trait);\n  }\n\n  /** @internal */\n  protected mountTraits(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.mountTrait();\n      if (next !== null && next.model !== this) {\n        throw new Error(\"inconsistent mount\");\n      }\n      trait = next;\n    }\n  }\n\n  /** @internal */\n  protected unmountTraits(): void {\n    let trait = this.firstTrait;\n    while (trait !== null) {\n      const next = trait.nextTrait;\n      trait.unmountTrait();\n      if (next !== null && next.model !== this) {\n        throw new Error(\"inconsistent unmount\");\n      }\n      trait = next;\n    }\n  }\n\n  getAncestorTrait<F extends Class<Trait>>(ancestorType: F): InstanceType<F> | null {\n    let ancestor = this.parent;\n    while (ancestor !== null) {\n      const ancestorTrait = ancestor.getTrait(ancestorType);\n      if (ancestorTrait !== null) {\n        return ancestorTrait;\n      }\n      ancestor = ancestor.parent;\n    }\n    return null;\n  }\n\n  getRootTrait<F extends Class<Trait>>(rootType: F): InstanceType<F> | null {\n    let rootTrait: InstanceType<F> | null = null;\n    let ancestor = this.parent;\n    while (ancestor !== null) {\n      const ancestorTrait = ancestor.getTrait(rootType);\n      if (ancestorTrait !== null) {\n        rootTrait = ancestorTrait;\n      }\n      ancestor = ancestor.parent;\n    }\n    return rootTrait;\n  }\n\n  protected override bindFastener(fastener: Fastener): void {\n    super.bindFastener(fastener);\n    if (fastener instanceof TraitRelation && fastener.binds) {\n      let trait = this.firstTrait;\n      while (trait !== null) {\n        const next = trait.nextTrait;\n        fastener.bindTrait(trait, next);\n        trait = next !== null && next.model === this ? next : null;\n      }\n    }\n    if (this.consuming) {\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected override bindChildFastener(fastener: Fastener, child: Model, target: Model | null): void {\n    super.bindChildFastener(fastener, child, target);\n    if (fastener instanceof ModelRelation || fastener instanceof TraitRelation) {\n      fastener.bindModel(child, target);\n    }\n  }\n\n  /** @internal */\n  protected override unbindChildFastener(fastener: Fastener, child: Model): void {\n    if (fastener instanceof ModelRelation || fastener instanceof TraitRelation) {\n      fastener.unbindModel(child);\n    }\n    super.unbindChildFastener(fastener, child);\n  }\n\n  /** @internal */\n  protected bindTraitFasteners(trait: Trait, target: Trait | null): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        this.bindTraitFastener(fastener, trait, target);\n      }\n    }\n  }\n\n  /** @internal */\n  protected bindTraitFastener(fastener: Fastener, trait: Trait, target: Trait | null): void {\n    if (fastener instanceof TraitRelation) {\n      fastener.bindTrait(trait, target);\n    }\n  }\n\n  /** @internal */\n  protected unbindTraitFasteners(trait: Trait): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        this.unbindTraitFastener(fastener, trait);\n      }\n    }\n  }\n\n  /** @internal */\n  protected unbindTraitFastener(fastener: Fastener, trait: Trait): void {\n    if (fastener instanceof TraitRelation) {\n      fastener.unbindTrait(trait);\n    }\n  }\n\n  /** @internal */\n  protected override enqueueFastener(fastener: Fastener): void {\n    super.enqueueFastener(fastener);\n    if (fastener instanceof WarpDownlink) {\n      this.requireUpdate(Model.NeedsReconcile);\n    } else {\n      this.requireUpdate(Model.NeedsMutate);\n    }\n  }\n\n  /** @internal */\n  override recohereFasteners(t?: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent === null || decoherent.length === 0) {\n      return;\n    } else if (t === void 0) {\n      t = performance.now();\n    }\n    (this as Mutable<this>).coherentTime = t;\n    (this as Mutable<this>).decoherent = null;\n    (this as Mutable<this>).recohering = decoherent;\n    try {\n      for (let i = 0; i < decoherent.length; i += 1) {\n        const fastener = decoherent[i]!;\n        if (!(fastener instanceof WarpDownlink)) {\n          fastener.recohere(t);\n        } else {\n          this.enqueueFastener(fastener);\n        }\n      }\n    } finally {\n      (this as Mutable<this>).recohering = null;\n    }\n  }\n\n  /** @internal */\n  recohereDownlinks(t: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent === null || decoherent.length === 0) {\n      return;\n    }\n    let coherentDownlinkProps = false;\n    (this as Mutable<this>).coherentTime = t;\n    (this as Mutable<this>).decoherent = null;\n    (this as Mutable<this>).recohering = decoherent;\n    try {\n      for (let i = 0; i < decoherent.length; i += 1) {\n        const fastener = decoherent[i]!;\n        if (fastener instanceof WarpDownlink) {\n          if (!coherentDownlinkProps) {\n            coherentDownlinkProps = true;\n            this.hostUri.recohere(t);\n            this.nodeUri.recohere(t);\n            this.laneUri.recohere(t);\n          }\n          fastener.recohere(t);\n        } else {\n          this.enqueueFastener(fastener);\n        }\n      }\n    } finally {\n      (this as Mutable<this>).recohering = null;\n    }\n  }\n\n  /** @internal */\n  readonly consumers: ReadonlySet<Consumer> | null;\n\n  /** @override */\n  consume(consumer: Consumer): void {\n    let consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null) {\n      consumers = new Set<Consumer>();\n      (this as Mutable<this>).consumers = consumers;\n    } else if (consumers.has(consumer)) {\n      return;\n    }\n    this.willConsume(consumer);\n    consumers.add(consumer);\n    this.onConsume(consumer);\n    this.didConsume(consumer);\n    if (consumers.size === 1 && this.mounted) {\n      this.startConsuming();\n    }\n  }\n\n  protected willConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected onConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected didConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  /** @override */\n  unconsume(consumer: Consumer): void {\n    const consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null || !consumers.has(consumer)) {\n      return;\n    }\n    this.willUnconsume(consumer);\n    consumers.delete(consumer);\n    this.onUnconsume(consumer);\n    this.didUnconsume(consumer);\n    if (consumers.size === 0) {\n      this.stopConsuming();\n    }\n  }\n\n  protected willUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected onUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected didUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  get consuming(): boolean {\n    return (this.flags & Model.ConsumingFlag) !== 0;\n  }\n\n  get startConsumingFlags(): ModelFlags {\n    return (this.constructor as typeof Model).StartConsumingFlags;\n  }\n\n  protected startConsuming(): void {\n    if ((this.flags & Model.ConsumingFlag) !== 0) {\n      return;\n    }\n    this.willStartConsuming();\n    this.setFlags(this.flags | Model.ConsumingFlag);\n    this.onStartConsuming();\n    this.didStartConsuming();\n  }\n\n  protected willStartConsuming(): void {\n    this.callObservers(\"modelWillStartConsuming\", this);\n  }\n\n  protected onStartConsuming(): void {\n    this.requireUpdate(this.startConsumingFlags);\n    this.startConsumingFasteners();\n  }\n\n  protected didStartConsuming(): void {\n    this.callObservers(\"modelDidStartConsuming\", this);\n  }\n\n  get stopConsumingFlags(): ModelFlags {\n    return (this.constructor as typeof Model).StopConsumingFlags;\n  }\n\n  protected stopConsuming(): void {\n    if ((this.flags & Model.ConsumingFlag) === 0) {\n      return;\n    }\n    this.willStopConsuming();\n    this.setFlags(this.flags & ~Model.ConsumingFlag);\n    this.onStopConsuming();\n    this.didStopConsuming();\n  }\n\n  protected willStopConsuming(): void {\n    this.callObservers(\"modelWillStopConsuming\", this);\n  }\n\n  protected onStopConsuming(): void {\n    this.requireUpdate(this.stopConsumingFlags);\n    this.stopConsumingFasteners();\n  }\n\n  protected didStopConsuming(): void {\n    this.callObservers(\"modelDidStopConsuming\", this);\n  }\n\n  /** @internal */\n  protected startConsumingFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected stopConsumingFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.unconsume(this);\n      }\n    }\n  }\n\n  get updateTime(): number {\n    return this.updater.getService().updateTime;\n  }\n\n  @Provider({\n    get serviceType(): typeof RefresherService { // avoid static forward reference\n      return RefresherService;\n    },\n    mountRootService(service: RefresherService): void {\n      super.mountRootService(service);\n      service.roots.addModel(this.owner);\n    },\n    unmountRootService(service: RefresherService): void {\n      super.unmountRootService(service);\n      service.roots.removeModel(this.owner);\n    },\n  })\n  readonly updater!: Provider<this, RefresherService>;\n\n  @Provider({\n    get serviceType(): typeof SelectionService { // avoid static forward reference\n      return SelectionService;\n    },\n  })\n  get selection(): Provider<this, SelectionService> {\n    return Provider.getter();\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get updateFlags(): ModelFlags {\n      return Model.NeedsReconcile;\n    },\n  })\n  get hostUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get updateFlags(): ModelFlags {\n      return Model.NeedsReconcile;\n    },\n  })\n  get nodeUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get updateFlags(): ModelFlags {\n      return Model.NeedsReconcile;\n    },\n  })\n  get laneUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  downlink(template?: FastenerTemplate<EventDownlink<WarpRef>>): EventDownlink<WarpRef> {\n    let downlinkClass = EventDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlink\", template) as typeof EventDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkValue<V = Value>(template?: FastenerTemplate<ValueDownlink<WarpRef, V>>): ValueDownlink<WarpRef, V> {\n    let downlinkClass = ValueDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkValue\", template) as typeof ValueDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkList<V = Value>(template?: FastenerTemplate<ListDownlink<WarpRef, V>>): ListDownlink<WarpRef, V> {\n    let downlinkClass = ListDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkList\", template) as typeof ListDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkMap<K = Value, V = Value>(template?: FastenerTemplate<MapDownlink<WarpRef, K, V>>): MapDownlink<WarpRef, K, V> {\n    let downlinkClass = MapDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkMap\", template) as typeof MapDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  command(hostUri: UriLike, nodeUri: UriLike, laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(nodeUri: UriLike, laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(body: ValueLike): void;\n  command(hostUri: UriLike | ValueLike, nodeUri?: UriLike | ValueLike, laneUri?: UriLike | ValueLike, body?: ValueLike): void {\n    if (nodeUri === void 0) {\n      body = Value.fromLike(hostUri as ValueLike);\n      laneUri = this.laneUri.getValue();\n      nodeUri = this.nodeUri.getValue();\n      hostUri = this.hostUri.value;\n    } else if (laneUri === void 0) {\n      body = Value.fromLike(nodeUri as ValueLike);\n      laneUri = Uri.fromLike(hostUri as UriLike);\n      nodeUri = this.nodeUri.getValue();\n      hostUri = this.hostUri.value;\n    } else if (body === void 0) {\n      body = Value.fromLike(laneUri as ValueLike);\n      laneUri = Uri.fromLike(nodeUri as UriLike);\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = this.hostUri.value;\n    } else {\n      body = Value.fromLike(body);\n      laneUri = Uri.fromLike(laneUri as UriLike);\n      nodeUri = Uri.fromLike(nodeUri as UriLike);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    if (hostUri === null) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    const warpRef = this.warpRef.value;\n    warpRef.command(hostUri, nodeUri, laneUri, body);\n  }\n\n  /** @override */\n  authenticate(hostUri: UriLike, credentials: ValueLike): void;\n  /** @override */\n  authenticate(credentials: ValueLike): void;\n  authenticate(hostUri: UriLike | ValueLike, credentials?: ValueLike): void {\n    if (credentials === void 0) {\n      credentials = Value.fromLike(hostUri as ValueLike);\n      hostUri = this.hostUri.getValue();\n    } else {\n      credentials = Value.fromLike(credentials);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const warpRef = this.warpRef.value;\n    warpRef.authenticate(hostUri, credentials);\n  }\n\n  /** @override */\n  hostRef(hostUri: UriLike): WarpRef {\n    hostUri = Uri.fromLike(hostUri);\n    const childRef = new Model();\n    childRef.hostUri.set(hostUri);\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @override */\n  nodeRef(hostUri: UriLike, nodeUri: UriLike): WarpRef;\n  /** @override */\n  nodeRef(nodeUri: UriLike): WarpRef;\n  nodeRef(hostUri: UriLike | undefined, nodeUri?: UriLike): WarpRef {\n    if (nodeUri === void 0) {\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = nodeUri.endpoint();\n      if (hostUri.isDefined()) {\n        nodeUri = hostUri.unresolve(nodeUri);\n      } else {\n        hostUri = void 0;\n      }\n    } else {\n      nodeUri = Uri.fromLike(nodeUri);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const childRef = new Model();\n    if (hostUri !== void 0) {\n      childRef.hostUri.set(hostUri);\n    }\n    if (nodeUri !== void 0) {\n      childRef.nodeUri.set(nodeUri);\n    }\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @override */\n  laneRef(hostUri: UriLike, nodeUri: UriLike, laneUri: UriLike): WarpRef;\n  /** @override */\n  laneRef(nodeUri: UriLike, laneUri: UriLike): WarpRef;\n  /** @override */\n  laneRef(laneUri: UriLike): WarpRef;\n  laneRef(hostUri: UriLike | undefined, nodeUri?: UriLike, laneUri?: UriLike): WarpRef {\n    if (nodeUri === void 0) {\n      laneUri = Uri.fromLike(hostUri as UriLike);\n      nodeUri = void 0;\n      hostUri = void 0;\n    } else if (laneUri === void 0) {\n      laneUri = Uri.fromLike(nodeUri);\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = nodeUri.endpoint();\n      if (hostUri.isDefined()) {\n        nodeUri = hostUri.unresolve(nodeUri);\n      } else {\n        hostUri = void 0;\n      }\n    } else {\n      laneUri = Uri.fromLike(laneUri);\n      nodeUri = Uri.fromLike(nodeUri);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const childRef = new Model();\n    if (hostUri !== void 0) {\n      childRef.hostUri.set(hostUri);\n    }\n    if (nodeUri !== void 0) {\n      childRef.nodeUri.set(nodeUri);\n    }\n    if (laneUri !== void 0) {\n      childRef.laneUri.set(laneUri);\n    }\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @internal @override */\n  getDownlink(hostUri: Uri, nodeUri: Uri, laneUri: Uri): WarpDownlinkModel | null {\n    const warpRef = this.warpRef.value;\n    return warpRef.getDownlink(hostUri, nodeUri, laneUri);\n  }\n\n  /** @internal @override */\n  openDownlink(downlink: WarpDownlinkModel): void {\n    const warpRef = this.warpRef.value;\n    warpRef.openDownlink(downlink);\n  }\n\n  @Property({\n    valueType: WarpRef,\n    inherits: true,\n    get updateFlags(): ModelFlags {\n      return Model.NeedsReconcile;\n    },\n    initValue(): WarpRef {\n      return WarpClient.global();\n    },\n    equalValues(newValue: WarpRef, oldValue: WarpRef): boolean {\n      return newValue === oldValue;\n    },\n  })\n  get warpRef(): Property<this, WarpRef> {\n    return Property.getter();\n  }\n\n  /** @internal */\n  static override uid: () => string = (function () {\n    let nextId = 1;\n    return function uid(): string {\n      const id = ~~nextId;\n      nextId += 1;\n      return \"model\" + id;\n    };\n  })();\n\n  /** @internal */\n  static override readonly MountedFlag: ModelFlags = Component.MountedFlag;\n  /** @internal */\n  static override readonly InsertingFlag: ModelFlags = Component.InsertingFlag;\n  /** @internal */\n  static override readonly RemovingFlag: ModelFlags = Component.RemovingFlag;\n  /** @internal */\n  static readonly AnalyzingFlag: ModelFlags = 1 << (Component.FlagShift + 0);\n  /** @internal */\n  static readonly RefreshingFlag: ModelFlags = 1 << (Component.FlagShift + 1);\n  /** @internal */\n  static readonly ConsumingFlag: ModelFlags = 1 << (Component.FlagShift + 2);\n  /** @internal */\n  static readonly UpdatingMask: ModelFlags = this.AnalyzingFlag\n                                           | this.RefreshingFlag;\n  /** @internal */\n  static readonly StatusMask: ModelFlags = this.MountedFlag\n                                         | this.InsertingFlag\n                                         | this.RemovingFlag\n                                         | this.AnalyzingFlag\n                                         | this.RefreshingFlag\n                                         | this.ConsumingFlag;\n\n  static readonly NeedsAnalyze: ModelFlags = 1 << (Component.FlagShift + 3);\n  static readonly NeedsMutate: ModelFlags = 1 << (Component.FlagShift + 4);\n  static readonly NeedsAggregate: ModelFlags = 1 << (Component.FlagShift + 5);\n  static readonly NeedsCorrelate: ModelFlags = 1 << (Component.FlagShift + 6);\n  /** @internal */\n  static readonly AnalyzeMask: ModelFlags = this.NeedsAnalyze\n                                          | this.NeedsMutate\n                                          | this.NeedsAggregate\n                                          | this.NeedsCorrelate;\n\n  static readonly NeedsRefresh: ModelFlags = 1 << (Component.FlagShift + 7);\n  static readonly NeedsValidate: ModelFlags = 1 << (Component.FlagShift + 8);\n  static readonly NeedsReconcile: ModelFlags = 1 << (Component.FlagShift + 9);\n  /** @internal */\n  static readonly RefreshMask: ModelFlags = this.NeedsRefresh\n                                          | this.NeedsValidate\n                                          | this.NeedsReconcile;\n\n  /** @internal */\n  static readonly UpdateMask: ModelFlags = this.AnalyzeMask\n                                         | this.RefreshMask;\n\n  /** @internal */\n  static override readonly FlagShift: number = Component.FlagShift + 10;\n  /** @internal */\n  static override readonly FlagMask: ModelFlags = (1 << this.FlagShift) - 1;\n\n  static override readonly MountFlags: ModelFlags = 0;\n  static override readonly InsertChildFlags: ModelFlags = 0;\n  static override readonly RemoveChildFlags: ModelFlags = 0;\n  static override readonly ReinsertChildFlags: ModelFlags = 0;\n  static readonly InsertTraitFlags: ModelFlags = 0;\n  static readonly RemoveTraitFlags: ModelFlags = 0;\n  static readonly StartConsumingFlags: ModelFlags = 0;\n  static readonly StopConsumingFlags: ModelFlags = 0;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Consumable} from \"@swim/util\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {ModelFactory} from \"./Model\";\nimport {Model} from \"./Model\";\nimport {Trait} from \"./\"; // forward import\n\n/** @public */\nexport interface ModelRelationDescriptor<R, M extends Model> extends FastenerDescriptor<R> {\n  extends?: Proto<ModelRelation<any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface ModelRelationClass<F extends ModelRelation<any, any, any> = ModelRelation<any, any, any>> extends FastenerClass<F> {\n  /** @internal */\n  readonly ConsumingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ModelRelation<R = any, M extends Model = Model, I extends any[] = [M | null]> extends Fastener<R, M | null, I>, Consumable {\n  /** @override */\n  get descriptorType(): Proto<ModelRelationDescriptor<R, M>>;\n\n  /** @override */\n  get fastenerType(): Proto<ModelRelation<any, any, any>>;\n\n  get consumed(): boolean;\n\n  get modelType(): ModelFactory<M> | null;\n\n  get observes(): boolean;\n\n  /** @override */\n  get parent(): ModelRelation<any, M, any> | null;\n\n  /** @internal */\n  readonly outlets: ReadonlySet<Fastener<any, any, any>> | null;\n\n  /** @internal @override */\n  attachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @override */\n  detachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @protected */\n  decohereOutlets(): void;\n\n  /** @protected */\n  initModel(model: M): void;\n\n  /** @protected */\n  willAttachModel(model: M, target: Model | null): void;\n\n  /** @protected */\n  onAttachModel(model: M, target: Model | null): void;\n\n  /** @protected */\n  didAttachModel(model: M, target: Model | null): void;\n\n  /** @protected */\n  deinitModel(model: M): void;\n\n  /** @protected */\n  willDetachModel(model: M): void;\n\n  /** @protected */\n  onDetachModel(model: M): void;\n\n  /** @protected */\n  didDetachModel(model: M): void;\n\n  get parentModel(): Model | null;\n\n  /** @protected */\n  insertChild(parent: Model, child: M, target: Model | null, key: string | undefined): void;\n\n  /** @internal */\n  bindModel(model: Model, target: Model | null): void;\n\n  /** @internal */\n  unbindModel(model: Model): void;\n\n  detectModel(model: Model): M | null;\n\n  createModel(): M;\n\n  /** @protected */\n  fromLike(value: M | LikeType<M>): M;\n\n  /** @internal */\n  readonly consumers: ReadonlySet<Consumer> | null;\n\n  /** @override */\n  consume(consumer: Consumer): void\n\n  /** @protected */\n  willConsume(consumer: Consumer): void;\n\n  /** @protected */\n  onConsume(consumer: Consumer): void;\n\n  /** @protected */\n  didConsume(consumer: Consumer): void;\n\n  /** @override */\n  unconsume(consumer: Consumer): void\n\n  /** @protected */\n  willUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  onUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  didUnconsume(consumer: Consumer): void;\n\n  get consuming(): boolean;\n\n  /** @internal */\n  startConsuming(): void;\n\n  /** @protected */\n  willStartConsuming(): void;\n\n  /** @protected */\n  onStartConsuming(): void;\n\n  /** @protected */\n  didStartConsuming(): void;\n\n  /** @internal */\n  stopConsuming(): void;\n\n  /** @protected */\n  willStopConsuming(): void;\n\n  /** @protected */\n  onStopConsuming(): void;\n\n  /** @protected */\n  didStopConsuming(): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n}\n\n/** @public */\nexport const ModelRelation = (<R, M extends Model, I extends any[], F extends ModelRelation<any, any, any>>() => Fastener.extend<ModelRelation<R, M, I>, ModelRelationClass<F>>(\"ModelRelation\", {\n  get fastenerType(): Proto<ModelRelation<any, any, any>> {\n    return ModelRelation;\n  },\n\n  consumed: false,\n\n  modelType: null,\n\n  observes: false,\n\n  attachOutlet(outlet: Fastener<any, any, any>): void {\n    let outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      outlets = new Set<Fastener<any, any, any>>();\n      (this as Mutable<typeof this>).outlets = outlets;\n    }\n    outlets.add(outlet);\n  },\n\n  detachOutlet(outlet: Fastener<any, any, any>): void {\n    const outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      return;\n    }\n    outlets.delete(outlet);\n  },\n\n  decohereOutlets(): void {\n    const outlets = this.outlets;\n    if (outlets !== null) {\n      for (const outlet of outlets) {\n        outlet.decohere(this);\n      }\n    }\n  },\n\n  initModel(model: M): void {\n    // hook\n  },\n\n  willAttachModel(model: M, target: Model | null): void {\n    // hook\n  },\n\n  onAttachModel(model: M, target: Model | null): void {\n    if (this.observes) {\n      model.observe(this as Observes<M>);\n    }\n    if ((this.flags & ModelRelation.ConsumingFlag) !== 0) {\n      model.consume(this);\n    }\n  },\n\n  didAttachModel(model: M, target: Model | null): void {\n    // hook\n  },\n\n  deinitModel(model: M): void {\n    // hook\n  },\n\n  willDetachModel(model: M): void {\n    // hook\n  },\n\n  onDetachModel(model: M): void {\n    if ((this.flags & ModelRelation.ConsumingFlag) !== 0) {\n      model.unconsume(this);\n    }\n    if (this.observes) {\n      model.unobserve(this as Observes<M>);\n    }\n  },\n\n  didDetachModel(model: M): void {\n    // hook\n  },\n\n  get parentModel(): Model | null {\n    const owner = this.owner;\n    if (owner instanceof Model) {\n      return owner;\n    } else if (owner instanceof Trait) {\n      return owner.model;\n    }\n    return null;\n  },\n\n  insertChild(parent: Model, child: M, target: Model | null, key: string | undefined): void {\n    parent.insertChild(child, target, key);\n  },\n\n  bindModel(model: Model, target: Model | null): void {\n    // hook\n  },\n\n  unbindModel(model: Model): void {\n    // hook\n  },\n\n  detectModel(model: Model): M | null {\n    return null;\n  },\n\n  createModel(): M {\n    let model: M | undefined;\n    const modelType = this.modelType;\n    if (modelType !== null) {\n      model = modelType.create();\n    }\n    if (model === void 0 || model === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"model\";\n      throw new Error(message);\n    }\n    return model;\n  },\n\n  fromLike(value: M | LikeType<M>): M {\n    const modelType = this.modelType;\n    if (modelType !== null) {\n      return modelType.fromLike(value);\n    }\n    return Model.fromLike(value) as M;\n  },\n\n  consume(consumer: Consumer): void {\n    let consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null) {\n      consumers = new Set<Consumer>();\n      (this as Mutable<typeof this>).consumers = consumers;\n    } else if (consumers.has(consumer)) {\n      return;\n    }\n    this.willConsume(consumer);\n    consumers.add(consumer);\n    this.onConsume(consumer);\n    this.didConsume(consumer);\n    if (consumers.size === 1 && this.mounted) {\n      this.startConsuming();\n    }\n  },\n\n  willConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  unconsume(consumer: Consumer): void {\n    const consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null || !consumers.has(consumer)) {\n      return;\n    }\n    this.willUnconsume(consumer);\n    consumers.delete(consumer);\n    this.onUnconsume(consumer);\n    this.didUnconsume(consumer);\n    if (consumers.size === 0) {\n      this.stopConsuming();\n    }\n  },\n\n  willUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  get consuming(): boolean {\n    return (this.flags & ModelRelation.ConsumingFlag) !== 0;\n  },\n\n  startConsuming(): void {\n    if ((this.flags & ModelRelation.ConsumingFlag) !== 0) {\n      return;\n    }\n    this.willStartConsuming();\n    this.setFlags(this.flags | ModelRelation.ConsumingFlag);\n    this.onStartConsuming();\n    this.didStartConsuming();\n  },\n\n  willStartConsuming(): void {\n    // hook\n  },\n\n  onStartConsuming(): void {\n    // hook\n  },\n\n  didStartConsuming(): void {\n    // hook\n  },\n\n  stopConsuming(): void {\n    if ((this.flags & ModelRelation.ConsumingFlag) === 0) {\n      return;\n    }\n    this.willStopConsuming();\n    this.setFlags(this.flags & ~ModelRelation.ConsumingFlag);\n    this.onStopConsuming();\n    this.didStopConsuming();\n  },\n\n  willStopConsuming(): void {\n    // hook\n  },\n\n  onStopConsuming(): void {\n    // hook\n  },\n\n  didStopConsuming(): void {\n    // hook\n  },\n\n  onMount(): void {\n    super.onMount();\n    if (this.consumers !== null && this.consumers.size !== 0) {\n      this.startConsuming();\n    }\n  },\n\n  onUnmount(): void {\n    super.onUnmount();\n    this.stopConsuming();\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).outlets = null;\n    (fastener as Mutable<typeof fastener>).consumers = null;\n    return fastener;\n  },\n\n  ConsumingFlag: 1 << (Fastener.FlagShift + 0),\n\n  FlagShift: Fastener.FlagShift + 1,\n  FlagMask: (1 << (Fastener.FlagShift + 1)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {Model} from \"./Model\";\nimport type {ModelRelationDescriptor} from \"./ModelRelation\";\nimport type {ModelRelationClass} from \"./ModelRelation\";\nimport {ModelRelation} from \"./ModelRelation\";\n\n/** @public */\nexport interface ModelRefDescriptor<R, M extends Model> extends ModelRelationDescriptor<R, M> {\n  extends?: Proto<ModelRef<any, any, any>> | boolean | null;\n  modelKey?: string | boolean;\n}\n\n/** @public */\nexport interface ModelRefClass<F extends ModelRef<any, any, any> = ModelRef<any, any, any>> extends ModelRelationClass<F> {\n  tryModel<R, K extends keyof R, F extends R[K] = R[K]>(owner: R, fastenerName: K): (F extends {readonly model: infer M | null} ? M | null : never) | null;\n}\n\n/** @public */\nexport interface ModelRef<R = any, M extends Model = Model, I extends any[] = [M | null]> extends ModelRelation<R, M, I> {\n  /** @override */\n  get descriptorType(): Proto<ModelRefDescriptor<R, M>>;\n\n  /** @override */\n  get fastenerType(): Proto<ModelRef<any, any, any>>;\n\n  /** @override */\n  get parent(): ModelRef<any, M, any> | null;\n\n  get inletModel(): M | null;\n\n  getInletModel(): M;\n\n  get(): M | null;\n\n  set(model: M | LikeType<M> | Fastener<any, I[0], any> | null): R;\n\n  setIntrinsic(model: M | LikeType<M> | Fastener<any, I[0], any> | null): R;\n\n  get modelKey(): string | undefined;\n\n  readonly model: M | null;\n\n  getModel(): M;\n\n  setModel(model: M | LikeType<M> | null, target?: Model | null, key?: string): M | null;\n\n  attachModel(model?: M | LikeType<M> | null, target?: Model | null): M;\n\n  detachModel(): M | null;\n\n  insertModel(parent?: Model | null, model?: M | LikeType<M>, target?: Model | null, key?: string): M;\n\n  removeModel(): M | null;\n\n  deleteModel(): M | null;\n\n  /** @internal @override */\n  bindModel(model: Model, target: Model | null): void;\n\n  /** @internal @override */\n  unbindModel(model: Model): void;\n\n  /** @override */\n  detectModel(model: Model): M | null;\n\n  /** @protected @override */\n  onStartConsuming(): void;\n\n  /** @protected @override */\n  onStopConsuming(): void;\n\n  /** @override */\n  recohere(t: number): void;\n}\n\n/** @public */\nexport const ModelRef = (<R, M extends Model, I extends any[], F extends ModelRef<any, any, any>>() => ModelRelation.extend<ModelRef<R, M, I>, ModelRefClass<F>>(\"ModelRef\", {\n  get fastenerType(): Proto<ModelRef<any, any, any>> {\n    return ModelRef;\n  },\n\n  get inletModel(): M | null {\n    const inlet = this.inlet;\n    return inlet instanceof ModelRef ? inlet.model : null;\n  },\n\n  getInletModel(): M {\n    const inletModel = this.inletModel;\n    if (inletModel === void 0 || inletModel === null) {\n      let message = inletModel + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"inlet model\";\n      throw new TypeError(message);\n    }\n    return inletModel;\n  },\n\n  get(): M | null {\n    return this.model;\n  },\n\n  set(model: M | LikeType<M> | Fastener<any, I[0], any> | null): R {\n    if (model instanceof Fastener) {\n      this.bindInlet(model);\n    } else {\n      this.setModel(model);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(model: M | LikeType<M> | Fastener<any, I[0], any> | null): R {\n    if (model instanceof Fastener) {\n      this.bindInlet(model);\n    } else {\n      this.setModel(model);\n    }\n    return this.owner;\n  },\n\n  modelKey: void 0,\n\n  getModel(): M {\n    const model = this.model;\n    if (model === null) {\n      let message = model + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"model\";\n      throw new TypeError(message);\n    }\n    return model;\n  },\n\n  setModel(newModel: M | LikeType<M> | null, target?: Model | null, key?: string): M | null {\n    if (newModel !== null) {\n      newModel = this.fromLike(newModel);\n    }\n    let oldModel = this.model;\n    if (oldModel === newModel) {\n      this.setCoherent(true);\n      return oldModel;\n    } else if (target === void 0) {\n      target = null;\n    }\n    let parent: Model | null;\n    if (this.binds && (parent = this.parentModel, parent !== null)) {\n      if (oldModel !== null && oldModel.parent === parent) {\n        if (target === null) {\n          target = oldModel.nextSibling;\n        }\n        oldModel.remove();\n      }\n      if (newModel !== null) {\n        if (key === void 0) {\n          key = this.modelKey;\n        }\n        this.insertChild(parent, newModel, target, key);\n      }\n      oldModel = this.model;\n      if (oldModel === newModel) {\n        return oldModel;\n      }\n    }\n    if (oldModel !== null) {\n      (this as Mutable<typeof this>).model = null;\n      this.willDetachModel(oldModel);\n      this.onDetachModel(oldModel);\n      this.deinitModel(oldModel);\n      this.didDetachModel(oldModel);\n    }\n    if (newModel !== null) {\n      (this as Mutable<typeof this>).model = newModel;\n      this.willAttachModel(newModel, target);\n      this.onAttachModel(newModel, target);\n      this.initModel(newModel);\n      this.didAttachModel(newModel, target);\n    }\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldModel;\n  },\n\n  attachModel(newModel?: M | LikeType<M> | null, target?: Model | null): M {\n    const oldModel = this.model;\n    if (newModel !== void 0 && newModel !== null) {\n      newModel = this.fromLike(newModel);\n    } else if (oldModel === null) {\n      newModel = this.createModel();\n    } else {\n      newModel = oldModel;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (oldModel === newModel) {\n      return newModel;\n    } else if (oldModel !== null) {\n      (this as Mutable<typeof this>).model = null;\n      this.willDetachModel(oldModel);\n      this.onDetachModel(oldModel);\n      this.deinitModel(oldModel);\n      this.didDetachModel(oldModel);\n    }\n    (this as Mutable<typeof this>).model = newModel;\n    this.willAttachModel(newModel, target);\n    this.onAttachModel(newModel, target);\n    this.initModel(newModel);\n    this.didAttachModel(newModel, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newModel;\n  },\n\n  detachModel(): M | null {\n    const oldModel = this.model;\n    if (oldModel === null) {\n      return null;\n    }\n    (this as Mutable<typeof this>).model = null;\n    this.willDetachModel(oldModel);\n    this.onDetachModel(oldModel);\n    this.deinitModel(oldModel);\n    this.didDetachModel(oldModel);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldModel;\n  },\n\n  insertModel(parent?: Model | null, newModel?: M | LikeType<M>, target?: Model | null, key?: string): M {\n    let oldModel = this.model;\n    if (newModel !== void 0 && newModel !== null) {\n      newModel = this.fromLike(newModel);\n    } else if (oldModel === null) {\n      newModel = this.createModel();\n    } else {\n      newModel = oldModel;\n    }\n    if (parent === void 0) {\n      parent = null;\n    }\n    if (!this.binds && oldModel === newModel && newModel.parent !== null && parent === null && key === void 0) {\n      return newModel;\n    }\n    if (parent === null) {\n      parent = this.parentModel;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.modelKey;\n    }\n    if (parent !== null && (newModel.parent !== parent || newModel.key !== key)) {\n      this.insertChild(parent, newModel, target, key);\n    }\n    oldModel = this.model;\n    if (oldModel === newModel) {\n      return newModel;\n    } else if (oldModel !== null) {\n      (this as Mutable<typeof this>).model = null;\n      this.willDetachModel(oldModel);\n      this.onDetachModel(oldModel);\n      this.deinitModel(oldModel);\n      this.didDetachModel(oldModel);\n      if (this.binds && parent !== null && oldModel.parent === parent) {\n        oldModel.remove();\n      }\n    }\n    (this as Mutable<typeof this>).model = newModel;\n    this.willAttachModel(newModel, target);\n    this.onAttachModel(newModel, target);\n    this.initModel(newModel);\n    this.didAttachModel(newModel, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newModel;\n  },\n\n  removeModel(): M | null {\n    const model = this.model;\n    if (model === null) {\n      return null;\n    }\n    model.remove();\n    return model;\n  },\n\n  deleteModel(): M | null {\n    const model = this.detachModel();\n    if (model === null) {\n      return null;\n    }\n    model.remove();\n    return model;\n  },\n\n  bindModel(model: Model, target: Model | null): void {\n    if (!this.binds || this.model !== null) {\n      return;\n    }\n    const newModel = this.detectModel(model);\n    if (newModel === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).model = newModel;\n    this.willAttachModel(newModel, target);\n    this.onAttachModel(newModel, target);\n    this.initModel(newModel);\n    this.didAttachModel(newModel, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindModel(model: Model): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldModel = this.detectModel(model);\n    if (oldModel === null || this.model !== oldModel) {\n      return;\n    }\n    (this as Mutable<typeof this>).model = null;\n    this.willDetachModel(oldModel);\n    this.onDetachModel(oldModel);\n    this.deinitModel(oldModel);\n    this.didDetachModel(oldModel);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectModel(model: Model): M | null {\n    const key = this.modelKey;\n    if (key !== void 0 && key === model.key) {\n      return model as M;\n    }\n    return null;\n  },\n\n  onStartConsuming(): void {\n    const model = this.model;\n    if (model !== null) {\n      model.consume(this);\n    }\n  },\n\n  onStopConsuming(): void {\n    const model = this.model;\n    if (model !== null) {\n      model.unconsume(this);\n    }\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof ModelRef) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setModel(inlet.model);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n},\n{\n  tryModel<R, K extends keyof R, F extends R[K]>(owner: R, fastenerName: K): (F extends {readonly model: infer M | null} ? M | null : never) | null {\n    const metaclass = FastenerContext.getMetaclass(owner);\n    const modelRef = metaclass !== null ? metaclass.tryFastener(owner, fastenerName) : null;\n    return modelRef instanceof ModelRef ? modelRef.model : null;\n  },\n\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).model = null;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<ModelRef<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const modelKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"modelKey\");\n    if (modelKeyDescriptor !== void 0 && \"value\" in modelKeyDescriptor) {\n      if (modelKeyDescriptor.value === true) {\n        modelKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"modelKey\", modelKeyDescriptor);\n      } else if (modelKeyDescriptor.value === false) {\n        modelKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"modelKey\", modelKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Comparator} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {Model} from \"./Model\";\nimport type {ModelRelationDescriptor} from \"./ModelRelation\";\nimport type {ModelRelationClass} from \"./ModelRelation\";\nimport {ModelRelation} from \"./ModelRelation\";\n\n/** @public */\nexport interface ModelSetDescriptor<R, M extends Model> extends ModelRelationDescriptor<R, M> {\n  extends?: Proto<ModelSet<any, any, any>> | boolean | null;\n  ordered?: boolean;\n  sorted?: boolean;\n}\n\n/** @public */\nexport interface ModelSetClass<F extends ModelSet<any, any, any> = ModelSet<any, any, any>> extends ModelRelationClass<F> {\n  /** @internal */\n  readonly OrderedFlag: FastenerFlags;\n  /** @internal */\n  readonly SortedFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ModelSet<R = any, M extends Model = Model, I extends any[] = [M | null]> extends ModelRelation<R, M, I> {\n  /** @override */\n  get descriptorType(): Proto<ModelSetDescriptor<R, M>>;\n\n  /** @override */\n  get fastenerType(): Proto<ModelSet<any, any, any>>;\n\n  /** @override */\n  get parent(): ModelSet<any, M, any> | null;\n\n  /** @protected */\n  modelKey(model: M): string | undefined;\n\n  /** @internal */\n  readonly models: {readonly [modelId: string]: M | undefined};\n\n  readonly modelCount: number;\n\n  /** @internal */\n  insertModelMap(newModel: M, target: Model | null): void;\n\n  /** @internal */\n  removeModelMap(oldModel: M): void;\n\n  hasModel(model: Model): boolean;\n\n  addModel(model?: M | LikeType<M>, target?: Model | null, key?: string): M;\n\n  addModels(models: {readonly [modelId: string]: M | undefined}, target?: Model | null): void;\n\n  setModels(models: {readonly [modelId: string]: M | undefined}, target?: Model | null): void;\n\n  attachModel(model?: M | LikeType<M> | null, target?: Model | null): M;\n\n  attachModels(models: {readonly [modelId: string]: M | undefined}, target?: Model | null): void;\n\n  detachModel(model: M): M | null;\n\n  detachModels(models?: {readonly [modelId: string]: M | undefined}): void;\n\n  insertModel(parent?: Model | null, model?: M | LikeType<M>, target?: Model | null, key?: string): M;\n\n  insertModels(parent: Model | null, models: {readonly [modelId: string]: M | undefined}, target?: Model | null): void;\n\n  removeModel(model: M): M | null;\n\n  removeModels(models?: {readonly [modelId: string]: M | undefined}): void;\n\n  deleteModel(model: M): M | null;\n\n  deleteModels(models?: {readonly [modelId: string]: M | undefined}): void;\n\n  reinsertModel(model: M, target?: Model | null): void;\n\n  /** @internal @override */\n  bindModel(model: Model, target: Model | null): void;\n\n  /** @internal @override */\n  unbindModel(model: Model): void;\n\n  /** @override */\n  detectModel(model: Model): M | null;\n\n  consumeModels(consumer: Consumer): void;\n\n  unconsumeModels(consumer: Consumer): void;\n\n  /** @protected @override */\n  onStartConsuming(): void;\n\n  /** @protected @override */\n  onStopConsuming(): void;\n\n  /** @override */\n  recohere(t: number): void;\n\n  get ordered(): boolean;\n\n  order(ordered?: boolean): this;\n\n  get sorted(): boolean;\n\n  sort(sorted?: boolean): this;\n\n  /** @protected */\n  willSort(parent: Model | null): void;\n\n  /** @protected */\n  onSort(parent: Model | null): void;\n\n  /** @protected */\n  didSort(parent: Model | null): void;\n\n  /** @internal */\n  sortChildren(parent: Model, comparator?: Comparator<M>): void;\n\n  /** @internal */\n  getTargetChild(parent: Model, child: M): Model | null;\n\n  /** @internal */\n  compareChildren(a: Model, b: Model): number;\n\n  /** @internal */\n  compareTargetChild(a: Model, b: Model): number;\n\n  /** @protected */\n  compare(a: M, b: M): number;\n}\n\n/** @public */\nexport const ModelSet = (<R, M extends Model, I extends any[], F extends ModelSet<any, any, any>>() => ModelRelation.extend<ModelSet<R, M, I>, ModelSetClass<F>>(\"ModelSet\", {\n  get fastenerType(): Proto<ModelSet<any, any, any>> {\n    return ModelSet;\n  },\n\n  modelKey(model: M): string | undefined {\n    return void 0;\n  },\n\n  insertModelMap(newModel: M, target: Model | null): void {\n    const models = this.models as {[modelId: string]: M | undefined};\n    if (target !== null && (this.flags & ModelSet.OrderedFlag) !== 0) {\n      (this as Mutable<typeof this>).models = Objects.inserted(models, newModel.uid, newModel, target);\n    } else {\n      models[newModel.uid] = newModel;\n    }\n  },\n\n  removeModelMap(oldModel: M): void {\n    const models = this.models as {[modelId: string]: M | undefined};\n    delete models[oldModel.uid];\n  },\n\n  hasModel(model: Model): boolean {\n    return this.models[model.uid] !== void 0;\n  },\n\n  addModel(newModel?: M | LikeType<M>, target?: Model | null, key?: string): M {\n    if (newModel !== void 0 && newModel !== null) {\n      newModel = this.fromLike(newModel);\n    } else {\n      newModel = this.createModel();\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    let parent: Model | null;\n    if (this.binds && (parent = this.parentModel, parent !== null)) {\n      if (target === null) {\n        if (newModel.parent === parent) {\n          target = newModel.nextSibling;\n        } else {\n          target = this.getTargetChild(parent, newModel);\n        }\n      }\n      if (key === void 0) {\n        key = this.modelKey(newModel);\n      }\n      if (newModel.parent !== parent || newModel.nextSibling !== target || newModel.key !== key) {\n        this.insertChild(parent, newModel, target, key);\n      }\n    }\n    if (this.models[newModel.uid] !== void 0) {\n      return newModel;\n    }\n    this.insertModelMap(newModel, target);\n    (this as Mutable<typeof this>).modelCount += 1;\n    this.willAttachModel(newModel, target);\n    this.onAttachModel(newModel, target);\n    this.initModel(newModel);\n    this.didAttachModel(newModel, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newModel;\n  },\n\n  addModels(newModels: {readonly [modelId: string]: M | undefined}, target?: Model | null): void {\n    for (const modelId in newModels) {\n      this.addModel(newModels[modelId]!, target);\n    }\n  },\n\n  setModels(newModels: {readonly [modelId: string]: M | undefined}, target?: Model | null): void {\n    const binds = this.binds;\n    const parent = binds ? this.parentModel : null;\n    const models = this.models;\n    for (const modelId in models) {\n      if (newModels[modelId] === void 0) {\n        const oldModel = this.detachModel(models[modelId]!);\n        if (oldModel !== null && binds && parent !== null && oldModel.parent === parent) {\n          oldModel.remove();\n        }\n      }\n    }\n    if ((this.flags & ModelSet.OrderedFlag) !== 0) {\n      const orderedModels = new Array<M>();\n      for (const modeld in newModels) {\n        orderedModels.push(newModels[modeld]!);\n      }\n      for (let i = 0, n = orderedModels.length; i < n; i += 1) {\n        const newModel = orderedModels[i]!;\n        if (models[newModel.uid] === void 0) {\n          const targetModel = i < n + 1 ? orderedModels[i + 1] : target;\n          this.addModel(newModel, targetModel);\n        }\n      }\n    } else {\n      for (const modelId in newModels) {\n        if (models[modelId] === void 0) {\n          this.addModel(newModels[modelId]!, target);\n        }\n      }\n    }\n  },\n\n  attachModel(newModel?: M | LikeType<M> | null, target?: Model | null): M {\n    if (newModel !== void 0 && newModel !== null) {\n      newModel = this.fromLike(newModel);\n    } else {\n      newModel = this.createModel();\n    }\n    if (this.models[newModel.uid] !== void 0) {\n      return newModel;\n    } else if (target === void 0) {\n      target = null;\n    }\n    this.insertModelMap(newModel, target);\n    (this as Mutable<typeof this>).modelCount += 1;\n    this.willAttachModel(newModel, target);\n    this.onAttachModel(newModel, target);\n    this.initModel(newModel);\n    this.didAttachModel(newModel, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newModel;\n  },\n\n  attachModels(newModels: {readonly [modelId: string]: M | undefined}, target?: Model | null): void {\n    for (const modelId in newModels) {\n      this.attachModel(newModels[modelId]!, target);\n    }\n  },\n\n  detachModel(oldModel: M): M | null {\n    if (this.models[oldModel.uid] === void 0) {\n      return null;\n    }\n    (this as Mutable<typeof this>).modelCount -= 1;\n    this.removeModelMap(oldModel);\n    this.willDetachModel(oldModel);\n    this.onDetachModel(oldModel);\n    this.deinitModel(oldModel);\n    this.didDetachModel(oldModel);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldModel;\n  },\n\n  detachModels(models?: {readonly [modelId: string]: M | undefined}): void {\n    if (models === void 0) {\n      models = this.models;\n    }\n    for (const modelId in models) {\n      this.detachModel(models[modelId]!);\n    }\n  },\n\n  insertModel(parent?: Model | null, newModel?: M | LikeType<M>, target?: Model | null, key?: string): M {\n    if (newModel !== void 0 && newModel !== null) {\n      newModel = this.fromLike(newModel);\n    } else {\n      newModel = this.createModel();\n    }\n    if (parent === void 0) {\n      parent = null;\n    }\n    if (!this.binds && this.models[newModel.uid] !== void 0 && newModel.parent !== null && parent === null && key === void 0) {\n      return newModel;\n    }\n    if (parent === null) {\n      parent = this.parentModel;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.modelKey(newModel);\n    }\n    if (parent !== null && (newModel.parent !== parent || newModel.key !== key)) {\n      if (target === null) {\n        target = this.getTargetChild(parent, newModel);\n      }\n      this.insertChild(parent, newModel, target, key);\n    }\n    if (this.models[newModel.uid] !== void 0) {\n      return newModel;\n    }\n    this.insertModelMap(newModel, target);\n    (this as Mutable<typeof this>).modelCount += 1;\n    this.willAttachModel(newModel, target);\n    this.onAttachModel(newModel, target);\n    this.initModel(newModel);\n    this.didAttachModel(newModel, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newModel;\n  },\n\n  insertModels(parent: Model | null, newModels: {readonly [modelId: string]: M | undefined}, target?: Model | null): void {\n    for (const modelId in newModels) {\n      this.insertModel(parent, newModels[modelId]!, target);\n    }\n  },\n\n  removeModel(model: M): M | null {\n    if (!this.hasModel(model)) {\n      return model;\n    }\n    model.remove();\n    return model;\n  },\n\n  removeModels(models?: {readonly [modelId: string]: M | undefined}): void {\n    if (models === void 0) {\n      models = this.models;\n    }\n    for (const modelId in models) {\n      this.removeModel(models[modelId]!);\n    }\n  },\n\n  deleteModel(model: M): M | null {\n    const oldModel = this.detachModel(model);\n    if (oldModel === null) {\n      return null;\n    }\n    oldModel.remove();\n    return oldModel;\n  },\n\n  deleteModels(models?: {readonly [modelId: string]: M | undefined}): void {\n    if (models === void 0) {\n      models = this.models;\n    }\n    for (const modelId in models) {\n      this.deleteModel(models[modelId]!);\n    }\n  },\n\n  reinsertModel(model: M, target?: Model | null): void {\n    if (this.models[model.uid] === void 0 || (target === void 0 && (this.flags & ModelSet.SortedFlag) === 0)) {\n      return;\n    }\n    const parent = model.parent;\n    if (parent === null) {\n      return;\n    } else if (target === void 0) {\n      target = this.getTargetChild(parent, model);\n    }\n    parent.reinsertChild(model, target);\n  },\n\n  bindModel(model: Model, target: Model | null): void {\n    if (!this.binds) {\n      return;\n    }\n    const newModel = this.detectModel(model);\n    if (newModel === null || this.models[newModel.uid] !== void 0) {\n      return;\n    }\n    this.insertModelMap(newModel, target);\n    (this as Mutable<typeof this>).modelCount += 1;\n    this.willAttachModel(newModel, target);\n    this.onAttachModel(newModel, target);\n    this.initModel(newModel);\n    this.didAttachModel(newModel, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindModel(model: Model): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldModel = this.detectModel(model);\n    if (oldModel === null || this.models[oldModel.uid] === void 0) {\n      return;\n    }\n    (this as Mutable<typeof this>).modelCount -= 1;\n    this.removeModelMap(oldModel);\n    this.willDetachModel(oldModel);\n    this.onDetachModel(oldModel);\n    this.deinitModel(oldModel);\n    this.didDetachModel(oldModel);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectModel(model: Model): M | null {\n    if (typeof this.modelType === \"function\" && model instanceof this.modelType) {\n      return model as M;\n    }\n    return null;\n  },\n\n  consumeModels(consumer: Consumer): void {\n    const models = this.models;\n    for (const modelId in models) {\n      const model = models[modelId]!;\n      model.consume(consumer);\n    }\n  },\n\n  unconsumeModels(consumer: Consumer): void {\n    const models = this.models;\n    for (const modelId in models) {\n      const model = models[modelId]!;\n      model.unconsume(consumer);\n    }\n  },\n\n  onStartConsuming(): void {\n    this.consumeModels(this);\n  },\n\n  onStopConsuming(): void {\n    this.unconsumeModels(this);\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof ModelSet) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setModels(inlet.models);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n\n  get ordered(): boolean {\n    return (this.flags & ModelSet.OrderedFlag) !== 0;\n  },\n\n  order(ordered?: boolean): typeof this {\n    if (ordered === void 0) {\n      ordered = true;\n    }\n    if (ordered) {\n      this.setFlags(this.flags | ModelSet.OrderedFlag);\n    } else {\n      this.setFlags(this.flags & ~ModelSet.OrderedFlag);\n    }\n    return this;\n  },\n\n  get sorted(): boolean {\n    return (this.flags & ModelSet.SortedFlag) !== 0;\n  },\n\n  sort(sorted?: boolean): typeof this {\n    if (sorted === void 0) {\n      sorted = true;\n    }\n    if (sorted) {\n      const parent = this.parentModel;\n      this.willSort(parent);\n      this.setFlags(this.flags | ModelSet.SortedFlag);\n      this.onSort(parent);\n      this.didSort(parent);\n    } else {\n      this.setFlags(this.flags & ~ModelSet.SortedFlag);\n    }\n    return this;\n  },\n\n  willSort(parent: Model | null): void {\n    // hook\n  },\n\n  onSort(parent: Model | null): void {\n    if (parent !== null) {\n      this.sortChildren(parent);\n    }\n  },\n\n  didSort(parent: Model | null): void {\n    // hook\n  },\n\n  sortChildren(parent: Model, comparator?: Comparator<M>): void {\n    parent.sortChildren(this.compareChildren.bind(this));\n  },\n\n  getTargetChild(parent: Model, child: M): Model | null {\n    if ((this.flags & ModelSet.SortedFlag) !== 0) {\n      return parent.getTargetChild(child, this.compareTargetChild.bind(this));\n    }\n    return null;\n  },\n\n  compareChildren(a: Model, b: Model): number {\n    const models = this.models;\n    const x = models[a.uid];\n    const y = models[b.uid];\n    if (x !== void 0 && y !== void 0) {\n      return this.compare(x, y);\n    }\n    return x !== void 0 ? 1 : y !== void 0 ? -1 : 0;\n  },\n\n  compareTargetChild(a: M, b: Model): number {\n    const models = this.models;\n    const y = models[b.uid];\n    if (y !== void 0) {\n      return this.compare(a, y);\n    }\n    return y !== void 0 ? -1 : 0;\n  },\n\n  compare(a: M, b: M): number {\n    return a.uid < b.uid ? -1 : a.uid > b.uid ? 1 : 0;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).models = {};\n    (fastener as Mutable<typeof fastener>).modelCount = 0;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<ModelSet<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    let flagsInit = fastenerPrototype.flagsInit;\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"ordered\")) {\n      if (fastenerPrototype.ordered) {\n        flagsInit |= ModelSet.OrderedFlag;\n      } else {\n        flagsInit &= ~ModelSet.OrderedFlag;\n      }\n      delete (fastenerPrototype as ModelSetDescriptor<any, any>).ordered;\n    }\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"sorted\")) {\n      if (fastenerPrototype.sorted) {\n        flagsInit |= ModelSet.SortedFlag;\n      } else {\n        flagsInit &= ~ModelSet.SortedFlag;\n      }\n      delete (fastenerPrototype as ModelSetDescriptor<any, any>).sorted;\n    }\n    Object.defineProperty(fastenerPrototype, \"flagsInit\", {\n      value: flagsInit,\n      enumerable: true,\n      configurable: true,\n    });\n  },\n\n  OrderedFlag: 1 << (ModelRelation.FlagShift + 0),\n  SortedFlag: 1 << (ModelRelation.FlagShift + 1),\n\n  FlagShift: ModelRelation.FlagShift + 2,\n  FlagMask: (1 << (ModelRelation.FlagShift + 2)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {__esDecorate} from \"tslib\";\nimport {__runInitializers} from \"tslib\";\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {Instance} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport {Murmur3} from \"@swim/util\";\nimport type {HashCode} from \"@swim/util\";\nimport type {Comparator} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {FromLike} from \"@swim/util\";\nimport {Creatable} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {Observable} from \"@swim/util\";\nimport type {ObserverMethods} from \"@swim/util\";\nimport type {ObserverParameters} from \"@swim/util\";\nimport type {Observer} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Consumable} from \"@swim/util\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerDecorator} from \"@swim/component\";\nimport type {FastenerTemplate} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport type {ValueLike} from \"@swim/structure\";\nimport {Value} from \"@swim/structure\";\nimport type {UriLike} from \"@swim/uri\";\nimport {Uri} from \"@swim/uri\";\nimport type {WarpDownlinkModel} from \"@swim/client\";\nimport {WarpDownlink} from \"@swim/client\";\nimport {EventDownlink} from \"@swim/client\";\nimport {ValueDownlink} from \"@swim/client\";\nimport {ListDownlink} from \"@swim/client\";\nimport {MapDownlink} from \"@swim/client\";\nimport {WarpRef} from \"@swim/client\";\nimport {WarpClient} from \"@swim/client\";\nimport type {ModelFlags} from \"./Model\";\nimport {Model} from \"./Model\";\nimport {ModelRelation} from \"./ModelRelation\";\nimport {TraitRelation} from \"./\"; // forward import\n\n/** @public */\nexport type TraitFlags = number;\n\n/** @public */\nexport interface TraitFactory<T extends Trait = Trait> extends Creatable<T>, FromLike<T> {\n}\n\n/** @public */\nexport interface TraitClass<T extends Trait = Trait> extends Function, TraitFactory<T> {\n  readonly prototype: T;\n}\n\n/** @public */\nexport interface TraitConstructor<T extends Trait = Trait> extends TraitClass<T> {\n  new(): T;\n}\n\n/** @public */\nexport interface TraitObserver<T extends Trait = Trait> extends Observer<T> {\n  traitWillAttachModel?(model: Model, trait: T): void;\n\n  traitDidAttachModel?(model: Model, trait: T): void;\n\n  traitWillDetachModel?(model: Model, trait: T): void;\n\n  traitDidDetachModel?(model: Model, trait: T): void;\n\n  traitWillAttachParent?(parent: Model, trait: T): void;\n\n  traitDidAttachParent?(parent: Model, trait: T): void;\n\n  traitWillDetachParent?(parent: Model, trait: T): void;\n\n  traitDidDetachParent?(parent: Model, trait: T): void;\n\n  traitWillInsertChild?(child: Model, target: Model | null, trait: T): void;\n\n  traitDidInsertChild?(child: Model, target: Model | null, trait: T): void;\n\n  traitWillRemoveChild?(child: Model, trait: T): void;\n\n  traitDidRemoveChild?(child: Model, trait: T): void;\n\n  traitWillReinsertChild?(child: Model, target: Model | null, trait: T): void;\n\n  traitDidReinsertChild?(child: Model, target: Model | null, trait: T): void;\n\n  traitWillInsertTrait?(member: Trait, target: Trait | null, trait: T): void;\n\n  traitDidInsertTrait?(member: Trait, target: Trait | null, trait: T): void;\n\n  traitWillRemoveTrait?(member: Trait, trait: T): void;\n\n  traitDidRemoveTrait?(member: Trait, trait: T): void;\n\n  traitWillMount?(trait: T): void;\n\n  traitDidMount?(trait: T): void;\n\n  traitWillUnmount?(trait: T): void;\n\n  traitDidUnmount?(trait: T): void;\n\n  traitWillMutate?(trait: T): void;\n\n  traitDidMutate?(trait: T): void;\n\n  traitWillAggregate?(trait: T): void;\n\n  traitDidAggregate?(trait: T): void;\n\n  traitWillCorrelate?(trait: T): void;\n\n  traitDidCorrelate?(trait: T): void;\n\n  traitWillValidate?(trait: T): void;\n\n  traitDidValidate?(trait: T): void;\n\n  traitWillReconcile?(trait: T): void;\n\n  traitDidReconcile?(trait: T): void;\n\n  traitWillStartConsuming?(trait: T): void;\n\n  traitDidStartConsuming?(trait: T): void;\n\n  traitWillStopConsuming?(trait: T): void;\n\n  traitDidStopConsuming?(trait: T): void;\n}\n\n/** @public */\nexport abstract class Trait implements HashCode, Observable, Consumable, FastenerContext, WarpRef {\n  constructor() {\n    this.uid = (this.constructor as typeof Trait).uid();\n    this.key = void 0;\n    this.flags = 0;\n    this.model = null;\n    this.nextTrait = null;\n    this.previousTrait = null;\n    this.coherentTime = 0;\n    this.decoherent = null;\n    this.recohering = null;\n    this.observers = null;\n    this.consumers = null;\n  }\n\n  declare readonly observerType?: Class<TraitObserver>;\n\n  likeType?(like: {create?(): Trait}): void;\n\n  /** @internal */\n  readonly uid: string;\n\n  readonly key: string | undefined;\n\n  /** @internal */\n  setKey(key: string | undefined): void {\n    (this as Mutable<this>).key = key;\n  }\n\n  /** @internal */\n  readonly flags: TraitFlags;\n\n  setFlags(flags: TraitFlags): void {\n    (this as Mutable<this>).flags = flags;\n  }\n\n  readonly model: Model | null;\n\n  getModel(): Model {\n    const model = this.model;\n    if (model === null) {\n      throw new TypeError(\"no model\");\n    }\n    return model;\n  }\n\n  /** @internal */\n  attachModel(model: Model, nextTrait: Trait | null): void {\n    // assert(this.model === null);\n    this.willAttachModel(model);\n    (this as Mutable<this>).model = model;\n    let previousTrait: Trait | null;\n    if (nextTrait !== null) {\n      previousTrait = nextTrait.previousTrait;\n      this.setNextTrait(nextTrait);\n      nextTrait.setPreviousTrait(this);\n    } else {\n      previousTrait = model.lastTrait;\n      model.setLastTrait(this);\n    }\n    if (previousTrait !== null) {\n      previousTrait.setNextTrait(this);\n      this.setPreviousTrait(previousTrait);\n    } else {\n      model.setFirstTrait(this);\n    }\n    if (model.mounted) {\n      this.mountTrait();\n    }\n    this.onAttachModel(model);\n    this.didAttachModel(model);\n  }\n\n  protected willAttachModel(model: Model): void {\n    this.callObservers(\"traitWillAttachModel\", model, this);\n  }\n\n  protected onAttachModel(model: Model): void {\n    this.bindModelFasteners(model);\n  }\n\n  protected didAttachModel(model: Model): void {\n    this.callObservers(\"traitDidAttachModel\", model, this);\n  }\n\n  /** @internal */\n  detachModel(model: Model): void {\n    // assert(this.model === model);\n    this.willDetachModel(model);\n    if (this.mounted) {\n      this.unmountTrait();\n    }\n    this.onDetachModel(model);\n    const nextTrait = this.nextTrait;\n    const previousTrait = this.previousTrait;\n    if (nextTrait !== null) {\n      this.setNextTrait(null);\n      nextTrait.setPreviousTrait(previousTrait);\n    } else {\n      model.setLastTrait(previousTrait);\n    }\n    if (previousTrait !== null) {\n      previousTrait.setNextTrait(nextTrait);\n      this.setPreviousTrait(null);\n    } else {\n      model.setFirstTrait(nextTrait);\n    }\n    (this as Mutable<this>).model = null;\n    this.didDetachModel(model);\n  }\n\n  protected willDetachModel(model: Model): void {\n    this.callObservers(\"traitWillDetachModel\", model, this);\n  }\n\n  protected onDetachModel(model: Model): void {\n    this.unbindModelFasteners(model);\n  }\n\n  protected didDetachModel(model: Model): void {\n    this.callObservers(\"traitDidDetachModel\", model, this);\n  }\n\n  get modelFlags(): ModelFlags {\n    const model = this.model;\n    return model !== null ? model.flags : 0;\n  }\n\n  setModelFlags(modelFlags: ModelFlags): void {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    model.setFlags(modelFlags);\n  }\n\n  remove(): void {\n    const model = this.model;\n    if (model !== null) {\n      model.removeTrait(this);\n    }\n  }\n\n  get parent(): Model | null {\n    const model = this.model;\n    return model !== null ? model.parent : null;\n  }\n\n  /** @protected */\n  willAttachParent(parent: Model): void {\n    this.callObservers(\"traitWillAttachParent\", parent, this);\n  }\n\n  /** @protected */\n  onAttachParent(parent: Model): void {\n    // hook\n  }\n\n  /** @protected */\n  didAttachParent(parent: Model): void {\n    this.callObservers(\"traitDidAttachParent\", parent, this);\n  }\n\n  /** @protected */\n  willDetachParent(parent: Model): void {\n    this.callObservers(\"traitWillDetachParent\", parent, this);\n  }\n\n  /** @protected */\n  onDetachParent(parent: Model): void {\n    // hook\n  }\n\n  /** @protected */\n  didDetachParent(parent: Model): void {\n    this.callObservers(\"traitDidDetachParent\", parent, this);\n  }\n\n  get nextSibling(): Model | null {\n    const model = this.model;\n    return model !== null ? model.nextSibling : null;\n  }\n\n  get previousSibling(): Model | null {\n    const model = this.model;\n    return model !== null ? model.previousSibling : null;\n  }\n\n  get firstChild(): Model | null {\n    const model = this.model;\n    return model !== null ? model.firstChild : null;\n  }\n\n  get lastChild(): Model | null {\n    const model = this.model;\n    return model !== null ? model.lastChild : null;\n  }\n\n  forEachChild<T>(callback: (child: Model) => T | void): T | undefined;\n  forEachChild<T, S>(callback: (this: S, child: Model) => T | void, thisArg: S): T | undefined;\n  forEachChild<T, S>(callback: (this: S | undefined, child: Model) => T | void, thisArg?: S): T | undefined {\n    const model = this.model;\n    return model !== null ? model.forEachChild(callback, thisArg) : void 0;\n  }\n\n  getChild<F extends Class<Model>>(key: string, childType: F): InstanceType<F> | null;\n  getChild(key: string, childType?: Class<Model>): Model | null;\n  getChild(key: string, childType?: Class<Model>): Model | null {\n    const model = this.model;\n    return model !== null ? model.getChild(key, childType) : null;\n  }\n\n  setChild<F extends Class<Instance<F, Model>> & Creatable<Instance<F, Model>>>(key: string, newChildFactory: F): Model | null;\n  setChild(key: string, newChild: Model | LikeType<Model> | null): Model | null;\n  setChild(key: string, newChild: Model | LikeType<Model> | null): Model | null {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.setChild(key, newChild);\n  }\n\n  appendChild<F extends Class<Instance<F, Model>> & Creatable<Instance<F, Model>>>(childFactory: F, key?: string): InstanceType<F>;\n  appendChild<M extends Model>(child: M | LikeType<M>, key?: string): M;\n  appendChild(child: Model | LikeType<Model>, key?: string): Model;\n  appendChild(child: Model | LikeType<Model>, key?: string): Model {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.appendChild(child, key);\n  }\n\n  prependChild<F extends Class<Instance<F, Model>> & Creatable<Instance<F, Model>>>(childFactory: F, key?: string): InstanceType<F>;\n  prependChild<M extends Model>(child: M | LikeType<M>, key?: string): M;\n  prependChild(child: Model | LikeType<Model>, key?: string): Model;\n  prependChild(child: Model | LikeType<Model>, key?: string): Model {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.prependChild(child, key);\n  }\n\n  insertChild<F extends Class<Instance<F, Model>> & Creatable<Instance<F, Model>>>(childFactory: F, target: Model | null, key?: string): InstanceType<F>;\n  insertChild<M extends Model>(child: M | LikeType<M>, target: Model | null, key?: string): M;\n  insertChild(child: Model | LikeType<Model>, target: Model | null, key?: string): Model;\n  insertChild(child: Model | LikeType<Model>, target: Model | null, key?: string): Model {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.insertChild(child, target, key);\n  }\n\n  reinsertChild(child: Model, target: Model | null): void {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    model.reinsertChild(child, target);\n  }\n\n  replaceChild<M extends Model>(newChild: Model, oldChild: M): M;\n  replaceChild<M extends Model>(newChild: Model | LikeType<Model>, oldChild: M): M;\n  replaceChild(newChild: Model | LikeType<Model>, oldChild: Model): Model;\n  replaceChild(newChild: Model | LikeType<Model>, oldChild: Model): Model {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.replaceChild(newChild, oldChild);\n  }\n\n  get insertChildFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).InsertChildFlags;\n  }\n\n  /** @protected */\n  willInsertChild(child: Model, target: Model | null): void {\n    this.callObservers(\"traitWillInsertChild\", child, target, this);\n  }\n\n  /** @protected */\n  onInsertChild(child: Model, target: Model | null): void {\n    this.requireUpdate(this.insertChildFlags);\n    this.bindChildFasteners(child, target);\n  }\n\n  /** @protected */\n  didInsertChild(child: Model, target: Model | null): void {\n    this.callObservers(\"traitDidInsertChild\", child, target, this);\n  }\n\n  removeChild<M extends Model>(child: M): M | null;\n  removeChild(key: string | Model): Model | null;\n  removeChild(key: string | Model): Model | null {\n    const model = this.model;\n    return model !== null ? model.removeChild(key) : null;\n  }\n\n  get removeChildFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).RemoveChildFlags;\n  }\n\n  /** @protected */\n  willRemoveChild(child: Model): void {\n    this.callObservers(\"traitWillRemoveChild\", child, this);\n    this.requireUpdate(this.removeChildFlags);\n  }\n\n  /** @protected */\n  onRemoveChild(child: Model): void {\n    this.unbindChildFasteners(child);\n  }\n\n  /** @protected */\n  didRemoveChild(child: Model): void {\n    this.callObservers(\"traitDidRemoveChild\", child, this);\n  }\n\n  get reinsertChildFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).ReinsertChildFlags;\n  }\n\n  /** @protected */\n  willReinsertChild(child: Model, target: Model | null): void {\n    this.callObservers(\"traitWillReinsertChild\", child, target, this);\n  }\n\n  /** @protected */\n  onReinsertChild(child: Model, target: Model | null): void {\n    this.requireUpdate(this.reinsertChildFlags);\n  }\n\n  /** @protected */\n  didReinsertChild(child: Model, target: Model | null): void {\n    this.callObservers(\"traitDidReinsertChild\", child, target, this);\n  }\n\n  removeChildren(): void {\n    const model = this.model;\n    if (model !== null) {\n      return model.removeChildren();\n    }\n  }\n\n  sortChildren(comparator: Comparator<Model>): void {\n    const model = this.model;\n    if (model !== null) {\n      return model.sortChildren(comparator);\n    }\n  }\n\n  getTargetChild(child: Model, comparator: Comparator<Model>): Model | null {\n    const model = this.model;\n    return model !== null ? model.getTargetChild(child, comparator) : null;\n  }\n\n  getAncestor<F extends Class<Model>>(ancestorType: F): InstanceType<F> | null {\n    const model = this.model;\n    return model !== null ? model.getAncestor(ancestorType) : null;\n  }\n\n  getRoot<F extends Class<Model>>(rootType: F): InstanceType<F> | null {\n    const model = this.model;\n    return model !== null ? model.getRoot(rootType) : null;\n  }\n\n  readonly nextTrait: Trait | null;\n\n  /** @internal */\n  setNextTrait(nextTrait: Trait | null): void {\n    (this as Mutable<this>).nextTrait = nextTrait;\n  }\n\n  readonly previousTrait: Trait | null;\n\n  /** @internal */\n  setPreviousTrait(previousTrait: Trait | null): void {\n    (this as Mutable<this>).previousTrait = previousTrait;\n  }\n\n  get firstTrait(): Trait | null {\n    const model = this.model;\n    return model !== null ? model.firstTrait : null;\n  }\n\n  get lastTrait(): Trait | null {\n    const model = this.model;\n    return model !== null ? model.lastTrait : null;\n  }\n\n  forEachTrait<T>(callback: (trait: Trait) => T | void): T | undefined;\n  forEachTrait<T, S>(callback: (this: S, trait: Trait) => T | void, thisArg: S): T | undefined;\n  forEachTrait<T, S>(callback: (this: S | undefined, trait: Trait) => T | void, thisArg?: S): T | undefined {\n    const model = this.model;\n    return model !== null ? model.forEachTrait(callback, thisArg) : void 0;\n  }\n\n  findTrait<F extends Class<Trait>>(key: string | undefined, traitClass: F | null | undefined): InstanceType<F> | null;\n  findTrait(key: string | undefined, traitClass: Class<Trait> | null | undefined): Trait | null;\n  findTrait(key: string | undefined, traitClass: Class<Trait> | null | undefined): Trait | null {\n    const model = this.model;\n    return model !== null ? model.findTrait(key, traitClass) : null;\n  }\n\n  getTrait<F extends Class<Trait>>(key: string, traitClass: F): InstanceType<F> | null;\n  getTrait(key: string, traitClass?: Class<Trait>): Trait | null;\n  getTrait<F extends Class<Trait>>(traitClass: F): InstanceType<F> | null;\n  getTrait(key: string | Class<Trait>, traitClass?: Class<Trait>): Trait | null {\n    const model = this.model;\n    return model !== null ? model.getTrait(key as string, traitClass) : null;\n  }\n\n  setTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(key: string, newChildFactory: F): Trait | null;\n  setTrait(key: string, newTrait: Trait | LikeType<Trait> | null): Trait | null;\n  setTrait(key: string, newTrait: Trait | LikeType<Trait> | null): Trait | null {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.setTrait(key, newTrait);\n  }\n\n  appendTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(childFactory: F, key?: string): InstanceType<F>;\n  appendTrait<T extends Trait>(trait: T | LikeType<T>, key?: string): T;\n  appendTrait(trait: Trait | LikeType<Trait>, key?: string): Trait;\n  appendTrait(trait: Trait | LikeType<Trait>, key?: string): Trait {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.appendTrait(trait, key);\n  }\n\n  prependTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(childFactory: F, key?: string): InstanceType<F>;\n  prependTrait<T extends Trait>(trait: T | LikeType<T>, key?: string): T;\n  prependTrait(trait: Trait | LikeType<Trait>, key?: string): Trait;\n  prependTrait(trait: Trait | LikeType<Trait>, key?: string): Trait {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.prependTrait(trait, key);\n  }\n\n  insertTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(childFactory: F, target: Trait | null, key?: string): InstanceType<F>;\n  insertTrait<T extends Trait>(trait: T | LikeType<T>, target: Trait | null, key?: string): T;\n  insertTrait(trait: Trait | LikeType<Trait>, target: Trait | null, key?: string): Trait;\n  insertTrait(trait: Trait | LikeType<Trait>, target: Trait | null, key?: string): Trait {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.insertTrait(trait, target, key);\n  }\n\n  replaceTrait<F extends Class<Instance<F, Trait>> & Creatable<Instance<F, Trait>>>(newChildFactory: F, oldTrait: Trait): Trait;\n  replaceTrait<T extends Trait>(newTrait: Trait | LikeType<Trait>, oldTrait: T): T;\n  replaceTrait(newTrait: Trait | LikeType<Trait>, oldTrait: Trait): Trait;\n  replaceTrait(newTrait: Trait | LikeType<Trait>, oldTrait: Trait): Trait {\n    const model = this.model;\n    if (model === null) {\n      throw new Error(\"no model\");\n    }\n    return model.replaceTrait(newTrait, oldTrait);\n  }\n\n  get insertTraitFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).InsertTraitFlags;\n  }\n\n  get inserting(): boolean {\n    return (this.flags & Trait.InsertingFlag) !== 0;\n  }\n\n  /** @protected */\n  willInsertTrait(trait: Trait, target: Trait | null): void {\n    this.callObservers(\"traitWillInsertTrait\", trait, target, this);\n  }\n\n  /** @protected */\n  onInsertTrait(trait: Trait, target: Trait | null): void {\n    this.requireUpdate(this.insertTraitFlags);\n    this.bindTraitFasteners(trait, target);\n  }\n\n  /** @protected */\n  didInsertTrait(trait: Trait, target: Trait | null): void {\n    this.callObservers(\"traitDidInsertTrait\", trait, target, this);\n  }\n\n  removeTrait<T extends Trait>(trait: T): T | null;\n  removeTrait(key: string | Trait): Trait | null;\n  removeTrait(key: string | Trait): Trait | null {\n    const model = this.model;\n    return model !== null ? model.removeTrait(key) : null;\n  }\n\n  get removeTraitFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).RemoveTraitFlags;\n  }\n\n  get removing(): boolean {\n    return (this.flags & Trait.RemovingFlag) !== 0;\n  }\n\n  /** @protected */\n  willRemoveTrait(trait: Trait): void {\n    this.callObservers(\"traitWillRemoveTrait\", trait, this);\n  }\n\n  /** @protected */\n  onRemoveTrait(trait: Trait): void {\n    this.requireUpdate(this.removeTraitFlags);\n    this.unbindTraitFasteners(trait);\n  }\n\n  /** @protected */\n  didRemoveTrait(trait: Trait): void {\n    this.callObservers(\"traitDidRemoveTrait\", trait, this);\n  }\n\n  sortTraits(comparator: Comparator<Trait>): void {\n    const model = this.model;\n    if (model !== null) {\n      model.sortTraits(comparator);\n    }\n  }\n\n  getAncestorTrait<F extends Class<Trait>>(ancestorType: F): InstanceType<F> | null {\n    const model = this.model;\n    return model !== null ? model.getAncestorTrait(ancestorType) : null;\n  }\n\n  getRootTrait<F extends Class<Trait>>(rootType: F): InstanceType<F> | null {\n    const model = this.model;\n    return model !== null ? model.getRootTrait(rootType) : null;\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get parentType(): typeof Trait {\n      return Trait;\n    },\n    updateFlags: Model.NeedsReconcile,\n  })\n  get hostUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get parentType(): typeof Trait {\n      return Trait;\n    },\n    updateFlags: Model.NeedsReconcile,\n  })\n  get nodeUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get parentType(): typeof Trait {\n      return Trait;\n    },\n    updateFlags: Model.NeedsReconcile,\n  })\n  get laneUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  downlink(template?: FastenerTemplate<EventDownlink<WarpRef>>): EventDownlink<WarpRef> {\n    let downlinkClass = EventDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlink\", template) as typeof EventDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkValue<V = Value>(template?: FastenerTemplate<ValueDownlink<WarpRef, V>>): ValueDownlink<WarpRef, V> {\n    let downlinkClass = ValueDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkValue\", template) as typeof ValueDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkList<V = Value>(template?: FastenerTemplate<ListDownlink<WarpRef, V>>): ListDownlink<WarpRef, V> {\n    let downlinkClass = ListDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkList\", template) as typeof ListDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkMap<K = Value, V = Value>(template?: FastenerTemplate<MapDownlink<WarpRef, K, V>>): MapDownlink<WarpRef, K, V> {\n    let downlinkClass = MapDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkMap\", template) as typeof MapDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  command(hostUri: UriLike, nodeUri: UriLike, laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(nodeUri: UriLike, laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(body: ValueLike): void;\n  command(hostUri: UriLike | ValueLike, nodeUri?: UriLike | ValueLike, laneUri?: UriLike | ValueLike, body?: ValueLike): void {\n    if (nodeUri === void 0) {\n      body = Value.fromLike(hostUri as ValueLike);\n      laneUri = this.laneUri.getValue();\n      nodeUri = this.nodeUri.getValue();\n      hostUri = this.hostUri.value;\n    } else if (laneUri === void 0) {\n      body = Value.fromLike(nodeUri as ValueLike);\n      laneUri = Uri.fromLike(hostUri as UriLike);\n      nodeUri = this.nodeUri.getValue();\n      hostUri = this.hostUri.value;\n    } else if (body === void 0) {\n      body = Value.fromLike(laneUri as ValueLike);\n      laneUri = Uri.fromLike(nodeUri as UriLike);\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = this.hostUri.value;\n    } else {\n      body = Value.fromLike(body);\n      laneUri = Uri.fromLike(laneUri as UriLike);\n      nodeUri = Uri.fromLike(nodeUri as UriLike);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    if (hostUri === null) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    const warpRef = this.warpRef.value;\n    warpRef.command(hostUri, nodeUri, laneUri, body);\n  }\n\n  /** @override */\n  authenticate(hostUri: UriLike, credentials: ValueLike): void;\n  /** @override */\n  authenticate(credentials: ValueLike): void;\n  authenticate(hostUri: UriLike | ValueLike, credentials?: ValueLike): void {\n    if (credentials === void 0) {\n      credentials = Value.fromLike(hostUri as ValueLike);\n      hostUri = this.hostUri.getValue();\n    } else {\n      credentials = Value.fromLike(credentials);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const warpRef = this.warpRef.value;\n    warpRef.authenticate(hostUri, credentials);\n  }\n\n  /** @override */\n  hostRef(hostUri: UriLike): WarpRef {\n    hostUri = Uri.fromLike(hostUri);\n    const childRef = new Model();\n    childRef.hostUri.set(hostUri);\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @override */\n  nodeRef(hostUri: UriLike, nodeUri: UriLike): WarpRef;\n  /** @override */\n  nodeRef(nodeUri: UriLike): WarpRef;\n  nodeRef(hostUri: UriLike | undefined, nodeUri?: UriLike): WarpRef {\n    if (nodeUri === void 0) {\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = nodeUri.endpoint();\n      if (hostUri.isDefined()) {\n        nodeUri = hostUri.unresolve(nodeUri);\n      } else {\n        hostUri = void 0;\n      }\n    } else {\n      nodeUri = Uri.fromLike(nodeUri);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const childRef = new Model();\n    if (hostUri !== void 0) {\n      childRef.hostUri.set(hostUri);\n    }\n    if (nodeUri !== void 0) {\n      childRef.nodeUri.set(nodeUri);\n    }\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @override */\n  laneRef(hostUri: UriLike, nodeUri: UriLike, laneUri: UriLike): WarpRef;\n  /** @override */\n  laneRef(nodeUri: UriLike, laneUri: UriLike): WarpRef;\n  /** @override */\n  laneRef(laneUri: UriLike): WarpRef;\n  laneRef(hostUri: UriLike | undefined, nodeUri?: UriLike, laneUri?: UriLike): WarpRef {\n    if (nodeUri === void 0) {\n      laneUri = Uri.fromLike(hostUri as UriLike);\n      nodeUri = void 0;\n      hostUri = void 0;\n    } else if (laneUri === void 0) {\n      laneUri = Uri.fromLike(nodeUri);\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = nodeUri.endpoint();\n      if (hostUri.isDefined()) {\n        nodeUri = hostUri.unresolve(nodeUri);\n      } else {\n        hostUri = void 0;\n      }\n    } else {\n      laneUri = Uri.fromLike(laneUri);\n      nodeUri = Uri.fromLike(nodeUri);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const childRef = new Model();\n    if (hostUri !== void 0) {\n      childRef.hostUri.set(hostUri);\n    }\n    if (nodeUri !== void 0) {\n      childRef.nodeUri.set(nodeUri);\n    }\n    if (laneUri !== void 0) {\n      childRef.laneUri.set(laneUri);\n    }\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @internal @override */\n  getDownlink(hostUri: Uri, nodeUri: Uri, laneUri: Uri): WarpDownlinkModel | null {\n    const warpRef = this.warpRef.value;\n    return warpRef.getDownlink(hostUri, nodeUri, laneUri);\n  }\n\n  /** @internal @override */\n  openDownlink(downlink: WarpDownlinkModel): void {\n    const warpRef = this.warpRef.value;\n    warpRef.openDownlink(downlink);\n  }\n\n  @Property({\n    valueType: WarpRef,\n    inherits: true,\n    updateFlags: Model.NeedsReconcile,\n    initValue(): WarpRef {\n      return WarpClient.global();\n    },\n    equalValues(newValue: WarpRef, oldValue: WarpRef): boolean {\n      return newValue === oldValue;\n    },\n  })\n  get warpRef(): Property<this, WarpRef> {\n    return Property.getter();\n  }\n\n  get mounted(): boolean {\n    return (this.flags & Trait.MountedFlag) !== 0;\n  }\n\n  get mountFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).MountFlags;\n  }\n\n  /** @internal */\n  mountTrait(): void {\n    if ((this.flags & Trait.MountedFlag) !== 0) {\n      throw new Error(\"already mounted\");\n    }\n    this.setFlags(this.flags | Trait.MountedFlag);\n    this.willMount();\n    this.onMount();\n    this.didMount();\n  }\n\n  protected willMount(): void {\n    this.callObservers(\"traitWillMount\", this);\n  }\n\n  protected onMount(): void {\n    // hook\n  }\n\n  protected didMount(): void {\n    this.requireUpdate(this.mountFlags);\n\n    if (this.decoherent !== null && this.decoherent.length !== 0) {\n      this.requireUpdate(Model.NeedsMutate);\n    }\n\n    this.mountFasteners();\n\n    if (this.consumers !== null && this.consumers.size !== 0) {\n      this.startConsuming();\n    }\n\n    this.callObservers(\"traitDidMount\", this);\n  }\n\n  /** @internal */\n  unmountTrait(): void {\n    if ((this.flags & Trait.MountedFlag) === 0) {\n      throw new Error(\"already unmounted\");\n    }\n    this.setFlags(this.flags & ~Trait.MountedFlag);\n    this.willUnmount();\n    this.onUnmount();\n    this.didUnmount();\n  }\n\n  protected willUnmount(): void {\n    this.callObservers(\"traitWillUnmount\", this);\n\n    this.stopConsuming();\n    this.unmountFasteners();\n  }\n\n  protected onUnmount(): void {\n    // hook\n  }\n\n  protected didUnmount(): void {\n    this.callObservers(\"traitDidUnmount\", this);\n  }\n\n  requireUpdate(updateFlags: ModelFlags, immediate: boolean = false): void {\n    const model = this.model;\n    if (model !== null) {\n      model.requireUpdate(updateFlags, immediate);\n    }\n  }\n\n  /** @protected */\n  needsUpdate(updateFlags: ModelFlags, immediate: boolean): ModelFlags {\n    return updateFlags;\n  }\n\n  requestUpdate(target: Model, updateFlags: ModelFlags, immediate: boolean): void {\n    const model = this.model;\n    if (model === null) {\n      throw new TypeError(\"no model\");\n    }\n    model.requestUpdate(target, updateFlags, immediate);\n  }\n\n  get updating(): boolean {\n    const model = this.model;\n    return model !== null && model.updating;\n  }\n\n  get analyzing(): boolean {\n    const model = this.model;\n    return model !== null && model.analyzing;\n  }\n\n  /** @protected */\n  needsAnalyze(analyzeFlags: ModelFlags): ModelFlags {\n    return analyzeFlags;\n  }\n\n  /** @protected */\n  willAnalyze(analyzeFlags: ModelFlags): void {\n    // hook\n  }\n\n  /** @protected */\n  onAnalyze(analyzeFlags: ModelFlags): void {\n    // hook\n  }\n\n  /** @protected */\n  didAnalyze(analyzeFlags: ModelFlags): void {\n    // hook\n  }\n\n  /** @protected */\n  willMutate(): void {\n    this.callObservers(\"traitWillMutate\", this);\n  }\n\n  /** @protected */\n  onMutate(): void {\n    this.recohereFasteners(this.updateTime);\n  }\n\n  /** @protected */\n  didMutate(): void {\n    this.callObservers(\"traitDidMutate\", this);\n  }\n\n  /** @protected */\n  willAggregate(): void {\n    this.callObservers(\"traitWillAggregate\", this);\n  }\n\n  /** @protected */\n  onAggregate(): void {\n    // hook\n  }\n\n  /** @protected */\n  didAggregate(): void {\n    this.callObservers(\"traitDidAggregate\", this);\n  }\n\n  /** @protected */\n  willCorrelate(): void {\n    this.callObservers(\"traitWillCorrelate\", this);\n  }\n\n  /** @protected */\n  onCorrelate(): void {\n    // hook\n  }\n\n  /** @protected */\n  didCorrelate(): void {\n    this.callObservers(\"traitDidCorrelate\", this);\n  }\n\n  /** @protected */\n  analyzeChildren(analyzeFlags: ModelFlags, analyzeChild: (this: Model, child: Model, analyzeFlags: ModelFlags) => void,\n                  analyzeChildren: (this: Model, analyzeFlags: ModelFlags, analyzeChild: (this: Model, child: Model, analyzeFlags: ModelFlags) => void) => void): void {\n    analyzeChildren.call(this.model!, analyzeFlags, analyzeChild);\n  }\n\n  get refreshing(): boolean {\n    const model = this.model;\n    return model !== null && model.refreshing;\n  }\n\n  /** @protected */\n  needsRefresh(refreshFlags: ModelFlags): ModelFlags {\n    return refreshFlags;\n  }\n\n  /** @protected */\n  willRefresh(refreshFlags: ModelFlags): void {\n    // hook\n  }\n\n  /** @protected */\n  onRefresh(refreshFlags: ModelFlags): void {\n    // hook\n  }\n\n  /** @protected */\n  didRefresh(refreshFlags: ModelFlags): void {\n    // hook\n  }\n\n  /** @protected */\n  willValidate(): void {\n    this.callObservers(\"traitWillValidate\", this);\n  }\n\n  /** @protected */\n  onValidate(): void {\n    // hook\n  }\n\n  /** @protected */\n  didValidate(): void {\n    this.callObservers(\"traitDidValidate\", this);\n  }\n\n  /** @protected */\n  willReconcile(): void {\n    this.callObservers(\"traitWillReconcile\", this);\n  }\n\n  /** @protected */\n  onReconcile(): void {\n    this.recohereDownlinks(this.updateTime);\n  }\n\n  /** @protected */\n  didReconcile(): void {\n    this.callObservers(\"traitDidReconcile\", this);\n  }\n\n  /** @protected */\n  refreshChildren(refreshFlags: ModelFlags, refreshChild: (this: Model, child: Model, refreshFlags: ModelFlags) => void,\n                  refreshChildren: (this: Model, refreshFlags: ModelFlags, refreshChild: (this: Model, child: Model, refreshFlags: ModelFlags) => void) => void): void {\n    refreshChildren.call(this.model!, refreshFlags, refreshChild);\n  }\n\n  tryFastener<K extends keyof this, F extends this[K] = this[K]>(fastenerName: K): (F extends Fastener<any, any, any> ? F | null : never) | null {\n    const metaclass = FastenerContext.getMetaclass(this);\n    return metaclass !== null ? metaclass.tryFastener(this, fastenerName) : null;\n  }\n\n  getFastener<F extends Fastener>(fastenerName: PropertyKey, fastenerType?: Proto<F>, contextType?: Proto<any> | null): F | null {\n    if (contextType !== void 0 && contextType !== null && !(this instanceof contextType)) {\n      return null;\n    }\n    const fastener = (this as any)[fastenerName] as F | null | undefined;\n    if (fastener === void 0 || (fastenerType !== void 0 && fastenerType !== null && !(fastener instanceof fastenerType))) {\n      return null;\n    }\n    return fastener;\n  }\n\n  /** @override */\n  getParentFastener<F extends Fastener>(fastenerName: string, fastenerType?: Proto<F>, contextType?: Proto<any> | null): F | null {\n    let parent = this.model;\n    if (parent === null) {\n      return null;\n    }\n\n    let fastener: F | null;\n    if (contextType !== void 0 && contextType !== null && (contextType === Trait || contextType.prototype instanceof Trait)) {\n      // Traverse traits attached to ancestor models,\n      // starting with the parent of the model to which this trait is attached.\n      parent = parent.parent;\n      while (parent !== null) {\n        fastener = parent.getTraitFastener(fastenerName, fastenerType, contextType);\n        if (fastener !== null) {\n          return fastener;\n        }\n        parent = parent.parent;\n      }\n      return null;\n    }\n\n    // Traverse ancestor models, starting with the model to which this trait is attached.\n    do {\n      fastener = parent.getFastener(fastenerName, fastenerType, contextType);\n      if (fastener !== null) {\n        return fastener;\n      }\n      parent = parent.parent;\n    } while (parent !== null);\n    return null;\n  }\n\n  /** @override */\n  attachFastener(fastener: Fastener): void {\n    if (this.mounted) {\n      fastener.mount();\n    }\n    this.bindFastener(fastener);\n  }\n\n  /** @internal */\n  protected mountFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        fastener.mount();\n      }\n    }\n  }\n\n  /** @internal */\n  protected unmountFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        fastener.unmount();\n      }\n    }\n  }\n\n  protected bindFastener(fastener: Fastener): void {\n    if ((fastener instanceof ModelRelation || fastener instanceof TraitRelation) && fastener.binds) {\n      this.forEachChild(function (child: Model): void {\n        fastener.bindModel(child, null);\n      }, this);\n    }\n    if (fastener instanceof TraitRelation && fastener.binds) {\n      this.forEachTrait(function (trait: Trait): void {\n        fastener.bindTrait(trait, null);\n      }, this);\n    }\n    if (this.consuming) {\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected bindModelFasteners(model: Model): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    model.forEachChild(function (child: Model): void {\n      for (let i = 0; i < fastenerSlots.length; i += 1) {\n        const fastener = this[fastenerSlots[i]!];\n        if (fastener instanceof Fastener) {\n          this.bindChildFastener(fastener, child, null);\n        }\n      }\n    }, this);\n    model.forEachTrait(function (trait: Trait): void {\n      for (let i = 0; i < fastenerSlots.length; i += 1) {\n        const fastener = this[fastenerSlots[i]!];\n        if (fastener instanceof Fastener) {\n          this.bindTraitFastener(fastener, trait, null);\n        }\n      }\n    }, this);\n  }\n\n  /** @internal */\n  protected unbindModelFasteners(model: Model): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    model.forEachTrait(function (trait: Trait): void {\n      for (let i = 0; i < fastenerSlots.length; i += 1) {\n        const fastener = this[fastenerSlots[i]!];\n        if (fastener instanceof Fastener) {\n          this.unbindTraitFastener(fastener, trait);\n        }\n      }\n    }, this);\n    model.forEachChild(function (child: Model): void {\n      for (let i = 0; i < fastenerSlots.length; i += 1) {\n        const fastener = this[fastenerSlots[i]!];\n        if (fastener instanceof Fastener) {\n          this.unbindChildFastener(fastener, child);\n        }\n      }\n    }, this);\n  }\n\n  /** @internal */\n  protected bindChildFasteners(child: Model, target: Model | null): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        this.bindChildFastener(fastener, child, target);\n      }\n    }\n  }\n\n  /** @internal */\n  protected bindChildFastener(fastener: Fastener, child: Model, target: Model | null): void {\n    if (fastener instanceof ModelRelation || fastener instanceof TraitRelation) {\n      fastener.bindModel(child, target);\n    }\n  }\n\n  /** @internal */\n  protected unbindChildFasteners(child: Model): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        this.unbindChildFastener(fastener, child);\n      }\n    }\n  }\n\n  /** @internal */\n  protected unbindChildFastener(fastener: Fastener, child: Model): void {\n    if (fastener instanceof ModelRelation || fastener instanceof TraitRelation) {\n      fastener.unbindModel(child);\n    }\n  }\n\n  /** @internal */\n  protected bindTraitFasteners(trait: Trait, target: Trait | null): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        this.bindTraitFastener(fastener, trait, target);\n      }\n    }\n  }\n\n  /** @internal */\n  protected bindTraitFastener(fastener: Fastener, trait: Trait, target: Trait | null): void {\n    if (fastener instanceof TraitRelation) {\n      fastener.bindTrait(trait, target);\n    }\n  }\n\n  /** @internal */\n  protected unbindTraitFasteners(trait: Trait): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof Fastener) {\n        this.unbindTraitFastener(fastener, trait);\n      }\n    }\n  }\n\n  /** @internal */\n  protected unbindTraitFastener(fastener: Fastener, trait: Trait): void {\n    if (fastener instanceof TraitRelation) {\n      fastener.unbindTrait(trait);\n    }\n  }\n\n  set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): this;\n  set(properties: {[K in keyof this as this[K] extends {set(value: any): any} ? K : never]?: this[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): this {\n    for (const key in properties) {\n      const value = properties[key];\n      const property = (this as any)[key] as {set?(value: any): any} | undefined;\n      if (property === void 0 || property === null) {\n        throw new Error(\"unknown property \" + key);\n      } else if (property.set === void 0) {\n        throw new Error(\"unsettable property \" + key);\n      } else if (property instanceof Animator) {\n        property.set(value, timing);\n      } else {\n        property.set(value);\n      }\n    }\n    return this;\n  }\n\n  setIntrinsic<S>(this: S, properties: {[K in keyof S as S[K] extends {setIntrinsic(value: any): any} ? K : never]?: S[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): this;\n  setIntrinsic(properties: {[K in keyof this as this[K] extends {setIntrinsic(value: any): any} ? K : never]?: this[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): this {\n    for (const key in properties) {\n      const value = properties[key];\n      const property = (this as any)[key] as {setIntrinsic?(value: any): any} | undefined;\n      if (property === void 0 || property === null) {\n        throw new Error(\"unknown property \" + key);\n      } else if (property.setIntrinsic === void 0) {\n        throw new Error(\"unsettable property \" + key);\n      } else if (property instanceof Animator) {\n        property.setIntrinsic(value, timing);\n      } else {\n        property.setIntrinsic(value);\n      }\n    }\n    return this;\n  }\n\n  /** @internal */\n  readonly coherentTime: number;\n\n  /** @internal */\n  readonly decoherent: readonly Fastener[] | null;\n\n  /** @internal */\n  readonly recohering: readonly Fastener[] | null;\n\n  /** @override */\n  decohereFastener(fastener: Fastener): void {\n    const recohering = this.recohering as Fastener[] | null;\n    if (recohering !== null && fastener.coherentTime !== this.coherentTime) {\n      recohering.push(fastener);\n      return;\n    }\n    this.enqueueFastener(fastener);\n  }\n\n  protected enqueueFastener(fastener: Fastener): void {\n    let decoherent = this.decoherent as Fastener[] | null;\n    if (decoherent === null) {\n      decoherent = [];\n      (this as Mutable<this>).decoherent = decoherent;\n    }\n    decoherent.push(fastener);\n    if (fastener instanceof WarpDownlink) {\n      this.requireUpdate(Model.NeedsReconcile);\n    } else {\n      this.requireUpdate(Model.NeedsMutate);\n    }\n  }\n\n  /** @internal */\n  recohereFasteners(t?: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent === null || decoherent.length === 0) {\n      return;\n    } else if (t === void 0) {\n      t = performance.now();\n    }\n    (this as Mutable<this>).coherentTime = t;\n    (this as Mutable<this>).decoherent = null;\n    (this as Mutable<this>).recohering = decoherent;\n    try {\n      for (let i = 0; i < decoherent.length; i += 1) {\n        const fastener = decoherent[i]!;\n        if (!(fastener instanceof WarpDownlink)) {\n          fastener.recohere(t);\n        } else {\n          this.enqueueFastener(fastener);\n        }\n      }\n    } finally {\n      (this as Mutable<this>).recohering = null;\n    }\n  }\n\n  /** @internal */\n  recohereDownlinks(t: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent === null || decoherent.length === 0) {\n      return;\n    }\n    let coherentDownlinkProps = false;\n    (this as Mutable<this>).coherentTime = t;\n    (this as Mutable<this>).decoherent = null;\n    (this as Mutable<this>).recohering = decoherent;\n    try {\n      for (let i = 0; i < decoherent.length; i += 1) {\n        const fastener = decoherent[i]!;\n        if (fastener instanceof WarpDownlink) {\n          if (!coherentDownlinkProps) {\n            coherentDownlinkProps = true;\n            this.hostUri.recohere(t);\n            this.nodeUri.recohere(t);\n            this.laneUri.recohere(t);\n          }\n          fastener.recohere(t);\n        } else {\n          this.enqueueFastener(fastener);\n        }\n      }\n    } finally {\n      (this as Mutable<this>).recohering = null;\n    }\n  }\n\n  /** @internal */\n  readonly observers: ReadonlySet<Observes<this>> | null;\n\n  /** @override */\n  observe(observer: Observes<this>): void {\n    let observers = this.observers as Set<Observes<this>> | null;\n    if (observers === null) {\n      observers = new Set<Observes<this>>();\n      (this as Mutable<this>).observers = observers;\n    } else if (observers.has(observer)) {\n      return;\n    }\n    this.willObserve(observer);\n    observers.add(observer);\n    this.onObserve(observer);\n    this.didObserve(observer);\n  }\n\n  protected willObserve(observer: Observes<this>): void {\n    // hook\n  }\n\n  protected onObserve(observer: Observes<this>): void {\n    // hook\n  }\n\n  protected didObserve(observer: Observes<this>): void {\n    // hook\n  }\n\n  /** @override */\n  unobserve(observer: Observes<this>): void {\n    const observers = this.observers as Set<Observes<this>> | null;\n    if (observers === null || !observers.has(observer)) {\n      return;\n    }\n    this.willUnobserve(observer);\n    observers.delete(observer);\n    this.onUnobserve(observer);\n    this.didUnobserve(observer);\n  }\n\n  protected willUnobserve(observer: Observes<this>): void {\n    // hook\n  }\n\n  protected onUnobserve(observer: Observes<this>): void {\n    // hook\n  }\n\n  protected didUnobserve(observer: Observes<this>): void {\n    // hook\n  }\n\n  callObservers<O, K extends keyof ObserverMethods<O>>(this: {readonly observerType?: Class<O>}, key: K, ...args: ObserverParameters<O, K>): void {\n    const observers = (this as Trait).observers as ReadonlySet<ObserverMethods<O>> | null;\n    if (observers === null) {\n      return;\n    }\n    for (const observer of observers) {\n      const method = observer[key];\n      if (typeof method === \"function\") {\n        method.call(observer, ...args);\n      }\n    }\n  }\n\n  /** @internal */\n  readonly consumers: ReadonlySet<Consumer> | null;\n\n  /** @override */\n  consume(consumer: Consumer): void {\n    let consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null) {\n      consumers = new Set<Consumer>();\n      (this as Mutable<this>).consumers = consumers;\n    } else if (consumers.has(consumer)) {\n      return;\n    }\n    this.willConsume(consumer);\n    consumers.add(consumer);\n    this.onConsume(consumer);\n    this.didConsume(consumer);\n    if (consumers.size === 1 && this.mounted) {\n      this.startConsuming();\n    }\n  }\n\n  protected willConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected onConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected didConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  /** @override */\n  unconsume(consumer: Consumer): void {\n    const consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null || !consumers.has(consumer)) {\n      return;\n    }\n    this.willUnconsume(consumer);\n    consumers.delete(consumer);\n    this.onUnconsume(consumer);\n    this.didUnconsume(consumer);\n    if (consumers.size === 0) {\n      this.stopConsuming();\n    }\n  }\n\n  protected willUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected onUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected didUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  get consuming(): boolean {\n    return (this.flags & Trait.ConsumingFlag) !== 0;\n  }\n\n  get startConsumingFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).StartConsumingFlags;\n  }\n\n  protected startConsuming(): void {\n    if ((this.flags & Trait.ConsumingFlag) !== 0) {\n      return;\n    }\n    this.willStartConsuming();\n    this.setFlags(this.flags | Trait.ConsumingFlag);\n    this.onStartConsuming();\n    this.didStartConsuming();\n  }\n\n  protected willStartConsuming(): void {\n    this.callObservers(\"traitWillStartConsuming\", this);\n  }\n\n  protected onStartConsuming(): void {\n    this.requireUpdate(this.startConsumingFlags);\n    this.startConsumingFasteners();\n  }\n\n  protected didStartConsuming(): void {\n    this.callObservers(\"traitDidStartConsuming\", this);\n  }\n\n  get stopConsumingFlags(): ModelFlags {\n    return (this.constructor as typeof Trait).StopConsumingFlags;\n  }\n\n  protected stopConsuming(): void {\n    if ((this.flags & Trait.ConsumingFlag) === 0) {\n      return;\n    }\n    this.willStopConsuming();\n    this.setFlags(this.flags & ~Trait.ConsumingFlag);\n    this.onStopConsuming();\n    this.didStopConsuming();\n  }\n\n  protected willStopConsuming(): void {\n    this.callObservers(\"traitWillStopConsuming\", this);\n  }\n\n  protected onStopConsuming(): void {\n    this.requireUpdate(this.stopConsumingFlags);\n    this.stopConsumingFasteners();\n  }\n\n  protected didStopConsuming(): void {\n    this.callObservers(\"traitDidStopConsuming\", this);\n  }\n\n  /** @internal */\n  protected startConsumingFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected stopConsumingFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.unconsume(this);\n      }\n    }\n  }\n\n  get updateTime(): number {\n    return this.getModel().updateTime;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    return this === that;\n  }\n\n  /** @override */\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mixString(0, this.uid));\n  }\n\n  static create<S extends new () => InstanceType<S>>(this: S): InstanceType<S> {\n    return new this();\n  }\n\n  static fromLike<S extends Class<Instance<S, Trait>>>(this: S, value: InstanceType<S> | LikeType<InstanceType<S>>): InstanceType<S> {\n    if (value === void 0 || value === null) {\n      return value as InstanceType<S>;\n    } else if (value instanceof Trait) {\n      if (!((value as Trait) instanceof this)) {\n        throw new TypeError(value + \" not an instance of \" + this);\n      }\n      return value as InstanceType<S>;\n    } else if (Creatable[Symbol.hasInstance](value)) {\n      return (value as Creatable<InstanceType<S>>).create();\n    }\n    throw new TypeError(\"\" + this);\n  }\n\n  /** @internal */\n  static uid: () => string = (function () {\n    let nextId = 1;\n    return function uid(): string {\n      const id = ~~nextId;\n      nextId += 1;\n      return \"trait\" + id;\n    };\n  })();\n\n  /** @internal */\n  declare static readonly fieldInitializers?: {[name: PropertyKey]: Function[]};\n  /** @internal */\n  declare static readonly instanceInitializers?: Function[];\n\n  /** @internal */\n  static initDecorators(): void {\n    // Ensure each trait class has its own metadata and decorator initializer fields.\n    if (!Object.hasOwnProperty.call(this, Symbol.metadata)) {\n      const superMetadata: Record<PropertyKey, unknown> & object /*DecoratorMetadataObject*/ | undefined = Object.getPrototypeOf(this)[Symbol.metadata];\n      Object.defineProperty(this, Symbol.metadata, {\n        value: Object.create(superMetadata !== void 0 ? superMetadata : null),\n        writable: true,\n        enumerable: true,\n        configurable: true,\n      });\n    }\n    if (!Object.hasOwnProperty.call(this, \"fieldInitializers\")) {\n      Object.defineProperty(this, \"fieldInitializers\", {\n        value: {},\n        enumerable: true,\n        configurable: true,\n      });\n    }\n    if (!Object.hasOwnProperty.call(this, \"instanceInitializers\")) {\n      Object.defineProperty(this, \"instanceInitializers\", {\n        value: [],\n        enumerable: true,\n        configurable: true,\n      });\n    }\n  }\n\n  /** @internal */\n  static defineField<S extends Class<Instance<S, Trait>>, T extends InstanceType<S>, K extends keyof T>(this: S, name: K, decorators: T[K] extends Fastener<any, any, any> ? FastenerDecorator<T[K]>[] : never): void {\n    const traitClass = this as unknown as typeof Trait;\n    traitClass.initDecorators();\n    __esDecorate(null, null, decorators as Function[], {\n      kind: \"field\",\n      name,\n      static: false,\n      private: false,\n      access: {\n        has(obj: T): boolean {\n          return name in obj;\n        },\n        get(obj: T): T[K] {\n          return obj[name];\n        },\n        set(obj: T, value: T[K]): void {\n          obj[name] = value;\n        },\n      },\n      metadata: traitClass[Symbol.metadata],\n    }, traitClass.fieldInitializers![name] = [], traitClass.instanceInitializers!);\n  }\n\n  /** @internal */\n  static defineGetter<S extends Class<Instance<S, Trait>>, T extends InstanceType<S>, K extends keyof T>(this: S, name: K, decorators: T[K] extends Fastener<any, any, any> ? FastenerDecorator<T[K]>[] : never): void {\n    const traitClass = this as unknown as typeof Trait;\n    traitClass.initDecorators();\n    Object.defineProperty(traitClass.prototype, name, {\n      get: Fastener.getter,\n      enumerable: true,\n      configurable: true,\n    });\n    __esDecorate(traitClass, null, decorators as Function[], {\n      kind: \"getter\",\n      name,\n      static: false,\n      private: false,\n      access: {\n        has(obj: T): boolean {\n          return name in obj;\n        },\n        get(obj: T): T[K] {\n          return obj[name];\n        },\n        set(obj: T, value: T[K]): void {\n          obj[name] = value;\n        },\n      },\n      metadata: traitClass[Symbol.metadata],\n    }, null, traitClass.instanceInitializers!);\n  }\n\n  /** @internal */\n  static initFasteners<S extends Class<Instance<S, Trait>>>(this: S, fastener: InstanceType<S>): void {\n    const traitClass = this as unknown as typeof Trait;\n    if (!Object.hasOwnProperty.call(traitClass, \"fieldInitializers\")\n        || !Object.hasOwnProperty.call(traitClass, \"instanceInitializers\")) {\n      return;\n    }\n    __runInitializers(fastener, traitClass.instanceInitializers!);\n    for (const key in traitClass.fieldInitializers!) {\n      (fastener as any)[key] = __runInitializers(fastener, traitClass.fieldInitializers[key]!, void 0);\n    }\n  }\n\n  /** @internal */\n  static readonly MountedFlag: TraitFlags = 1 << 0;\n  /** @internal */\n  static readonly InsertingFlag: TraitFlags = 1 << 1;\n  /** @internal */\n  static readonly RemovingFlag: TraitFlags = 1 << 2;\n  /** @internal */\n  static readonly ConsumingFlag: TraitFlags = 1 << 3;\n\n  /** @internal */\n  static readonly FlagShift: number = 4;\n  /** @internal */\n  static readonly FlagMask: ModelFlags = (1 << this.FlagShift) - 1;\n\n  static readonly MountFlags: ModelFlags = 0;\n  static readonly InsertChildFlags: ModelFlags = 0;\n  static readonly RemoveChildFlags: ModelFlags = 0;\n  static readonly ReinsertChildFlags: ModelFlags = 0;\n  static readonly InsertTraitFlags: ModelFlags = 0;\n  static readonly RemoveTraitFlags: ModelFlags = 0;\n  static readonly StartConsumingFlags: TraitFlags = 0;\n  static readonly StopConsumingFlags: TraitFlags = 0;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Consumable} from \"@swim/util\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {Model} from \"./Model\";\nimport type {TraitFactory} from \"./Trait\";\nimport {Trait} from \"./Trait\";\n\n/** @public */\nexport interface TraitRelationDescriptor<R, T extends Trait> extends FastenerDescriptor<R> {\n  extends?: Proto<TraitRelation<any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface TraitRelationClass<F extends TraitRelation<any, any, any> = TraitRelation<any, any, any>> extends FastenerClass<F> {\n  /** @internal */\n  readonly ConsumingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface TraitRelation<R = any, T extends Trait = Trait, I extends any[] = [T | null]> extends Fastener<R, T | null, I>, Consumable {\n  /** @override */\n  get descriptorType(): Proto<TraitRelationDescriptor<R, T>>;\n\n  /** @override */\n  get fastenerType(): Proto<TraitRelation<any, any, any>>;\n\n  get consumed(): boolean;\n\n  get traitType(): TraitFactory<T> | null;\n\n  get observes(): boolean;\n\n  /** @override */\n  get parent(): TraitRelation<any, T, any> | null;\n\n  /** @internal */\n  readonly outlets: ReadonlySet<Fastener<any, any, any>> | null;\n\n  /** @internal @override */\n  attachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @override */\n  detachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @protected */\n  decohereOutlets(): void;\n\n  /** @protected */\n  initTrait(trait: T): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, target: Trait | null): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, target: Trait | null): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, target: Trait | null): void;\n\n  /** @protected */\n  deinitTrait(trait: T): void;\n\n  /** @protected */\n  willDetachTrait(trait: T): void;\n\n  /** @protected */\n  onDetachTrait(trait: T): void;\n\n  /** @protected */\n  didDetachTrait(trait: T): void;\n\n  get parentModel(): Model | null;\n\n  /** @protected */\n  insertChild(model: Model, trait: T, target: Trait | null, key: string | undefined): void;\n\n  /** @internal */\n  bindModel(model: Model, targetModel: Model | null): void;\n\n  /** @internal */\n  unbindModel(model: Model): void;\n\n  detectModel(model: Model): T | null;\n\n  /** @internal */\n  bindTrait(trait: Trait, target: Trait | null): void;\n\n  /** @internal */\n  unbindTrait(trait: Trait): void;\n\n  detectTrait(trait: Trait): T | null;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromLike(value: T | LikeType<T>): T;\n\n  /** @internal */\n  readonly consumers: ReadonlySet<Consumer> | null;\n\n  /** @override */\n  consume(consumer: Consumer): void\n\n  /** @protected */\n  willConsume(consumer: Consumer): void;\n\n  /** @protected */\n  onConsume(consumer: Consumer): void;\n\n  /** @protected */\n  didConsume(consumer: Consumer): void;\n\n  /** @override */\n  unconsume(consumer: Consumer): void\n\n  /** @protected */\n  willUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  onUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  didUnconsume(consumer: Consumer): void;\n\n  get consuming(): boolean;\n\n  /** @internal */\n  startConsuming(): void;\n\n  /** @protected */\n  willStartConsuming(): void;\n\n  /** @protected */\n  onStartConsuming(): void;\n\n  /** @protected */\n  didStartConsuming(): void;\n\n  /** @internal */\n  stopConsuming(): void;\n\n  /** @protected */\n  willStopConsuming(): void;\n\n  /** @protected */\n  onStopConsuming(): void;\n\n  /** @protected */\n  didStopConsuming(): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n}\n\n/** @public */\nexport const TraitRelation = (<R, T extends Trait, I extends any[], F extends TraitRelation<any, any, any>>() => Fastener.extend<TraitRelation<R, T, I>, TraitRelationClass<F>>(\"TraitRelation\", {\n  get fastenerType(): Proto<TraitRelation<any, any, any>> {\n    return TraitRelation;\n  },\n\n  consumed: false,\n\n  traitType: null,\n\n  observes: false,\n\n  attachOutlet(outlet: Fastener<any, any, any>): void {\n    let outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      outlets = new Set<Fastener<any, any, any>>();\n      (this as Mutable<typeof this>).outlets = outlets;\n    }\n    outlets.add(outlet);\n  },\n\n  detachOutlet(outlet: Fastener<any, any, any>): void {\n    const outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      return;\n    }\n    outlets.delete(outlet);\n  },\n\n  decohereOutlets(): void {\n    const outlets = this.outlets;\n    if (outlets !== null) {\n      for (const outlet of outlets) {\n        outlet.decohere(this);\n      }\n    }\n  },\n\n  initTrait(trait: T): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, target: Trait | null): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, target: Trait | null): void {\n    if (this.observes) {\n      trait.observe(this as Observes<T>);\n    }\n    if ((this.flags & TraitRelation.ConsumingFlag) !== 0) {\n      trait.consume(this);\n    }\n  },\n\n  didAttachTrait(trait: T, target: Trait | null): void {\n    // hook\n  },\n\n  deinitTrait(trait: T): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T): void {\n    if ((this.flags & TraitRelation.ConsumingFlag) !== 0) {\n      trait.unconsume(this);\n    }\n    if (this.observes) {\n      trait.unobserve(this as Observes<T>);\n    }\n  },\n\n  didDetachTrait(trait: T): void {\n    // hook\n  },\n\n  get parentModel(): Model | null {\n    const owner = this.owner;\n    if (owner instanceof Model) {\n      return owner;\n    } else if (owner instanceof Trait) {\n      return owner.model;\n    }\n    return null;\n  },\n\n  insertChild(model: Model, trait: T, target: Trait | null, key: string | undefined): void {\n    model.insertTrait(trait, target, key);\n  },\n\n  bindModel(model: Model, targetModel: Model | null): void {\n    // hook\n  },\n\n  unbindModel(model: Model): void {\n    // hook\n  },\n\n  detectModel(model: Model): T | null {\n    return null;\n  },\n\n  bindTrait(trait: Trait, target: Trait | null): void {\n    // hook\n  },\n\n  unbindTrait(trait: Trait): void {\n    // hook\n  },\n\n  detectTrait(trait: Trait): T | null {\n    return null;\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  consume(consumer: Consumer): void {\n    let consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null) {\n      consumers = new Set<Consumer>();\n      (this as Mutable<typeof this>).consumers = consumers;\n    } else if (consumers.has(consumer)) {\n      return;\n    }\n    this.willConsume(consumer);\n    consumers.add(consumer);\n    this.onConsume(consumer);\n    this.didConsume(consumer);\n    if (consumers.size === 1 && this.mounted) {\n      this.startConsuming();\n    }\n  },\n\n  willConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  unconsume(consumer: Consumer): void {\n    const consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null || !consumers.has(consumer)) {\n      return;\n    }\n    this.willUnconsume(consumer);\n    consumers.delete(consumer);\n    this.onUnconsume(consumer);\n    this.didUnconsume(consumer);\n    if (consumers.size === 0) {\n      this.stopConsuming();\n    }\n  },\n\n  willUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  get consuming(): boolean {\n    return (this.flags & TraitRelation.ConsumingFlag) !== 0;\n  },\n\n  startConsuming(): void {\n    if ((this.flags & TraitRelation.ConsumingFlag) !== 0) {\n      return;\n    }\n    this.willStartConsuming();\n    this.setFlags(this.flags | TraitRelation.ConsumingFlag);\n    this.onStartConsuming();\n    this.didStartConsuming();\n  },\n\n  willStartConsuming(): void {\n    // hook\n  },\n\n  onStartConsuming(): void {\n    // hook\n  },\n\n  didStartConsuming(): void {\n    // hook\n  },\n\n  stopConsuming(): void {\n    if ((this.flags & TraitRelation.ConsumingFlag) === 0) {\n      return;\n    }\n    this.willStopConsuming();\n    this.setFlags(this.flags & ~TraitRelation.ConsumingFlag);\n    this.onStopConsuming();\n    this.didStopConsuming();\n  },\n\n  willStopConsuming(): void {\n    // hook\n  },\n\n  onStopConsuming(): void {\n    // hook\n  },\n\n  didStopConsuming(): void {\n    // hook\n  },\n\n  onMount(): void {\n    super.onMount();\n    if (this.consumers !== null && this.consumers.size !== 0) {\n      this.startConsuming();\n    }\n  },\n\n  onUnmount(): void {\n    super.onUnmount();\n    this.stopConsuming();\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).outlets = null;\n    (fastener as Mutable<typeof fastener>).consumers = null;\n    return fastener;\n  },\n\n  ConsumingFlag: 1 << (Fastener.FlagShift + 0),\n\n  FlagShift: Fastener.FlagShift + 1,\n  FlagMask: (1 << (Fastener.FlagShift + 1)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {Model} from \"./Model\";\nimport type {Trait} from \"./Trait\";\nimport type {TraitRelationDescriptor} from \"./TraitRelation\";\nimport type {TraitRelationClass} from \"./TraitRelation\";\nimport {TraitRelation} from \"./TraitRelation\";\n\n/** @public */\nexport interface TraitRefDescriptor<R, T extends Trait> extends TraitRelationDescriptor<R, T> {\n  extends?: Proto<TraitRef<any, any, any>> | boolean | null;\n  traitKey?: string | boolean;\n}\n\n/** @public */\nexport interface TraitRefClass<F extends TraitRef<any, any, any> = TraitRef<any, any, any>> extends TraitRelationClass<F> {\n  tryTrait<R, K extends keyof R, F extends R[K] = R[K]>(owner: R, fastenerName: K): (F extends {readonly trait: infer T | null} ? T | null : never) | null;\n}\n\n/** @public */\nexport interface TraitRef<R = any, T extends Trait = Trait, I extends any[] = [T | null]> extends TraitRelation<R, T, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitRefDescriptor<R, T>>;\n\n  /** @override */\n  get fastenerType(): Proto<TraitRef<any, any, any>>;\n\n  /** @override */\n  get parent(): TraitRef<any, T, any> | null;\n\n  get inletTrait(): T | null;\n\n  getInletTrait(): T;\n\n  get(): T | null;\n\n  set(trait: T | LikeType<T> | Fastener<any, I[0], any> | null): R;\n\n  setIntrinsic(trait: T | LikeType<T> | Fastener<any, I[0], any> | null): R;\n\n  get traitKey(): string | undefined;\n\n  readonly trait: T | null;\n\n  getTrait(): T;\n\n  setTrait(trait: T | LikeType<T> | null, target?: Trait | null, key?: string): T | null;\n\n  attachTrait(trait?: T | LikeType<T> | null, target?: Trait | null): T;\n\n  detachTrait(): T | null;\n\n  insertTrait(model?: Model | null, trait?: T | LikeType<T>, target?: Trait | null, key?: string): T;\n\n  removeTrait(): T | null;\n\n  deleteTrait(): T | null;\n\n  /** @internal @override */\n  bindModel(model: Model, target: Model | null): void;\n\n  /** @internal @override */\n  unbindModel(model: Model): void;\n\n  /** @override */\n  detectModel(model: Model): T | null;\n\n  /** @internal @override */\n  bindTrait(trait: Trait, target: Trait | null): void;\n\n  /** @internal @override */\n  unbindTrait(trait: Trait): void;\n\n  /** @override */\n  detectTrait(trait: Trait): T | null;\n\n  /** @protected @override */\n  onStartConsuming(): void;\n\n  /** @protected @override */\n  onStopConsuming(): void;\n\n  /** @override */\n  recohere(t: number): void;\n}\n\n/** @public */\nexport const TraitRef = (<R, T extends Trait, I extends any[], F extends TraitRef<any, any, any>>() => TraitRelation.extend<TraitRef<R, T, I>, TraitRefClass<F>>(\"TraitRef\", {\n  get fastenerType(): Proto<TraitRef<any, any, any>> {\n    return TraitRef;\n  },\n\n  get inletTrait(): T | null {\n    const inlet = this.inlet;\n    return inlet instanceof TraitRef ? inlet.trait : null;\n  },\n\n  getInletTrait(): T {\n    const inletTrait = this.inletTrait;\n    if (inletTrait === void 0 || inletTrait === null) {\n      let message = inletTrait + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"inlet trait\";\n      throw new TypeError(message);\n    }\n    return inletTrait;\n  },\n\n  get(): T | null {\n    return this.trait;\n  },\n\n  set(trait: T | LikeType<T> | Fastener<any, I[0], any> | null): R {\n    if (trait instanceof Fastener) {\n      this.bindInlet(trait);\n    } else {\n      this.setTrait(trait);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(trait: T | LikeType<T> | Fastener<any, I[0], any> | null): R {\n    if (trait instanceof Fastener) {\n      this.bindInlet(trait);\n    } else {\n      this.setTrait(trait);\n    }\n    return this.owner;\n  },\n\n  traitKey: void 0,\n\n  getTrait(): T {\n    const trait = this.trait;\n    if (trait === null) {\n      let message = trait + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new TypeError(message);\n    }\n    return trait;\n  },\n\n  setTrait(newTrait: T | LikeType<T> | null, target?: Trait | null, key?: string): T | null {\n    if (newTrait !== null) {\n      newTrait = this.fromLike(newTrait);\n    }\n    let oldTrait = this.trait;\n    if (oldTrait === newTrait) {\n      this.setCoherent(true);\n      return oldTrait;\n    } else if (target === void 0) {\n      target = null;\n    }\n    let model: Model | null;\n    if (this.binds && (model = this.parentModel, model !== null)) {\n      if (oldTrait !== null && oldTrait.model === model) {\n        if (target === null) {\n          target = oldTrait.nextTrait;\n        }\n        oldTrait.remove();\n      }\n      if (newTrait !== null) {\n        if (key === void 0) {\n          key = this.traitKey;\n        }\n        this.insertChild(model, newTrait, target, key);\n      }\n      oldTrait = this.trait;\n      if (oldTrait === newTrait) {\n        return oldTrait;\n      }\n    }\n    if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n    }\n    if (newTrait !== null) {\n      (this as Mutable<typeof this>).trait = newTrait;\n      this.willAttachTrait(newTrait, target);\n      this.onAttachTrait(newTrait, target);\n      this.initTrait(newTrait);\n      this.didAttachTrait(newTrait, target);\n    }\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldTrait;\n  },\n\n  attachTrait(newTrait?: T | LikeType<T> | null, target?: Trait | null): T {\n    const oldTrait = this.trait;\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromLike(newTrait);\n    } else if (oldTrait === null) {\n      newTrait = this.createTrait();\n    } else {\n      newTrait = oldTrait;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (oldTrait === newTrait) {\n      return newTrait;\n    } else if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newTrait;\n  },\n\n  detachTrait(): T | null {\n    const oldTrait = this.trait;\n    if (oldTrait === null) {\n      return null;\n    }\n    (this as Mutable<typeof this>).trait = null;\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldTrait;\n  },\n\n  insertTrait(model?: Model | null, newTrait?: T | LikeType<T>, target?: Trait | null, key?: string): T {\n    let oldTrait = this.trait;\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromLike(newTrait);\n    } else if (oldTrait === null) {\n      newTrait = this.createTrait();\n    } else {\n      newTrait = oldTrait;\n    }\n    if (model === void 0) {\n      model = null;\n    }\n    if (!this.binds && oldTrait === newTrait && newTrait.model !== null && model === null && key === void 0) {\n      return newTrait;\n    }\n    if (model === null) {\n      model = this.parentModel;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.traitKey;\n    }\n    if (model !== null && (newTrait.model !== model || newTrait.key !== key)) {\n      this.insertChild(model, newTrait, target, key);\n    }\n    oldTrait = this.trait;\n    if (oldTrait === newTrait) {\n      return newTrait;\n    } else if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n      if (this.binds && model !== null && oldTrait.model === model) {\n        oldTrait.remove();\n      }\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newTrait;\n  },\n\n  removeTrait(): T | null {\n    const trait = this.trait;\n    if (trait === null) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  deleteTrait(): T | null {\n    const trait = this.detachTrait();\n    if (trait === null) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  bindModel(model: Model, target: Model | null): void {\n    if (!this.binds || this.trait !== null) {\n      return;\n    }\n    const newTrait = this.detectModel(model);\n    if (newTrait === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, null);\n    this.onAttachTrait(newTrait, null);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, null);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindModel(model: Model): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldTrait = this.detectModel(model);\n    if (oldTrait === null || this.trait !== oldTrait) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = null;\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectModel(model: Model): T | null {\n    return null;\n  },\n\n  bindTrait(trait: Trait, target: Trait | null): void {\n    if (!this.binds || this.trait !== null) {\n      return;\n    }\n    const newTrait = this.detectTrait(trait);\n    if (newTrait === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindTrait(trait: Trait): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldTrait = this.detectTrait(trait);\n    if (oldTrait === null || this.trait !== oldTrait) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = null;\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectTrait(trait: Trait): T | null {\n    const key = this.traitKey;\n    if (key !== void 0 && key === trait.key) {\n      return trait as T;\n    }\n    return null;\n  },\n\n  onStartConsuming(): void {\n    const trait = this.trait;\n    if (trait !== null) {\n      trait.consume(this);\n    }\n  },\n\n  onStopConsuming(): void {\n    const trait = this.trait;\n    if (trait !== null) {\n      trait.unconsume(this);\n    }\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof TraitRef) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setTrait(inlet.trait);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n},\n{\n  tryTrait<R, K extends keyof R, F extends R[K]>(owner: R, fastenerName: K): (F extends {readonly trait: infer T | null} ? T | null : never) | null {\n    const metaclass = FastenerContext.getMetaclass(owner);\n    const traitRef = metaclass !== null ? metaclass.tryFastener(owner, fastenerName) : null;\n    return traitRef instanceof TraitRef ? traitRef.trait : null;\n  },\n\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).trait = null;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<TraitRef<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const traitKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"traitKey\");\n    if (traitKeyDescriptor !== void 0 && \"value\" in traitKeyDescriptor) {\n      if (traitKeyDescriptor.value === true) {\n        traitKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      } else if (traitKeyDescriptor.value === false) {\n        traitKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Comparator} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {Model} from \"./Model\";\nimport type {Trait} from \"./Trait\";\nimport type {TraitRelationDescriptor} from \"./TraitRelation\";\nimport type {TraitRelationClass} from \"./TraitRelation\";\nimport {TraitRelation} from \"./TraitRelation\";\n\n/** @public */\nexport interface TraitSetDescriptor<R, T extends Trait> extends TraitRelationDescriptor<R, T> {\n  extends?: Proto<TraitSet<any, any, any>> | boolean | null;\n  ordered?: boolean;\n  sorted?: boolean;\n}\n\n/** @public */\nexport interface TraitSetClass<F extends TraitSet<any, any, any> = TraitSet<any, any, any>> extends TraitRelationClass<F> {\n  /** @internal */\n  readonly OrderedFlag: FastenerFlags;\n  /** @internal */\n  readonly SortedFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface TraitSet<R = any, T extends Trait = Trait, I extends any[] = [T | null]> extends TraitRelation<R, T, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitSetDescriptor<R, T>>;\n\n  /** @override */\n  get fastenerType(): Proto<TraitSet<any, any, any>>;\n\n  /** @override */\n  get parent(): TraitSet<any, T, any> | null;\n\n  /** @internal */\n  readonly traits: {readonly [traitId: string]: T | undefined};\n\n  readonly traitCount: number;\n\n  /** @internal */\n  insertTraitMap(newTrait: T, target: Trait | null): void;\n\n  /** @internal */\n  removeTraitMap(oldTrait: T): void;\n\n  hasTrait(trait: Trait): boolean;\n\n  addTrait(trait?: T | LikeType<T>, target?: Trait | null, key?: string): T;\n\n  addTraits(traits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void;\n\n  setTraits(traits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void;\n\n  attachTrait(trait?: T | LikeType<T> | null, target?: Trait | null): T;\n\n  attachTraits(traits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void;\n\n  detachTrait(trait: T): T | null;\n\n  detachTraits(traits?: {readonly [traitId: string]: T | undefined}): void;\n\n  insertTrait(model?: Model | null, trait?: T | LikeType<T>, target?: Trait | null, key?: string): T;\n\n  insertTraits(model: Model | null, traits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void;\n\n  removeTrait(trait: T): T | null;\n\n  removeTraits(traits?: {readonly [traitId: string]: T | undefined}): void;\n\n  deleteTrait(trait: T): T | null;\n\n  deleteTraits(traits?: {readonly [traitId: string]: T | undefined}): void;\n\n  reinsertTrait(trait: T, target?: Trait | null): void;\n\n  /** @internal @override */\n  bindModel(model: Model, target: Model | null): void;\n\n  /** @internal @override */\n  unbindModel(model: Model): void;\n\n  /** @override */\n  detectModel(model: Model): T | null;\n\n  /** @internal @override */\n  bindTrait(trait: Trait, target: Trait | null): void;\n\n  /** @internal @override */\n  unbindTrait(trait: Trait): void;\n\n  /** @override */\n  detectTrait(trait: Trait): T | null;\n\n  consumeTraits(consumer: Consumer): void;\n\n  unconsumeTraits(consumer: Consumer): void;\n\n  /** @protected @override */\n  onStartConsuming(): void;\n\n  /** @protected @override */\n  onStopConsuming(): void;\n\n  /** @override */\n  recohere(t: number): void;\n\n  /** @protected */\n  traitKey(trait: T): string | undefined;\n\n  get ordered(): boolean;\n\n  order(ordered?: boolean): this;\n\n  get sorted(): boolean;\n\n  sort(sorted?: boolean): this;\n\n  /** @protected */\n  willSort(parent: Model | null): void;\n\n  /** @protected */\n  onSort(parent: Model | null): void;\n\n  /** @protected */\n  didSort(parent: Model | null): void;\n\n  /** @internal */\n  sortChildren(parent: Model, comparator?: Comparator<T>): void;\n\n  /** @internal */\n  getTargetChild(parent: Model, child: T): Trait | null;\n\n  /** @internal */\n  compareChildren(a: Model, b: Model): number;\n\n  /** @internal */\n  compareTargetChild(a: Model, b: Model): number;\n\n  /** @protected */\n  compare(a: T, b: T): number;\n}\n\n/** @public */\nexport const TraitSet = (<R, T extends Trait, I extends any[], F extends TraitSet<any, any, any>>() => TraitRelation.extend<TraitSet<R, T, I>, TraitSetClass<F>>(\"TraitSet\", {\n  get fastenerType(): Proto<TraitSet<any, any, any>> {\n    return TraitSet;\n  },\n\n  traitKey(trait: T): string | undefined {\n    return void 0;\n  },\n\n  insertTraitMap(newTrait: T, target: Trait | null): void {\n    const traits = this.traits as {[traitId: string]: T | undefined};\n    if (target !== null && (this.flags & TraitSet.OrderedFlag) !== 0) {\n      (this as Mutable<typeof this>).traits = Objects.inserted(traits, newTrait.uid, newTrait, target);\n    } else {\n      traits[newTrait.uid] = newTrait;\n    }\n  },\n\n  removeTraitMap(oldTrait: T): void {\n    const traits = this.traits as {[traitId: string]: T | undefined};\n    delete traits[oldTrait.uid];\n  },\n\n  hasTrait(trait: Trait): boolean {\n    return this.traits[trait.uid] !== void 0;\n  },\n\n  addTrait(newTrait?: T | LikeType<T>, target?: Trait | null, key?: string): T {\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromLike(newTrait);\n    } else {\n      newTrait = this.createTrait();\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    let model: Model | null;\n    if (this.binds && (model = this.parentModel, model !== null)) {\n      if (target === null) {\n        if (newTrait.model === model) {\n          target = newTrait.nextTrait;\n        } else {\n          target = this.getTargetChild(model, newTrait);\n        }\n      }\n      if (key === void 0) {\n        key = this.traitKey(newTrait);\n      }\n      if (newTrait.model !== model || newTrait.nextTrait !== target || newTrait.key !== key) {\n        this.insertChild(model, newTrait, target, key);\n      }\n    }\n    if (this.traits[newTrait.uid] !== void 0) {\n      return newTrait;\n    }\n    this.insertTraitMap(newTrait, target);\n    (this as Mutable<typeof this>).traitCount += 1;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newTrait;\n  },\n\n  addTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    for (const traitId in newTraits) {\n      this.addTrait(newTraits[traitId]!, target);\n    }\n  },\n\n  setTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    const binds = this.binds;\n    const model = binds ? this.parentModel : null;\n    const traits = this.traits;\n    for (const traitId in traits) {\n      if (newTraits[traitId] === void 0) {\n        const oldTrait = this.detachTrait(traits[traitId]!);\n        if (oldTrait !== null && binds && model !== null && oldTrait.model === model) {\n          oldTrait.remove();\n        }\n      }\n    }\n    if ((this.flags & TraitSet.OrderedFlag) !== 0) {\n      const orderedTraits = new Array<T>();\n      for (const traitId in newTraits) {\n        orderedTraits.push(newTraits[traitId]!);\n      }\n      for (let i = 0, n = orderedTraits.length; i < n; i += 1) {\n        const newTrait = orderedTraits[i]!;\n        if (traits[newTrait.uid] === void 0) {\n          const targetTrait = i < n + 1 ? orderedTraits[i + 1] : target;\n          this.addTrait(newTrait, targetTrait);\n        }\n      }\n    } else {\n      for (const traitId in newTraits) {\n        if (traits[traitId] === void 0) {\n          this.addTrait(newTraits[traitId]!, target);\n        }\n      }\n    }\n  },\n\n  attachTrait(newTrait?: T | LikeType<T> | null, target?: Trait | null): T {\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromLike(newTrait);\n    } else {\n      newTrait = this.createTrait();\n    }\n    if (this.traits[newTrait.uid] !== void 0) {\n      return newTrait;\n    } else if (target === void 0) {\n      target = null;\n    }\n    this.insertTraitMap(newTrait, target);\n    (this as Mutable<typeof this>).traitCount += 1;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newTrait;\n  },\n\n  attachTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    for (const traitId in newTraits) {\n      this.attachTrait(newTraits[traitId]!, target);\n    }\n  },\n\n  detachTrait(oldTrait: T): T | null {\n    if (this.traits[oldTrait.uid] === void 0) {\n      return null;\n    }\n    (this as Mutable<typeof this>).traitCount -= 1;\n    this.removeTraitMap(oldTrait);\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldTrait;\n  },\n\n  detachTraits(traits?: {readonly [traitId: string]: T | undefined}): void {\n    if (traits === void 0) {\n      traits = this.traits;\n    }\n    for (const traitId in traits) {\n      this.detachTrait(traits[traitId]!);\n    }\n  },\n\n  insertTrait(model?: Model | null, newTrait?: T | LikeType<T>, target?: Trait | null, key?: string): T {\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromLike(newTrait);\n    } else {\n      newTrait = this.createTrait();\n    }\n    if (model === void 0) {\n      model = null;\n    }\n    if (!this.binds && this.traits[newTrait.uid] !== void 0 && newTrait.model !== null && model === null && key === void 0) {\n      return newTrait;\n    }\n    if (model === null) {\n      model = this.parentModel;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.traitKey(newTrait);\n    }\n    if (model !== null && (newTrait.model !== model || newTrait.key !== key)) {\n      if (target === null) {\n        target = this.getTargetChild(model, newTrait);\n      }\n      this.insertChild(model, newTrait, target, key);\n    }\n    if (this.traits[newTrait.uid] !== void 0) {\n      return newTrait;\n    }\n    this.insertTraitMap(newTrait, target);\n    (this as Mutable<typeof this>).traitCount += 1;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newTrait;\n  },\n\n  insertTraits(model: Model | null, newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    for (const traitId in newTraits) {\n      this.insertTrait(model, newTraits[traitId]!, target);\n    }\n  },\n\n  removeTrait(trait: T): T | null {\n    if (!this.hasTrait(trait)) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  removeTraits(traits?: {readonly [traitId: string]: T | undefined}): void {\n    if (traits === void 0) {\n      traits = this.traits;\n    }\n    for (const traitId in traits) {\n      this.removeTrait(traits[traitId]!);\n    }\n  },\n\n  deleteTrait(trait: T): T | null {\n    const oldTrait = this.detachTrait(trait);\n    if (oldTrait === null) {\n      return null;\n    }\n    oldTrait.remove();\n    return oldTrait;\n  },\n\n  deleteTraits(traits?: {readonly [traitId: string]: T | undefined}): void {\n    if (traits === void 0) {\n      traits = this.traits;\n    }\n    for (const traitId in traits) {\n      this.deleteTrait(traits[traitId]!);\n    }\n  },\n\n  reinsertTrait(trait: T, target?: Trait | null): void {\n    if (this.traits[trait.uid] === void 0 || (target === void 0 && (this.flags & TraitSet.SortedFlag) === 0)) {\n      return;\n    }\n    const model = trait.model;\n    if (model === null) {\n      return;\n    }\n    const parent = trait.parent;\n    if (parent === null) {\n      return;\n    } else if (target === void 0) {\n      target = this.getTargetChild(parent, trait);\n    }\n    parent.reinsertChild(model, target !== null ? target.model : null);\n  },\n\n  bindModel(model: Model, target: Model | null): void {\n    if (!this.binds) {\n      return;\n    }\n    const newTrait = this.detectModel(model);\n    if (newTrait === null || this.traits[newTrait.uid] !== void 0) {\n      return;\n    }\n    this.insertTraitMap(newTrait, null);\n    (this as Mutable<typeof this>).traitCount += 1;\n    this.willAttachTrait(newTrait, null);\n    this.onAttachTrait(newTrait, null);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, null);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindModel(model: Model): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldTrait = this.detectModel(model);\n    if (oldTrait === null || this.traits[oldTrait.uid] === void 0) {\n      return;\n    }\n    (this as Mutable<typeof this>).traitCount -= 1;\n    this.removeTraitMap(oldTrait);\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectModel(model: Model): T | null {\n    return null;\n  },\n\n  bindTrait(trait: Trait, target: Trait | null): void {\n    if (!this.binds) {\n      return;\n    }\n    const newTrait = this.detectTrait(trait);\n    if (newTrait === null || this.traits[newTrait.uid] !== void 0) {\n      return;\n    }\n    this.insertTraitMap(newTrait, target);\n    (this as Mutable<typeof this>).traitCount += 1;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindTrait(trait: Trait): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldTrait = this.detectTrait(trait);\n    if (oldTrait === null || this.traits[oldTrait.uid] === void 0) {\n      return;\n    }\n    (this as Mutable<typeof this>).traitCount -= 1;\n    this.removeTraitMap(oldTrait);\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectTrait(trait: Trait): T | null {\n    if (typeof this.traitType === \"function\" && trait instanceof this.traitType) {\n      return trait as T;\n    }\n    return null;\n  },\n\n  consumeTraits(consumer: Consumer): void {\n    const traits = this.traits;\n    for (const traitId in traits) {\n      const trait = traits[traitId]!;\n      trait.consume(consumer);\n    }\n  },\n\n  unconsumeTraits(consumer: Consumer): void {\n    const traits = this.traits;\n    for (const traitId in traits) {\n      const trait = traits[traitId]!;\n      trait.unconsume(consumer);\n    }\n  },\n\n  onStartConsuming(): void {\n    this.consumeTraits(this);\n  },\n\n  onStopConsuming(): void {\n    this.unconsumeTraits(this);\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof TraitSet) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setTraits(inlet.traits);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n\n  get ordered(): boolean {\n    return (this.flags & TraitSet.OrderedFlag) !== 0;\n  },\n\n  order(ordered?: boolean): typeof this {\n    if (ordered === void 0) {\n      ordered = true;\n    }\n    if (ordered) {\n      this.setFlags(this.flags | TraitSet.OrderedFlag);\n    } else {\n      this.setFlags(this.flags & ~TraitSet.OrderedFlag);\n    }\n    return this;\n  },\n\n  get sorted(): boolean {\n    return (this.flags & TraitSet.SortedFlag) !== 0;\n  },\n\n  sort(sorted?: boolean): typeof this {\n    if (sorted === void 0) {\n      sorted = true;\n    }\n    if (sorted) {\n      const parent = this.parentModel;\n      this.willSort(parent);\n      this.setFlags(this.flags | TraitSet.SortedFlag);\n      this.onSort(parent);\n      this.didSort(parent);\n    } else {\n      this.setFlags(this.flags & ~TraitSet.SortedFlag);\n    }\n    return this;\n  },\n\n  willSort(parent: Model | null): void {\n    // hook\n  },\n\n  onSort(parent: Model | null): void {\n    if (parent !== null) {\n      this.sortChildren(parent);\n    }\n  },\n\n  didSort(parent: Model | null): void {\n    // hook\n  },\n\n  sortChildren(parent: Model, comparator?: Comparator<T>): void {\n    parent.sortChildren(this.compareChildren.bind(this));\n  },\n\n  getTargetChild(parent: Model, child: T): Trait | null {\n    if ((this.flags & TraitSet.SortedFlag) !== 0 && child.model !== null) {\n      const targetModel = parent.getTargetChild(child.model, this.compareTargetChild.bind(this));\n      if (targetModel !== null) {\n        return this.detectModel(targetModel);\n      }\n    }\n    return null;\n  },\n\n  compareChildren(a: Model, b: Model): number {\n    const traits = this.traits;\n    const p = this.detectModel(a);\n    const q = this.detectModel(b);\n    const x = p !== null ? traits[p.uid] : void 0;\n    const y = q !== null ? traits[q.uid] : void 0;\n    if (x !== void 0 && y !== void 0) {\n      return this.compare(x, y);\n    }\n    return x !== void 0 ? 1 : y !== void 0 ? -1 : 0;\n  },\n\n  compareTargetChild(a: Model, b: Model): number {\n    const traits = this.traits;\n    const p = this.detectModel(a);\n    const q = this.detectModel(b);\n    const x = p !== null ? p : void 0;\n    const y = q !== null ? traits[q.uid] : void 0;\n    if (x !== void 0 && y !== void 0) {\n      return this.compare(x, y);\n    }\n    return x !== void 0 ? 1 : y !== void 0 ? -1 : 0;\n  },\n\n  compare(a: T, b: T): number {\n    return a.uid < b.uid ? -1 : a.uid > b.uid ? 1 : 0;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).traits = {};\n    (fastener as Mutable<typeof fastener>).traitCount = 0;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<TraitSet<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    let flagsInit = fastenerPrototype.flagsInit;\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"ordered\")) {\n      if (fastenerPrototype.ordered) {\n        flagsInit |= TraitSet.OrderedFlag;\n      } else {\n        flagsInit &= ~TraitSet.OrderedFlag;\n      }\n      delete (fastenerPrototype as TraitSetDescriptor<any, any>).ordered;\n    }\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"sorted\")) {\n      if (fastenerPrototype.sorted) {\n        flagsInit |= TraitSet.SortedFlag;\n      } else {\n        flagsInit &= ~TraitSet.SortedFlag;\n      }\n      delete (fastenerPrototype as TraitSetDescriptor<any, any>).sorted;\n    }\n    Object.defineProperty(fastenerPrototype, \"flagsInit\", {\n      value: flagsInit,\n      enumerable: true,\n      configurable: true,\n    });\n  },\n\n  OrderedFlag: 1 << (TraitRelation.FlagShift + 0),\n  SortedFlag: 1 << (TraitRelation.FlagShift + 1),\n\n  FlagShift: TraitRelation.FlagShift + 2,\n  FlagMask: (1 << (TraitRelation.FlagShift + 2)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport {Fastener} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Model} from \"./Model\";\nimport type {ModelRefDescriptor} from \"./ModelRef\";\nimport type {ModelRefClass} from \"./ModelRef\";\nimport {ModelRef} from \"./ModelRef\";\nimport type {TraitFactory} from \"./Trait\";\nimport {Trait} from \"./Trait\";\n\n/** @public */\nexport interface TraitModelRefDescriptor<R, T extends Trait, M extends Model> extends ModelRefDescriptor<R, M> {\n  extends?: Proto<TraitModelRef<any, any, any, any>> | boolean | null;\n  traitKey?: string | boolean;\n}\n\n/** @public */\nexport interface TraitModelRefClass<F extends TraitModelRef<any, any, any, any> = TraitModelRef<any, any, any, any>> extends ModelRefClass<F> {\n}\n\n/** @public */\nexport interface TraitModelRef<R = any, T extends Trait = Trait, M extends Model = Model, I extends any[] = [M | null]> extends ModelRef<R, M, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitModelRefDescriptor<R, T, M>>;\n\n  get traitType(): TraitFactory<T> | null;\n\n  get traitKey(): string | undefined;\n\n  get observesTrait(): boolean;\n\n  /** @override */\n  set(traitOrModel: T | M | LikeType<M> | Fastener<any, I[0], any> | null): R;\n\n  /** @override */\n  setIntrinsic(traitOrModel: T | M | LikeType<M> | Fastener<any, I[0], any> | null): R;\n\n  readonly trait: T | null;\n\n  getTrait(): T;\n\n  setTrait(trait: T | LikeType<T> | null, targetTrait?: Trait | null, modelKey?: string): T | null;\n\n  attachTrait(trait?: T | LikeType<T> | null, targetTrait?: Trait | null): T;\n\n  /** @protected */\n  initTrait(trait: T): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, targetTrait: Trait | null): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, targetTrait: Trait | null): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, targetTrait: Trait | null): void;\n\n  detachTrait(): T | null;\n\n  /** @protected */\n  deinitTrait(trait: T): void;\n\n  /** @protected */\n  willDetachTrait(trait: T): void;\n\n  /** @protected */\n  onDetachTrait(trait: T): void;\n\n  /** @protected */\n  didDetachTrait(trait: T): void;\n\n  insertTrait(model?: M | null, trait?: T | LikeType<T>, targetTrait?: Trait | null, modelKey?: string): T;\n\n  removeTrait(): T | null;\n\n  deleteTrait(): T | null;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromTraitLike(value: T | LikeType<T>): T;\n\n  /** @protected */\n  detectModelTrait(model: Model): T | null;\n\n  /** @protected */\n  insertModelTrait(model: M, trait: T | null, targetTrait: Trait | null, traitKey: string | undefined): void;\n\n  /** @protected @override */\n  onAttachModel(model: M, targetModel: Model | null): void;\n\n  /** @protected @override */\n  onDetachModel(model: M): void;\n\n  /** @override */\n  createModel(trait?: T): M;\n}\n\n/** @public */\nexport const TraitModelRef = (<R, T extends Trait, M extends Model, I extends any[], F extends TraitModelRef<any, any, any, any>>() => ModelRef.extend<TraitModelRef<R, T, M, I>, TraitModelRefClass<F>>(\"TraitModelRef\", {\n  set(traitOrModel: T | M | LikeType<M> | Fastener<any, I[0], any> | null): R {\n    if (traitOrModel instanceof Fastener) {\n      this.bindInlet(traitOrModel);\n    } else if (traitOrModel instanceof Trait) {\n      this.setTrait(traitOrModel);\n    } else {\n      this.setModel(traitOrModel);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(traitOrModel: T | M | LikeType<M> | Fastener<any, I[0], any> | null): R {\n    if (traitOrModel instanceof Fastener) {\n      this.bindInlet(traitOrModel);\n    } else if (traitOrModel instanceof Trait) {\n      this.setTrait(traitOrModel);\n    } else {\n      this.setModel(traitOrModel);\n    }\n    return this.owner;\n  },\n\n  traitType: null,\n\n  traitKey: void 0,\n\n  observesTrait: false,\n\n  getTrait(): T {\n    const trait = this.trait;\n    if (trait === null) {\n      let message = trait + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new TypeError(message);\n    }\n    return trait;\n  },\n\n  setTrait(newTrait: T | LikeType<T> | null, targetTrait?: Trait | null, modelKey?: string): T | null {\n    if (newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    }\n    let oldTrait = this.trait;\n    if (oldTrait === newTrait) {\n      return oldTrait;\n    } else if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    let model = this.model;\n    if (model === null && newTrait !== null) {\n      model = this.createModel(newTrait);\n      const targetModel = targetTrait !== null ? targetTrait.model : null;\n      this.setModel(model, targetModel, modelKey);\n    }\n    if (model !== null) {\n      if (oldTrait !== null && oldTrait.model === model) {\n        if (targetTrait === null) {\n          targetTrait = oldTrait.nextTrait;\n        }\n        oldTrait.remove();\n      }\n      if (newTrait !== null) {\n        this.insertModelTrait(model, newTrait, targetTrait, this.traitKey);\n      }\n      oldTrait = this.trait;\n      if (oldTrait === newTrait) {\n        return oldTrait;\n      }\n    }\n    if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n    }\n    if (newTrait !== null) {\n      (this as Mutable<typeof this>).trait = newTrait;\n      this.willAttachTrait(newTrait, targetTrait);\n      this.onAttachTrait(newTrait, targetTrait);\n      this.initTrait(newTrait);\n      this.didAttachTrait(newTrait, targetTrait);\n    }\n    return oldTrait;\n  },\n\n  attachTrait(newTrait?: T | LikeType<T> | null, targetTrait?: Trait | null): T {\n    let oldTrait = this.trait;\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    } else if (oldTrait === null) {\n      newTrait = this.createTrait();\n    } else {\n      newTrait = oldTrait;\n    }\n    if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    let model = this.model;\n    if (model === null) {\n      model = this.createModel(newTrait);\n      const targetModel = targetTrait !== null ? targetTrait.model : null;\n      this.attachModel(model, targetModel);\n      oldTrait = this.trait;\n    }\n    if (oldTrait === newTrait) {\n      return newTrait;\n    } else if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, targetTrait);\n    this.onAttachTrait(newTrait, targetTrait);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, targetTrait);\n    return newTrait;\n  },\n\n  initTrait(trait: T): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, targetTrait: Trait | null): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, targetTrait: Trait | null): void {\n    if (this.observesTrait) {\n      trait.observe(this as Observes<T>);\n    }\n  },\n\n  didAttachTrait(trait: T, targetTrait: Trait | null): void {\n    // hook\n  },\n\n  detachTrait(): T | null {\n    const oldTrait = this.trait;\n    if (oldTrait === null) {\n      return null;\n    }\n    (this as Mutable<typeof this>).trait = null;\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    return oldTrait;\n  },\n\n  deinitTrait(trait: T): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T): void {\n    if (this.observesTrait) {\n      trait.unobserve(this as Observes<T>);\n    }\n  },\n\n  didDetachTrait(trait: T): void {\n    // hook\n  },\n\n  insertTrait(model?: M | null, newTrait?: T | LikeType<T>, targetTrait?: Trait | null, modelKey?: string): T {\n    let oldTrait = this.trait;\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    } else if (oldTrait === null) {\n      newTrait = this.createTrait();\n    } else {\n      newTrait = oldTrait;\n    }\n    if (model === void 0) {\n      model = null;\n    }\n    if (oldTrait === newTrait && newTrait.model !== null && model === null) {\n      return newTrait;\n    }\n    if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    if (model === null) {\n      model = this.createModel(newTrait);\n      const targetModel = targetTrait !== null ? targetTrait.model : null;\n      this.insertModel(null, model, targetModel, modelKey);\n    }\n    if (model !== null && newTrait.model !== model) {\n      this.insertModelTrait(model, newTrait, targetTrait, this.traitKey);\n    }\n    oldTrait = this.trait;\n    if (oldTrait === newTrait) {\n      return newTrait;\n    } else if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n      oldTrait.remove();\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, targetTrait);\n    this.onAttachTrait(newTrait, targetTrait);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, targetTrait);\n    return newTrait;\n  },\n\n  removeTrait(): T | null {\n    const trait = this.trait;\n    if (trait === null) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  deleteTrait(): T | null {\n    const trait = this.detachTrait();\n    if (trait === null) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n\n  fromTraitLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  detectModelTrait(model: Model): T | null {\n    return model.findTrait(this.traitKey, this.traitType as unknown as Class<T>);\n  },\n\n  insertModelTrait(model: M, trait: T, targetTrait: Trait | null, traitKey: string | undefined): void {\n    model.insertTrait(trait, targetTrait, traitKey);\n  },\n\n  onAttachModel(model: M, targetModel: Model | null): void {\n    const trait = this.detectModelTrait(model);\n    if (trait !== null) {\n      const targetTrait = targetModel !== null ? this.detectModelTrait(targetModel) : null;\n      this.attachTrait(trait, targetTrait);\n    }\n    super.onAttachModel(model, targetModel);\n  },\n\n  onDetachModel(model: M): void {\n    super.onDetachModel(model);\n    this.detachTrait();\n  },\n\n  createModel(trait?: T): M {\n    const model = super.createModel() as M;\n    if (trait === void 0) {\n      trait = this.createTrait();\n    }\n    this.insertModelTrait(model, trait, null, this.traitKey);\n    return model;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).trait = null;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<TraitModelRef<any, any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const traitKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"traitKey\");\n    if (traitKeyDescriptor !== void 0 && \"value\" in traitKeyDescriptor) {\n      if (traitKeyDescriptor.value === true) {\n        traitKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      } else if (traitKeyDescriptor.value === false) {\n        traitKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Model} from \"./Model\";\nimport type {ModelSetDescriptor} from \"./ModelSet\";\nimport type {ModelSetClass} from \"./ModelSet\";\nimport {ModelSet} from \"./ModelSet\";\nimport type {TraitFactory} from \"./Trait\";\nimport {Trait} from \"./Trait\";\n\n/** @public */\nexport interface TraitModelSetDescriptor<R, T extends Trait, M extends Model> extends ModelSetDescriptor<R, M> {\n  extends?: Proto<TraitModelSet<any, any, any, any>> | boolean | null;\n  traitKey?: string | boolean;\n}\n\n/** @public */\nexport interface TraitModelSetClass<F extends TraitModelSet<any, any, any, any> = TraitModelSet<any, any, any, any>> extends ModelSetClass<F> {\n}\n\n/** @public */\nexport interface TraitModelSet<R = any, T extends Trait = Trait, M extends Model = Model, I extends any[] = [M | null]> extends ModelSet<R, M, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitModelSetDescriptor<R, T, M>>;\n\n  get traitType(): TraitFactory<T> | null;\n\n  get traitKey(): string | undefined;\n\n  get observesTrait(): boolean;\n\n  /** @internal */\n  readonly traits: {readonly [traitId: string]: T | undefined};\n\n  readonly traitCount: number;\n\n  hasTrait(trait: Trait): boolean;\n\n  addTrait(trait?: T | LikeType<T>, targetModel?: Model | null, modelKey?: string): T;\n\n  addTraits(traits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void;\n\n  setTraits(traits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void;\n\n  attachTrait(trait?: T | LikeType<T> | null, targetModel?: Model | null): T;\n\n  /** @protected */\n  initTrait(trait: T): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, targetModel: Model | null): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, targetModel: Model | null): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, targetModel: Model | null): void;\n\n  attachTraits(traits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void;\n\n  detachTrait(trait: T): T | null;\n\n  /** @protected */\n  deinitTrait(trait: T): void;\n\n  /** @protected */\n  willDetachTrait(trait: T): void;\n\n  /** @protected */\n  onDetachTrait(trait: T): void;\n\n  /** @protected */\n  didDetachTrait(trait: T): void;\n\n  detachTraits(traits?: {readonly [traitId: string]: T | undefined}): void;\n\n  insertTrait(parent?: Model | null, trait?: T | LikeType<T>, targetModel?: Model | null, modelKey?: string): T;\n\n  insertTraits(parent: Model | null, traits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void;\n\n  removeTrait(trait: T): T | null;\n\n  removeTraits(traits?: {readonly [traitId: string]: T | undefined}): void;\n\n  deleteTrait(trait: T): T | null;\n\n  deleteTraits(traits?: {readonly [traitId: string]: T | undefined}): void;\n\n  reinsertTrait(trait: T, targetTrait?: T | null): void;\n\n  consumeTraits(consumer: Consumer): void;\n\n  unconsumeTraits(consumer: Consumer): void;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromTraitLike(value: T | LikeType<T>): T;\n\n  /** @protected */\n  detectModelTrait(model: Model): T | null;\n\n  /** @protected */\n  insertModelTrait(model: M, trait: T | null, targetTrait: Trait | null, traitKey: string | undefined): void;\n\n  /** @override */\n  detectModel(model: Model): M | null;\n\n  /** @protected @override */\n  onAttachModel(model: M, targetModel: Model | null): void;\n\n  /** @protected @override */\n  onDetachModel(model: M): void;\n\n  /** @override */\n  createModel(trait?: T): M;\n\n  /** @protected @override */\n  compare(a: M, b: M): number;\n\n  /** @protected */\n  compareTraits(a: T, b: T): number;\n}\n\n/** @public */\nexport const TraitModelSet = (<R, T extends Trait, M extends Model, I extends any[], F extends TraitModelSet<any, any, any, any>>() => ModelSet.extend<TraitModelSet<R, T, M, I>, TraitModelSetClass<F>>(\"TraitModelSet\", {\n  traitType: null,\n\n  traitKey: void 0,\n\n  observesTrait: false,\n\n  hasTrait(trait: Trait): boolean {\n    return this.traits[trait.uid] !== void 0;\n  },\n\n  addTrait(newTrait?: T | LikeType<T>, targetModel?: Model | null, modelKey?: string): T {\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    } else {\n      newTrait = this.createTrait();\n    }\n    let model = newTrait.model as M | null;\n    if (model === null) {\n      model = this.createModel(newTrait);\n    }\n    this.addModel(model, targetModel, modelKey);\n    return newTrait;\n  },\n\n  addTraits(newTraits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void {\n    for (const traitId in newTraits) {\n      this.addTrait(newTraits[traitId]!, targetModel);\n    }\n  },\n\n  setTraits(newTraits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void {\n    const traits = this.traits;\n    for (const traitId in traits) {\n      if (newTraits[traitId] === void 0) {\n        this.detachTrait(traits[traitId]!);\n      }\n    }\n    for (const traitId in newTraits) {\n      if (traits[traitId] === void 0) {\n        this.attachTrait(newTraits[traitId]!, targetModel);\n      }\n    }\n  },\n\n  attachTrait(newTrait?: T | LikeType<T> | null, targetModel?: Model | null): T {\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    } else {\n      newTrait = this.createTrait();\n    }\n    const traits = this.traits as {[traitId: string]: T | undefined};\n    if (traits[newTrait.uid] !== void 0) {\n      return newTrait;\n    } else if (targetModel === void 0) {\n      targetModel = null;\n    }\n    traits[newTrait.uid] = newTrait;\n    (this as Mutable<typeof this>).traitCount += 1;\n    let model = newTrait.model as M | null;\n    if (model === null) {\n      model = this.createModel(newTrait);\n    }\n    this.attachModel(model, targetModel);\n    this.willAttachTrait(newTrait, targetModel);\n    this.onAttachTrait(newTrait, targetModel);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, targetModel);\n    return newTrait;\n  },\n\n  initTrait(trait: T): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, targetModel: Model | null): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, targetModel: Model | null): void {\n    if (this.observesTrait) {\n      trait.observe(this as Observes<T>);\n    }\n  },\n\n  didAttachTrait(trait: T, targetModel: Model | null): void {\n    // hook\n  },\n\n  attachTraits(newTraits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void {\n    for (const traitId in newTraits) {\n      this.attachTrait(newTraits[traitId]!, targetModel);\n    }\n  },\n\n  detachTrait(oldTrait: T): T | null {\n    const traits = this.traits as {[traitId: string]: T | undefined};\n    if (traits[oldTrait.uid] === void 0) {\n      return null;\n    }\n    (this as Mutable<typeof this>).traitCount -= 1;\n    delete traits[oldTrait.uid];\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    const model = oldTrait.model as M | null;\n    if (model !== null) {\n      this.detachModel(model);\n    }\n    return oldTrait;\n  },\n\n  deinitTrait(trait: T): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T): void {\n    if (this.observesTrait) {\n      trait.unobserve(this as Observes<T>);\n    }\n  },\n\n  didDetachTrait(trait: T): void {\n    // hook\n  },\n\n  detachTraits(traits?: {readonly [traitId: string]: T | undefined}): void {\n    if (traits === void 0) {\n      traits = this.traits;\n    }\n    for (const traitId in traits) {\n      this.detachTrait(traits[traitId]!);\n    }\n  },\n\n  insertTrait(parent?: Model | null, newTrait?: T | LikeType<T>, targetModel?: Model | null, modelKey?: string): T {\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    } else {\n      newTrait = this.createTrait();\n    }\n    let model = newTrait.model as M | null;\n    if (model === null) {\n      model = this.createModel(newTrait);\n    }\n    this.insertModel(parent, model, targetModel, modelKey);\n    return newTrait;\n  },\n\n  insertTraits(parent: Model | null, newTraits: {readonly [traitId: string]: T | undefined}, targetModel?: Model | null): void {\n    for (const traitId in newTraits) {\n      this.insertTrait(parent, newTraits[traitId]!, targetModel);\n    }\n  },\n\n  removeTrait(trait: T): T | null {\n    if (!this.hasTrait(trait)) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  removeTraits(traits?: {readonly [traitId: string]: T | undefined}): void {\n    if (traits === void 0) {\n      traits = this.traits;\n    }\n    for (const traitId in traits) {\n      this.removeTrait(traits[traitId]!);\n    }\n  },\n\n  deleteTrait(trait: T): T | null {\n    const oldTrait = this.detachTrait(trait);\n    if (oldTrait === null) {\n      return null;\n    }\n    oldTrait.remove();\n    return oldTrait;\n  },\n\n  deleteTraits(traits?: {readonly [traitId: string]: T | undefined}): void {\n    if (traits === void 0) {\n      traits = this.traits;\n    }\n    for (const traitId in traits) {\n      this.deleteTrait(traits[traitId]!);\n    }\n  },\n\n  reinsertTrait(trait: T, targetTrait: T | null): void {\n    const model = trait.model as M | null;\n    if (model === null) {\n      return;\n    }\n    const targetModel = targetTrait !== null ? targetTrait.model : null;\n    this.reinsertModel(model, targetModel);\n  },\n\n  consumeTraits(consumer: Consumer): void {\n    const traits = this.traits;\n    for (const traitId in traits) {\n      const trait = traits[traitId]!;\n      trait.consume(consumer);\n    }\n  },\n\n  unconsumeTraits(consumer: Consumer): void {\n    const traits = this.traits;\n    for (const traitId in traits) {\n      const trait = traits[traitId]!;\n      trait.unconsume(consumer);\n    }\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n\n  fromTraitLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  detectModelTrait(model: Model): T | null {\n    return model.findTrait(this.traitKey, this.traitType as unknown as Class<T> | null);\n  },\n\n  insertModelTrait(model: M, trait: T, targetTrait: Trait | null, traitKey: string | undefined): void {\n    model.insertTrait(trait, targetTrait, traitKey);\n  },\n\n  detectModel(model: Model): M | null {\n    if (this.detectModelTrait(model) !== null) {\n      return model as M;\n    }\n    return null;\n  },\n\n  onAttachModel(model: M, targetModel: Model | null): void {\n    const trait = this.detectModelTrait(model);\n    if (trait !== null) {\n      this.attachTrait(trait, targetModel);\n    }\n    super.onAttachModel(model, targetModel);\n  },\n\n  onDetachModel(model: M): void {\n    super.onDetachModel(model);\n    const trait = this.detectModelTrait(model);\n    if (trait !== null) {\n      this.detachTrait(trait);\n    }\n  },\n\n  createModel(trait?: T): M {\n    const model = super.createModel() as M;\n    if (trait === void 0) {\n      trait = this.createTrait();\n    }\n    this.insertModelTrait(model, trait, null, this.traitKey);\n    return model;\n  },\n\n  compare(a: M, b: M): number {\n    const x = this.detectModelTrait(a);\n    const y = this.detectModelTrait(b);\n    if (x !== null && y !== null) {\n      return this.compareTraits(x, y);\n    }\n    return x !== null ? 1 : y !== null ? -1 : 0;\n  },\n\n  compareTraits(a: T, b: T): number {\n    return a.uid < b.uid ? -1 : a.uid > b.uid ? 1 : 0;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).traits = {};\n    (fastener as Mutable<typeof fastener>).traitCount = 0;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<TraitModelSet<any, any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const traitKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"traitKey\");\n    if (traitKeyDescriptor !== void 0 && \"value\" in traitKeyDescriptor) {\n      if (traitKeyDescriptor.value === true) {\n        traitKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      } else if (traitKeyDescriptor.value === false) {\n        traitKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport {EventHandler} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport type {ModelFlags} from \"./Model\";\nimport {Model} from \"./Model\";\nimport {ModelSet} from \"./ModelSet\";\n\n/** @public */\nexport interface RefresherServiceObserver<S extends RefresherService = RefresherService> extends ServiceObserver<S> {\n  serviceWillAttachRoot?(rootModel: Model, service: S): void;\n\n  serviceDidAttachRoot?(rootModel: Model, service: S): void;\n\n  serviceWillDetachRoot?(rootModel: Model, service: S): void;\n\n  serviceDidDetachRoot?(rootModel: Model, service: S): void;\n}\n\n/** @public */\nexport class RefresherService extends Service {\n  constructor() {\n    super();\n    this.updateFlags = 0;\n    this.updateTime = performance.now();\n    this.updateDelay = RefresherService.MinUpdateDelay;\n    this.analyzeTimer = 0;\n    this.refreshTimer = 0;\n\n    this.runAnalyzePass = this.runAnalyzePass.bind(this);\n    this.runRefreshPass = this.runRefreshPass.bind(this);\n  }\n\n  declare readonly observerType?: Class<RefresherServiceObserver>;\n\n  @ModelSet({\n    initModel(rootModel: Model): void {\n      this.owner.requestUpdate(rootModel, rootModel.flags & Model.UpdateMask, false);\n    },\n    willAttachModel(rootModel: Model): void {\n      this.owner.callObservers(\"serviceWillAttachRoot\", rootModel, this.owner);\n    },\n    didAttachModel(rootModel: Model): void {\n      this.owner.callObservers(\"serviceDidAttachRoot\", rootModel, this.owner);\n    },\n    willDetachModel(rootModel: Model): void {\n      this.owner.callObservers(\"serviceWillDetachRoot\", rootModel, this.owner);\n    },\n    didDetachModel(rootModel: Model): void {\n      this.owner.callObservers(\"serviceDidDetachRoot\", rootModel, this.owner);\n    },\n  })\n  readonly roots!: ModelSet<this, Model>;\n\n  /** @internal */\n  readonly updateFlags: ModelFlags;\n\n  /** @internal */\n  setUpdateFlags(updateFlags: ModelFlags): void {\n    (this as Mutable<this>).updateFlags = updateFlags;\n  }\n\n  readonly updateTime: number;\n\n  /** @internal */\n  updateDelay: number;\n\n  protected needsUpdate(updateFlags: ModelFlags, immediate: boolean): ModelFlags {\n    return updateFlags;\n  }\n\n  requestUpdate(target: Model, updateFlags: ModelFlags, immediate: boolean): void {\n    updateFlags = this.needsUpdate(updateFlags, immediate);\n    let deltaUpdateFlags = this.updateFlags & ~updateFlags & Model.UpdateMask;\n    if ((updateFlags & Model.AnalyzeMask) !== 0) {\n      deltaUpdateFlags |= Model.NeedsAnalyze;\n    }\n    if ((updateFlags & Model.RefreshMask) !== 0) {\n      deltaUpdateFlags |= Model.NeedsRefresh;\n    }\n    this.setUpdateFlags(this.updateFlags | deltaUpdateFlags);\n    if (immediate && (this.updateFlags & (Model.AnalyzingFlag | Model.RefreshingFlag)) === 0 && this.updateDelay <= RefresherService.MaxAnalyzeInterval) {\n      this.runImmediatePass();\n    } else {\n      this.scheduleUpdate();\n    }\n  }\n\n  protected scheduleUpdate(): void {\n    const updateFlags = this.updateFlags;\n    if ((updateFlags & Model.AnalyzingFlag) === 0 && (updateFlags & Model.AnalyzeMask) !== 0) {\n      this.scheduleAnalyzePass(this.updateDelay);\n    } else if ((updateFlags & Model.RefreshingFlag) === 0 && (updateFlags & Model.RefreshMask) !== 0) {\n      this.scheduleRefreshPass(RefresherService.MinAnalyzeInterval);\n    }\n  }\n\n  protected cancelUpdate(): void {\n    this.cancelAnalyzePass();\n    this.cancelRefreshPass();\n  }\n\n  protected runImmediatePass(): void {\n    if ((this.updateFlags & Model.AnalyzeMask) !== 0) {\n      this.cancelUpdate();\n      this.runAnalyzePass(true);\n    }\n    if ((this.updateFlags & Model.RefreshMask) !== 0 && this.updateDelay <= RefresherService.MaxAnalyzeInterval) {\n      this.cancelUpdate();\n      this.runRefreshPass(true);\n    }\n  }\n\n  /** @internal */\n  analyzeTimer: number;\n\n  protected scheduleAnalyzePass(updateDelay: number): void {\n    if (this.analyzeTimer === 0) {\n      this.analyzeTimer = setTimeout(this.runAnalyzePass, updateDelay) as any;\n    }\n  }\n\n  protected cancelAnalyzePass(): void {\n    if (this.analyzeTimer !== 0) {\n      clearTimeout(this.analyzeTimer);\n      this.analyzeTimer = 0;\n    }\n  }\n\n  protected runAnalyzePass(immediate: boolean = false): void {\n    if (!immediate) {\n      this.analyzeTimer = 0;\n    }\n    this.setUpdateFlags(this.updateFlags & ~Model.AnalyzeMask | Model.AnalyzingFlag);\n    try {\n      const t0 = performance.now();\n      (this as Mutable<this>).updateTime = t0;\n\n      const rootModels = this.roots.models;\n      for (const modelId in rootModels) {\n        const rootModel = rootModels[modelId]!;\n        if ((rootModel.flags & Model.AnalyzeMask) !== 0) {\n          rootModel.cascadeAnalyze(0);\n        }\n      }\n\n      const t1 = performance.now();\n      let analyzeDelay = Math.max(RefresherService.MinAnalyzeInterval, this.updateDelay);\n      if (t1 - t0 > analyzeDelay) {\n        this.updateDelay = Math.min(Math.max(2, this.updateDelay * 2), RefresherService.MaxUpdateDelay);\n      } else {\n        this.updateDelay = Math.min(RefresherService.MinUpdateDelay, this.updateDelay / 2);\n      }\n\n      this.cancelAnalyzePass();\n      if ((this.updateFlags & Model.RefreshMask) !== 0) {\n        this.scheduleRefreshPass(RefresherService.MinRefreshInterval);\n      } else if ((this.updateFlags & Model.AnalyzeMask) !== 0) {\n        if (immediate) {\n          analyzeDelay = Math.max(RefresherService.MaxAnalyzeInterval, analyzeDelay);\n        }\n        this.cancelRefreshPass();\n        this.scheduleAnalyzePass(analyzeDelay);\n      }\n    } finally {\n      this.setUpdateFlags(this.updateFlags & ~Model.AnalyzingFlag);\n    }\n  }\n\n  /** @internal */\n  refreshTimer: number;\n\n  protected scheduleRefreshPass(updateDelay: number): void {\n    if (this.refreshTimer === 0) {\n      this.refreshTimer = setTimeout(this.runRefreshPass, updateDelay) as any;\n    }\n  }\n\n  protected cancelRefreshPass(): void {\n    if (this.refreshTimer !== 0) {\n      clearTimeout(this.refreshTimer);\n      this.refreshTimer = 0;\n    }\n  }\n\n  protected runRefreshPass(immediate: boolean = false): void {\n    if (!immediate) {\n      this.refreshTimer = 0;\n    }\n    this.setUpdateFlags(this.updateFlags & ~Model.RefreshMask | Model.RefreshingFlag);\n    try {\n      const time = performance.now();\n      (this as Mutable<this>).updateTime = time;\n\n      const rootModels = this.roots.models;\n      for (const modelId in rootModels) {\n        const rootModel = rootModels[modelId]!;\n        if ((rootModel.flags & Model.RefreshMask) !== 0) {\n          rootModel.cascadeRefresh(0);\n        }\n      }\n\n      this.cancelRefreshPass();\n      if ((this.updateFlags & Model.AnalyzeMask) !== 0) {\n        let analyzeDelay = this.updateDelay;\n        if (immediate) {\n          analyzeDelay = Math.max(RefresherService.MaxAnalyzeInterval, analyzeDelay);\n        }\n        this.scheduleAnalyzePass(analyzeDelay);\n      } else if ((this.updateFlags & Model.RefreshMask) !== 0) {\n        this.cancelAnalyzePass();\n        this.scheduleRefreshPass(RefresherService.MaxRefreshInterval);\n      }\n    } finally {\n      this.setUpdateFlags(this.updateFlags & ~Model.RefreshingFlag);\n    }\n  }\n\n  get powerFlags(): ModelFlags {\n    return 0;\n  }\n\n  power(): void {\n    const rootModels = this.roots.models;\n    for (const modelId in rootModels) {\n      const rootModel = rootModels[modelId]!;\n      rootModel.requireUpdate(this.powerFlags);\n    }\n  }\n\n  unpower(): void {\n    this.cancelUpdate();\n    this.updateDelay = RefresherService.MinUpdateDelay;\n  }\n\n  @EventHandler({\n    eventType: \"visibilitychange\",\n    target: typeof document !== \"undefined\" ? document : null,\n    handle(event: Event): void {\n      if (document.visibilityState === \"visible\") {\n        this.owner.power();\n      } else {\n        this.owner.unpower();\n      }\n    },\n  })\n  readonly visibilityChange!: EventHandler<this>;\n\n  /** @internal */\n  static MinUpdateDelay: number = 0;\n  /** @internal */\n  static MaxUpdateDelay: number = 167;\n  /** @internal */\n  static MinAnalyzeInterval: number = 12;\n  /** @internal */\n  static MaxAnalyzeInterval: number = 33;\n  /** @internal */\n  static MinRefreshInterval: number = 4;\n  /** @internal */\n  static MaxRefreshInterval: number = 16;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {Dictionary} from \"@swim/util\";\nimport type {MutableDictionary} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport {EventHandler} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\n\n/** @public */\nexport interface StorageServiceObserver<S extends StorageService = StorageService> extends ServiceObserver<S> {\n  serviceWillStore?(key: string, newValue: string | undefined, oldValue: string | undefined, service: S): void;\n\n  serviceDidStore?(key: string, newValue: string | undefined, oldValue: string | undefined, service: S): void;\n\n  serviceWillClear?(service: S): void;\n\n  serviceDidClear?(service: S): void;\n}\n\n/** @public */\nexport abstract class StorageService extends Service {\n  declare readonly observerType?: Class<StorageServiceObserver>;\n\n  abstract get(key: string): string | undefined;\n\n  abstract override set(key: string, newValue: string | undefined): string | undefined;\n  abstract override set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): this;\n\n  protected willSet(key: string, newValue: string | undefined, oldValue: string | undefined): void {\n    this.callObservers(\"serviceWillStore\", key, newValue, oldValue, this);\n  }\n\n  protected onSet(key: string, newValue: string | undefined, oldValue: string | undefined): void {\n    // hook\n  }\n\n  protected didSet(key: string, newValue: string | undefined, oldValue: string | undefined): void {\n    this.callObservers(\"serviceDidStore\", key, newValue, oldValue, this);\n  }\n\n  abstract clear(): void;\n\n  protected willClear(): void {\n    this.callObservers(\"serviceWillClear\", this);\n  }\n\n  protected onClear(): void {\n    // hook\n  }\n\n  protected didClear(): void {\n    this.callObservers(\"serviceDidClear\", this);\n  }\n\n  static override create(): StorageService;\n  static override create(): StorageService;\n  static override create(): StorageService {\n    let service: StorageService | null = WebStorageService.local();\n    if (service === null) {\n      service = new EphemeralStorageService();\n    }\n    return service;\n  }\n}\n\n/** @public */\nexport class WebStorageService extends StorageService {\n  constructor(storageArea: Storage) {\n    super();\n    this.storageArea = storageArea;\n  }\n\n  readonly storageArea: Storage;\n\n  override get(key: string): string | undefined {\n    const value = this.storageArea.getItem(key);\n    return value !== null ? value : void 0;\n  }\n\n  override set(key: string, newValue: string | undefined): string | undefined;\n  override set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): this;\n  override set(key: string | {[K in keyof WebStorageService as WebStorageService[K] extends {set(value: any): any} ? K : never]?: WebStorageService[K] extends {set(value: infer T): any} ? T : never}, newValue?: string | TimingLike | boolean | null): string | undefined | this {\n    if (typeof key !== \"string\") {\n      Service.prototype.set.call(this, key, newValue as TimingLike | boolean | null | undefined);\n      return this;\n    }\n    let oldValue: string | null | undefined = this.storageArea.getItem(key);\n    if (oldValue === null) {\n      oldValue = void 0;\n    }\n    if (newValue === oldValue) {\n      return oldValue;\n    }\n    this.willSet(key, newValue as string | undefined, oldValue);\n    if (newValue !== void 0) {\n      this.storageArea.setItem(key, newValue as string);\n    } else {\n      this.storageArea.removeItem(key);\n    }\n    this.onSet(key, newValue as string | undefined, oldValue);\n    this.didSet(key, newValue as string | undefined, oldValue);\n    return oldValue;\n  }\n\n  override clear(): void {\n    this.willClear();\n    this.storageArea.clear();\n    this.onClear();\n    this.didClear();\n  }\n\n  @EventHandler({\n    eventType: \"storage\",\n    target: typeof window !== \"undefined\" ? window : null,\n    handle(event: StorageEvent): void {\n      if (event.storageArea !== this.owner.storageArea) {\n        return;\n      }\n      const key = event.key;\n      if (key === null) {\n        this.owner.willClear();\n        this.owner.onClear();\n        this.owner.didClear();\n        return;\n      }\n      let newValue: string | null | undefined = event.newValue;\n      if (newValue === null) {\n        newValue = void 0;\n      }\n      let oldValue: string | null | undefined = event.oldValue;\n      if (oldValue === null) {\n        oldValue = void 0;\n      }\n      if (newValue !== oldValue) {\n        this.owner.willSet(key, newValue, oldValue);\n        this.owner.onSet(key, newValue, oldValue);\n        this.owner.didSet(key, newValue, oldValue);\n      }\n    },\n  })\n  readonly storageEvent!: EventHandler<this>;\n\n  /** @internal */\n  static Local: WebStorageService | null | undefined = void 0;\n\n  static local(): WebStorageService | null {\n    if (this.Local === void 0) {\n      try {\n        this.Local = new WebStorageService(window.localStorage);\n      } catch (e) {\n        this.Local = null;\n      }\n    }\n    return this.Local;\n  }\n\n  /** @internal */\n  static Session: WebStorageService | null | undefined = void 0;\n\n  static session(): WebStorageService | null {\n    if (this.Session === void 0) {\n      try {\n        this.Session = new WebStorageService(window.sessionStorage);\n      } catch (e) {\n        this.Session = null;\n      }\n    }\n    return this.Session;\n  }\n}\n\n/** @public */\nexport class EphemeralStorageService extends StorageService {\n  constructor(storageArea?: Dictionary<string>) {\n    super();\n    if (storageArea === void 0) {\n      storageArea = {};\n    }\n    this.storageArea = storageArea;\n  }\n\n  readonly storageArea: Dictionary<string>;\n\n  override get(key: string): string | undefined {\n    return this.storageArea[key];\n  }\n\n  override set(key: string, newValue: string | undefined): string | undefined;\n  override set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): this;\n  override set(key: string | {[K in keyof EphemeralStorageService as EphemeralStorageService[K] extends {set(value: any): any} ? K : never]?: EphemeralStorageService[K] extends {set(value: infer T): any} ? T : never}, newValue?: string | TimingLike | boolean | null): string | undefined | this {\n    if (typeof key !== \"string\") {\n      Service.prototype.set.call(this, key, newValue as TimingLike | boolean | null | undefined);\n      return this;\n    }\n    const storageArea = this.storageArea as MutableDictionary<string>;\n    const oldValue = storageArea[key];\n    if (newValue === oldValue) {\n      return oldValue;\n    }\n    this.willSet(key, newValue as string | undefined, oldValue);\n    if (newValue !== void 0) {\n      storageArea[key] = newValue as string;\n    } else {\n      delete storageArea[key];\n    }\n    this.onSet(key, newValue as string | undefined, oldValue);\n    this.didSet(key, newValue as string | undefined, oldValue);\n    return oldValue;\n  }\n\n  override clear(): void {\n    this.willClear();\n    (this as Mutable<this>).storageArea = {};\n    this.onClear();\n    this.didClear();\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport type {Model} from \"./Model\";\nimport {SelectableTrait} from \"./\"; // forward import\n\n/** @public */\nexport interface SelectionOptions {\n  multi?: boolean;\n}\n\n/** @public */\nexport interface SelectionServiceObserver<S extends SelectionService = SelectionService> extends ServiceObserver<S> {\n  serviceWillSelect?(model: Model, index: number, options: SelectionOptions | null, service: S): void;\n\n  serviceDidSelect?(model: Model, index: number, options: SelectionOptions | null, service: S): void;\n\n  serviceWillUnselect?(model: Model, service: S): void;\n\n  serviceDidUnselect?(model: Model, service: S): void;\n\n  serviceDidUnselectAll?(service: S): void;\n}\n\n/** @public */\nexport class SelectionService extends Service {\n  constructor() {\n    super();\n    this.selections = [];\n  }\n\n  declare readonly observerType?: Class<SelectionServiceObserver>;\n\n  readonly selections: readonly Model[];\n\n  isSelected(model: Model): boolean {\n    return this.selections.indexOf(model) >= 0;\n  }\n\n  select(model: Model, options?: SelectionOptions | null, index?: number): void {\n    const selections = this.selections as Model[];\n    if (selections.indexOf(model) >= 0) {\n      return;\n    } else if (options === void 0) {\n      options = null;\n    }\n    if (options === null || !options.multi) {\n      this.unselectAll(true);\n    }\n    if (index === void 0) {\n      index = selections.length;\n    } else {\n      if (index < 0) {\n        index = selections.length + 1 + index;\n      }\n      index = Math.min(Math.max(0, index, selections.length));\n    }\n    const selectableTrait = model.getTrait(SelectableTrait);\n    this.willSelect(model, index, options);\n    if (selectableTrait !== null) {\n      selectableTrait.willSelect(options);\n    }\n    selections.splice(index, 0, model);\n    this.onSelect(model, index, options);\n    if (selectableTrait !== null) {\n      selectableTrait.onSelect(options);\n      selectableTrait.didSelect(options);\n    }\n    this.didSelect(model, index, options);\n  }\n\n  protected willSelect(model: Model, index: number, options: SelectionOptions | null): void {\n    this.callObservers(\"serviceWillSelect\", model, index, options, this);\n  }\n\n  protected onSelect(model: Model, index: number, options: SelectionOptions | null): void {\n    // hook\n  }\n\n  protected didSelect(model: Model, index: number, options: SelectionOptions | null): void {\n    this.callObservers(\"serviceDidSelect\", model, index, options, this);\n  }\n\n  unselect(model: Model): void;\n  /** @internal */\n  unselect(model: Model, internal?: boolean): void;\n  unselect(model: Model, internal?: boolean): void {\n    const selections = this.selections as Model[];\n    const index = selections.indexOf(model);\n    if (index < 0) {\n      return;\n    }\n    const selectableTrait = model.getTrait(SelectableTrait);\n    this.willUnselect(model);\n    if (selectableTrait !== null) {\n      selectableTrait.willUnselect();\n    }\n    selections.splice(index, 1);\n    this.onUnselect(model);\n    if (selectableTrait !== null) {\n      selectableTrait.onUnselect();\n      selectableTrait.didUnselect();\n    }\n    this.didUnselect(model);\n    if (internal !== true && selections.length === 0) {\n      this.didUnselectAll();\n    }\n  }\n\n  protected willUnselect(model: Model): void {\n    this.callObservers(\"serviceWillUnselect\", model, this);\n  }\n\n  protected onUnselect(model: Model): void {\n    // hook\n  }\n\n  protected didUnselect(model: Model): void {\n    this.callObservers(\"serviceDidUnselect\", model, this);\n  }\n\n  unselectAll(): void;\n  /** @internal */\n  unselectAll(internal?: boolean): void;\n  unselectAll(internal?: boolean): void {\n    const selections = this.selections;\n    if (selections.length === 0) {\n      return;\n    }\n    while (selections.length !== 0) {\n      this.unselect(selections[0]!, true);\n    }\n    if (internal !== true) {\n      this.didUnselectAll();\n    }\n  }\n\n  protected didUnselectAll(): void {\n    this.callObservers(\"serviceDidUnselectAll\", this);\n  }\n\n  toggle(model: Model, options?: SelectionOptions | null, index?: number): void {\n    const selections = this.selections as Model[];\n    const selectedIndex = selections.indexOf(model);\n    if (selectedIndex < 0) {\n      if (options === void 0) {\n        options = null;\n      }\n      if (options === null || !options.multi) {\n        this.unselectAll(true);\n      }\n      if (index === void 0) {\n        index = selections.length;\n      } else {\n        if (index < 0) {\n          index = selections.length + 1 + index;\n        }\n        index = Math.min(Math.max(0, index, selections.length));\n      }\n      const selectableTrait = model.getTrait(SelectableTrait);\n      this.willSelect(model, index, options);\n      if (selectableTrait !== null) {\n        selectableTrait.willSelect(options);\n      }\n      selections.splice(index, 0, model);\n      this.onSelect(model, index, options);\n      if (selectableTrait !== null) {\n        selectableTrait.onSelect(options);\n        selectableTrait.didSelect(options);\n      }\n      this.didSelect(model, index, options);\n    } else {\n      const selectableTrait = model.getTrait(SelectableTrait);\n      this.willUnselect(model);\n      if (selectableTrait !== null) {\n        selectableTrait.willUnselect();\n      }\n      selections.splice(selectedIndex, 1);\n      this.onUnselect(model);\n      if (selectableTrait !== null) {\n        selectableTrait.onUnselect();\n        selectableTrait.didUnselect();\n      }\n      this.didUnselect(model);\n      if (selections.length === 0) {\n        this.didUnselectAll();\n      }\n    }\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport {Provider} from \"@swim/component\";\nimport type {TraitObserver} from \"./Trait\";\nimport {Trait} from \"./Trait\";\nimport type {SelectionOptions} from \"./SelectionService\";\nimport {SelectionService} from \"./SelectionService\";\n\n/** @public */\nexport interface SelectableTraitObserver<T extends SelectableTrait = SelectableTrait> extends TraitObserver<T> {\n  traitWillSelect?(options: SelectionOptions | null, trait: T): void;\n\n  traitDidSelect?(options: SelectionOptions | null, trait: T): void;\n\n  traitWillUnselect?(trait: T): void;\n\n  traitDidUnselect?(trait: T): void;\n}\n\n/** @public */\nexport class SelectableTrait extends Trait {\n  constructor() {\n    super();\n    this.selected = false;\n  }\n\n  declare readonly observerType?: Class<SelectableTraitObserver>;\n\n  readonly selected: boolean;\n\n  select(options?: SelectionOptions | null): void {\n    if (this.selected) {\n      return;\n    }\n    (this as Mutable<this>).selected = true;\n    if (!this.mounted) {\n      return;\n    }\n    this.selection.getService().select(this.model!, options);\n  }\n\n  /** @protected */\n  willSelect(options: SelectionOptions | null): void {\n    this.callObservers(\"traitWillSelect\", options, this);\n  }\n\n  /** @protected */\n  onSelect(options: SelectionOptions | null): void {\n    (this as Mutable<this>).selected = true;\n  }\n\n  /** @protected */\n  didSelect(options: SelectionOptions | null): void {\n    this.callObservers(\"traitDidSelect\", options, this);\n  }\n\n  unselect(): void {\n    if (!this.selected) {\n      return;\n    }\n    (this as Mutable<this>).selected = false;\n    if (!this.mounted) {\n      return;\n    }\n    this.selection.getService().unselect(this.model!);\n  }\n\n  /** @protected */\n  willUnselect(): void {\n    this.callObservers(\"traitWillUnselect\", this);\n  }\n\n  /** @protected */\n  onUnselect(): void {\n    (this as Mutable<this>).selected = false;\n  }\n\n  /** @protected */\n  didUnselect(): void {\n    this.callObservers(\"traitDidUnselect\", this);\n  }\n\n  unselectAll(): void {\n    this.selection.getService().unselectAll();\n  }\n\n  toggle(options?: SelectionOptions): void {\n    if (!this.selected) {\n      this.select(options);\n    } else {\n      this.unselect();\n    }\n  }\n\n  @Provider({serviceType: SelectionService})\n  readonly selection!: Provider<this, SelectionService>;\n\n  protected override didMount(): void {\n    if (this.selected) {\n      this.selection.getService().select(this.model!);\n    }\n    super.didMount();\n  }\n\n  protected override willUnmount(): void {\n    super.willUnmount();\n    this.selection.getService().unselect(this.model!);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {Equivalent} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Strings} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport {Values} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport type {Output} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Base16} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport type {Item} from \"@swim/structure\";\nimport {Value} from \"@swim/structure\";\nimport {Attr} from \"@swim/structure\";\nimport {Record} from \"@swim/structure\";\nimport {Form} from \"@swim/structure\";\nimport type {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport {LengthParser} from \"@swim/math\";\n\n/** @public */\nexport type FontStyle = \"normal\"\n                      | \"italic\"\n                      | \"oblique\";\n\n/** @public */\nexport type FontVariant = \"normal\" | \"small-caps\";\n\n/** @public */\nexport type FontWeight = \"normal\"\n                       | \"100\"\n                       | \"200\"\n                       | \"300\"\n                       | \"400\"\n                       | \"500\"\n                       | \"600\"\n                       | \"700\"\n                       | \"800\"\n                       | \"900\"\n                       | \"bold\"\n                       | \"bolder\"\n                       | \"lighter\";\n\n/** @public */\nexport type FontStretch = \"normal\"\n                        | \"ultra-condensed\"\n                        | \"extra-condensed\"\n                        | \"semi-condensed\"\n                        | \"condensed\"\n                        | \"expanded\"\n                        | \"semi-expanded\"\n                        | \"extra-expanded\"\n                        | \"ultra-expanded\";\n\n/** @public */\nexport type FontSizeLike = LengthLike | FontSize;\n\n/** @public */\nexport type FontSize = Length\n                     | \"large\"\n                     | \"larger\"\n                     | \"medium\"\n                     | \"small\"\n                     | \"smaller\"\n                     | \"x-large\"\n                     | \"x-small\"\n                     | \"xx-large\"\n                     | \"xx-small\";\n\n/** @public */\nexport const FontSize = {\n  fromLike<T extends FontSizeLike | null | undefined>(value: T): FontSize | Uninitable<T> {\n    if (value === void 0 || value === null) {\n      return value as FontSize | Uninitable<T>;\n    } else if (typeof value === \"string\"\n        && (value === \"large\" || value === \"larger\" || value === \"medium\"\n         || value === \"small\" || value === \"smaller\"  || value === \"x-large\" || value === \"x-small\"\n         || value === \"xx-large\" || value === \"xx-small\")) {\n      return value as FontSize;\n    }\n    return Length.fromLike(value);\n  },\n\n  fromValue(value: Value): FontSize | null {\n    const string = value.stringValue(null);\n    if (string !== null) {\n      return FontSize.fromLike(string);\n    }\n    const size = Length.form().cast(value);\n    return size !== void 0 ? size : null;\n  },\n};\n\n/** @public */\nexport type LineHeightLike = LengthLike | LineHeight;\n\n/** @public */\nexport type LineHeight = Length | \"normal\";\n\n/** @public */\nexport const LineHeight = {\n  fromLike<T extends LineHeightLike | null | undefined>(value: T): LineHeight | Uninitable<T> {\n    if (value === void 0 || value === null) {\n      return value as LineHeight | Uninitable<T>;\n    } else if (typeof value === \"string\" && value === \"normal\") {\n      return value as LineHeight;\n    }\n    return Length.fromLike(value);\n  },\n\n  fromValue(value: Value): LineHeight | null {\n    const string = value.stringValue(null);\n    if (string !== null) {\n      return LineHeight.fromLike(string);\n    }\n    const height = Length.form().cast(value);\n    return height !== void 0 ? height : null;\n  },\n};\n\n/** @public */\nexport type GenericFamily = \"serif\"\n                          | \"sans-serif\"\n                          | \"cursive\"\n                          | \"fantasy\"\n                          | \"monospace\"\n                          | \"system-ui\"\n                          | \"emoji\"\n                          | \"math\"\n                          | \"fangsong\";\n\n/** @public */\nexport type FontFamily = string | GenericFamily;\n\n/** @public */\nexport const FontFamily = {\n  fromValue(value: Value): FontFamily | FontFamily[] | null {\n    let family: FontFamily | FontFamily[] | null = null;\n    value.forEach(function (item: Item): void {\n      let string: string | undefined;\n      if (!(item instanceof Value) || (string = item.stringValue(void 0)) === void 0) {\n        return;\n      }\n      if (family === null) {\n        family = string;\n      } else if (typeof family === \"string\") {\n        family = [family, string];\n      } else {\n        family.push(string);\n      }\n    });\n    return family;\n  },\n\n  format(family: FontFamily): string {\n    let isIdent = false;\n    if (family.length !== 0) {\n      isIdent = Unicode.isAlpha(family.charCodeAt(0));\n      for (let i = Strings.offsetByCodePoints(family, 0, 1); isIdent && i < family.length; i = Strings.offsetByCodePoints(family, i, 1)) {\n        const c = family.charCodeAt(i);\n        isIdent = Unicode.isAlpha(c) || c === 45/*'-'*/;\n      }\n    }\n    if (isIdent) {\n      return family;\n    }\n    let output = Unicode.stringOutput();\n    output = output.write(34/*'\"'*/);\n    for (let i = 0; i < family.length; i = Strings.offsetByCodePoints(family, i, 1)) {\n      const c = family.charCodeAt(i);\n      if (c === 10/*'\\n'*/ || c === 34/*'\"'*/ || c === 39/*'\\''*/) {\n        output = output.write(92/*'\\\\'*/).write(c);\n      } else if (c >= 0x20) {\n        output = output.write(c);\n      } else {\n        const base16 = Base16.uppercase;\n        output = output.write(92/*'\\\\'*/).write(base16.encodeDigit(c >>> 20 & 0xf))\n                                         .write(base16.encodeDigit(c >>> 16 & 0xf))\n                                         .write(base16.encodeDigit(c >>> 12 & 0xf))\n                                         .write(base16.encodeDigit(c >>>  8 & 0xf))\n                                         .write(base16.encodeDigit(c >>>  4 & 0xf))\n                                         .write(base16.encodeDigit(c        & 0xf));\n      }\n    }\n    output = output.write(34/*'\"'*/);\n    return output.toString();\n  },\n};\n\n/** @public */\nexport type FontLike = Font | FontInit | string;\n\n/** @public */\nexport const FontLike = {\n  [Symbol.hasInstance](instance: unknown): instance is FontLike {\n    return instance instanceof Font\n        || FontInit[Symbol.hasInstance](instance);\n  },\n};\n\n/** @public */\nexport interface FontInit {\n  style?: FontStyle;\n  variant?: FontVariant;\n  weight?: FontWeight;\n  stretch?: FontStretch;\n  size?: FontSizeLike | null;\n  height?: LineHeightLike | null;\n  family: FontFamily | FontFamily[];\n}\n\n/** @public */\nexport const FontInit = {\n  [Symbol.hasInstance](instance: unknown): instance is FontInit {\n    return Objects.hasAllKeys<FontInit>(instance, \"family\");\n  },\n};\n\n/** @public */\nexport class Font implements Interpolate<Font>, Equals, Equivalent, Debug {\n  constructor(style: FontStyle | undefined, variant: FontVariant | undefined,\n              weight: FontWeight | undefined, stretch: FontStretch | undefined,\n              size: FontSize | null, height: LineHeight | null,\n              family: FontFamily | readonly FontFamily[]) {\n    this.style = style;\n    this.variant = variant;\n    this.weight = weight;\n    this.stretch = stretch;\n    this.size = size;\n    this.height = height;\n    this.family = family;\n    this.stringValue = void 0;\n  }\n\n  likeType?(like: FontInit | string): void;\n\n  readonly style: FontStyle | undefined;\n\n  withStyle(style: FontStyle | undefined): Font {\n    if (style === this.style) {\n      return this;\n    }\n    return new Font(style, this.variant, this.weight, this.stretch,\n                    this.size, this.height, this.family);\n  }\n\n  readonly variant: FontVariant | undefined;\n\n  withVariant(variant: FontVariant | undefined): Font {\n    if (variant === this.variant) {\n      return this;\n    }\n    return new Font(this.style, variant, this.weight, this.stretch,\n                    this.size, this.height, this.family);\n  }\n\n  readonly weight: FontWeight | undefined;\n\n  withWeight(weight: FontWeight | undefined): Font {\n    if (weight === this.weight) {\n      return this;\n    }\n    return new Font(this.style, this.variant, weight, this.stretch,\n                    this.size, this.height, this.family);\n  }\n\n  readonly stretch: FontStretch | undefined;\n\n  withStretch(stretch: FontStretch | undefined): Font {\n    if (stretch === this.stretch) {\n      return this;\n    }\n    return new Font(this.style, this.variant, this.weight, stretch,\n                    this.size, this.height, this.family);\n  }\n\n  readonly size: FontSize | null;\n\n  withSize(size: FontSizeLike | null): Font{\n    size = FontSize.fromLike(size);\n    if (Values.equal(size, this.size)) {\n      return this;\n    }\n    return new Font(this.style, this.variant, this.weight, this.stretch,\n                    size as FontSize | null, this.height, this.family);\n  }\n\n  readonly height: LineHeight | null;\n\n  withHeight(height: LineHeightLike | null): Font {\n    height = LineHeight.fromLike(height);\n    if (Values.equal(height, this.height)) {\n      return this;\n    }\n    return new Font(this.style, this.variant, this.weight, this.stretch,\n                    this.size, height as LineHeight | null, this.family);\n  }\n\n  readonly family: FontFamily | readonly FontFamily[];\n\n  withFamily(family: FontFamily | readonly FontFamily[]): Font {\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    if (Values.equal(family, this.family)) {\n      return this;\n    }\n    return new Font(this.style, this.variant, this.weight, this.stretch,\n                    this.size, this.height, family);\n  }\n\n  toLike(): FontInit {\n    return {\n      style: this.style,\n      variant: this.variant,\n      weight: this.weight,\n      stretch: this.stretch,\n      size: this.size,\n      height: this.height,\n      family: (Array.isArray(this.family) ? this.family.slice(0) : this.family) as FontFamily | FontFamily[],\n    };\n  }\n\n  /** @override */\n  interpolateTo(that: Font): Interpolator<Font>;\n  interpolateTo(that: unknown): Interpolator<Font> | null;\n  interpolateTo(that: unknown): Interpolator<Font> | null {\n    if (that instanceof Font) {\n      return FontInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Font) {\n      return this.style === that.style && this.variant === that.variant\n          && this.weight === that.weight && this.stretch === that.stretch\n          && Values.equivalent(this.size, that.size, epsilon)\n          && Values.equivalent(this.height, that.height, epsilon)\n          && Values.equivalent(this.family, that.family, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Font) {\n      return this.style === that.style && this.variant === that.variant\n          && this.weight === that.weight && this.stretch === that.stretch\n          && Values.equal(this.size, that.size)\n          && Values.equal(this.height, that.height)\n          && Values.equal(this.family, that.family);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Font\").write(46/*'.'*/).write(\"family\").write(40/*'('*/);\n    if (typeof this.family === \"string\") {\n      output = output.debug(this.family);\n    } else if (Array.isArray(this.family) && this.family.length !== 0) {\n      output = output.debug(this.family[0]);\n      for (let i = 1; i < this.family.length; i += 1) {\n        output = output.write(\", \").debug(this.family[i]);\n      }\n    }\n    output = output.write(41/*')'*/);\n    if (this.style !== void 0) {\n      output = output.write(46/*'.'*/).write(\"style\").write(40/*'('*/).debug(this.style).write(41/*')'*/);\n    }\n    if (this.variant !== void 0) {\n      output = output.write(46/*'.'*/).write(\"variant\").write(40/*'('*/).debug(this.variant).write(41/*')'*/);\n    }\n    if (this.weight !== void 0) {\n      output = output.write(46/*'.'*/).write(\"weight\").write(40/*'('*/).debug(this.weight).write(41/*')'*/);\n    }\n    if (this.stretch !== void 0) {\n      output = output.write(46/*'.'*/).write(\"stretch\").write(40/*'('*/).debug(this.stretch).write(41/*')'*/);\n    }\n    if (this.size !== void 0) {\n      output = output.write(46/*'.'*/).write(\"size\").write(40/*'('*/).debug(this.size).write(41/*')'*/);\n    }\n    if (this.height !== void 0) {\n      output = output.write(46/*'.'*/).write(\"height\").write(40/*'('*/).debug(this.height).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  /* @internal */\n  readonly stringValue: string | undefined;\n\n  /** @override */\n  toString(): string {\n    let s = this.stringValue;\n    if (s === void 0) {\n      s = \"\";\n      if (this.style !== void 0 || this.variant === \"normal\" || this.weight === \"normal\" || this.stretch === \"normal\") {\n        s += this.style ?? \"normal\";\n      }\n      if (this.variant !== void 0 || this.weight === \"normal\" || this.stretch === \"normal\") {\n        if (s.length !== 0) {\n          s += \" \";\n        }\n        s += this.variant ?? \"normal\";\n      }\n      if (this.weight !== void 0 || this.stretch === \"normal\") {\n        if (s.length !== 0) {\n          s += \" \";\n        }\n        s += this.weight ?? \"normal\";\n      }\n      if (this.stretch !== void 0) {\n        if (s.length !== 0) {\n          s += \" \";\n        }\n        s += this.stretch;\n      }\n      if (this.size !== null) {\n        if (s.length !== 0) {\n          s += \" \";\n        }\n        s += this.size.toString();\n        if (this.height !== null) {\n          s += \"/\";\n          s += this.height.toString();\n        }\n      }\n      if (typeof this.family === \"string\") {\n        if (s.length !== 0) {\n          s += \" \";\n        }\n        s += FontFamily.format(this.family);\n      } else if (Array.isArray(this.family) && this.family.length !== 0) {\n        if (s.length !== 0) {\n          s += \" \";\n        }\n        s += FontFamily.format(this.family[0]);\n        for (let i = 1; i < this.family.length; i += 1) {\n          s += \", \";\n          s += FontFamily.format(this.family[i]);\n        }\n      }\n      (this as Mutable<this>).stringValue = s;\n    }\n    return s;\n  }\n\n  static style(style: FontStyle | undefined, family: FontFamily | readonly FontFamily[]): Font {\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    return new Font(style, void 0, void 0, void 0, null, null, family);\n  }\n\n  static variant(variant: FontVariant | undefined, family: FontFamily | readonly FontFamily[]): Font {\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    return new Font(void 0, variant, void 0, void 0, null, null, family);\n  }\n\n  static weight(weight: FontWeight | undefined, family: FontFamily | readonly FontFamily[]): Font {\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    return new Font(void 0, void 0, weight, void 0, null, null, family);\n  }\n\n  static stretch(stretch: FontStretch | undefined, family: FontFamily | readonly FontFamily[]): Font {\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    return new Font(void 0, void 0, void 0, stretch, null, null, family);\n  }\n\n  static size(size: FontSizeLike | null, family: FontFamily | readonly FontFamily[]): Font {\n    size = size !== null ? FontSize.fromLike(size) : null;\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    return new Font(void 0, void 0, void 0, void 0, size as FontSize | null, null, family);\n  }\n\n  static family(family: FontFamily | readonly FontFamily[]): Font {\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    return new Font(void 0, void 0, void 0, void 0, null, null, family);\n  }\n\n  static create(style: FontStyle | undefined, variant: FontVariant | undefined,\n                weight: FontWeight | undefined, stretch: FontStretch | undefined,\n                size: FontSizeLike | null | undefined, height: LineHeightLike | null | undefined,\n                family: FontFamily | readonly FontFamily[]): Font {\n    size = size !== void 0 && size !== null ? FontSize.fromLike(size) : null;\n    height = height !== void 0 && height !== null ? LineHeight.fromLike(height) : null;\n    if (Array.isArray(family) && family.length === 1) {\n      family = family[0];\n    }\n    return new Font(style, variant, weight, stretch, size as FontSize | null,\n                    height as LineHeight | null, family);\n  }\n\n  static fromLike<T extends FontLike | null | undefined>(value: T): Font | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Font) {\n      return value as Font | Uninitable<T>;\n    } else if (typeof value === \"object\" && value !== null) {\n      return Font.fromInit(value);\n    } else if (typeof value === \"string\") {\n      return Font.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(init: FontInit): Font {\n    return Font.create(init.style, init.variant, init.weight, init.stretch,\n                       init.size, init.height, init.family);\n  }\n\n  static fromValue(value: Value): Font | null {\n    const header = value.header(\"font\");\n    if (!header.isDefined()) {\n      return null;\n    }\n    const style = header.get(\"style\").stringValue(void 0) as FontStyle | undefined;\n    const variant = header.get(\"variant\").stringValue(void 0) as FontVariant | undefined;\n    const weight = header.get(\"weight\").stringValue(void 0) as FontWeight | undefined;\n    const stretch = header.get(\"stretch\").stringValue(void 0) as FontStretch | undefined;\n    const size = FontSize.fromValue(header.get(\"size\"));\n    const height = LineHeight.fromValue(header.get(\"height\"));\n    const family = FontFamily.fromValue(header.get(\"family\"));\n    if (family === null) {\n      return null;\n    }\n    return Font.create(style, variant, weight, stretch, size, height, family);\n  }\n\n  static parse(string: string): Font {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = FontParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  @Lazy\n  static form(): Form<Font, FontLike> {\n    return new FontForm(void 0);\n  }\n}\n\n/** @internal */\nexport interface FontInterpolator extends Interpolator<Font> {\n  /** @internal */\n  readonly styleInterpolator: Interpolator<FontStyle | undefined>;\n  /** @internal */\n  readonly variantInterpolator: Interpolator<FontVariant | undefined>;\n  /** @internal */\n  readonly weightInterpolator: Interpolator<FontWeight | undefined>;\n  /** @internal */\n  readonly stretchInterpolator: Interpolator<FontStretch | undefined>;\n  /** @internal */\n  readonly sizeInterpolator: Interpolator<FontSize | null>;\n  /** @internal */\n  readonly heightInterpolator: Interpolator<LineHeight | null>;\n  /** @internal */\n  readonly familyInterpolator: Interpolator<FontFamily | readonly FontFamily[]>;\n\n  get 0(): Font;\n\n  get 1(): Font;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const FontInterpolator = (function (_super: typeof Interpolator) {\n  const FontInterpolator = function (f0: Font, f1: Font): FontInterpolator {\n    const interpolator = function (u: number): Font {\n      const style = interpolator.styleInterpolator(u);\n      const variant = interpolator.variantInterpolator(u);\n      const weight = interpolator.weightInterpolator(u);\n      const stretch = interpolator.stretchInterpolator(u);\n      const size = interpolator.sizeInterpolator(u);\n      const height = interpolator.heightInterpolator(u);\n      const family = interpolator.familyInterpolator(u);\n      return new Font(style, variant, weight, stretch, size, height, family);\n    } as FontInterpolator;\n    Object.setPrototypeOf(interpolator, FontInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).styleInterpolator = Interpolator(f0.style, f1.style);\n    (interpolator as Mutable<typeof interpolator>).variantInterpolator = Interpolator(f0.variant, f1.variant);\n    (interpolator as Mutable<typeof interpolator>).weightInterpolator = Interpolator(f0.weight, f1.weight);\n    (interpolator as Mutable<typeof interpolator>).stretchInterpolator = Interpolator(f0.stretch, f1.stretch);\n    (interpolator as Mutable<typeof interpolator>).sizeInterpolator = Interpolator(f0.size, f1.size);\n    (interpolator as Mutable<typeof interpolator>).heightInterpolator = Interpolator(f0.height, f1.height);\n    (interpolator as Mutable<typeof interpolator>).familyInterpolator = Interpolator(f0.family, f1.family);\n    return interpolator;\n  } as {\n    (f0: Font, f1: Font): FontInterpolator;\n\n    /** @internal */\n    prototype: FontInterpolator;\n  };\n\n  FontInterpolator.prototype = Object.create(_super.prototype);\n  FontInterpolator.prototype.constructor = FontInterpolator;\n\n  Object.defineProperty(FontInterpolator.prototype, 0, {\n    get(this: FontInterpolator): Font {\n      const style = this.styleInterpolator[0];\n      const variant = this.variantInterpolator[0];\n      const weight = this.weightInterpolator[0];\n      const stretch = this.stretchInterpolator[0];\n      const size = this.sizeInterpolator[0];\n      const height = this.heightInterpolator[0];\n      const family = this.familyInterpolator[0];\n      return new Font(style, variant, weight, stretch, size, height, family);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(FontInterpolator.prototype, 1, {\n    get(this: FontInterpolator): Font {\n      const style = this.styleInterpolator[1];\n      const variant = this.variantInterpolator[1];\n      const weight = this.weightInterpolator[1];\n      const stretch = this.stretchInterpolator[1];\n      const size = this.sizeInterpolator[1];\n      const height = this.heightInterpolator[1];\n      const family = this.familyInterpolator[1];\n      return new Font(style, variant, weight, stretch, size, height, family);\n    },\n    configurable: true,\n  });\n\n  FontInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof FontInterpolator) {\n      return this.styleInterpolator.equals(that.styleInterpolator)\n          && this.variantInterpolator.equals(that.variantInterpolator)\n          && this.weightInterpolator.equals(that.weightInterpolator)\n          && this.stretchInterpolator.equals(that.stretchInterpolator)\n          && this.sizeInterpolator.equals(that.sizeInterpolator)\n          && this.heightInterpolator.equals(that.heightInterpolator)\n          && this.familyInterpolator.equals(that.familyInterpolator);\n    }\n    return false;\n  };\n\n  return FontInterpolator;\n})(Interpolator);\n\n/** @internal */\nexport class FontForm extends Form<Font, FontLike> {\n  constructor(unit: Font | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n      configurable: true,\n    });\n  }\n\n  override readonly unit: Font | undefined;\n\n  override withUnit(unit: Font | undefined): Form<Font, FontLike> {\n    if (unit === this.unit) {\n      return this;\n    }\n    return new FontForm(unit);\n  }\n\n  override mold(font: FontLike): Item {\n    font = Font.fromLike(font);\n    const header = Record.create(7);\n    if (font.style !== void 0) {\n      header.slot(\"style\", font.style);\n    }\n    if (font.variant !== void 0) {\n      header.slot(\"variant\", font.variant);\n    }\n    if (font.weight !== void 0) {\n      header.slot(\"weight\", font.weight);\n    }\n    if (font.stretch !== void 0) {\n      header.slot(\"stretch\", font.stretch);\n    }\n    if (font.size instanceof Length) {\n      header.slot(\"size\", Length.form().mold(font.size));\n    } else if (font.size !== void 0) {\n      header.slot(\"size\", font.size);\n    }\n    if (font.height instanceof Length) {\n      header.slot(\"height\", Length.form().mold(font.height));\n    } else if (font.height !== void 0) {\n      header.slot(\"height\", font.height);\n    }\n    if (Array.isArray(font.family)) {\n      const family = Record.create(font.family.length);\n      for (let i = 0; i < font.family.length; i += 1) {\n        family.push(font.family[i]);\n      }\n      header.slot(\"family\", family);\n    } else {\n      header.slot(\"family\", font.family);\n    }\n    return Record.of(Attr.of(\"font\", header));\n  }\n\n  override cast(item: Item): Font | undefined {\n    const value = item.toValue();\n    let font: Font | null = null;\n    try {\n      font = Font.fromValue(value);\n      if (font === null) {\n        const string = value.stringValue();\n        if (string !== void 0) {\n          font = Font.parse(string);\n        }\n      }\n    } catch (e) {\n      // swallow\n    }\n    return font !== null ? font : void 0;\n  }\n}\n\n/** @internal */\nexport class FontFamilyParser extends Parser<FontFamily> {\n  private readonly output: Output<string> | undefined;\n  private readonly quote: number | undefined;\n  private readonly code: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(output?: Output<string>, quote?: number, code?: number, step?: number) {\n    super();\n    this.output = output;\n    this.quote = quote;\n    this.code = code;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<FontFamily> {\n    return FontFamilyParser.parse(input, this.output, this.quote, this.code, this.step);\n  }\n\n  static parse<I, V>(input: Input, output?: Output<string>, quote: number = 0,\n                     code: number = 0, step: number = 1): Parser<FontFamily> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (Unicode.isAlpha(c) || c === 45/*'-'*/) {\n          output = output || Unicode.stringOutput();\n          step = 2;\n        } else if (c === 34/*'\"'*/ || c === 39/*'\\''*/ && (quote === c || quote === 0)) {\n          input = input.step();\n          output = output || Unicode.stringOutput();\n          quote = c;\n          step = 3;\n        } else {\n          return Parser.error(Diagnostic.expected(\"font family\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"font family\", input));\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || c === 45/*'-'*/)) {\n        input = input.step();\n        output!.write(c);\n      }\n      if (!input.isEmpty()) {\n        return Parser.done(output!.bind());\n      }\n    }\n    string: do {\n      if (step === 3) {\n        while (input.isCont()) {\n          c = input.head();\n          if (c >= 0x20 && c !== quote && c !== 92/*'\\\\'*/) {\n            input = input.step();\n            output!.write(c);\n          } else {\n            break;\n          }\n        }\n        if (input.isCont()) {\n          if (c === quote) {\n            input = input.step();\n            return Parser.done(output!.bind());\n          } else if (c === 92/*'\\\\'*/) {\n            input = input.step();\n            step = 4;\n          } else {\n            return Parser.error(Diagnostic.expected(quote, input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(quote, input));\n        }\n      }\n      if (step === 4) {\n        if (input.isCont()) {\n          c = input.head();\n          if (Base16.isDigit(c)) {\n            step = 5;\n          } else if (c === 10/*'\\n'*/) {\n            input.step();\n            step = 3;\n            continue;\n          } else {\n            input.step();\n            output!.write(c);\n            step = 3;\n            continue;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(\"escape character\", input));\n        }\n      }\n      if (step >= 5) {\n        do {\n          if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n            input = input.step();\n            code = 16 * code + Base16.decodeDigit(c);\n            if (step <= 11) {\n              step += 1;\n              continue;\n            } else {\n              if (code === 0) {\n                return Parser.error(Diagnostic.message(\"zero escape\", input));\n              }\n              output!.write(code);\n              code = 0;\n              step = 3;\n              continue string;\n            }\n          } else if (!input.isEmpty()) {\n            return Parser.error(Diagnostic.unexpected(input));\n          }\n          break;\n        } while (true);\n      }\n      break;\n    } while (true);\n    return new FontFamilyParser(output, quote, code, step);\n  }\n}\n\n/** @internal */\nexport class FontParser extends Parser<Font> {\n  private readonly style: FontStyle | undefined;\n  private readonly variant: FontVariant | undefined;\n  private readonly weight: FontWeight | undefined;\n  private readonly stretch: FontStretch | undefined;\n  private readonly size: FontSize | undefined;\n  private readonly height: LineHeight | undefined;\n  private readonly family: FontFamily | FontFamily[] | undefined;\n  private readonly identOutput: Output<string> | undefined;\n  private readonly lengthParser: Parser<Length> | undefined;\n  private readonly familyParser: Parser<FontFamily> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(style?: FontStyle, variant?: FontVariant, weight?: FontWeight,\n              stretch?: FontStretch, size?: FontSize, height?: LineHeight,\n              family?: FontFamily | FontFamily[], identOutput?: Output<string>,\n              lengthParser?: Parser<Length>, familyParser?: Parser<FontFamily>,\n              step?: number) {\n    super();\n    this.style = style;\n    this.variant = variant;\n    this.weight = weight;\n    this.stretch = stretch;\n    this.size = size;\n    this.height = height;\n    this.family = family;\n    this.identOutput = identOutput;\n    this.lengthParser = lengthParser;\n    this.familyParser = familyParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<Font> {\n    return FontParser.parse(input, this.style, this.variant, this.weight,\n                            this.stretch, this.size, this.height, this.family,\n                            this.identOutput, this.lengthParser,\n                            this.familyParser, this.step);\n  }\n\n  static parse(input: Input, style?: FontStyle, variant?: FontVariant,\n               weight?: FontWeight, stretch?: FontStretch, size?: FontSize,\n               height?: LineHeight, family?: FontFamily | FontFamily[],\n               identOutput?: Output<string>, lengthParser?: Parser<Length>,\n               familyParser?: Parser<FontFamily>, step: number = 1): Parser<Font> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input.step();\n        }\n        if (input.isCont()) {\n          if (Unicode.isAlpha(c)) {\n            step = 2;\n          } else if (c === 34/*'\"'*/ || c === 39/*'\\''*/) {\n            step = 11;\n          } else {\n            step = 4;\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 2) {\n        identOutput = identOutput || Unicode.stringOutput();\n        while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || c === 45/*'-'*/)) {\n          input = input.step();\n          identOutput.write(c);\n        }\n        if (!input.isEmpty()) {\n          const ident = identOutput.bind();\n          identOutput = void 0;\n          switch (ident) {\n            case \"italic\":\n            case \"oblique\":\n              if (style === void 0) {\n                style = ident;\n              } else {\n                return Parser.error(Diagnostic.message(\"reapeated font style: \" + ident, input));\n              }\n              step = 3;\n              break;\n            case \"small-caps\":\n              if (variant === void 0) {\n                variant = ident;\n              } else {\n                return Parser.error(Diagnostic.message(\"reapeated font variant: \" + ident, input));\n              }\n              step = 3;\n              break;\n            case \"bold\":\n            case \"bolder\":\n            case \"lighter\":\n              if (weight === void 0) {\n                weight = ident;\n              } else {\n                return Parser.error(Diagnostic.message(\"reapeated font weight: \" + ident, input));\n              }\n              step = 3;\n              break;\n            case \"ultra-condensed\":\n            case \"extra-condensed\":\n            case \"semi-condensed\":\n            case \"condensed\":\n            case \"expanded\":\n            case \"semi-expanded\":\n            case \"extra-expanded\":\n            case \"ultra-expanded\":\n              if (stretch === void 0) {\n                stretch = ident;\n              } else {\n                return Parser.error(Diagnostic.message(\"reapeated font stretch: \" + ident, input));\n              }\n              step = 3;\n              break;\n            case \"normal\":\n              if (style === void 0) {\n                style = ident;\n              } else if (variant === void 0) {\n                variant = ident;\n              } else if (weight === void 0) {\n                weight = ident;\n              } else if (stretch === void 0) {\n                stretch = ident;\n              } else {\n                return Parser.error(Diagnostic.message(\"reapeated font property: \" + ident, input));\n              }\n              step = 3;\n              break;\n            case \"large\":\n            case \"larger\":\n            case \"medium\":\n            case \"small\":\n            case \"smaller\":\n            case \"x-large\":\n            case \"x-small\":\n            case \"xx-large\":\n            case \"xx-small\":\n              size = ident;\n              step = 5;\n              break;\n            default:\n              family = ident;\n              step = 12;\n          }\n        }\n      }\n      if (step === 3) {\n        if (input.isCont()) {\n          c = input.head();\n          if (Unicode.isSpace(c)) {\n            input.step();\n            step = 1;\n            continue;\n          } else {\n            return Parser.error(Diagnostic.expected(\"font property, size, or family\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 4) {\n        if (lengthParser === void 0) {\n          lengthParser = LengthParser.parse(input);\n        } else {\n          lengthParser = lengthParser.feed(input);\n        }\n        if (lengthParser.isDone()) {\n          const length = lengthParser.bind();\n          if (length.units === \"\") {\n            const value = length.value;\n            switch (value) {\n              case 100:\n              case 200:\n              case 300:\n              case 400:\n              case 500:\n              case 600:\n              case 700:\n              case 800:\n              case 900:\n                if (weight === void 0) {\n                  weight = String(value) as FontWeight;\n                } else {\n                  return Parser.error(Diagnostic.message(\"reapeated font weight: \" + value, input));\n                }\n                break;\n              default:\n                return Parser.error(Diagnostic.message(\"unknown font property: \" + value, input));\n            }\n            step = 3;\n            continue;\n          } else {\n            size = length;\n            lengthParser = void 0;\n            step = 5;\n          }\n        } else if (lengthParser.isError()) {\n          return lengthParser.asError();\n        }\n      }\n      if (step === 5) {\n        if (input.isCont()) {\n          c = input.head();\n          if (Unicode.isSpace(c)) {\n            input.step();\n            step = 6;\n          } else if (c === 47/*'/'*/) {\n            input.step();\n            step = 7;\n          } else {\n            return Parser.error(Diagnostic.expected(\"font family\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 6) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input.step();\n        }\n        if (input.isCont()) {\n          if (c === 47/*'/'*/) {\n            input.step();\n            step = 7;\n          } else {\n            step = 11;\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 7) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input.step();\n        }\n        if (input.isCont()) {\n          if (Unicode.isAlpha(c)) {\n            step = 8;\n          } else {\n            step = 9;\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 8) {\n        identOutput = identOutput || Unicode.stringOutput();\n        while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n          input = input.step();\n          identOutput.write(c);\n        }\n        if (!input.isEmpty()) {\n          const ident = identOutput.bind();\n          identOutput = void 0;\n          switch (ident) {\n            case \"normal\":\n              height = ident;\n              step = 10;\n              break;\n            default:\n              return Parser.error(Diagnostic.message(\"unknown line height: \" + ident, input));\n          }\n        }\n      }\n      if (step === 9) {\n        if (lengthParser === void 0) {\n          lengthParser = LengthParser.parse(input);\n        } else {\n          lengthParser = lengthParser.feed(input);\n        }\n        if (lengthParser.isDone()) {\n          height = lengthParser.bind();\n          lengthParser = void 0;\n          step = 10;\n        } else if (lengthParser.isError()) {\n          return lengthParser.asError();\n        }\n      }\n      if (step === 10) {\n        if (input.isCont()) {\n          c = input.head();\n          if (Unicode.isSpace(c)) {\n            input.step();\n            step = 11;\n          } else {\n            return Parser.error(Diagnostic.expected(\"font family\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 11) {\n        if (familyParser === void 0) {\n          familyParser = FontFamilyParser.parse(input);\n        } else {\n          familyParser = familyParser.feed(input);\n        }\n        if (familyParser.isDone()) {\n          if (Array.isArray(family)) {\n            family.push(familyParser.bind());\n          } else if (family !== void 0) {\n            family = [family!, familyParser.bind()];\n          } else {\n            family = familyParser.bind();\n          }\n          familyParser = void 0;\n          step = 12;\n        } else if (familyParser.isError()) {\n          return familyParser.asError();\n        }\n      }\n      if (step === 12) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input.step();\n        }\n        if (input.isCont() && c === 44/*','*/) {\n          input.step();\n          step = 11;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.done(Font.create(style, variant, weight, stretch, size, height, family!));\n        }\n      }\n      break;\n    } while (true);\n    return new FontParser(style, variant, weight, stretch, size, height, family,\n                          identOutput, lengthParser, familyParser, step);\n  }\n\n  static parseRest(input: Input, style?: FontStyle, variant?: FontVariant,\n                   weight?: FontWeight, stretch?: FontStretch, size?: FontSize,\n                   height?: LineHeight, family?: FontFamily | FontFamily[]): Parser<Font> {\n    const step = family !== void 0 ? 12 : size !== void 0 ? 5 : 3;\n    return FontParser.parse(input, style, variant, weight, stretch, size, height,\n                            family, void 0, void 0, void 0, step);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport type {HashCode} from \"@swim/util\";\nimport type {Equivalent} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport type {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport type {Output} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Base10} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport type {Item} from \"@swim/structure\";\nimport type {Value} from \"@swim/structure\";\nimport {Text} from \"@swim/structure\";\nimport {Form} from \"@swim/structure\";\nimport type {AngleLike} from \"@swim/math\";\nimport {Angle} from \"@swim/math\";\nimport {RgbColorInit} from \"./\"; // forward import\nimport {RgbColor} from \"./\"; // forward import\nimport {RgbColorInterpolator} from \"./\"; // forward import\nimport {RgbColorParser} from \"./\"; // forward import\nimport {HexColorParser} from \"./\"; // forward import\nimport {HslColorInit} from \"./\"; // forward import\nimport {HslColor} from \"./\"; // forward import\nimport {HslColorParser} from \"./\"; // forward import\n\n/** @public */\nexport type ColorLike = Color | ColorInit | string;\n\n/** @public */\nexport const ColorLike = {\n  [Symbol.hasInstance](instance: unknown): instance is ColorLike {\n    return instance instanceof Color\n        || ColorInit[Symbol.hasInstance](instance)\n        || typeof instance === \"string\";\n  },\n};\n\n/** @public */\nexport type ColorInit = RgbColorInit | HslColorInit;\n\n/** @public */\nexport const ColorInit = {\n  [Symbol.hasInstance](instance: unknown): instance is ColorInit {\n    return RgbColorInit[Symbol.hasInstance](instance)\n        || HslColorInit[Symbol.hasInstance](instance);\n  },\n};\n\n/** @public */\nexport abstract class Color implements Interpolate<Color>, HashCode, Equivalent, Debug {\n  likeType?(like: ColorInit | string): void;\n\n  abstract isDefined(): boolean;\n\n  abstract alpha(): number;\n  abstract alpha(a: number): Color;\n\n  abstract plus(that: ColorLike): Color;\n\n  abstract times(scalar: number): Color;\n\n  abstract combine(that: ColorLike, scalar?: number): Color;\n\n  abstract readonly lightness: number;\n\n  abstract lighter(k?: number): Color;\n\n  abstract darker(k?: number): Color;\n\n  contrast(k?: number): Color {\n    return this.lightness < 0.67 ? this.lighter(k) : this.darker(k);\n  }\n\n  abstract rgb(): RgbColor;\n\n  abstract hsl(): HslColor;\n\n  /** @override */\n  interpolateTo(that: Color): Interpolator<Color>;\n  interpolateTo(that: unknown): Interpolator<Color> | null;\n  interpolateTo(that: unknown): Interpolator<Color> | null {\n    if (that instanceof Color) {\n      return RgbColorInterpolator(this.rgb(), that.rgb());\n    }\n    return null;\n  }\n\n  /** @override */\n  abstract equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  /** @override */\n  abstract equals(other: unknown): boolean;\n\n  /** @override */\n  abstract hashCode(): number;\n\n  /** @override */\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  abstract toHexString(): string;\n\n  abstract toRgbString(): string;\n\n  abstract toHslString(): string;\n\n  /** @override */\n  abstract toString(): string;\n\n  static transparent(): Color {\n    return RgbColor.transparent();\n  }\n\n  static black(alpha?: number): Color {\n    return RgbColor.black(alpha);\n  }\n\n  static white(alpha?: number): Color {\n    return RgbColor.white(alpha);\n  }\n\n  static rgb(r: number, g: number, b: number, a?: number): RgbColor {\n    return new RgbColor(r, g, b, a);\n  }\n\n  static hsl(h: AngleLike, s: number, l: number, a?: number): HslColor {\n    if (typeof h !== \"number\") {\n      h = Angle.fromLike(h).degValue();\n    }\n    return new HslColor(h, s, l, a);\n  }\n\n  static forName(name: string): Color | null {\n    switch (name) {\n      case \"transparent\": return Color.transparent();\n      case \"black\": return Color.black();\n      case \"white\": return Color.white();\n      default: return null;\n    }\n  }\n\n  static fromLike<T extends ColorLike | null | undefined>(value: T): Color | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Color) {\n      return value as Color | Uninitable<T>;\n    } else if (typeof value === \"string\") {\n      return Color.parse(value);\n    }\n    return Color.fromInit(value);\n  }\n\n  static fromInit(value: ColorInit): Color {\n    if (RgbColorInit[Symbol.hasInstance](value)) {\n      return RgbColor.fromInit(value);\n    } else if (HslColorInit[Symbol.hasInstance](value)) {\n      return HslColor.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromValue(value: Value): Color | null {\n    let color: Color | null;\n    color = RgbColor.fromValue(value);\n    if (color === void 0) {\n      color = HslColor.fromValue(value);\n    }\n    return color;\n  }\n\n  static parse(string: string): Color {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = ColorParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  @Lazy\n  static form(): Form<Color, ColorLike> {\n    return new ColorForm(Color.transparent());\n  }\n\n  /** @internal */\n  static Darker: number = 0.7;\n  /** @internal */\n  static Brighter: number = 1 / this.Darker;\n}\n\n/** @internal */\nexport class ColorForm extends Form<Color, ColorLike> {\n  constructor(unit: Color | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n      configurable: true,\n    });\n  }\n\n  override readonly unit: Color | undefined;\n\n  override withUnit(unit: Color | undefined): Form<Color, ColorLike> {\n    if (unit === this.unit) {\n      return this;\n    }\n    return new ColorForm(unit);\n  }\n\n  override mold(color: ColorLike): Item {\n    color = Color.fromLike(color);\n    return Text.from(color.toString());\n  }\n\n  override cast(item: Item): Color | undefined {\n    const value = item.toValue();\n    let color: Color | null = null;\n    try {\n      color = Color.fromValue(value);\n      if (color === void 0) {\n        const string = value.stringValue(void 0);\n        if (string !== void 0) {\n          color = Color.parse(string);\n        }\n      }\n    } catch (e) {\n      // swallow\n    }\n    return color !== null ? color : void 0;\n  }\n}\n\n/** @internal */\nexport class ColorParser extends Parser<Color> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<Color> {\n    return ColorParser.parse(input, this.identOutput, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, step: number = 1): Parser<Color> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        if (input.head() === 35/*'#'*/) {\n          return HexColorParser.parse(input);\n        } else {\n          step = 2;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      identOutput = identOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        switch (ident) {\n          case \"rgb\":\n          case \"rgba\": return RgbColorParser.parseRest(input);\n          case \"hsl\":\n          case \"hsla\": return HslColorParser.parseRest(input);\n          default: {\n            const color = Color.forName(ident);\n            if (color !== null) {\n              return Parser.done(color);\n            } else {\n              return Parser.error(Diagnostic.message(\"unknown color: \" + ident, input));\n            }\n          }\n        }\n      }\n    }\n    return new ColorParser(identOutput, step);\n  }\n}\n\n/** @internal */\nexport class ColorChannel {\n  constructor(value: number, units?: string) {\n    this.value = value;\n    this.units = units !== void 0 ? units : \"\";\n  }\n\n  readonly value: number;\n\n  readonly units: string;\n\n  scale(k: number): number {\n    if (this.units === \"%\") {\n      return this.value * k / 100;\n    } else {\n      return this.value;\n    }\n  }\n}\n\n/** @internal */\nexport class ColorChannelParser extends Parser<ColorChannel> {\n  private readonly valueParser: Parser<number> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(valueParser?: Parser<number>, step?: number) {\n    super();\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<ColorChannel> {\n    return ColorChannelParser.parse(input, this.valueParser, this.step);\n  }\n\n  static parse(input: Input, valueParser?: Parser<number>, step: number = 1): Parser<ColorChannel> {\n    if (step === 1) {\n      if (valueParser === void 0) {\n        valueParser = Base10.parseNumber(input);\n      } else {\n        valueParser = valueParser.feed(input);\n      }\n      if (valueParser.isDone()) {\n        step = 2;\n      } else if (valueParser.isError()) {\n        return valueParser.asError();\n      }\n    }\n    if (step === 2) {\n      if (input.isCont() && input.head() === 37/*'%'*/) {\n        input = input.step();\n        return Parser.done(new ColorChannel(valueParser!.bind(), \"%\"));\n      } else if (!input.isEmpty()) {\n        return Parser.done(new ColorChannel(valueParser!.bind()));\n      }\n    }\n    return new ColorChannelParser(valueParser, step);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Murmur3} from \"@swim/util\";\nimport {Numbers} from \"@swim/util\";\nimport {Constructors} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport type {Output} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport {Base16} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport type {Item} from \"@swim/structure\";\nimport {Value} from \"@swim/structure\";\nimport type {ColorLike} from \"./Color\";\nimport {Color} from \"./Color\";\nimport type {ColorChannel} from \"./Color\";\nimport {ColorChannelParser} from \"./Color\";\nimport {HslColor} from \"./\"; // forward import\n\n/** @public */\nexport type RgbColorLike = RgbColor | RgbColorInit | string;\n\n/** @public */\nexport const RgbColorLike = {\n  [Symbol.hasInstance](instance: unknown): instance is RgbColorLike {\n    return instance instanceof RgbColor\n        || RgbColorInit[Symbol.hasInstance](instance)\n        || typeof instance === \"string\";\n  },\n};\n\n/** @public */\nexport interface RgbColorInit {\n  readonly r: number;\n  readonly g: number;\n  readonly b: number;\n  readonly a?: number;\n}\n\n/** @public */\nexport const RgbColorInit = {\n  [Symbol.hasInstance](instance: unknown): instance is RgbColorInit {\n    return Objects.hasAllKeys(instance, \"r\", \"g\", \"b\");\n  },\n};\n\n/** @public */\nexport class RgbColor extends Color {\n  constructor(r: number, g: number, b: number, a: number = 1) {\n    super();\n    this.r = r;\n    this.g = g;\n    this.b = b;\n    this.a = a;\n    this.stringValue = void 0;\n  }\n\n  override likeType?(like: RgbColorInit | string): void;\n\n  override isDefined(): boolean {\n    return isFinite(this.r) && isFinite(this.g)\n        && isFinite(this.b) && isFinite(this.a);\n  }\n\n  readonly r: number;\n\n  readonly g: number;\n\n  readonly b: number;\n\n  readonly a: number;\n\n  override alpha(): number;\n  override alpha(a: number): RgbColor;\n  override alpha(a?: number): number | RgbColor {\n    if (a === void 0) {\n      return this.a;\n    } else if (this.a === a) {\n      return this;\n    }\n    return new RgbColor(this.r, this.g, this.b, a);\n  }\n\n  override get lightness(): number {\n    const r = this.r / 255;\n    const g = this.g / 255;\n    const b = this.b / 255;\n    const min = Math.min(r, g, b);\n    const max = Math.max(r, g, b);\n    return (max + min) / 2;\n  }\n\n  override plus(that: ColorLike): RgbColor {\n    that = Color.fromLike(that).rgb();\n    return new RgbColor(this.r + (that as RgbColor).r, this.g + (that as RgbColor).g,\n                        this.b + (that as RgbColor).b, this.a + (that as RgbColor).a);\n  }\n\n  override times(scalar: number): RgbColor {\n    return new RgbColor(this.r * scalar, this.g * scalar, this.b * scalar, this.a * scalar);\n  }\n\n  override combine(that: ColorLike, scalar: number = 1): Color {\n    that = Color.fromLike(that).rgb();\n    return new RgbColor(this.r + (that as RgbColor).r * scalar, this.g + (that as RgbColor).g * scalar,\n                        this.b + (that as RgbColor).b * scalar, this.a + (that as RgbColor).a * scalar);\n  }\n\n  override lighter(k?: number): RgbColor {\n    k = k === void 0 ? Color.Brighter : Math.pow(Color.Brighter, k);\n    return k !== 1 ? new RgbColor(this.r * k, this.g * k, this.b * k, this.a) : this;\n  }\n\n  override darker(k?: number): RgbColor {\n    k = k === void 0 ? Color.Darker : Math.pow(Color.Darker, k);\n    return k !== 1 ? new RgbColor(this.r * k, this.g * k, this.b * k, this.a) : this;\n  }\n\n  override rgb(): RgbColor {\n    return this;\n  }\n\n  override hsl(): HslColor {\n    return HslColor.fromRgb(this.r, this.g, this.b, this.a);\n  }\n\n  override interpolateTo(that: Color): Interpolator<RgbColor>;\n  override interpolateTo(that: unknown): Interpolator<Color> | null;\n  override interpolateTo(that: unknown): Interpolator<Color> | null {\n    if (that instanceof Color) {\n      return RgbColorInterpolator(this, that);\n    }\n    return super.interpolateTo(that);\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Color) {\n      that = that.rgb();\n      return Numbers.equivalent(this.r, (that as RgbColor).r, epsilon)\n          && Numbers.equivalent(this.g, (that as RgbColor).g, epsilon)\n          && Numbers.equivalent(this.b, (that as RgbColor).b, epsilon)\n          && Numbers.equivalent(this.a, (that as RgbColor).a, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof RgbColor) {\n      return this.r === that.r && this.g === that.g && this.b === that.b && this.a === that.a;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(Constructors.hash(RgbColor),\n        Numbers.hash(this.r)), Numbers.hash(this.g)), Numbers.hash(this.b)), Numbers.hash(this.a)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Color\").write(46/*'.'*/).write(\"rgb\").write(40/*'('*/)\n                   .debug(this.r).write(\", \").debug(this.g).write(\", \").debug(this.b);\n    if (this.a !== 1) {\n      output = output.write(\", \").debug(this.a);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toHexString(): string {\n    const r = Math.min(Math.max(0, Math.round(this.r || 0)), 255);\n    const g = Math.min(Math.max(0, Math.round(this.g || 0)), 255);\n    const b = Math.min(Math.max(0, Math.round(this.b || 0)), 255);\n    let s = \"#\";\n    const base16Alphabet = Base16.lowercase.alphabet;\n    s += base16Alphabet.charAt(r >>> 4 & 0xf);\n    s += base16Alphabet.charAt(r & 0xf);\n    s += base16Alphabet.charAt(g >>> 4 & 0xf);\n    s += base16Alphabet.charAt(g & 0xf);\n    s += base16Alphabet.charAt(b >>> 4 & 0xf);\n    s += base16Alphabet.charAt(b & 0xf);\n    return s;\n  }\n\n  toRgbString(): string {\n    let a = this.a;\n    a = isNaN(a) ? 1 : Math.max(0, Math.min(this.a, 1));\n    let s = a === 1 ? \"rgb\" : \"rgba\";\n    s += \"(\";\n    s += Math.max(0, Math.min(Math.round(this.r || 0), 255));\n    s += \",\";\n    s += Math.max(0, Math.min(Math.round(this.g || 0), 255));\n    s += \",\";\n    s += Math.max(0, Math.min(Math.round(this.b || 0), 255));\n    if (a !== 1) {\n      s += \",\";\n      s += a;\n    }\n    s += \")\";\n    return s;\n  }\n\n  override toHslString(): string {\n    return this.hsl().toHslString();\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let s = this.stringValue;\n    if (s === void 0) {\n      let a = this.a;\n      a = isNaN(a) ? 1 : Math.max(0, Math.min(this.a, 1));\n      if (a === 1) {\n        s = this.toHexString();\n      } else {\n        s = this.toRgbString();\n      }\n      (this as Mutable<this>).stringValue = s;\n    }\n    return s;\n  }\n\n  @Lazy\n  static override transparent(): RgbColor {\n    return new RgbColor(0, 0, 0, 0);\n  }\n\n  static override black(alpha: number = 1): RgbColor {\n    return new RgbColor(0, 0, 0, alpha);\n  }\n\n  static override white(alpha: number = 1): RgbColor {\n    return new RgbColor(255, 255, 255, alpha);\n  }\n\n  static fromHsl(h: number, s: number, l: number, a?: number): RgbColor {\n    h = h % 360 + +(h < 0) * 360;\n    s = isNaN(h) || isNaN(s) ? 0 : s;\n    const m2 = l + (l < 0.5 ? l : 1 - l) * s;\n    const m1 = 2 * l - m2;\n    return new RgbColor(RgbColor.fromHslChannel(h >= 240 ? h - 240 : h + 120, m1, m2),\n                        RgbColor.fromHslChannel(h, m1, m2),\n                        RgbColor.fromHslChannel(h < 120 ? h + 240 : h - 120, m1, m2),\n                        a);\n  }\n\n  /** @internal */\n  static fromHslChannel(h: number, m1: number, m2: number): number {\n    return 255 * (h < 60 ? m1 + (m2 - m1) * h / 60\n                         : h < 180 ? m2\n                                   : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n                                             : m1);\n  }\n\n  static override fromLike<T extends RgbColorLike | null | undefined>(value: T): RgbColor | Uninitable<T>;\n  static override fromLike<T extends ColorLike | null | undefined>(value: T): never;\n  static override fromLike<T extends RgbColorLike | null | undefined>(value: T): RgbColor | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof RgbColor) {\n      return value as RgbColor | Uninitable<T>;\n    } else if (typeof value === \"string\") {\n      return RgbColor.parse(value);\n    } else if (RgbColorInit[Symbol.hasInstance](value)) {\n      return RgbColor.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromInit(value: RgbColorInit): RgbColor {\n    return new RgbColor(value.r, value.g, value.b, value.a);\n  }\n\n  static override fromValue(value: Value): RgbColor | null {\n    const tag = value.tag;\n    let positional: boolean;\n    if (tag === \"rgb\" || tag === \"rgba\") {\n      value = value.header(tag);\n      positional = true;\n    } else {\n      positional = false;\n    }\n    let r: number | undefined;\n    let g: number | undefined;\n    let b: number | undefined;\n    let a: number | undefined;\n    value.forEach(function (member: Item, index: number): void {\n      const key = member.key.stringValue();\n      if (key !== void 0) {\n        if (key === \"r\") {\n          r = member.toValue().numberValue(r);\n        } else if (key === \"g\") {\n          g = member.toValue().numberValue(g);\n        } else if (key === \"b\") {\n          b = member.toValue().numberValue(b);\n        } else if (key === \"a\") {\n          a = member.toValue().numberValue(a);\n        }\n      } else if (member instanceof Value && positional) {\n        if (index === 0) {\n          r = member.numberValue(r);\n        } else if (index === 1) {\n          g = member.numberValue(g);\n        } else if (index === 2) {\n          b = member.numberValue(b);\n        } else if (index === 3) {\n          a = member.numberValue(a);\n        }\n      }\n    });\n    if (r !== void 0 && g !== void 0 && b !== void 0) {\n      return new RgbColor(r, g, b, a);\n    }\n    return null;\n  }\n\n  static override parse(str: string): RgbColor {\n    return Color.parse(str).rgb();\n  }\n}\n\n/** @internal */\nexport const RgbColorInterpolator = (function (_super: typeof Interpolator) {\n  const RgbColorInterpolator = function (c0: Color, c1: Color): Interpolator<RgbColor> {\n    const rgb0 = c0.rgb();\n    const rgb1 = c1.rgb();\n    const interpolator = function (u: number): RgbColor {\n      const rgb0 = interpolator[0];\n      const rgb1 = interpolator[1];\n      const r = rgb0.r + u * (rgb1.r - rgb0.r);\n      const g = rgb0.g + u * (rgb1.g - rgb0.g);\n      const b = rgb0.b + u * (rgb1.b - rgb0.b);\n      const a = rgb0.a + u * (rgb1.a - rgb0.a);\n      return new RgbColor(r, g, b, a);\n    } as Interpolator<RgbColor>;\n    Object.setPrototypeOf(interpolator, RgbColorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = rgb0;\n    (interpolator as Mutable<typeof interpolator>)[1] = rgb1;\n    return interpolator;\n  } as {\n    (c0: Color, c1: Color): Interpolator<RgbColor>;\n\n    /** @internal */\n    prototype: Interpolator<RgbColor>;\n  };\n\n  RgbColorInterpolator.prototype = Object.create(_super.prototype);\n  RgbColorInterpolator.prototype.constructor = RgbColorInterpolator;\n\n  return RgbColorInterpolator;\n})(Interpolator);\n\n/** @internal */\nexport class RgbColorParser extends Parser<RgbColor> {\n  private readonly rParser: Parser<ColorChannel> | undefined;\n  private readonly gParser: Parser<ColorChannel> | undefined;\n  private readonly bParser: Parser<ColorChannel> | undefined;\n  private readonly aParser: Parser<ColorChannel> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(rParser?: Parser<ColorChannel>, gParser?: Parser<ColorChannel>,\n              bParser?: Parser<ColorChannel>, aParser?: Parser<ColorChannel>,\n              step?: number) {\n    super();\n    this.rParser = rParser;\n    this.gParser = gParser;\n    this.bParser = bParser;\n    this.aParser = aParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<RgbColor> {\n    return RgbColorParser.parse(input, this.rParser, this.gParser,\n                                this.bParser, this.aParser, this.step);\n  }\n\n  static parse(input: Input, rParser?: Parser<ColorChannel>, gParser?: Parser<ColorChannel>,\n               bParser?: Parser<ColorChannel>, aParser?: Parser<ColorChannel>,\n               step?: number): Parser<RgbColor> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont() && input.head() === 114/*'r'*/) {\n        input = input.step();\n        step = 2;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"r\", input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont() && input.head() === 103/*'g'*/) {\n        input = input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"g\", input));\n      }\n    }\n    if (step === 3) {\n      if (input.isCont() && input.head() === 98/*'b'*/) {\n        input = input.step();\n        step = 4;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"b\", input));\n      }\n    }\n    if (step === 4) {\n      if (input.isCont() && input.head() === 97/*'a'*/) {\n        input = input.step();\n        step = 5;\n      } else if (!input.isEmpty()) {\n        step = 5;\n      }\n    }\n    if (step === 5) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input = input.step();\n        step = 6;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    if (step === 6) {\n      if (rParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          rParser = ColorChannelParser.parse(input);\n        }\n      } else {\n        rParser = rParser.feed(input);\n      }\n      if (rParser !== void 0) {\n        if (rParser.isDone()) {\n          step = 7;\n        } else if (rParser.isError()) {\n          return rParser.asError();\n        }\n      }\n    }\n    if (step === 7) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 8;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 8) {\n      if (gParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          gParser = ColorChannelParser.parse(input);\n        }\n      } else {\n        gParser = gParser.feed(input);\n      }\n      if (gParser !== void 0) {\n        if (gParser.isDone()) {\n          step = 9;\n        } else if (gParser.isError()) {\n          return gParser.asError();\n        }\n      }\n    }\n    if (step === 9) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 10;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 10) {\n      if (bParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          bParser = ColorChannelParser.parse(input);\n        }\n      } else {\n        bParser = bParser.feed(input);\n      }\n      if (bParser !== void 0) {\n        if (bParser.isDone()) {\n          step = 11;\n        } else if (bParser.isError()) {\n          return bParser.asError();\n        }\n      }\n    }\n    if (step === 11) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 41/*')'*/) {\n          input = input.step();\n          return Parser.done(new RgbColor(rParser!.bind().scale(255),\n                                          gParser!.bind().scale(255),\n                                          bParser!.bind().scale(255)));\n        } else if (c === 44/*','*/ || c === 47/*'/'*/) {\n          input = input.step();\n        }\n        step = 12;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 12) {\n      if (aParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          aParser = ColorChannelParser.parse(input);\n        }\n      } else {\n        aParser = aParser.feed(input);\n      }\n      if (aParser !== void 0) {\n        if (aParser.isDone()) {\n          step = 13;\n        } else if (aParser.isError()) {\n          return aParser.asError();\n        }\n      }\n    }\n    if (step === 13) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 41/*')'*/) {\n        input = input.step();\n        return Parser.done(new RgbColor(rParser!.bind().scale(255),\n                                        gParser!.bind().scale(255),\n                                        bParser!.bind().scale(255),\n                                        aParser!.bind().scale(1)));\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new RgbColorParser(rParser, gParser, bParser, aParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input): Parser<RgbColor> {\n    return RgbColorParser.parse(input, void 0, void 0, void 0, void 0, 5);\n  }\n}\n\n/** @internal */\nexport class HexColorParser extends Parser<RgbColor> {\n  private readonly value: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(value?: number, step?: number) {\n    super();\n    this.value = value;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<RgbColor> {\n    return HexColorParser.parse(input, this.value, this.step);\n  }\n\n  static parse(input: Input, value: number = 0, step: number = 1): Parser<RgbColor> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont() && input.head() === 35/*'#'*/) {\n        input = input.step();\n        step = 2;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"#\", input));\n      }\n    }\n    if (step >= 2) {\n      while (step <= 9 && input.isCont()) {\n        c = input.head();\n        if (Base16.isDigit(c)) {\n          input = input.step();\n          value = (value << 4) | Base16.decodeDigit(c);\n          step += 1;\n        } else {\n          break;\n        }\n      }\n      if (!input.isEmpty()) {\n        if (step === 5) { // #xxx\n          return Parser.done(new RgbColor(value >> 8 & 0x0f | value >> 4 & 0xf0,\n                                          value >> 4 & 0x0f | value & 0xf0,\n                                          value << 4 & 0xf0 | value & 0x0f));\n        } else if (step === 6) { // #xxxx\n          return Parser.done(new RgbColor(value >> 12 & 0x0f | value >> 8 & 0xf0,\n                                          value >> 8 & 0x0f | value >> 4 & 0xf0,\n                                          value >> 4 & 0x0f | value & 0xf0,\n                                          (value << 4 & 0xf0 | value & 0x0f) / 255));\n        } else if (step === 8) { // #xxxxxx\n          return Parser.done(new RgbColor(value >> 16 & 0xff,\n                                          value >> 8 & 0xff,\n                                          value & 0xff));\n        } else if (step === 10) { // #xxxxxxxx\n          return Parser.done(new RgbColor(value >> 24 & 0xff,\n                                          value >> 16 & 0xff,\n                                          value >> 8 & 0xff,\n                                          (value & 0xff) / 255));\n        } else {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n    }\n    return new HexColorParser(value, step);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Murmur3} from \"@swim/util\";\nimport {Numbers} from \"@swim/util\";\nimport {Constructors} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport type {Output} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport type {Item} from \"@swim/structure\";\nimport {Value} from \"@swim/structure\";\nimport type {AngleLike} from \"@swim/math\";\nimport {Angle} from \"@swim/math\";\nimport {AngleParser} from \"@swim/math\";\nimport type {ColorLike} from \"./Color\";\nimport {Color} from \"./Color\";\nimport type {ColorChannel} from \"./Color\";\nimport {ColorChannelParser} from \"./Color\";\nimport {RgbColor} from \"./RgbColor\";\n\n/** @public */\nexport type HslColorLike = HslColor | HslColorInit | string;\n\n/** @public */\nexport const HslColorLike = {\n  [Symbol.hasInstance](instance: unknown): instance is HslColorLike {\n    return instance instanceof HslColor\n        || HslColorInit[Symbol.hasInstance](instance)\n        || typeof instance === \"string\";\n  },\n};\n\n/** @public */\nexport interface HslColorInit {\n  readonly h: AngleLike;\n  readonly s: number;\n  readonly l: number;\n  readonly a?: number;\n}\n\n/** @public */\nexport const HslColorInit = {\n  [Symbol.hasInstance](instance: unknown): instance is HslColorInit {\n    return Objects.hasAllKeys(instance, \"h\", \"s\", \"l\");\n  },\n};\n\n/** @public */\nexport class HslColor extends Color {\n  constructor(h: number, s: number, l: number, a: number = 1) {\n    super();\n    this.h = h;\n    this.s = s;\n    this.l = l;\n    this.a = a;\n    this.stringValue = void 0;\n  }\n\n  override likeType?(like: HslColorInit | string): void;\n\n  override isDefined(): boolean {\n    return isFinite(this.h) && isFinite(this.s)\n        && isFinite(this.l) && isFinite(this.a);\n  }\n\n  readonly h: number;\n\n  readonly s: number;\n\n  readonly l: number;\n\n  readonly a: number;\n\n  override alpha(): number;\n  override alpha(a: number): HslColor;\n  override alpha(a?: number): number | HslColor {\n    if (a === void 0) {\n      return this.a;\n    } else if (this.a === a) {\n      return this;\n    }\n    return new HslColor(this.h, this.s, this.l, a);\n  }\n\n  override get lightness(): number {\n    return this.l;\n  }\n\n  override plus(that: ColorLike): HslColor {\n    that = Color.fromLike(that).hsl();\n    return new HslColor(this.h + (that as HslColor).h, this.s + (that as HslColor).s,\n                        this.l + (that as HslColor).l, this.a + (that as HslColor).a);\n  }\n\n  override times(scalar: number): HslColor {\n    return new HslColor(this.h * scalar, this.s * scalar, this.l * scalar, this.a * scalar);\n  }\n\n  override combine(that: ColorLike, scalar: number = 1): HslColor {\n    that = Color.fromLike(that).hsl();\n    return new HslColor(this.h + (that as HslColor).h * scalar, this.s + (that as HslColor).s * scalar,\n                        this.l + (that as HslColor).l * scalar, this.a + (that as HslColor).a * scalar);\n  }\n\n  override lighter(k?: number): HslColor {\n    k = k === void 0 ? Color.Brighter : Math.pow(Color.Brighter, k);\n    return k !== 1 ? new HslColor(this.h, this.s, this.l * k, this.a) : this;\n  }\n\n  override darker(k?: number): HslColor {\n    k = k === void 0 ? Color.Darker : Math.pow(Color.Darker, k);\n    return k !== 1 ? new HslColor(this.h, this.s, this.l * k, this.a) : this;\n  }\n\n  override rgb(): RgbColor {\n    return RgbColor.fromHsl(this.h, this.s, this.l, this.a);\n  }\n\n  override hsl(): HslColor {\n    return this;\n  }\n\n  override interpolateTo(that: Color): Interpolator<HslColor>;\n  override interpolateTo(that: unknown): Interpolator<Color> | null;\n  override interpolateTo(that: unknown): Interpolator<Color> | null {\n    if (that instanceof Color) {\n      return HslColorInterpolator(this, that);\n    }\n    return super.interpolateTo(that);\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Color) {\n      that = that.hsl();\n      return Numbers.equivalent(this.h, (that as HslColor).h, epsilon)\n          && Numbers.equivalent(this.s, (that as HslColor).s, epsilon)\n          && Numbers.equivalent(this.l, (that as HslColor).l, epsilon)\n          && Numbers.equivalent(this.a, (that as HslColor).a, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof HslColor) {\n      return this.h === that.h && this.s === that.s && this.l === that.l && this.a === that.a;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(Constructors.hash(HslColor),\n        Numbers.hash(this.h)), Numbers.hash(this.s)), Numbers.hash(this.l)), Numbers.hash(this.a)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Color\").write(46/*'.'*/).write(\"hsl\").write(40/*'('*/)\n                   .debug(this.h).write(\", \").debug(this.s).write(\", \").debug(this.l);\n    if (this.a !== 1) {\n      output = output.write(\", \").debug(this.a);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toHexString(): string {\n    return this.rgb().toHexString();\n  }\n\n  override toRgbString(): string {\n    return this.rgb().toRgbString();\n  }\n\n  override toHslString(): string {\n    let a = this.a;\n    a = isNaN(a) ? 1 : Math.max(0, Math.min(this.a, 1));\n    let s = a === 1 ? \"hsl\" : \"hsla\";\n    s += \"(\";\n    s += Math.max(0, Math.min(Math.round(this.h || 0), 360));\n    s += \",\";\n    s += Math.max(0, Math.min(Math.round(100 * (this.s || 0)), 100)) + \"%\";\n    s += \",\";\n    s += Math.max(0, Math.min(Math.round(100 * (this.l || 0)), 100)) + \"%\";\n    if (a !== 1) {\n      s += \",\";\n      s += a;\n    }\n    s += \")\";\n    return s;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let s = this.stringValue;\n    if (s === void 0) {\n      s = this.toHslString();\n      (this as Mutable<this>).stringValue = s;\n    }\n    return s;\n  }\n\n  @Lazy\n  static override transparent(): HslColor {\n    return new HslColor(0, 0, 0, 0);\n  }\n\n  static override black(alpha: number = 1): HslColor {\n    return new HslColor(0, 0, 0, alpha);\n  }\n\n  static override white(alpha: number = 1): HslColor {\n    return new HslColor(0, 1, 1, alpha);\n  }\n\n  static fromRgb(r: number, g: number, b: number, a?: number): HslColor {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    const min = Math.min(r, g, b);\n    const max = Math.max(r, g, b);\n    let h = NaN;\n    let s = max - min;\n    const l = (max + min) / 2;\n    if (s !== 0) {\n      if (r === max) {\n        h = (g - b) / s + +(g < b) * 6;\n      } else if (g === max) {\n        h = (b - r) / s + 2;\n      } else {\n        h = (r - g) / s + 4;\n      }\n      s /= l < 0.5 ? max + min : 2 - (max + min);\n      h *= 60;\n    } else {\n      s = l > 0 && l < 1 ? 0 : h;\n    }\n    return new HslColor(h, s, l, a);\n  }\n\n  static override fromLike<T extends HslColorLike | null | undefined>(value: T): HslColor | Uninitable<T>;\n  static override fromLike<T extends ColorLike | null | undefined>(value: T): never;\n  static override fromLike<T extends HslColorLike | null | undefined>(value: T): HslColor | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof HslColor) {\n      return value as HslColor | Uninitable<T>;\n    } else if (typeof value === \"string\") {\n      return HslColor.parse(value);\n    } else if (HslColorInit[Symbol.hasInstance](value)) {\n      return HslColor.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromInit(value: HslColorInit): HslColor {\n    const h = typeof value.h === \"number\" ? value.h : Angle.fromLike(value.h).degValue();\n    return new HslColor(h, value.s, value.l, value.a);\n  }\n\n  static override fromValue(value: Value): HslColor | null {\n    const tag = value.tag;\n    let positional: boolean;\n    if (tag === \"hsl\" || tag === \"hsla\") {\n      value = value.header(tag);\n      positional = true;\n    } else {\n      positional = false;\n    }\n    let h: Angle | undefined;\n    let s: number | undefined;\n    let l: number | undefined;\n    let a: number | undefined;\n    value.forEach(function (member: Item, index: number): void {\n      const key = member.key.stringValue();\n      if (key !== void 0) {\n        if (key === \"h\") {\n          h = member.toValue().cast(Angle.form(), h);\n        } else if (key === \"s\") {\n          s = member.toValue().numberValue(s);\n        } else if (key === \"l\") {\n          l = member.toValue().numberValue(l);\n        } else if (key === \"a\") {\n          a = member.toValue().numberValue(a);\n        }\n      } else if (member instanceof Value && positional) {\n        if (index === 0) {\n          h = member.cast(Angle.form(), h);\n        } else if (index === 1) {\n          s = member.numberValue(s);\n        } else if (index === 2) {\n          l = member.numberValue(l);\n        } else if (index === 3) {\n          a = member.numberValue(a);\n        }\n      }\n    });\n    if (h !== void 0 && s !== void 0 && l !== void 0) {\n      return new HslColor(h.degValue(), s, l, a);\n    }\n    return null;\n  }\n\n  static override parse(str: string): HslColor {\n    return Color.parse(str).hsl();\n  }\n}\n\n/** @internal */\nexport const HslColorInterpolator = (function (_super: typeof Interpolator) {\n  const HslColorInterpolator = function (c0: Color, c1: Color): Interpolator<HslColor> {\n    const hsl0 = c0.hsl();\n    const hsl1 = c1.hsl();\n    const interpolator = function (u: number): HslColor {\n      const hsl0 = interpolator[0];\n      const hsl1 = interpolator[1];\n      const h = hsl0.h + u * (hsl1.h - hsl0.h);\n      const s = hsl0.s + u * (hsl1.s - hsl0.s);\n      const l = hsl0.l + u * (hsl1.l - hsl0.l);\n      const a = hsl0.a + u * (hsl1.a - hsl0.a);\n      return new HslColor(h, s, l, a);\n    } as Interpolator<HslColor>;\n    Object.setPrototypeOf(interpolator, HslColorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = hsl0;\n    (interpolator as Mutable<typeof interpolator>)[1] = hsl1;\n    return interpolator;\n  } as {\n    (c0: Color, c1: Color): Interpolator<HslColor>;\n\n    /** @internal */\n    prototype: Interpolator<HslColor>;\n  };\n\n  HslColorInterpolator.prototype = Object.create(_super.prototype);\n  HslColorInterpolator.prototype.constructor = HslColorInterpolator;\n\n  return HslColorInterpolator;\n})(Interpolator);\n\n/** @internal */\nexport class HslColorParser extends Parser<HslColor> {\n  private readonly hParser: Parser<Angle> | undefined;\n  private readonly sParser: Parser<ColorChannel> | undefined;\n  private readonly lParser: Parser<ColorChannel> | undefined;\n  private readonly aParser: Parser<ColorChannel> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(hParser?: Parser<Angle>, sParser?: Parser<ColorChannel>,\n              lParser?: Parser<ColorChannel>, aParser?: Parser<ColorChannel>,\n              step?: number) {\n    super();\n    this.hParser = hParser;\n    this.sParser = sParser;\n    this.lParser = lParser;\n    this.aParser = aParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<HslColor> {\n    return HslColorParser.parse(input, this.hParser, this.sParser,\n                                this.lParser, this.aParser, this.step);\n  }\n\n  static parse(input: Input, hParser?: Parser<Angle>, sParser?: Parser<ColorChannel>,\n               lParser?: Parser<ColorChannel>, aParser?: Parser<ColorChannel>,\n               step?: number): Parser<HslColor> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont() && input.head() === 104/*'h'*/) {\n        input = input.step();\n        step = 2;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"h\", input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont() && input.head() === 115/*'s'*/) {\n        input = input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"s\", input));\n      }\n    }\n    if (step === 3) {\n      if (input.isCont() && input.head() === 108/*'l'*/) {\n        input = input.step();\n        step = 4;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"l\", input));\n      }\n    }\n    if (step === 4) {\n      if (input.isCont() && input.head() === 97/*'a'*/) {\n        input = input.step();\n        step = 5;\n      } else if (!input.isEmpty()) {\n        step = 5;\n      }\n    }\n    if (step === 5) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input = input.step();\n        step = 6;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    if (step === 6) {\n      if (hParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          hParser = AngleParser.parse(input, \"deg\");\n        }\n      } else {\n        hParser = hParser.feed(input);\n      }\n      if (hParser !== void 0) {\n        if (hParser.isDone()) {\n          step = 7;\n        } else if (hParser.isError()) {\n          return hParser.asError();\n        }\n      }\n    }\n    if (step === 7) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 8;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 8) {\n      if (sParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          sParser = ColorChannelParser.parse(input);\n        }\n      } else {\n        sParser = sParser.feed(input);\n      }\n      if (sParser !== void 0) {\n        if (sParser.isDone()) {\n          if (sParser.bind().units === \"%\") {\n            step = 9;\n          } else {\n            return Parser.error(Diagnostic.expected(\"%\", input));\n          }\n        } else if (sParser.isError()) {\n          return sParser.asError();\n        }\n      }\n    }\n    if (step === 9) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 10;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 10) {\n      if (lParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          lParser = ColorChannelParser.parse(input);\n        }\n      } else {\n        lParser = lParser.feed(input);\n      }\n      if (lParser !== void 0) {\n        if (lParser.isDone()) {\n          if (lParser.bind().units === \"%\") {\n            step = 11;\n          } else {\n            return Parser.error(Diagnostic.expected(\"%\", input));\n          }\n        } else if (lParser.isError()) {\n          return lParser.asError();\n        }\n      }\n    }\n    if (step === 11) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 41/*')'*/) {\n          input = input.step();\n          return Parser.done(new HslColor(hParser!.bind().degValue(),\n                                          sParser!.bind().scale(1),\n                                          lParser!.bind().scale(1)));\n        } else if (c === 44/*','*/ || c === 47/*'/'*/) {\n          input = input.step();\n        }\n        step = 12;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 12) {\n      if (aParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          aParser = ColorChannelParser.parse(input);\n        }\n      } else {\n        aParser = aParser.feed(input);\n      }\n      if (aParser !== void 0) {\n        if (aParser.isDone()) {\n          step = 13;\n        } else if (aParser.isError()) {\n          return aParser.asError();\n        }\n      }\n    }\n    if (step === 13) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 41/*')'*/) {\n        input = input.step();\n        return Parser.done(new HslColor(hParser!.bind().degValue(),\n                                        sParser!.bind().scale(1),\n                                        lParser!.bind().scale(1),\n                                        aParser!.bind().scale(1)));\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new HslColorParser(hParser, sParser, lParser, aParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input): Parser<HslColor> {\n    return HslColorParser.parse(input, void 0, void 0, void 0, void 0, 5);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport {Equivalent} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport {LengthParser} from \"@swim/math\";\nimport {ColorLike} from \"./Color\";\nimport {Color} from \"./Color\";\nimport {ColorParser} from \"./Color\";\n\n/** @public */\nexport type ColorStopLike = ColorStop | ColorStopInit | ColorStopTuple | string;\n\n/** @public */\nexport const ColorStopLike = {\n  [Symbol.hasInstance](instance: unknown): instance is ColorStopLike {\n    return instance instanceof ColorStop\n        || ColorStopInit[Symbol.hasInstance](instance)\n        || ColorStopTuple[Symbol.hasInstance](instance)\n        || typeof instance === \"string\";\n  },\n};\n\n/** @public */\nexport interface ColorStopInit {\n  color: ColorLike;\n  stop?: LengthLike;\n  hint?: LengthLike;\n}\n\n/** @public */\nexport const ColorStopInit = {\n  [Symbol.hasInstance](instance: unknown): instance is ColorStopInit {\n    return Objects.hasAllKeys(instance, \"color\");\n  },\n};\n\n/** @public */\nexport type ColorStopTuple = [ColorLike, LengthLike | null];\n\n/** @public */\nexport const ColorStopTuple = {\n  [Symbol.hasInstance](instance: unknown): instance is ColorStopTuple {\n    return Array.isArray(instance) && instance.length === 2\n        && ColorLike[Symbol.hasInstance](instance[0])\n        && (instance[1] === null || LengthLike[Symbol.hasInstance](instance[1]));\n  },\n};\n\n/** @public */\nexport class ColorStop implements Interpolate<ColorStop>, Equals, Equivalent {\n  constructor(color: Color, stop: Length | null, hint: Length | null) {\n    this.color = color;\n    this.stop = stop;\n    this.hint = hint;\n  }\n\n  likeType?(like: ColorStopInit | ColorStopTuple | string): void;\n\n  readonly color: Color;\n\n  withColor(color: ColorLike): ColorStop {\n    color = Color.fromLike(color);\n    return new ColorStop(color, this.stop, this.hint);\n  }\n\n  readonly stop: Length | null;\n\n  withStop(stop: LengthLike | null): ColorStop {\n    stop = Length.fromLike(stop, \"%\");\n    return new ColorStop(this.color, stop, this.hint);\n  }\n\n  readonly hint: Length | null;\n\n  withHint(hint: LengthLike | null): ColorStop {\n    hint = Length.fromLike(hint, \"%\");\n    return new ColorStop(this.color, this.stop, hint);\n  }\n\n  /** @override */\n  interpolateTo(that: ColorStop): Interpolator<ColorStop>;\n  interpolateTo(that: unknown): Interpolator<ColorStop> | null;\n  interpolateTo(that: unknown): Interpolator<ColorStop> | null {\n    if (that instanceof ColorStop) {\n      return ColorStopInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ColorStop) {\n      return Equivalent(this.color, that.color, epsilon)\n          && Equivalent(this.stop, that.stop, epsilon)\n          && Equivalent(this.hint, that.hint, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ColorStop) {\n      return this.color.equals(that.color)\n          && Equals(this.stop, that.stop)\n          && Equals(this.hint, that.hint);\n    }\n    return false;\n  }\n\n  /** @override */\n  toString(): string {\n    let s = \"\";\n    if (this.hint !== null) {\n      s += this.hint.toString();\n      s += \", \";\n    }\n    s += this.color.toString();\n    if (this.stop !== null) {\n      s += \" \";\n      s += this.stop.toString();\n    }\n    return s;\n  }\n\n  static create(color: ColorLike, stop: LengthLike | null = null,\n                hint: LengthLike | null = null): ColorStop {\n    color = Color.fromLike(color);\n    stop = Length.fromLike(stop, \"%\");\n    hint = Length.fromLike(hint, \"%\");\n    return new ColorStop(color, stop, hint);\n  }\n\n  static fromLike<T extends ColorStopLike | null | undefined>(value: T): ColorStop | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof ColorStop) {\n      return value as ColorStop | Uninitable<T>;\n    } else if (typeof value === \"string\") {\n      return ColorStop.parse(value);\n    } else if (ColorStopInit[Symbol.hasInstance](value)) {\n      return ColorStop.fromInit(value);\n    } else if (ColorStopTuple[Symbol.hasInstance](value)) {\n      return ColorStop.fromTuple(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(init: ColorStopInit): ColorStop {\n    const color = Color.fromLike(init.color);\n    const stop = init.stop !== void 0 ? Length.fromLike(init.stop, \"%\") : null;\n    const hint = init.hint !== void 0 ? Length.fromLike(init.hint, \"%\") : null;\n    return new ColorStop(color, stop, hint);\n  }\n\n  static fromTuple(value: ColorStopTuple): ColorStop {\n    const color = Color.fromLike(value[0]);\n    const stop = Length.fromLike(value[1], \"%\");\n    return new ColorStop(color, stop, null);\n  }\n\n  static parse(string: string): ColorStop {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = ColorStopParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  static parseHint(string: string): ColorStop {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = ColorStopParser.parseHint(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  static parseList(string: string): ColorStop[] {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = ColorStopListParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n\n/** @internal */\nexport interface ColorStopInterpolator extends Interpolator<ColorStop> {\n  /** @internal */\n  readonly colorInterpolator: Interpolator<Color>;\n  /** @internal */\n  readonly stopInterpolator: Interpolator<Length | null>;\n  /** @internal */\n  readonly hintInterpolator: Interpolator<Length | null>;\n\n  readonly 0: ColorStop;\n\n  readonly 1: ColorStop;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const ColorStopInterpolator = (function (_super: typeof Interpolator) {\n  const ColorStopInterpolator = function (y0: ColorStop, y1: ColorStop): ColorStopInterpolator {\n    const interpolator = function (u: number): ColorStop {\n      const color = interpolator.colorInterpolator(u);\n      const stop = interpolator.stopInterpolator(u);\n      const hint = interpolator.hintInterpolator(u);\n      return new ColorStop(color, stop, hint);\n    } as ColorStopInterpolator;\n    Object.setPrototypeOf(interpolator, ColorStopInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).colorInterpolator = y0.color.interpolateTo(y1.color);\n    (interpolator as Mutable<typeof interpolator>).stopInterpolator = Interpolator(y0.stop, y1.stop);\n    (interpolator as Mutable<typeof interpolator>).hintInterpolator = Interpolator(y0.hint, y1.hint);\n    return interpolator;\n  } as {\n    (y0: ColorStop, y1: ColorStop): ColorStopInterpolator;\n\n    /** @internal */\n    prototype: ColorStopInterpolator;\n  };\n\n  ColorStopInterpolator.prototype = Object.create(_super.prototype);\n  ColorStopInterpolator.prototype.constructor = ColorStopInterpolator;\n\n  Object.defineProperty(ColorStopInterpolator.prototype, 0, {\n    get(this: ColorStopInterpolator): ColorStop {\n      const color = this.colorInterpolator[0];\n      const stop = this.stopInterpolator[0];\n      const hint = this.hintInterpolator[0];\n      return new ColorStop(color, stop, hint);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ColorStopInterpolator.prototype, 1, {\n    get(this: ColorStopInterpolator): ColorStop {\n      const color = this.colorInterpolator[1];\n      const stop = this.stopInterpolator[1];\n      const hint = this.hintInterpolator[1];\n      return new ColorStop(color, stop, hint);\n    },\n    configurable: true,\n  });\n\n  ColorStopInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ColorStopInterpolator) {\n      return this.colorInterpolator.equals(that.colorInterpolator)\n          && this.stopInterpolator.equals(that.stopInterpolator)\n          && this.hintInterpolator.equals(that.hintInterpolator);\n    }\n    return false;\n  };\n\n  return ColorStopInterpolator;\n})(Interpolator);\n\n/** @internal */\nexport class ColorStopParser extends Parser<ColorStop> {\n  private readonly colorParser: Parser<Color> | undefined;\n  private readonly stopParser: Parser<Length> | undefined;\n  private readonly hintParser: Parser<Length> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(colorParser?: Parser<Color>, stopParser?: Parser<Length>,\n              hintParser?: Parser<Length>, step?: number) {\n    super();\n    this.colorParser = colorParser;\n    this.stopParser = stopParser;\n    this.hintParser = hintParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<ColorStop> {\n    return ColorStopParser.parse(input, this.colorParser, this.stopParser,\n                                 this.hintParser, this.step);\n  }\n\n  static parse(input: Input, colorParser?: Parser<Color>, stopParser?: Parser<Length>,\n               hintParser?: Parser<Length>, step: number = 4): Parser<ColorStop> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input.step();\n      }\n      if (input.isCont()) {\n        if (c === 45/*'-'*/ || c === 46/*'.'*/ || c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          step = 2;\n        } else {\n          step = 7;\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (hintParser === void 0) {\n        hintParser = LengthParser.parse(input);\n      } else {\n        hintParser = hintParser.feed(input);\n      }\n      if (hintParser !== void 0) {\n        if (hintParser.isDone()) {\n          step = 3;\n        } else if (hintParser.isError()) {\n          return hintParser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input.step();\n          step = 4;\n        } else {\n          stopParser = hintParser;\n          hintParser = void 0;\n          step = 7;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input.step();\n      }\n      if (input.isCont()) {\n        if (c === 45/*'-'*/ || c === 46/*'.'*/ || c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          step = 5;\n        } else {\n          step = 7;\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 5) {\n      if (stopParser === void 0) {\n        stopParser = LengthParser.parse(input);\n      } else {\n        stopParser = stopParser.feed(input);\n      }\n      if (stopParser !== void 0) {\n        if (stopParser.isDone()) {\n          step = 6;\n        } else if (stopParser.isError()) {\n          return stopParser.asError();\n        }\n      }\n    }\n    if (step === 6) {\n      if (input.isCont()) {\n        if (Unicode.isSpace(input.head())) {\n          input.step();\n          step = 7;\n        } else {\n          return Parser.error(Diagnostic.expected(\"color\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 7) {\n      if (colorParser === void 0) {\n        colorParser = ColorParser.parse(input);\n      } else {\n        colorParser = colorParser.feed(input);\n      }\n      if (colorParser !== void 0) {\n        if (colorParser.isDone()) {\n          if (stopParser !== void 0) {\n            const hint = hintParser !== void 0 ? hintParser.bind() : null;\n            return Parser.done(new ColorStop(colorParser.bind(), stopParser.bind(), hint));\n          } else {\n            step = 8;\n          }\n        } else if (colorParser.isError()) {\n          return colorParser.asError();\n        }\n      }\n    }\n    if (step === 8) {\n      if (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n        step = 9;\n      } else if (!input.isEmpty()) {\n        const hint = hintParser !== void 0 ? hintParser.bind() : null;\n        return Parser.done(new ColorStop(colorParser!.bind(), null, hint));\n      }\n    }\n    if (step === 9) {\n      if (stopParser === void 0) {\n        stopParser = LengthParser.parse(input);\n      } else {\n        stopParser = stopParser.feed(input);\n      }\n      if (stopParser !== void 0) {\n        if (stopParser.isDone()) {\n          const hint = hintParser !== void 0 ? hintParser.bind() : null;\n          return Parser.done(new ColorStop(colorParser!.bind(), stopParser.bind(), hint));\n        } else if (stopParser.isError()) {\n          return stopParser.asError();\n        }\n      }\n    }\n    return new ColorStopParser(colorParser, stopParser, hintParser, step);\n  }\n\n  static parseHint(input: Input): Parser<ColorStop> {\n    return ColorStopParser.parse(input, void 0, void 0, void 0, 1);\n  }\n}\n\n/** @internal */\nexport class ColorStopListParser extends Parser<ColorStop[]> {\n  private readonly stops: readonly ColorStop[] | undefined;\n  private readonly stopParser: Parser<ColorStop> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(stops?: readonly ColorStop[], stopParser?: Parser<ColorStop>, step?: number) {\n    super();\n    this.stops = stops;\n    this.stopParser = stopParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<ColorStop[]> {\n    return ColorStopListParser.parse(input, this.stops !== void 0 ? this.stops.slice(0) : void 0,\n                                     this.stopParser, this.step);\n  }\n\n  static parse(input: Input, stops?: ColorStop[], stopParser?: Parser<ColorStop>,\n               step: number = 1): Parser<ColorStop[]> {\n    let c = 0;\n    if (step === 1) {\n      if (stopParser === void 0) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          stopParser = ColorStopParser.parse(input);\n        }\n      } else {\n        stopParser = stopParser.feed(input);\n      }\n      if (stopParser !== void 0) {\n        if (stopParser.isDone()) {\n          if (stops === void 0) {\n            stops = [];\n          }\n          stops.push(stopParser.bind());\n          stopParser = void 0;\n          step = 2;\n        } else if (stopParser.isError()) {\n          return stopParser.asError();\n        }\n      }\n    }\n    do {\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont() && c === 44/*','*/) {\n          input = input.step();\n          step = 3;\n        } else {\n          return Parser.done(stops!);\n        }\n      }\n      if (step === 3) {\n        if (stopParser === void 0) {\n          while (input.isCont() && Unicode.isSpace(input.head())) {\n            input.step();\n          }\n          if (!input.isEmpty()) {\n            stopParser = ColorStopParser.parseHint(input);\n          }\n        } else {\n          stopParser = stopParser.feed(input);\n        }\n        if (stopParser !== void 0) {\n          if (stopParser.isDone()) {\n            stops!.push(stopParser.bind());\n            stopParser = void 0;\n            step = 2;\n            continue;\n          } else if (stopParser.isError()) {\n            return stopParser.asError();\n          }\n        }\n      }\n      break;\n    } while (true);\n    return new ColorStopListParser(stops, stopParser, step);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {Equivalent} from \"@swim/util\";\nimport {Arrays} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport {Values} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport type {Output} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport {Angle} from \"@swim/math\";\nimport {AngleParser} from \"@swim/math\";\nimport type {ColorStopLike} from \"./ColorStop\";\nimport {ColorStop} from \"./ColorStop\";\nimport {ColorStopListParser} from \"./ColorStop\";\n\n/** @public */\nexport type LinearGradientAngleLike = LinearGradientAngle | number;\n\n/** @public */\nexport type LinearGradientAngle = Angle | LinearGradientSide | LinearGradientCorner;\n\n/** @public */\nexport type LinearGradientCorner = [LinearGradientSide, LinearGradientSide];\n\n/** @public */\nexport type LinearGradientSide = \"left\" | \"right\" | \"top\" | \"bottom\";\n\n/** @public */\nexport type LinearGradientLike = LinearGradient | LinearGradientInit | string;\n\n/** @public */\nexport const LinearGradientLike = {\n  [Symbol.hasInstance](instance: unknown): instance is LinearGradientLike {\n    return instance instanceof LinearGradient\n        || LinearGradientInit[Symbol.hasInstance](instance)\n        || typeof instance === \"string\";\n  },\n};\n\n/** @public */\nexport interface LinearGradientInit {\n  angle: LinearGradientAngleLike;\n  stops: ColorStopLike[];\n}\n\n/** @public */\nexport const LinearGradientInit = {\n  [Symbol.hasInstance](instance: unknown): instance is LinearGradientInit {\n    return Objects.hasAllKeys(instance, \"angle\", \"stops\");\n  },\n};\n\n/** @public */\nexport class LinearGradient implements Interpolate<LinearGradient>, Equals, Equivalent {\n  constructor(angle: LinearGradientAngle, stops: readonly ColorStop[]) {\n    this.angle = angle;\n    this.stops = stops;\n    this.stringValue = void 0;\n  }\n\n  readonly angle: LinearGradientAngle;\n\n  withAngle(angle: LinearGradientAngleLike): LinearGradient {\n    if (angle instanceof Angle || typeof angle === \"number\") {\n      angle = Angle.fromLike(angle, \"deg\");\n    }\n    return new LinearGradient(angle, this.stops);\n  }\n\n  readonly stops: readonly ColorStop[];\n\n  withStops(stops: readonly ColorStopLike[]): LinearGradient {\n    const n = stops.length;\n    const array = new Array<ColorStop>(n);\n    for (let i = 0; i < n; i += 1) {\n      array[i] = ColorStop.fromLike(stops[i]!);\n    }\n    return new LinearGradient(this.angle, array);\n  }\n\n  /** @override */\n  interpolateTo(that: LinearGradient): Interpolator<LinearGradient>;\n  interpolateTo(that: unknown): Interpolator<LinearGradient> | null;\n  interpolateTo(that: unknown): Interpolator<LinearGradient> | null {\n    if (that instanceof LinearGradient) {\n      return LinearGradientInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LinearGradient) {\n      return Values.equivalent(this.angle, that.angle, epsilon)\n          && Arrays.equivalent(this.stops, that.stops, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LinearGradient) {\n      return Values.equal(this.angle, that.angle)\n          && Arrays.equal(this.stops, that.stops);\n    }\n    return false;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  /** @override */\n  toString(): string {\n    let s = this.stringValue;\n    if (s === void 0) {\n      s = \"linear-gradient(\";\n      if (this.angle instanceof Angle) {\n        s += this.angle.toString();\n      } else {\n        s += \"to\";\n        if (typeof this.angle === \"string\") {\n          s += \" \";\n          s += this.angle;\n        } else {\n          for (let i = 0; i < this.angle.length; i += 1) {\n            s += \" \";\n            s += this.angle[i];\n          }\n        }\n      }\n      for (let i = 0; i < this.stops.length; i += 1) {\n        s += \", \";\n        s += this.stops[i]!.toString();\n      }\n      s += \")\";\n      (this as Mutable<this>).stringValue = s;\n    }\n    return s;\n  }\n\n  static create(angle: LinearGradientAngleLike, ...stops: ColorStopLike[]): LinearGradient {\n    if (angle instanceof Angle || typeof angle === \"number\") {\n      angle = Angle.fromLike(angle, \"deg\");\n    }\n    const n = stops.length;\n    const array = new Array<ColorStop>(n);\n    for (let i = 0; i < n; i += 1) {\n      const stop = stops[i];\n      if (typeof stop === \"string\") {\n        if (i === 0) {\n          array[i] = ColorStop.parse(stop);\n        } else {\n          array[i] = ColorStop.parseHint(stop);\n        }\n      } else {\n        array[i] = ColorStop.fromLike(stops[i]!);\n      }\n    }\n    return new LinearGradient(angle, array);\n  }\n\n  static fromLike<T extends LinearGradientLike | null | undefined>(value: T): LinearGradient | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof LinearGradient) {\n      return value as LinearGradient | Uninitable<T>;\n    } else if (typeof value === \"string\") {\n      return LinearGradient.parse(value);\n    } else if (typeof value === \"object\") {\n      return LinearGradient.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(init: LinearGradientInit): LinearGradient {\n    let angle: LinearGradientAngleLike = init.angle;\n    if (angle instanceof Angle || typeof angle === \"number\") {\n      angle = Angle.fromLike(angle, \"deg\");\n    }\n    const n = init.stops.length;\n    const array = new Array<ColorStop>(n);\n    for (let i = 0; i < n; i += 1) {\n      array[i] = ColorStop.fromLike(init.stops[i]!);\n    }\n    return new LinearGradient(angle, array);\n  }\n\n  static parse(string: string): LinearGradient {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = LinearGradientParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  static parseAngle(string: string): LinearGradientAngle {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = LinearGradientAngleParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n\n/** @internal */\nexport interface LinearGradientInterpolator extends Interpolator<LinearGradient> {\n  /** @internal */\n  readonly angleInterpolator: Interpolator<LinearGradientAngle>;\n  /** @internal */\n  readonly stopInterpolators: readonly Interpolator<ColorStop>[];\n\n  readonly 0: LinearGradient;\n\n  readonly 1: LinearGradient;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const LinearGradientInterpolator = (function (_super: typeof Interpolator) {\n  const LinearGradientInterpolator = function (g0: LinearGradient, g1: LinearGradient): LinearGradientInterpolator {\n    const interpolator = function (u: number): LinearGradient {\n      const angle = interpolator.angleInterpolator(u);\n      const stopInterpolators = interpolator.stopInterpolators;\n      const stopCount = stopInterpolators.length;\n      const stops = new Array<ColorStop>(stopCount);\n      for (let i = 0; i < stopCount; i += 1) {\n        stops[i] = stopInterpolators[i]!(u);\n      }\n      return new LinearGradient(angle, stops);\n    } as LinearGradientInterpolator;\n    Object.setPrototypeOf(interpolator, LinearGradientInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).angleInterpolator = Interpolator(g0.angle, g1.angle);\n    const stops0 = g0.stops;\n    const stops1 = g1.stops;\n    const stopCount = Math.min(stops0.length, stops1.length);\n    const stopInterpolators = new Array<Interpolator<ColorStop>>(stopCount);\n    for (let i = 0; i < stopCount; i += 1) {\n      stopInterpolators[i] = stops0[i]!.interpolateTo(stops1[i]!);\n    }\n    (interpolator as Mutable<typeof interpolator>).stopInterpolators = stopInterpolators;\n    return interpolator;\n  } as {\n    (g0: LinearGradient, g1: LinearGradient): LinearGradientInterpolator;\n\n    /** @internal */\n    prototype: LinearGradientInterpolator;\n  };\n\n  LinearGradientInterpolator.prototype = Object.create(_super.prototype);\n  LinearGradientInterpolator.prototype.constructor = LinearGradientInterpolator;\n\n  Object.defineProperty(LinearGradientInterpolator.prototype, 0, {\n    get(this: LinearGradientInterpolator): LinearGradient {\n      const angle = this.angleInterpolator[0];\n      const stopInterpolators = this.stopInterpolators;\n      const stopCount = stopInterpolators.length;\n      const stops = new Array<ColorStop>(stopCount);\n      for (let i = 0; i < stopCount; i += 1) {\n        stops[i] = stopInterpolators[i]![0];\n      }\n      return new LinearGradient(angle, stops);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(LinearGradientInterpolator.prototype, 1, {\n    get(this: LinearGradientInterpolator): LinearGradient {\n      const angle = this.angleInterpolator[1];\n      const stopInterpolators = this.stopInterpolators;\n      const stopCount = stopInterpolators.length;\n      const stops = new Array<ColorStop>(stopCount);\n      for (let i = 0; i < stopCount; i += 1) {\n        stops[i] = stopInterpolators[i]![1];\n      }\n      return new LinearGradient(angle, stops);\n    },\n    configurable: true,\n  });\n\n  LinearGradientInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LinearGradientInterpolator) {\n      if (this.angleInterpolator.equals(that.angleInterpolator)) {\n        const n = this.stopInterpolators.length;\n        if (n !== that.stopInterpolators.length) {\n          return false;\n        }\n        for (let i = 0; i < n; i += 1) {\n          if (!this.stopInterpolators[i]!.equals(that.stopInterpolators[i]!)) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    return false;\n  };\n\n  return LinearGradientInterpolator;\n})(Interpolator);\n\n/** @internal */\nexport class LinearGradientAngleParser extends Parser<LinearGradientAngle> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly angleParser: Parser<Angle> | undefined;\n  private readonly side: LinearGradientSide | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, angleParser?: Parser<Angle>,\n              side?: LinearGradientSide, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.angleParser = angleParser;\n    this.side = side;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<LinearGradientAngle> {\n    return LinearGradientAngleParser.parse(input, this.identOutput, this.angleParser,\n                                           this.side, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, angleParser?: Parser<Angle>,\n               side?: LinearGradientSide, step: number = 1): Parser<LinearGradientAngle> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input.step();\n      }\n      if (input.isCont()) {\n        if (c === 45/*'-'*/ || c === 46/*'.'*/ || c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          step = 2;\n        } else {\n          step = 3;\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (angleParser === void 0) {\n        angleParser = AngleParser.parse(input, \"deg\");\n      } else {\n        angleParser = angleParser.feed(input);\n      }\n      if (angleParser !== void 0) {\n        if (angleParser.isDone()) {\n          return angleParser;\n        } else if (angleParser.isError()) {\n          return angleParser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      if (identOutput === void 0) {\n        identOutput = Unicode.stringOutput();\n      }\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        if (ident === \"to\") {\n          identOutput = void 0;\n          step = 4;\n        } else {\n          return Parser.error(Diagnostic.message(\"unexpected \" + ident, input));\n        }\n      }\n    }\n    if (step === 4) {\n      if (input.isCont()) {\n        if (Unicode.isSpace(input.head())) {\n          input.step();\n          step = 5;\n        } else {\n          return Parser.error(Diagnostic.expected(\"side or corner\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 5) {\n      if (identOutput === void 0) {\n        identOutput = Unicode.stringOutput();\n      }\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        identOutput = void 0;\n        switch (ident) {\n          case \"left\":\n          case \"right\":\n            side = ident;\n            step = 6;\n            break;\n          case \"top\":\n          case \"bottom\":\n            side = ident;\n            step = 7;\n            break;\n          default: return Parser.error(Diagnostic.message(\"unknown side: \" + ident, input));\n        }\n      }\n    }\n    if (step === 6) {\n      if (identOutput === void 0) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont() && Unicode.isAlpha(c)) {\n          identOutput = Unicode.stringOutput();\n        } else if (!input.isEmpty()) {\n          return Parser.done(side!);\n        }\n      }\n      if (identOutput !== void 0) {\n        while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n          input = input.step();\n          identOutput.write(c);\n        }\n        if (!input.isEmpty()) {\n          const ident = identOutput.bind();\n          identOutput = void 0;\n          switch (ident) {\n            case \"top\":\n            case \"bottom\": return Parser.done([side as \"left\" | \"right\", ident]);\n            default: return Parser.error(Diagnostic.message(\"unknown side: \" + ident, input));\n          }\n        }\n      }\n    }\n    if (step === 7) {\n      if (identOutput === void 0) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont() && Unicode.isAlpha(c)) {\n          identOutput = Unicode.stringOutput();\n        } else if (!input.isEmpty()) {\n          return Parser.done(side!);\n        }\n      }\n      if (identOutput !== void 0) {\n        while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n          input = input.step();\n          identOutput.write(c);\n        }\n        if (!input.isEmpty()) {\n          const ident = identOutput.bind();\n          identOutput = void 0;\n          switch (ident) {\n            case \"left\":\n            case \"right\": return Parser.done([side as \"top\" | \"bottom\", ident]);\n            default: return Parser.error(Diagnostic.message(\"unknown side: \" + ident, input));\n          }\n        }\n      }\n    }\n    return new LinearGradientAngleParser(identOutput, angleParser, side, step);\n  }\n}\n\n/** @internal */\nexport class LinearGradientParser extends Parser<LinearGradient> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly angleParser: Parser<LinearGradientAngle> | undefined;\n  private readonly stopsParser: Parser<ColorStop[]> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, angleParser?: Parser<LinearGradientAngle>,\n              stopsParser?: Parser<ColorStop[]>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.angleParser = angleParser;\n    this.stopsParser = stopsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<LinearGradient> {\n    return LinearGradientParser.parse(input, this.identOutput, this.angleParser,\n                                      this.stopsParser, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, angleParser?: Parser<LinearGradientAngle>,\n               stopsParser?: Parser<ColorStop[]>, step: number = 1): Parser<LinearGradient> {\n    let c = 0;\n    if (step === 1) {\n      if (identOutput === void 0) {\n        identOutput = Unicode.stringOutput();\n      }\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || c === 45/*'-'*/)) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        if (ident === \"linear-gradient\") {\n          identOutput = void 0;\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.message(\"unexpected \" + ident, input));\n        }\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    if (step === 3) {\n      if (angleParser === void 0) {\n        angleParser = LinearGradientAngleParser.parse(input);\n      } else {\n        angleParser = angleParser.feed(input);\n      }\n      if (angleParser !== void 0) {\n        if (angleParser.isDone()) {\n          step = 4;\n        } else if (angleParser.isError()) {\n          return angleParser.asError();\n        }\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 44/*','*/) {\n        input = input.step();\n        step = 5;\n      } else {\n        return Parser.error(Diagnostic.expected(\"color stops\", input));\n      }\n    }\n    if (step === 5) {\n      if (stopsParser === void 0) {\n        stopsParser = ColorStopListParser.parse(input);\n      } else {\n        stopsParser = stopsParser.feed(input);\n      }\n      if (stopsParser !== void 0) {\n        if (stopsParser.isDone()) {\n          step = 6;\n        } else if (stopsParser.isError()) {\n          return stopsParser.asError();\n        }\n      }\n    }\n    if (step === 6) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont() && input.head() === 41/*')'*/) {\n        input.step();\n        return Parser.done(new LinearGradient(angleParser!.bind(), stopsParser!.bind()));\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new LinearGradientParser(identOutput, angleParser, stopsParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input, identOutput?: Output<string>): Parser<LinearGradient> {\n    return LinearGradientParser.parse(input, identOutput, void 0, void 0, 2);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport {Equivalent} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport type {Output} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport type {Item} from \"@swim/structure\";\nimport {Value} from \"@swim/structure\";\nimport {Record} from \"@swim/structure\";\nimport {Text} from \"@swim/structure\";\nimport {Form} from \"@swim/structure\";\nimport type {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport {LengthParser} from \"@swim/math\";\nimport type {ColorLike} from \"./Color\";\nimport {Color} from \"./Color\";\nimport {ColorParser} from \"./Color\";\n\n/** @public */\nexport type BoxShadowLike = BoxShadow | BoxShadowInit | string | readonly BoxShadowLike[];\n\n/** @public */\nexport const BoxShadowLike = {\n  [Symbol.hasInstance](instance: unknown): instance is BoxShadowLike {\n    return instance instanceof BoxShadow\n        || BoxShadowInit[Symbol.hasInstance](instance)\n        || typeof instance === \"string\"\n        || BoxShadowLike.isArray(instance);\n  },\n  /** @internal */\n  isArray(value: unknown): value is readonly BoxShadowLike[] {\n    if (!Array.isArray(value) || value.length === 0) {\n      return false;\n    }\n    for (let i = 0; i < value.length; i += 1) {\n      if (!BoxShadowLike[Symbol.hasInstance](value)) {\n        return false;\n      }\n    }\n    return true;\n  },\n};\n\n/** @public */\nexport interface BoxShadowInit {\n  inset?: boolean;\n  offsetX?: LengthLike;\n  offsetY?: LengthLike;\n  blurRadius?: LengthLike;\n  spreadRadius?: LengthLike;\n  color?: ColorLike;\n}\n\n/** @public */\nexport const BoxShadowInit = {\n  [Symbol.hasInstance](instance: unknown): instance is BoxShadowInit {\n    return Objects.hasAnyKey(instance, \"inset\", \"offsetX\", \"offsetY\", \"blurRadius\", \"spreadRadius\", \"color\");\n  },\n};\n\n/** @public */\nexport class BoxShadow implements Interpolate<BoxShadow>, Equals, Equivalent {\n  constructor(inset: boolean, offsetX: Length, offsetY: Length, blurRadius: Length,\n              spreadRadius: Length, color: Color, next: BoxShadow | null) {\n    this.inset = inset;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    this.blurRadius = blurRadius;\n    this.spreadRadius = spreadRadius;\n    this.color = color;\n    this.next = next;\n    this.stringValue = void 0;\n  }\n\n  likeType?(like: BoxShadowInit | string | readonly BoxShadowLike[]): void;\n\n  readonly inset: boolean;\n\n  withInset(inset: boolean): BoxShadow {\n    if (inset === this.inset) {\n      return this;\n    }\n    return new BoxShadow(inset, this.offsetX, this.offsetY, this.blurRadius,\n                         this.spreadRadius, this.color, this.next);\n  }\n\n  readonly offsetX: Length;\n\n  withOffsetX(offsetX: LengthLike): BoxShadow {\n    offsetX = Length.fromLike(offsetX);\n    if (offsetX.equals(this.offsetX)) {\n      return this;\n    }\n    return new BoxShadow(this.inset, offsetX, this.offsetY, this.blurRadius,\n                         this.spreadRadius, this.color, this.next);\n  }\n\n  readonly offsetY: Length;\n\n  withOffsetY(offsetY: LengthLike): BoxShadow {\n    offsetY = Length.fromLike(offsetY);\n    if (offsetY.equals(this.offsetY)) {\n      return this;\n    }\n    return new BoxShadow(this.inset, this.offsetX, offsetY, this.blurRadius,\n                         this.spreadRadius, this.color, this.next);\n  }\n\n  readonly blurRadius: Length;\n\n  withBlurRadius(blurRadius: LengthLike): BoxShadow {\n    blurRadius = Length.fromLike(blurRadius);\n    if (blurRadius.equals(this.blurRadius)) {\n      return this;\n    }\n    return new BoxShadow(this.inset, this.offsetX, this.offsetY, blurRadius,\n                         this.spreadRadius, this.color, this.next);\n  }\n\n  readonly spreadRadius: Length;\n\n  withSpreadRadius(spreadRadius: LengthLike): BoxShadow {\n    spreadRadius = Length.fromLike(spreadRadius);\n    if (spreadRadius.equals(this.spreadRadius)) {\n      return this;\n    }\n    return new BoxShadow(this.inset, this.offsetX, this.offsetY, this.blurRadius,\n                         spreadRadius, this.color, this.next);\n  }\n\n  readonly color: Color;\n\n  withColor(color: ColorLike): BoxShadow {\n    color = Color.fromLike(color);\n    if (color.equals(this.color)) {\n      return this;\n    }\n    return new BoxShadow(this.inset, this.offsetX, this.offsetY, this.blurRadius,\n                         this.spreadRadius, color, this.next);\n  }\n\n  readonly next: BoxShadow | null;\n\n  and(value: BoxShadowLike): BoxShadow;\n  and(offsetX: LengthLike, offsetY: LengthLike, color: ColorLike): BoxShadow;\n  and(offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, color: ColorLike): BoxShadow;\n  and(offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, spreadRadius: LengthLike, color: ColorLike): BoxShadow;\n  and(inset: boolean, offsetX: LengthLike, offsetY: LengthLike, color: ColorLike): BoxShadow;\n  and(inset: boolean, offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, color: ColorLike): BoxShadow;\n  and(inset: boolean, offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, spreadRadius: LengthLike, color: ColorLike): BoxShadow;\n  and(inset: BoxShadowLike | LengthLike | boolean, offsetX?: LengthLike, offsetY?: ColorLike | LengthLike, blurRadius?: ColorLike | LengthLike, spreadRadius?: ColorLike | LengthLike, color?: ColorLike): BoxShadow {\n    let next: BoxShadow | null;\n    if (this.next !== null) {\n      // eslint-disable-next-line prefer-rest-params, prefer-spread\n      next = this.next.and.apply(this.next, arguments as any);\n    } else {\n      // eslint-disable-next-line prefer-rest-params, prefer-spread\n      next = BoxShadow.create.apply(BoxShadow, arguments as any);\n    }\n    return new BoxShadow(this.inset, this.offsetX, this.offsetY, this.blurRadius,\n                         this.spreadRadius, this.color, next);\n  }\n\n  /** @override */\n  interpolateTo(that: BoxShadow): Interpolator<BoxShadow>;\n  interpolateTo(that: unknown): Interpolator<BoxShadow> | null;\n  interpolateTo(that: unknown): Interpolator<BoxShadow> | null {\n    if (that instanceof BoxShadow) {\n      return BoxShadowInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BoxShadow) {\n      return this.inset === that.inset\n          && this.offsetX.equivalentTo(that.offsetX, epsilon)\n          && this.offsetY.equivalentTo(that.offsetY, epsilon)\n          && this.blurRadius.equivalentTo(that.blurRadius, epsilon)\n          && this.spreadRadius.equivalentTo(that.spreadRadius, epsilon)\n          && this.color.equivalentTo(that.color, epsilon)\n          && Equivalent(this.next, that.next, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BoxShadow) {\n      return this.inset === that.inset && this.offsetX.equals(that.offsetX)\n          && this.offsetY.equals(that.offsetY) && this.blurRadius.equals(that.blurRadius)\n          && this.spreadRadius.equals(that.spreadRadius) && this.color.equals(that.color)\n          && Equals(this.next, that.next);\n    }\n    return false;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  /** @override */\n  toString(): string {\n    let s = this.stringValue;\n    if (s === void 0) {\n      s = \"\";\n      if (this.inset) {\n        s += \"inset\";\n        s += \" \";\n      }\n      s += this.offsetX.toString();\n      s += \" \";\n      s += this.offsetY.toString();\n      s += \" \";\n      s += this.blurRadius.toString();\n      s += \" \";\n      s += this.spreadRadius.toString();\n      s += \" \";\n      s += this.color.toString();\n      if (this.next !== null) {\n        s += \", \";\n        s += this.next.toString();\n      }\n      (this as Mutable<this>).stringValue = s;\n    }\n    return s;\n  }\n\n  static create(value: BoxShadowLike): BoxShadow;\n  static create(offsetX: LengthLike, offsetY: LengthLike, color: ColorLike): BoxShadow;\n  static create(offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, color: ColorLike): BoxShadow;\n  static create(offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, spreadRadius: LengthLike, color: ColorLike): BoxShadow;\n  static create(inset: boolean, offsetX: LengthLike, offsetY: LengthLike, color: ColorLike): BoxShadow;\n  static create(inset: boolean, offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, color: ColorLike): BoxShadow;\n  static create(inset: boolean, offsetX: LengthLike, offsetY: LengthLike, blurRadius: LengthLike, spreadRadius: LengthLike, color: ColorLike): BoxShadow;\n  static create(inset: BoxShadowLike | LengthLike | boolean, offsetX?: LengthLike, offsetY?: ColorLike | LengthLike, blurRadius?: ColorLike | LengthLike, spreadRadius?: ColorLike | LengthLike, color?: ColorLike): BoxShadow {\n    if (arguments.length === 1) {\n      return BoxShadow.fromLike(inset as BoxShadowLike)!;\n    } else if (typeof inset !== \"boolean\") {\n      if (arguments.length === 3) {\n        color = Color.fromLike(offsetY as ColorLike);\n        spreadRadius = Length.zero();\n        blurRadius = Length.zero();\n        offsetY = Length.fromLike(offsetX!);\n        offsetX = Length.fromLike(inset as LengthLike);\n      } else if (arguments.length === 4) {\n        color = Color.fromLike(blurRadius as ColorLike);\n        spreadRadius = Length.zero();\n        blurRadius = Length.fromLike(offsetY as LengthLike);\n        offsetY = Length.fromLike(offsetX!);\n        offsetX = Length.fromLike(inset as LengthLike);\n      } else if (arguments.length === 5) {\n        color = Color.fromLike(spreadRadius as ColorLike);\n        spreadRadius = Length.fromLike(blurRadius as LengthLike);\n        blurRadius = Length.fromLike(offsetY as LengthLike);\n        offsetY = Length.fromLike(offsetX!);\n        offsetX = Length.fromLike(inset as LengthLike);\n      } else {\n        throw new Error(inset + \", \" + offsetX + \", \" + offsetY + \", \" + blurRadius + \", \" + spreadRadius + \", \" + color);\n      }\n      inset = false;\n    } else {\n      if (arguments.length === 4) {\n        color = Color.fromLike(blurRadius as ColorLike);\n        spreadRadius = Length.zero();\n        blurRadius = Length.zero();\n        offsetY = Length.fromLike(offsetY as LengthLike);\n        offsetX = Length.fromLike(offsetX!);\n      } else if (arguments.length === 5) {\n        color = Color.fromLike(spreadRadius as ColorLike);\n        spreadRadius = Length.zero();\n        blurRadius = Length.fromLike(blurRadius as LengthLike);\n        offsetY = Length.fromLike(offsetY as LengthLike);\n        offsetX = Length.fromLike(offsetX!);\n      } else if (arguments.length === 6) {\n        color = Color.fromLike(color!);\n        spreadRadius = Length.fromLike(spreadRadius as LengthLike);\n        blurRadius = Length.fromLike(blurRadius as LengthLike);\n        offsetY = Length.fromLike(offsetY as LengthLike);\n        offsetX = Length.fromLike(offsetX!);\n      } else {\n        throw new Error(inset + \", \" + offsetX + \", \" + offsetY + \", \" + blurRadius + \", \" + spreadRadius + \", \" + color);\n      }\n    }\n    return new BoxShadow(inset, offsetX, offsetY, blurRadius, spreadRadius, color, null);\n  }\n\n  static fromLike<T extends BoxShadowLike | null | undefined>(values: T): BoxShadow | Uninitable<T>;\n  static fromLike(...values: BoxShadowLike[]): BoxShadow;\n  static fromLike(...values: BoxShadowLike[]): BoxShadow | null {\n    let value: BoxShadowLike;\n    if (arguments.length === 0) {\n      return null;\n    } else if (arguments.length === 1) {\n      value = values[0]!;\n    } else {\n      value = values;\n    }\n    if (value === void 0 || value === null || value instanceof BoxShadow) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return BoxShadow.parse(value);\n    } else if (typeof value === \"object\" && (value as any).length === void 0) {\n      return BoxShadow.fromInit(value as BoxShadowInit);\n    } else if (typeof value === \"object\" && (value as any).length !== 0) {\n      return BoxShadow.fromArray(value as readonly BoxShadowLike[]);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(init: BoxShadowInit): BoxShadow {\n    const inset = init.inset || false;\n    const offsetX = init.offsetX !== void 0 ? Length.fromLike(init.offsetX) : Length.zero();\n    const offsetY = init.offsetY !== void 0 ? Length.fromLike(init.offsetY) : Length.zero();\n    const blurRadius = init.blurRadius !== void 0 ? Length.fromLike(init.blurRadius) : Length.zero();\n    const spreadRadius = init.spreadRadius !== void 0 ? Length.fromLike(init.spreadRadius) : Length.zero();\n    const color = init.color !== void 0 ? Color.fromLike(init.color) : Color.black();\n    return new BoxShadow(inset, offsetX, offsetY, blurRadius, spreadRadius, color, null);\n  }\n\n  static fromArray(array: readonly BoxShadowLike[]): BoxShadow {\n    let boxShadow = BoxShadow.fromLike(array[0]!)!;\n    for (let i = 1; i < array.length; i += 1) {\n      boxShadow = boxShadow.and(array[i]!);\n    }\n    return boxShadow;\n  }\n\n  static fromValue(value: Value): BoxShadow | null {\n    let boxShadow: BoxShadow | null = null;\n    value.forEach(function (item: Item, index: number): void {\n      const header = item.header(\"boxShadow\");\n      if (!header.isDefined()) {\n        return;\n      }\n      let inset: boolean | undefined;\n      let offsetX: Length | undefined;\n      let offsetY: Length | undefined;\n      let blurRadius: Length | undefined;\n      let spreadRadius: Length | undefined;\n      let color: Color | undefined;\n      header.forEach(function (item: Item, index: number): void {\n        const key = item.key.stringValue();\n        if (key !== void 0) {\n          if (key === \"inset\") {\n            inset = item.toValue().booleanValue(inset);\n          } else if (key === \"offsetX\") {\n            offsetX = item.toValue().cast(Length.form(), offsetX);\n          } else if (key === \"offsetY\") {\n            offsetY = item.toValue().cast(Length.form(), offsetY);\n          } else if (key === \"blurRadius\") {\n            blurRadius = item.toValue().cast(Length.form(), blurRadius);\n          } else if (key === \"spreadRadius\") {\n            spreadRadius = item.toValue().cast(Length.form(), spreadRadius);\n          } else if (key === \"color\") {\n            color = item.toValue().cast(Color.form(), color);\n          }\n        } else if (item instanceof Value) {\n          if (index === 0 && item instanceof Text && item.value === \"inset\") {\n            inset = true;\n          } else if (index === 0 || index === 1 && inset !== void 0) {\n            offsetX = item.cast(Length.form(), offsetX);\n          } else if (index === 1 || index === 2 && inset !== void 0) {\n            offsetY = item.cast(Length.form(), offsetY);\n          } else if (index === 2 || index === 3 && inset !== void 0) {\n            blurRadius = item.cast(Length.form(), blurRadius);\n            if (blurRadius === void 0) {\n              color = item.cast(Color.form(), color);\n            }\n          } else if ((index === 3 || index === 4 && inset === void 0) && color === void 0) {\n            spreadRadius = item.cast(Length.form(), spreadRadius);\n            if (spreadRadius === void 0) {\n              color = item.cast(Color.form(), color);\n            }\n          } else if ((index === 4 || index === 5 && inset === void 0) && color === void 0) {\n            color = item.cast(Color.form(), color);\n          }\n        }\n      });\n      inset = inset !== void 0 ? inset : false;\n      offsetX = offsetX !== void 0 ? offsetX : Length.zero();\n      offsetY = offsetY !== void 0 ? offsetY : Length.zero();\n      blurRadius = blurRadius !== void 0 ? blurRadius : Length.zero();\n      spreadRadius = spreadRadius !== void 0 ? spreadRadius : Length.zero();\n      color = color !== void 0 ? color : Color.black();\n      const next = new BoxShadow(inset || false, offsetX, offsetY, blurRadius, spreadRadius, color, null);\n      if (boxShadow !== null) {\n        boxShadow = boxShadow.and(next);\n      } else {\n        boxShadow = next;\n      }\n    });\n    return boxShadow;\n  }\n\n  static parse(string: string): BoxShadow | null {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = BoxShadowParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  @Lazy\n  static form(): Form<BoxShadow | null, BoxShadowLike> {\n    return new BoxShadowForm(null);\n  }\n}\n\n/** @internal */\nexport interface BoxShadowInterpolator extends Interpolator<BoxShadow> {\n  /** @internal */\n  readonly insetInterpolator: Interpolator<boolean>;\n  /** @internal */\n  readonly offsetXInterpolator: Interpolator<Length>;\n  /** @internal */\n  readonly offsetYInterpolator: Interpolator<Length>;\n  /** @internal */\n  readonly blurRadiusInterpolator: Interpolator<Length>;\n  /** @internal */\n  readonly spreadRadiusInterpolator: Interpolator<Length>;\n  /** @internal */\n  readonly colorInterpolator: Interpolator<Color>;\n  /** @internal */\n  readonly nextInterpolator: Interpolator<BoxShadow | null>;\n\n  get 0(): BoxShadow;\n\n  get 1(): BoxShadow;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const BoxShadowInterpolator = (function (_super: typeof Interpolator) {\n  const BoxShadowInterpolator = function (b0: BoxShadow, b1: BoxShadow): BoxShadowInterpolator {\n    const interpolator = function (u: number): BoxShadow {\n      const inset = interpolator.insetInterpolator(u);\n      const offsetX = interpolator.offsetXInterpolator(u);\n      const offsetY = interpolator.offsetYInterpolator(u);\n      const blurRadius = interpolator.blurRadiusInterpolator(u);\n      const spreadRadius = interpolator.spreadRadiusInterpolator(u);\n      const color = interpolator.colorInterpolator(u);\n      const next = interpolator.nextInterpolator(u);\n      return new BoxShadow(inset, offsetX, offsetY, blurRadius, spreadRadius, color, next);\n    } as BoxShadowInterpolator;\n    Object.setPrototypeOf(interpolator, BoxShadowInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).insetInterpolator = Interpolator(b0.inset, b1.inset);\n    (interpolator as Mutable<typeof interpolator>).offsetXInterpolator = b0.offsetX.interpolateTo(b1.offsetX);\n    (interpolator as Mutable<typeof interpolator>).offsetYInterpolator = b0.offsetY.interpolateTo(b1.offsetY);\n    (interpolator as Mutable<typeof interpolator>).blurRadiusInterpolator = b0.blurRadius.interpolateTo(b1.blurRadius);\n    (interpolator as Mutable<typeof interpolator>).spreadRadiusInterpolator = b0.spreadRadius.interpolateTo(b1.spreadRadius);\n    (interpolator as Mutable<typeof interpolator>).colorInterpolator = b0.color.interpolateTo(b1.color);\n    (interpolator as Mutable<typeof interpolator>).nextInterpolator = Interpolator(b0.next, b1.next);\n    return interpolator;\n  } as {\n    (b0: BoxShadow, b1: BoxShadow): BoxShadowInterpolator;\n\n    /** @internal */\n    prototype: BoxShadowInterpolator;\n  };\n\n  BoxShadowInterpolator.prototype = Object.create(_super.prototype);\n  BoxShadowInterpolator.prototype.constructor = BoxShadowInterpolator;\n\n  Object.defineProperty(BoxShadowInterpolator.prototype, 0, {\n    get(this: BoxShadowInterpolator): BoxShadow {\n      const inset = this.insetInterpolator[0];\n      const offsetX = this.offsetXInterpolator[0];\n      const offsetY = this.offsetYInterpolator[0];\n      const blurRadius = this.blurRadiusInterpolator[0];\n      const spreadRadius = this.spreadRadiusInterpolator[0];\n      const color = this.colorInterpolator[0];\n      const next = this.nextInterpolator[0];\n      return new BoxShadow(inset, offsetX, offsetY, blurRadius, spreadRadius, color, next);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(BoxShadowInterpolator.prototype, 1, {\n    get(this: BoxShadowInterpolator): BoxShadow {\n      const inset = this.insetInterpolator[1];\n      const offsetX = this.offsetXInterpolator[1];\n      const offsetY = this.offsetYInterpolator[1];\n      const blurRadius = this.blurRadiusInterpolator[1];\n      const spreadRadius = this.spreadRadiusInterpolator[1];\n      const color = this.colorInterpolator[1];\n      const next = this.nextInterpolator[1];\n      return new BoxShadow(inset, offsetX, offsetY, blurRadius, spreadRadius, color, next);\n    },\n    configurable: true,\n  });\n\n  BoxShadowInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BoxShadowInterpolator) {\n      return this.insetInterpolator.equals(that.insetInterpolator)\n          && this.offsetXInterpolator.equals(that.offsetXInterpolator)\n          && this.offsetYInterpolator.equals(that.offsetYInterpolator)\n          && this.blurRadiusInterpolator.equals(that.blurRadiusInterpolator)\n          && this.spreadRadiusInterpolator.equals(that.spreadRadiusInterpolator)\n          && this.colorInterpolator.equals(that.colorInterpolator)\n          && this.nextInterpolator.equals(that.nextInterpolator);\n    }\n    return false;\n  };\n\n  return BoxShadowInterpolator;\n})(Interpolator);\n\n/** @internal */\nexport class BoxShadowForm extends Form<BoxShadow | null, BoxShadowLike> {\n  constructor(unit: BoxShadow | null | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n      configurable: true,\n    });\n  }\n\n  override readonly unit: BoxShadow | null | undefined;\n\n  override withUnit(unit: BoxShadow | null | undefined): Form<BoxShadow | null, BoxShadowLike> {\n    if (unit === this.unit) {\n      return this;\n    }\n    return new BoxShadowForm(unit);\n  }\n\n  override mold(boxShadow: BoxShadowLike): Item {\n    let shadow = BoxShadow.fromLike(boxShadow)!;\n    const record = Record.create();\n    do {\n      const header = Record.create(5);\n      if (shadow.inset) {\n        header.push(\"inset\");\n      }\n      header.push(Length.form().mold(shadow.offsetX));\n      header.push(Length.form().mold(shadow.offsetY));\n      header.push(Length.form().mold(shadow.blurRadius));\n      header.push(Length.form().mold(shadow.spreadRadius));\n      header.push(Color.form().mold(shadow.color));\n      record.attr(\"boxShadow\", header);\n      if (shadow.next !== null) {\n        shadow = shadow.next;\n        continue;\n      }\n      break;\n    } while (true);\n    return record;\n  }\n\n  override cast(item: Item): BoxShadow | null | undefined {\n    const value = item.toValue();\n    let boxShadow: BoxShadow | null | undefined;\n    try {\n      boxShadow = BoxShadow.fromValue(value);\n      if (boxShadow === void 0) {\n        const string = value.stringValue();\n        if (string !== void 0) {\n          boxShadow = BoxShadow.parse(string);\n        }\n      }\n    } catch (e) {\n      // swallow\n    }\n    return boxShadow;\n  }\n}\n\n/** @internal */\nexport class BoxShadowParser extends Parser<BoxShadow | null> {\n  private readonly boxShadow: BoxShadow | undefined;\n  private readonly identOutput: Output<string> | undefined;\n  private readonly offsetXParser: Parser<Length> | undefined;\n  private readonly offsetYParser: Parser<Length> | undefined;\n  private readonly blurRadiusParser: Parser<Length> | undefined;\n  private readonly spreadRadiusParser: Parser<Length> | undefined;\n  private readonly colorParser: Parser<Color> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(boxShadow?: BoxShadow, identOutput?: Output<string>,\n              offsetXParser?: Parser<Length>, offsetYParser?: Parser<Length>,\n              blurRadiusParser?: Parser<Length>, spreadRadiusParser?: Parser<Length>,\n              colorParser?: Parser<Color>, step?: number) {\n    super();\n    this.boxShadow = boxShadow;\n    this.identOutput = identOutput;\n    this.offsetXParser = offsetXParser;\n    this.offsetYParser = offsetYParser;\n    this.blurRadiusParser = blurRadiusParser;\n    this.spreadRadiusParser = spreadRadiusParser;\n    this.colorParser = colorParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<BoxShadow | null> {\n    return BoxShadowParser.parse(input, this.boxShadow, this.identOutput, this.offsetXParser,\n                                 this.offsetYParser, this.blurRadiusParser, this.spreadRadiusParser,\n                                 this.colorParser, this.step);\n  }\n\n  static parse(input: Input, boxShadow?: BoxShadow, identOutput?: Output<string>,\n               offsetXParser?: Parser<Length>, offsetYParser?: Parser<Length>,\n               blurRadiusParser?: Parser<Length>, spreadRadiusParser?: Parser<Length>,\n               colorParser?: Parser<Color>, step: number = 1): Parser<BoxShadow | null> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input.step();\n        }\n        if (input.isCont()) {\n          if (Unicode.isAlpha(c)) {\n            step = 2;\n          } else {\n            step = 4;\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 2) {\n        identOutput = identOutput || Unicode.stringOutput();\n        while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n          input = input.step();\n          identOutput.write(c);\n        }\n        if (!input.isEmpty()) {\n          const ident = identOutput.bind();\n          switch (ident) {\n            case \"inset\": step = 3; break;\n            case \"none\": return Parser.done(null);\n            default: return Parser.error(Diagnostic.message(\"unknown box-shadow: \" + ident, input));\n          }\n        }\n      }\n      if (step === 3) {\n        if (input.isCont()) {\n          if (Unicode.isSpace(input.head())) {\n            input.step();\n            step = 4;\n          } else {\n            return Parser.error(Diagnostic.expected(\"space\", input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 4) {\n        if (offsetXParser === void 0) {\n          while (input.isCont() && Unicode.isSpace(input.head())) {\n            input.step();\n          }\n          if (!input.isEmpty()) {\n            offsetXParser = LengthParser.parse(input);\n          }\n        } else {\n          offsetXParser = offsetXParser.feed(input);\n        }\n        if (offsetXParser !== void 0) {\n          if (offsetXParser.isDone()) {\n            step = 5;\n          } else if (offsetXParser.isError()) {\n            return offsetXParser.asError();\n          }\n        }\n      }\n      if (step === 5) {\n        if (input.isCont()) {\n          if (Unicode.isSpace(input.head())) {\n            input.step();\n            step = 6;\n          } else {\n            return Parser.error(Diagnostic.expected(\"space\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 6) {\n        if (offsetYParser === void 0) {\n          while (input.isCont() && Unicode.isSpace(input.head())) {\n            input.step();\n          }\n          if (!input.isEmpty()) {\n            offsetYParser = LengthParser.parse(input);\n          }\n        } else {\n          offsetYParser = offsetYParser.feed(input);\n        }\n        if (offsetYParser !== void 0) {\n          if (offsetYParser.isDone()) {\n            step = 7;\n          } else if (offsetYParser.isError()) {\n            return offsetYParser.asError();\n          }\n        }\n      }\n      if (step === 7) {\n        if (input.isCont()) {\n          if (Unicode.isSpace(input.head())) {\n            input.step();\n            step = 8;\n          } else {\n            return Parser.error(Diagnostic.expected(\"space\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 8) {\n        if (blurRadiusParser === void 0) {\n          while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n            input.step();\n          }\n          if (input.isCont() && (c === 45/*'-'*/ || c >= 48/*'0'*/ && c <= 57/*'9'*/)) {\n            blurRadiusParser = LengthParser.parse(input);\n          } else if (!input.isEmpty()) {\n            step = 12;\n          }\n        } else {\n          blurRadiusParser = blurRadiusParser.feed(input);\n        }\n        if (blurRadiusParser !== void 0) {\n          if (blurRadiusParser.isDone()) {\n            step = 9;\n          } else if (blurRadiusParser.isError()) {\n            return blurRadiusParser.asError();\n          }\n        }\n      }\n      if (step === 9) {\n        if (input.isCont()) {\n          if (Unicode.isSpace(input.head())) {\n            input.step();\n            step = 10;\n          } else {\n            return Parser.error(Diagnostic.expected(\"space\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 10) {\n        if (spreadRadiusParser === void 0) {\n          while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n            input.step();\n          }\n          if (input.isCont() && (c === 45/*'-'*/ || c >= 48/*'0'*/ && c <= 57/*'9'*/)) {\n            spreadRadiusParser = LengthParser.parse(input);\n          } else if (!input.isEmpty()) {\n            step = 12;\n          }\n        } else {\n          spreadRadiusParser = spreadRadiusParser.feed(input);\n        }\n        if (spreadRadiusParser !== void 0) {\n          if (spreadRadiusParser.isDone()) {\n            step = 11;\n          } else if (spreadRadiusParser.isError()) {\n            return spreadRadiusParser.asError();\n          }\n        }\n      }\n      if (step === 11) {\n        if (input.isCont()) {\n          if (Unicode.isSpace(input.head())) {\n            input.step();\n            step = 12;\n          } else {\n            return Parser.error(Diagnostic.expected(\"space\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 12) {\n        if (colorParser === void 0) {\n          while (input.isCont() && Unicode.isSpace(input.head())) {\n            input.step();\n          }\n          if (!input.isEmpty()) {\n            colorParser = ColorParser.parse(input);\n          }\n        } else {\n          colorParser = colorParser.feed(input);\n        }\n        if (colorParser !== void 0) {\n          if (colorParser.isDone()) {\n            const inset = identOutput !== void 0 ? identOutput.bind() === \"inset\" : false;\n            const offsetX = offsetXParser!.bind();\n            const offsetY = offsetYParser!.bind();\n            const blurRadius = blurRadiusParser !== void 0 ? blurRadiusParser.bind() : Length.zero();\n            const spreadRadius = spreadRadiusParser !== void 0 ? spreadRadiusParser.bind() : Length.zero();\n            const color = colorParser!.bind();\n            const next = new BoxShadow(inset, offsetX, offsetY, blurRadius, spreadRadius, color, null);\n            if (boxShadow === void 0) {\n              boxShadow = next;\n            } else {\n              boxShadow = boxShadow.and(next);\n            }\n            identOutput = void 0;\n            offsetXParser = void 0;\n            offsetYParser = void 0;\n            blurRadiusParser = void 0;\n            spreadRadiusParser = void 0;\n            colorParser = void 0;\n            step = 13;\n          } else if (colorParser.isError()) {\n            return colorParser.asError();\n          }\n        }\n      }\n      if (step === 13) {\n        while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n          input.step();\n        }\n        if (input.isCont() && c === 44/*','*/) {\n          input.step();\n          step = 1;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.done(boxShadow!);\n        }\n      }\n      break;\n    } while (true);\n    return new BoxShadowParser(boxShadow, identOutput, offsetXParser, offsetYParser,\n                               blurRadiusParser, spreadRadiusParser, colorParser, step);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {Diagnostic} from \"@swim/codec\";\nimport type {Input} from \"@swim/codec\";\nimport type {Output} from \"@swim/codec\";\nimport {Parser} from \"@swim/codec\";\nimport {Base10} from \"@swim/codec\";\nimport {Unicode} from \"@swim/codec\";\nimport {Item} from \"@swim/structure\";\nimport {Record} from \"@swim/structure\";\nimport {Num} from \"@swim/structure\";\nimport {Bool} from \"@swim/structure\";\nimport {Form} from \"@swim/structure\";\nimport type {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport type {AngleLike} from \"@swim/math\";\nimport {Angle} from \"@swim/math\";\nimport type {TransformLike} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport {TranslateTransformParser} from \"@swim/math\";\nimport {ScaleTransformParser} from \"@swim/math\";\nimport {RotateTransformParser} from \"@swim/math\";\nimport {SkewTransformParser} from \"@swim/math\";\nimport {AffineTransformParser} from \"@swim/math\";\nimport {DateTimeLike} from \"@swim/time\";\nimport type {DateTimeInit} from \"@swim/time\";\nimport {DateTime} from \"@swim/time\";\nimport {DateTimeFormat} from \"@swim/time\";\nimport type {FontWeight} from \"./Font\";\nimport {FontLike} from \"./Font\";\nimport {Font} from \"./Font\";\nimport {FontParser} from \"./Font\";\nimport {ColorLike} from \"./Color\";\nimport {Color} from \"./Color\";\nimport {RgbColorParser} from \"./RgbColor\";\nimport {HexColorParser} from \"./RgbColor\";\nimport {HslColorParser} from \"./HslColor\";\nimport {LinearGradientLike} from \"./LinearGradient\";\nimport {LinearGradient} from \"./LinearGradient\";\nimport {LinearGradientParser} from \"./LinearGradient\";\nimport {BoxShadowLike} from \"./BoxShadow\";\nimport {BoxShadow} from \"./BoxShadow\";\n\n/** @public */\nexport type StyleValueLike = DateTimeLike\n                           | AngleLike\n                           | LengthLike\n                           | FontLike\n                           | ColorLike\n                           | LinearGradientLike\n                           | BoxShadowLike\n                           | TransformLike\n                           | Interpolator<any>\n                           | number\n                           | boolean;\n\n/** @public */\nexport type StyleValue = DateTime\n                       | Angle\n                       | Length\n                       | Font\n                       | Color\n                       | LinearGradient\n                       | BoxShadow\n                       | Transform\n                       | Interpolator<any>\n                       | number\n                       | boolean;\n\n/** @public */\nexport const StyleValue = {\n  fromLike<T extends StyleValueLike | null | undefined>(value: T): StyleValue | Uninitable<T> {\n    if (value === void 0 || value === null\n        || value instanceof DateTime\n        || value instanceof Angle\n        || value instanceof Length\n        || value instanceof Color\n        || value instanceof Font\n        || value instanceof BoxShadow\n        || value instanceof LinearGradient\n        || value instanceof Transform\n        || value instanceof Interpolator\n        || typeof value === \"number\"\n        || typeof value === \"boolean\") {\n      return value as StyleValue | Uninitable<T>;\n    } else if (DateTimeLike[Symbol.hasInstance](value)) {\n      return DateTime.fromLike(value);\n    } else if (ColorLike[Symbol.hasInstance](value)) {\n      return Color.fromLike(value);\n    } else if (FontLike[Symbol.hasInstance](value)) {\n      return Font.fromLike(value);\n    } else if (BoxShadowLike[Symbol.hasInstance](value)) {\n      return BoxShadow.fromLike(value)!;\n    } else if (LinearGradientLike[Symbol.hasInstance](value)) {\n      return LinearGradient.fromLike(value)!;\n    } else if (typeof value === \"string\") {\n      return StyleValue.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  },\n\n  parse(input: Input | string): StyleValue {\n    if (typeof input === \"string\") {\n      input = Unicode.stringInput(input);\n    }\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = StyleValueParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  },\n\n  form: Lazy(function (): Form<StyleValue, StyleValueLike> {\n    return new StyleValueForm(void 0);\n  }),\n};\n\n/** @internal */\nexport class StyleValueForm extends Form<StyleValue, StyleValueLike> {\n  constructor(unit: StyleValue | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n      configurable: true,\n    });\n  }\n\n  override readonly unit: StyleValue | undefined;\n\n  override withUnit(unit: StyleValue | undefined): Form<StyleValue, StyleValueLike> {\n    if (unit === this.unit) {\n      return this;\n    }\n    return new StyleValueForm(unit);\n  }\n\n  override mold(value: StyleValueLike): Item {\n    if (value === void 0) {\n      return Item.extant();\n    }\n    value = StyleValue.fromLike(value);\n    if (value instanceof DateTime) {\n      return DateTime.form().mold(value);\n    } else if (value instanceof Angle) {\n      return Angle.form().mold(value);\n    } else if (value instanceof Length) {\n      return Length.form().mold(value);\n    } else if (value instanceof Font) {\n      return Font.form().mold(value);\n    } else if (value instanceof Color) {\n      return Color.form().mold(value);\n    } else if (value instanceof BoxShadow) {\n      return BoxShadow.form().mold(value);\n    } else if (value instanceof Transform) {\n      return Transform.form().mold(value);\n    } else if (typeof value === \"number\") {\n      return Num.from(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  override cast(item: Item): StyleValue | undefined {\n    const value = item.toValue();\n    if (value instanceof Num) {\n      return value.numberValue();\n    }\n    if (value instanceof Bool) {\n      return value.booleanValue();\n    }\n    const string = value.stringValue(void 0);\n    if (string !== void 0) {\n      try {\n        return StyleValue.parse(string);\n      } catch (e) {\n        // swallow\n      }\n    }\n    if (value instanceof Record) {\n      const date = DateTime.fromValue(value);\n      if (date !== null) {\n        return date;\n      }\n      const angle = Angle.fromValue(value);\n      if (angle !== null) {\n        return angle;\n      }\n      const length = Length.fromValue(value);\n      if (length !== null) {\n        return length;\n      }\n      const font = Font.fromValue(value);\n      if (font !== null) {\n        return font;\n      }\n      const color = Color.fromValue(value);\n      if (color !== null) {\n        return color;\n      }\n      const boxShadow = BoxShadow.fromValue(value);\n      if (boxShadow !== null) {\n        return boxShadow;\n      }\n      const transform = Transform.fromValue(value);\n      if (transform !== null) {\n        return transform;\n      }\n    }\n    return void 0;\n  }\n}\n\n/** @internal */\nexport class StyleValueParser extends Parser<StyleValue> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly valueParser: Parser<number> | undefined;\n  private readonly unitsOutput: Output<string> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, valueParser?: Parser<number>,\n              unitsOutput?: Output<string>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.valueParser = valueParser;\n    this.unitsOutput = unitsOutput;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<StyleValue> {\n    return StyleValueParser.parse(input, this.identOutput, this.valueParser,\n                                  this.unitsOutput, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, valueParser?: Parser<number>,\n               unitsOutput?: Output<string>, step: number = 1): Parser<StyleValue> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input.step();\n      }\n      if (input.isCont()) {\n        if (c === 35/*'#'*/) {\n          return HexColorParser.parse(input);\n        } else if (Unicode.isAlpha(c)) {\n          step = 2;\n        } else {\n          step = 3;\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      identOutput = identOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || Unicode.isDigit(c) || c === 45/*'-'*/)) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        switch (ident) {\n          case \"rgb\":\n          case \"rgba\": return RgbColorParser.parseRest(input);\n\n          case \"hsl\":\n          case \"hsla\": return HslColorParser.parseRest(input);\n\n          case \"linear-gradient\": return LinearGradientParser.parseRest(input, identOutput);\n\n          case \"normal\":\n          case \"italic\":\n          case \"oblique\": return FontParser.parseRest(input, ident);\n          case \"small-caps\": return FontParser.parseRest(input, void 0, ident);\n          case \"bold\":\n          case \"bolder\":\n          case \"lighter\": return FontParser.parseRest(input, void 0, void 0, ident);\n          case \"ultra-condensed\":\n          case \"extra-condensed\":\n          case \"semi-condensed\":\n          case \"condensed\":\n          case \"expanded\":\n          case \"semi-expanded\":\n          case \"extra-expanded\":\n          case \"ultra-expanded\": return FontParser.parseRest(input, void 0, void 0, void 0, ident);\n          case \"large\":\n          case \"larger\":\n          case \"medium\":\n          case \"small\":\n          case \"smaller\":\n          case \"x-large\":\n          case \"x-small\":\n          case \"xx-large\":\n          case \"xx-small\": return FontParser.parseRest(input, void 0, void 0, void 0, void 0, ident);\n\n          case \"translate3d\":\n          case \"translateX\":\n          case \"translateY\":\n          case \"translate\": return TranslateTransformParser.parseRest(input, identOutput);\n          case \"scaleX\":\n          case \"scaleY\":\n          case \"scale\": return ScaleTransformParser.parseRest(input, identOutput);\n          case \"rotate\": return RotateTransformParser.parseRest(input, identOutput);\n          case \"skewX\":\n          case \"skewY\":\n          case \"skew\": return SkewTransformParser.parseRest(input, identOutput);\n          case \"matrix\": return AffineTransformParser.parseRest(input, identOutput);\n          case \"none\": return Parser.done(Transform.identity());\n\n          case \"true\": return Parser.done(true);\n          case \"false\": return Parser.done(false);\n          default: {\n            const color = Color.forName(ident);\n            if (color !== null) {\n              return Parser.done(color);\n            }\n            return Parser.error(Diagnostic.message(\"unknown style value: \" + ident, input));\n          }\n        }\n      }\n    }\n    if (step === 3) {\n      if (valueParser === void 0) {\n        valueParser = Base10.parseDecimal(input);\n      } else {\n        valueParser = valueParser.feed(input);\n      }\n      if (valueParser.isDone()) {\n        step = 4;\n      } else if (valueParser.isError()) {\n        return valueParser.asError();\n      }\n    }\n    if (step === 4) {\n      if (input.isCont() && (c = input.head(), c === 45/*'-'*/)) {\n        input.step();\n        const date = {} as DateTimeInit;\n        date.year = valueParser!.bind();\n        return DateTimeFormat.pattern('%m-%dT%H:%M:%S.%LZ').parseDate(input, date);\n      } else if (!input.isEmpty()) {\n        step = 5;\n      }\n    }\n    if (step === 5) {\n      unitsOutput = unitsOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || c === 37/*'%'*/)) {\n        input.step();\n        unitsOutput.push(c);\n      }\n      if (!input.isEmpty()) {\n        step = 6;\n      }\n    }\n    if (step === 6) {\n      if (!input.isEmpty()) {\n        const value = valueParser!.bind();\n        const units = unitsOutput!.bind();\n        let styleValue: Angle | Length | number;\n        switch (units) {\n          case \"deg\": styleValue = Angle.deg(value); break;\n          case \"rad\": styleValue = Angle.rad(value); break;\n          case \"grad\": styleValue = Angle.grad(value); break;\n          case \"turn\": styleValue = Angle.turn(value); break;\n\n          case \"px\": styleValue = Length.px(value); break;\n          case \"em\": styleValue = Length.em(value); break;\n          case \"rem\": styleValue = Length.rem(value); break;\n          case \"%\": styleValue = Length.pct(value); break;\n\n          case \"\": styleValue = value; break;\n          default: return Parser.error(Diagnostic.message(\"unknown style units: \" + units, input));\n        }\n        if (input.isCont() && (c = input.head(), Unicode.isSpace(c) || c === 47/*'/'*/)) {\n          if (styleValue instanceof Length) {\n            return FontParser.parseRest(input, void 0, void 0, void 0, void 0, styleValue);\n          } else if (typeof styleValue === \"number\") {\n            switch (value) {\n              case 100:\n              case 200:\n              case 300:\n              case 400:\n              case 500:\n              case 600:\n              case 700:\n              case 800:\n              case 900: return FontParser.parseRest(input, void 0, void 0, String(value) as FontWeight);\n            }\n          }\n        }\n        return Parser.done(styleValue);\n      }\n    }\n    return new StyleValueParser(identOutput, valueParser, unitsOutput, step);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport interface ToAttributeString {\n  toAttributeString(): string;\n}\n\n/** @public */\nexport function ToAttributeString(value: unknown): string {\n  if (typeof value === \"object\" && value !== null) {\n    if (typeof (value as ToAttributeString).toAttributeString === \"function\") {\n      return (value as ToAttributeString).toAttributeString();\n    } else {\n      return value.toString();\n    }\n  }\n  return \"\" + value;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport interface ToStyleString {\n  toStyleString(): string;\n}\n\n/** @public */\nexport function ToStyleString(value: unknown): string {\n  if (typeof value === \"object\" && value !== null) {\n    if (typeof (value as ToStyleString).toStyleString === \"function\") {\n      return (value as ToStyleString).toStyleString();\n    } else {\n      return value.toString();\n    }\n  }\n  return \"\" + value;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {ToStyleString} from \"./ToStyleString\";\n\n/** @public */\nexport interface ToCssValue {\n  toCssValue(): CSSStyleValue | null;\n}\n\n/** @public */\nexport const ToCssValue = (function () {\n  let ToCssValue: (value: unknown) => CSSStyleValue | null;\n\n  if (typeof CSSStyleValue !== \"undefined\") { // CSS Typed OM support\n    ToCssValue = function (value: unknown): CSSStyleValue | null {\n      if (typeof value === \"object\" && value !== null &&\n          typeof (value as ToCssValue).toCssValue === \"function\") {\n        return (value as ToCssValue).toCssValue();\n      } else if (typeof value === \"number\") {\n        return new CSSUnitValue(value, \"number\");\n      }\n      return null;\n    };\n  } else {\n    ToCssValue = ToStyleString;\n  }\n\n  return ToCssValue;\n})();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Murmur3} from \"@swim/util\";\nimport type {Equivalent} from \"@swim/util\";\nimport type {HashCode} from \"@swim/util\";\nimport {Numbers} from \"@swim/util\";\nimport {Constructors} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport {Affinity} from \"@swim/component\";\nimport type {AnimatorClass} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\n\n/** @public */\nexport type FocusLike = Focus | FocusInit | boolean;\n\n/** @public */\nexport const FocusLike = {\n  [Symbol.hasInstance](instance: unknown): instance is FocusLike {\n    return instance instanceof Focus\n        || FocusInit[Symbol.hasInstance](instance)\n        || typeof instance === \"boolean\";\n  },\n};\n\n/** @public */\nexport interface FocusInit {\n  /** @internal */\n  readonly typeid?: \"FocusInit\";\n  readonly phase: number;\n  readonly direction: number;\n}\n\n/** @public */\nexport const FocusInit = {\n  [Symbol.hasInstance](instance: unknown): instance is FocusInit {\n    return Objects.hasAllKeys<FocusInit>(instance, \"phase\", \"direction\");\n  },\n};\n\n/** @public */\nexport class Focus implements Interpolate<Focus>, HashCode, Equivalent, Debug {\n  constructor(phase: number, direction: number) {\n    this.phase = phase;\n    this.direction = direction;\n  }\n\n  /** @internal */\n  declare readonly typeid?: \"Focus\";\n\n  likeType?(like: FocusInit | boolean): void;\n\n  readonly phase: number;\n\n  withPhase(phase: number): Focus {\n    if (phase === this.phase) {\n      return this;\n    }\n    return Focus.create(phase, this.direction);\n  }\n\n  readonly direction: number;\n\n  withDirection(direction: number): Focus {\n    if (direction === this.direction) {\n      return this;\n    }\n    return Focus.create(this.phase, direction);\n  }\n\n  get unfocused(): boolean {\n    return this.phase === 0 && this.direction === 0;\n  }\n\n  get focused(): boolean {\n    return this.phase === 1 && this.direction === 0;\n  }\n\n  get focusing(): boolean {\n    return this.direction > 0;\n  }\n\n  get unfocusing(): boolean {\n    return this.direction < 0;\n  }\n\n  asFocusing(): Focus {\n    if (this.focusing) {\n      return this;\n    }\n    return Focus.focusing(this.phase);\n  }\n\n  asUnfocusing(): Focus {\n    if (this.unfocusing) {\n      return this;\n    }\n    return Focus.unfocusing(this.phase);\n  }\n\n  asToggling(): Focus {\n    if (this.direction > 0 || this.phase >= 0.5) {\n      return Focus.unfocusing(this.phase);\n    } else if (this.direction < 0 || this.phase < 0.5) {\n      return Focus.focusing(this.phase);\n    }\n    return this;\n  }\n\n  asToggled(): Focus {\n    if (this.direction > 0 || this.phase >= 0.5) {\n      return Focus.unfocused();\n    } else if (this.direction < 0 || this.phase < 0.5) {\n      return Focus.focused();\n    }\n    return this;\n  }\n\n  /** @override */\n  interpolateTo(that: Focus): Interpolator<Focus>;\n  interpolateTo(that: unknown): Interpolator<Focus> | null;\n  interpolateTo(that: unknown): Interpolator<Focus> | null {\n    if (that instanceof Focus) {\n      return FocusInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Focus) {\n      return Numbers.equivalent(this.phase, that.phase, epsilon)\n          && Numbers.equivalent(this.direction, that.direction, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Focus) {\n      return this.phase === that.phase && this.direction === that.direction;\n    }\n    return false;\n  }\n\n  /** @override */\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(Focus),\n        Numbers.hash(this.phase)), Numbers.hash(this.direction)));\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Focus\").write(46/*'.'*/);\n    if (this.phase === 0 && this.direction === 0) {\n      output = output.write(\"unfocused\").write(40/*'('*/);\n    } else if (this.phase === 1 && this.direction === 0) {\n      output = output.write(\"focused\").write(40/*'('*/);\n    } else if (this.direction === 1) {\n      output = output.write(\"focusing\").write(40/*'('*/);\n      if (this.phase !== 0) {\n        output = output.debug(this.phase);\n      }\n    } else if (this.direction === -1) {\n      output = output.write(\"unfocusing\").write(40/*'('*/);\n      if (this.phase !== 1) {\n        output = output.debug(this.phase);\n      }\n    } else {\n      output = output.write(\"create\").write(40/*'('*/).debug(this.phase);\n      if (this.direction !== 0) {\n        output = output.write(\", \").debug(this.direction);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static unfocused(): Focus {\n    return new Focus(0, 0);\n  }\n\n  @Lazy\n  static focused(): Focus {\n    return new Focus(1, 0);\n  }\n\n  static focusing(phase?: number): Focus {\n    if (phase === void 0) {\n      phase = 0;\n    }\n    return new Focus(phase, 1);\n  }\n\n  static unfocusing(phase?: number): Focus {\n    if (phase === void 0) {\n      phase = 1;\n    }\n    return new Focus(phase, -1);\n  }\n\n  static create(phase: number, direction?: number): Focus {\n    if (direction === void 0) {\n      direction = 0;\n    }\n    if (phase === 0 && direction === 0) {\n      return Focus.unfocused();\n    } else if (phase === 1 && direction === 0) {\n      return Focus.focused();\n    }\n    return new Focus(phase, direction);\n  }\n\n  static fromLike<T extends FocusLike | null | undefined>(value: T): Focus | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Focus) {\n      return value as Focus | Uninitable<T>;\n    } else if (FocusInit[Symbol.hasInstance](value)) {\n      return Focus.fromInit(value);\n    } else if (value === true) {\n      return Focus.focused();\n    } else if (value === false) {\n      return Focus.unfocused();\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(value: FocusInit): Focus {\n    return new Focus(value.phase, value.direction);\n  }\n}\n\n/** @internal */\nexport const FocusInterpolator = (function (_super: typeof Interpolator) {\n  const FocusInterpolator = function (f0: Focus, f1: Focus): Interpolator<Focus> {\n    const interpolator = function (u: number): Focus {\n      const f0 = interpolator[0];\n      const f1 = interpolator[1];\n      const phase = f0.phase + u * (f1.phase - f0.phase);\n      const direction = u !== 1 ? f0.direction : f1.direction;\n      return Focus.create(phase, direction);\n    } as Interpolator<Focus>;\n    Object.setPrototypeOf(interpolator, FocusInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = f0;\n    (interpolator as Mutable<typeof interpolator>)[1] = f1;\n    return interpolator;\n  } as {\n    (f0: Focus, f1: Focus): Interpolator<Focus>;\n\n    /** @internal */\n    prototype: Interpolator<Focus>;\n  };\n\n  FocusInterpolator.prototype = Object.create(_super.prototype);\n  FocusInterpolator.prototype.constructor = FocusInterpolator;\n\n  return FocusInterpolator;\n})(Interpolator);\n\n/** @public */\nexport interface FocusAnimator<R = any, T extends Focus | null | undefined = Focus | null | undefined, I extends any[] = [T]> extends Animator<R, T, I> {\n  get phase(): number | undefined;\n\n  getPhase(): number;\n\n  getPhaseOr<E>(elsePhase: E): number | E;\n\n  setPhase(newPhase: number, timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  setPhase(newPhase: number, timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  get direction(): number;\n\n  setDirection(newDirection: number, timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  setDirection(newDirection: number, timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  get unfocused(): boolean;\n\n  get focused(): boolean;\n\n  get focusing(): boolean;\n\n  get unfocusing(): boolean;\n\n  focus(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  focus(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  unfocus(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  unfocus(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  toggle(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  toggle(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  /** @protected @override */\n  willSetState(newState: T, oldState: T): void;\n\n  /** @override @protected */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected */\n  willFocus(): void;\n\n  /** @protected */\n  didFocus(): void;\n\n  /** @protected */\n  willUnfocus(): void;\n\n  /** @protected */\n  didUnfocus(): void;\n\n  /** @override */\n  equalValues(newState: T, oldState: T | undefined): boolean;\n}\n\n/** @public */\nexport const FocusAnimator = (<R, T extends Focus | null | undefined, I extends any[], A extends FocusAnimator<any, any, any>>() => Animator.extend<FocusAnimator<R, T, I>, AnimatorClass<A>>(\"FocusAnimator\", {\n  valueType: Focus,\n\n  get phase(): number | undefined {\n    const value = this.value;\n    return value !== void 0 && value !== null ? value.phase : void 0;\n  },\n\n  getPhase(this: FocusAnimator): number {\n    return this.getValue().phase;\n  },\n\n  getPhaseOr<E>(elsePhase: E): number | E {\n    const value = this.value;\n    if (value === void 0 || value === null) {\n      return elsePhase;\n    }\n    return value.phase;\n  },\n\n  setPhase(newPhase: number, timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const value = this.value;\n    if (value === void 0 || value === null) {\n      return;\n    } else if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n    this.setState(value.withPhase(newPhase) as T, timing, affinity);\n  },\n\n  get direction(): number {\n    const value = this.value;\n    return value !== void 0 && value !== null ? value.direction : 0;\n  },\n\n  setDirection(newDirection: number, timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n    this.setState(oldValue.withDirection(newDirection) as T, timing, affinity);\n  },\n\n  get unfocused(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.unfocused;\n  },\n\n  get focused(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.focused;\n  },\n\n  get focusing(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.focusing;\n  },\n\n  get unfocusing(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.unfocusing;\n  },\n\n  focus(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    this.setState(Focus.focused() as T, timing as any, affinity);\n  },\n\n  unfocus(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    this.setState(Focus.unfocused() as T, timing as any, affinity);\n  },\n\n  toggle(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue !== void 0 && oldValue !== null) {\n      this.setState(oldValue.asToggled() as T, timing as any, affinity);\n    }\n  },\n\n  willSetState(newState: T, oldState: T): void {\n    super.willSetState(newState, oldState);\n    const oldValue = this.value;\n    if (oldValue !== void 0 && oldValue !== null && newState !== void 0 && newState !== null) {\n      if (newState.focused) {\n        this.setValue(oldValue.asFocusing() as T, Affinity.Reflexive);\n      } else if (newState.unfocused) {\n        this.setValue(oldValue.asUnfocusing() as T, Affinity.Reflexive);\n      }\n    }\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    super.onSetValue(newValue, oldValue);\n    if (newValue === void 0 || newValue === null || oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (newValue.focusing && !oldValue.focusing) {\n      this.willFocus();\n    } else if (newValue.focused && !oldValue.focused) {\n      this.didFocus();\n    } else if (newValue.unfocusing && !oldValue.unfocusing) {\n      this.willUnfocus();\n    } else if (newValue.unfocused && !oldValue.unfocused) {\n      this.didUnfocus();\n    }\n  },\n\n  willFocus(this: FocusAnimator): void {\n    // hook\n  },\n\n  didFocus(this: FocusAnimator): void {\n    // hook\n  },\n\n  willUnfocus(this: FocusAnimator): void {\n    // hook\n  },\n\n  didUnfocus(this: FocusAnimator): void {\n    // hook\n  },\n\n  equalValues(newState: T | undefined, oldState: T | undefined): boolean {\n    if (newState !== void 0 && newState !== null) {\n      return newState.equals(oldState);\n    }\n    return newState === oldState;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Murmur3} from \"@swim/util\";\nimport type {Equivalent} from \"@swim/util\";\nimport type {HashCode} from \"@swim/util\";\nimport {Numbers} from \"@swim/util\";\nimport {Constructors} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport {Affinity} from \"@swim/component\";\nimport type {AnimatorClass} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\n\n/** @public */\nexport type PresenceLike = Presence | PresenceInit | boolean;\n\n/** @public */\nexport const PresenceLike = {\n  [Symbol.hasInstance](instance: unknown): instance is PresenceLike {\n    return instance instanceof Presence\n        || PresenceInit[Symbol.hasInstance](instance)\n        || typeof instance === \"boolean\";\n  },\n};\n\n/** @public */\nexport interface PresenceInit {\n  /** @internal */\n  readonly typeid?: \"PresenceInit\";\n  readonly phase: number;\n  readonly direction: number;\n}\n\n/** @public */\nexport const PresenceInit = {\n  [Symbol.hasInstance](instance: unknown): instance is PresenceInit {\n    return Objects.hasAllKeys<PresenceInit>(instance, \"phase\", \"direction\");\n  },\n};\n\n/** @public */\nexport class Presence implements Interpolate<Presence>, HashCode, Equivalent, Debug {\n  constructor(phase: number, direction: number) {\n    this.phase = phase;\n    this.direction = direction;\n  }\n\n  /** @internal */\n  declare readonly typeid?: \"Presence\";\n\n  likeType?(like: PresenceInit | boolean): void;\n\n  readonly phase: number;\n\n  withPhase(phase: number): Presence {\n    if (phase === this.phase) {\n      return this;\n    }\n    return Presence.create(phase, this.direction);\n  }\n\n  readonly direction: number;\n\n  withDirection(direction: number): Presence {\n    if (direction === this.direction) {\n      return this;\n    }\n    return Presence.create(this.phase, direction);\n  }\n\n  get dismissed(): boolean {\n    return this.phase === 0 && this.direction === 0;\n  }\n\n  get presented(): boolean {\n    return this.phase === 1 && this.direction === 0;\n  }\n\n  get presenting(): boolean {\n    return this.direction > 0;\n  }\n\n  get dismissing(): boolean {\n    return this.direction < 0;\n  }\n\n  asPresenting(): Presence {\n    if (this.presenting) {\n      return this;\n    }\n    return Presence.presenting(this.phase);\n  }\n\n  asDismissing(): Presence {\n    if (this.dismissing) {\n      return this;\n    }\n    return Presence.dismissing(this.phase);\n  }\n\n  asToggling(): Presence {\n    if (this.direction > 0 || this.phase >= 0.5) {\n      return Presence.dismissing(this.phase);\n    } else if (this.direction < 0 || this.phase < 0.5) {\n      return Presence.presenting(this.phase);\n    }\n    return this;\n  }\n\n  asToggled(): Presence {\n    if (this.direction > 0 || this.phase >= 0.5) {\n      return Presence.dismissed();\n    } else if (this.direction < 0 || this.phase < 0.5) {\n      return Presence.presented();\n    }\n    return this;\n  }\n\n  /** @override */\n  interpolateTo(that: Presence): Interpolator<Presence>;\n  interpolateTo(that: unknown): Interpolator<Presence> | null;\n  interpolateTo(that: unknown): Interpolator<Presence> | null {\n    if (that instanceof Presence) {\n      return PresenceInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Presence) {\n      return Numbers.equivalent(this.phase, that.phase, epsilon)\n          && Numbers.equivalent(this.direction, that.direction, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Presence) {\n      return this.phase === that.phase && this.direction === that.direction;\n    }\n    return false;\n  }\n\n  /** @override */\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(Presence),\n        Numbers.hash(this.phase)), Numbers.hash(this.direction)));\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Presence\").write(46/*'.'*/);\n    if (this.phase === 0 && this.direction === 0) {\n      output = output.write(\"dismissed\").write(40/*'('*/);\n    } else if (this.phase === 1 && this.direction === 0) {\n      output = output.write(\"presented\").write(40/*'('*/);\n    } else if (this.direction === 1) {\n      output = output.write(\"presenting\").write(40/*'('*/);\n      if (this.phase !== 0) {\n        output = output.debug(this.phase);\n      }\n    } else if (this.direction === -1) {\n      output = output.write(\"dismissing\").write(40/*'('*/);\n      if (this.phase !== 1) {\n        output = output.debug(this.phase);\n      }\n    } else {\n      output = output.write(\"create\").write(40/*'('*/).debug(this.phase);\n      if (this.direction !== 0) {\n        output = output.write(\", \").debug(this.direction);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static dismissed(): Presence {\n    return new Presence(0, 0);\n  }\n\n  @Lazy\n  static presented(): Presence {\n    return new Presence(1, 0);\n  }\n\n  static presenting(phase?: number): Presence {\n    if (phase === void 0) {\n      phase = 0;\n    }\n    return new Presence(phase, 1);\n  }\n\n  static dismissing(phase?: number): Presence {\n    if (phase === void 0) {\n      phase = 1;\n    }\n    return new Presence(phase, -1);\n  }\n\n  static create(phase: number, direction?: number): Presence {\n    if (direction === void 0) {\n      direction = 0;\n    }\n    if (phase === 0 && direction === 0) {\n      return Presence.dismissed();\n    } else if (phase === 1 && direction === 0) {\n      return Presence.presented();\n    }\n    return new Presence(phase, direction);\n  }\n\n  static fromLike<T extends PresenceLike | null | undefined>(value: T): Presence | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Presence) {\n      return value as Presence | Uninitable<T>;\n    } else if (PresenceInit[Symbol.hasInstance](value)) {\n      return Presence.fromInit(value);\n    } else if (value === true) {\n      return Presence.presented();\n    } else if (value === false) {\n      return Presence.dismissed();\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(value: PresenceInit): Presence {\n    return new Presence(value.phase, value.direction);\n  }\n}\n\n/** @internal */\nexport const PresenceInterpolator = (function (_super: typeof Interpolator) {\n  const PresenceInterpolator = function (p0: Presence, p1: Presence): Interpolator<Presence> {\n    const interpolator = function (u: number): Presence {\n      const p0 = interpolator[0];\n      const p1 = interpolator[1];\n      const phase = p0.phase + u * (p1.phase - p0.phase);\n      const direction = u !== 1 ? p0.direction : p1.direction;\n      return Presence.create(phase, direction);\n    } as Interpolator<Presence>;\n    Object.setPrototypeOf(interpolator, PresenceInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = p0;\n    (interpolator as Mutable<typeof interpolator>)[1] = p1;\n    return interpolator;\n  } as {\n    (p0: Presence, p1: Presence): Interpolator<Presence>;\n\n    /** @internal */\n    prototype: Interpolator<Presence>;\n  };\n\n  PresenceInterpolator.prototype = Object.create(_super.prototype);\n  PresenceInterpolator.prototype.constructor = PresenceInterpolator;\n\n  return PresenceInterpolator;\n})(Interpolator);\n\n/** @public */\nexport interface PresenceAnimator<R = any, T extends Presence | null | undefined = Presence | null | undefined, I extends any[] = [T]> extends Animator<R, T, I> {\n  get phase(): number | undefined;\n\n  getPhase(): number;\n\n  getPhaseOr<E>(elsePhase: E): number | E;\n\n  setPhase(newPhase: number, timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  setPhase(newPhase: number, timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  get direction(): number;\n\n  setDirection(newDirection: number, timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  setDirection(newDirection: number, timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  get dismissed(): boolean;\n\n  get presented(): boolean;\n\n  get presenting(): boolean;\n\n  get dismissing(): boolean;\n\n  present(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  present(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  dismiss(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  dismiss(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  toggle(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  toggle(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  /** @protected @override */\n  willSetState(newState: T, oldState: T): void;\n\n  /** @override @protected */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected */\n  willPresent(): void;\n\n  /** @protected */\n  didPresent(): void;\n\n  /** @protected */\n  willDismiss(): void;\n\n  /** @protected */\n  didDismiss(): void;\n\n  /** @override */\n  equalValues(newValue: T, oldValue: T | undefined): boolean;\n}\n\n/** @public */\nexport const PresenceAnimator = (<R, T extends Presence | null | undefined, I extends any[], A extends PresenceAnimator<any, any, any>>() => Animator.extend<PresenceAnimator<R, T, I>, AnimatorClass<A>>(\"PresenceAnimator\", {\n  valueType: Presence,\n\n  get phase(): number | undefined {\n    const value = this.value;\n    return value !== void 0 && value !== null ? value.phase : void 0;\n  },\n\n  getPhase(): number {\n    return this.getValue().phase;\n  },\n\n  getPhaseOr<E>(elsePhase: E): number | E {\n    const value = this.value;\n    if (value === void 0 || value === null) {\n      return elsePhase;\n    }\n    return value.phase;\n  },\n\n  setPhase(newPhase: number, timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n    this.setState(oldValue.withPhase(newPhase) as T, timing, affinity);\n  },\n\n  get direction(): number {\n    const value = this.value;\n    return value !== void 0 && value !== null ? value.direction : 0;\n  },\n\n  setDirection(newDirection: number, timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n    this.setState(oldValue.withDirection(newDirection) as T, timing, affinity);\n  },\n\n  get dismissed(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.dismissed;\n  },\n\n  get presented(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.presented;\n  },\n\n  get presenting(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.presenting;\n  },\n\n  get dismissing(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.dismissing;\n  },\n\n  present(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    this.setState(Presence.presented() as T, timing as any, affinity);\n  },\n\n  dismiss(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    this.setState(Presence.dismissed() as T, timing as any, affinity);\n  },\n\n  toggle(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue !== void 0 && oldValue !== null) {\n      this.setState(oldValue.asToggled() as T, timing as any, affinity);\n    }\n  },\n\n  willSetState(newState: T, oldState: T): void {\n    super.willSetState(newState, oldState);\n    const oldValue = this.value;\n    if (oldValue !== void 0 && oldValue !== null && newState !== void 0 && newState !== null) {\n      if (newState.presented) {\n        this.setValue(oldValue.asPresenting() as T, Affinity.Reflexive);\n      } else if (newState.dismissed) {\n        this.setValue(oldValue.asDismissing() as T, Affinity.Reflexive);\n      }\n    }\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    super.onSetValue(newValue, oldValue);\n    if (newValue === void 0 || newValue === null || oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (newValue.presenting && !oldValue.presenting) {\n      this.willPresent();\n    } else if (newValue.presented && !oldValue.presented) {\n      this.didPresent();\n    } else if (newValue.dismissing && !oldValue.dismissing) {\n      this.willDismiss();\n    } else if (newValue.dismissed && !oldValue.dismissed) {\n      this.didDismiss();\n    }\n  },\n\n  willPresent(): void {\n    // hook\n  },\n\n  didPresent(): void {\n    // hook\n  },\n\n  willDismiss(): void {\n    // hook\n  },\n\n  didDismiss(): void {\n    // hook\n  },\n\n  equalValues(newValue: T | undefined, oldState: T | undefined): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldState);\n    }\n    return newValue === oldState;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Murmur3} from \"@swim/util\";\nimport type {Equivalent} from \"@swim/util\";\nimport type {HashCode} from \"@swim/util\";\nimport {Numbers} from \"@swim/util\";\nimport {Constructors} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport {Affinity} from \"@swim/component\";\nimport type {AnimatorClass} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\n\n/** @public */\nexport type ExpansionLike = Expansion | ExpansionInit | boolean;\n\n/** @public */\nexport const ExpansionLike = {\n  [Symbol.hasInstance](instance: unknown): instance is ExpansionLike {\n    return instance instanceof Expansion\n        || ExpansionInit[Symbol.hasInstance](instance)\n        || typeof instance === \"boolean\";\n  },\n};\n\n/** @public */\nexport interface ExpansionInit {\n  /** @internal */\n  readonly typeid?: \"ExpansionInit\";\n  readonly phase: number;\n  readonly direction: number;\n}\n\n/** @public */\nexport const ExpansionInit = {\n  [Symbol.hasInstance](instance: unknown): instance is ExpansionInit {\n    return Objects.hasAllKeys<ExpansionInit>(instance, \"phase\", \"direction\");\n  },\n};\n\n/** @public */\nexport class Expansion implements Interpolate<Expansion>, HashCode, Equivalent, Debug {\n  constructor(phase: number, direction: number) {\n    this.phase = phase;\n    this.direction = direction;\n  }\n\n  /** @internal */\n  declare readonly typeid?: \"Expansion\";\n\n  likeType?(like: ExpansionInit | boolean): void;\n\n  readonly phase: number;\n\n  withPhase(phase: number): Expansion {\n    if (phase === this.phase) {\n      return this;\n    }\n    return Expansion.create(phase, this.direction);\n  }\n\n  readonly direction: number;\n\n  withDirection(direction: number): Expansion {\n    if (direction === this.direction) {\n      return this;\n    }\n    return Expansion.create(this.phase, direction);\n  }\n\n  get collapsed(): boolean {\n    return this.phase === 0 && this.direction === 0;\n  }\n\n  get expanded(): boolean {\n    return this.phase === 1 && this.direction === 0;\n  }\n\n  get expanding(): boolean {\n    return this.direction > 0;\n  }\n\n  get collapsing(): boolean {\n    return this.direction < 0;\n  }\n\n  asExpanding(): Expansion {\n    if (this.expanding) {\n      return this;\n    }\n    return Expansion.expanding(this.phase);\n  }\n\n  asCollapsing(): Expansion {\n    if (this.collapsing) {\n      return this;\n    }\n    return Expansion.collapsing(this.phase);\n  }\n\n  asToggling(): Expansion {\n    if (this.direction > 0 || this.phase >= 0.5) {\n      return Expansion.collapsing(this.phase);\n    } else if (this.direction < 0 || this.phase < 0.5) {\n      return Expansion.expanding(this.phase);\n    }\n    return this;\n  }\n\n  asToggled(): Expansion {\n    if (this.direction > 0 || this.phase >= 0.5) {\n      return Expansion.collapsed();\n    } else if (this.direction < 0 || this.phase < 0.5) {\n      return Expansion.expanded();\n    }\n    return this;\n  }\n\n  /** @override */\n  interpolateTo(that: Expansion): Interpolator<Expansion>;\n  interpolateTo(that: unknown): Interpolator<Expansion> | null;\n  interpolateTo(that: unknown): Interpolator<Expansion> | null {\n    if (that instanceof Expansion) {\n      return ExpansionInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Expansion) {\n      return Numbers.equivalent(this.phase, that.phase, epsilon)\n          && Numbers.equivalent(this.direction, that.direction, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Expansion) {\n      return this.phase === that.phase && this.direction === that.direction;\n    }\n    return false;\n  }\n\n  /** @override */\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(Expansion),\n        Numbers.hash(this.phase)), Numbers.hash(this.direction)));\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Expansion\").write(46/*'.'*/);\n    if (this.phase === 0 && this.direction === 0) {\n      output = output.write(\"collapsed\").write(40/*'('*/);\n    } else if (this.phase === 1 && this.direction === 0) {\n      output = output.write(\"expanded\").write(40/*'('*/);\n    } else if (this.direction === 1) {\n      output = output.write(\"expanding\").write(40/*'('*/);\n      if (this.phase !== 0) {\n        output = output.debug(this.phase);\n      }\n    } else if (this.direction === -1) {\n      output = output.write(\"collapsing\").write(40/*'('*/);\n      if (this.phase !== 1) {\n        output = output.debug(this.phase);\n      }\n    } else {\n      output = output.write(\"create\").write(40/*'('*/).debug(this.phase);\n      if (this.direction !== 0) {\n        output = output.write(\", \").debug(this.direction);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static collapsed(): Expansion {\n    return new Expansion(0, 0);\n  }\n\n  @Lazy\n  static expanded(): Expansion {\n    return new Expansion(1, 0);\n  }\n\n  static expanding(phase?: number): Expansion {\n    if (phase === void 0) {\n      phase = 0;\n    }\n    return new Expansion(phase, 1);\n  }\n\n  static collapsing(phase?: number): Expansion {\n    if (phase === void 0) {\n      phase = 1;\n    }\n    return new Expansion(phase, -1);\n  }\n\n  static create(phase: number, direction?: number): Expansion {\n    if (direction === void 0) {\n      direction = 0;\n    }\n    if (phase === 0 && direction === 0) {\n      return Expansion.collapsed();\n    } else if (phase === 1 && direction === 0) {\n      return Expansion.expanded();\n    }\n    return new Expansion(phase, direction);\n  }\n\n  static fromLike<T extends ExpansionLike | null | undefined>(value: T): Expansion | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Expansion) {\n      return value as Expansion | Uninitable<T>;\n    } else if (ExpansionInit[Symbol.hasInstance](value)) {\n      return Expansion.fromInit(value);\n    } else if (value === true) {\n      return Expansion.expanded();\n    } else if (value === false) {\n      return Expansion.collapsed();\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(value: ExpansionInit): Expansion {\n    return new Expansion(value.phase, value.direction);\n  }\n}\n\n/** @internal */\nexport const ExpansionInterpolator = (function (_super: typeof Interpolator) {\n  const ExpansionInterpolator = function (e0: Expansion, e1: Expansion): Interpolator<Expansion> {\n    const interpolator = function (u: number): Expansion {\n      const e0 = interpolator[0];\n      const e1 = interpolator[1];\n      const phase = e0.phase + u * (e1.phase - e0.phase);\n      const direction = u !== 1 ? e0.direction : e1.direction;\n      return Expansion.create(phase, direction);\n    } as Interpolator<Expansion>;\n    Object.setPrototypeOf(interpolator, ExpansionInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = e0;\n    (interpolator as Mutable<typeof interpolator>)[1] = e1;\n    return interpolator;\n  } as {\n    (e0: Expansion, e1: Expansion): Interpolator<Expansion>;\n\n    /** @internal */\n    prototype: Interpolator<Expansion>;\n  };\n\n  ExpansionInterpolator.prototype = Object.create(_super.prototype);\n  ExpansionInterpolator.prototype.constructor = ExpansionInterpolator;\n\n  return ExpansionInterpolator;\n})(Interpolator);\n\n/** @public */\nexport interface ExpansionAnimator<R = any, T extends Expansion | null | undefined = Expansion | null | undefined, I extends any[] = [T]> extends Animator<R, T, I> {\n  get phase(): number | undefined;\n\n  getPhase(): number;\n\n  getPhaseOr<E>(elsePhase: E): number | E;\n\n  setPhase(newPhase: number, timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  setPhase(newPhase: number, timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  get direction(): number;\n\n  setDirection(newDirection: number, timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  setDirection(newDirection: number, timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  get collapsed(): boolean;\n\n  get expanded(): boolean;\n\n  get expanding(): boolean;\n\n  get collapsing(): boolean;\n\n  expand(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  expand(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  collapse(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  collapse(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  toggle(timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  toggle(timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  /** @protected @override */\n  willSetState(newState: T, oldState: T): void;\n\n  /** @override @protected */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected */\n  willExpand(): void;\n\n  /** @protected */\n  didExpand(): void;\n\n  /** @protected */\n  willCollapse(): void;\n\n  /** @protected */\n  didCollapse(): void;\n\n  /** @override */\n  equalValues(newValue: T, oldValue: T | undefined): boolean;\n}\n\n/** @public */\nexport const ExpansionAnimator = (<R, T extends Expansion | null | undefined, I extends any[], A extends ExpansionAnimator<any, any, any>>() => Animator.extend<ExpansionAnimator<R, T, I>, AnimatorClass<A>>(\"ExpansionAnimator\", {\n  valueType: Expansion,\n\n  get phase(): number | undefined {\n    const value = this.value;\n    return value !== void 0 && value !== null ? value.phase : void 0;\n  },\n\n  getPhase(): number {\n    return this.getValue().phase;\n  },\n\n  getPhaseOr<E>(elsePhase: E): number | E {\n    const value = this.value;\n    if (value === void 0 || value === null) {\n      return elsePhase;\n    }\n    return value.phase;\n  },\n\n  setPhase(newPhase: number, timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n    this.setState(oldValue.withPhase(newPhase) as T, timing, affinity);\n  },\n\n  get direction(): number {\n    const value = this.value;\n    return value !== void 0 && value !== null ? value.direction : 0;\n  },\n\n  setDirection(newDirection: number, timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n    this.setState(oldValue.withDirection(newDirection) as T, timing, affinity);\n  },\n\n  get collapsed(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.collapsed;\n  },\n\n  get expanded(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.expanded;\n  },\n\n  get expanding(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.expanding;\n  },\n\n  get collapsing(): boolean {\n    const value = this.value;\n    return value !== void 0 && value !== null && value.collapsing;\n  },\n\n  expand(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    this.setState(Expansion.expanded() as T, timing as any, affinity);\n  },\n\n  collapse(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    this.setState(Expansion.collapsed() as T, timing as any, affinity);\n  },\n\n  toggle(timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    const oldValue = this.value;\n    if (oldValue !== void 0 && oldValue !== null) {\n      this.setState(oldValue.asToggled() as T, timing as any, affinity);\n    }\n  },\n\n  willSetState(newState: T, oldState: T): void {\n    super.willSetState(newState, oldState);\n    const oldValue = this.value;\n    if (oldValue !== void 0 && oldValue !== null && newState !== void 0 && newState !== null) {\n      if (newState.expanded) {\n        this.setValue(oldValue.asExpanding() as T, Affinity.Reflexive);\n      } else if (newState.collapsed) {\n        this.setValue(oldValue.asCollapsing() as T, Affinity.Reflexive);\n      }\n    }\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    super.onSetValue(newValue, oldValue);\n    if (newValue === void 0 || newValue === null || oldValue === void 0 || oldValue === null) {\n      return;\n    } else if (newValue.expanding && !oldValue.expanding) {\n      this.willExpand();\n    } else if (newValue.expanded && !oldValue.expanded) {\n      this.didExpand();\n    } else if (newValue.collapsing && !oldValue.collapsing) {\n      this.willCollapse();\n    } else if (newValue.collapsed && !oldValue.collapsed) {\n      this.didCollapse();\n    }\n  },\n\n  willExpand(): void {\n    // hook\n  },\n\n  didExpand(): void {\n    // hook\n  },\n\n  willCollapse(): void {\n    // hook\n  },\n\n  didCollapse(): void {\n    // hook\n  },\n\n  equalValues(newValue: T, oldValue: T | undefined): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Arrays} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {Feel} from \"./Feel\";\n\n/** @public */\nexport type LookVectorInit<T> = LookVector<T> | LookVectorArray<T>;\n\n/** @public */\nexport type LookVectorArray<T> = readonly [Feel, T][];\n\n/** @public */\nexport type LookVectorUpdates<T> = readonly [Feel, T | undefined][];\n\n/** @public */\nexport class LookVector<T> implements Equals, Debug {\n  constructor(array: readonly [Feel, T][],\n              index: {readonly [name: string]: number | undefined}) {\n    this.array = array;\n    this.index = index;\n  }\n\n  likeType?(like: LookVectorArray<T>): void;\n\n  /** @internal */\n  readonly array: readonly [Feel, T][];\n\n  /** @internal */\n  readonly index: {readonly [name: string]: number | undefined};\n\n  get size(): number {\n    return this.array.length;\n  }\n\n  isEmpty(): boolean {\n    return this.array.length === 0;\n  }\n\n  has(feel: Feel): boolean;\n  has(name: string): boolean;\n  has(feel: Feel | string): boolean {\n    if (typeof feel === \"object\" && feel !== null || typeof feel === \"function\") {\n      feel = feel.name;\n    }\n    return this.index[feel] !== void 0;\n  }\n\n  get(feel: Feel): T | undefined;\n  get(name: string): T | undefined;\n  get(index: number): T | undefined;\n  get(feel: Feel | string | number | undefined): T | undefined {\n    if (typeof feel === \"object\" && feel !== null || typeof feel === \"function\") {\n      feel = feel.name;\n    }\n    if (typeof feel === \"string\") {\n      feel = this.index[feel];\n    }\n    const entry = typeof feel === \"number\" ? this.array[feel] : void 0;\n    return entry !== void 0 ? entry[1] : void 0;\n  }\n\n  getOr<E>(feel: Feel, elseValue: E): T | E;\n  getOr<E>(name: string, elseValue: E): T | E;\n  getOr<E>(index: number, elseValue: E): T | E;\n  getOr<E>(feel: Feel | string | number | undefined, elseValue: E): T | E {\n    if (typeof feel === \"object\" && feel !== null || typeof feel === \"function\") {\n      feel = feel.name;\n    }\n    if (typeof feel === \"string\") {\n      feel = this.index[feel];\n    }\n    const entry = typeof feel === \"number\" ? this.array[feel] : void 0;\n    return entry !== void 0 ? entry[1] : elseValue;\n  }\n\n  updated(feel: Feel, value: T | undefined): LookVector<T>;\n  updated(updates: LookVectorUpdates<T>): LookVector<T>;\n  updated(updates: LookVectorUpdates<T> | Feel, value?: T | undefined): LookVector<T> {\n    let feel: Feel;\n    let oldArray = this.array;\n    let oldIndex = this.index;\n    let newArray: [Feel, T][] | undefined;\n    let newIndex: {[name: string]: number | undefined} | undefined;\n    const updateCount = Array.isArray(updates) ? updates.length : 1;\n    for (let updateIndex = 0; updateIndex < updateCount; updateIndex += 1) {\n      if (updateIndex === 0 && !Array.isArray(updates)) {\n        feel = updates as Feel;\n      } else {\n        [feel, value] = (updates as LookVectorUpdates<T>)[updateIndex]!;\n      }\n      const i = oldIndex[feel.name];\n      if (value !== void 0 && i !== void 0) { // update\n        const newArray = oldArray.slice(0);\n        newArray[i] = [feel, value];\n        newIndex = oldIndex;\n        oldArray = newArray;\n      } else if (value !== void 0) { // insert\n        const newArray = oldArray.slice(0);\n        const newIndex: {[name: string]: number | undefined} = {};\n        for (const name in oldIndex) {\n          newIndex[name] = oldIndex[name];\n        }\n        newIndex[feel.name] = newArray.length;\n        newArray.push([feel, value]);\n        oldArray = newArray;\n        oldIndex = newIndex;\n      } else if (i !== void 0) { // remove\n        const newArray = new Array<[Feel, T]>();\n        const newIndex: {[name: string]: number | undefined} = {};\n        let k = 0;\n        for (let j = 0; j < oldArray.length; j += 1) {\n          const entry = oldArray[j]!;\n          if (entry[0] !== feel) {\n            newArray[k] = entry;\n            newIndex[entry[0].name] = k;\n            k += 1;\n          }\n        }\n        oldArray = newArray;\n        oldIndex = newIndex;\n      }\n    }\n    if (newArray === void 0 || newIndex === void 0) {\n      return this;\n    }\n    return this.copy(newArray, newIndex);\n  }\n\n  protected copy(array: readonly [Feel, T][],\n                 index?: {readonly [name: string]: number | undefined}): LookVector<T> {\n    return LookVector.fromArray(array, index);\n  }\n\n  forEach<R>(callback: (value: T, feel: Feel) => R | void): R | undefined;\n  forEach<R, S>(callback: (this: S, value: T, feel: Feel) => R | void, thisArg: S): R | undefined;\n  forEach<R, S>(callback: (this: S | undefined, value: T, feel: Feel) => R | void, thisArg?: S): R | undefined {\n    const array = this.array;\n    for (let i = 0; i < array.length; i += 1) {\n      const entry = array[i]!;\n      const result = callback.call(thisArg, entry[1], entry[0]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LookVector) {\n      return Arrays.equal(this.array, that.array);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    const array = this.array;\n    const n = array.length;\n    output = output.write(\"LookVector\").write(46/*'.'*/)\n                   .write(n !== 0 ? \"of\" : \"empty\").write(40/*'('*/);\n    for (let i = 0; i < n; i += 1) {\n      const [feel, value] = array[i]!;\n      if (i !== 0) {\n        output = output.write(\", \");\n      }\n      output = output.write(91/*'['*/).debug(feel).write(\", \").debug(value).write(93/*']'*/);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static empty<T>(): LookVector<T> {\n    return new LookVector(Arrays.empty(), {});\n  }\n\n  static of<T>(...feels: [Feel, T][]): LookVector<T> {\n    return new LookVector(feels, LookVector.index(feels));\n  }\n\n  static fromLike<T, V extends LookVectorInit<T> | null | undefined>(value: V): LookVector<T> | Uninitable<V> {\n    if (value === void 0 || value === null || value instanceof LookVector) {\n      return value as LookVector<T> | Uninitable<V>;\n    } else if (Array.isArray(value)) {\n      return LookVector.fromArray(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromArray<T>(array: readonly [Feel, T][],\n                      index?: {[name: string]: number | undefined}): LookVector<T> {\n    if (index === void 0) {\n      index = LookVector.index(array);\n    }\n    return new LookVector(array, index);\n  }\n\n  /** @internal */\n  static index<T>(array: readonly [Feel, T][]): {readonly [name: string]: number | undefined} {\n    const index: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < array.length; i += 1) {\n      const entry = array[i]!;\n      index[entry[0].name] = i;\n    }\n    return index;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Arrays} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {Look} from \"./Look\";\n\n/** @public */\nexport type FeelVectorLike = FeelVector | FeelVectorArray;\n\n/** @public */\nexport type FeelVectorArray = readonly [Look<unknown>, unknown][];\n\n/** @public */\nexport type FeelVectorUpdates = readonly [Look<unknown>, unknown | undefined][];\n\n/** @public */\nexport class FeelVector implements Interpolate<FeelVector>, Equals, Debug {\n  constructor(array: readonly [Look<unknown>, unknown][],\n              index: {readonly [name: string]: number | undefined}) {\n    this.array = array;\n    this.index = index;\n  }\n\n  likeType?(like: FeelVectorArray): void;\n\n  /** @internal */\n  readonly array: readonly [Look<unknown>, unknown][];\n\n  /** @internal */\n  readonly index: {readonly [name: string]: number | undefined};\n\n  get size(): number {\n    return this.array.length;\n  }\n\n  isEmpty(): boolean {\n    return this.array.length === 0;\n  }\n\n  has(look: Look<any>): boolean;\n  has(name: string): boolean;\n  has(look: Look<any> | string): boolean {\n    if (typeof look === \"object\" && look !== null || typeof look === \"function\") {\n      look = look.name;\n    }\n    return this.index[look] !== void 0;\n  }\n\n  get<T>(look: Look<T>): T | undefined;\n  get(name: string): unknown | undefined;\n  get(index: number): unknown | undefined;\n  get<T>(look: Look<T> | string | number | undefined): T | unknown | undefined {\n    if (typeof look === \"object\" && look !== null || typeof look === \"function\") {\n      look = look.name;\n    }\n    if (typeof look === \"string\") {\n      look = this.index[look];\n    }\n    const entry = typeof look === \"number\" ? this.array[look] : void 0;\n    return entry !== void 0 ? entry[1] : void 0;\n  }\n\n  getOr<T, E>(look: Look<T>, elseValue: E): T | E;\n  getOr(name: string, elseValue: unknown): unknown;\n  getOr(index: number, elseValue: unknown): unknown;\n  getOr<T, E>(look: Look<T> | string | number | undefined, elseValue: E): T | unknown | E {\n    if (typeof look === \"object\" && look !== null || typeof look === \"function\") {\n      look = look.name;\n    }\n    if (typeof look === \"string\") {\n      look = this.index[look];\n    }\n    const entry = typeof look === \"number\" ? this.array[look] : void 0;\n    return entry !== void 0 ? entry[1] : elseValue;\n  }\n\n  updated<T>(look: Look<T>, value: T | LikeType<T> | undefined): FeelVector;\n  updated(updates: FeelVectorUpdates): FeelVector;\n  updated(updates: FeelVectorUpdates | Look<unknown>, value?: unknown | undefined): FeelVector {\n    let look: Look<unknown>;\n    let oldArray = this.array;\n    let oldIndex = this.index;\n    let newArray: [Look<unknown>, unknown][] | undefined;\n    let newIndex: {[name: string]: number | undefined} | undefined;\n    const updateCount = Array.isArray(updates) ? updates.length : 1;\n    for (let updateIndex = 0; updateIndex < updateCount; updateIndex += 1) {\n      if (updateIndex === 0 && !Array.isArray(updates)) {\n        look = updates as Look<unknown>;\n      } else {\n        [look, value] = (updates as FeelVectorUpdates)[updateIndex]!;\n      }\n      const i = oldIndex[look.name];\n      if (value !== void 0 && i !== void 0) { // update\n        const newArray = oldArray.slice(0);\n        newIndex = oldIndex;\n        newArray[i] = [look, value];\n        oldArray = newArray;\n      } else if (value !== void 0) { // insert\n        const newArray = oldArray.slice(0);\n        const newIndex: {[name: string]: number | undefined} = {};\n        for (const name in oldIndex) {\n          newIndex[name] = oldIndex[name];\n        }\n        newIndex[look.name] = newArray.length;\n        newArray.push([look, value]);\n        oldArray = newArray;\n        oldIndex = newIndex;\n      } else if (i !== void 0) { // remove\n        const newArray = new Array<[Look<unknown>, unknown]>();\n        const newIndex: {[name: string]: number | undefined} = {};\n        let k = 0;\n        for (let j = 0; j < oldArray.length; j += 1) {\n          const entry = oldArray[j]!;\n          if (entry[0] !== look) {\n            newArray[k] = entry;\n            newIndex[entry[0].name] = k;\n            k += 1;\n          }\n        }\n        oldArray = newArray;\n        oldIndex = newIndex;\n      }\n    }\n    if (newArray === void 0 || newIndex === void 0) {\n      return this;\n    }\n    return this.copy(newArray, newIndex);\n  }\n\n  plus(that: FeelVector): FeelVector {\n    const thisArray = this.array;\n    const thatArray = that.array;\n    const newArray = new Array<[Look<unknown>, unknown]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < thisArray.length; i += 1) {\n      const entry = thisArray[i]!;\n      const look = entry[0];\n      const y = that.get(look);\n      newIndex[look.name] = newArray.length;\n      newArray.push(y === void 0 ? entry : [look, look.combine(entry[1], y)]);\n    }\n    for (let i = 0; i < thatArray.length; i += 1) {\n      const entry = thatArray[i]!;\n      const look = entry[0];\n      if (newIndex[look.name] === void 0) {\n        newIndex[look.name] = newArray.length;\n        newArray.push(entry);\n      }\n    }\n    return this.copy(newArray, newIndex);\n  }\n\n  negative(): FeelVector {\n    const oldArray = this.array;\n    const n = oldArray.length;\n    const newArray = new Array<[Look<unknown>, unknown]>(n);\n    for (let i = 0; i < n; i += 1) {\n      const [look, x] = oldArray[i]!;\n      newArray[i] = [look, look.combine(void 0, x, -1)];\n    }\n    return this.copy(newArray, this.index);\n  }\n\n  minus(that: FeelVector): FeelVector {\n    const thisArray = this.array;\n    const thatArray = that.array;\n    const newArray = new Array<[Look<unknown>, unknown]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < thisArray.length; i += 1) {\n      const entry = thisArray[i]!;\n      const look = entry[0];\n      const y = that.get(look);\n      newIndex[look.name] = newArray.length;\n      newArray.push(y === void 0 ? entry : [look, look.combine(entry[1], y, -1)]);\n    }\n    for (let i = 0; i < thatArray.length; i += 1) {\n      const [look, y] = thatArray[i]!;\n      if (newIndex[look.name] === void 0) {\n        newIndex[look.name] = newArray.length;\n        newArray.push([look, look.combine(void 0, y, -1)]);\n      }\n    }\n    return this.copy(newArray, newIndex);\n  }\n\n  times(scalar: number): FeelVector {\n    const oldArray = this.array;\n    const n = oldArray.length;\n    const newArray = new Array<[Look<unknown>, unknown]>(n);\n    for (let i = 0; i < n; i += 1) {\n      const [look, x] = oldArray[i]!;\n      newArray[i] = [look, look.combine(void 0, x, scalar)];\n    }\n    return this.copy(newArray, this.index);\n  }\n\n  protected copy(array: readonly [Look<unknown>, unknown][],\n                 index?: {readonly [name: string]: number | undefined}): FeelVector {\n    return FeelVector.fromArray(array, index);\n  }\n\n  forEach<R>(callback: <T>(value: T, look: Look<T>) => R | void): R | undefined;\n  forEach<R, S>(callback: <T>(this: S, value: T, look: Look<T>) => R | void, thisArg: S): R | undefined;\n  forEach<R, S>(callback: <T>(this: S | undefined, value: T, look: Look<T>) => R | void, thisArg?: S): R | undefined {\n    const array = this.array;\n    for (let i = 0; i < array.length; i += 1) {\n      const entry = array[i]!;\n      const result = callback.call(thisArg, entry[1], entry[0]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  /** @override */\n  interpolateTo(that: FeelVector): Interpolator<FeelVector>;\n  interpolateTo(that: unknown): Interpolator<FeelVector> | null;\n  interpolateTo(that: unknown): Interpolator<FeelVector> | null {\n    if (that instanceof FeelVector) {\n      return FeelVectorInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof FeelVector) {\n      return Arrays.equal(this.array, that.array);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    const array = this.array;\n    const n = array.length;\n    output = output.write(\"FeelVector\").write(46/*'.'*/)\n                   .write(n !== 0 ? \"of\" : \"empty\").write(40/*'('*/);\n    for (let i = 0; i < n; i += 1) {\n      const [look, value] = array[i]!;\n      if (i !== 0) {\n        output = output.write(\", \");\n      }\n      output = output.write(91/*'['*/).debug(look).write(\", \").debug(value).write(93/*']'*/);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static empty(): FeelVector {\n    return new FeelVector(Arrays.empty(), {});\n  }\n\n  static of(...looks: [Look<unknown>, unknown][]): FeelVector {\n    const n = looks.length;\n    const array = new Array<[Look<unknown>, unknown]>(n);\n    const index: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < n; i += 1) {\n      const [look, value] = looks[i]!;\n      array[i] = [look, look.coerce(value)];\n      index[look.name] = i;\n    }\n    return new FeelVector(array, index);\n  }\n\n  static fromLike<V extends FeelVectorLike | null | undefined>(value: V): FeelVector | Uninitable<V> {\n    if (value === void 0 || value === null || value instanceof FeelVector) {\n      return value as FeelVector | Uninitable<V>;\n    } else if (Array.isArray(value)) {\n      return FeelVector.of(...value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromArray(array: readonly [Look<unknown>, unknown][],\n                   index?: {readonly [name: string]: number | undefined}): FeelVector {\n    if (index === void 0) {\n      index = FeelVector.index(array);\n    }\n    return new FeelVector(array, index);\n  }\n\n  /** @internal */\n  static index<T>(array: readonly [Look<T>, T][]): {readonly [name: string]: number | undefined} {\n    const index: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < array.length; i += 1) {\n      const entry = array[i]!;\n      index[entry[0].name] = i;\n    }\n    return index;\n  }\n}\n\n/** @internal */\nexport interface FeelVectorInterpolator extends Interpolator<FeelVector> {\n  /** @internal */\n  readonly interpolators: readonly [Look<unknown>, Interpolator<unknown>][];\n  /** @internal */\n  readonly index: {readonly [name: string]: number | undefined};\n\n  get 0(): FeelVector;\n\n  get 1(): FeelVector;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const FeelVectorInterpolator = (function (_super: typeof Interpolator) {\n  const FeelVectorInterpolator = function (v0: FeelVector, v1: FeelVector): FeelVectorInterpolator {\n    const interpolator = function (u: number): FeelVector {\n      const interpolators = interpolator.interpolators;\n      const interpolatorCount = interpolators.length;\n      const array = new Array<[Look<unknown>, unknown]>(interpolatorCount);\n      const index = interpolator.index;\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        const [look, interpolator] = interpolators[i]!;\n        const value = interpolator(u);\n        array[i] = [look, value];\n      }\n      return FeelVector.fromArray(array, index);\n    } as FeelVectorInterpolator;\n    Object.setPrototypeOf(interpolator, FeelVectorInterpolator.prototype);\n    const interpolators = new Array<[Look<unknown>, Interpolator<unknown>]>();\n    const index: {[name: string]: number | undefined} = {};\n    v0.forEach(function <T>(a: T, look: Look<T>): void {\n      const b = v1.get(look);\n      if (b !== void 0) {\n        const interpolator = look.between(a, b);\n        index[look.name] = interpolators.length;\n        interpolators.push([look, interpolator]);\n      }\n    });\n    (interpolator as Mutable<typeof interpolator>).interpolators = interpolators;\n    (interpolator as Mutable<typeof interpolator>).index = index;\n    return interpolator;\n  } as {\n    (v0: FeelVector, v1: FeelVector): FeelVectorInterpolator;\n\n    /** @internal */\n    prototype: FeelVectorInterpolator;\n  };\n\n  FeelVectorInterpolator.prototype = Object.create(_super.prototype);\n  FeelVectorInterpolator.prototype.constructor = FeelVectorInterpolator;\n\n  Object.defineProperty(FeelVectorInterpolator.prototype, 0, {\n    get(this: FeelVectorInterpolator): FeelVector {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const array = new Array<[Look<unknown>, unknown]>(interpolatorCount);\n      const index = this.index;\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        const [look, interpolator] = interpolators[i]!;\n        const value = interpolator[0];\n        array[i] = [look, value];\n      }\n      return FeelVector.fromArray(array, index);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(FeelVectorInterpolator.prototype, 1, {\n    get(this: FeelVectorInterpolator): FeelVector {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const array = new Array<[Look<unknown>, unknown]>(interpolatorCount);\n      const index = this.index;\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        const [look, interpolator] = interpolators[i]!;\n        const value = interpolator[1];\n        array[i] = [look, value];\n      }\n      return FeelVector.fromArray(array, index);\n    },\n    configurable: true,\n  });\n\n  FeelVectorInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof FeelVectorInterpolator) {\n      const n = this.interpolators.length;\n      if (n !== that.interpolators.length) {\n        return false;\n      }\n      for (let i = 0; i < n; i += 1) {\n        if (!Arrays.equal(this.interpolators[i]!, that.interpolators[i]!)) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return false;\n  };\n\n  return FeelVectorInterpolator;\n})(Interpolator);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Arrays} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {Feel} from \"./Feel\";\nimport type {Mood} from \"./Mood\";\n\n/** @public */\nexport type MoodVectorLike<M extends Mood = Feel> = MoodVector<M> | MoodVectorArray<M>;\n\n/** @public */\nexport type MoodVectorArray<M extends Mood = Feel> = readonly [M, number][];\n\n/** @public */\nexport type MoodVectorUpdates<M extends Mood = Feel> = readonly [M, number | undefined][];\n\n/** @public */\nexport class MoodVector<M extends Mood = Feel> implements Equals, Debug {\n  constructor(array: readonly [M, number][],\n              index: {readonly [name: string]: number | undefined}) {\n    this.array = array;\n    this.index = index;\n  }\n\n  likeType?(like: MoodVectorArray<M>): void;\n\n  /** @internal */\n  readonly array: readonly [M, number][];\n\n  /** @internal */\n  readonly index: {readonly [name: string]: number | undefined};\n\n  get size(): number {\n    return this.array.length;\n  }\n\n  isEmpty(): boolean {\n    return this.array.length === 0;\n  }\n\n  has(key: M): boolean;\n  has(name: string): boolean;\n  has(key: M | string): boolean {\n    if (typeof key === \"object\" && key !== null || typeof key === \"function\") {\n      key = key.name;\n    }\n    return this.index[key] !== void 0;\n  }\n\n  get(key: M): number | undefined;\n  get(name: string): number | undefined;\n  get(index: number): number | undefined;\n  get(key: M | string | number | undefined): number | undefined {\n    if (typeof key === \"object\" && key !== null || typeof key === \"function\") {\n      key = key.name;\n    }\n    if (typeof key === \"string\") {\n      key = this.index[key];\n    }\n    const entry = typeof key === \"number\" ? this.array[key] : void 0;\n    return entry !== void 0 ? entry[1] : void 0;\n  }\n\n  getOr<E>(key: M, elseValue: E): number | E;\n  getOr<E>(name: string, elseValue: E): number | E;\n  getOr<E>(index: number, elseValue: E): number | E;\n  getOr<E>(key: M | string | number | undefined, elseValue: E): number | E {\n    if (typeof key === \"object\" && key !== null || typeof key === \"function\") {\n      key = key.name;\n    }\n    if (typeof key === \"string\") {\n      key = this.index[key];\n    }\n    const entry = typeof key === \"number\" ? this.array[key] : void 0;\n    return entry !== void 0 ? entry[1] : elseValue;\n  }\n\n  updated(key: M, value: number | undefined): MoodVector<M>;\n  updated(updates: MoodVectorUpdates<M>): MoodVector<M>;\n  updated(updates: MoodVectorUpdates<M> | M, value?: number | undefined): MoodVector<M> {\n    let key: M;\n    let oldArray = this.array;\n    let oldIndex = this.index;\n    let newArray: [M, number][] | undefined;\n    let newIndex: {[name: string]: number | undefined} | undefined;\n    const updateCount = Array.isArray(updates) ? updates.length : 1;\n    for (let updateIndex = 0; updateIndex < updateCount; updateIndex += 1) {\n      if (updateIndex === 0 && !Array.isArray(updates)) {\n        key = updates as M;\n      } else {\n        [key, value] = (updates as MoodVectorUpdates<M>)[updateIndex]!;\n      }\n      const i = oldIndex[key.name];\n      if (value !== void 0 && i !== void 0) { // update\n        newArray = oldArray.slice(0);\n        newIndex = oldIndex;\n        newArray[i] = [key, value];\n        oldArray = newArray;\n      } else if (value !== void 0) { // insert\n        newArray = oldArray.slice(0);\n        newIndex = {};\n        for (const name in oldIndex) {\n          newIndex[name] = oldIndex[name];\n        }\n        newIndex[key.name] = newArray.length;\n        newArray.push([key, value]);\n        oldArray = newArray;\n        oldIndex = newIndex;\n      } else if (i !== void 0) { // remove\n        newArray = new Array<[M, number]>();\n        newIndex = {};\n        let k = 0;\n        for (let j = 0; j < oldArray.length; j += 1) {\n          const entry = oldArray[j]!;\n          if (entry[0] !== key) {\n            newArray[k] = entry;\n            newIndex[entry[0].name] = k;\n            k += 1;\n          }\n        }\n        oldArray = newArray;\n        oldIndex = newIndex;\n      }\n    }\n    if (newArray === void 0 || newIndex === void 0) {\n      return this;\n    }\n    return this.copy(newArray, newIndex);\n  }\n\n  plus(that: MoodVector<M>): MoodVector<M> {\n    const thisArray = this.array;\n    const thatArray = that.array;\n    const newArray = new Array<[M, number]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < thisArray.length; i += 1) {\n      const entry = thisArray[i]!;\n      const key = entry[0];\n      const y = that.get(key);\n      newIndex[key.name] = newArray.length;\n      newArray.push(y === void 0 ? entry : [key, entry[1] + y]);\n    }\n    for (let i = 0; i < thatArray.length; i += 1) {\n      const entry = thatArray[i]!;\n      const key = entry[0];\n      if (newIndex[key.name] === void 0) {\n        newIndex[key.name] = newArray.length;\n        newArray.push(entry);\n      }\n    }\n    return this.copy(newArray, newIndex);\n  }\n\n  negative(): MoodVector<M> {\n    const oldArray = this.array;\n    const n = oldArray.length;\n    const newArray = new Array<[M, number]>(n);\n    for (let i = 0; i < n; i += 1) {\n      const [key, x] = oldArray[i]!;\n      newArray[i] = [key, -x];\n    }\n    return this.copy(newArray, this.index);\n  }\n\n  minus(that: MoodVector<M>): MoodVector<M> {\n    const thisArray = this.array;\n    const thatArray = that.array;\n    const newArray = new Array<[M, number]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < thisArray.length; i += 1) {\n      const entry = thisArray[i]!;\n      const key = entry[0];\n      const y = that.get(key);\n      newIndex[key.name] = newArray.length;\n      newArray.push(y === void 0 ? entry : [key, entry[1] - y]);\n    }\n    for (let i = 0; i < thatArray.length; i += 1) {\n      const [key, y] = thatArray[i]!;\n      if (newIndex[key.name] === void 0) {\n        newIndex[key.name] = newArray.length;\n        newArray.push([key, -y]);\n      }\n    }\n    return this.copy(newArray, newIndex);\n  }\n\n  times(scalar: number): MoodVector<M> {\n    const oldArray = this.array;\n    const n = oldArray.length;\n    const newArray = new Array<[M, number]>(n);\n    for (let i = 0; i < n; i += 1) {\n      const [key, x] = oldArray[i]!;\n      newArray[i] = [key, x * scalar];\n    }\n    return this.copy(newArray, this.index);\n  }\n\n  dot(that: MoodVector<M>): number | undefined {\n    const array = this.array;\n    let combination: number | undefined;\n    for (let i = 0; i < array.length; i += 1) {\n      const [key, x] = array[i]!;\n      const y = that.get(key);\n      if (y === void 0) {\n        continue;\n      } else if (combination === void 0) {\n        combination = x * y;\n      } else {\n        combination += x * y;\n      }\n    }\n    return combination;\n  }\n\n  protected copy(array: readonly [M, number][],\n                 index?: {readonly [name: string]: number | undefined}): MoodVector<M> {\n    return MoodVector.fromArray(array, index);\n  }\n\n  forEach<R>(callback: (value: number, key: M) => R | void): R | undefined;\n  forEach<R, S>(callback: (this: S, value: number, key: M) => R | void, thisArg: S): R | undefined;\n  forEach<R, S>(callback: (this: S | undefined, value: number, key: M) => R | void, thisArg?: S): R | undefined {\n    const array = this.array;\n    for (let i = 0; i < array.length; i += 1) {\n      const entry = array[i]!;\n      const result = callback.call(thisArg, entry[1], entry[0]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof MoodVector) {\n      return Arrays.equal(this.array, that.array);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    const array = this.array;\n    const n = array.length;\n    output = output.write(\"MoodVector\").write(46/*'.'*/)\n                   .write(n !== 0 ? \"of\" : \"empty\").write(40/*'('*/);\n    for (let i = 0; i < n; i += 1) {\n      const [key, value] = array[i]!;\n      if (i !== 0) {\n        output = output.write(\", \");\n      }\n      output = output.write(91/*'['*/).debug(key).write(\", \").debug(value).write(93/*']'*/);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static empty<M extends Mood>(): MoodVector<M> {\n    return new MoodVector(Arrays.empty(), {});\n  }\n\n  static of<M extends Mood>(...keys: [M, number][]): MoodVector<M> {\n    return new MoodVector(keys, MoodVector.index(keys));\n  }\n\n  static fromLike<M extends Mood, V extends MoodVectorLike<M> | null | undefined>(value: V): MoodVector<M> | Uninitable<V> {\n    if (value === void 0 || value === null || value instanceof MoodVector) {\n      return value as MoodVector<M> | Uninitable<V>;\n    } else if (Array.isArray(value)) {\n      return MoodVector.fromArray(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromArray<M extends Mood>(array: readonly [M, number][],\n                                   index?: {[name: string]: number | undefined}): MoodVector<M> {\n    if (index === void 0) {\n      index = MoodVector.index(array);\n    }\n    return new MoodVector(array, index);\n  }\n\n  /** @internal */\n  static index<M extends Mood>(array: readonly [M, unknown][]): {readonly [name: string]: number | undefined} {\n    const index: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < array.length; i += 1) {\n      const entry = array[i]!;\n      index[entry[0].name] = i;\n    }\n    return index;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport {Arrays} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {MoodVectorLike} from \"./MoodVector\";\nimport type {MoodVectorUpdates} from \"./MoodVector\";\nimport {MoodVector} from \"./MoodVector\";\nimport type {Feel} from \"./Feel\";\nimport type {Mood} from \"./Mood\";\n\n/** @public */\nexport class MoodMatrix<M extends Mood = Feel, N extends Mood = Feel> implements Equals, Debug {\n  constructor(rowArray: readonly [M, MoodVector<N>][],\n              rowIndex: {readonly [name: string]: number | undefined},\n              colArray: readonly [N, MoodVector<M>][],\n              colIndex: {readonly [name: string]: number | undefined}) {\n    this.rowArray = rowArray;\n    this.rowIndex = rowIndex;\n    this.colArray = colArray;\n    this.colIndex = colIndex;\n  }\n\n  /** @internal */\n  readonly rowArray: readonly [M, MoodVector<N>][];\n\n  /** @internal */\n  readonly rowIndex: {readonly [name: string]: number | undefined};\n\n  /** @internal */\n  readonly colArray: readonly [N, MoodVector<M>][];\n\n  /** @internal */\n  readonly colIndex: {readonly [name: string]: number | undefined};\n\n  get rowCount(): number {\n    return this.rowArray.length;\n  }\n\n  get colCount(): number {\n    return this.colArray.length;\n  }\n\n  hasRow(rowKey: M): boolean;\n  hasRow(rowKey: string): boolean;\n  hasRow(rowKey: M | string): boolean {\n    if (typeof rowKey === \"object\" && rowKey !== null || typeof rowKey === \"function\") {\n      rowKey = rowKey.name;\n    }\n    return this.rowIndex[rowKey] !== void 0;\n  }\n\n  hasCol(colKey: N): boolean;\n  hasCol(colKey: string): boolean;\n  hasCol(colKey: N | string): boolean {\n    if (typeof colKey === \"object\" && colKey !== null || typeof colKey === \"function\") {\n      colKey = colKey.name;\n    }\n    return this.colIndex[colKey] !== void 0;\n  }\n\n  getRow(rowKey: M): MoodVector<N> | undefined;\n  getRow(rowKey: string): MoodVector<N> | undefined;\n  getRow(rowIndex: number): MoodVector<N> | undefined;\n  getRow(rowKey: M | string | number | undefined): MoodVector<N> | undefined {\n    if (typeof rowKey === \"object\" && rowKey !== null || typeof rowKey === \"function\") {\n      rowKey = rowKey.name;\n    }\n    if (typeof rowKey === \"string\") {\n      rowKey = this.rowIndex[rowKey];\n    }\n    const entry = typeof rowKey === \"number\" ? this.rowArray[rowKey] : void 0;\n    return entry !== void 0 ? entry[1] : void 0;\n  }\n\n  getCol(colKey: N): MoodVector<M> | undefined;\n  getCol(colKey: string): MoodVector<M> | undefined;\n  getCol(colIndex: number): MoodVector<M> | undefined;\n  getCol(colKey: N | string | number | undefined): MoodVector<M> | undefined {\n    if (typeof colKey === \"object\" && colKey !== null || typeof colKey === \"function\") {\n      colKey = colKey.name;\n    }\n    if (typeof colKey === \"string\") {\n      colKey = this.colIndex[colKey];\n    }\n    const entry = typeof colKey === \"number\" ? this.colArray[colKey] : void 0;\n    return entry !== void 0 ? entry[1] : void 0;\n  }\n\n  plus(that: MoodMatrix<M, N>): MoodMatrix<M, N> {\n    const thisColArray = this.colArray;\n    const thatColArray = that.colArray;\n    const newColArray = new Array<[N, MoodVector<M>]>();\n    const newColIndex: {[name: string]: number | undefined} = {};\n    for (let j = 0; j < thisColArray.length; j += 1) {\n      const entry = thisColArray[j]!;\n      const colKey = entry[0];\n      const b = that.getCol(colKey);\n      newColIndex[colKey.name] = newColArray.length;\n      newColArray.push(b === void 0 ? entry : [colKey, entry[1].plus(b)]);\n    }\n    for (let j = 0; j < thatColArray.length; j += 1) {\n      const entry = thatColArray[j]!;\n      const colKey = entry[0];\n      if (newColIndex[colKey.name] === void 0) {\n        newColIndex[colKey.name] = newColArray.length;\n        newColArray.push(entry);\n      }\n    }\n    return MoodMatrix.fromColArray(newColArray, newColIndex);\n  }\n\n  negative(): MoodMatrix<M, N> {\n    const oldColArray = this.colArray;\n    const n = oldColArray.length;\n    const newColArray = new Array<[N, MoodVector<M>]>(n);\n    for (let j = 0; j < n; j += 1) {\n      const [colKey, a] = oldColArray[j]!;\n      newColArray[j] = [colKey, a.negative()];\n    }\n    return MoodMatrix.fromColArray(newColArray, this.colIndex);\n  }\n\n  minus(that: MoodMatrix<M, N>): MoodMatrix<M, N> {\n    const thisColArray = this.colArray;\n    const thatColArray = that.colArray;\n    const newColArray = new Array<[N, MoodVector<M>]>();\n    const newColIndex: {[name: string]: number | undefined} = {};\n    for (let j = 0; j < thisColArray.length; j += 1) {\n      const entry = thisColArray[j]!;\n      const colKey = entry[0];\n      const b = that.getCol(colKey);\n      newColIndex[colKey.name] = newColArray.length;\n      newColArray.push(b === void 0 ? entry : [colKey, entry[1].minus(b)]);\n    }\n    for (let j = 0; j < thatColArray.length; j += 1) {\n      const [colKey, b] = thatColArray[j]!;\n      if (newColIndex[colKey.name] === void 0) {\n        newColIndex[colKey.name] = newColArray.length;\n        newColArray.push([colKey, b.negative()]);\n      }\n    }\n    return MoodMatrix.fromColArray(newColArray, newColIndex);\n  }\n\n  times(scalar: number): MoodMatrix<M, N> {\n    const oldColArray = this.colArray;\n    const n = oldColArray.length;\n    const newColArray = new Array<[N, MoodVector<M>]>(n);\n    for (let j = 0; j < n; j += 1) {\n      const [colKey, a] = oldColArray[j]!;\n      newColArray[j] = [colKey, a.times(scalar)];\n    }\n    return MoodMatrix.fromColArray(newColArray, this.colIndex);\n  }\n\n  dot(rowKey: M | string | number, col: MoodVector<N>): number | undefined;\n  dot(rowKey: M | string | number | undefined, col: MoodVector<N>): number | undefined {\n    if (typeof rowKey === \"object\" && rowKey !== null || typeof rowKey === \"function\") {\n      rowKey = rowKey.name;\n    }\n    if (typeof rowKey === \"string\") {\n      rowKey = this.rowIndex[rowKey];\n    }\n    const entry = typeof rowKey === \"number\" ? this.rowArray[rowKey] : void 0;\n    if (entry === void 0) {\n      return void 0;\n    }\n    rowKey = entry[0];\n    const row = entry[1];\n    return row.dot(col);\n  }\n\n  timesCol(col: MoodVector<N>): MoodVector<M>;\n  timesCol(col: MoodVector<M & N>, implicitIdentity?: boolean): MoodVector<M | M>;\n  timesCol(col: MoodVector<M & N>, implicitIdentity: boolean = false): MoodVector<M | N> {\n    const rowArray = this.rowArray;\n    const newArray = new Array<[M, number]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < rowArray.length; i += 1) {\n      const [rowKey, row] = rowArray[i]!;\n      const value = row.dot(col);\n      if (value !== void 0) {\n        newIndex[rowKey.name] = newArray.length;\n        newArray.push([rowKey, value]);\n      }\n    }\n    if (implicitIdentity) {\n      const thatArray = col.array;\n      for (let i = 0; i < thatArray.length; i += 1) {\n        const rowKey = thatArray[i]![0];\n        if (!this.hasRow(rowKey)) {\n          newIndex[rowKey.name] = newArray.length;\n          newArray.push(thatArray[i]!);\n        }\n      }\n    }\n    return MoodVector.fromArray(newArray, newIndex);\n  }\n\n  timesRow(row: MoodVector<M>): MoodVector<N>;\n  timesRow(row: MoodVector<M & N>, implicitIdentity?: boolean): MoodVector<M | M>;\n  timesRow(row: MoodVector<M & N>, implicitIdentity: boolean = false): MoodVector<M | N> {\n    const colArray = this.colArray;\n    const newArray = new Array<[N, number]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < colArray.length; i += 1) {\n      const [colKey, col] = colArray[i]!;\n      const value = row.dot(col as MoodVector<M & N>);\n      if (value !== void 0) {\n        newIndex[colKey.name] = newArray.length;\n        newArray.push([colKey, value]);\n      }\n    }\n    if (implicitIdentity) {\n      const thatArray = row.array;\n      for (let i = 0; i < thatArray.length; i += 1) {\n        const colKey = thatArray[i]![0];\n        if (!this.hasCol(colKey)) {\n          newIndex[colKey.name] = newArray.length;\n          newArray.push(thatArray[i]!);\n        }\n      }\n    }\n    return MoodVector.fromArray(newArray, newIndex);\n  }\n\n  transform(that: MoodMatrix<N, N>, implicitIdentity: boolean = true): MoodMatrix<M, N> {\n    const thisRowArray = this.rowArray;\n    const thisColArray = this.colArray;\n    const newRowArray = new Array<[M, MoodVector<N>]>();\n    const newRowIndex: {[name: string]: number | undefined} = {};\n    const newColArray = new Array<[N, MoodVector<M>]>();\n    const newColIndex: {[name: string]: number | undefined} = {};\n    for (let j = 0; j < thisColArray.length; j += 1) {\n      const colKey = thisColArray[j]![0];\n      let col = that.getCol(colKey);\n      if (col === void 0 && implicitIdentity) {\n        col = MoodVector.of([colKey, 1]);\n      }\n      if (col === void 0) {\n        continue;\n      }\n      for (let i = 0; i < thisRowArray.length; i += 1) {\n        const [rowKey, row] = thisRowArray[i]!;\n        const value = row.dot(col);\n        if (value === void 0) {\n          continue;\n        }\n        const i2 = newRowIndex[rowKey.name];\n        if (i2 === void 0) {\n          newRowIndex[rowKey.name] = newRowArray.length;\n          newRowArray.push([rowKey, MoodVector.of([colKey, value])]);\n        } else {\n          const newRow = newRowArray[i2]![1];\n          (newRow.index as {[name: string]: number | undefined})[rowKey.name] = newRow.array.length;\n          (newRow.array as [N, number][]).push([colKey, value]);\n        }\n        const j2 = newColIndex[colKey.name];\n        if (j2 === void 0) {\n          newColIndex[colKey.name] = newColArray.length;\n          newColArray.push([colKey, MoodVector.of([rowKey, value])]);\n        } else {\n          const newCol = newColArray[j2]![1];\n          (newCol.index as {[name: string]: number | undefined})[colKey.name] = newCol.array.length;\n          (newCol.array as [M, number][]).push([rowKey, value]);\n        }\n      }\n    }\n    return new MoodMatrix(newRowArray, newRowIndex, newColArray, newColIndex);\n  }\n\n  /** @internal */\n  identityFor(that: MoodMatrix<N, M & N>): MoodMatrix<M, N> {\n    const thisRowArray = this.rowArray;\n    const thatColArray = that.colArray;\n    let newRowArray: Array<[M, MoodVector<N>]> | undefined;\n    let newRowIndex: {[name: string]: number | undefined} | undefined;\n    for (let j = 0; j < thatColArray.length; j += 1) {\n      const colKey = thatColArray[j]![0];\n      if (this.hasRow(colKey)) {\n        continue;\n      } else if (newRowArray === void 0) {\n        newRowArray = thisRowArray.slice(0);\n      }\n      if (newRowIndex === void 0) {\n        newRowIndex = {};\n        for (const name in this.rowIndex) {\n          newRowIndex[name] = this.rowIndex[name];\n        }\n      }\n      newRowIndex[colKey.name] = newRowArray.length;\n      newRowArray.push([colKey, MoodVector.of([colKey, 1])]);\n    }\n    if (newRowArray === void 0 || newRowIndex === void 0) {\n      return this;\n    }\n    return MoodMatrix.fromRowArray(newRowArray, newRowIndex);\n  }\n\n  row(rowKey: M, row: MoodVectorLike<N> | undefined): MoodMatrix<M, N> {\n    if (row !== void 0) {\n      row = MoodVector.fromLike(row);\n    }\n    const oldRowArray = this.rowArray;\n    const oldRowIndex = this.rowIndex;\n    const i = oldRowIndex[rowKey.name];\n    if (row !== void 0 && i !== void 0) { // update\n      const newRowArray = oldRowArray.slice(0);\n      newRowArray[i] = [rowKey, row];\n      return MoodMatrix.fromRowArray(newRowArray, oldRowIndex);\n    } else if (row !== void 0) { // insert\n      const newRowArray = oldRowArray.slice(0);\n      const newRowIndex: {[name: string]: number | undefined} = {};\n      for (const name in oldRowIndex) {\n        newRowIndex[name] = oldRowIndex[name];\n      }\n      newRowIndex[rowKey.name] = newRowArray.length;\n      newRowArray.push([rowKey, row]);\n      return MoodMatrix.fromRowArray(newRowArray, newRowIndex);\n    } else if (i !== void 0) { // remove\n      const newRowArray = new Array<[M, MoodVector<N>]>();\n      const newRowIndex: {[name: string]: number | undefined} = {};\n      let k = 0;\n      for (let j = 0; j < oldRowArray.length; j += 1) {\n        const entry = oldRowArray[j]!;\n        if (entry[0] !== rowKey) {\n          newRowArray[k] = entry;\n          newRowIndex[entry[0].name] = k;\n          k += 1;\n        }\n      }\n      return MoodMatrix.fromRowArray(newRowArray, newRowIndex);\n    }\n    return this; // nop\n  }\n\n  col(colKey: N, col: MoodVectorLike<M> | undefined): MoodMatrix<M, N> {\n    if (col !== void 0) {\n      col = MoodVector.fromLike(col);\n    }\n    const oldColArray = this.colArray;\n    const oldColIndex = this.colIndex;\n    const i = oldColIndex[colKey.name];\n    if (col !== void 0 && i !== void 0) { // update\n      const newColArray = oldColArray.slice(0);\n      newColArray[i] = [colKey, col];\n      return MoodMatrix.fromColArray(newColArray, oldColIndex);\n    } else if (col !== void 0) { // insert\n      const newColArray = oldColArray.slice(0);\n      const newColIndex: {[name: string]: number | undefined} = {};\n      for (const name in oldColIndex) {\n        newColIndex[name] = oldColIndex[name];\n      }\n      newColIndex[colKey.name] = newColArray.length;\n      newColArray.push([colKey, col]);\n      return MoodMatrix.fromColArray(newColArray, newColIndex);\n    } else if (i !== void 0) { // remove\n      const newColArray = new Array<[N, MoodVector<M>]>();\n      const newColIndex: {[name: string]: number | undefined} = {};\n      let k = 0;\n      for (let j = 0; j < oldColArray.length; j += 1) {\n        const entry = oldColArray[j]!;\n        if (entry[0] !== colKey) {\n          newColArray[k] = entry;\n          newColIndex[entry[0].name] = k;\n          k += 1;\n        }\n      }\n      return MoodMatrix.fromColArray(newColArray, newColIndex);\n    } else\n    return this; // nop\n  }\n\n  updatedRow(rowKey: M, updates: MoodVectorUpdates<N>,\n             defaultRow?: MoodVectorLike<N>): MoodMatrix<M, N>;\n  updatedRow(rowKey: M & N, updates: MoodVectorUpdates<M & N>,\n             defaultRow?: MoodVectorLike<N> | boolean): MoodMatrix<M | N, N>\n  updatedRow(rowKey: M & N, updates: MoodVectorUpdates<M & N>,\n             defaultRow?: MoodVectorLike<N> | boolean): MoodMatrix<M | N, N> {\n    const oldRow = this.getRow(rowKey);\n    let newRow = oldRow;\n    if (newRow === void 0) {\n      if (defaultRow === true) {\n        defaultRow = MoodVector.of([rowKey, 1]);\n      } else if (defaultRow === false) {\n        defaultRow = void 0;\n      }\n      if (defaultRow === void 0) {\n        defaultRow = MoodVector.empty();\n      } else {\n        defaultRow = MoodVector.fromLike(defaultRow);\n      }\n      newRow = defaultRow;\n    }\n    newRow = newRow.updated(updates);\n    if (newRow.equals(oldRow)) {\n      return this;\n    }\n    return this.row(rowKey, newRow);\n  }\n\n  updatedCol(colKey: N, updates: MoodVectorUpdates<M>,\n             defaultCol?: MoodVectorLike<M>): MoodMatrix<M, N>;\n  updatedCol(colKey: M & N, updates: MoodVectorUpdates<M & N>,\n             defaultCol?: MoodVectorLike<M> | boolean): MoodMatrix<M | N, N>;\n  updatedCol(colKey: M & N, updates: MoodVectorUpdates<M & N>,\n             defaultCol?: MoodVectorLike<M> | boolean): MoodMatrix<M | N, N> {\n    const oldCol = this.getCol(colKey);\n    let newCol = oldCol;\n    if (newCol === void 0) {\n      if (defaultCol === true) {\n        defaultCol = MoodVector.of([colKey, 1]);\n      } else if (defaultCol === false) {\n        defaultCol = void 0;\n      }\n      if (defaultCol === void 0) {\n        defaultCol = MoodVector.empty();\n      } else {\n        defaultCol = MoodVector.fromLike(defaultCol);\n      }\n      newCol = defaultCol;\n    }\n    newCol = newCol.updated(updates);\n    if (newCol.equals(oldCol)) {\n      return this;\n    }\n    return this.col(colKey, newCol);\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof MoodMatrix) {\n      const equal = Arrays.equal(this.colArray, that.colArray);\n      return equal;\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    const cols = this.colArray;\n    const n = cols.length;\n    output = output.write(\"MoodMatrix\").write(46/*'.'*/)\n                   .write(n !== 0 ? \"forCols\" : \"empty\").write(40/*'('*/);\n    for (let j = 0; j < n; j += 1) {\n      const [colKey, col] = cols[j]!;\n      if (j !== 0) {\n        output = output.write(\", \");\n      }\n      output = output.write(91/*'['*/).debug(colKey).write(\", \").debug(col).write(93/*']'*/);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static empty<M extends Mood = Feel, N extends Mood = Feel>(): MoodMatrix<M, N> {\n    return new MoodMatrix(Arrays.empty(), {}, Arrays.empty(), {});\n  }\n\n  static forRows<M extends Mood, N extends Mood>(...rows: [M, MoodVectorLike<N>][]): MoodMatrix<M, N> {\n    const m = rows.length;\n    const rowArray = new Array<[M, MoodVector<N>]>(m);\n    for (let i = 0; i < m; i += 1) {\n      const [rowKey, row] = rows[i]!;\n      rowArray[i] = [rowKey, MoodVector.fromLike(row)];\n    }\n    return this.fromRowArray(rowArray);\n  }\n\n  static forCols<M extends Mood, N extends Mood>(...cols: [N, MoodVectorLike<M>][]): MoodMatrix<M, N> {\n    const m = cols.length;\n    const colArray = new Array<[N, MoodVector<M>]>(m);\n    for (let j = 0; j < m; j += 1) {\n      const [colKey, col] = cols[j]!;\n      colArray[j] = [colKey, MoodVector.fromLike(col)];\n    }\n    return this.fromColArray(colArray);\n  }\n\n  static fromRowArray<M extends Mood, N extends Mood>(\n      rowArray: readonly [M, MoodVector<N>][],\n      rowIndex?: {readonly [name: string]: number | undefined}): MoodMatrix<M, N> {\n    if (rowIndex === void 0) {\n      rowIndex = MoodVector.index(rowArray);\n    }\n    const colArray = new Array<[N, MoodVector<M>]>();\n    const colIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < rowArray.length; i += 1) {\n      const row = rowArray[i]![1];\n      row.forEach(function (value: number, colKey: N): void {\n        if (colIndex[colKey.name] === void 0) {\n          colIndex[colKey.name] = colArray.length;\n          colArray.push([colKey, void 0 as unknown as MoodVector<M>]);\n        }\n      }, this);\n    }\n    for (let j = 0; j < colArray.length; j += 1) {\n      const entry = colArray[j]!;\n      const colKey = entry[0];\n      const array = new Array<[M, number]>();\n      const index: {[name: string]: number | undefined} = {};\n      for (let i = 0; i < rowArray.length; i += 1) {\n        const [rowKey, row] = rowArray[i]!;\n        const value = row.get(colKey);\n        if (value !== void 0) {\n          index[rowKey.name] = array.length;\n          array.push([rowKey, value]);\n        }\n      }\n      const col = MoodVector.fromArray(array, index);\n      entry[1] = col;\n    }\n    return new MoodMatrix(rowArray, rowIndex, colArray, colIndex);\n  }\n\n  static fromColArray<M extends Mood, N extends Mood>(\n      colArray: readonly [N, MoodVector<M>][],\n      colIndex?: {readonly [name: string]: number | undefined}): MoodMatrix<M, N> {\n    if (colIndex === void 0) {\n      colIndex = MoodVector.index(colArray);\n    }\n    const rowArray = new Array<[M, MoodVector<N>]>();\n    const rowIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < colArray.length; i += 1) {\n      const col = colArray[i]![1];\n      col.forEach(function (value: number, rowKey: M): void {\n        if (rowIndex[rowKey.name] === void 0) {\n          rowIndex[rowKey.name] = rowArray.length;\n          rowArray.push([rowKey, void 0 as unknown as MoodVector<N>]);\n        }\n      }, this);\n    }\n    for (let i = 0; i < rowArray.length; i += 1) {\n      const entry = rowArray[i]!;\n      const rowKey = entry[0];\n      const array = new Array<[N, number]>();\n      const index: {[name: string]: number | undefined} = {};\n      for (let j = 0; j < colArray.length; j += 1) {\n        const [colKey, col] = colArray[j]!;\n        const value = col.get(rowKey);\n        if (value !== void 0) {\n          index[colKey.name] = array.length;\n          array.push([colKey, value]);\n        }\n      }\n      const row = MoodVector.fromArray(array, index);\n      entry[1] = row;\n    }\n    return new MoodMatrix(rowArray, rowIndex, colArray, colIndex);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport {Arrays} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {LookVectorInit} from \"./LookVector\";\nimport type {LookVectorUpdates} from \"./LookVector\";\nimport {LookVector} from \"./LookVector\";\nimport type {FeelVectorLike} from \"./FeelVector\";\nimport type {FeelVectorUpdates} from \"./FeelVector\";\nimport {FeelVector} from \"./FeelVector\";\nimport {MoodVector} from \"./MoodVector\";\nimport type {MoodMatrix} from \"./MoodMatrix\";\nimport type {Look} from \"./Look\";\nimport type {Feel} from \"./Feel\";\n\n/** @public */\nexport class ThemeMatrix implements Equals, Debug {\n  constructor(rowArray: readonly [Look<unknown>, LookVector<unknown>][],\n              rowIndex: {readonly [name: string]: number | undefined},\n              colArray: readonly [Feel, FeelVector][],\n              colIndex: {readonly [name: string]: number | undefined}) {\n    this.rowArray = rowArray;\n    this.rowIndex = rowIndex;\n    this.colArray = colArray;\n    this.colIndex = colIndex;\n  }\n\n  /** @internal */\n  readonly rowArray: readonly [Look<unknown>, LookVector<unknown>][];\n\n  /** @internal */\n  readonly rowIndex: {readonly [name: string]: number | undefined};\n\n  /** @internal */\n  readonly colArray: readonly [Feel, FeelVector][];\n\n  /** @internal */\n  readonly colIndex: {readonly [name: string]: number | undefined};\n\n  get rowCount(): number {\n    return this.rowArray.length;\n  }\n\n  get colCount(): number {\n    return this.colArray.length;\n  }\n\n  hasRow(look: Look<unknown>): boolean;\n  hasRow(name: string): boolean;\n  hasRow(look: Look<unknown> | string): boolean {\n    if (typeof look === \"object\" && look !== null || typeof look === \"function\") {\n      look = look.name;\n    }\n    return this.rowIndex[look] !== void 0;\n  }\n\n  hasCol(feel: Feel): boolean;\n  hasCol(name: string): boolean;\n  hasCol(feel: Feel | string): boolean {\n    if (typeof feel === \"object\" && feel !== null || typeof feel === \"function\") {\n      feel = feel.name;\n    }\n    return this.colIndex[feel] !== void 0;\n  }\n\n  getRow<T>(look: Look<T>): LookVector<T> | undefined;\n  getRow(name: string): LookVector<unknown> | undefined;\n  getRow(index: number): LookVector<unknown> | undefined;\n  getRow<T>(look: Look<T> | string | number | undefined): LookVector<unknown> | undefined {\n    if (typeof look === \"object\" && look !== null || typeof look === \"function\") {\n      look = look.name;\n    }\n    if (typeof look === \"string\") {\n      look = this.rowIndex[look];\n    }\n    const entry = typeof look === \"number\" ? this.rowArray[look] : void 0;\n    return entry !== void 0 ? entry[1] : void 0;\n  }\n\n  getCol(feel: Feel): FeelVector | undefined;\n  getCol(name: string): FeelVector | undefined;\n  getCol(index: number): FeelVector | undefined;\n  getCol(feel: Feel | string | number | undefined): FeelVector | undefined {\n    if (typeof feel === \"object\" && feel !== null || typeof feel === \"function\") {\n      feel = feel.name;\n    }\n    if (typeof feel === \"string\") {\n      feel = this.colIndex[feel];\n    }\n    const entry = typeof feel === \"number\" ? this.colArray[feel] : void 0;\n    return entry !== void 0 ? entry[1] : void 0;\n  }\n\n  get<T>(look: Look<T>, mood: MoodVector): T | undefined {\n    return this.dot(look, mood);\n  }\n\n  getOr<T, E>(look: Look<T>, mood: MoodVector, elseValue: E): T | E {\n    return this.dotOr(look, mood, elseValue);\n  }\n\n  plus(that: ThemeMatrix): ThemeMatrix {\n    const thisColArray = this.colArray;\n    const thatColArray = that.colArray;\n    const newColArray = new Array<[Feel, FeelVector]>();\n    const newColIndex: {[name: string]: number | undefined} = {};\n    for (let j = 0; j < thisColArray.length; j += 1) {\n      const entry = thisColArray[j]!;\n      const feel = entry[0];\n      const b = that.getCol(feel);\n      newColIndex[feel.name] = newColArray.length;\n      newColArray.push(b === void 0 ? entry : [feel, entry[1].plus(b)]);\n    }\n    for (let j = 0; j < thatColArray.length; j += 1) {\n      const entry = thatColArray[j]!;\n      const feel = entry[0];\n      if (newColIndex[feel.name] === void 0) {\n        newColIndex[feel.name] = newColArray.length;\n        newColArray.push(entry);\n      }\n    }\n    return ThemeMatrix.fromColArray(newColArray, newColIndex);\n  }\n\n  negative(): ThemeMatrix {\n    const oldColArray = this.colArray;\n    const n = oldColArray.length;\n    const newColArray = new Array<[Feel, FeelVector]>(n);\n    for (let j = 0; j < n; j += 1) {\n      const [feel, a] = oldColArray[j]!;\n      newColArray[j] = [feel, a.negative()];\n    }\n    return ThemeMatrix.fromColArray(newColArray, this.colIndex);\n  }\n\n  minus(that: ThemeMatrix): ThemeMatrix {\n    const thisColArray = this.colArray;\n    const thatColArray = that.colArray;\n    const newColArray = new Array<[Feel, FeelVector]>();\n    const newColIndex: {[name: string]: number | undefined} = {};\n    for (let j = 0; j < thisColArray.length; j += 1) {\n      const entry = thisColArray[j]!;\n      const feel = entry[0];\n      const b = that.getCol(feel);\n      newColIndex[feel.name] = newColArray.length;\n      newColArray.push(b === void 0 ? entry : [feel, entry[1].minus(b)]);\n    }\n    for (let j = 0; j < thatColArray.length; j += 1) {\n      const [feel, b] = thatColArray[j]!;\n      if (newColIndex[feel.name] === void 0) {\n        newColIndex[feel.name] = newColArray.length;\n        newColArray.push([feel, b.negative()]);\n      }\n    }\n    return ThemeMatrix.fromColArray(newColArray, newColIndex);\n  }\n\n  times(scalar: number): ThemeMatrix {\n    const oldColArray = this.colArray;\n    const n = oldColArray.length;\n    const newColArray = new Array<[Feel, FeelVector]>(n);\n    for (let j = 0; j < n; j += 1) {\n      const [feel, a] = oldColArray[j]!;\n      newColArray[j] = [feel, a.times(scalar)];\n    }\n    return ThemeMatrix.fromColArray(newColArray, this.colIndex);\n  }\n\n  dot<T>(look: Look<T>, col: MoodVector): T | undefined;\n  dot(look: string | number, col: MoodVector): unknown | undefined;\n  dot(look: Look<unknown> | string | number | undefined, col: MoodVector): unknown | undefined {\n    if (typeof look === \"object\" && look !== null || typeof look === \"function\") {\n      look = look.name;\n    }\n    if (typeof look === \"string\") {\n      look = this.rowIndex[look];\n    }\n    const entry = typeof look === \"number\" ? this.rowArray[look] : void 0;\n    if (entry === void 0) {\n      return void 0;\n    }\n    look = entry[0];\n    const row = entry[1];\n    return look.dot(row, col);\n  }\n\n  dotOr<T, E>(look: Look<T>, col: MoodVector, elseValue: E): T | E;\n  dotOr(look: string | number, col: MoodVector, elseValue: unknown): unknown;\n  dotOr(look: Look<unknown> | string | number | undefined, col: MoodVector, elseValue: unknown): unknown {\n    if (typeof look === \"object\" && look !== null || typeof look === \"function\") {\n      look = look.name;\n    }\n    if (typeof look === \"string\") {\n      look = this.rowIndex[look];\n    }\n    const entry = typeof look === \"number\" ? this.rowArray[look] : void 0;\n    if (entry === void 0) {\n      return elseValue;\n    }\n    look = entry[0];\n    const row = entry[1];\n    return look.dotOr(row, col, elseValue);\n  }\n\n  timesCol(col: MoodVector): FeelVector {\n    const rowArray = this.rowArray;\n    const newArray = new Array<[Look<unknown>, unknown]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < rowArray.length; i += 1) {\n      const [look, row] = rowArray[i]!;\n      const value = look.dot(row, col);\n      if (value !== void 0) {\n        newIndex[look.name] = newArray.length;\n        newArray.push([look, value]);\n      }\n    }\n    return FeelVector.fromArray(newArray, newIndex);\n  }\n\n  transform(that: MoodMatrix, implicitIdentity: boolean = true): ThemeMatrix {\n    const thisRowArray = this.rowArray;\n    const thisColArray = this.colArray;\n    const newRowArray = new Array<[Look<unknown>, LookVector<unknown>]>();\n    const newRowIndex: {[name: string]: number | undefined} = {};\n    const newColArray = new Array<[Feel, FeelVector]>();\n    const newColIndex: {[name: string]: number | undefined} = {};\n    for (let j = 0; j < thisColArray.length; j += 1) {\n      const feel = thisColArray[j]![0];\n      let col = that.getCol(feel);\n      if (col === void 0 && implicitIdentity) {\n        col = MoodVector.of([feel, 1]);\n      }\n      if (col === void 0) {\n        continue;\n      }\n      for (let i = 0; i < thisRowArray.length; i += 1) {\n        const [look, row] = thisRowArray[i]!;\n        const value = look.dot(row, col);\n        if (value === void 0) {\n          continue;\n        }\n        const i2 = newRowIndex[look.name];\n        if (i2 === void 0) {\n          newRowIndex[look.name] = newRowArray.length;\n          newRowArray.push([look, LookVector.of([feel, value])]);\n        } else {\n          const newRow = newRowArray[i2]![1];\n          (newRow.index as {[name: string]: number | undefined})[look.name] = newRow.array.length;\n          (newRow.array as [Feel, unknown][]).push([feel, value]);\n        }\n        const j2 = newColIndex[feel.name];\n        if (j2 === void 0) {\n          newColIndex[feel.name] = newColArray.length;\n          newColArray.push([feel, FeelVector.of([look, value])]);\n        } else {\n          const newCol = newColArray[j2]![1];\n          (newCol.index as {[name: string]: number | undefined})[feel.name] = newCol.array.length;\n          (newCol.array as [Look<unknown>, unknown][]).push([look, value]);\n        }\n      }\n    }\n    return new ThemeMatrix(newRowArray, newRowIndex, newColArray, newColIndex);\n  }\n\n  row<T>(look: Look<T>, row: LookVectorInit<T> | undefined): ThemeMatrix {\n    if (row !== void 0) {\n      row = LookVector.fromLike(row);\n    }\n    const oldRowArray = this.rowArray;\n    const oldRowIndex = this.rowIndex;\n    const i = oldRowIndex[look.name];\n    if (row !== void 0 && i !== void 0) { // update\n      const newRowArray = oldRowArray.slice(0);\n      newRowArray[i] = [look, row];\n      return ThemeMatrix.fromRowArray(newRowArray, oldRowIndex);\n    } else if (row !== void 0) { // insert\n      const newRowArray = oldRowArray.slice(0);\n      const newRowIndex: {[name: string]: number | undefined} = {};\n      for (const name in oldRowIndex) {\n        newRowIndex[name] = oldRowIndex[name];\n      }\n      newRowIndex[look.name] = newRowArray.length;\n      newRowArray.push([look, row]);\n      return ThemeMatrix.fromRowArray(newRowArray, newRowIndex);\n    } else if (i !== void 0) { // remove\n      const newRowArray = new Array<[Look<unknown>, LookVector<unknown>]>();\n      const newRowIndex: {[name: string]: number | undefined} = {};\n      let k = 0;\n      for (let j = 0; j < oldRowArray.length; j += 1) {\n        const entry = oldRowArray[j]!;\n        if (entry[0] !== look) {\n          newRowArray[k] = entry;\n          newRowIndex[entry[0].name] = k;\n          k += 1;\n        }\n      }\n      return ThemeMatrix.fromRowArray(newRowArray, newRowIndex);\n    }\n    return this; // nop\n  }\n\n  col(feel: Feel, col: FeelVectorLike | undefined): ThemeMatrix {\n    if (col !== void 0) {\n      col = FeelVector.fromLike(col);\n    }\n    const oldColArray = this.colArray;\n    const oldColIndex = this.colIndex;\n    const i = oldColIndex[feel.name];\n    if (col !== void 0 && i !== void 0) { // update\n      const newColArray = oldColArray.slice(0);\n      newColArray[i] = [feel, col];\n      return ThemeMatrix.fromColArray(newColArray, oldColIndex);\n    } else if (col !== void 0) { // insert\n      const newColArray = oldColArray.slice(0);\n      const newColIndex: {[name: string]: number | undefined} = {};\n      for (const name in oldColIndex) {\n        newColIndex[name] = oldColIndex[name];\n      }\n      newColIndex[feel.name] = newColArray.length;\n      newColArray.push([feel, col]);\n      return ThemeMatrix.fromColArray(newColArray, newColIndex);\n    } else if (i !== void 0) { // remove\n      const newColArray = new Array<[Feel, FeelVector]>();\n      const newColIndex: {[name: string]: number | undefined} = {};\n      let k = 0;\n      for (let j = 0; j < oldColArray.length; j += 1) {\n        const entry = oldColArray[j]!;\n        if (entry[0] !== feel) {\n          newColArray[k] = entry;\n          newColIndex[entry[0].name] = k;\n          k += 1;\n        }\n      }\n      return ThemeMatrix.fromColArray(newColArray, newColIndex);\n    }\n    return this; // nop\n  }\n\n  updatedRow<T>(look: Look<T>, updates: LookVectorUpdates<T>,\n                defaultRow?: LookVectorInit<T>): ThemeMatrix {\n    const oldRow = this.getRow(look);\n    let newRow = oldRow;\n    if (newRow === void 0) {\n      if (defaultRow !== void 0) {\n        defaultRow = LookVector.fromLike(defaultRow);\n      } else {\n        defaultRow = LookVector.empty();\n      }\n      newRow = defaultRow;\n    }\n    newRow = newRow.updated(updates);\n    if (newRow.equals(oldRow)) {\n      return this;\n    }\n    return this.row(look, newRow);\n  }\n\n  updatedCol(feel: Feel, updates: FeelVectorUpdates,\n             defaultCol?: FeelVectorLike): ThemeMatrix {\n    const oldCol = this.getCol(feel);\n    let newCol = oldCol;\n    if (newCol === void 0) {\n      if (defaultCol !== void 0) {\n        defaultCol = FeelVector.fromLike(defaultCol);\n      } else {\n        defaultCol = FeelVector.empty();\n      }\n      newCol = defaultCol;\n    }\n    newCol = newCol.updated(updates);\n    if (newCol.equals(oldCol)) {\n      return this;\n    }\n    return this.col(feel, newCol);\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ThemeMatrix) {\n      return Arrays.equal(this.colArray, that.colArray);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    const cols = this.colArray;\n    const n = cols.length;\n    output = output.write(\"ThemeMatrix\").write(46/*'.'*/)\n                   .write(n !== 0 ? \"forCols\" : \"empty\").write(40/*'('*/);\n    for (let j = 0; j < n; j += 1) {\n      const [feel, col] = cols[j]!;\n      if (j !== 0) {\n        output = output.write(\", \");\n      }\n      output = output.write(91/*'['*/).debug(feel).write(\", \").debug(col).write(93/*']'*/);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static empty(): ThemeMatrix {\n    return new ThemeMatrix(Arrays.empty(), {}, Arrays.empty(), {});\n  }\n\n  static forRows(...rows: [Look<unknown>, LookVectorInit<unknown>][]): ThemeMatrix {\n    const m = rows.length;\n    const rowArray = new Array<[Look<unknown>, LookVector<unknown>]>(m);\n    for (let i = 0; i < m; i += 1) {\n      const [look, row] = rows[i]!;\n      rowArray[i] = [look, LookVector.fromLike(row)];\n    }\n    return this.fromRowArray(rowArray);\n  }\n\n  static forCols(...cols: [Feel, FeelVectorLike][]): ThemeMatrix {\n    const m = cols.length;\n    const colArray = new Array<[Feel, FeelVector]>(m);\n    for (let j = 0; j < m; j += 1) {\n      const [feel, col] = cols[j]!;\n      colArray[j] = [feel, FeelVector.fromLike(col)];\n    }\n    return this.fromColArray(colArray);\n  }\n\n  static fromRowArray(rowArray: readonly [Look<unknown>, LookVector<unknown>][],\n                      rowIndex?: {readonly [name: string]: number | undefined}): ThemeMatrix {\n    if (rowIndex === void 0) {\n      rowIndex = FeelVector.index(rowArray);\n    }\n    const colArray = new Array<[Feel, FeelVector]>();\n    const colIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < rowArray.length; i += 1) {\n      const row = rowArray[i]![1];\n      row.forEach(function (value: unknown, feel: Feel): void {\n        if (colIndex[feel.name] === void 0) {\n          colIndex[feel.name] = colArray.length;\n          colArray.push([feel, void 0 as unknown as FeelVector]);\n        }\n      }, this);\n    }\n    for (let j = 0; j < colArray.length; j += 1) {\n      const entry = colArray[j]!;\n      const feel = entry[0];\n      const array = new Array<[Look<unknown>, unknown]>();\n      const index: {[name: string]: number | undefined} = {};\n      for (let i = 0; i < rowArray.length; i += 1) {\n        const [look, row] = rowArray[i]!;\n        const value = row.get(feel);\n        if (value !== void 0) {\n          index[look.name] = array.length;\n          array.push([look, value]);\n        }\n      }\n      const col = FeelVector.fromArray(array, index);\n      entry[1] = col;\n    }\n    return new ThemeMatrix(rowArray, rowIndex, colArray, colIndex);\n  }\n\n  static fromColArray(colArray: readonly [Feel, FeelVector][],\n                      colIndex?: {readonly [name: string]: number | undefined}): ThemeMatrix {\n    if (colIndex === void 0) {\n      colIndex = LookVector.index(colArray);\n    }\n    const rowArray = new Array<[Look<unknown>, LookVector<unknown>]>();\n    const rowIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < colArray.length; i += 1) {\n      const col = colArray[i]![1];\n      col.forEach(function <T>(value: T, look: Look<T>): void {\n        if (rowIndex[look.name] === void 0) {\n          rowIndex[look.name] = rowArray.length;\n          rowArray.push([look, void 0 as unknown as LookVector<T>]);\n        }\n      }, this);\n    }\n    for (let i = 0; i < rowArray.length; i += 1) {\n      const entry = rowArray[i]!;\n      const look = entry[0];\n      const array = new Array<[Feel, unknown]>();\n      const index: {[name: string]: number | undefined} = {};\n      for (let j = 0; j < colArray.length; j += 1) {\n        const [feel, col] = colArray[j]!;\n        const value = col.get(look);\n        if (value !== void 0) {\n          index[feel.name] = array.length;\n          array.push([feel, value]);\n        }\n      }\n      const row = LookVector.fromArray(array, index);\n      entry[1] = row;\n    }\n    return new ThemeMatrix(rowArray, rowIndex, colArray, colIndex);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Objects} from \"@swim/util\";\nimport type {MoodVector} from \"./MoodVector\";\nimport type {Look} from \"./Look\";\nimport type {Feel} from \"./Feel\";\n\n/** @public */\nexport interface ThemeContext {\n  getLook<T>(look: Look<T>, mood?: MoodVector<Feel> | null): T | undefined;\n\n  getLookOr<T, E>(look: Look<T>, elseValue: E): T | E;\n  getLookOr<T, E>(look: Look<T>, mood: MoodVector<Feel> | null, elseValue: E): T | E;\n}\n\n/** @public */\nexport const ThemeContext = {\n  [Symbol.hasInstance](instance: unknown): instance is ThemeContext {\n    return Objects.hasAllKeys<ThemeContext>(instance, \"getLook\");\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport {Timing} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerContext} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport type {AnimatorClass} from \"@swim/component\";\nimport type {AnimatorDescriptor} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport type {MoodVector} from \"./MoodVector\";\nimport type {ThemeMatrix} from \"./ThemeMatrix\";\nimport {ThemeContext} from \"./ThemeContext\";\nimport {Look} from \"./\"; // forward import\n\n/** @public */\nexport interface ThemeAnimatorDescriptor<R, T> extends AnimatorDescriptor<R, T> {\n  extends?: Proto<ThemeAnimator<any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface ThemeAnimatorClass<A extends ThemeAnimator<any, any, any> = ThemeAnimator<any, any, any>> extends AnimatorClass<A> {\n}\n\n/** @public */\nexport interface ThemeAnimator<R = any, T = any, I extends any[] = [Look<NonNullable<T>> | T]> extends Animator<R, T, I> {\n  /** @override */\n  get descriptorType(): Proto<ThemeAnimatorDescriptor<R, T>>;\n\n  /** @protected @override */\n  onSetAffinity(newAffinity: Affinity, oldAffinity: Affinity): void;\n\n  /** @override */\n  set(newValue: T | LikeType<T> | Look<NonNullable<T>> | Fastener<any, I[0], any>, timing?: TimingLike | boolean | null): R;\n\n  /** @override */\n  setIntrinsic(newValue: T | LikeType<T> | Look<NonNullable<T>> | Fastener<any, I[0], any>, timing?: TimingLike | boolean | null): R;\n\n  get inletLook(): Look<NonNullable<T>> | null;\n\n  getInletLook(): Look<NonNullable<T>>;\n\n  getInletLookOr<E>(elseLook: E): Look<NonNullable<T>> | E;\n\n  /** @protected */\n  initLook(): Look<NonNullable<T>> | null;\n\n  readonly look: Look<NonNullable<T>> | null;\n\n  getLook(): Look<NonNullable<T>>;\n\n  getLookOr<E>(elseLook: E): Look<NonNullable<T>> | E;\n\n  setLook(newLook: Look<NonNullable<T>> | null, timingOrAffinity: Affinity | TimingLike | boolean | null | undefined): void;\n  setLook(newLook: Look<NonNullable<T>> | null, timing?: TimingLike | boolean | null, affinity?: Affinity): void;\n\n  /** @protected */\n  willSetLook(newLook: Look<NonNullable<T>> | null, oldLook: Look<NonNullable<T>> | null, timing: Timing | boolean | null): void;\n\n  /** @protected */\n  onSetLook(newLook: Look<NonNullable<T>> | null, oldLook: Look<NonNullable<T>> | null, timing: Timing | boolean | null): void;\n\n  /** @protected */\n  didSetLook(newLook: Look<NonNullable<T>> | null, oldLook: Look<NonNullable<T>> | null, timing: Timing | boolean | null): void;\n\n  /** @internal */\n  applyLook(look: Look<NonNullable<T>>, timing: Timing | boolean | null | undefined): void;\n\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean | null | undefined): void;\n\n  /** @override */\n  recohere(t: number): void;\n\n  /** @protected @override */\n  onMount(): void;\n}\n\n/** @public */\nexport const ThemeAnimator = (<R, T, I extends any[], A extends ThemeAnimator<any, any, any>>() => Animator.extend<ThemeAnimator<R, T, I>, ThemeAnimatorClass<A>>(\"ThemeAnimator\", {\n  onSetAffinity(newAffinity: Affinity, oldAffinity: Affinity): void {\n    if (newAffinity > Affinity.Intrinsic) {\n      this.setLook(null, newAffinity);\n    }\n    super.onSetAffinity(newAffinity, oldAffinity);\n  },\n\n  set(newValue: T | LikeType<T> | Look<NonNullable<T>> | Fastener<any, I[0], any>, timing?: TimingLike | boolean | null): R {\n    if (newValue instanceof Fastener) {\n      this.bindInlet(newValue);\n    } else if (newValue instanceof Look) {\n      this.setLook(newValue, timing, Affinity.Extrinsic);\n    } else {\n      this.setState(newValue, timing, Affinity.Extrinsic);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(newValue: T | LikeType<T> | Look<NonNullable<T>> | Fastener<any, I[0], any>, timing?: TimingLike | boolean | null): R {\n    if (newValue instanceof Fastener) {\n      this.bindInlet(newValue);\n    } else if (newValue instanceof Look) {\n      this.setLook(newValue, timing, Affinity.Intrinsic);\n    } else {\n      this.setState(newValue, timing, Affinity.Intrinsic);\n    }\n    return this.owner;\n  },\n\n  get inletLook(): Look<NonNullable<T>> | null {\n    const inlet = this.inlet;\n    return inlet instanceof ThemeAnimator ? inlet.look : null;\n  },\n\n  getInletLook(): Look<NonNullable<T>> {\n    const inletLook = this.inletLook;\n    if (inletLook === null) {\n      throw new TypeError(inletLook + \" \" + this.name.toString() + \" inlet look\");\n    }\n    return inletLook;\n  },\n\n  getInletLookOr<E>(elseLook: E): Look<NonNullable<T>> | E {\n    const inletLook = this.inletLook;\n    if (inletLook === null) {\n      return elseLook;\n    }\n    return inletLook;\n  },\n\n  look: null,\n\n  initLook(): Look<NonNullable<T>> | null {\n    return (Object.getPrototypeOf(this) as ThemeAnimator<unknown, T>).look;\n  },\n\n  getLook(): Look<NonNullable<T>> {\n    const look = this.look;\n    if (look === null) {\n      throw new TypeError(look + \" \" + this.name.toString() + \" look\");\n    }\n    return look;\n  },\n\n  getLookOr<E>(elseLook: E): Look<NonNullable<T>> | E {\n    const look = this.look;\n    if (look === null) {\n      return elseLook;\n    }\n    return look;\n  },\n\n  setLook(newLook: Look<NonNullable<T>> | null, timing?: Affinity | TimingLike | boolean | null, affinity?: Affinity): void {\n    if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n    if (affinity === void 0) {\n      affinity = Affinity.Extrinsic;\n    }\n    if (!this.minAffinity(affinity)) {\n      return;\n    }\n    const oldLook = this.look;\n    if (newLook === oldLook) {\n      return;\n    }\n    if (timing === void 0) {\n      timing = this.transition;\n    } else {\n      timing = Timing.fromLike(timing);\n    }\n    if (timing === true) {\n      if (Objects.hasAllKeys<FastenerContext>(this.owner, \"getTransition\")) {\n        timing = this.owner.getTransition!(this);\n      } else {\n        timing = this.timing;\n      }\n    } else if (timing === false) {\n      timing = null;\n    }\n    this.willSetLook(newLook, oldLook, timing);\n    this.incrementVersion();\n    (this as Mutable<typeof this>).look = newLook;\n    this.onSetLook(newLook, oldLook, timing);\n    this.didSetLook(newLook, oldLook, timing);\n  },\n\n  willSetLook(newLook: Look<NonNullable<T>> | null, oldLook: Look<NonNullable<T>> | null, timing: Timing | null): void {\n    // hook\n  },\n\n  onSetLook(newLook: Look<NonNullable<T>> | null, oldLook: Look<NonNullable<T>> | null, timing: Timing | null): void {\n    if (newLook !== null) {\n      this.applyLook(newLook, timing);\n    }\n  },\n\n  didSetLook(newLook: Look<NonNullable<T>> | null, oldLook: Look<NonNullable<T>> | null, timing: Timing | null): void {\n    // hook\n  },\n\n  applyLook(look: Look<NonNullable<T>>, timing: Timing | boolean | null | undefined): void {\n    if (!this.mounted || !ThemeContext[Symbol.hasInstance](this.owner)) {\n      return;\n    }\n    const state = this.owner.getLook(look);\n    if (state === void 0) {\n      return;\n    }\n    this.setState(state, timing, Affinity.Reflexive);\n  },\n\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean | null | undefined): void {\n    const look = this.look;\n    if (look === null) {\n      return;\n    }\n    const state = theme.get(look, mood);\n    if (state === void 0) {\n      return;\n    }\n    if (timing === void 0) {\n      timing = this.transition;\n    } else {\n      timing = Timing.fromLike(timing);\n    }\n    if (timing === true) {\n      if (Objects.hasAllKeys<FastenerContext>(this.owner, \"getTransition\")) {\n        timing = this.owner.getTransition!(this);\n      } else {\n        timing = this.timing;\n      }\n    } else if (timing === false) {\n      timing = null;\n    }\n    this.setState(state, timing, Affinity.Reflexive);\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof Animator) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        if (inlet instanceof ThemeAnimator) {\n          this.setLook(inlet.look, inlet.timing, Affinity.Reflexive);\n        } else {\n          this.setLook(null, Affinity.Reflexive);\n        }\n        if (this.look === null) {\n          this.tweenInherited(t);\n        } else if ((this.flags & Animator.TweeningFlag) !== 0) {\n          this.tween(t);\n        } else {\n          this.setCoherent(true);\n        }\n      } else if ((this.flags & Animator.TweeningFlag) !== 0) {\n        this.tween(t);\n      } else {\n        this.setCoherent(true);\n      }\n    } else if (inlet instanceof Property) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0 && this.inletVersion !== inlet.version) {\n        (this as Mutable<typeof this>).inletVersion = inlet.version;\n        const inletValue = inlet.getOutletValue(this);\n        if (inletValue instanceof Look) {\n          this.setLook(inletValue, Affinity.Reflexive);\n        } else {\n          this.setLook(null, Affinity.Reflexive);\n          const derivedValue = (this as unknown as Property<R, T, [unknown]>).deriveValue(inlet.getOutletValue(this));\n          this.setState(derivedValue, Affinity.Reflexive);\n        }\n        if ((this.flags & Animator.TweeningFlag) !== 0) {\n          this.tween(t);\n        } else {\n          this.setCoherent(true);\n        }\n      } else if ((this.flags & Animator.TweeningFlag) !== 0) {\n        this.tween(t);\n      } else {\n        this.setCoherent(true);\n      }\n    } else if (Array.isArray(inlet)) {\n      this.setDerived(true);\n      const inletVersions = this.inletVersion as number[];\n      const inletValues = new Array<unknown>(inlet.length);\n      for (let i = 0; i < inlet.length; i += 1) {\n        if (inlet[i] instanceof Property) {\n          inletVersions[i] = (inlet[i] as Property).version;\n          inletValues[i] = (inlet[i] as Property).getOutletValue(this);\n        } else {\n          this.setDerived(false);\n          this.setCoherent(true);\n          return;\n        }\n      }\n      const derivedValue = this.deriveValue(...(inletValues as I));\n      this.setState(derivedValue, Affinity.Reflexive);\n      if ((this.flags & Animator.TweeningFlag) !== 0) {\n        this.tween(t);\n      } else {\n        this.setCoherent(true);\n      }\n    } else {\n      this.setDerived(false);\n      if ((this.flags & Animator.TweeningFlag) !== 0) {\n        this.tween(t);\n      } else {\n        this.setCoherent(true);\n      }\n    }\n  },\n\n  onMount(): void {\n    super.onMount();\n    const look = this.look;\n    if (look !== null) {\n      this.applyLook(look, false);\n    }\n  },\n}, {\n  construct(animator: A | null, owner: A extends Fastener<infer R, any, any> ? R : never): A {\n    animator = super.construct(animator, owner) as A;\n    (animator as Mutable<typeof animator>).look = animator.initLook();\n    return animator;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport type {ConstraintExpressionLike} from \"@swim/constraint\";\nimport {ConstraintExpression} from \"@swim/constraint\";\nimport type {ConstraintTerm} from \"@swim/constraint\";\nimport type {ConstraintVariable} from \"@swim/constraint\";\nimport type {ConstraintStrengthLike} from \"@swim/constraint\";\nimport {ConstraintStrength} from \"@swim/constraint\";\nimport type {Constraint} from \"@swim/constraint\";\nimport {ConstraintScope} from \"@swim/constraint\";\nimport type {ConstraintSolver} from \"@swim/constraint\";\nimport type {ThemeAnimatorDescriptor} from \"./ThemeAnimator\";\nimport type {ThemeAnimatorClass} from \"./ThemeAnimator\";\nimport {ThemeAnimator} from \"./ThemeAnimator\";\nimport type {Look} from \"./Look\";\n\n/** @public */\nexport interface ThemeConstraintAnimatorDescriptor<R, T> extends ThemeAnimatorDescriptor<R, T> {\n  extends?: Proto<ThemeConstraintAnimator<any, any, any>> | boolean | null;\n  strength?: ConstraintStrengthLike;\n  constrained?: boolean;\n}\n\n/** @public */\nexport interface ThemeConstraintAnimatorClass<A extends ThemeConstraintAnimator<any, any, any> = ThemeConstraintAnimator<any, any, any>> extends ThemeAnimatorClass<A> {\n  /** @internal */\n  readonly ConstrainedFlag: FastenerFlags;\n  /** @internal */\n  readonly ConstrainingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ThemeConstraintAnimator<R = any, T = any, I extends any[] = [Look<NonNullable<T>> | T]> extends ThemeAnimator<R, T, I>, ConstraintVariable {\n  /** @override */\n  get descriptorType(): Proto<ThemeConstraintAnimatorDescriptor<R, T>>;\n\n  /** @internal @override */\n  isExternal(): boolean;\n\n  /** @internal @override */\n  isDummy(): boolean;\n\n  /** @internal @override */\n  isInvalid(): boolean;\n\n  /** @override */\n  isConstant(): boolean;\n\n  /** @internal @override */\n  evaluateConstraintVariable(): void;\n\n  /** @internal @override */\n  updateConstraintSolution(value: number): void;\n\n  /** @internal @protected */\n  initStrength(): ConstraintStrength;\n\n  /** @override */\n  readonly strength: ConstraintStrength;\n\n  setStrength(strength: ConstraintStrengthLike): void;\n\n  /** @override */\n  get coefficient(): number;\n\n  /** @override */\n  get variable(): ConstraintVariable | null;\n\n  /** @override */\n  get terms(): ReadonlyMap<ConstraintVariable, number>;\n\n  /** @override */\n  get constant(): number;\n\n  /** @override */\n  plus(that: ConstraintExpressionLike): ConstraintExpression;\n\n  /** @override */\n  negative(): ConstraintTerm;\n\n  /** @override */\n  minus(that: ConstraintExpressionLike): ConstraintExpression;\n\n  /** @override */\n  times(scalar: number): ConstraintExpression;\n\n  /** @override */\n  divide(scalar: number): ConstraintExpression;\n\n  get constrained(): boolean;\n\n  constrain(constrained?: boolean): this;\n\n  /** @internal */\n  readonly conditionCount: number;\n\n  /** @internal @override */\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal @override */\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal */\n  get constraining(): boolean;\n\n  /** @internal */\n  startConstraining(): void;\n\n  /** @protected */\n  willStartConstraining(): void;\n\n  /** @protected */\n  onStartConstraining(): void;\n\n  /** @protected */\n  didStartConstraining(): void;\n\n  /** @internal */\n  stopConstraining(): void;\n\n  /** @protected */\n  willStopConstraining(): void;\n\n  /** @protected */\n  onStopConstraining(): void;\n\n  /** @protected */\n  didStopConstraining(): void;\n\n  /** @internal */\n  updateConstraintVariable(): void;\n\n  /** @protected @override */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n\n  /** @internal @protected */\n  toNumber(value: T): number;\n}\n\n/** @public */\nexport const ThemeConstraintAnimator = (<R, T, I extends any[], A extends ThemeConstraintAnimator<any, any, any>>() => ThemeAnimator.extend<ThemeConstraintAnimator<R, T, I>, ThemeConstraintAnimatorClass<A>>(\"ThemeConstraintAnimator\", {\n  isExternal(): boolean {\n    return true;\n  },\n\n  isDummy(): boolean {\n    return false;\n  },\n\n  isInvalid(): boolean {\n    return false;\n  },\n\n  isConstant(): boolean {\n    return false;\n  },\n\n  evaluateConstraintVariable(): void {\n    // hook\n  },\n\n  updateConstraintSolution(state: number): void {\n    if (this.constrained && this.toNumber(this.state) !== state) {\n      this.setState(state as unknown as T, Affinity.Reflexive);\n    }\n  },\n\n  initStrength(): ConstraintStrength {\n    let strength = (Object.getPrototypeOf(this) as ThemeConstraintAnimator).strength as ConstraintStrength | undefined;\n    if (strength === void 0) {\n      strength = ConstraintStrength.Strong;\n    }\n    return strength;\n  },\n\n  setStrength(strength: ConstraintStrengthLike): void {\n    (this as Mutable<typeof this>).strength = ConstraintStrength.fromLike(strength);\n  },\n\n  get coefficient(): number {\n    return 1;\n  },\n\n  get variable(): ConstraintVariable {\n    return this;\n  },\n\n  get terms(): ReadonlyMap<ConstraintVariable, number> {\n    const terms = new Map<ConstraintVariable, number>();\n    terms.set(this, 1);\n    return terms;\n  },\n\n  get constant(): number {\n    return 0;\n  },\n\n  plus(that: ConstraintExpressionLike): ConstraintExpression {\n    that = ConstraintExpression.fromLike(that);\n    if (this === that) {\n      return ConstraintExpression.product(2, this);\n    }\n    return ConstraintExpression.sum(this, that);\n  },\n\n  negative(): ConstraintTerm {\n    return ConstraintExpression.product(-1, this);\n  },\n\n  minus(that: ConstraintExpressionLike): ConstraintExpression {\n    that = ConstraintExpression.fromLike(that);\n    if (this === that) {\n      return ConstraintExpression.zero();\n    }\n    return ConstraintExpression.sum(this, that.negative());\n  },\n\n  times(scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(scalar, this);\n  },\n\n  divide(scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(1 / scalar, this);\n  },\n\n  get constrained(): boolean {\n    return (this.flags & ThemeConstraintAnimator.ConstrainedFlag) !== 0;\n  },\n\n  constrain(constrained?: boolean): typeof this {\n    if (constrained === void 0) {\n      constrained = true;\n    }\n    const flags = this.flags;\n    if (constrained && (flags & ThemeConstraintAnimator.ConstrainedFlag) === 0) {\n      this.setFlags(flags | ThemeConstraintAnimator.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.stopConstraining();\n      }\n    } else if (!constrained && (flags & ThemeConstraintAnimator.ConstrainedFlag) !== 0) {\n      this.setFlags(flags & ~ThemeConstraintAnimator.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.startConstraining();\n        this.updateConstraintVariable();\n      }\n    }\n    return this;\n  },\n\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount += 1;\n    if (!this.constrained && this.conditionCount === 1 && this.mounted) {\n      this.startConstraining();\n      this.updateConstraintVariable();\n    }\n  },\n\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount -= 1;\n    if (!this.constrained && this.conditionCount === 0 && this.mounted) {\n      this.stopConstraining();\n    }\n  },\n\n  get constraining(): boolean {\n    return (this.flags & ThemeConstraintAnimator.ConstrainingFlag) !== 0;\n  },\n\n  startConstraining(): void {\n    if ((this.flags & ThemeConstraintAnimator.ConstrainingFlag) !== 0) {\n      return;\n    }\n    this.willStartConstraining();\n    this.setFlags(this.flags | ThemeConstraintAnimator.ConstrainingFlag);\n    this.onStartConstraining();\n    this.didStartConstraining();\n  },\n\n  willStartConstraining(): void {\n    // hook\n  },\n\n  onStartConstraining(): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      constraintScope.addConstraintVariable(this);\n    }\n  },\n\n  didStartConstraining(): void {\n    // hook\n  },\n\n  stopConstraining(): void {\n    if ((this.flags & ThemeConstraintAnimator.ConstrainingFlag) === 0) {\n      return;\n    }\n    this.willStopConstraining();\n    this.setFlags(this.flags & ~ThemeConstraintAnimator.ConstrainingFlag);\n    this.onStopConstraining();\n    this.didStopConstraining();\n  },\n\n  willStopConstraining(): void {\n    // hook\n  },\n\n  onStopConstraining(): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      constraintScope.removeConstraintVariable(this);\n    }\n  },\n\n  didStopConstraining(): void {\n    // hook\n  },\n\n  updateConstraintVariable(): void {\n    const constraintScope = this.owner;\n    const value = this.value;\n    if (value !== void 0 && ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      constraintScope.setConstraintVariable(this, this.toNumber(value));\n    }\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    super.onSetValue(newValue, oldValue);\n    const constraintScope = this.owner;\n    if (this.constraining && ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      constraintScope.setConstraintVariable(this, newValue !== void 0 && newValue !== null ? this.toNumber(newValue) : 0);\n    }\n  },\n\n  onMount(): void {\n    super.onMount();\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.startConstraining();\n    }\n  },\n\n  onUnmount(): void {\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.stopConstraining();\n    }\n    super.onUnmount();\n  },\n\n  toNumber(value: T): number {\n    return value !== void 0 && value !== null ? +value : 0;\n  },\n},\n{\n  construct(animator: A | null, owner: A extends Fastener<infer R, any, any> ? R : never): A {\n    animator = super.construct(animator, owner) as A;\n    (animator as Mutable<typeof animator>).strength = animator.initStrength();\n    (animator as Mutable<typeof animator>).conditionCount = 0;\n    return animator;\n  },\n\n  refine(animatorClass: FastenerClass<ThemeConstraintAnimator<any, any, any>>): void {\n    super.refine(animatorClass);\n    const animatorPrototype = animatorClass.prototype;\n\n    let flagsInit = animatorPrototype.flagsInit;\n    if (Object.prototype.hasOwnProperty.call(animatorPrototype, \"constrained\")) {\n      if (animatorPrototype.constrained) {\n        flagsInit |= ThemeConstraintAnimator.ConstrainedFlag;\n      } else {\n        flagsInit &= ~ThemeConstraintAnimator.ConstrainedFlag;\n      }\n      delete (animatorPrototype as ThemeConstraintAnimatorDescriptor<any, any>).constrained;\n    }\n    Object.defineProperty(animatorPrototype, \"flagsInit\", {\n      value: flagsInit,\n      enumerable: true,\n      configurable: true,\n    });\n\n    const strengthDescriptor = Object.getOwnPropertyDescriptor(animatorPrototype, \"strength\");\n    if (strengthDescriptor !== void 0 && \"value\" in strengthDescriptor) {\n      strengthDescriptor.value = ConstraintStrength.fromLike(strengthDescriptor.value);\n      Object.defineProperty(animatorPrototype, \"strength\", strengthDescriptor);\n    }\n  },\n\n  ConstrainedFlag: 1 << (ThemeAnimator.FlagShift + 0),\n  ConstrainingFlag: 1 << (ThemeAnimator.FlagShift + 1),\n\n  FlagShift: ThemeAnimator.FlagShift + 2,\n  FlagMask: (1 << (ThemeAnimator.FlagShift + 2)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Numbers} from \"@swim/util\";\nimport type {Like} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport {Timing} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport {NumberInterpolator} from \"@swim/util\";\nimport type {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport {LengthInterpolator} from \"@swim/math\";\nimport type {FontLike} from \"@swim/style\";\nimport {Font} from \"@swim/style\";\nimport {FontInterpolator} from \"@swim/style\";\nimport type {ColorLike} from \"@swim/style\";\nimport {Color} from \"@swim/style\";\nimport type {BoxShadowLike} from \"@swim/style\";\nimport {BoxShadow} from \"@swim/style\";\nimport {BoxShadowInterpolator} from \"@swim/style\";\nimport {LookVector} from \"./LookVector\";\nimport type {MoodVector} from \"./MoodVector\";\nimport type {Feel} from \"./Feel\";\nimport type {Mood} from \"./Mood\";\n\n/** @public */\nexport abstract class Look<T> implements Mood {\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  readonly name: string;\n\n  add(a: LookVector<T>, b: LookVector<T>): LookVector<T> {\n    const aArray = a.array;\n    const bArray = b.array;\n    const newArray = new Array<[Feel, T]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < aArray.length; i += 1) {\n      const entry = aArray[i]!;\n      const feel = entry[0];\n      const y = b.get(feel);\n      newIndex[feel.name] = newArray.length;\n      newArray.push(y === void 0 ? entry : [feel, feel.combine(this, entry[1], y)]);\n    }\n    for (let i = 0; i < bArray.length; i += 1) {\n      const entry = bArray[i]!;\n      const feel = entry[0];\n      if (newIndex[feel.name] === void 0) {\n        newIndex[feel.name] = newArray.length;\n        newArray.push(entry);\n      }\n    }\n    return this.fromArray(newArray, newIndex);\n  }\n\n  negate(a: LookVector<T>): LookVector<T> {\n    const oldArray = a.array;\n    const n = oldArray.length;\n    const newArray = new Array<[Feel, T]>(n);\n    for (let i = 0; i < n; i += 1) {\n      const [feel, x] = oldArray[i]!;\n      newArray[i] = [feel, feel.combine(this, void 0, x, -1)];\n    }\n    return this.fromArray(newArray, a.index);\n  }\n\n  subtract(a: LookVector<T>, b: LookVector<T>): LookVector<T> {\n    const aArray = a.array;\n    const bArray = b.array;\n    const newArray = new Array<[Feel, T]>();\n    const newIndex: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < aArray.length; i += 1) {\n      const entry = aArray[i]!;\n      const feel = entry[0];\n      const y = b.get(feel);\n      newIndex[feel.name] = newArray.length;\n      newArray.push(y === void 0 ? entry : [feel, feel.combine(this, entry[1], y, -1)]);\n    }\n    for (let i = 0; i < bArray.length; i += 1) {\n      const [feel, y] = bArray[i]!;\n      if (newIndex[feel.name] === void 0) {\n        newIndex[feel.name] = newArray.length;\n        newArray.push([feel, feel.combine(this, void 0, y, -1)]);\n      }\n    }\n    return this.fromArray(newArray, newIndex);\n  }\n\n  multiply(a: LookVector<T>, scalar: number): LookVector<T> {\n    const oldArray = a.array;\n    const n = oldArray.length;\n    const newArray = new Array<[Feel, T]>(n);\n    for (let i = 0; i < n; i += 1) {\n      const [feel, x] = oldArray[i]!;\n      newArray[i] = [feel, feel.combine(this, void 0, x, scalar)];\n    }\n    return this.fromArray(newArray, a.index);\n  }\n\n  dot(a: LookVector<T>, b: MoodVector): T | undefined {\n    const array = a.array;\n    let combination: T | undefined;\n    for (let i = 0; i < array.length; i += 1) {\n      const [feel, value] = array[i]!;\n      const weight = b.get(feel);\n      if (weight !== void 0 && weight !== 0) {\n        combination = feel.combine(this, combination, value, weight);\n      }\n    }\n    return combination;\n  }\n\n  dotOr<E>(a: LookVector<T>, b: MoodVector, elseValue: E): T | E {\n    const array = a.array;\n    if (array.length === 0) {\n      return elseValue;\n    }\n    let combination: T | undefined;\n    for (let i = 0; i < array.length; i += 1) {\n      const [feel, value] = array[i]!;\n      const weight = b.get(feel);\n      if (weight !== void 0 && weight !== 0) {\n        combination = feel.combine(this, combination, value, weight);\n      }\n    }\n    return combination!;\n  }\n\n  abstract combine(combination: T | undefined, value: T, weight?: number): T;\n\n  abstract between(a: T, b: T): Interpolator<T>;\n\n  abstract coerce(value: T | LikeType<T>): T;\n\n  empty(): LookVector<T> {\n    return LookVector.empty();\n  }\n\n  of(...feels: [Feel, T | LikeType<T>][]): LookVector<T> {\n    const n = feels.length;\n    const array = new Array<[Feel, T]>(n);\n    const index: {[name: string]: number | undefined} = {};\n    for (let i = 0; i < n; i += 1) {\n      const [feel, value] = feels[i]!;\n      array[i] = [feel, this.coerce(value)];\n      index[feel.name] = i;\n    }\n    return this.fromArray(array, index);\n  }\n\n  fromArray(array: readonly [Feel, T][],\n            index?: {readonly [name: string]: number | undefined}): LookVector<T> {\n    return LookVector.fromArray(array, index);\n  }\n\n  toString(): string {\n    return \"Look\" + \".\" + this.name;\n  }\n\n  static font: Look<Font>; // defined by looks\n  static smallFont: Look<Font>; // defined by looks\n  static largeFont: Look<Font>; // defined by looks\n\n  static textColor: Look<Color>; // defined by looks\n  static iconColor: Look<Color>; // defined by looks\n  static labelColor: Look<Color>; // defined by looks\n  static legendColor: Look<Color>; // defined by looks\n  static placeholderColor: Look<Color>; // defined by looks\n  static highlightColor: Look<Color>; // defined by looks\n\n  static statusColor: Look<Color>; // defined by looks\n  static accentColor: Look<Color>; // defined by looks\n\n  static backgroundColor: Look<Color>; // defined by looks\n  static selectionColor: Look<Color>; // defined by looks\n  static borderColor: Look<Color>; // defined by looks\n  static focusColor: Look<Color>; // defined by looks\n\n  static etchColor: Look<Color>; // defined by looks\n  static maskColor: Look<Color>; // defined by looks\n  static tickColor: Look<Color>; // defined by looks\n  static gridColor: Look<Color>; // defined by looks\n\n  static opacity: Look<number>; // defined by looks\n  static shadow: Look<BoxShadow>; // defined by looks\n  static spacing: Look<Length>; // defined by looks\n  static timing: Look<Timing>; // defined by looks\n}\n\n/** @public */\nexport type NumberOrLookLike = Look<number> | number | string | boolean;\n\n/** @public */\nexport type NumberOrLook = Like<Look<number> | number, string | boolean>;\n\n/** @public */\nexport class NumberLook extends Look<number> {\n  override combine(combination: number | undefined, value: number, weight: number): number {\n    if (combination !== void 0) {\n      if (weight === void 0 || weight === 1) {\n        return value;\n      } else if (weight === 0) {\n        return combination;\n      } else {\n        return (1.0 - weight) * combination + weight * value;\n      }\n    } else if (weight !== void 0 && weight !== 1) {\n      return value * weight;\n    }\n    return value;\n  }\n\n  override between(a: number, b: number): Interpolator<number> {\n    return NumberInterpolator(a, b);\n  }\n\n  override coerce(value: number): number {\n    return value;\n  }\n\n  static fromLike<T extends Look<number> | number | string | boolean | null | undefined>(value: T): Look<number> | number | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Look) {\n      return value as Look<number> | Uninitable<T>;\n    }\n    return Numbers.fromLike<number | string | boolean>(value);\n  }\n}\n\n/** @public */\nexport type LengthOrLookLike = Look<Length> | LengthLike;\n\n/** @public */\nexport type LengthOrLook = Look<Length> | Length;\n\n/** @public */\nexport class LengthLook extends Look<Length> {\n  override combine(combination: Length | undefined, value: Length, weight?: number): Length {\n    if (combination !== void 0) {\n      if (weight === void 0 || weight === 1) {\n        return value;\n      } else if (weight === 0) {\n        return combination;\n      } else {\n        return LengthInterpolator(combination, value)(weight);\n      }\n    } else if (weight !== void 0 && weight !== 1) {\n      return value.times(weight);\n    }\n    return value;\n  }\n\n  override between(a: Length, b: Length): Interpolator<Length> {\n    return LengthInterpolator(a, b);\n  }\n\n  override coerce(value: LengthLike): Length {\n    return Length.fromLike(value);\n  }\n\n  static fromLike<T extends Look<Length> | LengthLike | null | undefined>(value: T): Look<Length> | Length | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Look || value instanceof Length) {\n      return value as Look<Length> | Length | Uninitable<T>;\n    }\n    return Length.fromLike<LengthLike>(value);\n  }\n}\n\n/** @public */\nexport type ColorOrLookLike = Look<Color> | ColorLike;\n\n/** @public */\nexport type ColorOrLook = Look<Color> | Color;\n\n/** @public */\nexport class ColorLook extends Look<Color> {\n  override combine(combination: Color | undefined, value: Color, weight?: number): Color {\n    if (combination !== void 0) {\n      if (weight === void 0 || weight === 1) {\n        return value;\n      } else if (weight === 0) {\n        return combination;\n      } else {\n        return combination.interpolateTo(value)(weight);\n      }\n    } else if (weight !== void 0 && weight !== 1) {\n      return value.times(weight);\n    }\n    return value;\n  }\n\n  override between(a: Color, b: Color): Interpolator<Color> {\n    return a.interpolateTo(b);\n  }\n\n  override coerce(value: ColorLike): Color {\n    return Color.fromLike(value);\n  }\n\n  static fromLike<T extends Look<Color> | ColorLike | null | undefined>(value: T): Look<Color> | Color | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Look || value instanceof Color) {\n      return value as Look<Color> | Color | Uninitable<T>;\n    }\n    return Color.fromLike<ColorLike>(value);\n  }\n}\n\n/** @public */\nexport type FontOrLookLike = Look<Font> | FontLike;\n\n/** @public */\nexport type FontOrLook = Look<Font> | Font;\n\n/** @public */\nexport class FontLook extends Look<Font> {\n  override combine(combination: Font | undefined, value: Font, weight?: number): Font {\n    if (weight === void 0 || weight !== 0) {\n      return value;\n    } else if (combination !== void 0) {\n      return combination;\n    }\n    return Font.family(value.family);\n  }\n\n  override between(a: Font, b: Font): Interpolator<Font> {\n    return FontInterpolator(a, b);\n  }\n\n  override coerce(value: FontLike): Font {\n    return Font.fromLike(value);\n  }\n\n  static fromLike<T extends Look<Font> | FontLike | null | undefined>(value: T): Look<Font> | Font | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Look || value instanceof Font) {\n      return value as Look<Font> | Font | Uninitable<T>;\n    }\n    return Font.fromLike<Font | FontLike>(value);\n  }\n}\n\n/** @public */\nexport type ShadowOrLookLike = Look<BoxShadow> | BoxShadowLike;\n\n/** @public */\nexport type ShadowOrLook = Look<BoxShadow> | BoxShadow;\n\n/** @public */\nexport class ShadowLook extends Look<BoxShadow> {\n  override combine(combination: BoxShadow | undefined, value: BoxShadow, weight?: number): BoxShadow {\n    if (weight === void 0 || weight !== 0) {\n      return value;\n    } else if (combination !== void 0) {\n      return combination;\n    }\n    return value;\n  }\n\n  override between(a: BoxShadow, b: BoxShadow): Interpolator<BoxShadow> {\n    return BoxShadowInterpolator(a, b);\n  }\n\n  override coerce(value: BoxShadowLike): BoxShadow {\n    return BoxShadow.fromLike(value)!;\n  }\n\n  static fromLike<T extends Look<BoxShadow> | BoxShadowLike | null | undefined>(value: T): Look<BoxShadow> | BoxShadow | Uninitable<T>{\n    if (value === void 0 || value === null || value instanceof Look || value instanceof BoxShadow) {\n      return value as Look<BoxShadow> | BoxShadow | Uninitable<T>;\n    }\n    return BoxShadow.fromLike<BoxShadowLike>(value);\n  }\n}\n\n/** @public */\nexport type TimingOrLookLike = Look<Timing> | TimingLike;\n\n/** @public */\nexport type TimingOrLook = Look<Timing> | Timing;\n\n/** @public */\nexport class TimingLook extends Look<Timing> {\n  override combine(combination: Timing | undefined, value: Timing, weight: number): Timing {\n    if (weight === void 0 || weight !== 0) {\n      return value;\n    } else if (combination !== void 0) {\n      return combination;\n    }\n    return value;\n  }\n\n  override between(a: Timing, b: Timing): Interpolator<Timing> {\n    return Interpolator(a, b);\n  }\n\n  override coerce(value: TimingLike): Timing {\n    return Timing.fromLike(value);\n  }\n\n  static fromLike<T extends Look<Timing> | TimingLike | null | undefined>(value: T): Look<Timing> | Timing | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Look || value instanceof Timing) {\n      return value as Look<Timing> | Timing | Uninitable<T>;\n    }\n    return Timing.fromLike<TimingLike>(value);\n  }\n}\n\nLook.font = new FontLook(\"font\");\nLook.smallFont = new FontLook(\"smallFont\");\nLook.largeFont = new FontLook(\"largeFont\");\n\nLook.textColor = new ColorLook(\"textColor\");\nLook.iconColor = new ColorLook(\"iconColor\");\nLook.labelColor = new ColorLook(\"labelColor\");\nLook.legendColor = new ColorLook(\"legendColor\");\nLook.placeholderColor = new ColorLook(\"placeholderColor\");\nLook.highlightColor = new ColorLook(\"highlightColor\");\n\nLook.statusColor = new ColorLook(\"statusColor\");\nLook.accentColor = new ColorLook(\"accentColor\");\n\nLook.backgroundColor = new ColorLook(\"backgroundColor\");\nLook.selectionColor = new ColorLook(\"selectionColor\");\nLook.borderColor = new ColorLook(\"borderColor\");\nLook.focusColor = new ColorLook(\"focusColor\");\n\nLook.etchColor = new ColorLook(\"etchColor\");\nLook.maskColor = new ColorLook(\"maskColor\");\nLook.tickColor = new ColorLook(\"tickColor\");\nLook.gridColor = new ColorLook(\"gridColor\");\n\nLook.opacity = new NumberLook(\"opacity\");\nLook.shadow = new ShadowLook(\"shadow\");\nLook.spacing = new LengthLook(\"spacing\");\nLook.timing = new TimingLook(\"timing\");\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Color} from \"@swim/style\";\nimport {FeelVector} from \"./FeelVector\";\nimport type {Look} from \"./Look\";\nimport type {Mood} from \"./Mood\";\n\n/** @public */\nexport abstract class Feel implements Mood {\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  readonly name: string;\n\n  abstract combine<T>(look: Look<T>, combination: T | undefined,\n                      value: T, weight?: number): T;\n\n  empty(): FeelVector {\n    return FeelVector.empty();\n  }\n\n  of(...looks: [Look<unknown>, any][]): FeelVector {\n    return FeelVector.of(...looks);\n  }\n\n  from(array: readonly [Look<unknown>, unknown][],\n       index?: {readonly [name: string]: number | undefined}): FeelVector {\n    return FeelVector.fromArray(array, index);\n  }\n\n  toString(): string {\n    return \"Feel\" + \".\" + this.name;\n  }\n\n  static ambient: Feel; // defined by feels\n  static default: Feel; // defined by feels\n\n  static primary: Feel; // defined by feels\n  static secondary: Feel; // defined by feels\n  static disabled: Feel; // defined by feels\n  static inactive: Feel; // defined by feels\n  static warning: Feel; // defined by feels\n  static alert: Feel; // defined by feels\n\n  static unselected: Feel; // defined by feels\n  static selected: Feel; // defined by feels\n\n  static darker: Feel; // defined by feels\n  static lighter: Feel; // defined by feels\n  static contrasted: Feel; // defined by feels\n\n  static raised: Feel; // defined by feels\n  static covered: Feel; // defined by feels\n\n  static opaque: Feel; // defined by feels\n  static floating: Feel; // defined by feels\n  static embossed: Feel; // defined by feels\n  static nested: Feel; // defined by feels\n  static hovering: Feel; // defined by feels\n  static translucent: Feel; // defined by feels\n  static transparent: Feel; // defined by feels\n\n  static navigating: Feel; // defined by feels\n}\n\n/** @public */\nexport class InterpolatedFeel extends Feel {\n  override combine<T>(look: Look<T>, combination: T | undefined,\n                      value: T, weight?: number): T {\n    return look.combine(combination, value, weight);\n  }\n}\n\n/** @public */\nexport class BrightnessFeel extends Feel {\n  override combine<T>(look: Look<T>, combination: T | undefined,\n                      value: T, weight?: number): T {\n    if (combination instanceof Color && value instanceof Color) {\n      const amount = weight === void 0 ? value.alpha() : value.alpha() * weight;\n      if (amount >= 0) {\n        return combination.darker(amount) as unknown as T;\n      } else {\n        return combination.lighter(-amount) as unknown as T;\n      }\n    }\n    return look.combine(combination, value, weight);\n  }\n}\n\n/** @public */\nexport class OpacityFeel extends Feel {\n  override combine<T>(look: Look<T>, combination: T | undefined,\n                      value: T, weight?: number): T {\n    if (combination instanceof Color && value instanceof Color) {\n      if (weight === void 0) {\n        weight = 1;\n      }\n      const alpha0 = combination.alpha();\n      const alpha1 = alpha0 * value.alpha();\n      const alpha = (1.0 - weight) * alpha0 + weight * alpha1;\n      const color = combination.alpha(alpha) as unknown as T;\n      return color;\n    }\n    return look.combine(combination, value, weight);\n  }\n}\n\nFeel.ambient = new InterpolatedFeel(\"ambient\");\nFeel.default = new InterpolatedFeel(\"default\");\n\nFeel.primary = new InterpolatedFeel(\"primary\");\nFeel.secondary = new InterpolatedFeel(\"secondary\");\nFeel.disabled = new InterpolatedFeel(\"disabled\");\nFeel.inactive = new InterpolatedFeel(\"inactive\");\nFeel.warning = new InterpolatedFeel(\"warning\");\nFeel.alert = new InterpolatedFeel(\"alert\");\n\nFeel.unselected = new InterpolatedFeel(\"unselected\");\nFeel.selected = new InterpolatedFeel(\"selected\");\n\nFeel.darker = new BrightnessFeel(\"darker\");\nFeel.lighter = new BrightnessFeel(\"lighter\");\nFeel.contrasted = new BrightnessFeel(\"contrasted\");\n\nFeel.raised = new InterpolatedFeel(\"raised\");\nFeel.covered = new InterpolatedFeel(\"covered\");\n\nFeel.opaque = new InterpolatedFeel(\"opaque\");\nFeel.floating = new InterpolatedFeel(\"floating\");\nFeel.embossed = new BrightnessFeel(\"embossed\");\nFeel.nested = new BrightnessFeel(\"nested\");\nFeel.hovering = new BrightnessFeel(\"hovering\");\nFeel.translucent = new OpacityFeel(\"translucent\");\nFeel.transparent = new OpacityFeel(\"transparent\");\n\nFeel.navigating = new InterpolatedFeel(\"navigating\");\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {MoodVector} from \"./MoodVector\";\nimport {Feel} from \"./Feel\";\n\n/** @public */\nexport interface Mood {\n  readonly name: string;\n}\n\n/** @public */\nexport const Mood = {} as {\n  ambient: MoodVector; // defined by moods\n  default: MoodVector; // defined by moods\n\n  primary: MoodVector; // defined by moods\n  secondary: MoodVector; // defined by moods\n  disabled: MoodVector; // defined by moods\n  inactive: MoodVector; // defined by moods\n  warning: MoodVector; // defined by moods\n  alert: MoodVector; // defined by moods\n\n  unselected: MoodVector; // defined by moods\n  selected: MoodVector; // defined by moods\n\n  darker: MoodVector; // defined by moods\n  lighter: MoodVector; // defined by moods\n  contrasted: MoodVector; // defined by moods\n\n  raised: MoodVector; // defined by moods\n  covered: MoodVector; // defined by moods\n\n  opaque: MoodVector; // defined by moods\n  floating: MoodVector; // defined by moods\n  transparent: MoodVector; // defined by moods\n  translucent: MoodVector; // defined by moods\n  embossed: MoodVector; // defined by moods\n  nested: MoodVector; // defined by moods\n  hovering: MoodVector; // defined by moods\n\n  navigating: MoodVector; // defined by moods\n};\n\nMood.ambient = MoodVector.of([Feel.ambient, 1]);\nMood.default = MoodVector.of([Feel.default, 1]);\n\nMood.primary = MoodVector.of([Feel.primary, 1]);\nMood.secondary = MoodVector.of([Feel.secondary, 1]);\nMood.disabled = MoodVector.of([Feel.disabled, 1]);\nMood.inactive = MoodVector.of([Feel.inactive, 1]);\nMood.warning = MoodVector.of([Feel.warning, 1]);\nMood.alert = MoodVector.of([Feel.alert, 1]);\n\nMood.unselected = MoodVector.of([Feel.unselected, 1]);\nMood.selected = MoodVector.of([Feel.selected, 1]);\n\nMood.darker = MoodVector.of([Feel.darker, 1]);\nMood.lighter = MoodVector.of([Feel.lighter, 1]);\nMood.contrasted = MoodVector.of([Feel.contrasted, 1]);\n\nMood.raised = MoodVector.of([Feel.raised, 1]);\nMood.covered = MoodVector.of([Feel.covered, 1]);\n\nMood.opaque = MoodVector.of([Feel.opaque, 1]);\nMood.floating = MoodVector.of([Feel.floating, 1]);\nMood.transparent = MoodVector.of([Feel.transparent, 1]);\nMood.translucent = MoodVector.of([Feel.translucent, 1]);\nMood.embossed = MoodVector.of([Feel.embossed, 1]);\nMood.nested = MoodVector.of([Feel.nested, 1]);\nMood.hovering = MoodVector.of([Feel.hovering, 1]);\n\nMood.navigating = MoodVector.of([Feel.navigating, 1]);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Easing} from \"@swim/util\";\nimport {Length} from \"@swim/math\";\nimport {Font} from \"@swim/style\";\nimport {Color} from \"@swim/style\";\nimport {BoxShadow} from \"@swim/style\";\nimport {FeelVector} from \"./FeelVector\";\nimport {ThemeMatrix} from \"./ThemeMatrix\";\nimport {Look} from \"./Look\";\nimport {Feel} from \"./Feel\";\n\n/** @public */\nexport const Theme = {} as {\n  dark: ThemeMatrix, // defined by DarkTheme\n  light: ThemeMatrix, // defined by LightTheme\n};\n\nTheme.dark = (function (): ThemeMatrix {\n  const font = Font.parse(\"14px -apple-system, system-ui, sans-serif\");\n  const smallFont = font.withSize(12);\n  const largeFont = font.withSize(16);\n\n  const textColor = Color.parse(\"#ffffff\");\n  const iconColor = Color.parse(\"#ffffff\");\n  const labelColor = Color.parse(\"#ffffff\").alpha(0.85);\n  const legendColor = Color.parse(\"#ffffff\").alpha(0.55);\n  const placeholderColor = Color.parse(\"#ffffff\").alpha(0.25);\n  const highlightColor = Color.white(0.1);\n\n  const accentColor = Color.parse(\"#a1a3a4\");\n  const primaryColor = Color.parse(\"#66ffdd\");\n  const secondaryColor = Color.parse(\"#32c5ff\");\n\n  const disabledColor = Color.parse(\"#7b7c7d\");\n  const inactiveColor = Color.parse(\"#7b7c7d\");\n  const warningColor = Color.parse(\"#f9f070\");\n  const alertColor = Color.parse(\"#f6511d\");\n\n  const selectionColor = Color.parse(\"#5e5f5f\");\n  const primarySelectionColor = Color.parse(\"#2b6458\");\n  const secondarySelectionColor = Color.parse(\"#326578\");\n  const warningSelectionColor = Color.parse(\"#67643b\");\n  const alertSelectionColor = Color.parse(\"#6a3423\");\n\n  const backgroundColor = Color.parse(\"#181818\");\n  const borderColor = Color.parse(\"#ffffff\").alpha(0.25);\n  const focusColor = primaryColor.alpha(0.5);\n\n  const raisedColor = Color.parse(\"#212121\");\n  const coveredColor = Color.parse(\"#363636\");\n\n  const etchColor = Color.parse(\"#262626\");\n  const maskColor = Color.parse(\"#343434\");\n  const tickColor = Color.parse(\"#c0c0c0\");\n  const gridColor = Color.parse(\"#3c3c3c\");\n\n  const spacing = Length.px(10);\n\n  const ambientFeel = FeelVector.of(\n    [Look.font, font],\n    [Look.smallFont, smallFont],\n    [Look.largeFont, largeFont],\n\n    [Look.textColor, textColor],\n    [Look.iconColor, iconColor],\n    [Look.labelColor, labelColor],\n    [Look.legendColor, legendColor],\n    [Look.placeholderColor, placeholderColor],\n    [Look.highlightColor, highlightColor],\n\n    [Look.statusColor, textColor],\n    [Look.accentColor, accentColor],\n\n    [Look.backgroundColor, backgroundColor],\n    [Look.selectionColor, selectionColor],\n    [Look.borderColor, borderColor],\n    [Look.focusColor, focusColor],\n\n    [Look.etchColor, etchColor],\n    [Look.maskColor, maskColor],\n    [Look.tickColor, tickColor],\n    [Look.gridColor, gridColor],\n\n    [Look.spacing, spacing],\n    [Look.timing, Easing.linear.withDuration(250)],\n  );\n\n  const defaultFeel = FeelVector.of(\n    [Look.font, font],\n    [Look.smallFont, smallFont],\n    [Look.largeFont, largeFont],\n\n    [Look.textColor, textColor],\n    [Look.iconColor, iconColor],\n    [Look.labelColor, labelColor],\n    [Look.legendColor, legendColor],\n    [Look.placeholderColor, placeholderColor],\n    [Look.highlightColor, highlightColor],\n\n    [Look.statusColor, textColor],\n    [Look.accentColor, accentColor],\n\n    [Look.backgroundColor, backgroundColor],\n    [Look.selectionColor, selectionColor],\n    [Look.borderColor, borderColor],\n    [Look.focusColor, focusColor],\n\n    [Look.etchColor, etchColor],\n    [Look.maskColor, maskColor],\n    [Look.tickColor, tickColor],\n    [Look.gridColor, gridColor],\n\n    [Look.spacing, spacing],\n    [Look.timing, Easing.cubicOut.withDuration(250)],\n  );\n\n  const primaryFeel = FeelVector.of(\n    [Look.accentColor, primaryColor],\n    [Look.selectionColor, primarySelectionColor],\n  );\n\n  const secondaryFeel = FeelVector.of(\n    [Look.accentColor, secondaryColor],\n    [Look.selectionColor, secondarySelectionColor],\n  );\n\n  const disabledFeel = FeelVector.of(\n    [Look.textColor, disabledColor],\n    [Look.iconColor, disabledColor],\n    [Look.statusColor, disabledColor],\n    [Look.accentColor, disabledColor],\n  );\n\n  const inactiveFeel = FeelVector.of(\n    [Look.statusColor, inactiveColor],\n    [Look.accentColor, inactiveColor],\n  );\n\n  const warningFeel = FeelVector.of(\n    [Look.statusColor, warningColor],\n    [Look.accentColor, warningColor],\n    [Look.selectionColor, warningSelectionColor],\n  );\n\n  const alertFeel = FeelVector.of(\n    [Look.statusColor, alertColor],\n    [Look.accentColor, alertColor],\n    [Look.selectionColor, alertSelectionColor],\n  );\n\n  const unselectedFeel = FeelVector.of(\n    [Look.textColor, labelColor],\n    [Look.iconColor, labelColor],\n    [Look.backgroundColor, backgroundColor.darker(1)],\n  );\n\n  const selectedFeel = FeelVector.of(\n    [Look.textColor, textColor],\n    [Look.iconColor, iconColor],\n    [Look.backgroundColor, selectionColor],\n  );\n\n  const raisedFeel = FeelVector.of(\n    [Look.labelColor, labelColor.darker(1 / 3)],\n    [Look.legendColor, legendColor.darker(1 / 3)],\n    [Look.backgroundColor, raisedColor],\n  );\n\n  const coveredFeel = FeelVector.of(\n    [Look.labelColor, labelColor.darker(1 / 3)],\n    [Look.legendColor, legendColor.darker(1 / 3)],\n    [Look.backgroundColor, coveredColor],\n  );\n\n  const opaqueFeel = FeelVector.of(\n    [Look.backgroundColor, backgroundColor],\n    [Look.borderColor, borderColor],\n  );\n\n  const floatingFeel = FeelVector.of(\n    [Look.shadow, BoxShadow.create(0, 2, 4, 0, Color.black(0.5))],\n  );\n\n  const darkerFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(1)],\n    [Look.selectionColor, Color.black(1)],\n    [Look.iconColor, Color.black(1)],\n    [Look.statusColor, Color.black(1)],\n    [Look.accentColor, Color.black(1)],\n    [Look.etchColor, Color.black(1)],\n    [Look.maskColor, Color.black(1)],\n  );\n\n  const lighterFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(-1)],\n    [Look.selectionColor, Color.black(-1)],\n    [Look.iconColor, Color.black(-1)],\n    [Look.statusColor, Color.black(-1)],\n    [Look.accentColor, Color.black(-1)],\n    [Look.etchColor, Color.black(-1)],\n    [Look.maskColor, Color.black(-1)],\n  );\n\n  const contrastedFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(-1)],\n    [Look.selectionColor, Color.black(-1)],\n    [Look.iconColor, Color.black(-1)],\n    [Look.statusColor, Color.black(-1)],\n    [Look.accentColor, Color.black(-1)],\n    [Look.etchColor, Color.black(-1)],\n    [Look.maskColor, Color.black(-1)],\n  );\n\n  const embossedFeel = FeelVector.of(\n    [Look.iconColor, Color.black(2)],\n    [Look.statusColor, Color.black(2)],\n    [Look.accentColor, Color.black(2)],\n  );\n\n  const nestedFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(1 / 3)],\n    [Look.borderColor, Color.black(1 / 3)],\n  );\n\n  const hoveringFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(-2)],\n    [Look.etchColor, Color.black(-1)],\n    [Look.maskColor, Color.black(-1)],\n  );\n\n  const translucentFeel = FeelVector.of(\n    [Look.iconColor, Color.black(0.8)],\n    [Look.statusColor, Color.black(0.8)],\n    [Look.accentColor, Color.black(0.8)],\n    [Look.backgroundColor, Color.black(0.8)],\n    [Look.selectionColor, Color.black(0.8)],\n  );\n\n  const transparentFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(0)],\n    [Look.selectionColor, Color.black(0)],\n  );\n\n  const navigatingFeel = FeelVector.of(\n    [Look.timing, Easing.cubicOut.withDuration(350)],\n  );\n\n  const theme = ThemeMatrix.forCols(\n    [Feel.ambient, ambientFeel],\n    [Feel.default, defaultFeel],\n\n    [Feel.primary, primaryFeel],\n    [Feel.secondary, secondaryFeel],\n    [Feel.disabled, disabledFeel],\n    [Feel.inactive, inactiveFeel],\n    [Feel.warning, warningFeel],\n    [Feel.alert, alertFeel],\n\n    [Feel.unselected, unselectedFeel],\n    [Feel.selected, selectedFeel],\n\n    [Feel.darker, darkerFeel],\n    [Feel.lighter, lighterFeel],\n    [Feel.contrasted, contrastedFeel],\n\n    [Feel.raised, raisedFeel],\n    [Feel.covered, coveredFeel],\n\n    [Feel.opaque, opaqueFeel],\n    [Feel.floating, floatingFeel],\n    [Feel.embossed, embossedFeel],\n    [Feel.nested, nestedFeel],\n    [Feel.hovering, hoveringFeel],\n    [Feel.translucent, translucentFeel],\n    [Feel.transparent, transparentFeel],\n\n    [Feel.navigating, navigatingFeel],\n  );\n\n  return theme;\n})();\n\nTheme.light = (function (): ThemeMatrix {\n  const font = Font.parse(\"14px -apple-system, system-ui, sans-serif\");\n  const smallFont = font.withSize(12);\n  const largeFont = font.withSize(16);\n\n  const textColor = Color.parse(\"#000000\");\n  const iconColor = Color.parse(\"#4a4a4a\");\n  const labelColor = Color.parse(\"#000000\").alpha(0.85);\n  const legendColor = Color.parse(\"#000000\").alpha(0.5);\n  const placeholderColor = Color.parse(\"#000000\").alpha(0.25);\n  const highlightColor = Color.black(0.05);\n\n  const accentColor = Color.parse(\"#a1a3a4\");\n  const primaryColor = Color.parse(\"#00b0a7\");\n  const secondaryColor = Color.parse(\"#008ec0\");\n\n  const disabledColor = Color.parse(\"#7b7c7d\");\n  const inactiveColor = Color.parse(\"#7b7c7d\");\n  const warningColor = Color.parse(\"#f0b600\");\n  const alertColor = Color.parse(\"#e24214\");\n\n  const selectionColor = Color.parse(\"#e0e0e1\");\n  const primarySelectionColor = Color.parse(\"#bae8e6\");\n  const secondarySelectionColor = Color.parse(\"#b5e2f1\");\n  const warningSelectionColor = Color.parse(\"#f9ebc0\");\n  const alertSelectionColor = Color.parse(\"#fddad0\");\n\n  const backgroundColor = Color.parse(\"#f9f9f9\");\n  const borderColor = Color.parse(\"#000000\").alpha(0.25);\n  const focusColor = primaryColor.alpha(0.5);\n\n  const raisedColor = Color.parse(\"#f1f1f1\");\n  const coveredColor = Color.parse(\"#ffffff\");\n\n  const etchColor = Color.parse(\"#d8d8d8\");\n  const maskColor = Color.parse(\"#dcdcdc\");\n  const tickColor = Color.parse(\"#262626\");\n  const gridColor = Color.parse(\"#e0e0e0\");\n\n  const spacing = Length.px(10);\n\n  const ambientFeel = FeelVector.of(\n    [Look.font, font],\n    [Look.smallFont, smallFont],\n    [Look.largeFont, largeFont],\n\n    [Look.textColor, textColor],\n    [Look.iconColor, iconColor],\n    [Look.labelColor, labelColor],\n    [Look.legendColor, legendColor],\n    [Look.placeholderColor, placeholderColor],\n    [Look.highlightColor, highlightColor],\n\n    [Look.statusColor, textColor],\n    [Look.accentColor, accentColor],\n\n    [Look.backgroundColor, backgroundColor],\n    [Look.selectionColor, selectionColor],\n    [Look.borderColor, borderColor],\n    [Look.focusColor, focusColor],\n\n    [Look.etchColor, etchColor],\n    [Look.maskColor, maskColor],\n    [Look.tickColor, tickColor],\n    [Look.gridColor, gridColor],\n\n    [Look.spacing, spacing],\n    [Look.timing, Easing.linear.withDuration(250)],\n  );\n\n  const defaultFeel = FeelVector.of(\n    [Look.font, font],\n    [Look.smallFont, smallFont],\n    [Look.largeFont, largeFont],\n\n    [Look.textColor, textColor],\n    [Look.iconColor, iconColor],\n    [Look.labelColor, labelColor],\n    [Look.legendColor, legendColor],\n    [Look.placeholderColor, placeholderColor],\n    [Look.highlightColor, highlightColor],\n\n    [Look.statusColor, textColor],\n    [Look.accentColor, accentColor],\n\n    [Look.backgroundColor, backgroundColor],\n    [Look.selectionColor, selectionColor],\n    [Look.borderColor, borderColor],\n    [Look.focusColor, focusColor],\n\n    [Look.etchColor, etchColor],\n    [Look.maskColor, maskColor],\n    [Look.tickColor, tickColor],\n    [Look.gridColor, gridColor],\n\n    [Look.spacing, spacing],\n    [Look.timing, Easing.cubicOut.withDuration(250)],\n  );\n\n  const primaryFeel = FeelVector.of(\n    [Look.accentColor, primaryColor],\n    [Look.selectionColor, primarySelectionColor],\n  );\n\n  const secondaryFeel = FeelVector.of(\n    [Look.accentColor, secondaryColor],\n    [Look.selectionColor, secondarySelectionColor],\n  );\n\n  const disabledFeel = FeelVector.of(\n    [Look.textColor, disabledColor],\n    [Look.iconColor, disabledColor],\n    [Look.statusColor, disabledColor],\n    [Look.accentColor, disabledColor],\n  );\n\n  const inactiveFeel = FeelVector.of(\n    [Look.statusColor, inactiveColor],\n    [Look.accentColor, inactiveColor],\n  );\n\n  const warningFeel = FeelVector.of(\n    [Look.statusColor, warningColor],\n    [Look.accentColor, warningColor],\n    [Look.selectionColor, warningSelectionColor],\n  );\n\n  const alertFeel = FeelVector.of(\n    [Look.statusColor, alertColor],\n    [Look.accentColor, alertColor],\n    [Look.selectionColor, alertSelectionColor],\n  );\n\n  const unselectedFeel = FeelVector.of(\n    [Look.textColor, labelColor],\n    [Look.iconColor, labelColor],\n    [Look.backgroundColor, backgroundColor.darker(1 / 2)],\n  );\n\n  const selectedFeel = FeelVector.of(\n    [Look.textColor, textColor],\n    [Look.iconColor, iconColor],\n    [Look.backgroundColor, selectionColor],\n  );\n\n  const raisedFeel = FeelVector.of(\n    [Look.labelColor, labelColor.darker(1 / 3)],\n    [Look.legendColor, legendColor.darker(1 / 3)],\n    [Look.backgroundColor, raisedColor],\n  );\n\n  const coveredFeel = FeelVector.of(\n    [Look.labelColor, labelColor.darker(1 / 3)],\n    [Look.legendColor, legendColor.darker(1 / 3)],\n    [Look.backgroundColor, coveredColor],\n  );\n\n  const opaqueFeel = FeelVector.of(\n    [Look.backgroundColor, backgroundColor],\n    [Look.borderColor, borderColor],\n  );\n\n  const floatingFeel = FeelVector.of(\n    [Look.shadow, BoxShadow.create(0, 2, 4, 0, Color.black(0.5))],\n  );\n\n  const darkerFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(1)],\n    [Look.selectionColor, Color.black(1)],\n    [Look.iconColor, Color.black(1)],\n    [Look.statusColor, Color.black(1)],\n    [Look.accentColor, Color.black(1)],\n    [Look.etchColor, Color.black(1)],\n    [Look.maskColor, Color.black(1)],\n  );\n\n  const lighterFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(-1)],\n    [Look.selectionColor, Color.black(-1)],\n    [Look.iconColor, Color.black(-1)],\n    [Look.statusColor, Color.black(-1)],\n    [Look.accentColor, Color.black(-1)],\n    [Look.etchColor, Color.black(-1)],\n    [Look.maskColor, Color.black(-1)],\n  );\n\n  const contrastedFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(1)],\n    [Look.selectionColor, Color.black(1)],\n    [Look.iconColor, Color.black(1)],\n    [Look.statusColor, Color.black(1)],\n    [Look.accentColor, Color.black(1)],\n    [Look.etchColor, Color.black(1)],\n    [Look.maskColor, Color.black(1)],\n  );\n\n  const embossedFeel = FeelVector.of(\n    [Look.iconColor, Color.black(1)],\n    [Look.statusColor, Color.black(1)],\n    [Look.accentColor, Color.black(1)],\n  );\n\n  const nestedFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(1 / 24)],\n    [Look.borderColor, Color.black(1 / 24)],\n  );\n\n  const hoveringFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(1 / 4)],\n    [Look.etchColor, Color.black(1 / 4)],\n    [Look.maskColor, Color.black(1 / 4)],\n  );\n\n  const translucentFeel = FeelVector.of(\n    [Look.iconColor, Color.black(0.8)],\n    [Look.statusColor, Color.black(0.8)],\n    [Look.accentColor, Color.black(0.8)],\n    [Look.backgroundColor, Color.black(0.8)],\n    [Look.selectionColor, Color.black(0.8)],\n  );\n\n  const transparentFeel = FeelVector.of(\n    [Look.backgroundColor, Color.black(0)],\n    [Look.selectionColor, Color.black(0)],\n  );\n\n  const navigatingFeel = FeelVector.of(\n    [Look.timing, Easing.cubicOut.withDuration(350)],\n  );\n\n  const theme = ThemeMatrix.forCols(\n    [Feel.ambient, ambientFeel],\n    [Feel.default, defaultFeel],\n\n    [Feel.primary, primaryFeel],\n    [Feel.secondary, secondaryFeel],\n    [Feel.disabled, disabledFeel],\n    [Feel.inactive, inactiveFeel],\n    [Feel.warning, warningFeel],\n    [Feel.alert, alertFeel],\n\n    [Feel.unselected, unselectedFeel],\n    [Feel.selected, selectedFeel],\n\n    [Feel.raised, raisedFeel],\n    [Feel.covered, coveredFeel],\n\n    [Feel.opaque, opaqueFeel],\n    [Feel.floating, floatingFeel],\n    [Feel.embossed, embossedFeel],\n    [Feel.nested, nestedFeel],\n    [Feel.hovering, hoveringFeel],\n\n    [Feel.translucent, translucentFeel],\n    [Feel.darker, darkerFeel],\n    [Feel.lighter, lighterFeel],\n    [Feel.contrasted, contrastedFeel],\n    [Feel.transparent, transparentFeel],\n\n    [Feel.navigating, navigatingFeel],\n  );\n\n  return theme;\n})();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport type {FromLike} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport {Timing} from \"@swim/util\";\nimport type {Creatable} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport type {ComponentFlags} from \"@swim/component\";\nimport type {ComponentObserver} from \"@swim/component\";\nimport {Component} from \"@swim/component\";\nimport type {ConstraintExpressionLike} from \"@swim/constraint\";\nimport {ConstraintExpression} from \"@swim/constraint\";\nimport type {ConstraintVariable} from \"@swim/constraint\";\nimport {ConstraintProperty} from \"@swim/constraint\";\nimport type {ConstraintRelation} from \"@swim/constraint\";\nimport type {ConstraintStrengthLike} from \"@swim/constraint\";\nimport {ConstraintStrength} from \"@swim/constraint\";\nimport {Constraint} from \"@swim/constraint\";\nimport type {ConstraintScope} from \"@swim/constraint\";\nimport type {ConstraintContext} from \"@swim/constraint\";\nimport {R2Box} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport {Look} from \"@swim/theme\";\nimport {Feel} from \"@swim/theme\";\nimport {Mood} from \"@swim/theme\";\nimport type {MoodVectorUpdates} from \"@swim/theme\";\nimport {MoodVector} from \"@swim/theme\";\nimport {MoodMatrix} from \"@swim/theme\";\nimport {ThemeMatrix} from \"@swim/theme\";\nimport type {ThemeContext} from \"@swim/theme\";\nimport {ViewRelation} from \"./\"; // forward import\nimport {Gesture} from \"./\"; // forward import\nimport type {LayoutViewport} from \"./Viewport\";\nimport type {VisualViewport} from \"./Viewport\";\nimport {ViewportService} from \"./\"; // forward import\nimport {DisplayerService} from \"./\"; // forward import\nimport {SolverService} from \"./\"; // forward import\nimport {StylerService} from \"./\"; // forward import\n\n/** @public */\nexport type ViewIdiom = \"unspecified\" | \"mobile\" | \"tablet\" | \"desktop\";\n\n/** @public */\nexport interface ViewInsets {\n  readonly insetTop: number;\n  readonly insetRight: number;\n  readonly insetBottom: number;\n  readonly insetLeft: number;\n}\n\n/** @public */\nexport const ViewInsets = {\n  zero: Lazy(function (): ViewInsets {\n    return Object.freeze({\n      insetTop: 0,\n      insetRight: 0,\n      insetBottom: 0,\n      insetLeft: 0,\n    });\n  }),\n\n  equal(x: ViewInsets | null | undefined, y: ViewInsets | null | undefined): boolean {\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"object\" && x !== null && typeof y === \"object\" && y !== null) {\n      return x.insetTop === y.insetTop\n          && x.insetRight === y.insetRight\n          && x.insetBottom === y.insetBottom\n          && x.insetLeft === y.insetLeft;\n    }\n    return false;\n  },\n};\n\n/** @public */\nexport type ViewFlags = ComponentFlags;\n\n/** @public */\nexport interface ViewFactory<V extends View = View> extends Creatable<V>, FromLike<V> {\n}\n\n/** @public */\nexport interface ViewClass<V extends View = View> extends Function, ViewFactory<V> {\n  readonly prototype: V;\n}\n\n/** @public */\nexport interface ViewConstructor<V extends View = View> extends ViewClass<V> {\n  new(): V;\n}\n\n/** @public */\nexport interface ViewObserver<V extends View = View> extends ComponentObserver<V> {\n  viewWillAttachParent?(parent: View, view: V): void;\n\n  viewDidAttachParent?(parent: View, view: V): void;\n\n  viewWillDetachParent?(parent: View, view: V): void;\n\n  viewDidDetachParent?(parent: View, view: V): void;\n\n  viewWillInsertChild?(child: View, target: View | null, view: V): void;\n\n  viewDidInsertChild?(child: View, target: View | null, view: V): void;\n\n  viewWillRemoveChild?(child: View, view: V): void;\n\n  viewDidRemoveChild?(child: View, view: V): void;\n\n  viewWillReinsertChild?(child: View, target: View | null, view: V): void;\n\n  viewDidReinsertChild?(child: View, target: View | null, view: V): void;\n\n  viewWillMount?(view: V): void;\n\n  viewDidMount?(view: V): void;\n\n  viewWillUnmount?(view: V): void;\n\n  viewDidUnmount?(view: V): void;\n\n  viewWillCull?(view: V): void;\n\n  viewDidCull?(view: V): void;\n\n  viewWillUncull?(view: V): void;\n\n  viewDidUncull?(view: V): void;\n\n  viewWillHide?(view: V): void;\n\n  viewDidHide?(view: V): void;\n\n  viewWillUnhide?(view: V): void;\n\n  viewDidUnhide?(view: V): void;\n\n  viewWillResize?(view: V): void;\n\n  viewDidResize?(view: V): void;\n\n  viewWillScroll?(view: V): void;\n\n  viewDidScroll?(view: V): void;\n\n  viewWillChange?(view: V): void;\n\n  viewDidChange?(view: V): void;\n\n  viewWillAnimate?(view: V): void;\n\n  viewDidAnimate?(view: V): void;\n\n  viewWillProject?(view: V): void;\n\n  viewDidProject?(view: V): void;\n\n  viewWillLayout?(view: V): void;\n\n  viewDidLayout?(view: V): void;\n\n  viewWillRender?(view: V): void;\n\n  viewDidRender?(view: V): void;\n\n  viewWillRasterize?(view: V): void;\n\n  viewDidRasterize?(view: V): void;\n\n  viewWillComposite?(view: V): void;\n\n  viewDidComposite?(view: V): void;\n\n  viewWillApplyTheme?(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean, view: V): void;\n\n  viewDidApplyTheme?(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean, view: V): void;\n}\n\n/** @public */\nexport class View extends Component<View> implements ConstraintScope, ConstraintContext, ThemeContext, EventTarget {\n  constructor() {\n    super();\n    this.constraints = null;\n    this.constraintVariables = null;\n\n    // Observer caches\n    this.willAttachParentObservers = null;\n    this.didAttachParentObservers = null;\n    this.willDetachParentObservers = null;\n    this.didDetachParentObservers = null;\n    this.willInsertChildObservers = null;\n    this.didInsertChildObservers = null;\n    this.willRemoveChildObservers = null;\n    this.didRemoveChildObservers = null;\n    this.willMountObservers = null;\n    this.didMountObservers = null;\n    this.willUnmountObservers = null;\n    this.didUnmountObservers = null;\n    this.willResizeObservers = null;\n    this.didResizeObservers = null;\n    this.willScrollObservers = null;\n    this.didScrollObservers = null;\n    this.willChangeObservers = null;\n    this.didChangeObservers = null;\n    this.willAnimateObservers = null;\n    this.didAnimateObservers = null;\n    this.willProjectObservers = null;\n    this.didProjectObservers = null;\n    this.willLayoutObservers = null;\n    this.didLayoutObservers = null;\n    this.willRenderObservers = null;\n    this.didRenderObservers = null;\n    this.willRasterizeObservers = null;\n    this.didRasterizeObservers = null;\n    this.willCompositeObservers = null;\n    this.didCompositeObservers = null;\n  }\n\n  declare readonly observerType?: Class<ViewObserver>;\n\n  override get componentType(): Class<View> {\n    return View;\n  }\n\n  /** @internal */\n  override attachParent(parent: View, nextSibling: View | null): void {\n    // assert(this.parent === null);\n    this.willAttachParent(parent);\n    (this as Mutable<this>).parent = parent;\n    let previousSibling: View | null;\n    if (nextSibling !== null) {\n      previousSibling = nextSibling.previousSibling;\n      this.setNextSibling(nextSibling);\n      nextSibling.setPreviousSibling(this);\n    } else {\n      previousSibling = parent.lastChild;\n      parent.setLastChild(this);\n    }\n    if (previousSibling !== null) {\n      previousSibling.setNextSibling(this);\n      this.setPreviousSibling(previousSibling);\n    } else {\n      parent.setFirstChild(this);\n    }\n    if (parent.mounted) {\n      if (parent.culled) {\n        this.cascadeCull();\n      }\n      this.cascadeMount();\n    }\n    this.onAttachParent(parent);\n    this.didAttachParent(parent);\n  }\n\n  /** @internal */\n  protected willAttachParentObservers: Set<Required<Pick<ViewObserver, \"viewWillAttachParent\">>> | null;\n  protected override willAttachParent(parent: View): void {\n    const observers = this.willAttachParentObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillAttachParent(parent, this);\n      }\n    }\n  }\n\n  protected override onAttachParent(parent: View): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didAttachParentObservers: Set<Required<Pick<ViewObserver, \"viewDidAttachParent\">>> | null;\n  protected override didAttachParent(parent: View): void {\n    const observers = this.didAttachParentObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidAttachParent(parent, this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willDetachParentObservers: Set<Required<Pick<ViewObserver, \"viewWillDetachParent\">>> | null;\n  protected override willDetachParent(parent: View): void {\n    const observers = this.willDetachParentObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillDetachParent(parent, this);\n      }\n    }\n  }\n\n  protected override onDetachParent(parent: View): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didDetachParentObservers: Set<Required<Pick<ViewObserver, \"viewDidDetachParent\">>> | null;\n  protected override didDetachParent(parent: View): void {\n    const observers = this.didDetachParentObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidDetachParent(parent, this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willInsertChildObservers: Set<Required<Pick<ViewObserver, \"viewWillInsertChild\">>> | null;\n  protected override willInsertChild(child: View, target: View | null): void {\n    super.willInsertChild(child, target);\n    const observers = this.willInsertChildObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillInsertChild(child, target, this);\n      }\n    }\n  }\n\n  protected override onInsertChild(child: View, target: View | null): void {\n    super.onInsertChild(child, target);\n  }\n\n  /** @internal */\n  protected didInsertChildObservers: Set<Required<Pick<ViewObserver, \"viewDidInsertChild\">>> | null;\n  protected override didInsertChild(child: View, target: View | null): void {\n    const observers = this.didInsertChildObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidInsertChild(child, target, this);\n      }\n    }\n    super.didInsertChild(child, target);\n  }\n\n  /** @internal */\n  override cascadeInsert(updateFlags?: ViewFlags): void {\n    if ((this.flags & View.MountedFlag) !== 0) {\n      if (updateFlags === void 0) {\n        updateFlags = 0;\n      }\n      updateFlags |= this.flags & View.UpdateMask;\n      if ((updateFlags & View.ProcessMask) !== 0) {\n        this.cascadeProcess(updateFlags);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willRemoveChildObservers: Set<Required<Pick<ViewObserver, \"viewWillRemoveChild\">>> | null;\n  protected override willRemoveChild(child: View): void {\n    super.willRemoveChild(child);\n    const observers = this.willRemoveChildObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillRemoveChild(child, this);\n      }\n    }\n  }\n\n  protected override onRemoveChild(child: View): void {\n    super.onRemoveChild(child);\n  }\n\n  /** @internal */\n  protected didRemoveChildObservers: Set<Required<Pick<ViewObserver, \"viewDidRemoveChild\">>> | null;\n  protected override didRemoveChild(child: View): void {\n    const observers = this.didRemoveChildObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidRemoveChild(child, this);\n      }\n    }\n    super.didRemoveChild(child);\n  }\n\n  protected override willReinsertChild(child: View, target: View | null): void {\n    super.willReinsertChild(child, target);\n    this.callObservers(\"viewWillReinsertChild\", child, target, this);\n  }\n\n  protected override onReinsertChild(child: View, target: View | null): void {\n    super.onReinsertChild(child, target);\n  }\n\n  protected override didReinsertChild(child: View, target: View | null): void {\n    this.callObservers(\"viewDidReinsertChild\", child, target, this);\n    super.didReinsertChild(child, target);\n  }\n\n  /** @internal */\n  override mount(): void {\n    throw new Error();\n  }\n\n  protected willMountObservers: Set<Required<Pick<ViewObserver, \"viewWillMount\">>> | null;\n  protected override willMount(): void {\n    super.willMount();\n    const observers = this.willMountObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillMount(this);\n      }\n    }\n  }\n\n  protected didMountObservers: Set<Required<Pick<ViewObserver, \"viewDidMount\">>> | null;\n  protected override didMount(): void {\n    // subsume super\n    this.requestUpdate(this, this.flags & View.UpdateMask, false);\n    this.requireUpdate(this.mountFlags);\n\n    if (!this.culled && this.decoherent !== null && this.decoherent.length !== 0) {\n      this.requireUpdate(View.NeedsChange | View.NeedsAnimate);\n    }\n\n    this.mountFasteners();\n\n    this.activateLayout();\n    const observers = this.didMountObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidMount(this);\n      }\n    }\n    super.didMount();\n  }\n\n  /** @internal */\n  override unmount(): void {\n    throw new Error();\n  }\n\n  protected willUnmountObservers: Set<Required<Pick<ViewObserver, \"viewWillUnmount\">>> | null;\n  protected override willUnmount(): void {\n    super.willUnmount();\n    const observers = this.willUnmountObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillUnmount(this);\n      }\n    }\n    this.deactivateLayout();\n  }\n\n  protected didUnmountObservers: Set<Required<Pick<ViewObserver, \"viewDidUnmount\">>> | null;\n  protected override didUnmount(): void {\n    const observers = this.didUnmountObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidUnmount(this);\n      }\n    }\n    super.didUnmount();\n  }\n\n  get culled(): boolean {\n    return (this.flags & View.CulledMask) !== 0;\n  }\n\n  setCulled(culled: boolean): void {\n    const flags = this.flags;\n    if (culled && (flags & View.CulledFlag) === 0) {\n      if ((flags & View.CullFlag) === 0) {\n        this.willCull();\n        this.setFlags(flags | View.CulledFlag);\n        this.onCull();\n        this.cullChildren();\n        this.didCull();\n      } else {\n        this.setFlags(flags | View.CulledFlag);\n      }\n    } else if (!culled && (flags & View.CulledFlag) !== 0) {\n      if ((flags & View.CullFlag) === 0) {\n        this.willUncull();\n        this.setFlags(flags & ~View.CulledFlag);\n        this.uncullChildren();\n        this.onUncull();\n        this.didUncull();\n      } else {\n        this.setFlags(flags & ~View.CulledFlag);\n      }\n    }\n  }\n\n  /** @internal */\n  cascadeCull(): void {\n    if ((this.flags & View.CullFlag) !== 0) {\n      return;\n    } else if ((this.flags & View.CulledFlag) !== 0) {\n      this.setFlags(this.flags | View.CullFlag);\n      return;\n    }\n    this.willCull();\n    this.setFlags(this.flags | View.CullFlag);\n    this.onCull();\n    this.cullChildren();\n    this.didCull();\n  }\n\n  protected willCull(): void {\n    this.callObservers(\"viewWillCull\", this);\n  }\n\n  protected onCull(): void {\n    // hook\n  }\n\n  protected didCull(): void {\n    this.callObservers(\"viewDidCull\", this);\n  }\n\n  /** @internal */\n  protected cullChildren(): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      child.cascadeCull();\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent cull\");\n      }\n      child = next;\n    }\n  }\n\n  /** @internal */\n  cascadeUncull(): void {\n    if ((this.flags & View.CullFlag) === 0) {\n      return;\n    } else if ((this.flags & View.CulledFlag) !== 0) {\n      this.setFlags(this.flags & ~View.CullFlag);\n      return;\n    }\n    this.willUncull();\n    this.setFlags(this.flags & ~View.CullFlag);\n    this.uncullChildren();\n    this.onUncull();\n    this.didUncull();\n  }\n\n  get uncullFlags(): ViewFlags {\n    return (this.constructor as typeof View).UncullFlags;\n  }\n\n  protected willUncull(): void {\n    this.callObservers(\"viewWillUncull\", this);\n  }\n\n  protected onUncull(): void {\n    this.requestUpdate(this, this.flags & View.UpdateMask, false);\n    this.requireUpdate(this.uncullFlags);\n\n    if (this.decoherent !== null && this.decoherent.length !== 0) {\n      this.requireUpdate(View.NeedsChange | View.NeedsAnimate);\n    }\n\n    if (this.mood.derived) {\n      this.mood.decohere();\n    }\n    if (this.theme.derived) {\n      this.theme.decohere();\n    }\n  }\n\n  protected didUncull(): void {\n    this.callObservers(\"viewDidUncull\", this);\n  }\n\n  /** @internal */\n  protected uncullChildren(): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      child.cascadeUncull();\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent uncull\");\n      }\n      child = next;\n    }\n  }\n\n  /**\n   * Returns `true` if this view is ineligible for rendering and hit testing,\n   * and should be excluded from its parent's layout and hit bounds.\n   */\n  get hidden(): boolean {\n    return (this.flags & View.HiddenMask) !== 0;\n  }\n\n  /**\n   * Makes this view ineligible for rendering and hit testing, and excludes\n   * this view from its parent's layout and hit bounds, when `hidden` is `true`.\n   * Makes this view eligible for rendering and hit testing, and includes this\n   * view in its parent's layout and hit bounds, when `hidden` is `false`.\n   */\n  setHidden(hidden: boolean): void {\n    const flags = this.flags;\n    if (hidden && (flags & View.HiddenFlag) === 0) {\n      this.setFlags(flags | View.HiddenFlag);\n      if ((flags & View.HideFlag) === 0) {\n        this.willHide();\n        this.onHide();\n        this.hideChildren();\n        this.didHide();\n      }\n    } else if (!hidden && (flags & View.HiddenFlag) !== 0) {\n      this.setFlags(flags & ~View.HiddenFlag);\n      if ((flags & View.HideFlag) === 0) {\n        this.willUnhide();\n        this.unhideChildren();\n        this.onUnhide();\n        this.didUnhide();\n      }\n    }\n  }\n\n  /** @internal */\n  cascadeHide(): void {\n    if ((this.flags & View.HideFlag) !== 0) {\n      return;\n    } else if ((this.flags & View.HiddenFlag) !== 0) {\n      this.setFlags(this.flags | View.HideFlag);\n      return;\n    }\n    this.willHide();\n    this.setFlags(this.flags | View.HideFlag);\n    this.onHide();\n    this.hideChildren();\n    this.didHide();\n  }\n\n  protected willHide(): void {\n    this.callObservers(\"viewWillHide\", this);\n  }\n\n  protected onHide(): void {\n    // hook\n  }\n\n  protected didHide(): void {\n    this.callObservers(\"viewDidHide\", this);\n  }\n\n  /** @internal */\n  protected hideChildren(): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      child.cascadeHide();\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent hide\");\n      }\n      child = next;\n    }\n  }\n\n  cascadeUnhide(): void {\n    if ((this.flags & View.HideFlag) === 0) {\n      return;\n    } else if ((this.flags & View.HiddenFlag) !== 0) {\n      this.setFlags(this.flags & ~View.HideFlag);\n      return;\n    }\n    this.willUnhide();\n    this.setFlags(this.flags & ~View.HideFlag);\n    this.unhideChildren();\n    this.onUnhide();\n    this.didUnhide();\n  }\n\n  get unhideFlags(): ViewFlags {\n    return (this.constructor as typeof View).UnhideFlags;\n  }\n\n  protected willUnhide(): void {\n    this.callObservers(\"viewWillUnhide\", this);\n  }\n\n  protected onUnhide(): void {\n    this.requestUpdate(this, this.flags & View.UpdateMask, false);\n    this.requireUpdate(this.uncullFlags);\n  }\n\n  protected didUnhide(): void {\n    this.callObservers(\"viewDidUnhide\", this);\n  }\n\n  /** @internal */\n  protected unhideChildren(): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      child.cascadeUnhide();\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent unhide\");\n      }\n      child = next;\n    }\n  }\n\n  get unbounded(): boolean {\n    return (this.flags & View.UnboundedFlag) !== 0;\n  }\n\n  setUnbounded(unboundedFlag: boolean): void {\n    if (unboundedFlag !== ((this.flags & View.UnboundedFlag) !== 0)) {\n      this.willSetUnbounded(unboundedFlag);\n      if (unboundedFlag) {\n        this.setFlags(this.flags | View.UnboundedFlag);\n      } else {\n        this.setFlags(this.flags & ~View.UnboundedFlag);\n      }\n      this.onSetUnbounded(unboundedFlag);\n      this.didSetUnbounded(unboundedFlag);\n    }\n  }\n\n  protected willSetUnbounded(unboundedFlag: boolean): void {\n    // hook\n  }\n\n  protected onSetUnbounded(unboundedFlag: boolean): void {\n    // hook\n  }\n\n  protected didSetUnbounded(unboundedFlag: boolean): void {\n    // hook\n  }\n\n  get intangible(): boolean {\n    return (this.flags & View.IntangibleFlag) !== 0;\n  }\n\n  setIntangible(intangible: boolean): void {\n    if (intangible !== ((this.flags & View.IntangibleFlag) !== 0)) {\n      this.willSetIntangible(intangible);\n      if (intangible) {\n        this.setFlags(this.flags | View.IntangibleFlag);\n      } else {\n        this.setFlags(this.flags & ~View.IntangibleFlag);\n      }\n      this.onSetIntangible(intangible);\n      this.didSetIntangible(intangible);\n    }\n  }\n\n  protected willSetIntangible(intangible: boolean): void {\n    // hook\n  }\n\n  protected onSetIntangible(intangible: boolean): void {\n    // hook\n  }\n\n  protected didSetIntangible(intangible: boolean): void {\n    // hook\n  }\n\n  override requireUpdate(updateFlags: ViewFlags, immediate: boolean = false): void {\n    const flags = this.flags;\n    const deltaUpdateFlags = updateFlags & ~flags & View.UpdateMask;\n    if (deltaUpdateFlags === 0) {\n      return;\n    }\n    this.setFlags(flags | deltaUpdateFlags);\n    this.requestUpdate(this, deltaUpdateFlags, immediate);\n  }\n\n  protected needsUpdate(updateFlags: ViewFlags, immediate: boolean): ViewFlags {\n    return updateFlags;\n  }\n\n  requestUpdate(target: View, updateFlags: ViewFlags, immediate: boolean): void {\n    if ((this.flags & View.CulledMask) === View.CulledFlag) {\n      return; // culled root\n    }\n    updateFlags = this.needsUpdate(updateFlags, immediate);\n    let deltaUpdateFlags = this.flags & ~updateFlags & View.UpdateMask;\n    if ((updateFlags & View.ProcessMask) !== 0) {\n      deltaUpdateFlags |= View.NeedsProcess;\n    }\n    if ((updateFlags & View.DisplayMask) !== 0) {\n      deltaUpdateFlags |= View.NeedsDisplay;\n    }\n    if (deltaUpdateFlags === 0 && !immediate) {\n      return;\n    }\n    this.setFlags(this.flags | deltaUpdateFlags);\n    const parent = this.parent;\n    if (parent !== null) {\n      parent.requestUpdate(target, updateFlags, immediate);\n    } else if (this.mounted) {\n      const updaterService = this.updater.service;\n      if (updaterService !== null) {\n        updaterService.requestUpdate(target, updateFlags, immediate);\n      }\n    }\n  }\n\n  get updating(): boolean {\n    return (this.flags & View.UpdatingMask) !== 0;\n  }\n\n  get processing(): boolean {\n    return (this.flags & View.ProcessingFlag) !== 0;\n  }\n\n  protected needsProcess(processFlags: ViewFlags): ViewFlags {\n    return processFlags;\n  }\n\n  cascadeProcess(processFlags: ViewFlags): void {\n    try {\n      processFlags &= ~View.NeedsProcess;\n      processFlags |= this.flags & View.UpdateMask;\n      processFlags = this.needsProcess(processFlags);\n      if ((processFlags & View.ProcessMask) === 0) {\n        return;\n      }\n      let cascadeFlags = processFlags;\n      this.setFlags(this.flags & ~View.NeedsProcess | View.ProcessingFlag);\n      this.willProcess(cascadeFlags);\n      if (((this.flags | processFlags) & View.NeedsResize) !== 0) {\n        cascadeFlags |= View.NeedsResize;\n        this.setFlags(this.flags & ~View.NeedsResize);\n        this.willResize();\n      }\n      if (((this.flags | processFlags) & View.NeedsScroll) !== 0) {\n        cascadeFlags |= View.NeedsScroll;\n        this.setFlags(this.flags & ~View.NeedsScroll);\n        this.willScroll();\n      }\n      if (((this.flags | processFlags) & View.NeedsChange) !== 0) {\n        cascadeFlags |= View.NeedsChange;\n        this.setFlags(this.flags & ~View.NeedsChange);\n        this.willChange();\n      }\n      if (((this.flags | processFlags) & View.NeedsAnimate) !== 0) {\n        cascadeFlags |= View.NeedsAnimate;\n        this.setFlags(this.flags & ~View.NeedsAnimate);\n        this.willAnimate();\n      }\n      if (((this.flags | processFlags) & View.NeedsProject) !== 0) {\n        cascadeFlags |= View.NeedsProject;\n        this.setFlags(this.flags & ~View.NeedsProject);\n        this.willProject();\n      }\n\n      this.onProcess(cascadeFlags);\n      if ((cascadeFlags & View.NeedsResize) !== 0) {\n        this.onResize();\n      }\n      if ((cascadeFlags & View.NeedsScroll) !== 0) {\n        this.onScroll();\n      }\n      if ((cascadeFlags & View.NeedsChange) !== 0) {\n        this.onChange();\n      }\n      if ((cascadeFlags & View.NeedsAnimate) !== 0) {\n        this.onAnimate();\n      }\n      if ((cascadeFlags & View.NeedsProject) !== 0) {\n        this.onProject();\n      }\n\n      if ((cascadeFlags & View.ProcessMask) !== 0) {\n        this.processChildren(cascadeFlags, this.processChild);\n      }\n\n      if ((cascadeFlags & View.NeedsProject) !== 0) {\n        this.didProject();\n      }\n      if ((cascadeFlags & View.NeedsAnimate) !== 0) {\n        this.didAnimate();\n      }\n      if ((cascadeFlags & View.NeedsChange) !== 0) {\n        this.didChange();\n      }\n      if ((cascadeFlags & View.NeedsScroll) !== 0) {\n        this.didScroll();\n      }\n      if ((cascadeFlags & View.NeedsResize) !== 0) {\n        this.didResize();\n      }\n      this.didProcess(cascadeFlags);\n    } finally {\n      this.setFlags(this.flags & ~View.ProcessingFlag);\n    }\n  }\n\n  protected willProcess(processFlags: ViewFlags): void {\n    // hook\n  }\n\n  protected onProcess(processFlags: ViewFlags): void {\n    // hook\n  }\n\n  protected didProcess(processFlags: ViewFlags): void {\n    // hook\n  }\n\n  /** @internal */\n  protected willResizeObservers: Set<Required<Pick<ViewObserver, \"viewWillResize\">>> | null;\n  protected willResize(): void {\n    const observers = this.willResizeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillResize(this);\n      }\n    }\n    this.evaluateConstraintVariables();\n  }\n\n  protected onResize(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didResizeObservers: Set<Required<Pick<ViewObserver, \"viewDidResize\">>> | null;\n  protected didResize(): void {\n    const observers = this.didResizeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidResize(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willScrollObservers: Set<Required<Pick<ViewObserver, \"viewWillScroll\">>> | null;\n  protected willScroll(): void {\n    const observers = this.willScrollObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillScroll(this);\n      }\n    }\n  }\n\n  protected onScroll(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didScrollObservers: Set<Required<Pick<ViewObserver, \"viewDidScroll\">>> | null;\n  protected didScroll(): void {\n    const observers = this.didScrollObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidScroll(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willChangeObservers: Set<Required<Pick<ViewObserver, \"viewWillChange\">>> | null;\n  protected willChange(): void {\n    const observers = this.willChangeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillChange(this);\n      }\n    }\n  }\n\n  protected onChange(): void {\n    this.recohereFasteners(this.updateTime);\n  }\n\n  /** @internal */\n  protected didChangeObservers: Set<Required<Pick<ViewObserver, \"viewDidChange\">>> | null;\n  protected didChange(): void {\n    const observers = this.didChangeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidChange(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willAnimateObservers: Set<Required<Pick<ViewObserver, \"viewWillAnimate\">>> | null;\n  protected willAnimate(): void {\n    const observers = this.willAnimateObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillAnimate(this);\n      }\n    }\n  }\n\n  protected onAnimate(): void {\n    this.recohereAnimators(this.updateTime);\n  }\n\n  /** @internal */\n  protected didAnimateObservers: Set<Required<Pick<ViewObserver, \"viewDidAnimate\">>> | null;\n  protected didAnimate(): void {\n    const observers = this.didAnimateObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidAnimate(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willProjectObservers: Set<Required<Pick<ViewObserver, \"viewWillProject\">>> | null;\n  protected willProject(): void {\n    const observers = this.willProjectObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillProject(this);\n      }\n    }\n  }\n\n  protected onProject(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didProjectObservers: Set<Required<Pick<ViewObserver, \"viewDidProject\">>> | null;\n  protected didProject(): void {\n    const observers = this.didProjectObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidProject(this);\n      }\n    }\n  }\n\n  protected processChildren(processFlags: ViewFlags, processChild: (this: this, child: View, processFlags: ViewFlags) => void): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      processChild.call(this, child, processFlags);\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent process pass\");\n      }\n      child = next;\n    }\n  }\n\n  protected processChild(child: View, processFlags: ViewFlags): void {\n    child.cascadeProcess(processFlags);\n  }\n\n  get displaying(): boolean {\n    return (this.flags & View.DisplayingFlag) !== 0;\n  }\n\n  protected needsDisplay(displayFlags: ViewFlags): ViewFlags {\n    return displayFlags;\n  }\n\n  cascadeDisplay(displayFlags: ViewFlags): void {\n    try {\n      displayFlags &= ~View.NeedsDisplay;\n      displayFlags |= this.flags & View.UpdateMask;\n      displayFlags = this.needsDisplay(displayFlags);\n      if ((displayFlags & View.DisplayMask) === 0) {\n        return;\n      }\n      let cascadeFlags = displayFlags;\n      this.setFlags(this.flags & ~View.NeedsDisplay | View.DisplayingFlag);\n      this.willDisplay(cascadeFlags);\n      if (((this.flags | displayFlags) & View.NeedsLayout) !== 0) {\n        cascadeFlags |= View.NeedsLayout;\n        this.setFlags(this.flags & ~View.NeedsLayout);\n        this.willLayout();\n      }\n      if (((this.flags | displayFlags) & View.NeedsRender) !== 0) {\n        cascadeFlags |= View.NeedsRender;\n        this.setFlags(this.flags & ~View.NeedsRender);\n        this.willRender();\n      }\n      if (((this.flags | displayFlags) & View.NeedsRasterize) !== 0) {\n        cascadeFlags |= View.NeedsRasterize;\n        this.setFlags(this.flags & ~View.NeedsRasterize);\n        this.willRasterize();\n      }\n      if (((this.flags | displayFlags) & View.NeedsComposite) !== 0) {\n        cascadeFlags |= View.NeedsComposite;\n        this.setFlags(this.flags & ~View.NeedsComposite);\n        this.willComposite();\n      }\n\n      this.onDisplay(cascadeFlags);\n      if ((cascadeFlags & View.NeedsLayout) !== 0) {\n        this.onLayout();\n      }\n      if ((cascadeFlags & View.NeedsRender) !== 0) {\n        this.onRender();\n      }\n      if ((cascadeFlags & View.NeedsRasterize) !== 0) {\n        this.onRasterize();\n      }\n      if ((cascadeFlags & View.NeedsComposite) !== 0) {\n        this.onComposite();\n      }\n\n      if ((cascadeFlags & View.DisplayMask) !== 0 && !this.hidden && !this.culled) {\n        this.displayChildren(cascadeFlags, this.displayChild);\n      }\n\n      if ((cascadeFlags & View.NeedsComposite) !== 0) {\n        this.didComposite();\n      }\n      if ((cascadeFlags & View.NeedsRasterize) !== 0) {\n        this.didRasterize();\n      }\n      if ((cascadeFlags & View.NeedsRender) !== 0) {\n        this.didRender();\n      }\n      if ((cascadeFlags & View.NeedsLayout) !== 0) {\n        this.didLayout();\n      }\n      this.didDisplay(cascadeFlags);\n    } finally {\n      this.setFlags(this.flags & ~View.DisplayingFlag);\n    }\n  }\n\n  protected willDisplay(displayFlags: ViewFlags): void {\n    // hook\n  }\n\n  protected onDisplay(displayFlags: ViewFlags): void {\n    // hook\n  }\n\n  protected didDisplay(displayFlags: ViewFlags): void {\n    // hook\n  }\n\n  /** @internal */\n  protected willLayoutObservers: Set<Required<Pick<ViewObserver, \"viewWillLayout\">>> | null;\n  protected willLayout(): void {\n    const observers = this.willLayoutObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillLayout(this);\n      }\n    }\n  }\n\n  protected onLayout(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didLayoutObservers: Set<Required<Pick<ViewObserver, \"viewDidLayout\">>> | null;\n  protected didLayout(): void {\n    const observers = this.didLayoutObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidLayout(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willRenderObservers: Set<Required<Pick<ViewObserver, \"viewWillRender\">>> | null;\n  protected willRender(): void {\n    const observers = this.willRenderObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillRender(this);\n      }\n    }\n  }\n\n  protected onRender(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didRenderObservers: Set<Required<Pick<ViewObserver, \"viewDidRender\">>> | null;\n  protected didRender(): void {\n    const observers = this.didRenderObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidRender(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willRasterizeObservers: Set<Required<Pick<ViewObserver, \"viewWillRasterize\">>> | null;\n  protected willRasterize(): void {\n    const observers = this.willRasterizeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillRasterize(this);\n      }\n    }\n  }\n\n  protected onRasterize(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didRasterizeObservers: Set<Required<Pick<ViewObserver, \"viewDidRasterize\">>> | null;\n  protected didRasterize(): void {\n    const observers = this.didRasterizeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidRasterize(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected willCompositeObservers: Set<Required<Pick<ViewObserver, \"viewWillComposite\">>> | null;\n  protected willComposite(): void {\n    const observers = this.willCompositeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillComposite(this);\n      }\n    }\n  }\n\n  protected onComposite(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didCompositeObservers: Set<Required<Pick<ViewObserver, \"viewDidComposite\">>> | null;\n  protected didComposite(): void {\n    const observers = this.didCompositeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidComposite(this);\n      }\n    }\n  }\n\n  protected displayChildren(displayFlags: ViewFlags, displayChild: (this: this, child: View, displayFlags: ViewFlags) => void): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      displayChild.call(this, child, displayFlags);\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent display pass\");\n      }\n      child = next;\n    }\n  }\n\n  protected displayChild(child: View, displayFlags: ViewFlags): void {\n    child.cascadeDisplay(displayFlags);\n  }\n\n  get updateTime(): number {\n    return this.updater.getService().updateTime;\n  }\n\n  @Provider({\n    get serviceType(): typeof ViewportService { // avoid static forward reference\n      return ViewportService;\n    },\n  })\n  get viewport(): Provider<this, ViewportService> {\n    return Provider.getter();\n  }\n\n  @Provider({\n    get serviceType(): typeof DisplayerService { // avoid static forward reference\n      return DisplayerService;\n    },\n    mountRootService(service: DisplayerService): void {\n      super.mountRootService(service);\n      service.roots.addView(this.owner);\n    },\n    unmountRootService(service: DisplayerService): void {\n      super.unmountRootService(service);\n      service.roots.removeView(this.owner);\n    },\n  })\n  readonly updater!: Provider<this, DisplayerService>;\n\n  @Provider({\n    get serviceType(): typeof SolverService { // avoid static forward reference\n      return SolverService;\n    },\n  })\n  get solver(): Provider<this, SolverService> {\n    return Provider.getter();\n  }\n\n  @Provider({\n    get serviceType(): typeof StylerService { // avoid static forward reference\n      return StylerService;\n    },\n    mountRootService(service: StylerService): void {\n      super.mountRootService(service);\n      service.roots.addView(this.owner);\n    },\n    unmountRootService(service: StylerService): void {\n      super.unmountRootService(service);\n      service.roots.removeView(this.owner);\n    },\n  })\n  readonly styler!: Provider<this, StylerService>;\n\n  @Property({\n    valueType: MoodVector,\n    value: null,\n    affinity: Affinity.Inherited,\n    inherits: true,\n    init(): void {\n      this.timing = void 0;\n    },\n    deriveValue(superMood: MoodVector | null): MoodVector | null {\n      if (superMood !== null) {\n        const moodModifierProperty = this.owner.moodModifier;\n        const moodModifier = moodModifierProperty instanceof Property ? moodModifierProperty.value : null;\n        if (moodModifier !== null) {\n          superMood = moodModifier.timesCol(superMood, true);\n        }\n      }\n      return superMood;\n    },\n    didSetValue(mood: MoodVector | null): void {\n      const theme = this.owner.theme.value;\n      if (theme !== null && mood !== null) {\n        this.owner.applyTheme(theme, mood, this.timing);\n        this.timing = void 0;\n      }\n    },\n  })\n  readonly mood!: Property<this, MoodVector | null> & {\n    /** @internal */\n    timing: TimingLike | boolean | undefined,\n  };\n\n  @Property({\n    valueType: ThemeMatrix,\n    value: null,\n    affinity: Affinity.Inherited,\n    inherits: true,\n    init(): void {\n      this.timing = void 0;\n    },\n    deriveValue(superTheme: ThemeMatrix | null): ThemeMatrix | null {\n      if (superTheme !== null) {\n        const themeModifierProperty = this.owner.themeModifier;\n        const themeModifier = themeModifierProperty instanceof Property ? themeModifierProperty.value : null;\n        if (themeModifier !== null) {\n          superTheme = superTheme.transform(themeModifier, true);\n        }\n      }\n      return superTheme;\n    },\n    didSetValue(theme: ThemeMatrix | null): void {\n      const mood = this.owner.mood.value;\n      if (theme !== null && mood !== null) {\n        this.owner.applyTheme(theme, mood, this.timing);\n        this.timing = void 0;\n      }\n    },\n  })\n  readonly theme!: Property<this, ThemeMatrix | null> & {\n    /** @internal */\n    timing: TimingLike | boolean | undefined,\n  };\n\n  /** @override */\n  getLook<T>(look: Look<T>, mood?: MoodVector<Feel> | null): T | undefined {\n    const theme = this.theme.value;\n    let value: T | undefined;\n    if (theme !== null) {\n      if (mood === void 0 || mood === null) {\n        mood = this.mood.value;\n      }\n      if (mood !== null) {\n        value = theme.get(look, mood);\n      }\n    }\n    return value;\n  }\n\n  /** @override */\n  getLookOr<T, E>(look: Look<T>, elseValue: E): T | E;\n  /** @override */\n  getLookOr<T, E>(look: Look<T>, mood: MoodVector<Feel> | null, elseValue: E): T | E;\n  getLookOr<T, E>(look: Look<T>, mood: MoodVector<Feel> | null | E, elseValue?: E): T | E {\n    if (arguments.length === 2) {\n      elseValue = mood as E;\n      mood = null;\n    }\n    const theme = this.theme.value;\n    let value: T | E;\n    if (theme !== null) {\n      if (mood === void 0 || mood === null) {\n        mood = this.mood.value;\n      }\n      if (mood !== null) {\n        value = theme.getOr(look, mood as MoodVector<Feel>, elseValue as E);\n      } else {\n        value = elseValue as E;\n      }\n    } else {\n      value = elseValue as E;\n    }\n    return value;\n  }\n\n  /** @internal */\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing?: TimingLike | boolean): void {\n    if (timing === void 0 && this.inserting) {\n      timing = false;\n    } else if (timing === void 0 || timing === true) {\n      timing = theme.getOr(Look.timing, Mood.ambient, false);\n    } else {\n      timing = Timing.fromLike(timing);\n    }\n    this.willApplyTheme(theme, mood, timing);\n    this.onApplyTheme(theme, mood, timing);\n    this.didApplyTheme(theme, mood, timing);\n  }\n\n  protected willApplyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    this.callObservers(\"viewWillApplyTheme\", theme, mood, timing, this);\n  }\n\n  protected onApplyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    this.themeFsteners(theme, mood, timing);\n  }\n\n  protected didApplyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    this.callObservers(\"viewDidApplyTheme\", theme, mood, timing, this);\n  }\n\n  /** @internal */\n  protected themeFsteners(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!] as Fastener<any, any, any> | undefined;\n      if (fastener !== void 0 && \"applyTheme\" in (fastener as any)) {\n        (fastener as any).applyTheme(theme, mood, timing);\n      }\n    }\n  }\n\n  @Property({\n    valueType: MoodMatrix,\n    value: null,\n    didSetValue(moodModifier: MoodMatrix | null): void {\n      if (moodModifier === null || !this.owner.mood.hasAffinity(Affinity.Inherited)) {\n        return;\n      }\n      let superMood = this.owner.mood.inletValue;\n      if (superMood === void 0 || superMood === null) {\n        const stylerService = this.owner.styler.service;\n        if (stylerService !== void 0 && stylerService !== null) {\n          superMood = stylerService.mood.value;\n        }\n      }\n      if (superMood !== void 0 && superMood !== null) {\n        const mood = moodModifier.timesCol(superMood, true);\n        this.owner.mood.setValue(mood, Affinity.Reflexive);\n      }\n    },\n  })\n  readonly moodModifier!: Property<this, MoodMatrix | null>;\n\n  modifyMood(feel: Feel, updates: MoodVectorUpdates<Feel>, timing?: TimingLike | boolean): void {\n    if (!this.moodModifier.hasAffinity(Affinity.Intrinsic)) {\n      return;\n    }\n    const oldMoodModifier = this.moodModifier.getValueOr(MoodMatrix.empty());\n    const newMoodModifier = oldMoodModifier.updatedCol(feel, updates, true);\n    if (newMoodModifier.equals(oldMoodModifier)) {\n      return;\n    }\n    this.mood.timing = timing;\n    this.moodModifier.setIntrinsic(newMoodModifier);\n  }\n\n  @Property({\n    valueType: MoodMatrix,\n    value: null,\n    didSetValue(themeModifier: MoodMatrix | null): void {\n      if (themeModifier === null || !this.owner.theme.hasAffinity(Affinity.Inherited)) {\n        return;\n      }\n      let superTheme = this.owner.theme.inletValue;\n      if (superTheme === void 0 || superTheme === null) {\n        const stylerService = this.owner.styler.service;\n        if (stylerService !== void 0 && stylerService !== null) {\n          superTheme = stylerService.theme.value;\n        }\n      }\n      if (superTheme !== void 0 && superTheme !== null) {\n        const theme = superTheme.transform(themeModifier, true);\n        this.owner.theme.setValue(theme, Affinity.Reflexive);\n      }\n    },\n  })\n  readonly themeModifier!: Property<this, MoodMatrix | null>;\n\n  modifyTheme(feel: Feel, updates: MoodVectorUpdates<Feel>, timing?: TimingLike | boolean): void;\n  modifyTheme(cols: [feel: Feel, updates: MoodVectorUpdates<Feel> | undefined][], timing?: TimingLike | boolean): void;\n  modifyTheme(feel: Feel | [feel: Feel, updates: MoodVectorUpdates<Feel> | undefined][], updates?: MoodVectorUpdates<Feel> | TimingLike | boolean, timing?: TimingLike | boolean): void {\n    if (!this.themeModifier.hasAffinity(Affinity.Intrinsic)) {\n      return;\n    }\n    const oldThemeModifier = this.themeModifier.getValueOr(MoodMatrix.empty());\n    let newThemeModifier: MoodMatrix;\n    if (feel instanceof Feel) {\n      newThemeModifier = oldThemeModifier.updatedCol(feel, updates as MoodVectorUpdates<Feel>, true);\n    } else {\n      newThemeModifier = oldThemeModifier;\n      const cols = feel as [feel: Feel, updates: MoodVectorUpdates<Feel> | undefined][];\n      timing = updates as TimingLike | boolean;\n      updates = void 0;\n      for (let i = 0; i < cols.length; i += 1) {\n        [feel, updates] = cols[i]!;\n        if (updates !== void 0) {\n          newThemeModifier = newThemeModifier.updatedCol(feel, updates, true);\n        } else {\n          newThemeModifier = newThemeModifier.col(feel, void 0);\n        }\n      }\n    }\n    if (!newThemeModifier.equals(oldThemeModifier)) {\n      this.theme.timing = timing;\n      this.themeModifier.setIntrinsic(newThemeModifier);\n    }\n  }\n\n  /** @override */\n  getTransition(fastener: Fastener<any, any, any>): Timing | null {\n    return this.getLookOr(Look.timing, null);\n  }\n\n  /** @internal */\n  protected override bindChildFastener(fastener: Fastener, child: View, target: View | null): void {\n    super.bindChildFastener(fastener, child, target);\n    if (fastener instanceof ViewRelation || fastener instanceof Gesture) {\n      fastener.bindView(child, target);\n    }\n  }\n\n  /** @internal */\n  protected override unbindChildFastener(fastener: Fastener, child: View): void {\n    if (fastener instanceof ViewRelation || fastener instanceof Gesture) {\n      fastener.unbindView(child);\n    }\n    super.unbindChildFastener(fastener, child);\n  }\n\n  /** @internal */\n  protected override enqueueFastener(fastener: Fastener): void {\n    super.enqueueFastener(fastener);\n    if (fastener instanceof Animator) {\n      this.requireUpdate(View.NeedsAnimate);\n    } else {\n      this.requireUpdate(View.NeedsChange);\n    }\n  }\n\n  /** @internal */\n  override recohereFasteners(t?: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent === null || decoherent.length === 0) {\n      return;\n    } else if (t === void 0) {\n      t = performance.now();\n    }\n    (this as Mutable<this>).coherentTime = t;\n    (this as Mutable<this>).decoherent = null;\n    (this as Mutable<this>).recohering = decoherent;\n    try {\n      for (let i = 0; i < decoherent.length; i += 1) {\n        const fastener = decoherent[i]!;\n        if (!(fastener instanceof Animator)) {\n          fastener.recohere(t);\n        } else {\n          this.enqueueFastener(fastener);\n        }\n      }\n    } finally {\n      (this as Mutable<this>).recohering = null;\n    }\n  }\n\n  /** @internal */\n  recohereAnimators(t: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent === null || decoherent.length === 0) {\n      return;\n    }\n    // The passed-in update time parameter is used to ensure that all animators\n    // update as if evaluated instantaneously. Jitter can occur if an update\n    // pass takes longer than an animation frame. This is especially noticeable\n    // when beginning new animations, such as when animating the insertion of\n    // new views. Since animators base their timing functions on the time of\n    // the first transition frame, update lag can truncate the important first\n    // frames of an animation. To counter this effect, we use the current time\n    // if more than 1/30 of a second has elapsed since the start of the update pass.\n    const now = performance.now();\n    if (now - t >= DisplayerService.MaxProcessInterval) {\n      t = now;\n    }\n    (this as Mutable<this>).coherentTime = t;\n    (this as Mutable<this>).decoherent = null;\n    (this as Mutable<this>).recohering = decoherent;\n    try {\n      for (let i = 0; i < decoherent.length; i += 1) {\n        const fastener = decoherent[i]!;\n        if (fastener instanceof Animator) {\n          fastener.recohere(t);\n        } else {\n          this.enqueueFastener(fastener);\n        }\n      }\n    } finally {\n      (this as Mutable<this>).recohering = null;\n    }\n  }\n\n  /** @override */\n  constraint(lhs: ConstraintExpressionLike, relation: ConstraintRelation,\n             rhs?: ConstraintExpressionLike, strength?: ConstraintStrengthLike): Constraint {\n    lhs = ConstraintExpression.fromLike(lhs);\n    rhs = ConstraintExpression.fromLike(rhs);\n    const expression = rhs !== void 0 ? lhs.minus(rhs) : lhs;\n    if (strength === void 0) {\n      strength = ConstraintStrength.Required;\n    } else {\n      strength = ConstraintStrength.fromLike(strength);\n    }\n    const constraint = new Constraint(this, expression, relation, strength);\n    this.addConstraint(constraint);\n    return constraint;\n  }\n\n  /** @internal */\n  readonly constraints: ReadonlySet<Constraint> | null;\n\n  /** @override */\n  hasConstraint(constraint: Constraint): boolean {\n    const constraints = this.constraints;\n    return constraints !== null && constraints.has(constraint);\n  }\n\n  /** @override */\n  addConstraint(constraint: Constraint): void {\n    let constraints = this.constraints as Set<Constraint> | null;\n    if (constraints === null) {\n      constraints = new Set<Constraint>();\n      (this as Mutable<this>).constraints = constraints;\n    } else if (constraints.has(constraint)) {\n      return;\n    }\n    constraints.add(constraint);\n    this.activateConstraint(constraint);\n  }\n\n  /** @override */\n  removeConstraint(constraint: Constraint): void {\n    const constraints = this.constraints as Set<Constraint> | null;\n    if (constraints === null || !constraints.has(constraint)) {\n      return;\n    }\n    this.deactivateConstraint(constraint);\n    constraints.delete(constraint);\n  }\n\n  /** @internal @override */\n  activateConstraint(constraint: Constraint): void {\n    const solverService = this.solver.service;\n    if (solverService === null) {\n      return;\n    }\n    solverService.activateConstraint(constraint);\n    this.requireUpdate(View.NeedsLayout);\n  }\n\n  /** @internal @override */\n  deactivateConstraint(constraint: Constraint): void {\n    const solverService = this.solver.service;\n    if (solverService === null) {\n      return;\n    }\n    solverService.deactivateConstraint(constraint);\n    this.requireUpdate(View.NeedsLayout);\n  }\n\n  /** @override */\n  constraintVariable(name: string, value?: number, strength?: ConstraintStrengthLike): ConstraintProperty<unknown, number> {\n    if (value === void 0) {\n      value = 0;\n    }\n    if (strength !== void 0) {\n      strength = ConstraintStrength.fromLike(strength);\n    } else {\n      strength = ConstraintStrength.Strong;\n    }\n    const property = ConstraintProperty.create(this) as ConstraintProperty<unknown, number>;\n    Object.defineProperty(property, \"name\", {\n      value: name,\n      configurable: true,\n    });\n    if (value !== void 0) {\n      property.set(value);\n    }\n    property.setStrength(strength);\n    property.mount();\n    return property;\n  }\n\n  /** @internal */\n  readonly constraintVariables: ReadonlySet<ConstraintVariable> | null;\n\n  /** @override */\n  hasConstraintVariable(constraintVariable: ConstraintVariable): boolean {\n    const constraintVariables = this.constraintVariables;\n    return constraintVariables !== null && constraintVariables.has(constraintVariable);\n  }\n\n  /** @override */\n  addConstraintVariable(constraintVariable: ConstraintVariable): void {\n    let constraintVariables = this.constraintVariables as Set<ConstraintVariable> | null;\n    if (constraintVariables === null) {\n      constraintVariables = new Set<ConstraintVariable>();\n      (this as Mutable<this>).constraintVariables = constraintVariables;\n    } else if (constraintVariables.has(constraintVariable)) {\n      return;\n    }\n    constraintVariables.add(constraintVariable);\n    this.activateConstraintVariable(constraintVariable);\n  }\n\n  /** @override */\n  removeConstraintVariable(constraintVariable: ConstraintVariable): void {\n    const constraintVariables = this.constraintVariables as Set<ConstraintVariable> | null;\n    if (constraintVariables === null || !constraintVariables.has(constraintVariable)) {\n      return;\n    }\n    this.deactivateConstraintVariable(constraintVariable);\n    constraintVariables.delete(constraintVariable);\n  }\n\n  /** @internal @override */\n  activateConstraintVariable(constraintVariable: ConstraintVariable): void {\n    const solverService = this.solver.service;\n    if (solverService === null) {\n      return;\n    }\n    solverService.activateConstraintVariable(constraintVariable);\n    this.requireUpdate(View.NeedsLayout);\n  }\n\n  /** @internal @override */\n  deactivateConstraintVariable(constraintVariable: ConstraintVariable): void {\n    const solverService = this.solver.service;\n    if (solverService === null) {\n      return;\n    }\n    solverService.deactivateConstraintVariable(constraintVariable);\n    this.requireUpdate(View.NeedsLayout);\n  }\n\n  /** @internal @override */\n  setConstraintVariable(constraintVariable: ConstraintVariable, value: number): void {\n    const solverService = Provider.tryService(this, \"solver\");\n    if (solverService === null) {\n      return;\n    }\n    solverService.setConstraintVariable(constraintVariable, value);\n  }\n\n  /** @internal */\n  evaluateConstraintVariables(): void {\n    const constraintVariables = this.constraintVariables;\n    if (constraintVariables === null) {\n      return;\n    }\n    for (const constraintVariable of constraintVariables) {\n      constraintVariable.evaluateConstraintVariable();\n    }\n  }\n\n  /** @internal */\n  protected activateLayout(): void {\n    const constraints = this.constraints;\n    if (constraints === null) {\n      return;\n    }\n    const solverService = this.solver.service;\n    if (solverService === null || constraints === null) {\n      return;\n    }\n    for (const constraint of constraints) {\n      solverService.activateConstraint(constraint);\n    }\n  }\n\n  /** @internal */\n  protected deactivateLayout(): void {\n    const constraints = this.constraints;\n    if (constraints === null) {\n      return;\n    }\n    const solverService = this.solver.service;\n    if (solverService === null) {\n      return;\n    }\n    for (const constraint of constraints) {\n      solverService.deactivateConstraint(constraint);\n    }\n  }\n\n  get layoutViewport(): LayoutViewport {\n    return this.viewport.getService().layoutViewport.value;\n  }\n\n  get visualViewport(): VisualViewport {\n    return this.viewport.getService().visualViewport.value;\n  }\n\n  get viewIdiom(): ViewIdiom {\n    return this.viewport.getService().viewIdiom.value;\n  }\n\n  @Property({\n    valueType: ViewInsets,\n    value: ViewInsets.zero(),\n    inherits: true,\n    get updateFlags(): ViewFlags {\n      return View.NeedsResize | View.NeedsScroll | View.NeedsLayout;\n    },\n    equalValues: ViewInsets.equal,\n  })\n  get edgeInsets(): Property<this, ViewInsets> {\n    return Property.getter();\n  }\n\n  /**\n   * Returns the transformation from the parent view coordinates to view\n   * coordinates.\n   */\n  get parentTransform(): Transform {\n    return Transform.identity();\n  }\n\n  /**\n   * Returns the transformation from page coordinates to view coordinates.\n   */\n  get pageTransform(): Transform {\n    const parent = this.parent;\n    if (parent !== null) {\n      return parent.pageTransform.transform(this.parentTransform);\n    } else {\n      return Transform.identity();\n    }\n  }\n\n  get pageBounds(): R2Box {\n    const clientBounds = this.clientBounds;\n    const clientTransform = this.clientTransform;\n    return clientBounds.transform(clientTransform);\n  }\n\n  /**\n   * Returns the bounding box, in page coordinates, the edges to which attached\n   * popovers should point.\n   */\n  get popoverFrame(): R2Box {\n    return this.pageBounds;\n  }\n\n  /**\n   * Returns the transformation from viewport coordinates to view coordinates.\n   */\n  get clientTransform(): Transform {\n    let clientTransform: Transform;\n    const scrollX = window.pageXOffset;\n    const scrollY = window.pageYOffset;\n    if (scrollX !== 0 || scrollY !== 0) {\n      clientTransform = Transform.translate(scrollX, scrollY);\n    } else {\n      clientTransform = Transform.identity();\n    }\n    const pageTransform = this.pageTransform;\n    return clientTransform.transform(pageTransform);\n  }\n\n  get clientBounds(): R2Box {\n    return R2Box.undefined();\n  }\n\n  intersectsViewport(): boolean {\n    const bounds = this.clientBounds;\n    const viewportWidth = document.documentElement.clientWidth;\n    const viewportHeight = document.documentElement.clientHeight;\n    return (bounds.top <= 0 && 0 < bounds.bottom || 0 <= bounds.top && bounds.top < viewportHeight)\n        && (bounds.left <= 0 && 0 < bounds.right || 0 <= bounds.left && bounds.left < viewportWidth);\n  }\n\n  dispatchEvent(event: Event): boolean {\n    return true; // nop\n  }\n\n  addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void {\n    // nop\n  }\n\n  removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void {\n    // nop\n  }\n\n  protected override onObserve(observer: Observes<this>): void {\n    super.onObserve(observer);\n    if (observer.viewWillAttachParent !== void 0) {\n      if (this.willAttachParentObservers === null) {\n        this.willAttachParentObservers = new Set();\n      }\n      this.willAttachParentObservers.add(observer as Required<Pick<ViewObserver, \"viewWillAttachParent\">>);\n    }\n    if (observer.viewDidAttachParent !== void 0) {\n      if (this.didAttachParentObservers === null) {\n        this.didAttachParentObservers = new Set();\n      }\n      this.didAttachParentObservers.add(observer as Required<Pick<ViewObserver, \"viewDidAttachParent\">>);\n    }\n    if (observer.viewWillDetachParent !== void 0) {\n      if (this.willDetachParentObservers === null) {\n        this.willDetachParentObservers = new Set();\n      }\n      this.willDetachParentObservers.add(observer as Required<Pick<ViewObserver, \"viewWillDetachParent\">>);\n    }\n    if (observer.viewDidDetachParent !== void 0) {\n      if (this.didDetachParentObservers === null) {\n        this.didDetachParentObservers = new Set();\n      }\n      this.didDetachParentObservers.add(observer as Required<Pick<ViewObserver, \"viewDidDetachParent\">>);\n    }\n    if (observer.viewWillInsertChild !== void 0) {\n      if (this.willInsertChildObservers === null) {\n        this.willInsertChildObservers = new Set();\n      }\n      this.willInsertChildObservers.add(observer as Required<Pick<ViewObserver, \"viewWillInsertChild\">>);\n    }\n    if (observer.viewDidInsertChild !== void 0) {\n      if (this.didInsertChildObservers === null) {\n        this.didInsertChildObservers = new Set();\n      }\n      this.didInsertChildObservers.add(observer as Required<Pick<ViewObserver, \"viewDidInsertChild\">>);\n    }\n    if (observer.viewWillRemoveChild !== void 0) {\n      if (this.willRemoveChildObservers === null) {\n        this.willRemoveChildObservers = new Set();\n      }\n      this.willRemoveChildObservers.add(observer as Required<Pick<ViewObserver, \"viewWillRemoveChild\">>);\n    }\n    if (observer.viewDidRemoveChild !== void 0) {\n      if (this.didRemoveChildObservers === null) {\n        this.didRemoveChildObservers = new Set();\n      }\n      this.didRemoveChildObservers.add(observer as Required<Pick<ViewObserver, \"viewDidRemoveChild\">>);\n    }\n    if (observer.viewWillMount !== void 0) {\n      if (this.willMountObservers === null) {\n        this.willMountObservers = new Set();\n      }\n      this.willMountObservers.add(observer as Required<Pick<ViewObserver, \"viewWillMount\">>);\n    }\n    if (observer.viewDidMount !== void 0) {\n      if (this.didMountObservers === null) {\n        this.didMountObservers = new Set();\n      }\n      this.didMountObservers.add(observer as Required<Pick<ViewObserver, \"viewDidMount\">>);\n    }\n    if (observer.viewWillUnmount !== void 0) {\n      if (this.willUnmountObservers === null) {\n        this.willUnmountObservers = new Set();\n      }\n      this.willUnmountObservers.add(observer as Required<Pick<ViewObserver, \"viewWillUnmount\">>);\n    }\n    if (observer.viewDidUnmount !== void 0) {\n      if (this.didUnmountObservers === null) {\n        this.didUnmountObservers = new Set();\n      }\n      this.didUnmountObservers.add(observer as Required<Pick<ViewObserver, \"viewDidUnmount\">>);\n    }\n    if (observer.viewWillResize !== void 0) {\n      if (this.willResizeObservers === null) {\n        this.willResizeObservers = new Set();\n      }\n      this.willResizeObservers.add(observer as Required<Pick<ViewObserver, \"viewWillResize\">>);\n    }\n    if (observer.viewDidResize !== void 0) {\n      if (this.didResizeObservers === null) {\n        this.didResizeObservers = new Set();\n      }\n      this.didResizeObservers.add(observer as Required<Pick<ViewObserver, \"viewDidResize\">>);\n    }\n    if (observer.viewWillScroll !== void 0) {\n      if (this.willScrollObservers === null) {\n        this.willScrollObservers = new Set();\n      }\n      this.willScrollObservers.add(observer as Required<Pick<ViewObserver, \"viewWillScroll\">>);\n    }\n    if (observer.viewDidScroll !== void 0) {\n      if (this.didScrollObservers === null) {\n        this.didScrollObservers = new Set();\n      }\n      this.didScrollObservers.add(observer as Required<Pick<ViewObserver, \"viewDidScroll\">>);\n    }\n    if (observer.viewWillChange !== void 0) {\n      if (this.willChangeObservers === null) {\n        this.willChangeObservers = new Set();\n      }\n      this.willChangeObservers.add(observer as Required<Pick<ViewObserver, \"viewWillChange\">>);\n    }\n    if (observer.viewDidChange !== void 0) {\n      if (this.didChangeObservers === null) {\n        this.didChangeObservers = new Set();\n      }\n      this.didChangeObservers.add(observer as Required<Pick<ViewObserver, \"viewDidChange\">>);\n    }\n    if (observer.viewWillAnimate !== void 0) {\n      if (this.willAnimateObservers === null) {\n        this.willAnimateObservers = new Set();\n      }\n      this.willAnimateObservers.add(observer as Required<Pick<ViewObserver, \"viewWillAnimate\">>);\n    }\n    if (observer.viewDidAnimate !== void 0) {\n      if (this.didAnimateObservers === null) {\n        this.didAnimateObservers = new Set();\n      }\n      this.didAnimateObservers.add(observer as Required<Pick<ViewObserver, \"viewDidAnimate\">>);\n    }\n    if (observer.viewWillProject !== void 0) {\n      if (this.willProjectObservers === null) {\n        this.willProjectObservers = new Set();\n      }\n      this.willProjectObservers.add(observer as Required<Pick<ViewObserver, \"viewWillProject\">>);\n    }\n    if (observer.viewDidProject !== void 0) {\n      if (this.didProjectObservers === null) {\n        this.didProjectObservers = new Set();\n      }\n      this.didProjectObservers.add(observer as Required<Pick<ViewObserver, \"viewDidProject\">>);\n    }\n    if (observer.viewWillLayout !== void 0) {\n      if (this.willLayoutObservers === null) {\n        this.willLayoutObservers = new Set();\n      }\n      this.willLayoutObservers.add(observer as Required<Pick<ViewObserver, \"viewWillLayout\">>);\n    }\n    if (observer.viewDidLayout !== void 0) {\n      if (this.didLayoutObservers === null) {\n        this.didLayoutObservers = new Set();\n      }\n      this.didLayoutObservers.add(observer as Required<Pick<ViewObserver, \"viewDidLayout\">>);\n    }\n    if (observer.viewWillRender !== void 0) {\n      if (this.willRenderObservers === null) {\n        this.willRenderObservers = new Set();\n      }\n      this.willRenderObservers.add(observer as Required<Pick<ViewObserver, \"viewWillRender\">>);\n    }\n    if (observer.viewDidRender !== void 0) {\n      if (this.didRenderObservers === null) {\n        this.didRenderObservers = new Set();\n      }\n      this.didRenderObservers.add(observer as Required<Pick<ViewObserver, \"viewDidRender\">>);\n    }\n    if (observer.viewWillRasterize !== void 0) {\n      if (this.willRasterizeObservers === null) {\n        this.willRasterizeObservers = new Set();\n      }\n      this.willRasterizeObservers.add(observer as Required<Pick<ViewObserver, \"viewWillRasterize\">>);\n    }\n    if (observer.viewDidRasterize !== void 0) {\n      if (this.didRasterizeObservers === null) {\n        this.didRasterizeObservers = new Set();\n      }\n      this.didRasterizeObservers.add(observer as Required<Pick<ViewObserver, \"viewDidRasterize\">>);\n    }\n    if (observer.viewWillComposite !== void 0) {\n      if (this.willCompositeObservers === null) {\n        this.willCompositeObservers = new Set();\n      }\n      this.willCompositeObservers.add(observer as Required<Pick<ViewObserver, \"viewWillComposite\">>);\n    }\n    if (observer.viewDidComposite !== void 0) {\n      if (this.didCompositeObservers === null) {\n        this.didCompositeObservers = new Set();\n      }\n      this.didCompositeObservers.add(observer as Required<Pick<ViewObserver, \"viewDidComposite\">>);\n    }\n  }\n\n  protected override onUnobserve(observer: Observes<this>): void {\n    super.onUnobserve(observer);\n    if (observer.viewWillAttachParent !== void 0 && this.willAttachParentObservers !== null) {\n      this.willAttachParentObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillAttachParent\">>);\n    }\n    if (observer.viewDidAttachParent !== void 0 && this.didAttachParentObservers !== null) {\n      this.didAttachParentObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidAttachParent\">>);\n    }\n    if (observer.viewWillDetachParent !== void 0 && this.willDetachParentObservers !== null) {\n      this.willDetachParentObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillDetachParent\">>);\n    }\n    if (observer.viewDidDetachParent !== void 0 && this.didDetachParentObservers !== null) {\n      this.didDetachParentObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidDetachParent\">>);\n    }\n    if (observer.viewWillInsertChild !== void 0 && this.willInsertChildObservers !== null) {\n      this.willInsertChildObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillInsertChild\">>);\n    }\n    if (observer.viewDidInsertChild !== void 0 && this.didInsertChildObservers !== null) {\n      this.didInsertChildObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidInsertChild\">>);\n    }\n    if (observer.viewWillRemoveChild !== void 0 && this.willRemoveChildObservers !== null) {\n      this.willRemoveChildObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillRemoveChild\">>);\n    }\n    if (observer.viewDidRemoveChild !== void 0 && this.didRemoveChildObservers !== null) {\n      this.didRemoveChildObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidRemoveChild\">>);\n    }\n    if (observer.viewWillMount !== void 0 && this.willMountObservers !== null) {\n      this.willMountObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillMount\">>);\n    }\n    if (observer.viewDidMount !== void 0 && this.didMountObservers !== null) {\n      this.didMountObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidMount\">>);\n    }\n    if (observer.viewWillUnmount !== void 0 && this.willUnmountObservers !== null) {\n      this.willUnmountObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillUnmount\">>);\n    }\n    if (observer.viewDidUnmount !== void 0 && this.didUnmountObservers !== null) {\n      this.didUnmountObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidUnmount\">>);\n    }\n    if (observer.viewWillResize !== void 0 && this.willResizeObservers !== null) {\n      this.willResizeObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillResize\">>);\n    }\n    if (observer.viewDidResize !== void 0 && this.didResizeObservers !== null) {\n      this.didResizeObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidResize\">>);\n    }\n    if (observer.viewWillScroll !== void 0 && this.willScrollObservers !== null) {\n      this.willScrollObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillScroll\">>);\n    }\n    if (observer.viewDidScroll !== void 0 && this.didScrollObservers !== null) {\n      this.didScrollObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidScroll\">>);\n    }\n    if (observer.viewWillChange !== void 0 && this.willChangeObservers !== null) {\n      this.willChangeObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillChange\">>);\n    }\n    if (observer.viewDidChange !== void 0 && this.didChangeObservers !== null) {\n      this.didChangeObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidChange\">>);\n    }\n    if (observer.viewWillAnimate !== void 0 && this.willAnimateObservers !== null) {\n      this.willAnimateObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillAnimate\">>);\n    }\n    if (observer.viewDidAnimate !== void 0 && this.didAnimateObservers !== null) {\n      this.didAnimateObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidAnimate\">>);\n    }\n    if (observer.viewWillProject !== void 0 && this.willProjectObservers !== null) {\n      this.willProjectObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillProject\">>);\n    }\n    if (observer.viewDidProject !== void 0 && this.didProjectObservers !== null) {\n      this.didProjectObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidProject\">>);\n    }\n    if (observer.viewWillLayout !== void 0 && this.willLayoutObservers !== null) {\n      this.willLayoutObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillLayout\">>);\n    }\n    if (observer.viewDidLayout !== void 0 && this.didLayoutObservers !== null) {\n      this.didLayoutObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidLayout\">>);\n    }\n    if (observer.viewWillRender !== void 0 && this.willRenderObservers !== null) {\n      this.willRenderObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillRender\">>);\n    }\n    if (observer.viewDidRender !== void 0 && this.didRenderObservers !== null) {\n      this.didRenderObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidRender\">>);\n    }\n    if (observer.viewWillRasterize !== void 0 && this.willRasterizeObservers !== null) {\n      this.willRasterizeObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillRasterize\">>);\n    }\n    if (observer.viewDidRasterize !== void 0 && this.didRasterizeObservers !== null) {\n      this.didRasterizeObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidRasterize\">>);\n    }\n    if (observer.viewWillComposite !== void 0 && this.willCompositeObservers !== null) {\n      this.willCompositeObservers.delete(observer as Required<Pick<ViewObserver, \"viewWillComposite\">>);\n    }\n    if (observer.viewDidComposite !== void 0 && this.didCompositeObservers !== null) {\n      this.didCompositeObservers.delete(observer as Required<Pick<ViewObserver, \"viewDidComposite\">>);\n    }\n  }\n\n  /** @internal */\n  static override uid: () => string = (function () {\n    let nextId = 1;\n    return function uid(): string {\n      const id = ~~nextId;\n      nextId += 1;\n      return \"view\" + id;\n    };\n  })();\n\n  /** @internal */\n  static override readonly MountedFlag: ViewFlags = Component.MountedFlag;\n  /** @internal */\n  static override readonly InsertingFlag: ViewFlags = Component.InsertingFlag;\n  /** @internal */\n  static override readonly RemovingFlag: ViewFlags = Component.RemovingFlag;\n  /** @internal */\n  static readonly ProcessingFlag: ViewFlags = 1 << (Component.FlagShift + 0);\n  /** @internal */\n  static readonly DisplayingFlag: ViewFlags = 1 << (Component.FlagShift + 1);\n  /** @internal */\n  static readonly CullFlag: ViewFlags = 1 << (Component.FlagShift + 2);\n  /** @internal */\n  static readonly CulledFlag: ViewFlags = 1 << (Component.FlagShift + 3);\n  /** @internal */\n  static readonly HideFlag: ViewFlags = 1 << (Component.FlagShift + 4);\n  /** @internal */\n  static readonly HiddenFlag: ViewFlags = 1 << (Component.FlagShift + 5);\n  /** @internal */\n  static readonly UnboundedFlag: ViewFlags = 1 << (Component.FlagShift + 6);\n  /** @internal */\n  static readonly IntangibleFlag: ViewFlags = 1 << (Component.FlagShift + 7);\n  /** @internal */\n  static readonly CulledMask: ViewFlags = this.CullFlag\n                                        | this.CulledFlag;\n  /** @internal */\n  static readonly HiddenMask: ViewFlags = this.HideFlag\n                                        | this.HiddenFlag;\n  /** @internal */\n  static readonly UpdatingMask: ViewFlags = this.ProcessingFlag\n                                          | this.DisplayingFlag;\n  /** @internal */\n  static readonly StatusMask: ViewFlags = this.MountedFlag\n                                        | this.InsertingFlag\n                                        | this.RemovingFlag\n                                        | this.ProcessingFlag\n                                        | this.DisplayingFlag\n                                        | this.CullFlag\n                                        | this.CulledFlag\n                                        | this.HiddenFlag\n                                        | this.UnboundedFlag\n                                        | this.IntangibleFlag;\n\n  static readonly NeedsProcess: ViewFlags = 1 << (Component.FlagShift + 8);\n  static readonly NeedsResize: ViewFlags = 1 << (Component.FlagShift + 9);\n  static readonly NeedsScroll: ViewFlags = 1 << (Component.FlagShift + 10);\n  static readonly NeedsChange: ViewFlags = 1 << (Component.FlagShift + 11);\n  static readonly NeedsAnimate: ViewFlags = 1 << (Component.FlagShift + 12);\n  static readonly NeedsProject: ViewFlags = 1 << (Component.FlagShift + 13);\n  /** @internal */\n  static readonly ProcessMask: ViewFlags = this.NeedsProcess\n                                         | this.NeedsResize\n                                         | this.NeedsScroll\n                                         | this.NeedsChange\n                                         | this.NeedsAnimate\n                                         | this.NeedsProject;\n\n  static readonly NeedsDisplay: ViewFlags = 1 << (Component.FlagShift + 14);\n  static readonly NeedsLayout: ViewFlags = 1 << (Component.FlagShift + 15);\n  static readonly NeedsRender: ViewFlags = 1 << (Component.FlagShift + 16);\n  static readonly NeedsRasterize: ViewFlags = 1 << (Component.FlagShift + 17);\n  static readonly NeedsComposite: ViewFlags = 1 << (Component.FlagShift + 18);\n  /** @internal */\n  static readonly DisplayMask: ViewFlags = this.NeedsDisplay\n                                         | this.NeedsLayout\n                                         | this.NeedsRender\n                                         | this.NeedsRasterize\n                                         | this.NeedsComposite;\n\n  /** @internal */\n  static readonly UpdateMask: ViewFlags = this.ProcessMask\n                                        | this.DisplayMask;\n\n  /** @internal */\n  static override readonly FlagShift: number = Component.FlagShift + 19;\n  /** @internal */\n  static override readonly FlagMask: ViewFlags = (1 << this.FlagShift) - 1;\n\n  static override readonly MountFlags: ViewFlags = Component.MountFlags | this.NeedsResize | this.NeedsChange | this.NeedsLayout;\n  static readonly UncullFlags: ViewFlags = this.NeedsResize | this.NeedsChange | this.NeedsLayout;\n  static readonly UnhideFlags: ViewFlags = this.NeedsLayout;\n  static override readonly InsertChildFlags: ViewFlags = Component.InsertChildFlags | this.NeedsLayout;\n  static override readonly RemoveChildFlags: ViewFlags = Component.RemoveChildFlags | this.NeedsLayout;\n  static override readonly ReinsertChildFlags: ViewFlags = Component.InsertChildFlags | this.NeedsLayout;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {ViewFactory} from \"./View\";\nimport {View} from \"./View\";\n\n/** @public */\nexport interface ViewRelationDescriptor<R, V extends View> extends FastenerDescriptor<R> {\n  extends?: Proto<ViewRelation<any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface ViewRelationClass<F extends ViewRelation<any, any, any> = ViewRelation<any, any, any>> extends FastenerClass<F> {\n}\n\n/** @public */\nexport interface ViewRelation<R = any, V extends View = View, I extends any[] = [V | null]> extends Fastener<R, V | null, I> {\n  /** @override */\n  get descriptorType(): Proto<ViewRelationDescriptor<R, V>>;\n\n  /** @override */\n  get fastenerType(): Proto<ViewRelation<any, any, any>>;\n\n  get viewType(): ViewFactory<V> | null;\n\n  get observes(): boolean;\n\n  /** @override */\n  get parent(): ViewRelation<any, V, any> | null;\n\n  /** @internal */\n  readonly outlets: ReadonlySet<Fastener<any, any, any>> | null;\n\n  /** @internal @override */\n  attachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @override */\n  detachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @protected */\n  decohereOutlets(): void;\n\n  /** @protected */\n  initView(view: V): void;\n\n  /** @protected */\n  willAttachView(view: V, target: View | null): void;\n\n  /** @protected */\n  onAttachView(view: V, target: View | null): void;\n\n  /** @protected */\n  didAttachView(view: V, target: View | null): void;\n\n  /** @protected */\n  deinitView(view: V): void;\n\n  /** @protected */\n  willDetachView(view: V): void;\n\n  /** @protected */\n  onDetachView(view: V): void;\n\n  /** @protected */\n  didDetachView(view: V): void;\n\n  get parentView(): View | null;\n\n  /** @protected */\n  insertChild(parent: View, child: V, target: View | null, key: string | undefined): void;\n\n  /** @internal */\n  bindView(view: View, target: View | null): void;\n\n  /** @internal */\n  unbindView(view: View): void;\n\n  detectView(view: View): V | null;\n\n  createView(): V;\n\n  fromLike(value: V | LikeType<V>): V;\n}\n\n/** @public */\nexport const ViewRelation = (<R, V extends View, I extends any[], F extends ViewRelation<any, any, any>>() => Fastener.extend<ViewRelation<R, V, I>, ViewRelationClass<F>>(\"ViewRelation\", {\n  get fastenerType(): Proto<ViewRelation<any, any, any>> {\n    return ViewRelation;\n  },\n\n  viewType: null,\n\n  observes: false,\n\n  attachOutlet(outlet: Fastener<any, any, any>): void {\n    let outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      outlets = new Set<Fastener<any, any, any>>();\n      (this as Mutable<typeof this>).outlets = outlets;\n    }\n    outlets.add(outlet);\n  },\n\n  detachOutlet(outlet: Fastener<any, any, any>): void {\n    const outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      return;\n    }\n    outlets.delete(outlet);\n  },\n\n  decohereOutlets(): void {\n    const outlets = this.outlets;\n    if (outlets !== null) {\n      for (const outlet of outlets) {\n        outlet.decohere(this);\n      }\n    }\n  },\n\n  initView(view: V): void {\n    // hook\n  },\n\n  willAttachView(view: V, target: View | null): void {\n    // hook\n  },\n\n  onAttachView(view: V, target: View | null): void {\n    if (this.observes) {\n      view.observe(this as Observes<V>);\n    }\n  },\n\n  didAttachView(view: V, target: View | null): void {\n    // hook\n  },\n\n  deinitView(view: V): void {\n    // hook\n  },\n\n  willDetachView(view: V): void {\n    // hook\n  },\n\n  onDetachView(view: V): void {\n    if (this.observes) {\n      view.unobserve(this as Observes<V>);\n    }\n  },\n\n  didDetachView(view: V): void {\n    // hook\n  },\n\n  get parentView(): View | null {\n    const owner = this.owner;\n    return owner instanceof View ? owner : null;\n  },\n\n  insertChild(parent: View, child: V, target: View | null, key: string | undefined): void {\n    parent.insertChild(child, target, key);\n  },\n\n  bindView(view: View, target: View | null): void {\n    // hook\n  },\n\n  unbindView(view: View): void {\n    // hook\n  },\n\n  detectView(view: View): V | null {\n    return null;\n  },\n\n  createView(): V {\n    let view: V | undefined;\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      view = viewType.create();\n    }\n    if (view === void 0 || view === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new Error(message);\n    }\n    return view;\n  },\n\n  fromLike(value: V | LikeType<V>): V {\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      return viewType.fromLike(value);\n    }\n    return View.fromLike(value) as V;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).outlets = null;\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {ConstraintExpressionLike} from \"@swim/constraint\";\nimport {ConstraintExpression} from \"@swim/constraint\";\nimport type {ConstraintVariable} from \"@swim/constraint\";\nimport {ConstraintProperty} from \"@swim/constraint\";\nimport type {ConstraintRelation} from \"@swim/constraint\";\nimport type {ConstraintStrengthLike} from \"@swim/constraint\";\nimport {ConstraintStrength} from \"@swim/constraint\";\nimport {Constraint} from \"@swim/constraint\";\nimport {ConstraintScope} from \"@swim/constraint\";\nimport {ConstraintContext} from \"@swim/constraint\";\nimport type {View} from \"./View\";\nimport type {ViewRelationDescriptor} from \"./ViewRelation\";\nimport type {ViewRelationClass} from \"./ViewRelation\";\nimport {ViewRelation} from \"./ViewRelation\";\n\n/** @public */\nexport interface ViewRefDescriptor<R, V extends View> extends ViewRelationDescriptor<R, V> {\n  extends?: Proto<ViewRef<any, any, any>> | boolean | null;\n  viewKey?: string | boolean;\n}\n\n/** @public */\nexport interface ViewRefClass<F extends ViewRef<any, any, any> = ViewRef<any, any, any>> extends ViewRelationClass<F> {\n  tryView<R, K extends keyof R, F extends R[K] = R[K]>(owner: R, fastenerName: K): (F extends {readonly view: infer V | null} ? V | null : never) | null;\n}\n\n/** @public */\nexport interface ViewRef<R = any, V extends View = View, I extends any[] = [V | null]> extends ViewRelation<R, V, I>, ConstraintScope, ConstraintContext {\n  /** @override */\n  get descriptorType(): Proto<ViewRefDescriptor<R, V>>;\n\n  /** @override */\n  get fastenerType(): Proto<ViewRef<any, any, any>>;\n\n  /** @override */\n  get parent(): ViewRef<any, V, any> | null;\n\n  get inletView(): V | null;\n\n  getInletView(): V;\n\n  get(): V | null;\n\n  set(view: V | LikeType<V> | Fastener<any, I[0], any> | null): R;\n\n  setIntrinsic(view: V | LikeType<V> | Fastener<any, I[0], any> | null): R;\n\n  get viewKey(): string | undefined;\n\n  readonly view: V | null;\n\n  getView(): V;\n\n  setView(view: V | LikeType<V> | null, target?: View | null, key?: string): V | null;\n\n  attachView(view?: V | LikeType<V> | null, target?: View | null): V;\n\n  detachView(): V | null;\n\n  insertView(parent?: View | null, view?: V | LikeType<V>, target?: View | null, key?: string): V;\n\n  removeView(): V | null;\n\n  deleteView(): V | null;\n\n  /** @internal @override */\n  bindView(view: View, target: View | null): void;\n\n  /** @internal @override */\n  unbindView(view: View): void;\n\n  /** @override */\n  detectView(view: View): V | null;\n\n  /** @override */\n  recohere(t: number): void;\n\n  constraint(lhs: ConstraintExpressionLike, relation: ConstraintRelation, rhs?: ConstraintExpressionLike, strength?: ConstraintStrengthLike): Constraint;\n\n  /** @internal */\n  readonly constraints: ReadonlySet<Constraint> | null;\n\n  /** @override */\n  hasConstraint(constraint: Constraint): boolean;\n\n  /** @override */\n  addConstraint(constraint: Constraint): void;\n\n  /** @override */\n  removeConstraint(constraint: Constraint): void;\n\n  /** @override */\n  activateConstraint(constraint: Constraint): void;\n\n  /** @override */\n  deactivateConstraint(constraint: Constraint): void;\n\n  /** @override */\n  constraintVariable(name: string, value?: number, strength?: ConstraintStrengthLike): ConstraintProperty<any, number>;\n\n  /** @internal */\n  readonly constraintVariables: ReadonlySet<ConstraintVariable> | null;\n\n  /** @override */\n  hasConstraintVariable(variable: ConstraintVariable): boolean;\n\n  /** @override */\n  addConstraintVariable(variable: ConstraintVariable): void;\n\n  /** @override */\n  removeConstraintVariable(variable: ConstraintVariable): void;\n\n  /** @override */\n  activateConstraintVariable(constraintVariable: ConstraintVariable): void;\n\n  /** @override */\n  deactivateConstraintVariable(constraintVariable: ConstraintVariable): void;\n\n  /** @override */\n  setConstraintVariable(constraintVariable: ConstraintVariable, state: number): void;\n\n  /** @internal @protected */\n  activateLayout(): void;\n\n  /** @internal @protected */\n  deactivateLayout(): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n}\n\n/** @public */\nexport const ViewRef = (<R, V extends View, I extends any[], F extends ViewRef<any, any, any>>() => ViewRelation.extend<ViewRef<R, V, I>, ViewRefClass<F>>(\"ViewRef\", {\n  get fastenerType(): Proto<ViewRef<any, any, any>> {\n    return ViewRef;\n  },\n\n  get inletView(): V | null {\n    const inlet = this.inlet;\n    return inlet instanceof ViewRef ? inlet.view : null;\n  },\n\n  getInletView(): V {\n    const inletView = this.inletView;\n    if (inletView === void 0 || inletView === null) {\n      let message = inletView + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"inlet view\";\n      throw new TypeError(message);\n    }\n    return inletView;\n  },\n\n  get(): V | null {\n    return this.view;\n  },\n\n  set(view: V | LikeType<V> | Fastener<any, I[0], any> | null): R {\n    if (view instanceof Fastener) {\n      this.bindInlet(view);\n    } else {\n      this.setView(view);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(view: V | LikeType<V> | Fastener<any, I[0], any> | null): R {\n    if (view instanceof Fastener) {\n      this.bindInlet(view);\n    } else {\n      this.setView(view);\n    }\n    return this.owner;\n  },\n\n  viewKey: void 0,\n\n  getView(): V {\n    const view = this.view;\n    if (view === null) {\n      let message = view + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new TypeError(message);\n    }\n    return view;\n  },\n\n  setView(newView: V | LikeType<V> | null, target?: View | null, key?: string): V | null {\n    if (newView !== null) {\n      newView = this.fromLike(newView);\n    }\n    let oldView = this.view;\n    if (oldView === newView) {\n      this.setCoherent(true);\n      return oldView;\n    } else if (target === void 0) {\n      target = null;\n    }\n    let parent: View | null;\n    if (this.binds && (parent = this.parentView, parent !== null)) {\n      if (oldView !== null && oldView.parent === parent) {\n        if (target === null) {\n          target = oldView.nextSibling;\n        }\n        oldView.remove();\n      }\n      if (newView !== null) {\n        if (key === void 0) {\n          key = this.viewKey;\n        }\n        this.insertChild(parent, newView, target, key);\n      }\n      oldView = this.view;\n      if (oldView === newView) {\n        return oldView;\n      }\n    }\n    if (oldView !== null) {\n      this.deactivateLayout();\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n    }\n    if (newView !== null) {\n      (this as Mutable<typeof this>).view = newView;\n      this.willAttachView(newView, target);\n      this.onAttachView(newView, target);\n      this.initView(newView);\n      this.didAttachView(newView, target);\n    }\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldView;\n  },\n\n  attachView(newView?: V | LikeType<V> | null, target?: View | null): V {\n    const oldView = this.view;\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromLike(newView);\n    } else if (oldView === null) {\n      newView = this.createView();\n    } else {\n      newView = oldView;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (oldView === newView) {\n      return newView;\n    } else if (oldView !== null) {\n      this.deactivateLayout();\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newView;\n  },\n\n  detachView(): V | null {\n    const oldView = this.view;\n    if (oldView === null) {\n      return null;\n    }\n    this.deactivateLayout();\n    (this as Mutable<typeof this>).view = null;\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldView;\n  },\n\n  insertView(parent?: View | null, newView?: V | LikeType<V>, target?: View | null, key?: string): V {\n    let oldView = this.view;\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromLike(newView);\n    } else if (oldView === null) {\n      newView = this.createView();\n    } else {\n      newView = oldView;\n    }\n    if (parent === void 0) {\n      parent = null;\n    }\n    if (!this.binds && oldView === newView && newView.parent !== null && parent === null && key === void 0) {\n      return newView;\n    }\n    if (parent === null) {\n      parent = this.parentView;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.viewKey;\n    }\n    if (parent !== null && (newView.parent !== parent || newView.key !== key)) {\n      this.insertChild(parent, newView, target, key);\n    }\n    oldView = this.view;\n    if (oldView === newView) {\n      return newView;\n    } else if (oldView !== null) {\n      this.deactivateLayout();\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n      if (this.binds && parent !== null && oldView.parent === parent) {\n        oldView.remove();\n      }\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newView;\n  },\n\n  removeView(): V | null {\n    const view = this.view;\n    if (view === null) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  deleteView(): V | null {\n    const view = this.detachView();\n    if (view === null) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  bindView(view: View, target: View | null): void {\n    if (!this.binds || this.view !== null) {\n      return;\n    }\n    const newView = this.detectView(view);\n    if (newView === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindView(view: View): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldView = this.detectView(view);\n    if (oldView === null || this.view !== oldView) {\n      return;\n    }\n    this.deactivateLayout();\n    (this as Mutable<typeof this>).view = null;\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectView(view: View): V | null {\n    const key = this.viewKey;\n    if (key !== void 0 && key === view.key) {\n      return view as V;\n    }\n    return null;\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof ViewRef) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setView(inlet.view);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n\n  constraint(lhs: ConstraintExpressionLike, relation: ConstraintRelation, rhs?: ConstraintExpressionLike, strength?: ConstraintStrengthLike): Constraint {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    lhs = ConstraintExpression.fromLike(lhs);\n    rhs = ConstraintExpression.fromLike(rhs);\n    const expression = rhs !== void 0 ? lhs.minus(rhs) : lhs;\n    if (strength === void 0) {\n      strength = ConstraintStrength.Required;\n    } else {\n      strength = ConstraintStrength.fromLike(strength);\n    }\n    const constraint = new Constraint(this.owner, expression, relation, strength);\n    this.addConstraint(constraint);\n    return constraint;\n  },\n\n  hasConstraint(constraint: Constraint): boolean {\n    const constraints = this.constraints;\n    return constraints !== null && constraints.has(constraint);\n  },\n\n  addConstraint(constraint: Constraint): void {\n    let constraints = this.constraints as Set<Constraint> | null;\n    if (constraints === null) {\n      constraints = new Set<Constraint>();\n      (this as Mutable<typeof this>).constraints = constraints;\n    } else if (constraints.has(constraint)) {\n      return;\n    }\n    constraints.add(constraint);\n    this.activateConstraint(constraint);\n  },\n\n  removeConstraint(constraint: Constraint): void {\n    const constraints = this.constraints as Set<Constraint> | null;\n    if (constraints === null || !constraints.has(constraint)) {\n      return;\n    }\n    this.deactivateConstraint(constraint);\n    constraints.delete(constraint);\n  },\n\n  activateConstraint(constraint: Constraint): void {\n    if (!ConstraintContext[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint context\");\n    }\n    this.owner.activateConstraint(constraint);\n  },\n\n  deactivateConstraint(constraint: Constraint): void {\n    if (!ConstraintContext[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint context\");\n    }\n    this.owner.deactivateConstraint(constraint);\n  },\n\n  constraintVariable(name: string, value?: number, strength?: ConstraintStrengthLike): ConstraintProperty<unknown, number> {\n    if (value === void 0) {\n      value = 0;\n    }\n    if (strength !== void 0) {\n      strength = ConstraintStrength.fromLike(strength);\n    } else {\n      strength = ConstraintStrength.Strong;\n    }\n    const property = ConstraintProperty.create(this) as ConstraintProperty<unknown, number>;\n    Object.defineProperty(property, \"name\", {\n      value: name,\n      enumerable: true,\n      configurable: true,\n    });\n    if (value !== void 0) {\n      property.set(value);\n    }\n    property.setStrength(strength);\n    property.mount();\n    return property;\n  },\n\n  hasConstraintVariable(constraintVariable: ConstraintVariable): boolean {\n    const constraintVariables = this.constraintVariables;\n    return constraintVariables !== null && constraintVariables.has(constraintVariable);\n  },\n\n  addConstraintVariable(constraintVariable: ConstraintVariable): void {\n    let constraintVariables = this.constraintVariables as Set<ConstraintVariable> | null;\n    if (constraintVariables === null) {\n      constraintVariables = new Set<ConstraintVariable>();\n      (this as Mutable<typeof this>).constraintVariables = constraintVariables;\n    } else if (constraintVariables.has(constraintVariable)) {\n      return;\n    }\n    constraintVariables.add(constraintVariable);\n    this.activateConstraintVariable(constraintVariable);\n  },\n\n  removeConstraintVariable(constraintVariable: ConstraintVariable): void {\n    const constraintVariables = this.constraintVariables as Set<ConstraintVariable> | null;\n    if (constraintVariables === null || !constraintVariables.has(constraintVariable)) {\n      return;\n    }\n    this.deactivateConstraintVariable(constraintVariable);\n    constraintVariables.delete(constraintVariable);\n  },\n\n  activateConstraintVariable(constraintVariable: ConstraintVariable): void {\n    if (!ConstraintContext[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint context\");\n    }\n    this.owner.activateConstraintVariable(constraintVariable);\n  },\n\n  deactivateConstraintVariable(constraintVariable: ConstraintVariable): void {\n    if (!ConstraintContext[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint context\");\n    }\n    this.owner.deactivateConstraintVariable(constraintVariable);\n  },\n\n  setConstraintVariable(constraintVariable: ConstraintVariable, state: number): void {\n    if (!ConstraintContext[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint context\");\n    }\n    this.owner.setConstraintVariable(constraintVariable, state);\n  },\n\n  activateLayout(): void {\n    if (!ConstraintContext[Symbol.hasInstance](this.owner)) {\n      return;\n    }\n    const constraintVariables = this.constraintVariables;\n    if (constraintVariables !== null) {\n      for (const constraintVariable of constraintVariables) {\n        this.owner.activateConstraintVariable(constraintVariable);\n      }\n    }\n    const constraints = this.constraints;\n    if (constraints !== null) {\n      for (const constraint of constraints) {\n        this.owner.activateConstraint(constraint);\n      }\n    }\n  },\n\n  deactivateLayout(): void {\n    if (!ConstraintContext[Symbol.hasInstance](this.owner)) {\n      return;\n    }\n    const constraints = this.constraints;\n    if (constraints !== null) {\n      for (const constraint of constraints) {\n        this.owner.deactivateConstraint(constraint);\n      }\n    }\n    const constraintVariables = this.constraintVariables;\n    if (constraintVariables !== null) {\n      for (const constraintVariable of constraintVariables) {\n        this.owner.deactivateConstraintVariable(constraintVariable);\n      }\n    }\n  },\n\n  onMount(): void {\n    super.onMount();\n    this.activateLayout();\n  },\n\n  onUnmount(): void {\n    this.deactivateLayout();\n    super.onUnmount();\n  },\n},\n{\n  tryView<R, K extends keyof R, F extends R[K]>(owner: R, fastenerName: K): (F extends {readonly view: infer V | null} ? V | null : never) | null {\n    const metaclass = FastenerContext.getMetaclass(owner);\n    const viewRef = metaclass !== null ? metaclass.tryFastener(owner, fastenerName) : null;\n    return viewRef instanceof ViewRef ? viewRef.view : null;\n  },\n\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).constraints = null;\n    (fastener as Mutable<typeof fastener>).constraintVariables = null;\n    (fastener as Mutable<typeof fastener>).view = null;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<ViewRef<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const viewKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"viewKey\");\n    if (viewKeyDescriptor !== void 0 && \"value\" in viewKeyDescriptor) {\n      if (viewKeyDescriptor.value === true) {\n        viewKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      } else if (viewKeyDescriptor.value === false) {\n        viewKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Comparator} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {View} from \"./View\";\nimport type {ViewRelationDescriptor} from \"./ViewRelation\";\nimport type {ViewRelationClass} from \"./ViewRelation\";\nimport {ViewRelation} from \"./ViewRelation\";\n\n/** @public */\nexport interface ViewSetDescriptor<R, V extends View> extends ViewRelationDescriptor<R, V> {\n  extends?: Proto<ViewSet<any, any, any>> | boolean | null;\n  ordered?: boolean;\n  sorted?: boolean;\n}\n\n/** @public */\nexport interface ViewSetClass<F extends ViewSet<any, any, any> = ViewSet<any, any, any>> extends ViewRelationClass<F> {\n  /** @internal */\n  readonly OrderedFlag: FastenerFlags;\n  /** @internal */\n  readonly SortedFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ViewSet<R = any, V extends View = View, I extends any[] = [V | null]> extends ViewRelation<R, V, I> {\n  /** @override */\n  get descriptorType(): Proto<ViewSetDescriptor<R, V>>;\n\n  /** @override */\n  get fastenerType(): Proto<ViewSet<any, any, any>>;\n\n  /** @override */\n  get parent(): ViewSet<any, V, any> | null;\n\n  /** @protected */\n  viewKey(view: V): string | undefined;\n\n  /** @internal */\n  readonly views: {readonly [viewId: string]: V | undefined};\n\n  readonly viewCount: number;\n\n  /** @internal */\n  insertViewMap(newView: V, target: View | null): void;\n\n  /** @internal */\n  removeViewMap(oldView: V): void;\n\n  hasView(view: View): boolean;\n\n  addView(view?: V | LikeType<V>, target?: View | null, key?: string): V;\n\n  addViews(views: {readonly [viewId: string]: V | undefined}, target?: View | null): void;\n\n  setViews(views: {readonly [viewId: string]: V | undefined}, target?: View | null): void;\n\n  attachView(view?: V | LikeType<V> | null, target?: View | null): V;\n\n  attachViews(views: {readonly [viewId: string]: V | undefined}, target?: View | null): void;\n\n  detachView(view: V): V | null;\n\n  detachViews(views?: {readonly [viewId: string]: V | undefined}): void;\n\n  insertView(parent?: View | null, view?: V | LikeType<V>, target?: View | null, key?: string): V;\n\n  insertViews(parent: View | null, views: {readonly [viewId: string]: V | undefined}, target?: View | null): void;\n\n  removeView(view: V): V | null;\n\n  removeViews(views?: {readonly [viewId: string]: V | undefined}): void;\n\n  deleteView(view: V): V | null;\n\n  deleteViews(views?: {readonly [viewId: string]: V | undefined}): void;\n\n  reinsertView(view: V, target?: View | null): void;\n\n  /** @internal @override */\n  bindView(view: View, target: View | null): void;\n\n  /** @internal @override */\n  unbindView(view: View): void;\n\n  /** @override */\n  detectView(view: View): V | null;\n\n  /** @override */\n  recohere(t: number): void;\n\n  get ordered(): boolean;\n\n  order(ordered?: boolean): this;\n\n  get sorted(): boolean;\n\n  sort(sorted?: boolean): this;\n\n  /** @protected */\n  willSort(parent: View | null): void;\n\n  /** @protected */\n  onSort(parent: View | null): void;\n\n  /** @protected */\n  didSort(parent: View | null): void;\n\n  /** @internal */\n  sortChildren(parent: View, comparator?: Comparator<V>): void;\n\n  /** @internal */\n  getTargetChild(parent: View, child: V): View | null;\n\n  /** @internal */\n  compareChildren(a: View, b: View): number;\n\n  /** @internal */\n  compareTargetChild(a: View, b: View): number;\n\n  /** @protected */\n  compare(a: V, b: V): number;\n}\n\n/** @public */\nexport const ViewSet = (<R, V extends View, I extends any[], F extends ViewSet<any, any, any>>() => ViewRelation.extend<ViewSet<R, V, I>, ViewSetClass<F>>(\"ViewSet\", {\n  get fastenerType(): Proto<ViewSet<any, any, any>> {\n    return ViewSet;\n  },\n\n  viewKey(view: V): string | undefined {\n    return void 0;\n  },\n\n  insertViewMap(newView: V, target: View | null): void {\n    const views = this.views as {[viewId: string]: V | undefined};\n    if (target !== null && (this.flags & ViewSet.OrderedFlag) !== 0) {\n      (this as Mutable<typeof this>).views = Objects.inserted(views, newView.uid, newView, target);\n    } else {\n      views[newView.uid] = newView;\n    }\n  },\n\n  removeViewMap(oldView: V): void {\n    const views = this.views as {[viewId: string]: V | undefined};\n    delete views[oldView.uid];\n  },\n\n  hasView(view: View): boolean {\n    return this.views[view.uid] !== void 0;\n  },\n\n  addView(newView?: V | LikeType<V>, target?: View | null, key?: string): V {\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromLike(newView);\n    } else {\n      newView = this.createView();\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    let parent: View | null;\n    if (this.binds && (parent = this.parentView, parent !== null)) {\n      if (target === null) {\n        if (newView.parent === parent) {\n          target = newView.nextSibling;\n        } else {\n          target = this.getTargetChild(parent, newView);\n        }\n      }\n      if (key === void 0) {\n        key = this.viewKey(newView);\n      }\n      if (newView.parent !== parent || newView.nextSibling !== target || newView.key !== key) {\n        this.insertChild(parent, newView, target, key);\n      }\n    }\n    if (this.views[newView.uid] !== void 0) {\n      return newView;\n    }\n    this.insertViewMap(newView, target);\n    (this as Mutable<typeof this>).viewCount += 1;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newView;\n  },\n\n  addViews(newViews: {readonly [viewId: string]: V | undefined}, target?: View | null): void {\n    for (const viewId in newViews) {\n      this.addView(newViews[viewId]!, target);\n    }\n  },\n\n  setViews(newViews: {readonly [viewId: string]: V | undefined}, target?: View | null): void {\n    const binds = this.binds;\n    const parent = binds ? this.parentView : null;\n    const views = this.views;\n    for (const viewId in views) {\n      if (newViews[viewId] === void 0) {\n        const oldView = this.detachView(views[viewId]!);\n        if (oldView !== null && binds && parent !== null && oldView.parent === parent) {\n          oldView.remove();\n        }\n      }\n    }\n    if ((this.flags & ViewSet.OrderedFlag) !== 0) {\n      const orderedViews = new Array<V>();\n      for (const viewId in newViews) {\n        orderedViews.push(newViews[viewId]!);\n      }\n      for (let i = 0, n = orderedViews.length; i < n; i += 1) {\n        const newView = orderedViews[i]!;\n        if (views[newView.uid] === void 0) {\n          const targetView = i < n + 1 ? orderedViews[i + 1] : target;\n          this.addView(newView, targetView);\n        }\n      }\n    } else {\n      for (const viewId in newViews) {\n        if (views[viewId] === void 0) {\n          this.addView(newViews[viewId]!, target);\n        }\n      }\n    }\n  },\n\n  attachView(newView?: V | LikeType<V> | null, target?: View | null): V {\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromLike(newView);\n    } else {\n      newView = this.createView();\n    }\n    if (this.views[newView.uid] !== void 0) {\n      return newView;\n    } else if (target === void 0) {\n      target = null;\n    }\n    this.insertViewMap(newView, target);\n    (this as Mutable<typeof this>).viewCount += 1;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newView;\n  },\n\n  attachViews(newViews: {readonly [viewId: string]: V | undefined}, target?: View | null): void {\n    for (const viewId in newViews) {\n      this.attachView(newViews[viewId]!, target);\n    }\n  },\n\n  detachView(oldView: V): V | null {\n    if (this.views[oldView.uid] === void 0) {\n      return null;\n    }\n    (this as Mutable<typeof this>).viewCount -= 1;\n    this.removeViewMap(oldView);\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldView;\n  },\n\n  detachViews(views?: {readonly [viewId: string]: V | undefined}): void {\n    if (views === void 0) {\n      views = this.views;\n    }\n    for (const viewId in views) {\n      this.detachView(views[viewId]!);\n    }\n  },\n\n  insertView(parent?: View | null, newView?: V | LikeType<V>, target?: View | null, key?: string): V {\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromLike(newView);\n    } else {\n      newView = this.createView();\n    }\n    if (parent === void 0) {\n      parent = null;\n    }\n    if (!this.binds && this.views[newView.uid] !== void 0 && newView.parent !== null && parent === null && key === void 0) {\n      return newView;\n    }\n    if (parent === null) {\n      parent = this.parentView;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.viewKey(newView);\n    }\n    if (parent !== null && (newView.parent !== parent || newView.key !== key)) {\n      if (target === null) {\n        target = this.getTargetChild(parent, newView);\n      }\n      this.insertChild(parent, newView, target, key);\n    }\n    if (this.views[newView.uid] !== void 0) {\n      return newView;\n    }\n    this.insertViewMap(newView, target);\n    (this as Mutable<typeof this>).viewCount += 1;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newView;\n  },\n\n  insertViews(parent: View | null, newViews: {readonly [viewId: string]: V | undefined}, target?: View | null): void {\n    for (const viewId in newViews) {\n      this.insertView(parent, newViews[viewId]!, target);\n    }\n  },\n\n  removeView(view: V): V | null {\n    if (!this.hasView(view)) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  removeViews(views?: {readonly [viewId: string]: V | undefined}): void {\n    if (views === void 0) {\n      views = this.views;\n    }\n    for (const viewId in views) {\n      this.removeView(views[viewId]!);\n    }\n  },\n\n  deleteView(view: V): V | null {\n    const oldView = this.detachView(view);\n    if (oldView === null) {\n      return null;\n    }\n    oldView.remove();\n    return oldView;\n  },\n\n  deleteViews(views?: {readonly [viewId: string]: V | undefined}): void {\n    if (views === void 0) {\n      views = this.views;\n    }\n    for (const viewId in views) {\n      this.deleteView(views[viewId]!);\n    }\n  },\n\n  reinsertView(view: V, target?: View | null): void {\n    if (this.views[view.uid] === void 0 || (target === void 0 && (this.flags & ViewSet.SortedFlag) === 0)) {\n      return;\n    }\n    const parent = view.parent;\n    if (parent === null) {\n      return;\n    } else if (target === void 0) {\n      target = this.getTargetChild(parent, view);\n    }\n    parent.reinsertChild(view, target);\n  },\n\n  bindView(view: View, target: View | null): void {\n    if (!this.binds) {\n      return;\n    }\n    const newView = this.detectView(view);\n    if (newView === null || this.views[newView.uid] !== void 0) {\n      return;\n    }\n    this.insertViewMap(newView, target);\n    (this as Mutable<typeof this>).viewCount += 1;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindView(view: View): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldView = this.detectView(view);\n    if (oldView === null || this.views[oldView.uid] === void 0) {\n      return;\n    }\n    (this as Mutable<typeof this>).viewCount -= 1;\n    this.removeViewMap(oldView);\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectView(view: View): V | null {\n    if (typeof this.viewType === \"function\" && view instanceof this.viewType) {\n      return view as V;\n    }\n    return null;\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof ViewSet) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setViews(inlet.views);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n\n  get ordered(): boolean {\n    return (this.flags & ViewSet.OrderedFlag) !== 0;\n  },\n\n  order(ordered?: boolean): typeof this {\n    if (ordered === void 0) {\n      ordered = true;\n    }\n    if (ordered) {\n      this.setFlags(this.flags | ViewSet.OrderedFlag);\n    } else {\n      this.setFlags(this.flags & ~ViewSet.OrderedFlag);\n    }\n    return this;\n  },\n\n  get sorted(): boolean {\n    return (this.flags & ViewSet.SortedFlag) !== 0;\n  },\n\n  sort(sorted?: boolean): typeof this {\n    if (sorted === void 0) {\n      sorted = true;\n    }\n    if (sorted) {\n      const parent = this.parentView;\n      this.willSort(parent);\n      this.setFlags(this.flags | ViewSet.SortedFlag);\n      this.onSort(parent);\n      this.didSort(parent);\n    } else {\n      this.setFlags(this.flags & ~ViewSet.SortedFlag);\n    }\n    return this;\n  },\n\n  willSort(parent: View | null): void {\n    // hook\n  },\n\n  onSort(parent: View | null): void {\n    if (parent !== null) {\n      this.sortChildren(parent);\n    }\n  },\n\n  didSort(parent: View | null): void {\n    // hook\n  },\n\n  sortChildren(parent: View, comparator?: Comparator<V>): void {\n    parent.sortChildren(this.compareChildren.bind(this));\n  },\n\n  getTargetChild(parent: View, child: V): View | null {\n    if ((this.flags & ViewSet.SortedFlag) !== 0) {\n      return parent.getTargetChild(child, this.compareTargetChild.bind(this));\n    }\n    return null;\n  },\n\n  compareChildren(a: View, b: View): number {\n    const views = this.views;\n    const x = views[a.uid];\n    const y = views[b.uid];\n    if (x !== void 0 && y !== void 0) {\n      return this.compare(x, y);\n    }\n    return x !== void 0 ? 1 : y !== void 0 ? -1 : 0;\n  },\n\n  compareTargetChild(a: V, b: View): number {\n    const views = this.views;\n    const y = views[b.uid];\n    if (y !== void 0) {\n      return this.compare(a, y);\n    }\n    return y !== void 0 ? -1 : 0;\n  },\n\n  compare(a: V, b: V): number {\n    return a.uid < b.uid ? -1 : a.uid > b.uid ? 1 : 0;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).views = {};\n    (fastener as Mutable<typeof fastener>).viewCount = 0;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<ViewSet<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    let flagsInit = fastenerPrototype.flagsInit;\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"ordered\")) {\n      if (fastenerPrototype.ordered) {\n        flagsInit |= ViewSet.OrderedFlag;\n      } else {\n        flagsInit &= ~ViewSet.OrderedFlag;\n      }\n      delete (fastenerPrototype as ViewSetDescriptor<any, any>).ordered;\n    }\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"sorted\")) {\n      if (fastenerPrototype.sorted) {\n        flagsInit |= ViewSet.SortedFlag;\n      } else {\n        flagsInit &= ~ViewSet.SortedFlag;\n      }\n      delete (fastenerPrototype as ViewSetDescriptor<any, any>).sorted;\n    }\n    Object.defineProperty(fastenerPrototype, \"flagsInit\", {\n      value: flagsInit,\n      enumerable: true,\n      configurable: true,\n    });\n  },\n\n  OrderedFlag: 1 << (ViewRelation.FlagShift + 0),\n  SortedFlag: 1 << (ViewRelation.FlagShift + 1),\n\n  FlagShift: ViewRelation.FlagShift + 2,\n  FlagMask: (1 << (ViewRelation.FlagShift + 2)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {View} from \"./View\";\n\n/** @public */\nexport type GestureInputType = \"mouse\" | \"wheel\" | \"touch\" | \"pen\" | \"unknown\";\n\n/** @public */\nexport class GestureInput {\n  readonly inputId: string;\n  inputType: GestureInputType;\n  isPrimary: boolean;\n\n  target: EventTarget | null;\n  button: number;\n  buttons: number;\n  altKey: boolean;\n  ctrlKey: boolean;\n  metaKey: boolean;\n  shiftKey: boolean;\n\n  width: number;\n  height: number;\n  tiltX: number;\n  tiltY: number;\n  twist: number;\n  pressure: number;\n  tangentialPressure: number;\n\n  x0: number;\n  y0: number;\n  t0: number;\n  dx: number;\n  dy: number;\n  dt: number;\n  x: number;\n  y: number;\n  t: number;\n\n  detail: unknown;\n\n  defaultPrevented: boolean;\n\n  constructor(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number) {\n    this.inputId = inputId;\n    this.inputType = inputType;\n    this.isPrimary = isPrimary;\n\n    this.target = null;\n    this.button = 0;\n    this.buttons = 0;\n    this.altKey = false;\n    this.ctrlKey = false;\n    this.metaKey = false;\n    this.shiftKey = false;\n\n    this.width = 0;\n    this.height = 0;\n    this.tiltX = 0;\n    this.tiltY = 0;\n    this.twist = 0;\n    this.pressure = 0;\n    this.tangentialPressure = 0;\n\n    this.x0 = x;\n    this.y0 = y;\n    this.t0 = t;\n    this.dx = 0;\n    this.dy = 0;\n    this.dt = 0;\n    this.x = x;\n    this.y = y;\n    this.t = t;\n\n    this.detail = void 0;\n\n    this.defaultPrevented = false;\n  }\n\n  preventDefault(): void {\n    this.defaultPrevented = true;\n  }\n\n  /** @internal */\n  static pointerInputType(inputType: string): GestureInputType {\n    if (inputType === \"mouse\" || inputType === \"touch\" || inputType === \"pen\") {\n      return inputType;\n    }\n    return \"unknown\";\n  }\n}\n\n/** @public */\nexport type GestureMethod = \"auto\" | \"pointer\" | \"touch\" | \"mouse\";\n\n/** @public */\nexport interface GestureDescriptor<R, V extends View> extends FastenerDescriptor<R> {\n  extends?: Proto<Gesture<any, any>> | boolean | null;\n  method?: GestureMethod;\n  viewKey?: string | boolean;\n  observes?: boolean;\n}\n\n/** @public */\nexport interface GestureClass<G extends Gesture<any, any> = Gesture> extends FastenerClass<G> {\n}\n\n/** @public */\nexport interface Gesture<R = any, V extends View = View> extends Fastener<R> {\n  /** @override */\n  get descriptorType(): Proto<GestureDescriptor<R, V>>;\n\n  /** @override */\n  get fastenerType(): Proto<Gesture<any, any>>;\n\n  get bindsOwner(): boolean;\n\n  get observes(): boolean;\n\n  get viewKey(): string | undefined;\n\n  readonly view: V | null;\n\n  getView(): V;\n\n  setView(newView: V | null): V | null;\n\n  /** @protected */\n  initView(view: V): void;\n\n  /** @protected */\n  willAttachView(view: V): void;\n\n  /** @protected */\n  onAttachView(view: V): void;\n\n  /** @protected */\n  didAttachView(view: V): void;\n\n  /** @protected */\n  deinitView(view: V): void;\n\n  /** @protected */\n  willDetachView(view: V): void;\n\n  /** @protected */\n  onDetachView(view: V): void;\n\n  /** @protected */\n  didDetachView(view: V): void;\n\n  /** @internal @protected */\n  attachEvents(view: V): void;\n\n  /** @internal @protected */\n  detachEvents(view: V): void;\n\n  /** @internal */\n  readonly inputs: {readonly [inputId: string]: GestureInput | undefined};\n\n  readonly inputCount: number;\n\n  getInput(inputId: string | number): GestureInput | null;\n\n  /** @internal */\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number): GestureInput;\n\n  /** @internal */\n  getOrCreateInput(inputId: string | number, inputType: GestureInputType, isPrimary: boolean,\n                   x: number, y: number, t: number): GestureInput;\n\n  /** @internal */\n  clearInput(input: GestureInput): void;\n\n  /** @internal */\n  clearInputs(): void;\n\n  /** @internal */\n  resetInput(input: GestureInput): void;\n\n  /** @internal */\n  resetInputs(): void;\n\n  /** @internal */\n  bindView(view: View): void;\n\n  /** @internal */\n  unbindView(view: View): void;\n\n  detectView(view: View): V | null;\n\n  /** @internal */\n  viewWillUnmount(view: V): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n}\n\n/** @public */\nexport const Gesture = (<R, V extends View, G extends Gesture<any, any>>() => Fastener.extend<Gesture<R, V>, GestureClass<G>>(\"Gesture\", {\n  get fastenerType(): Proto<Gesture<any, any>> {\n    return Gesture;\n  },\n\n  bindsOwner: false,\n\n  observes: true,\n\n  viewKey: void 0,\n\n  getView(): V {\n    const view = this.view;\n    if (view === null) {\n      let message = view + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new TypeError(message);\n    }\n    return view;\n  },\n\n  setView(newView: V | null): V | null {\n    const oldView = this.view;\n    if (oldView === newView) {\n      return oldView;\n    } else if (oldView !== null) {\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n    }\n    if (newView !== null) {\n      (this as Mutable<typeof this>).view = newView;\n      this.willAttachView(newView);\n      this.onAttachView(newView);\n      this.initView(newView);\n      this.didAttachView(newView);\n    }\n    return oldView;\n  },\n\n  initView(view: V): void {\n    // hook\n  },\n\n  willAttachView(view: V): void {\n    // hook\n  },\n\n  onAttachView(view: V): void {\n    if ((this.flags & Fastener.MountedFlag) === 0) {\n      return;\n    }\n    this.attachEvents(view);\n    if (this.observes) {\n      view.observe(this as Observes<V>);\n    }\n  },\n\n  didAttachView(view: V): void {\n    // hook\n  },\n\n  deinitView(view: V): void {\n    // hook\n  },\n\n  willDetachView(view: V): void {\n    // hook\n  },\n\n  onDetachView(view: V): void {\n    this.clearInputs();\n    if ((this.flags & Fastener.MountedFlag) === 0) {\n      return;\n    }\n    if (this.observes) {\n      view.unobserve(this as Observes<V>);\n    }\n    this.detachEvents(view);\n  },\n\n  didDetachView(view: V): void {\n    // hook\n  },\n\n  attachEvents(view: V): void {\n    // hook\n  },\n\n  detachEvents(view: V): void {\n    // hook\n  },\n\n  getInput(inputId: string | number): GestureInput | null {\n    if (typeof inputId === \"number\") {\n      inputId = \"\" + inputId;\n    }\n    const input = this.inputs[inputId];\n    return input !== void 0 ? input : null;\n  },\n\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number): GestureInput {\n    return new GestureInput(inputId, inputType, isPrimary, x, y, t);\n  },\n\n  getOrCreateInput(inputId: string | number, inputType: GestureInputType, isPrimary: boolean,\n                   x: number, y: number, t: number): GestureInput {\n    if (typeof inputId === \"number\") {\n      inputId = \"\" + inputId;\n    }\n    const inputs = this.inputs as {[inputId: string]: GestureInput | undefined};\n    let input = inputs[inputId];\n    if (input === void 0) {\n      input = this.createInput(inputId, inputType, isPrimary, x, y, t);\n      inputs[inputId] = input;\n      (this as Mutable<typeof this>).inputCount += 1;\n    }\n    return input;\n  },\n\n  clearInput(input: GestureInput): void {\n    const inputs = this.inputs as {[inputId: string]: GestureInput | undefined};\n    delete inputs[input.inputId];\n    (this as Mutable<typeof this>).inputCount -= 1;\n  },\n\n  clearInputs(): void {\n    (this as Mutable<typeof this>).inputs = {};\n    (this as Mutable<typeof this>).inputCount = 0;\n  },\n\n  resetInput(input: GestureInput): void {\n    this.clearInput(input);\n  },\n\n  resetInputs(): void {\n    const inputs = this.inputs as {[inputId: string]: GestureInput | undefined};\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      this.resetInput(input);\n    }\n  },\n\n  bindView(view: View): void {\n    if (!this.binds || this.view !== null) {\n      return;\n    }\n    const newView = this.detectView(view);\n    if (newView === null) {\n      return;\n    }\n    this.setView(newView);\n  },\n\n  unbindView(view: View): void {\n    if (!this.binds || this.view !== view) {\n      return;\n    }\n    this.setView(null);\n  },\n\n  detectView(view: View): V | null {\n    if (this.viewKey !== void 0 && this.viewKey === view.key) {\n      return view as V;\n    }\n    return null;\n  },\n\n  viewWillUnmount(view: View): void {\n    this.clearInputs();\n  },\n\n  onMount(): void {\n    super.onMount();\n    const view = this.view;\n    if (view !== null) {\n      this.attachEvents(view);\n      if (this.observes) {\n        view.observe(this as Observes<V>);\n      }\n    }\n  },\n\n  onUnmount(): void {\n    super.onUnmount();\n    this.clearInputs();\n    const view = this.view;\n    if (view !== null) {\n      if (this.observes) {\n        view.unobserve(this as Observes<V>);\n      }\n      this.detachEvents(view);\n    }\n  },\n},\n{\n  create(owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    const gesture = super.create(owner) as G;\n    if (gesture.view === null && gesture.bindsOwner === true && (owner as unknown) instanceof View) {\n      gesture.setView(owner);\n    }\n    return gesture;\n  },\n\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    (gesture as Mutable<typeof gesture>).view = null;\n    (gesture as Mutable<typeof gesture>).inputs = {};\n    (gesture as Mutable<typeof gesture>).inputCount = 0;\n    return gesture;\n  },\n\n  refine(fastenerClass: FastenerClass<Gesture<any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const viewKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"viewKey\");\n    if (viewKeyDescriptor !== void 0 && \"value\" in viewKeyDescriptor) {\n      if (viewKeyDescriptor.value === true) {\n        viewKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      } else if (viewKeyDescriptor.value === false) {\n        viewKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport type {View} from \"./View\";\nimport type {GestureInputType} from \"./Gesture\";\nimport {GestureInput} from \"./Gesture\";\nimport type {GestureDescriptor} from \"./Gesture\";\nimport type {GestureClass} from \"./Gesture\";\nimport {Gesture} from \"./Gesture\";\n\n/** @public */\nexport class PositionGestureInput extends GestureInput {\n  hovering: boolean;\n  pressing: boolean;\n  holdTimer: number;\n  holdDelay: number;\n\n  constructor(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number) {\n    super(inputId, inputType, isPrimary, x, y, t);\n    this.hovering = false;\n    this.pressing = false;\n    this.holdTimer = 0;\n    this.holdDelay = 400;\n  }\n\n  isRunaway(): boolean {\n    const dx = this.x - this.x0;\n    const dy = this.y - this.y0;\n    const dt = this.t - this.t0;\n    return this.inputType !== \"mouse\" && dt < 100\n        && dx * dx + dy * dy > 10 * 10;\n  }\n\n  setHoldTimer(f: () => void): void {\n    if (this.holdDelay === 0) {\n      return;\n    }\n    this.clearHoldTimer();\n    this.holdTimer = setTimeout(f, this.holdDelay) as any;\n  }\n\n  clearHoldTimer(): void {\n    if (this.holdTimer === 0) {\n      return;\n    }\n    clearTimeout(this.holdTimer);\n    this.holdTimer = 0;\n  }\n}\n\n/** @public */\nexport interface PositionGestureDescriptor<R, V extends View> extends GestureDescriptor<R, V> {\n  extends?: Proto<PositionGesture<any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface PositionGestureClass<G extends PositionGesture<any, any> = PositionGesture> extends GestureClass<G> {\n}\n\n/** @public */\nexport interface PositionGesture<R = any, V extends View = View> extends Gesture<R, V> {\n  /** @override */\n  get descriptorType(): Proto<PositionGestureDescriptor<R, V>>;\n\n  /** @internal @protected @override */\n  attachEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachEvents(view: V): void;\n\n  /** @internal @protected */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  detachPressEvents(view: V): void;\n\n  /** @internal @override */\n  readonly inputs: {readonly [inputId: string]: PositionGestureInput | undefined};\n\n  /** @override */\n  getInput(inputId: string | number): PositionGestureInput | null;\n\n  /** @internal @override */\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number): PositionGestureInput;\n\n  /** @internal */\n  getOrCreateInput(inputId: string | number, inputType: GestureInputType, isPrimary: boolean,\n                   x: number, y: number, t: number): PositionGestureInput;\n\n  /** @internal @override */\n  clearInput(input: PositionGestureInput): void;\n\n  /** @internal @override */\n  clearInputs(): void;\n\n  /** @internal @override */\n  resetInput(input: PositionGestureInput): void;\n\n  readonly hoverCount: number;\n\n  get hovering(): boolean;\n\n  /** @internal */\n  startHovering(): void;\n\n  /** @protected */\n  willStartHovering(): void;\n\n  /** @protected */\n  onStartHovering(): void;\n\n  /** @protected */\n  didStartHovering(): void;\n\n  /** @internal */\n  stopHovering(): void;\n\n  /** @protected */\n  willStopHovering(): void;\n\n  /** @protected */\n  onStopHovering(): void;\n\n  /** @protected */\n  didStopHovering(): void;\n\n  /** @internal */\n  beginHover(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willBeginHover(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  onBeginHover(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didBeginHover(input: PositionGestureInput, event: Event | null): void;\n\n  /** @internal */\n  endHover(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willEndHover(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  onEndHover(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didEndHover(input: PositionGestureInput, event: Event | null): void;\n\n  readonly pressCount: number;\n\n  get pressing(): boolean\n\n  /** @internal */\n  startPressing(): void;\n\n  /** @protected */\n  willStartPressing(): void;\n\n  /** @protected */\n  onStartPressing(): void;\n\n  /** @protected */\n  didStartPressing(): void;\n\n  /** @internal */\n  stopPressing(): void;\n\n  /** @protected */\n  willStopPressing(): void;\n\n  /** @protected */\n  onStopPressing(): void;\n\n  /** @protected */\n  didStopPressing(): void;\n\n  /** @internal */\n  beginPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willBeginPress(input: PositionGestureInput, event: Event | null): boolean | void;\n\n  /** @protected */\n  onBeginPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didBeginPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @internal */\n  movePress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willMovePress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  onMovePress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didMovePress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @internal */\n  endPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willEndPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  onEndPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didEndPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @internal */\n  cancelPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willCancelPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  onCancelPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didCancelPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @internal */\n  press(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  onPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didPress(input: PositionGestureInput, event: Event | null): void;\n\n  /** @internal */\n  longPress(input: PositionGestureInput): void;\n\n  /** @protected */\n  willLongPress(input: PositionGestureInput): void;\n\n  /** @protected */\n  onLongPress(input: PositionGestureInput): void;\n\n  /** @protected */\n  didLongPress(input: PositionGestureInput): void;\n}\n\n/** @public */\nexport const PositionGesture = (<R, V extends View, G extends PositionGesture<any, any>>() => Gesture.extend<PositionGesture<R, V>, PositionGestureClass<G>>(\"PositionGesture\", {\n  attachEvents(view: V): void {\n    super.attachEvents(view);\n    this.attachHoverEvents(view);\n  },\n\n  detachEvents(view: V): void {\n    this.detachPressEvents(view);\n    this.detachHoverEvents(view);\n    super.detachEvents(view);\n  },\n\n  attachHoverEvents(view: V): void {\n    // hook\n  },\n\n  detachHoverEvents(view: V): void {\n    // hook\n  },\n\n  attachPressEvents(view: V): void {\n    // hook\n  },\n\n  detachPressEvents(view: V): void {\n    // hook\n  },\n\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number): PositionGestureInput {\n    return new PositionGestureInput(inputId, inputType, isPrimary, x, y, t);\n  },\n\n  clearInput(input: PositionGestureInput): void {\n    if (!input.hovering && !input.pressing) {\n      super.clearInput(input);\n    }\n  },\n\n  clearInputs(): void {\n    super.clearInputs();\n    (this as Mutable<typeof this>).hoverCount = 0;\n    (this as Mutable<typeof this>).pressCount = 0;\n  },\n\n  resetInput(input: PositionGestureInput): void {\n    if (input.pressing) {\n      this.cancelPress(input, null);\n    }\n    if (input.hovering) {\n      this.endHover(input, null);\n    }\n    super.resetInput(input);\n  },\n\n  get hovering() {\n    return this.hoverCount !== 0;\n  },\n\n  startHovering(): void {\n    this.willStartHovering();\n    this.onStartHovering();\n    this.didStartHovering();\n  },\n\n  willStartHovering(): void {\n    // hook\n  },\n\n  onStartHovering(): void {\n    // hook\n  },\n\n  didStartHovering(): void {\n    // hook\n  },\n\n  stopHovering(): void {\n    this.willStopHovering();\n    this.onStopHovering();\n    this.didStopHovering();\n  },\n\n  willStopHovering(): void {\n    // hook\n  },\n\n  onStopHovering(): void {\n    // hook\n  },\n\n  didStopHovering(): void {\n    // hook\n  },\n\n  beginHover(input: PositionGestureInput, event: Event | null): void {\n    if (input.hovering) {\n      return;\n    }\n    this.willBeginHover(input, event);\n    input.hovering = true;\n    (this as Mutable<typeof this>).hoverCount += 1;\n    this.onBeginHover(input, event);\n    this.didBeginHover(input, event);\n    if (this.hoverCount === 1) {\n      this.startHovering();\n    }\n  },\n\n  willBeginHover(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  onBeginHover(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  didBeginHover(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  endHover(input: PositionGestureInput, event: Event | null): void {\n    if (!input.hovering) {\n      return;\n    }\n    this.willEndHover(input, event);\n    input.hovering = false;\n    (this as Mutable<typeof this>).hoverCount -= 1;\n    this.onEndHover(input, event);\n    this.didEndHover(input, event);\n    if (this.hoverCount === 0) {\n      this.stopHovering();\n    }\n    this.clearInput(input);\n  },\n\n  willEndHover(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  onEndHover(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  didEndHover(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  get pressing(): boolean {\n    return this.pressCount !== 0;\n  },\n\n  startPressing(): void {\n    this.willStartPressing();\n    this.onStartPressing();\n    this.didStartPressing();\n  },\n\n  willStartPressing(): void {\n    // hook\n  },\n\n  onStartPressing(): void {\n    this.attachPressEvents(this.view!);\n  },\n\n  didStartPressing(): void {\n    // hook\n  },\n\n  stopPressing(): void {\n    this.willStopPressing();\n    this.onStopPressing();\n    this.didStopPressing();\n  },\n\n  willStopPressing(): void {\n    // hook\n  },\n\n  onStopPressing(): void {\n    this.detachPressEvents(this.view!);\n  },\n\n  didStopPressing(): void {\n    // hook\n  },\n\n  beginPress(input: PositionGestureInput, event: Event | null): void {\n    if (input.pressing) {\n      return;\n    }\n    let allowPress = this.willBeginPress(input, event);\n    if (allowPress === void 0) {\n      allowPress = true;\n    }\n    if (!allowPress) {\n      return;\n    }\n    input.pressing = true;\n    input.defaultPrevented = false;\n    (this as Mutable<typeof this>).pressCount += 1;\n    this.onBeginPress(input, event);\n    input.setHoldTimer(this.longPress.bind(this, input));\n    this.didBeginPress(input, event);\n    if (this.pressCount === 1) {\n      this.startPressing();\n    }\n  },\n\n  willBeginPress(input: PositionGestureInput, event: Event | null): boolean | void {\n    // hook\n  },\n\n  onBeginPress(input: PositionGestureInput, event: Event | null): void {\n    input.x0 = input.x;\n    input.y0 = input.y;\n    input.t0 = input.t;\n    input.dx = 0;\n    input.dy = 0;\n    input.dt = 0;\n  },\n\n  didBeginPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  movePress(input: PositionGestureInput, event: Event | null): void {\n    if (!input.pressing) {\n      return;\n    }\n    this.willMovePress(input, event);\n    this.onMovePress(input, event);\n    this.didMovePress(input, event);\n  },\n\n  willMovePress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  onMovePress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  didMovePress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  endPress(input: PositionGestureInput, event: Event | null): void {\n    input.clearHoldTimer();\n    if (!input.pressing) {\n      return;\n    }\n    this.willEndPress(input, event);\n    input.pressing = false;\n    (this as Mutable<typeof this>).pressCount -= 1;\n    this.onEndPress(input, event);\n    this.didEndPress(input, event);\n    if (this.pressCount === 0) {\n      this.stopPressing();\n    }\n    this.clearInput(input);\n  },\n\n  willEndPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  onEndPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  didEndPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  cancelPress(input: PositionGestureInput, event: Event | null): void {\n    input.clearHoldTimer();\n    if (!input.pressing) {\n      return;\n    }\n    this.willCancelPress(input, event);\n    input.pressing = false;\n    (this as Mutable<typeof this>).pressCount -= 1;\n    this.onCancelPress(input, event);\n    this.didCancelPress(input, event);\n    if (this.pressCount === 0) {\n      this.stopPressing();\n    }\n    this.clearInput(input);\n  },\n\n  willCancelPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  onCancelPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  didCancelPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  press(input: PositionGestureInput, event: Event | null): void {\n    this.willPress(input, event);\n    this.onPress(input, event);\n    this.didPress(input, event);\n  },\n\n  willPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  onPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  didPress(input: PositionGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  longPress(input: PositionGestureInput): void {\n    input.clearHoldTimer();\n    const dt = performance.now() - input.t0;\n    if (dt >= 1.5 * input.holdDelay || !input.pressing) {\n      return;\n    }\n    this.willLongPress(input);\n    this.onLongPress(input);\n    this.didLongPress(input);\n  },\n\n  willLongPress(input: PositionGestureInput): void {\n    // hook\n  },\n\n  onLongPress(input: PositionGestureInput): void {\n    const t = performance.now();\n    input.dt = t - input.t;\n    input.t = t;\n  },\n\n  didLongPress(input: PositionGestureInput): void {\n    // hook\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    (gesture as Mutable<typeof gesture>).hoverCount = 0;\n    (gesture as Mutable<typeof gesture>).pressCount = 0;\n    return gesture;\n  },\n\n  specialize(template: G extends {readonly descriptorType?: Proto<infer D>} ? D : never): FastenerClass<G> {\n    let superClass = template.extends as FastenerClass<G> | null | undefined;\n    if (superClass === void 0 || superClass === null) {\n      const method = template.method;\n      if (method === \"pointer\") {\n        superClass = PointerPositionGesture as unknown as FastenerClass<G>;\n      } else if (method === \"touch\") {\n        superClass = TouchPositionGesture as unknown as FastenerClass<G>;\n      } else if (method === \"mouse\") {\n        superClass = MousePositionGesture as unknown as FastenerClass<G>;\n      } else if (typeof PointerEvent !== \"undefined\") {\n        superClass = PointerPositionGesture as unknown as FastenerClass<G>;\n      } else if (typeof TouchEvent !== \"undefined\") {\n        superClass = TouchPositionGesture as unknown as FastenerClass<G>;\n      } else {\n        superClass = MousePositionGesture as unknown as FastenerClass<G>;\n      }\n    }\n    return superClass;\n  },\n}))();\n\n/** @internal */\nexport interface PointerPositionGesture<R = any, V extends View = View> extends PositionGesture<R, V> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: PositionGestureInput, event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerEnter(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerLeave(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerDown(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerMove(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerUp(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerCancel(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerLeaveDocument(event: PointerEvent): void;\n}\n\n/** @internal */\nexport const PointerPositionGesture = (<R, V extends View, G extends PointerPositionGesture<any, any>>() => PositionGesture.extend<PointerPositionGesture<R, V>, PositionGestureClass<G>>(\"PointerPositionGesture\", {\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"pointerenter\", this.onPointerEnter as EventListener);\n    view.addEventListener(\"pointerleave\", this.onPointerLeave as EventListener);\n    view.addEventListener(\"pointerdown\", this.onPointerDown as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"pointerenter\", this.onPointerEnter as EventListener);\n    view.removeEventListener(\"pointerleave\", this.onPointerLeave as EventListener);\n    view.removeEventListener(\"pointerdown\", this.onPointerDown as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    document.body.addEventListener(\"pointermove\", this.onPointerMove);\n    document.body.addEventListener(\"pointerup\", this.onPointerUp);\n    document.body.addEventListener(\"pointercancel\", this.onPointerCancel);\n    document.body.addEventListener(\"pointerleave\", this.onPointerLeaveDocument);\n  },\n\n  detachPressEvents(view: V): void {\n    document.body.removeEventListener(\"pointermove\", this.onPointerMove);\n    document.body.removeEventListener(\"pointerup\", this.onPointerUp);\n    document.body.removeEventListener(\"pointercancel\", this.onPointerCancel);\n    document.body.removeEventListener(\"pointerleave\", this.onPointerLeaveDocument);\n  },\n\n  updateInput(input: PositionGestureInput, event: PointerEvent): void {\n    input.target = event.target;\n    input.button = event.button;\n    input.buttons = event.buttons;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = event.clientX - input.x;\n    input.dy = event.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = event.clientX;\n    input.y = event.clientY;\n    input.t = event.timeStamp;\n\n    input.width = event.width;\n    input.height = event.height;\n    input.tiltX = event.tiltX;\n    input.tiltY = event.tiltY;\n    input.twist = event.twist;\n    input.pressure = event.pressure;\n    input.tangentialPressure = event.tangentialPressure;\n  },\n\n  onPointerEnter(event: PointerEvent): void {\n    if (event.pointerType !== \"mouse\" || event.buttons !== 0) {\n      return;\n    }\n    const input = this.getOrCreateInput(event.pointerId, GestureInput.pointerInputType(event.pointerType),\n                                        event.isPrimary, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.hovering) {\n      this.beginHover(input, event);\n    }\n  },\n\n  onPointerLeave(event: PointerEvent): void {\n    if (event.pointerType !== \"mouse\") {\n      return;\n    }\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endHover(input, event);\n  },\n\n  onPointerDown(event: PointerEvent): void {\n    const input = this.getOrCreateInput(event.pointerId, GestureInput.pointerInputType(event.pointerType),\n                                        event.isPrimary, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.pressing) {\n      this.beginPress(input, event);\n    }\n    if (event.pointerType === \"mouse\" && event.button !== 0) {\n      this.cancelPress(input, event);\n    }\n  },\n\n  onPointerMove(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.movePress(input, event);\n  },\n\n  onPointerUp(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endPress(input, event);\n    if (!input.defaultPrevented && event.button === 0) {\n      this.press(input, event);\n    }\n  },\n\n  onPointerCancel(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n  },\n\n  onPointerLeaveDocument(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n    this.endHover(input, event);\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onPointerEnter = gesture.onPointerEnter.bind(gesture);\n    gesture.onPointerLeave = gesture.onPointerLeave.bind(gesture);\n    gesture.onPointerDown = gesture.onPointerDown.bind(gesture);\n    gesture.onPointerMove = gesture.onPointerMove.bind(gesture);\n    gesture.onPointerUp = gesture.onPointerUp.bind(gesture);\n    gesture.onPointerCancel = gesture.onPointerCancel.bind(gesture);\n    gesture.onPointerLeaveDocument = gesture.onPointerLeaveDocument.bind(gesture);\n    return gesture;\n  },\n}))();\n\n/** @internal */\nexport interface TouchPositionGesture<R = any, V extends View = View> extends PositionGesture<R, V> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: PositionGestureInput, event: TouchEvent, touch: Touch): void;\n\n  /** @internal @protected */\n  onTouchStart(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchMove(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchEnd(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchCancel(event: TouchEvent): void;\n}\n\n/** @internal */\nexport const TouchPositionGesture = (<R, V extends View, G extends TouchPositionGesture<any, any>>() => PositionGesture.extend<TouchPositionGesture<R, V>, PositionGestureClass<G>>(\"TouchPositionGesture\", {\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"touchstart\", this.onTouchStart as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"touchstart\", this.onTouchStart as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    view.addEventListener(\"touchmove\", this.onTouchMove as EventListener);\n    view.addEventListener(\"touchend\", this.onTouchEnd as EventListener);\n    view.addEventListener(\"touchcancel\", this.onTouchCancel as EventListener);\n  },\n\n  detachPressEvents(view: V): void {\n    view.removeEventListener(\"touchmove\", this.onTouchMove as EventListener);\n    view.removeEventListener(\"touchend\", this.onTouchEnd as EventListener);\n    view.removeEventListener(\"touchcancel\", this.onTouchCancel as EventListener);\n  },\n\n  updateInput(input: PositionGestureInput, event: TouchEvent, touch: Touch): void {\n    input.target = touch.target;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = touch.clientX - input.x;\n    input.dy = touch.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = touch.clientX;\n    input.y = touch.clientY;\n    input.t = event.timeStamp;\n  },\n\n  onTouchStart(event: TouchEvent): void {\n    const touches = event.targetTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getOrCreateInput(touch.identifier, \"touch\", false, touch.clientX, touch.clientY, event.timeStamp);\n      this.updateInput(input, event, touch);\n      if (!input.pressing) {\n        this.beginPress(input, event);\n      }\n    }\n  },\n\n  onTouchMove(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.movePress(input, event);\n    }\n  },\n\n  onTouchEnd(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.endPress(input, event);\n      if (!input.defaultPrevented) {\n        this.press(input, event);\n      }\n      this.endHover(input, event);\n    }\n  },\n\n  onTouchCancel(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.cancelPress(input, event);\n      this.endHover(input, event);\n    }\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onTouchStart = gesture.onTouchStart.bind(gesture);\n    gesture.onTouchMove = gesture.onTouchMove.bind(gesture);\n    gesture.onTouchEnd = gesture.onTouchEnd.bind(gesture);\n    gesture.onTouchCancel = gesture.onTouchCancel.bind(gesture);\n    return gesture;\n  },\n}))();\n\n/** @internal */\nexport interface MousePositionGesture<R = any, V extends View = View> extends PositionGesture<R, V> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: PositionGestureInput, event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseEnter(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseLeave(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseDown(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseMove(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseUp(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseLeaveDocument(event: MouseEvent): void;\n}\n\n/** @internal */\nexport const MousePositionGesture = (<R, V extends View, G extends MousePositionGesture<any, any>>() => PositionGesture.extend<MousePositionGesture<R, V>, PositionGestureClass<G>>(\"MousePositionGesture\", {\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"mouseenter\", this.onMouseEnter as EventListener);\n    view.addEventListener(\"mouseleave\", this.onMouseLeave as EventListener);\n    view.addEventListener(\"mousedown\", this.onMouseDown as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"mouseenter\", this.onMouseEnter as EventListener);\n    view.removeEventListener(\"mouseleave\", this.onMouseLeave as EventListener);\n    view.removeEventListener(\"mousedown\", this.onMouseDown as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    document.body.addEventListener(\"mousemove\", this.onMouseMove);\n    document.body.addEventListener(\"mouseup\", this.onMouseUp);\n    document.body.addEventListener(\"mouseleave\", this.onMouseLeaveDocument);\n  },\n\n  detachPressEvents(view: V): void {\n    document.body.removeEventListener(\"mousemove\", this.onMouseMove);\n    document.body.removeEventListener(\"mouseup\", this.onMouseUp);\n    document.body.removeEventListener(\"mouseleave\", this.onMouseLeaveDocument);\n  },\n\n  updateInput(input: PositionGestureInput, event: MouseEvent): void {\n    input.target = event.target;\n    input.button = event.button;\n    input.buttons = event.buttons;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = event.clientX - input.x;\n    input.dy = event.clientY - input.y;\n    input.dt = event.timeStamp - input.y;\n    input.x = event.clientX;\n    input.y = event.clientY;\n    input.t = event.timeStamp;\n  },\n\n  onMouseEnter(event: MouseEvent): void {\n    if (event.buttons !== 0) {\n      return;\n    }\n    const input = this.getOrCreateInput(\"mouse\", \"mouse\", true, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.hovering) {\n      this.beginHover(input, event);\n    }\n  },\n\n  onMouseLeave(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endHover(input, event);\n  },\n\n  onMouseDown(event: MouseEvent): void {\n    const input = this.getOrCreateInput(\"mouse\", \"mouse\", true, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.pressing) {\n      this.beginPress(input, event);\n    }\n    if (event.button !== 0) {\n      this.cancelPress(input, event);\n    }\n  },\n\n  onMouseMove(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.movePress(input, event);\n  },\n\n  onMouseUp(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endPress(input, event);\n    if (!input.defaultPrevented && event.button === 0) {\n      this.press(input, event);\n    }\n  },\n\n  onMouseLeaveDocument(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n    this.endHover(input, event);\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onMouseEnter = gesture.onMouseEnter.bind(gesture);\n    gesture.onMouseLeave = gesture.onMouseLeave.bind(gesture);\n    gesture.onMouseDown = gesture.onMouseDown.bind(gesture);\n    gesture.onMouseMove = gesture.onMouseMove.bind(gesture);\n    gesture.onMouseUp = gesture.onMouseUp.bind(gesture);\n    gesture.onMouseLeaveDocument = gesture.onMouseLeaveDocument.bind(gesture);\n    return gesture;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport {View} from \"./View\";\nimport type {GestureInputType} from \"./Gesture\";\nimport {GestureInput} from \"./Gesture\";\nimport {PositionGestureInput} from \"./PositionGesture\";\nimport type {PositionGestureDescriptor} from \"./PositionGesture\";\nimport type {PositionGestureClass} from \"./PositionGesture\";\nimport {PositionGesture} from \"./PositionGesture\";\n\n/** @public */\nexport class MomentumGestureInput extends PositionGestureInput {\n  vx: number;\n  vy: number;\n  ax: number;\n  ay: number;\n\n  /** @internal */\n  readonly path: {x: number; y: number; t: number;}[];\n  coasting: boolean;\n\n  constructor(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number) {\n    super(inputId, inputType, isPrimary, x, y, t);\n    this.vx = 0;\n    this.vy = 0;\n    this.ax = 0;\n    this.ay = 0;\n    this.path = [];\n    this.coasting = false;\n  }\n\n  /** @internal */\n  updatePosition(hysteresis: number): void {\n    const path = this.path;\n    const x = this.x;\n    const y = this.y;\n    const t = this.t;\n    path.push({x, y, t});\n    while (path.length > 1 && t - path[0]!.t > hysteresis) {\n      path.shift();\n    }\n  }\n\n  /** @internal */\n  deriveVelocity(vMax: number): void {\n    const p0 = this.path[0]!;\n    const p1 = this.path[this.path.length - 1]!;\n    if (p1 !== void 0 && p1 !== p0) {\n      const dt = p1.t - p0.t;\n      let vx: number;\n      let vy: number;\n      if (dt !== 0) {\n        vx = (p1.x - p0.x) / dt;\n        vy = (p1.y - p0.y) / dt;\n        const v2 = vx * vx + vy * vy;\n        const vMax2 = vMax * vMax;\n        if (vMax2 < v2) {\n          const v = Math.sqrt(v2);\n          vx = vx * vMax / v;\n          vy = vy * vMax / v;\n        }\n      } else {\n        vx = 0;\n        vy = 0;\n      }\n      this.vx = vx;\n      this.vy = vy;\n    } else if (p0 !== void 0) {\n      this.vx = 0;\n      this.vy = 0;\n    }\n  }\n\n  /** @internal */\n  integrateVelocity(t: number): void {\n    const dt = t - this.t;\n    if (dt === 0) {\n      return;\n    }\n\n    let vx = this.vx + this.ax * dt;\n    let x: number;\n    if (vx < 0 === this.vx < 0) {\n      x = this.x + this.vx * dt + 0.5 * (this.ax * dt * dt);\n    } else {\n      x = this.x - (this.vx * this.vx) / (2 * this.ax);\n      vx = 0;\n      this.ax = 0;\n    }\n\n    let vy = this.vy + this.ay * dt;\n    let y: number;\n    if (vy < 0 === this.vy < 0) {\n      y = this.y + this.vy * dt + 0.5 * (this.ay * dt * dt);\n    } else {\n      y = this.y - (this.vy * this.vy) / (2 * this.ay);\n      vy = 0;\n      this.ay = 0;\n    }\n\n    this.dx = x - this.x;\n    this.dy = y - this.y;\n    this.dt = dt;\n    this.x = x;\n    this.y = y;\n    this.t = t;\n    this.vx = vx;\n    this.vy = vy;\n  }\n}\n\n/** @public */\nexport interface MomentumGestureDescriptor<R, V extends View> extends PositionGestureDescriptor<R, V> {\n  extends?: Proto<MomentumGesture<any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface MomentumGestureClass<G extends MomentumGesture<any, any> = MomentumGesture> extends PositionGestureClass<G> {\n}\n\n/** @public */\nexport interface MomentumGesture<R = any, V extends View = View> extends PositionGesture<R, V> {\n  /** @override */\n  get descriptorType(): Proto<MomentumGestureDescriptor<R, V>>;\n\n  /** @internal @override */\n  readonly inputs: {readonly [inputId: string]: MomentumGestureInput | undefined};\n\n  /** @override */\n  getInput(inputId: string | number): MomentumGestureInput | null;\n\n  /** @internal @override */\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number): MomentumGestureInput;\n\n  /** @internal @override */\n  getOrCreateInput(inputId: string | number, inputType: GestureInputType, isPrimary: boolean,\n                   x: number, y: number, t: number): MomentumGestureInput;\n\n  /** @internal @override */\n  clearInput(input: MomentumGestureInput): void;\n\n  /** @internal @override */\n  clearInputs(): void;\n\n  /** @internal @override */\n  resetInput(input: MomentumGestureInput): void;\n\n  /** @protected */\n  initHysteresis(): number;\n\n  /**\n   * The time delta for velocity derivation, in milliseconds.\n   */\n  hysteresis: number;\n\n  /** @protected */\n  initAcceleration(): number;\n\n  /**\n   * The magnitude of the deceleration on coasting input points in,\n   * pixels/millisecond^2. An acceleration of zero disables coasting.\n   */\n  acceleration: number;\n\n  /** @protected */\n  initVelocityMax(): number;\n\n  /**\n   * The maximum magnitude of the velocity of coasting input points,\n   * in pixels/millisecond.\n   */\n  velocityMax: number;\n\n  /** @internal */\n  viewWillAnimate(view: View): void;\n\n  /** @internal */\n  interrupt(event: Event | null): void;\n\n  /** @internal */\n  cancel(event: Event | null): void;\n\n  /** @internal */\n  startInteracting(): void;\n\n  /** @protected */\n  willStartInteracting(): void;\n\n  /** @protected */\n  onStartInteracting(): void;\n\n  /** @protected */\n  didStartInteracting(): void;\n\n  /** @internal */\n  stopInteracting(): void;\n\n  /** @protected */\n  willStopInteracting(): void;\n\n  /** @protected */\n  onStopInteracting(): void;\n\n  /** @protected */\n  didStopInteracting(): void;\n\n  /** @internal @override */\n  onStartPressing(): void;\n\n  /** @internal @override */\n  onStopPressing(): void;\n\n  /** @internal @override */\n  beginPress(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected @override */\n  onBeginPress(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected @override */\n  onMovePress(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected @override */\n  willEndPress(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected @override */\n  onEndPress(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected @override */\n  onCancelPress(input: MomentumGestureInput, event: Event | null): void;\n\n  readonly coastCount: number;\n\n  get coasting(): boolean;\n\n  /** @internal */\n  startCoasting(): void;\n\n  /** @protected */\n  willStartCoasting(): void;\n\n  /** @protected */\n  onStartCoasting(): void;\n\n  /** @protected */\n  didStartCoasting(): void;\n\n  /** @internal */\n  stopCoasting(): void;\n\n  /** @protected */\n  willStopCoasting(): void;\n\n  /** @protected */\n  onStopCoasting(): void;\n\n  /** @protected */\n  didStopCoasting(): void;\n\n  /** @internal */\n  beginCoast(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willBeginCoast(input: MomentumGestureInput, event: Event | null): boolean | void;\n\n  /** @protected */\n  onBeginCoast(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didBeginCoast(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @internal */\n  endCoast(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected */\n  willEndCoast(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected */\n  onEndCoast(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @protected */\n  didEndCoast(input: MomentumGestureInput, event: Event | null): void;\n\n  /** @internal */\n  doCoast(t: number): void;\n\n  /** @protected */\n  willCoast(): void;\n\n  /** @protected */\n  onCoast(): void;\n\n  /** @protected */\n  didCoast(): void;\n\n  /** @internal */\n  integrate(t: number): void;\n}\n\n/** @public */\nexport const MomentumGesture = (<R, V extends View, G extends MomentumGesture<any, any>>() => PositionGesture.extend<MomentumGesture<R, V>, MomentumGestureClass<G>>(\"MomentumGesture\", {\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number): MomentumGestureInput {\n    return new MomentumGestureInput(inputId, inputType, isPrimary, x, y, t);\n  },\n\n  clearInput(input: MomentumGestureInput): void {\n    if (!input.coasting) {\n      super.clearInput(input);\n    }\n  },\n\n  clearInputs(): void {\n    super.clearInputs();\n    (this as Mutable<typeof this>).coastCount = 0;\n  },\n\n  resetInput(input: MomentumGestureInput): void {\n    if (input.coasting) {\n      this.endCoast(input, null);\n    }\n    super.resetInput(input);\n  },\n\n  hysteresis: 67,\n\n  initHysteresis(): number {\n    return (Object.getPrototypeOf(this) as MomentumGesture).hysteresis;\n  },\n\n  acceleration: 0.00175,\n\n  initAcceleration(): number {\n    return (Object.getPrototypeOf(this) as MomentumGesture).acceleration;\n  },\n\n  velocityMax: 1.75,\n\n  initVelocityMax(): number {\n    return (Object.getPrototypeOf(this) as MomentumGesture).velocityMax;\n  },\n\n  viewWillAnimate(view: View): void {\n    this.doCoast(view.updateTime);\n  },\n\n  interrupt(event: Event | null): void {\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      this.endCoast(input, event);\n    }\n  },\n\n  cancel(event: Event | null): void {\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      this.endPress(input, event);\n      this.endCoast(input, event);\n    }\n  },\n\n  startInteracting(): void {\n    this.willStartInteracting();\n    this.onStartInteracting();\n    this.didStartInteracting();\n  },\n\n  willStartInteracting(): void {\n    // hook\n  },\n\n  onStartInteracting(): void {\n    // hook\n  },\n\n  didStartInteracting(): void {\n    // hook\n  },\n\n  stopInteracting(): void {\n    this.willStopInteracting();\n    this.onStopInteracting();\n    this.didStopInteracting();\n  },\n\n  willStopInteracting(): void {\n    // hook\n  },\n\n  onStopInteracting(): void {\n    // hook\n  },\n\n  didStopInteracting(): void {\n    // hook\n  },\n\n  onStartPressing(): void {\n    super.onStartPressing();\n    if (this.coastCount === 0) {\n      this.startInteracting();\n    }\n  },\n\n  onStopPressing(): void {\n    super.onStopPressing();\n    if (this.coastCount === 0) {\n      this.stopInteracting();\n    }\n  },\n\n  beginPress(input: MomentumGestureInput, event: Event | null): void {\n    super.beginPress(input, event);\n    this.interrupt(event);\n  },\n\n  onBeginPress(input: MomentumGestureInput, event: Event | null): void {\n    super.onBeginPress(input, event);\n    input.updatePosition(this.hysteresis);\n    input.deriveVelocity(this.velocityMax);\n  },\n\n  onMovePress(input: MomentumGestureInput, event: Event | null): void {\n    super.onMovePress(input, event);\n    input.updatePosition(this.hysteresis);\n    input.deriveVelocity(this.velocityMax);\n  },\n\n  willEndPress(input: MomentumGestureInput, event: Event | null): void {\n    super.willEndPress(input, event);\n    this.beginCoast(input, event);\n  },\n\n  onEndPress(input: MomentumGestureInput, event: Event | null): void {\n    super.onEndPress(input, event);\n    input.updatePosition(this.hysteresis);\n    input.deriveVelocity(this.velocityMax);\n  },\n\n  onCancelPress(input: MomentumGestureInput, event: Event | null): void {\n    super.onCancelPress(input, event);\n    input.updatePosition(this.hysteresis);\n    input.deriveVelocity(this.velocityMax);\n  },\n\n  get coasting(): boolean {\n    return this.coastCount !== 0;\n  },\n\n  startCoasting(): void {\n    this.willStartCoasting();\n    this.onStartCoasting();\n    this.didStartCoasting();\n  },\n\n  willStartCoasting(): void {\n    // hook\n  },\n\n  onStartCoasting(): void {\n    if (this.pressCount === 0) {\n      this.startInteracting();\n    }\n    if (this.view !== null) {\n      this.view.requireUpdate(View.NeedsAnimate);\n    }\n  },\n\n  didStartCoasting(): void {\n    // hook\n  },\n\n  stopCoasting(): void {\n    this.willStopCoasting();\n    this.onStopCoasting();\n    this.didStopCoasting();\n  },\n\n  willStopCoasting(): void {\n    // hook\n  },\n\n  onStopCoasting(): void {\n    if (this.pressCount === 0) {\n      this.stopInteracting();\n    }\n  },\n\n  didStopCoasting(): void {\n    // hook\n  },\n\n  beginCoast(input: MomentumGestureInput, event: Event | null): void {\n    if (input.coasting || (input.vx === 0 && input.vy === 0)) {\n      return;\n    }\n    const angle = Math.atan2(Math.abs(input.vy), Math.abs(input.vx));\n    const a = this.acceleration;\n    const ax = (input.vx < 0 ? a : input.vx > 0 ? -a : 0) * Math.cos(angle);\n    const ay = (input.vy < 0 ? a : input.vy > 0 ? -a : 0) * Math.sin(angle);\n    if (ax === 0 && ay === 0) {\n      return;\n    }\n    input.ax = ax;\n    input.ay = ay;\n    let allowCoast = this.willBeginCoast(input, event);\n    if (allowCoast === void 0) {\n      allowCoast = true;\n    }\n    if (!allowCoast) {\n      return;\n    }\n    input.coasting = true;\n    (this as Mutable<typeof this>).coastCount += 1;\n    this.onBeginCoast(input, event);\n    this.didBeginCoast(input, event);\n    if (this.coastCount === 1) {\n      this.startCoasting();\n    }\n  },\n\n  willBeginCoast(input: MomentumGestureInput, event: Event | null): boolean | void {\n    // hook\n  },\n\n  onBeginCoast(input: MomentumGestureInput, event: Event | null): void {\n    input.x0 = input.x;\n    input.y0 = input.y;\n    input.t0 = input.t;\n    input.dx = 0;\n    input.dy = 0;\n    input.dt = 0;\n  },\n\n  didBeginCoast(input: MomentumGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  endCoast(input: MomentumGestureInput, event: Event | null): void {\n    if (!input.coasting) {\n      return;\n    }\n    this.willEndCoast(input, event);\n    input.coasting = false;\n    (this as Mutable<typeof this>).coastCount -= 1;\n    this.onEndCoast(input, event);\n    this.didEndCoast(input, event);\n    if (this.coastCount === 0) {\n      this.stopCoasting();\n    }\n    this.clearInput(input);\n  },\n\n  willEndCoast(input: MomentumGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  onEndCoast(input: MomentumGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  didEndCoast(input: MomentumGestureInput, event: Event | null): void {\n    // hook\n  },\n\n  doCoast(t: number): void {\n    if (this.coastCount === 0) {\n      return;\n    }\n    this.willCoast();\n    this.integrate(t);\n    this.onCoast();\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (input.coasting && input.ax === 0 && input.ay === 0) {\n        this.endCoast(input, null);\n      }\n    }\n    this.didCoast();\n    if (this.coastCount !== 0 && this.view !== null) {\n      this.view.requireUpdate(View.NeedsAnimate);\n    }\n  },\n\n  willCoast(): void {\n    // hook\n  },\n\n  onCoast(): void {\n    // hook\n  },\n\n  didCoast(): void {\n    // hook\n  },\n\n  integrate(t: number): void {\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (input.coasting) {\n        input.integrateVelocity(t);\n      }\n    }\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    (gesture as Mutable<typeof gesture>).coastCount = 0;\n    gesture.hysteresis = gesture.initHysteresis();\n    gesture.acceleration = gesture.initAcceleration();\n    gesture.velocityMax = gesture.initVelocityMax();\n    return gesture;\n  },\n\n  specialize(template: G extends {readonly descriptorType?: Proto<infer D>} ? D : never): FastenerClass<G> {\n    let superClass = template.extends as FastenerClass<G> | null | undefined;\n    if (superClass === void 0 || superClass === null) {\n      const method = template.method;\n      if (method === \"pointer\") {\n        superClass = PointerMomentumGesture as unknown as FastenerClass<G>;\n      } else if (method === \"touch\") {\n        superClass = TouchMomentumGesture as unknown as FastenerClass<G>;\n      } else if (method === \"mouse\") {\n        superClass = MouseMomentumGesture as unknown as FastenerClass<G>;\n      } else if (typeof PointerEvent !== \"undefined\") {\n        superClass = PointerMomentumGesture as unknown as FastenerClass<G>;\n      } else if (typeof TouchEvent !== \"undefined\") {\n        superClass = TouchMomentumGesture as unknown as FastenerClass<G>;\n      } else {\n        superClass = MouseMomentumGesture as unknown as FastenerClass<G>;\n      }\n    }\n    return superClass;\n  },\n}))();\n\n/** @internal */\nexport interface PointerMomentumGesture<R = any, V extends View = View> extends MomentumGesture<R, V> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: MomentumGestureInput, event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerEnter(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerLeave(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerDown(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerMove(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerUp(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerCancel(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerLeaveDocument(event: PointerEvent): void;\n}\n\n/** @internal */\nexport const PointerMomentumGesture = (<R, V extends View, G extends PointerMomentumGesture<any, any>>() => MomentumGesture.extend<PointerMomentumGesture<R, V>, MomentumGestureClass<G>>(\"PointerMomentumGesture\", {\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"pointerenter\", this.onPointerEnter as EventListener);\n    view.addEventListener(\"pointerleave\", this.onPointerLeave as EventListener);\n    view.addEventListener(\"pointerdown\", this.onPointerDown as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"pointerenter\", this.onPointerEnter as EventListener);\n    view.removeEventListener(\"pointerleave\", this.onPointerLeave as EventListener);\n    view.removeEventListener(\"pointerdown\", this.onPointerDown as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    document.body.addEventListener(\"pointermove\", this.onPointerMove);\n    document.body.addEventListener(\"pointerup\", this.onPointerUp);\n    document.body.addEventListener(\"pointercancel\", this.onPointerCancel);\n    document.body.addEventListener(\"pointerleave\", this.onPointerLeaveDocument);\n  },\n\n  detachPressEvents(view: V): void {\n    document.body.removeEventListener(\"pointermove\", this.onPointerMove);\n    document.body.removeEventListener(\"pointerup\", this.onPointerUp);\n    document.body.removeEventListener(\"pointercancel\", this.onPointerCancel);\n    document.body.removeEventListener(\"pointerleave\", this.onPointerLeaveDocument);\n  },\n\n  updateInput(input: MomentumGestureInput, event: PointerEvent): void {\n    input.target = event.target;\n    input.button = event.button;\n    input.buttons = event.buttons;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = event.clientX - input.x;\n    input.dy = event.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = event.clientX;\n    input.y = event.clientY;\n    input.t = event.timeStamp;\n\n    input.width = event.width;\n    input.height = event.height;\n    input.tiltX = event.tiltX;\n    input.tiltY = event.tiltY;\n    input.twist = event.twist;\n    input.pressure = event.pressure;\n    input.tangentialPressure = event.tangentialPressure;\n  },\n\n  onPointerEnter(event: PointerEvent): void {\n    if (event.pointerType !== \"mouse\" || event.buttons !== 0) {\n      return;\n    }\n    const input = this.getOrCreateInput(event.pointerId, GestureInput.pointerInputType(event.pointerType),\n                                        event.isPrimary, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.hovering) {\n      this.beginHover(input, event);\n    }\n  },\n\n  onPointerLeave(event: PointerEvent): void {\n    if (event.pointerType !== \"mouse\") {\n      return;\n    }\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endHover(input, event);\n  },\n\n  onPointerDown(event: PointerEvent): void {\n    const input = this.getOrCreateInput(event.pointerId, GestureInput.pointerInputType(event.pointerType),\n                                        event.isPrimary, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.pressing) {\n      this.beginPress(input, event);\n    }\n    if (event.pointerType === \"mouse\" && event.button !== 0) {\n      this.cancelPress(input, event);\n    }\n  },\n\n  onPointerMove(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.movePress(input, event);\n  },\n\n  onPointerUp(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endPress(input, event);\n    if (!input.defaultPrevented && event.button === 0) {\n      this.press(input, event);\n    }\n  },\n\n  onPointerCancel(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n  },\n\n  onPointerLeaveDocument(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n    this.endHover(input, event);\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onPointerEnter = gesture.onPointerEnter.bind(gesture);\n    gesture.onPointerLeave = gesture.onPointerLeave.bind(gesture);\n    gesture.onPointerDown = gesture.onPointerDown.bind(gesture);\n    gesture.onPointerMove = gesture.onPointerMove.bind(gesture);\n    gesture.onPointerUp = gesture.onPointerUp.bind(gesture);\n    gesture.onPointerCancel = gesture.onPointerCancel.bind(gesture);\n    gesture.onPointerLeaveDocument = gesture.onPointerLeaveDocument.bind(gesture);\n    return gesture;\n  },\n}))();\n\n/** @internal */\nexport interface TouchMomentumGesture<R = any, V extends View = View> extends MomentumGesture<R, V> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: MomentumGestureInput, event: TouchEvent, touch: Touch): void;\n\n  /** @internal @protected */\n  onTouchStart(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchMove(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchEnd(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchCancel(event: TouchEvent): void;\n}\n\n/** @internal */\nexport const TouchMomentumGesture = (<R, V extends View, G extends TouchMomentumGesture<any, any>>() => MomentumGesture.extend<TouchMomentumGesture<R, V>, MomentumGestureClass<G>>(\"TouchMomentumGesture\", {\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"touchstart\", this.onTouchStart as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"touchstart\", this.onTouchStart as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    view.addEventListener(\"touchmove\", this.onTouchMove as EventListener);\n    view.addEventListener(\"touchend\", this.onTouchEnd as EventListener);\n    view.addEventListener(\"touchcancel\", this.onTouchCancel as EventListener);\n  },\n\n  detachPressEvents(view: V): void {\n    view.removeEventListener(\"touchmove\", this.onTouchMove as EventListener);\n    view.removeEventListener(\"touchend\", this.onTouchEnd as EventListener);\n    view.removeEventListener(\"touchcancel\", this.onTouchCancel as EventListener);\n  },\n\n  updateInput(input: MomentumGestureInput, event: TouchEvent, touch: Touch): void {\n    input.target = touch.target;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = touch.clientX - input.x;\n    input.dy = touch.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = touch.clientX;\n    input.y = touch.clientY;\n    input.t = event.timeStamp;\n  },\n\n  onTouchStart(event: TouchEvent): void {\n    const touches = event.targetTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getOrCreateInput(touch.identifier, \"touch\", false, touch.clientX, touch.clientY, event.timeStamp);\n      this.updateInput(input, event, touch);\n      if (!input.pressing) {\n        this.beginPress(input, event);\n      }\n    }\n  },\n\n  onTouchMove(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.movePress(input, event);\n    }\n  },\n\n  onTouchEnd(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.endPress(input, event);\n      if (!input.defaultPrevented) {\n        this.press(input, event);\n      }\n      this.endHover(input, event);\n    }\n  },\n\n  onTouchCancel(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.cancelPress(input, event);\n      this.endHover(input, event);\n    }\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onTouchStart = gesture.onTouchStart.bind(gesture);\n    gesture.onTouchMove = gesture.onTouchMove.bind(gesture);\n    gesture.onTouchEnd = gesture.onTouchEnd.bind(gesture);\n    gesture.onTouchCancel = gesture.onTouchCancel.bind(gesture);\n    return gesture;\n  },\n}))();\n\n/** @internal */\nexport interface MouseMomentumGesture<R = any, V extends View = View> extends MomentumGesture<R, V> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: MomentumGestureInput, event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseEnter(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseLeave(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseDown(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseMove(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseUp(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseLeaveDocument(event: MouseEvent): void;\n}\n\n/** @internal */\nexport const MouseMomentumGesture = (<R, V extends View, G extends MouseMomentumGesture<any, any>>() => MomentumGesture.extend<MouseMomentumGesture<R, V>, MomentumGestureClass<G>>(\"MouseMomentumGesture\", {\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"mouseenter\", this.onMouseEnter as EventListener);\n    view.addEventListener(\"mouseleave\", this.onMouseLeave as EventListener);\n    view.addEventListener(\"mousedown\", this.onMouseDown as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"mouseenter\", this.onMouseEnter as EventListener);\n    view.removeEventListener(\"mouseleave\", this.onMouseLeave as EventListener);\n    view.removeEventListener(\"mousedown\", this.onMouseDown as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    document.body.addEventListener(\"mousemove\", this.onMouseMove);\n    document.body.addEventListener(\"mouseup\", this.onMouseUp);\n    document.body.addEventListener(\"mouseleave\", this.onMouseLeaveDocument);\n  },\n\n  detachPressEvents(view: V): void {\n    document.body.removeEventListener(\"mousemove\", this.onMouseMove);\n    document.body.removeEventListener(\"mouseup\", this.onMouseUp);\n    document.body.removeEventListener(\"mouseleave\", this.onMouseLeaveDocument);\n  },\n\n  updateInput(input: MomentumGestureInput, event: MouseEvent): void {\n    input.target = event.target;\n    input.button = event.button;\n    input.buttons = event.buttons;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = event.clientX - input.x;\n    input.dy = event.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = event.clientX;\n    input.y = event.clientY;\n    input.t = event.timeStamp;\n  },\n\n  onMouseEnter(event: MouseEvent): void {\n    if (event.buttons !== 0) {\n      return;\n    }\n    const input = this.getOrCreateInput(\"mouse\", \"mouse\", true, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.hovering) {\n      this.beginHover(input, event);\n    }\n  },\n\n  onMouseLeave(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endHover(input, event);\n  },\n\n  onMouseDown(event: MouseEvent): void {\n    const input = this.getOrCreateInput(\"mouse\", \"mouse\", true, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.pressing) {\n      this.beginPress(input, event);\n    }\n    if (event.button !== 0) {\n      this.cancelPress(input, event);\n    }\n  },\n\n  onMouseMove(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.movePress(input, event);\n  },\n\n  onMouseUp(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endPress(input, event);\n    if (!input.defaultPrevented && event.button === 0) {\n      this.press(input, event);\n    }\n  },\n\n  onMouseLeaveDocument(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n    this.endHover(input, event);\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onMouseEnter = gesture.onMouseEnter.bind(gesture);\n    gesture.onMouseLeave = gesture.onMouseLeave.bind(gesture);\n    gesture.onMouseDown = gesture.onMouseDown.bind(gesture);\n    gesture.onMouseMove = gesture.onMouseMove.bind(gesture);\n    gesture.onMouseUp = gesture.onMouseUp.bind(gesture);\n    gesture.onMouseLeaveDocument = gesture.onMouseLeaveDocument.bind(gesture);\n    return gesture;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {ContinuousScale} from \"@swim/util\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport type {R2Box} from \"@swim/math\";\nimport {View} from \"./View\";\nimport type {GestureInputType} from \"./Gesture\";\nimport {GestureInput} from \"./Gesture\";\nimport {MomentumGestureInput} from \"./MomentumGesture\";\nimport type {MomentumGestureDescriptor} from \"./MomentumGesture\";\nimport type {MomentumGestureClass} from \"./MomentumGesture\";\nimport {MomentumGesture} from \"./MomentumGesture\";\n\n/** @public */\nexport class ScaleGestureInput<X = any, Y = any> extends MomentumGestureInput {\n  xCoord: X | undefined;\n  yCoord: Y | undefined;\n  disableX: boolean;\n  disableY: boolean;\n\n  constructor(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number) {\n    super(inputId, inputType, isPrimary, x, y, t);\n    this.xCoord = void 0;\n    this.yCoord = void 0;\n    this.disableX = false;\n    this.disableY = false;\n  }\n}\n\n/** @public */\nexport interface ScaleGestureDescriptor<R, V extends View, X, Y> extends MomentumGestureDescriptor<R, V> {\n  extends?: Proto<ScaleGesture<any, any, any, any>> | boolean | null;\n  preserveAspectRatio?: boolean;\n  wheel?: boolean;\n}\n\n/** @public */\nexport interface ScaleGestureClass<G extends ScaleGesture = ScaleGesture> extends MomentumGestureClass<G> {\n  /** @internal */\n  readonly PreserveAspectRatioFlag: FastenerFlags;\n  /** @internal */\n  readonly WheelFlag: FastenerFlags;\n  /** @internal */\n  readonly NeedsRescale: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ScaleGesture<R = any, V extends View = View, X = any, Y = any> extends MomentumGesture<R, V> {\n  /** @override */\n  get descriptorType(): Proto<ScaleGestureDescriptor<R, V, X, Y>>;\n\n  /** @internal @override */\n  readonly inputs: {readonly [inputId: string]: ScaleGestureInput<X, Y> | undefined};\n\n  /** @override */\n  getInput(inputId: string | number): ScaleGestureInput<X, Y> | null;\n\n  /** @internal @override */\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n              x: number, y: number, t: number): ScaleGestureInput<X, Y>;\n\n  /** @internal @override */\n  getOrCreateInput(inputId: string | number, inputType: GestureInputType, isPrimary: boolean,\n                   x: number, y: number, t: number): ScaleGestureInput<X, Y>;\n\n  /** @internal @override */\n  clearInput(input: ScaleGestureInput<X, Y>): void;\n\n  /** @internal @override */\n  clearInputs(): void;\n\n  /** @internal @override */\n  resetInput(input: ScaleGestureInput<X, Y>): void;\n\n  /** @protected */\n  initDistanceMin(): number;\n\n  /**\n   * The minimum radial distance between input positions, in pixels.\n   * Used to avoid scale gesture singularities.\n   */\n  distanceMin: number;\n\n  get preserveAspectRatio(): boolean;\n  set preserveAspectRatio(preserveAspectRatio: boolean);\n\n  get wheel(): boolean;\n  set wheel(wheel: boolean);\n\n  getXScale(): ContinuousScale<X, number> | null;\n\n  setXScale(xScale: ContinuousScale<X, number> | null, timing?: TimingLike | boolean): void;\n\n  getYScale(): ContinuousScale<Y, number> | null;\n\n  setYScale(yScale: ContinuousScale<Y, number> | null, timing?: TimingLike | boolean): void;\n\n  /** @internal */\n  clientToRangeX(clientX: number, xScale: ContinuousScale<X, number>, bounds: R2Box): number;\n\n  /** @internal */\n  clientToRangeY(clientY: number, yScale: ContinuousScale<Y, number>, bounds: R2Box): number;\n\n  /** @internal */\n  unscaleX(clientX: number, xScale: ContinuousScale<X, number>, bounds: R2Box): X;\n\n  /** @internal */\n  unscaleY(clientY: number, yScale: ContinuousScale<Y, number>, bounds: R2Box): Y;\n\n  /** @internal @override */\n  viewWillAnimate(view: View): void;\n\n  /** @protected @override */\n  onBeginPress(input: ScaleGestureInput<X, Y>, event: Event | null): void;\n\n  /** @protected @override */\n  onMovePress(input: ScaleGestureInput<X, Y>, event: Event | null): void;\n\n  /** @protected @override */\n  onEndPress(input: ScaleGestureInput<X, Y>, event: Event | null): void;\n\n  /** @protected @override */\n  onCancelPress(input: ScaleGestureInput<X, Y>, event: Event | null): void;\n\n  /** @internal @override */\n  beginCoast(input: ScaleGestureInput<X, Y>, event: Event | null): void;\n\n  /** @protected @override */\n  onBeginCoast(input: ScaleGestureInput<X, Y>, event: Event | null): void;\n\n  /** @protected @override */\n  onEndCoast(input: ScaleGestureInput<X, Y>, event: Event | null): void;\n\n  /** @protected @override */\n  onCoast(): void;\n\n  /** @internal */\n  updateInputDomain(input: ScaleGestureInput<X, Y>,\n                    xScale?: ContinuousScale<X, number> | null,\n                    yScale?: ContinuousScale<Y, number> | null,\n                    bounds?: R2Box): void;\n\n  /** @internal */\n  neutralizeX(): void;\n\n  /** @internal */\n  neutralizeY(): void;\n\n  /** @internal */\n  rescale(): void;\n\n  /** @internal */\n  rescaleRadial(oldXScale: ContinuousScale<X, number>,\n                oldYScale: ContinuousScale<Y, number>,\n                input0: ScaleGestureInput<X, Y>,\n                input1: ScaleGestureInput<X, Y>,\n                bounds: R2Box): void;\n\n  /** @internal */\n  rescaleXY(oldXScale: ContinuousScale<X, number>,\n            oldYScale: ContinuousScale<Y, number>,\n            input0: ScaleGestureInput<X, Y>,\n            input1: ScaleGestureInput<X, Y> | undefined,\n            bounds: R2Box): void;\n\n  /** @internal */\n  rescaleX(oldXScale: ContinuousScale<X, number>,\n           input0: ScaleGestureInput<X, Y>,\n           input1: ScaleGestureInput<X, Y> | undefined,\n           bounds: R2Box): void;\n\n  /** @internal */\n  rescaleY(oldYScale: ContinuousScale<Y, number>,\n           input0: ScaleGestureInput<X, Y>,\n           input1: ScaleGestureInput<X, Y> | undefined,\n           bounds: R2Box): void;\n\n  /** @internal */\n  conserveMomentum(input0: ScaleGestureInput<X, Y>): void;\n\n  /** @internal */\n  distributeXYMomentum(input0: ScaleGestureInput<X, Y>,\n                       input1: ScaleGestureInput<X, Y>): void;\n\n  /** @internal */\n  distributeXMomentum(input0: ScaleGestureInput<X, Y>,\n                      input1: ScaleGestureInput<X, Y>): void;\n\n  /** @internal */\n  distributeYMomentum(input0: ScaleGestureInput<X, Y>,\n                      input1: ScaleGestureInput<X, Y>): void;\n\n  /** @internal @override */\n  integrate(t: number): void;\n\n  /** @internal */\n  zoom(x: number, y: number, dz: number, event: Event | null): void;\n}\n\n/** @public */\nexport const ScaleGesture = (<R, V extends View, X, Y, G extends ScaleGesture<any, any, any, any>>() => MomentumGesture.extend<ScaleGesture<R, V, X, Y>, ScaleGestureClass<G>>(\"ScaleGesture\", {\n  createInput(inputId: string, inputType: GestureInputType, isPrimary: boolean,\n                                                       x: number, y: number, t: number): ScaleGestureInput<X, Y> {\n    return new ScaleGestureInput(inputId, inputType, isPrimary, x, y, t);\n  },\n\n  clearInputs(): void {\n    super.clearInputs();\n    this.setFlags(this.flags & ~ScaleGesture.NeedsRescale);\n  },\n\n  distanceMin: 10,\n\n  initDistanceMin(): number {\n    return (Object.getPrototypeOf(this) as ScaleGesture).distanceMin;\n  },\n\n  get preserveAspectRatio(): boolean {\n    return (this.flags & ScaleGesture.PreserveAspectRatioFlag) !== 0;\n  },\n\n  set preserveAspectRatio(preserveAspectRatio: boolean) {\n    if (preserveAspectRatio) {\n      this.setFlags(this.flags | ScaleGesture.PreserveAspectRatioFlag);\n    } else {\n      this.setFlags(this.flags & ~ScaleGesture.PreserveAspectRatioFlag);\n    }\n  },\n\n  get wheel(): boolean {\n    return (this.flags & ScaleGesture.WheelFlag) !== 0;\n  },\n\n  set wheel(wheel: boolean) {\n    if (wheel) {\n      this.setFlags(this.flags | ScaleGesture.WheelFlag);\n    } else {\n      this.setFlags(this.flags & ~ScaleGesture.WheelFlag);\n    }\n  },\n\n  getXScale(): ContinuousScale<X, number> | null {\n    return null; // hook\n  },\n\n  setXScale(xScale: ContinuousScale<X, number> | null, timing?: TimingLike | boolean): void {\n    // hook\n  },\n\n  getYScale(): ContinuousScale<Y, number> | null {\n    return null; // hook\n  },\n\n  setYScale(yScale: ContinuousScale<Y, number> | null, timing?: TimingLike | boolean): void {\n    // hook\n  },\n\n  clientToRangeX(clientX: number, xScale: ContinuousScale<X, number>, bounds: R2Box): number {\n    const viewX = clientX - bounds.xMin;\n    const xRange = xScale.range;\n    if (xRange[0] <= xRange[1]) {\n      return xRange[0] + viewX;\n    }\n    return bounds.xMax + viewX - xRange[0];\n  },\n\n  clientToRangeY(clientY: number, yScale: ContinuousScale<Y, number>, bounds: R2Box): number {\n    const viewY = clientY - bounds.yMin;\n    const yRange = yScale.range;\n    if (yRange[0] <= yRange[1]) {\n      return yRange[0] + viewY;\n    }\n    return bounds.yMax + viewY - yRange[0];\n  },\n\n  unscaleX(clientX: number, xScale: ContinuousScale<X, number>, bounds: R2Box): X {\n    return xScale.inverse(this.clientToRangeX(clientX, xScale, bounds));\n  },\n\n  unscaleY(clientY: number, yScale: ContinuousScale<Y, number>, bounds: R2Box): Y {\n    return yScale.inverse(this.clientToRangeY(clientY, yScale, bounds));\n  },\n\n  viewWillAnimate(view: View): void {\n    super.viewWillAnimate(view);\n    if ((this.flags & ScaleGesture.NeedsRescale) !== 0) {\n      this.rescale();\n    }\n  },\n\n  onBeginPress(input: ScaleGestureInput<X, Y>, event: Event | null): void {\n    super.onBeginPress(input, event);\n    this.updateInputDomain(input);\n    this.view!.requireUpdate(View.NeedsAnimate);\n    this.setFlags(this.flags | ScaleGesture.NeedsRescale);\n  },\n\n  onMovePress(input: ScaleGestureInput<X, Y>, event: Event | null): void {\n    super.onMovePress(input, event);\n    this.view!.requireUpdate(View.NeedsAnimate);\n    this.setFlags(this.flags | ScaleGesture.NeedsRescale);\n  },\n\n  onEndPress(input: ScaleGestureInput<X, Y>, event: Event | null): void {\n    super.onEndPress(input, event);\n    this.updateInputDomain(input);\n    this.view!.requireUpdate(View.NeedsAnimate);\n    this.setFlags(this.flags | ScaleGesture.NeedsRescale);\n  },\n\n  onCancelPress(input: ScaleGestureInput<X, Y>, event: Event | null): void {\n    super.onCancelPress(input, event);\n    this.updateInputDomain(input);\n    this.view!.requireUpdate(View.NeedsAnimate);\n    this.setFlags(this.flags | ScaleGesture.NeedsRescale);\n  },\n\n  beginCoast(input: ScaleGestureInput<X, Y>, event: Event | null): void {\n    if (this.coastCount < 2) {\n      super.beginCoast(input, event);\n    }\n  },\n\n  onBeginCoast(input: ScaleGestureInput<X, Y>, event: Event | null): void {\n    super.onBeginCoast(input, event);\n    this.updateInputDomain(input);\n    this.conserveMomentum(input);\n    this.view!.requireUpdate(View.NeedsAnimate);\n    this.setFlags(this.flags | ScaleGesture.NeedsRescale);\n  },\n\n  onEndCoast(input: ScaleGestureInput<X, Y>, event: Event | null): void {\n    super.onEndCoast(input, event);\n    input.disableX = false;\n    input.disableY = false;\n    this.view!.requireUpdate(View.NeedsAnimate);\n    this.setFlags(this.flags | ScaleGesture.NeedsRescale);\n  },\n\n  onCoast(): void {\n    super.onCoast();\n    this.view!.requireUpdate(View.NeedsAnimate);\n    this.setFlags(this.flags | ScaleGesture.NeedsRescale);\n  },\n\n  updateInputDomain(input: ScaleGestureInput<X, Y>, xScale?: ContinuousScale<X, number> | null,\n                    yScale?: ContinuousScale<Y, number> | null, bounds?: R2Box): void {\n    if (xScale === void 0) {\n      xScale = this.getXScale();\n    }\n    if (xScale !== null) {\n      if (bounds === void 0) {\n        bounds = this.view!.clientBounds;\n      }\n      input.xCoord = this.unscaleX(input.x0, xScale, bounds);\n    }\n    if (yScale === void 0) {\n      yScale = this.getYScale();\n    }\n    if (yScale !== null) {\n      if (bounds === void 0) {\n        bounds = this.view!.clientBounds;\n      }\n      input.yCoord = this.unscaleY(input.y0, yScale, bounds);\n    }\n  },\n\n  neutralizeX(): void {\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (!input.coasting) {\n        continue;\n      }\n      input.disableX = true;\n      input.vx = 0;\n      input.ax = 0;\n    }\n  },\n\n  neutralizeY(): void {\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (!input.coasting) {\n        continue;\n      }\n      input.disableY = true;\n      input.vy = 0;\n      input.ay = 0;\n    }\n  },\n\n  rescale(): void {\n    let input0: ScaleGestureInput<X, Y> | undefined;\n    let input1: ScaleGestureInput<X, Y> | undefined;\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (!input.pressing && !input.coasting) {\n        continue;\n      } else if (input0 === void 0) {\n        input0 = input;\n      } else if (input1 === void 0) {\n        input1 = input;\n      } else if (input.t0 < input0.t0) {\n        input0 = input;\n      } else if (input.t0 < input1.t0) {\n        input1 = input;\n      }\n    }\n    if (input0 !== void 0) {\n      const bounds = this.view!.clientBounds;\n      const xScale = this.getXScale();\n      const yScale = this.getYScale();\n      if (xScale !== null && yScale !== null) {\n        if (input1 !== void 0 && this.preserveAspectRatio) {\n          this.rescaleRadial(xScale, yScale, input0, input1, bounds);\n        } else {\n          this.rescaleXY(xScale, yScale, input0, input1, bounds);\n        }\n      } else if (xScale !== null) {\n        this.rescaleX(xScale, input0, input1, bounds);\n      } else if (yScale !== null) {\n        this.rescaleY(yScale, input0, input1, bounds);\n      }\n    }\n    this.setFlags(this.flags & ~ScaleGesture.NeedsRescale);\n  },\n\n  rescaleRadial(oldXScale: ContinuousScale<X, number>, oldYScale: ContinuousScale<Y, number>,\n                input0: ScaleGestureInput<X, Y>, input1: ScaleGestureInput<X, Y>, bounds: R2Box): void {\n    const x0 = input0.xCoord!;\n    const y0 = input0.yCoord!;\n    const px0 = this.clientToRangeX(input0.x0, oldXScale, bounds);\n    const py0 = this.clientToRangeY(input0.y0, oldYScale, bounds);\n    const qx0 = this.clientToRangeX(input0.x, oldXScale, bounds);\n    const qy0 = this.clientToRangeY(input0.y, oldYScale, bounds);\n    const vx0 = input0.vx;\n    const vy0 = input0.vy;\n    const ax0 = input0.ax;\n    const ay0 = input0.ay;\n\n    const x1 = input1.xCoord!;\n    const y1 = input1.yCoord!;\n    const px1 = this.clientToRangeX(input1.x0, oldXScale, bounds);\n    const py1 = this.clientToRangeY(input1.y0, oldYScale, bounds);\n    const qx1 = this.clientToRangeX(input1.x, oldXScale, bounds);\n    const qy1 = this.clientToRangeY(input1.y, oldYScale, bounds);\n    const vx1 = input1.vx;\n    const vy1 = input1.vy;\n    const ax1 = input1.ax;\n    const ay1 = input1.ay;\n\n    // Compute the difference vector between previous input positions.\n    const dpx = px1 - px0;\n    const dpy = py1 - py0;\n    // Normalize the previous input distance vector.\n    const dp = Math.max(this.distanceMin, Math.sqrt(dpx * dpx + dpy * dpy));\n    const upx = dpx / dp;\n    const upy = dpy / dp;\n\n    // Compute the translation vectors from the previous input positions\n    // to the current input positions.\n    const dpqx0 = qx0 - px0;\n    const dpqy0 = qy0 - py0;\n    const dpqx1 = qx1 - px1;\n    const dpqy1 = qy1 - py1;\n\n    // Project the current input positions onto the unit vector separating\n    // the previous input positions.\n    const ip0 = dpqx0 * upx + dpqy0 * upy;\n    const ip1 = dpqx1 * upx + dpqy1 * upy;\n    const ix0 = ip0 * upx;\n    const iy0 = ip0 * upy;\n    const ix1 = ip1 * upx;\n    const iy1 = ip1 * upy;\n\n    // Project the current input positions onto the unit vector orthogonal\n    // to the previous input positions.\n    const jp0 = dpqx0 * upy + dpqy0 * -upx;\n    const jp1 = dpqx1 * upy + dpqy1 * -upx;\n    const jx0 = jp0 * upy;\n    const jy0 = jp0 * -upx;\n    const jx1 = jp1 * upy;\n    const jy1 = jp1 * -upx;\n    // Average the mean orthogonal projection of the input translations.\n    const jpx = (jx0 + jx1) / 2;\n    const jpy = (jy0 + jy1) / 2;\n\n    // Offset the previous input positions by the radial and mean orthogonal\n    // projections of the input translations.\n    const rx0 = px0 + ix0 + jpx;\n    const ry0 = py0 + iy0 + jpy;\n    const rx1 = px1 + ix1 + jpx;\n    const ry1 = py1 + iy1 + jpy;\n\n    // Project the velocity vectors onto the unit vector separating\n    // the previous input positions.\n    const iv0 = vx0 * upx + vy0 * upy;\n    const iv1 = vx1 * upx + vy1 * upy;\n    const ivx0 = iv0 * upx;\n    const ivy0 = iv0 * upy;\n    const ivx1 = iv1 * upx;\n    const ivy1 = iv1 * upy;\n\n    // Project the velocity vectors onto the unit vector orthogonal\n    // to the previous input positions.\n    const jv0 = vx0 * upy + vy0 * -upx;\n    const jv1 = vx1 * upy + vy1 * -upx;\n    const jvx0 = jv0 * upy;\n    const jvy0 = jv0 * -upx;\n    const jvx1 = jv1 * upy;\n    const jvy1 = jv1 * -upx;\n    // Average the mean orthogonal projection of the input velocity.\n    const jvx = (jvx0 + jvx1) / 2;\n    const jvy = (jvy0 + jvy1) / 2;\n\n    // Recombine the radial and mean orthogonal velocity components.\n    let rvx0 = ivx0 + jvx;\n    let rvy0 = ivy0 + jvy;\n    let rvx1 = ivx1 + jvx;\n    let rvy1 = ivy1 + jvy;\n\n    // Normalize the recombined velocity vectors.\n    const v0 = Math.sqrt(rvx0 * rvx0 + rvy0 * rvy0);\n    const v1 = Math.sqrt(rvx1 * rvx1 + rvy1 * rvy1);\n    const uvx0 = v0 !== 0 ? rvx0 / v0 : 0;\n    const uvy0 = v0 !== 0 ? rvy0 / v0 : 0;\n    const uvx1 = v1 !== 0 ? rvx1 / v1 : 0;\n    const uvy1 = v1 !== 0 ? rvy1 / v1 : 0;\n\n    // Scale the recombined velocity vectors back to their original magnitudes.\n    rvx0 = uvx0 * v0;\n    rvy0 = uvy0 * v0;\n    rvx1 = uvx1 * v1;\n    rvy1 = uvy1 * v1;\n\n    // Compute the magnitudes of the acceleration vectors.\n    const a0 = Math.sqrt(ax0 * ax0 + ay0 * ay0);\n    const a1 = Math.sqrt(ax1 * ax1 + ay1 * ay1);\n\n    // Rotate the acceleration vectors to opposite the updated velocity vectors.\n    const rax0 = a0 * -uvx0;\n    const ray0 = a0 * -uvy0;\n    const rax1 = a1 * -uvx1;\n    const ray1 = a1 * -uvy1;\n\n    let newXScale: ContinuousScale<X, number> | null = null;\n    const solvedXScale = oldXScale.solveDomain(x0, rx0, x1, rx1);\n    if (!solvedXScale.equals(oldXScale)) {\n      newXScale = solvedXScale;\n      this.setXScale(newXScale);\n    }\n\n    let newYScale: ContinuousScale<Y, number> | null = null;\n    const solvedYScale = oldYScale.solveDomain(y0, ry0, y1, ry1);\n    if (!solvedYScale.equals(oldYScale)) {\n      newYScale = solvedYScale;\n      this.setYScale(newYScale);\n    }\n\n    if (newXScale === null && newYScale === null) {\n      return;\n    }\n    if (newXScale !== null) {\n      input0.x0 = input0.x;\n      input0.dx = 0;\n      input0.vx = rvx0;\n      input0.ax = rax0;\n      input0.xCoord = this.unscaleX(input0.x0, newXScale, bounds);\n\n      input1.x0 = input1.x;\n      input1.dx = 0;\n      input1.vx = rvx1;\n      input1.ax = rax1;\n      input1.xCoord = this.unscaleX(input1.x0, newXScale, bounds);\n    }\n    if (newYScale !== null) {\n      input0.y0 = input0.y;\n      input0.dy = 0;\n      input0.vy = rvy0;\n      input0.ay = ray0;\n      input0.yCoord = this.unscaleY(input0.y0, newYScale, bounds);\n\n      input1.y0 = input1.y;\n      input1.dy = 0;\n      input1.vy = rvy1;\n      input1.ay = ray1;\n      input1.yCoord = this.unscaleY(input1.y0, newYScale, bounds);\n    }\n\n    if (this.inputCount <= 2) {\n      return;\n    }\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (input === input0 || input === input1) {\n        continue;\n      }\n      if (newXScale !== null) {\n        input.x0 = input.x;\n        input.dx = 0;\n        input.xCoord = this.unscaleX(input.x0, newXScale, bounds);\n      }\n      if (newYScale !== null) {\n        input.y0 = input.y;\n        input.dy = 0;\n        input.yCoord = this.unscaleY(input.y0, newYScale, bounds);\n      }\n    }\n  },\n\n  rescaleXY(oldXScale: ContinuousScale<X, number>, oldYScale: ContinuousScale<Y, number>,\n            input0: ScaleGestureInput<X, Y>, input1: ScaleGestureInput<X, Y> | undefined, bounds: R2Box): void {\n    const x0 = input0.xCoord!;\n    const y0 = input0.yCoord!;\n    let sx0 = this.clientToRangeX(input0.x, oldXScale, bounds);\n    let sy0 = this.clientToRangeY(input0.y, oldYScale, bounds);\n    let disableX = input0.disableX;\n    let disableY = input0.disableY;\n\n    let x1: X | undefined;\n    let y1: Y | undefined;\n    let sx1: number | undefined;\n    let sy1: number | undefined;\n\n    if (input1 !== void 0) {\n      x1 = input1.xCoord!;\n      y1 = input1.yCoord!;\n      sx1 = this.clientToRangeX(input1.x, oldXScale, bounds);\n      sy1 = this.clientToRangeY(input1.y, oldYScale, bounds);\n      disableX = disableX || input1.disableX;\n      disableY = disableY || input1.disableY;\n      const dsx = Math.abs(sx1 - sx0);\n      const dsy = Math.abs(sy1 - sy0);\n\n      const distanceMin = this.distanceMin;\n      if (dsx < distanceMin) {\n        const esx = (distanceMin - dsx) / 2;\n        if (sx0 <= sx1) {\n          sx0 -= esx;\n          sx1 += esx;\n        } else {\n          sx0 += esx;\n          sx1 -= esx;\n        }\n      }\n      if (dsy < distanceMin) {\n        const esy = (distanceMin - dsy) / 2;\n        if (sy0 <= sy1) {\n          sy0 -= esy;\n          sy1 += esy;\n        } else {\n          sy0 += esy;\n          sy1 -= esy;\n        }\n      }\n    }\n\n    let newXScale: ContinuousScale<X, number> | null = null;\n    if (!disableX) {\n      newXScale = oldXScale.solveDomain(x0, sx0, x1, sx1);\n      if (!newXScale.equals(oldXScale)) {\n        this.setXScale(newXScale);\n      }\n    }\n\n    let newYScale: ContinuousScale<Y, number> | null = null;\n    if (!disableY) {\n      newYScale = oldYScale.solveDomain(y0, sy0, y1, sy1);\n      if (!newYScale.equals(oldYScale)) {\n        this.setYScale(newYScale);\n      }\n    }\n\n    if ((newXScale === null && newYScale === null) || !this.preserveAspectRatio) {\n      return;\n    }\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (newXScale !== null) {\n        input.x0 = input.x;\n        input.dx = 0;\n        input.xCoord = this.unscaleX(input.x0, newXScale, bounds);\n      }\n      if (newYScale !== null) {\n        input.y0 = input.y;\n        input.dy = 0;\n        input.yCoord = this.unscaleY(input.y0, newYScale, bounds);\n      }\n    }\n  },\n\n  rescaleX(oldXScale: ContinuousScale<X, number>, input0: ScaleGestureInput<X, Y>,\n           input1: ScaleGestureInput<X, Y> | undefined, bounds: R2Box): void {\n    const x0 = input0.xCoord!;\n    let sx0 = this.clientToRangeX(input0.x, oldXScale, bounds);\n    let sx1: number | undefined;\n    let x1: X | undefined;\n    let disableX = input0.disableX;\n    if (input1 !== void 0) {\n      x1 = input1.xCoord!;\n      sx1 = this.clientToRangeX(input1.x, oldXScale, bounds);\n      disableX = disableX || input1.disableX;\n      const dsx = Math.abs(sx1 - sx0);\n      const distanceMin = this.distanceMin;\n      if (dsx < distanceMin) {\n        const esx = (distanceMin - dsx) / 2;\n        if (sx0 <= sx1) {\n          sx0 -= esx;\n          sx1 += esx;\n        } else {\n          sx0 += esx;\n          sx1 -= esx;\n        }\n      }\n    }\n    if (disableX) {\n      return;\n    }\n    const newXScale = oldXScale.solveDomain(x0, sx0, x1, sx1);\n    if (!newXScale.equals(oldXScale)) {\n      this.setXScale(newXScale);\n    }\n  },\n\n  rescaleY(oldYScale: ContinuousScale<Y, number>, input0: ScaleGestureInput<X, Y>,\n           input1: ScaleGestureInput<X, Y> | undefined, bounds: R2Box): void {\n    const y0 = input0.yCoord!;\n    let sy0 = this.clientToRangeY(input0.y, oldYScale, bounds);\n    let sy1: number | undefined;\n    let y1: Y | undefined;\n    let disableY = input0.disableY;\n    if (input1 !== void 0) {\n      y1 = input1.yCoord!;\n      sy1 = this.clientToRangeY(input1.y, oldYScale, bounds);\n      disableY = disableY || input1.disableY;\n      const dsy = Math.abs(sy1 - sy0);\n      const distanceMin = this.distanceMin;\n      if (dsy < distanceMin) {\n        const esy = (distanceMin - dsy) / 2;\n        if (sy0 <= sy1) {\n          sy0 -= esy;\n          sy1 += esy;\n        } else {\n          sy0 += esy;\n          sy1 -= esy;\n        }\n      }\n    }\n    if (disableY) {\n      return;\n    }\n    const newYScale = oldYScale.solveDomain(y0, sy0, y1, sy1);\n    if (!newYScale.equals(oldYScale)) {\n      this.setYScale(newYScale);\n    }\n  },\n\n  conserveMomentum(input0: ScaleGestureInput<X, Y>): void {\n    let input1: ScaleGestureInput<X, Y> | undefined;\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (!input.coasting) {\n        continue;\n      } else if (input1 === void 0) {\n        input1 = input;\n      } else if (input.t0 < input1.t0) {\n        input1 = input;\n      }\n    }\n    if (input1 === void 0) {\n      return;\n    }\n    const xScale = this.getXScale();\n    const yScale = this.getYScale();\n    if (xScale !== null && yScale !== null) {\n      this.distributeXYMomentum(input0, input1);\n    } else if (xScale !== null) {\n      this.distributeXMomentum(input0, input1);\n    } else if (yScale !== null) {\n      this.distributeYMomentum(input0, input1);\n    }\n  },\n\n  distributeXYMomentum(input0: ScaleGestureInput<X, Y>, input1: ScaleGestureInput<X, Y>): void {\n    const vx0 = input0.vx;\n    const vy0 = input0.vy;\n    const vx1 = input1.vx;\n    const vy1 = input1.vy;\n    const v0 = Math.sqrt(vx0 * vx0 + vy0 * vy0);\n    const v1 = Math.sqrt(vx1 * vx1 + vy1 * vy1);\n    const uvx0 = v0 !== 0 ? vx0 / v0 : 0;\n    const uvy0 = v0 !== 0 ? vy0 / v0 : 0;\n    const uvx1 = v1 !== 0 ? vx1 / v1 : 0;\n    const uvy1 = v1 !== 0 ? vy1 / v1 : 0;\n    const v = (v0 + v1) / 2;\n    input0.vx = uvx0 * v;\n    input0.vy = uvy0 * v;\n    input1.vx = uvx1 * v;\n    input1.vy = uvy1 * v;\n\n    const ax0 = input0.ax;\n    const ay0 = input0.ay;\n    const ax1 = input1.ax;\n    const ay1 = input1.ay;\n    const a0 = Math.sqrt(ax0 * ax0 + ay0 * ay0);\n    const a1 = Math.sqrt(ax1 * ax1 + ay1 * ay1);\n    const uax0 = a0 !== 0 ? ax0 / a0 : 0;\n    const uay0 = a0 !== 0 ? ay0 / a0 : 0;\n    const uax1 = a1 !== 0 ? ax1 / a1 : 0;\n    const uay1 = a1 !== 0 ? ay1 / a1 : 0;\n    const a = (a0 + a1) / 2;\n    input0.ax = uax0 * a;\n    input0.ay = uay0 * a;\n    input1.ax = uax1 * a;\n    input1.ay = uay1 * a;\n  },\n\n  distributeXMomentum(input0: ScaleGestureInput<X, Y>, input1: ScaleGestureInput<X, Y>): void {\n    const vx0 = input0.vx;\n    const vx1 = input1.vx;\n    const v0 = Math.abs(vx0);\n    const v1 = Math.abs(vx1);\n    const uvx0 = v0 !== 0 ? vx0 / v0 : 0;\n    const uvx1 = v1 !== 0 ? vx1 / v1 : 0;\n    const v = (v0 + v1) / 2;\n    input0.vx = uvx0 * v;\n    input1.vx = uvx1 * v;\n\n    const ax0 = input0.ax;\n    const ax1 = input1.ax;\n    const a0 = Math.abs(ax0);\n    const a1 = Math.abs(ax1);\n    const uax0 = a0 !== 0 ? ax0 / a0 : 0;\n    const uax1 = a1 !== 0 ? ax1 / a1 : 0;\n    const a = (a0 + a1) / 2;\n    input0.ax = uax0 * a;\n    input1.ax = uax1 * a;\n  },\n\n  distributeYMomentum(input0: ScaleGestureInput<X, Y>, input1: ScaleGestureInput<X, Y>): void {\n    const vy0 = input0.vy;\n    const vy1 = input1.vy;\n    const v0 = Math.sqrt(vy0);\n    const v1 = Math.sqrt(vy1);\n    const uvy0 = v0 !== 0 ? vy0 / v0 : 0;\n    const uvy1 = v1 !== 0 ? vy1 / v1 : 0;\n    const v = (v0 + v1) / 2;\n    input0.vy = uvy0 * v;\n    input1.vy = uvy1 * v;\n\n    const ay0 = input0.ay;\n    const ay1 = input1.ay;\n    const a0 = Math.sqrt(ay0);\n    const a1 = Math.sqrt(ay1);\n    const uay0 = a0 !== 0 ? ay0 / a0 : 0;\n    const uay1 = a1 !== 0 ? ay1 / a1 : 0;\n    const a = (a0 + a1) / 2;\n    input0.ay = uay0 * a;\n    input1.ay = uay1 * a;\n  },\n\n  integrate(t: number): void {\n    let coast0: ScaleGestureInput<X, Y> | undefined;\n    let coast1: ScaleGestureInput<X, Y> | undefined;\n    const inputs = this.inputs;\n    for (const inputId in inputs) {\n      const input = inputs[inputId]!;\n      if (!input.coasting) {\n        continue;\n      } else if (coast0 === void 0) {\n        coast0 = input;\n      } else if (coast1 === void 0) {\n        coast1 = input;\n        const dx0 = coast1.x - coast0.x;\n        const dy0 = coast1.y - coast0.y;\n        const d0 = Math.sqrt(dx0 * dx0 + dy0 * dy0);\n        coast0.integrateVelocity(t);\n        coast1.integrateVelocity(t);\n        const dx1 = coast1.x - coast0.x;\n        const dy1 = coast1.y - coast0.y;\n        const d1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        const s = d1 / d0;\n        coast0.vx *= s;\n        coast0.vy *= s;\n        coast0.ax *= s;\n        coast0.ay *= s;\n        coast1.vx *= s;\n        coast1.vy *= s;\n        coast1.ax *= s;\n        coast1.ay *= s;\n      } else {\n        input.integrateVelocity(t);\n      }\n    }\n    if (coast0 !== void 0 && coast1 === void 0) {\n      coast0.integrateVelocity(t);\n    }\n  },\n\n  zoom(x: number, y: number, dz: number, event: Event | null): void {\n    if (dz === 0) {\n      return;\n    }\n    const t = event !== null ? event.timeStamp : performance.now();\n    const a = this.acceleration;\n    let ax = a * Math.cos(Math.PI / 4);\n    let ay = a * Math.sin(Math.PI / 4);\n    const vMax = this.velocityMax;\n    const vx = 0.5 * vMax * Math.cos(Math.PI / 4);\n    const vy = 0.5 * vMax * Math.sin(Math.PI / 4);\n    const dx = (4 * vx * vx) / ax;\n    const dy = (4 * vy * vy) / ay;\n\n    const inputs = this.inputs as {[inputId: string]: ScaleGestureInput<X, Y> | undefined};\n    let zoom0 = inputs.zoom0;\n    let zoom1 = inputs.zoom1;\n    if (zoom0 !== void 0 && zoom1 !== void 0) {\n      const dt = t - zoom0.t;\n      if (dt > 0) {\n        const dzx = Math.abs(zoom1.x - zoom0.x) / 2;\n        const dzy = Math.abs(zoom1.y - zoom0.y) / 2;\n        dz = Math.min(Math.max(-vMax * dt, dz), vMax * dt);\n        const zx = (dz * dzx * Math.cos(Math.PI / 4)) / dx;\n        const zy = (dz * dzy * Math.sin(Math.PI / 4)) / dy;\n        ax = (ax * dzx) / dx;\n        ay = (ay * dzy) / dy;\n\n        zoom0.x += zx;\n        zoom0.y += zy;\n        zoom0.t = t;\n        zoom0.dx = zx;\n        zoom0.dy = zy;\n        zoom0.dt = dt;\n        zoom0.vx = zx / dt;\n        zoom0.vy = zy / dt;\n        zoom0.ax = zoom0.vx < 0 ? ax : zoom0.vx > 0 ? -ax : 0;\n        zoom0.ay = zoom0.vy < 0 ? ay : zoom0.vy > 0 ? -ay : 0;\n\n        zoom1.x -= zx;\n        zoom1.y -= zy;\n        zoom1.t = t;\n        zoom0.dx = -zx;\n        zoom0.dy = -zy;\n        zoom0.dt = dt;\n        zoom1.vx = -zx / dt;\n        zoom1.vy = -zy / dt;\n        zoom1.ax = zoom1.vx < 0 ? ax : zoom1.vx > 0 ? -ax : 0;\n        zoom1.ay = zoom1.vy < 0 ? ay : zoom1.vy > 0 ? -ay : 0;\n      }\n    } else {\n      this.interrupt(event);\n\n      if (dz < 0) {\n        zoom0 = this.createInput(\"zoom0\", \"unknown\", false, x - dx, y - dy, t);\n        zoom0.vx = -vx;\n        zoom0.vy = -vy;\n        zoom0.ax = ax;\n        zoom0.ay = ay;\n        zoom1 = this.createInput(\"zoom1\", \"unknown\", false, x + dx, y + dy, t);\n        zoom1.vx = vx;\n        zoom1.vy = vy;\n        zoom1.ax = -ax;\n        zoom1.ay = -ay;\n      } else {\n        zoom0 = this.createInput(\"zoom0\", \"unknown\", false, x - dx, y - dy, t);\n        zoom0.vx = vx;\n        zoom0.vy = vy;\n        zoom0.ax = -ax;\n        zoom0.ay = -ay;\n        zoom1 = this.createInput(\"zoom1\", \"unknown\", false, x + dx, y + dy, t);\n        zoom1.vx = -vx;\n        zoom1.vy = -vy;\n        zoom1.ax = ax;\n        zoom1.ay = ay;\n      }\n\n      inputs.zoom0 = zoom0;\n      inputs.zoom1 = zoom1;\n      (this as Mutable<typeof this>).inputCount += 2;\n      this.beginCoast(zoom0, event);\n      this.beginCoast(zoom1, event);\n    }\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.distanceMin = gesture.initDistanceMin();\n    return gesture;\n  },\n\n  specialize(template: G extends {readonly descriptorType?: Proto<infer D>} ? D : never): FastenerClass<G> {\n    let superClass = template.extends as FastenerClass<G> | null | undefined;\n    if (superClass === void 0 || superClass === null) {\n      const method = template.method;\n      if (method === \"pointer\") {\n        superClass = PointerScaleGesture as unknown as FastenerClass<G>;\n      } else if (method === \"touch\") {\n        superClass = TouchScaleGesture as unknown as FastenerClass<G>;\n      } else if (method === \"mouse\") {\n        superClass = MouseScaleGesture as unknown as FastenerClass<G>;\n      } else if (typeof PointerEvent !== \"undefined\") {\n        superClass = PointerScaleGesture as unknown as FastenerClass<G>;\n      } else if (typeof TouchEvent !== \"undefined\") {\n        superClass = TouchScaleGesture as unknown as FastenerClass<G>;\n      } else {\n        superClass = MouseScaleGesture as unknown as FastenerClass<G>;\n      }\n    }\n    return superClass;\n  },\n\n  refine(gestureClass: FastenerClass<ScaleGesture<any, any, any, any>>): void {\n    super.refine(gestureClass);\n    const fastenerPrototype = gestureClass.prototype;\n\n    let flagsInit = fastenerPrototype.flagsInit;\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"preserveAspectRatio\")) {\n      if (fastenerPrototype.preserveAspectRatio) {\n        flagsInit |= ScaleGesture.PreserveAspectRatioFlag;\n      } else {\n        flagsInit &= ~ScaleGesture.PreserveAspectRatioFlag;\n      }\n      delete (fastenerPrototype as ScaleGestureDescriptor<any, any, any, any>).preserveAspectRatio;\n    }\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"wheel\")) {\n      if (fastenerPrototype.wheel) {\n        flagsInit |= ScaleGesture.WheelFlag;\n      } else {\n        flagsInit &= ~ScaleGesture.WheelFlag;\n      }\n      delete (fastenerPrototype as ScaleGestureDescriptor<any, any, any, any>).wheel;\n    }\n    Object.defineProperty(fastenerPrototype, \"flagsInit\", {\n      value: flagsInit,\n      enumerable: true,\n      configurable: true,\n    });\n  },\n\n  PreserveAspectRatioFlag: 1 << (MomentumGesture.FlagShift + 0),\n  WheelFlag: 1 << (MomentumGesture.FlagShift + 1),\n  NeedsRescale: 1 << (MomentumGesture.FlagShift + 2),\n\n  FlagShift: MomentumGesture.FlagShift + 3,\n  FlagMask: (1 << (MomentumGesture.FlagShift + 3)) - 1,\n}))();\n\n/** @internal */\nexport interface PointerScaleGesture<R = any, V extends View = View, X = any, Y = any> extends ScaleGesture<R, V, X, Y> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: ScaleGestureInput<X, Y>, event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerEnter(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerLeave(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerDown(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerMove(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerUp(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerCancel(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onPointerLeaveDocument(event: PointerEvent): void;\n\n  /** @internal @protected */\n  onWheel(event: WheelEvent): void;\n}\n\n/** @internal */\nexport const PointerScaleGesture = (<R, V extends View, X, Y, G extends PointerScaleGesture<any, any, any, any>>() => ScaleGesture.extend<PointerScaleGesture<R, V, X, Y>, ScaleGestureClass<G>>(\"PointerScaleGesture\", {\n  wheel: true,\n\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"pointerenter\", this.onPointerEnter as EventListener);\n    view.addEventListener(\"pointerleave\", this.onPointerLeave as EventListener);\n    view.addEventListener(\"pointerdown\", this.onPointerDown as EventListener);\n    view.addEventListener(\"wheel\", this.onWheel as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"pointerenter\", this.onPointerEnter as EventListener);\n    view.removeEventListener(\"pointerleave\", this.onPointerLeave as EventListener);\n    view.removeEventListener(\"pointerdown\", this.onPointerDown as EventListener);\n    view.removeEventListener(\"wheel\", this.onWheel as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    document.body.addEventListener(\"pointermove\", this.onPointerMove);\n    document.body.addEventListener(\"pointerup\", this.onPointerUp);\n    document.body.addEventListener(\"pointercancel\", this.onPointerCancel);\n    document.body.addEventListener(\"pointerleave\", this.onPointerLeaveDocument);\n  },\n\n  detachPressEvents(view: V): void {\n    document.body.removeEventListener(\"pointermove\", this.onPointerMove);\n    document.body.removeEventListener(\"pointerup\", this.onPointerUp);\n    document.body.removeEventListener(\"pointercancel\", this.onPointerCancel);\n    document.body.removeEventListener(\"pointerleave\", this.onPointerLeaveDocument);\n  },\n\n  updateInput(input: ScaleGestureInput<X, Y>, event: PointerEvent): void {\n    input.target = event.target;\n    input.button = event.button;\n    input.buttons = event.buttons;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = event.clientX - input.x;\n    input.dy = event.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = event.clientX;\n    input.y = event.clientY;\n    input.t = event.timeStamp;\n\n    input.width = event.width;\n    input.height = event.height;\n    input.tiltX = event.tiltX;\n    input.tiltY = event.tiltY;\n    input.twist = event.twist;\n    input.pressure = event.pressure;\n    input.tangentialPressure = event.tangentialPressure;\n  },\n\n  onPointerEnter(event: PointerEvent): void {\n    if (event.pointerType !== \"mouse\" || event.buttons !== 0) {\n      return;\n    }\n    const input = this.getOrCreateInput(event.pointerId, GestureInput.pointerInputType(event.pointerType),\n                                        event.isPrimary, event.clientX, event.clientY, event.timeStamp);\n    if (!input.coasting) {\n      this.updateInput(input, event);\n    }\n    if (!input.hovering) {\n      this.beginHover(input, event);\n    }\n  },\n\n  onPointerLeave(event: PointerEvent): void {\n    if (event.pointerType !== \"mouse\") {\n      return;\n    }\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    } else if (!input.coasting) {\n      this.updateInput(input, event);\n    }\n    this.endHover(input, event);\n  },\n\n  onPointerDown(event: PointerEvent): void {\n    const input = this.getOrCreateInput(event.pointerId, GestureInput.pointerInputType(event.pointerType),\n                                        event.isPrimary, event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.pressing) {\n      this.beginPress(input, event);\n    }\n    if (event.pointerType === \"mouse\" && event.button !== 0) {\n      this.cancelPress(input, event);\n    }\n  },\n\n  onPointerMove(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.movePress(input, event);\n  },\n\n  onPointerUp(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endPress(input, event);\n    if (!input.defaultPrevented && event.button === 0) {\n      this.press(input, event);\n    }\n  },\n\n  onPointerCancel(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n  },\n\n  onPointerLeaveDocument(event: PointerEvent): void {\n    const input = this.getInput(event.pointerId);\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n    this.endHover(input, event);\n  },\n\n  onWheel(event: WheelEvent): void {\n    if (!this.wheel) {\n      return;\n    }\n    event.preventDefault();\n    this.zoom(event.clientX, event.clientY, event.deltaY, event);\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onPointerEnter = gesture.onPointerEnter.bind(gesture);\n    gesture.onPointerLeave = gesture.onPointerLeave.bind(gesture);\n    gesture.onPointerDown = gesture.onPointerDown.bind(gesture);\n    gesture.onPointerMove = gesture.onPointerMove.bind(gesture);\n    gesture.onPointerUp = gesture.onPointerUp.bind(gesture);\n    gesture.onPointerCancel = gesture.onPointerCancel.bind(gesture);\n    gesture.onPointerLeaveDocument = gesture.onPointerLeaveDocument.bind(gesture);\n    gesture.onWheel = gesture.onWheel.bind(gesture);\n    return gesture;\n  },\n}))();\n\n/** @internal */\nexport interface TouchScaleGesture<R = any, V extends View = View, X = any, Y = any> extends ScaleGesture<R, V, X, Y> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: ScaleGestureInput<X, Y>, event: TouchEvent, touch: Touch): void;\n\n  /** @internal @protected */\n  onTouchStart(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchMove(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchEnd(event: TouchEvent): void;\n\n  /** @internal @protected */\n  onTouchCancel(event: TouchEvent): void;\n}\n\n/** @internal */\nexport const TouchScaleGesture = (<R, V extends View, X, Y, G extends TouchScaleGesture<any, any, any, any>>() => ScaleGesture.extend<TouchScaleGesture<R, V, X, Y>, ScaleGestureClass<G>>(\"TouchScaleGesture\", {\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"touchstart\", this.onTouchStart as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"touchstart\", this.onTouchStart as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    view.addEventListener(\"touchmove\", this.onTouchMove as EventListener);\n    view.addEventListener(\"touchend\", this.onTouchEnd as EventListener);\n    view.addEventListener(\"touchcancel\", this.onTouchCancel as EventListener);\n  },\n\n  detachPressEvents(view: V): void {\n    view.removeEventListener(\"touchmove\", this.onTouchMove as EventListener);\n    view.removeEventListener(\"touchend\", this.onTouchEnd as EventListener);\n    view.removeEventListener(\"touchcancel\", this.onTouchCancel as EventListener);\n  },\n\n  updateInput(input: ScaleGestureInput<X, Y>, event: TouchEvent, touch: Touch): void {\n    input.target = touch.target;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = touch.clientX - input.x;\n    input.dy = touch.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = touch.clientX;\n    input.y = touch.clientY;\n    input.t = event.timeStamp;\n  },\n\n  onTouchStart(event: TouchEvent): void {\n    const touches = event.targetTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getOrCreateInput(touch.identifier, \"touch\", false,\n                                          touch.clientX, touch.clientY, event.timeStamp);\n      this.updateInput(input, event, touch);\n      if (!input.pressing) {\n        this.beginPress(input, event);\n      }\n    }\n  },\n\n  onTouchMove(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.movePress(input, event);\n    }\n  },\n\n  onTouchEnd(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.endPress(input, event);\n      if (!input.defaultPrevented) {\n        this.press(input, event);\n      }\n      this.endHover(input, event);\n    }\n  },\n\n  onTouchCancel(event: TouchEvent): void {\n    const touches = event.changedTouches;\n    for (let i = 0; i < touches.length; i += 1) {\n      const touch = touches[i]!;\n      const input = this.getInput(touch.identifier);\n      if (input === null) {\n        continue;\n      }\n      this.updateInput(input, event, touch);\n      this.cancelPress(input, event);\n      this.endHover(input, event);\n    }\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onTouchStart = gesture.onTouchStart.bind(gesture);\n    gesture.onTouchMove = gesture.onTouchMove.bind(gesture);\n    gesture.onTouchEnd = gesture.onTouchEnd.bind(gesture);\n    gesture.onTouchCancel = gesture.onTouchCancel.bind(gesture);\n    return gesture;\n  },\n}))();\n\n/** @internal */\nexport interface MouseScaleGesture<R = any, V extends View = View, X = any, Y = any> extends ScaleGesture<R, V, X, Y> {\n  /** @internal @protected @override */\n  attachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachHoverEvents(view: V): void;\n\n  /** @internal @protected @override */\n  attachPressEvents(view: V): void;\n\n  /** @internal @protected @override */\n  detachPressEvents(view: V): void;\n\n  /** @internal @protected */\n  updateInput(input: ScaleGestureInput<X, Y>, event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseEnter(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseLeave(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseDown(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseMove(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseUp(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onMouseLeaveDocument(event: MouseEvent): void;\n\n  /** @internal @protected */\n  onWheel(event: WheelEvent): void;\n}\n\n/** @internal */\nexport const MouseScaleGesture = (<R, V extends View, X, Y, G extends MouseScaleGesture<any, any, any, any>>() => ScaleGesture.extend<MouseScaleGesture<R, V, X, Y>, ScaleGestureClass<G>>(\"MouseScaleGesture\", {\n  wheel: true,\n\n  attachHoverEvents(view: V): void {\n    view.addEventListener(\"mouseenter\", this.onMouseEnter as EventListener);\n    view.addEventListener(\"mouseleave\", this.onMouseLeave as EventListener);\n    view.addEventListener(\"mousedown\", this.onMouseDown as EventListener);\n    view.addEventListener(\"wheel\", this.onWheel as EventListener);\n  },\n\n  detachHoverEvents(view: V): void {\n    view.removeEventListener(\"mouseenter\", this.onMouseEnter as EventListener);\n    view.removeEventListener(\"mouseleave\", this.onMouseLeave as EventListener);\n    view.removeEventListener(\"mousedown\", this.onMouseDown as EventListener);\n    view.removeEventListener(\"wheel\", this.onWheel as EventListener);\n  },\n\n  attachPressEvents(view: V): void {\n    document.body.addEventListener(\"mousemove\", this.onMouseMove);\n    document.body.addEventListener(\"mouseup\", this.onMouseUp);\n    document.body.addEventListener(\"mouseleave\", this.onMouseLeaveDocument);\n  },\n\n  detachPressEvents(view: V): void {\n    document.body.removeEventListener(\"mousemove\", this.onMouseMove);\n    document.body.removeEventListener(\"mouseup\", this.onMouseUp);\n    document.body.removeEventListener(\"mouseleave\", this.onMouseLeaveDocument);\n  },\n\n  updateInput(input: ScaleGestureInput<X, Y>, event: MouseEvent): void {\n    input.target = event.target;\n    input.button = event.button;\n    input.buttons = event.buttons;\n    input.altKey = event.altKey;\n    input.ctrlKey = event.ctrlKey;\n    input.metaKey = event.metaKey;\n    input.shiftKey = event.shiftKey;\n\n    input.dx = event.clientX - input.x;\n    input.dy = event.clientY - input.y;\n    input.dt = event.timeStamp - input.t;\n    input.x = event.clientX;\n    input.y = event.clientY;\n    input.t = event.timeStamp;\n  },\n\n  onMouseEnter(event: MouseEvent): void {\n    if (event.buttons !== 0) {\n      return;\n    }\n    const input = this.getOrCreateInput(\"mouse\", \"mouse\", true,\n                                        event.clientX, event.clientY, event.timeStamp);\n    if (!input.coasting) {\n      this.updateInput(input, event);\n    }\n    if (!input.hovering) {\n      this.beginHover(input, event);\n    }\n  },\n\n  onMouseLeave(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    } else if (!input.coasting) {\n      this.updateInput(input, event);\n    }\n    this.endHover(input, event);\n  },\n\n  onMouseDown(event: MouseEvent): void {\n    const input = this.getOrCreateInput(\"mouse\", \"mouse\", true,\n                                        event.clientX, event.clientY, event.timeStamp);\n    this.updateInput(input, event);\n    if (!input.pressing) {\n      this.beginPress(input, event);\n    }\n    if (event.button !== 0) {\n      this.cancelPress(input, event);\n    }\n  },\n\n  onMouseMove(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.movePress(input, event);\n  },\n\n  onMouseUp(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.endPress(input, event);\n    if (!input.defaultPrevented && event.button === 0) {\n      this.press(input, event);\n    }\n  },\n\n  onMouseLeaveDocument(event: MouseEvent): void {\n    const input = this.getInput(\"mouse\");\n    if (input === null) {\n      return;\n    }\n    this.updateInput(input, event);\n    this.cancelPress(input, event);\n    this.endHover(input, event);\n  },\n\n  onWheel(event: WheelEvent): void {\n    if (!this.wheel) {\n      return;\n    }\n    event.preventDefault();\n    this.zoom(event.clientX, event.clientY, event.deltaY, event);\n  },\n},\n{\n  construct(gesture: G | null, owner: G extends Fastener<infer R, any, any> ? R : never): G {\n    gesture = super.construct(gesture, owner) as G;\n    gesture.onMouseEnter = gesture.onMouseEnter.bind(gesture);\n    gesture.onMouseLeave = gesture.onMouseLeave.bind(gesture);\n    gesture.onMouseDown = gesture.onMouseDown.bind(gesture);\n    gesture.onMouseMove = gesture.onMouseMove.bind(gesture);\n    gesture.onMouseUp = gesture.onMouseUp.bind(gesture);\n    gesture.onMouseLeaveDocument = gesture.onMouseLeaveDocument.bind(gesture);\n    gesture.onWheel = gesture.onWheel.bind(gesture);\n    return gesture;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport type ViewportOrientation = \"portrait\" | \"landscape\";\n\n/** @public */\nexport type ViewportColorScheme = \"dark\" | \"light\" | \"no-preference\";\n\n/** @public */\nexport interface LayoutViewport {\n  readonly width: number;\n  readonly height: number;\n  readonly pageLeft: number;\n  readonly pageTop: number;\n}\n\n/** @public */\nexport const LayoutViewport = {\n  equal(x: LayoutViewport | null | undefined, y: LayoutViewport | null | undefined): boolean {\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"object\" && x !== null && typeof y === \"object\" && y !== null) {\n      return x.width === y.width\n          && x.height === y.height\n          && x.pageLeft === y.pageLeft\n          && x.pageTop === y.pageTop;\n    }\n    return false;\n  },\n};\n\n/** @public */\nexport interface VisualViewport {\n  readonly width: number;\n  readonly height: number;\n  readonly pageLeft: number;\n  readonly pageTop: number;\n  readonly offsetLeft: number;\n  readonly offsetTop: number;\n  readonly scale: number;\n}\n\n/** @public */\nexport const VisualViewport = {\n  equal(x: VisualViewport | null | undefined, y: VisualViewport | null | undefined): boolean {\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"object\" && x !== null && typeof y === \"object\" && y !== null) {\n      return x.width === y.width\n          && x.height === y.height\n          && x.pageLeft === y.pageLeft\n          && x.pageTop === y.pageTop\n          && x.offsetLeft === y.offsetLeft\n          && x.offsetTop === y.offsetTop\n          && x.scale === y.scale;\n    }\n    return false;\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport {EventHandler} from \"@swim/component\";\nimport {EventTimer} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport {Length} from \"@swim/math\";\nimport type {ViewIdiom} from \"./View\";\nimport {ViewInsets} from \"./View\";\nimport type {ViewportOrientation} from \"./Viewport\";\nimport type {ViewportColorScheme} from \"./Viewport\";\nimport {LayoutViewport} from \"./Viewport\";\nimport {VisualViewport} from \"./Viewport\";\n\n/** @public */\nexport interface ViewportServiceObserver<S extends ViewportService = ViewportService> extends ServiceObserver<S> {\n  serviceDidScrollLayoutViewport?(layoutViewport: LayoutViewport, service: S): void;\n\n  serviceDidResizeLayoutViewport?(layoutViewport: LayoutViewport, service: S): void;\n\n  serviceDidResizeVisualViewport?(visualViewport: VisualViewport, service: S): void;\n\n  serviceDidResizeViewportSafeArea?(safeArea: ViewInsets, service: S): void;\n\n  serviceDidSetViewportOrientation?(orientation: ViewportOrientation, service: S): void;\n\n  serviceDidSetViewportColorScheme?(colorScheme: ViewportColorScheme, service: S): void;\n\n  serviceDidSetViewIdiom?(viewIdiom: ViewIdiom, service: S): void;\n}\n\n/** @public */\nexport class ViewportService extends Service {\n  declare readonly observerType?: Class<ViewportServiceObserver>;\n\n  @Property({\n    valueType: LayoutViewport,\n    initValue(): LayoutViewport {\n      return this.detect();\n    },\n    update(): void {\n      if (this.hasAffinity(Affinity.Intrinsic)) {\n        const layoutViewport = this.detect();\n        this.setIntrinsic(layoutViewport);\n      }\n    },\n    detect(): LayoutViewport {\n      return {\n        width: document.documentElement.clientWidth,\n        height: document.documentElement.clientHeight,\n        pageLeft: window.pageXOffset,\n        pageTop: window.pageYOffset,\n      };\n    },\n    didSetValue(newLayoutViewport: LayoutViewport, oldLayoutViewport: LayoutViewport): void {\n      if (newLayoutViewport.width !== oldLayoutViewport.width || newLayoutViewport.height !== oldLayoutViewport.height) {\n        this.owner.callObservers(\"serviceDidResizeLayoutViewport\", newLayoutViewport, this.owner);\n        this.owner.safeArea.update();\n        this.owner.viewIdiom.update();\n      } else {\n        this.owner.callObservers(\"serviceDidScrollLayoutViewport\", newLayoutViewport, this.owner);\n      }\n    },\n    equalValues: LayoutViewport.equal,\n  })\n  readonly layoutViewport!: Property<this, LayoutViewport> & {\n    update(): void,\n    detect(): LayoutViewport,\n  };\n\n  @EventTimer({\n    delay: 33,\n    eventType: [\"resize\", \"scroll\"],\n    initTarget(): EventTarget | null {\n      if (typeof window !== \"undefined\") {\n        return window;\n      }\n      return null;\n    },\n    handle(event: Event): void {\n      this.owner.layoutViewport.update();\n    },\n  })\n  readonly layoutViewportChange!: EventTimer<this>;\n\n  @Property({\n    valueType: VisualViewport,\n    initValue(): VisualViewport {\n      return this.detect();\n    },\n    update(): void {\n      if (this.hasAffinity(Affinity.Intrinsic)) {\n        const visualViewport = this.detect();\n        this.setIntrinsic(visualViewport);\n      }\n    },\n    detect(): VisualViewport {\n      let visualViewport: VisualViewport;\n      if (window.visualViewport !== void 0 && window.visualViewport !== null) {\n        visualViewport = {\n          width: window.visualViewport.width,\n          height: window.visualViewport.height,\n          pageLeft: window.visualViewport.pageLeft,\n          pageTop: window.visualViewport.pageTop,\n          offsetLeft: window.visualViewport.offsetLeft,\n          offsetTop: window.visualViewport.offsetTop,\n          scale: window.visualViewport.scale,\n        };\n      } else {\n        visualViewport = {\n          width: document.documentElement.clientWidth,\n          height: document.documentElement.clientHeight,\n          pageLeft: window.pageXOffset,\n          pageTop: window.pageYOffset,\n          offsetLeft: 0,\n          offsetTop: 0,\n          scale: 1,\n        };\n      }\n      return visualViewport;\n    },\n    didSetValue(visualViewport: VisualViewport): void {\n      this.owner.callObservers(\"serviceDidResizeVisualViewport\", visualViewport, this.owner);\n    },\n    equalValues: VisualViewport.equal,\n  })\n  readonly visualViewport!: Property<this, VisualViewport> & {\n    update(): void,\n    detect(): VisualViewport,\n  };\n\n  @EventTimer({\n    delay: 33,\n    eventType: \"resize\",\n    initTarget(): EventTarget | null {\n      if (typeof window !== \"undefined\" && window.visualViewport !== void 0) {\n        return window.visualViewport;\n      }\n      return null;\n    },\n    handle(event: Event): void {\n      this.owner.visualViewport.update();\n    },\n  })\n  readonly visualViewportChange!: EventTimer<this>;\n\n  @Property({\n    valueType: ViewInsets,\n    value: ViewInsets.zero(),\n    update(): void {\n      if (this.hasAffinity(Affinity.Intrinsic)) {\n        const safeArea = this.detect();\n        this.setIntrinsic(safeArea);\n      }\n    },\n    detect(): ViewInsets {\n      let safeArea: ViewInsets;\n      try {\n        const documentStyle = getComputedStyle(document.documentElement);\n        const insetTop = Length.parse(documentStyle.getPropertyValue(\"--safe-area-inset-top\")).pxValue();\n        const insetRight = Length.parse(documentStyle.getPropertyValue(\"--safe-area-inset-right\")).pxValue();\n        const insetBottom = Length.parse(documentStyle.getPropertyValue(\"--safe-area-inset-bottom\")).pxValue();\n        const insetLeft = Length.parse(documentStyle.getPropertyValue(\"--safe-area-inset-left\")).pxValue();\n        safeArea = {insetTop, insetRight, insetBottom, insetLeft};\n      } catch (swallow) {\n        safeArea = ViewInsets.zero();\n      }\n      return safeArea;\n    },\n    didSetValue(safeArea: ViewInsets): void {\n      this.owner.callObservers(\"serviceDidResizeViewportSafeArea\", safeArea, this.owner);\n    },\n    equalValues: ViewInsets.equal,\n    didMount(): void {\n      if (typeof CSS !== \"undefined\" && CSS.supports !== void 0 &&\n          CSS.supports(\"--safe-area-inset-top: env(safe-area-inset-top)\")) {\n        const documentStyle = document.documentElement.style;\n        documentStyle.setProperty(\"--safe-area-inset-top\", \"env(safe-area-inset-top)\");\n        documentStyle.setProperty(\"--safe-area-inset-right\", \"env(safe-area-inset-right)\");\n        documentStyle.setProperty(\"--safe-area-inset-bottom\", \"env(safe-area-inset-bottom)\");\n        documentStyle.setProperty(\"--safe-area-inset-left\", \"env(safe-area-inset-left)\");\n        this.update();\n      }\n    },\n  })\n  readonly safeArea!: Property<this, ViewInsets> & {\n    update(): void,\n    detect(): ViewInsets,\n  };\n\n  @Property({\n    valueType: String,\n    initValue(): ViewportOrientation {\n      return this.detect();\n    },\n    update(): void {\n      if (this.hasAffinity(Affinity.Intrinsic)) {\n        const orientation = this.detect();\n        this.setIntrinsic(orientation);\n      }\n    },\n    detect(): ViewportOrientation {\n      let orientation: ViewportOrientation;\n      if (typeof window !== \"undefined\" && window.matchMedia(\"(orientation: portrait)\").matches) {\n        orientation = \"portrait\";\n      } else if (typeof window !== \"undefined\" && window.matchMedia(\"(orientation: landscape)\").matches) {\n        orientation = \"landscape\";\n      } else {\n        orientation = \"landscape\";\n      }\n      return orientation;\n    },\n    didSetValue(orientation: ViewportOrientation): void {\n      this.owner.callObservers(\"serviceDidSetViewportOrientation\", orientation, this.owner);\n      this.owner.safeArea.update();\n      this.owner.viewIdiom.update();\n    },\n  })\n  readonly orientation!: Property<this, ViewportOrientation> & {\n    update(): void,\n    detect(): ViewportOrientation,\n  };\n\n  @EventHandler({\n    eventType: \"change\",\n    initTarget(): EventTarget | null {\n      if (typeof window !== \"undefined\") {\n        return window.matchMedia(\"(orientation: landscape)\");\n      }\n      return null;\n    },\n    handle(event: MediaQueryListEvent): void {\n      this.owner.orientation.update();\n    },\n  })\n  readonly orientationChange!: EventHandler<this>;\n\n  @Property({\n    valueType: String,\n    initValue(): ViewportColorScheme {\n      return this.detect();\n    },\n    update(): void {\n      if (this.hasAffinity(Affinity.Intrinsic)) {\n        const colorScheme = this.detect();\n        this.setIntrinsic(colorScheme);\n      }\n    },\n    detect(): ViewportColorScheme {\n      let colorScheme: ViewportColorScheme;\n      if (typeof window !== \"undefined\" && window.matchMedia(\"(prefers-color-scheme: dark)\").matches) {\n        colorScheme = \"dark\";\n      } else if (typeof window !== \"undefined\" && window.matchMedia(\"(prefers-color-scheme: light)\").matches) {\n        colorScheme = \"light\";\n      } else {\n        colorScheme = \"no-preference\";\n      }\n      return colorScheme;\n    },\n    didSetValue(colorScheme: ViewportColorScheme): void {\n      this.owner.callObservers(\"serviceDidSetViewportColorScheme\", colorScheme, this.owner);\n    },\n  })\n  readonly colorScheme!: Property<this, ViewportColorScheme> & {\n    update(): void,\n    detect(): ViewportColorScheme,\n  };\n\n  @EventHandler({\n    eventType: \"change\",\n    initTarget(): EventTarget | null {\n      if (typeof window !== \"undefined\") {\n        return window.matchMedia(\"(prefers-color-scheme: dark)\");\n      }\n      return null;\n    },\n    handle(event: MediaQueryListEvent): void {\n      this.owner.colorScheme.update();\n    },\n  })\n  readonly colorSchemeChange!: EventHandler<this>;\n\n  @Property({\n    valueType: String,\n    initValue(): ViewIdiom {\n      return this.detect();\n    },\n    update(): void {\n      if (this.hasAffinity(Affinity.Intrinsic)) {\n        const viewIdiom = this.detect();\n        this.setIntrinsic(viewIdiom);\n      }\n    },\n    detect(): ViewIdiom {\n      let viewIdiom: ViewIdiom;\n      const viewport = this.owner.layoutViewport.value;\n      if (viewport.width < 600) {\n        viewIdiom = \"mobile\";\n      } else if (viewport.width < 800) {\n        viewIdiom = \"tablet\";\n      } else {\n        viewIdiom = \"desktop\";\n      }\n      return viewIdiom;\n    },\n    didSetValue(viewIdiom: ViewIdiom): void {\n      return this.owner.callObservers(\"serviceDidSetViewIdiom\", viewIdiom, this.owner);\n    },\n  })\n  readonly viewIdiom!: Property<this, ViewIdiom> & {\n    update(): void,\n    detect(): ViewIdiom,\n  };\n\n  @EventTimer({\n    delay: 100, // work around safe area not available on standalone load\n    eventType: \"load\",\n    initTarget(): EventTarget | null {\n      if (typeof window !== \"undefined\") {\n        return window;\n      }\n      return null;\n    },\n    handle(event: Event): void {\n      this.owner.layoutViewport.update();\n      this.owner.visualViewport.update();\n      this.owner.safeArea.update();\n      this.owner.orientation.update();\n      this.owner.colorScheme.update();\n    },\n  })\n  readonly load!: EventTimer<this>;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {EventHandler} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport type {ViewIdiom} from \"./View\";\nimport type {ViewInsets} from \"./View\";\nimport type {ViewFlags} from \"./View\";\nimport {View} from \"./View\";\nimport {ViewSet} from \"./ViewSet\";\nimport type {ViewportOrientation} from \"./Viewport\";\nimport type {LayoutViewport} from \"./Viewport\";\nimport type {VisualViewport} from \"./Viewport\";\nimport {ViewportService} from \"./ViewportService\";\n\n/** @public */\nexport interface DisplayerServiceObserver<S extends DisplayerService = DisplayerService> extends ServiceObserver<S> {\n  serviceWillAttachRoot?(rootView: View, service: S): void;\n\n  serviceDidAttachRoot?(rootView: View, service: S): void;\n\n  serviceWillDetachRoot?(rootView: View, service: S): void;\n\n  serviceDidDetachRoot?(rootView: View, service: S): void;\n}\n\n/** @public */\nexport class DisplayerService extends Service {\n  constructor() {\n    super();\n    this.updateFlags = 0;\n    this.updateTime = performance.now();\n    this.updateDelay = DisplayerService.MinUpdateDelay;\n    this.processTimer = 0;\n    this.displayFrame = 0;\n\n    this.runProcessPass = this.runProcessPass.bind(this);\n    this.runDisplayPass = this.runDisplayPass.bind(this);\n  }\n\n  declare readonly observerType?: Class<DisplayerServiceObserver>;\n\n  @ViewSet({\n    initView(rootView: View): void {\n      this.owner.requestUpdate(rootView, rootView.flags & View.UpdateMask, false);\n      const safeArea = this.owner.viewport.getService().safeArea.value;\n      rootView.edgeInsets.setValue(safeArea, Affinity.Inherited);\n    },\n    willAttachView(rootView: View): void {\n      this.owner.callObservers(\"serviceWillAttachRoot\", rootView, this.owner);\n    },\n    didAttachView(rootView: View): void {\n      this.owner.callObservers(\"serviceDidAttachRoot\", rootView, this.owner);\n    },\n    willDetachView(rootView: View): void {\n      this.owner.callObservers(\"serviceWillDetachRoot\", rootView, this.owner);\n    },\n    didDetachView(rootView: View): void {\n      this.owner.callObservers(\"serviceDidDetachRoot\", rootView, this.owner);\n    },\n    updateSafeArea(safeArea: ViewInsets): void {\n      const rootViews = this.owner.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        rootView.edgeInsets.setValue(safeArea, Affinity.Inherited);\n      }\n    },\n  })\n  readonly roots!: ViewSet<this, View> & {\n    /** @internal */\n    updateSafeArea(safeArea: ViewInsets): void,\n  };\n\n  @Provider({\n    serviceType: ViewportService,\n    observes: true,\n    initService(viewportService: ViewportService): void {\n      this.owner.roots.updateSafeArea(viewportService.safeArea.value);\n    },\n    serviceDidScrollLayoutViewport(layoutViewport: LayoutViewport): void {\n      const rootViews = this.owner.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        rootView.requireUpdate(View.NeedsScroll);\n      }\n    },\n    serviceDidResizeLayoutViewport(layoutViewport: LayoutViewport): void {\n      const rootViews = this.owner.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        rootView.requireUpdate(View.NeedsResize | View.NeedsScroll);\n      }\n    },\n    serviceDidResizeVisualViewport(visualViewport: VisualViewport): void {\n      // hook\n    },\n    serviceDidResizeViewportSafeArea(safeArea: ViewInsets): void {\n      this.owner.roots.updateSafeArea(safeArea);\n    },\n    serviceDidSetViewportOrientation(orientation: ViewportOrientation): void {\n      const rootViews = this.owner.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        rootView.requireUpdate(View.NeedsResize | View.NeedsScroll | View.NeedsLayout);\n      }\n    },\n    serviceDidSetViewIdiom(viewIdiom: ViewIdiom): void {\n      const rootViews = this.owner.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        rootView.requireUpdate(View.NeedsResize | View.NeedsLayout);\n      }\n    }\n  })\n  readonly viewport!: Provider<this, ViewportService> & Observes<ViewportService>;\n\n  /** @internal */\n  readonly updateFlags: ViewFlags;\n\n  /** @internal */\n  setUpdateFlags(updateFlags: ViewFlags): void {\n    (this as Mutable<this>).updateFlags = updateFlags;\n  }\n\n  readonly updateTime: number;\n\n  /** @internal */\n  updateDelay: number;\n\n  protected needsUpdate(updateFlags: ViewFlags, immediate: boolean): ViewFlags {\n    return updateFlags;\n  }\n\n  requestUpdate(target: View, updateFlags: ViewFlags, immediate: boolean): void {\n    updateFlags = this.needsUpdate(updateFlags, immediate);\n    let deltaUpdateFlags = this.updateFlags & ~updateFlags & View.UpdateMask;\n    if ((updateFlags & View.ProcessMask) !== 0) {\n      deltaUpdateFlags |= View.NeedsProcess;\n    }\n    if ((updateFlags & View.DisplayMask) !== 0) {\n      deltaUpdateFlags |= View.NeedsDisplay;\n    }\n    this.setUpdateFlags(this.updateFlags | deltaUpdateFlags);\n    if (immediate && (this.updateFlags & (View.ProcessingFlag | View.DisplayingFlag)) === 0 && this.updateDelay <= DisplayerService.MaxProcessInterval) {\n      this.runImmediatePass();\n    } else {\n      this.scheduleUpdate();\n    }\n  }\n\n  protected scheduleUpdate(): void {\n    const updateFlags = this.updateFlags;\n    if ((updateFlags & View.ProcessingFlag) === 0 && (updateFlags & View.ProcessMask) !== 0) {\n      this.scheduleProcessPass(this.updateDelay);\n    } else if ((updateFlags & View.DisplayingFlag) === 0 && (updateFlags & View.DisplayMask) !== 0) {\n      this.scheduleDisplayPass();\n    }\n  }\n\n  protected cancelUpdate(): void {\n    this.cancelProcessPass();\n    this.cancelDisplayPass();\n  }\n\n  protected runImmediatePass(): void {\n    if ((this.updateFlags & View.ProcessMask) !== 0) {\n      this.cancelUpdate();\n      this.runProcessPass(true);\n    }\n    if ((this.updateFlags & View.DisplayMask) !== 0 && this.updateDelay <= DisplayerService.MaxProcessInterval) {\n      this.cancelUpdate();\n      this.runDisplayPass(void 0, true);\n    }\n  }\n\n  /** @internal */\n  processTimer: number;\n\n  protected scheduleProcessPass(updateDelay: number): void {\n    if (this.processTimer === 0) {\n      this.processTimer = setTimeout(this.runProcessPass, updateDelay) as any;\n    }\n  }\n\n  protected cancelProcessPass(): void {\n    if (this.processTimer !== 0) {\n      clearTimeout(this.processTimer);\n      this.processTimer = 0;\n    }\n  }\n\n  protected runProcessPass(immediate: boolean = false): void {\n    if (!immediate) {\n      this.processTimer = 0;\n    }\n    this.setUpdateFlags(this.updateFlags & ~View.ProcessMask | View.ProcessingFlag);\n    try {\n      const t0 = performance.now();\n      (this as Mutable<this>).updateTime = t0;\n\n      const rootViews = this.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        if ((rootView.flags & View.ProcessMask) !== 0) {\n          rootView.cascadeProcess(0);\n        }\n      }\n\n      const t1 = performance.now();\n      let processDelay = Math.max(DisplayerService.MinProcessInterval, this.updateDelay);\n      if (t1 - t0 > processDelay) {\n        this.updateDelay = Math.min(Math.max(2, this.updateDelay * 2), DisplayerService.MaxUpdateDelay);\n      } else {\n        this.updateDelay = Math.min(DisplayerService.MinUpdateDelay, this.updateDelay / 2);\n      }\n\n      this.cancelProcessPass();\n      if ((this.updateFlags & View.DisplayMask) !== 0) {\n        this.scheduleDisplayPass();\n      } else if ((this.updateFlags & View.ProcessMask) !== 0) {\n        if (immediate) {\n          processDelay = Math.max(DisplayerService.MaxProcessInterval, processDelay);\n        }\n        this.cancelDisplayPass();\n        this.scheduleProcessPass(processDelay);\n      }\n    } finally {\n      this.setUpdateFlags(this.updateFlags & ~View.ProcessingFlag);\n    }\n  }\n\n  /** @internal */\n  displayFrame: number;\n\n  protected scheduleDisplayPass(): void {\n    if (this.displayFrame === 0) {\n      this.displayFrame = requestAnimationFrame(this.runDisplayPass);\n    }\n  }\n\n  protected cancelDisplayPass(): void {\n    if (this.displayFrame !== 0) {\n      cancelAnimationFrame(this.displayFrame);\n      this.displayFrame = 0;\n    }\n  }\n\n  protected runDisplayPass(time?: number, immediate: boolean = false): void {\n    if (!immediate) {\n      this.displayFrame = 0;\n    }\n    this.setUpdateFlags(this.updateFlags & ~View.DisplayMask | View.DisplayingFlag);\n    try {\n      if (time === void 0) {\n        time = performance.now();\n      }\n      (this as Mutable<this>).updateTime = time;\n\n      const rootViews = this.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        if ((rootView.flags & View.DisplayMask) !== 0) {\n          rootView.cascadeDisplay(0);\n        }\n      }\n\n      this.cancelDisplayPass();\n      if ((this.updateFlags & View.ProcessMask) !== 0) {\n        let processDelay = this.updateDelay;\n        if (immediate) {\n          processDelay = Math.max(DisplayerService.MaxProcessInterval, processDelay);\n        }\n        this.scheduleProcessPass(processDelay);\n      } else if ((this.updateFlags & View.DisplayMask) !== 0) {\n        this.cancelProcessPass();\n        this.scheduleDisplayPass();\n      }\n    } finally {\n      this.setUpdateFlags(this.updateFlags & ~View.DisplayingFlag);\n    }\n  }\n\n  get powerFlags(): ViewFlags {\n    return View.NeedsResize | View.NeedsScroll;\n  }\n\n  power(): void {\n    const rootViews = this.roots.views;\n    for (const viewId in rootViews) {\n      const rootView = rootViews[viewId]!;\n      rootView.requireUpdate(this.powerFlags);\n    }\n  }\n\n  unpower(): void {\n    this.cancelUpdate();\n    this.updateDelay = DisplayerService.MinUpdateDelay;\n  }\n\n  @EventHandler({\n    eventType: \"visibilitychange\",\n    target: typeof document !== \"undefined\" ? document : null,\n    handle(event: Event): void {\n      if (document.visibilityState === \"visible\") {\n        this.owner.power();\n      } else {\n        this.owner.unpower();\n      }\n    },\n  })\n  readonly visibilityChange!: EventHandler<this>;\n\n  /** @internal */\n  static MinUpdateDelay: number = 0;\n  /** @internal */\n  static MaxUpdateDelay: number = 167;\n  /** @internal */\n  static MinProcessInterval: number = 12;\n  /** @internal */\n  static MaxProcessInterval: number = 33;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport type {ConstraintVariable} from \"@swim/constraint\";\nimport type {Constraint} from \"@swim/constraint\";\nimport type {ConstraintContext} from \"@swim/constraint\";\nimport {ConstraintSolver} from \"@swim/constraint\";\n\n/** @public */\nexport interface SolverServiceObserver<S extends SolverService = SolverService> extends ServiceObserver<S> {\n}\n\n/** @public */\nexport class SolverService extends Service implements ConstraintContext {\n  constructor() {\n    super();\n    this.solver = this.createSolver();\n  }\n\n  declare readonly observerType?: Class<SolverServiceObserver>;\n\n  readonly solver: ConstraintSolver;\n\n  /** @internal */\n  protected createSolver(): ConstraintSolver {\n    return new ConstraintSolver();\n  }\n\n  /** @override */\n  activateConstraint(constraint: Constraint): void {\n    this.solver.addConstraint(constraint);\n  }\n\n  /** @override */\n  deactivateConstraint(constraint: Constraint): void {\n    this.solver.removeConstraint(constraint);\n  }\n\n  /** @override */\n  activateConstraintVariable(variable: ConstraintVariable): void {\n    this.solver.addConstraintVariable(variable);\n  }\n\n  /** @override */\n  deactivateConstraintVariable(variable: ConstraintVariable): void {\n    this.solver.removeConstraintVariable(variable);\n  }\n\n  /** @override */\n  setConstraintVariable(variable: ConstraintVariable, value: number): void {\n    this.solver.setConstraintVariable(variable, value);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {Timing} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport {Mood} from \"@swim/theme\";\nimport {MoodVector} from \"@swim/theme\";\nimport {Theme} from \"@swim/theme\";\nimport {ThemeMatrix} from \"@swim/theme\";\nimport {View} from \"./View\";\nimport {ViewSet} from \"./ViewSet\";\nimport type {ViewportColorScheme} from \"./Viewport\";\nimport {ViewportService} from \"./ViewportService\";\n\n/** @public */\nexport interface StylerServiceObserver<S extends StylerService = StylerService> extends ServiceObserver<S> {\n  serviceWillAttachRoot?(rootView: View, service: S): void;\n\n  serviceDidAttachRoot?(rootView: View, service: S): void;\n\n  serviceWillDetachRoot?(rootView: View, service: S): void;\n\n  serviceDidDetachRoot?(rootView: View, service: S): void;\n\n  serviceDidSetTheme?(theme: ThemeMatrix, service: S): void;\n\n  serviceDidSetMood?(mood: MoodVector, service: S): void;\n\n  serviceWillApplyTheme?(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean, service: S): void;\n\n  serviceDidApplyTheme?(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean, service: S): void;\n}\n\n/** @public */\nexport class StylerService extends Service {\n  declare readonly observerType?: Class<StylerServiceObserver>;\n\n  @ViewSet({\n    initView(rootView: View): void {\n      rootView.mood.setValue(this.owner.mood.value, Affinity.Inherited);\n      rootView.theme.setValue(this.owner.theme.value, Affinity.Inherited);\n      rootView.requireUpdate(View.NeedsChange);\n    },\n    willAttachView(rootView: View): void {\n      this.owner.callObservers(\"serviceWillAttachRoot\", rootView, this.owner);\n    },\n    didAttachView(rootView: View): void {\n      this.owner.callObservers(\"serviceDidAttachRoot\", rootView, this.owner);\n    },\n    willDetachView(rootView: View): void {\n      this.owner.callObservers(\"serviceWillDetachRoot\", rootView, this.owner);\n    },\n    didDetachView(rootView: View): void {\n      this.owner.callObservers(\"serviceDidDetachRoot\", rootView, this.owner);\n    },\n  })\n  readonly roots!: ViewSet<this, View>;\n\n  @Provider({\n    serviceType: ViewportService,\n    observes: true,\n    serviceDidSetViewportColorScheme(colorScheme: ViewportColorScheme): void {\n      this.owner.theme.update();\n    },\n  })\n  readonly viewport!: Provider<this, ViewportService> & Observes<ViewportService>;\n\n  @Property({\n    valueType: ThemeMatrix,\n    initValue(): ThemeMatrix {\n      return this.detect();\n    },\n    update(): void {\n      if (this.hasAffinity(Affinity.Intrinsic)) {\n        const theme = this.detect();\n        this.setIntrinsic(theme);\n      }\n    },\n    detect(): ThemeMatrix {\n      const viewportService = this.owner.viewport.getService();\n      const colorScheme = viewportService.colorScheme.value;\n      if (colorScheme === \"dark\") {\n        return Theme.dark;\n      } else {\n        return Theme.light;\n      }\n    },\n    didSetValue(theme: ThemeMatrix): void {\n      const rootViews = this.owner.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        rootView.theme.setValue(theme, Affinity.Inherited);\n        rootView.requireUpdate(View.NeedsChange);\n      }\n      this.owner.callObservers(\"serviceDidSetTheme\", theme, this.owner);\n    },\n  })\n  readonly theme!: Property<this, ThemeMatrix> & {\n    update(): void,\n    detect(): ThemeMatrix,\n  };\n\n  @Property({\n    valueType: MoodVector,\n    initValue(): MoodVector {\n      return Mood.default;\n    },\n    didSetValue(mood: MoodVector): void {\n      const rootViews = this.owner.roots.views;\n      for (const viewId in rootViews) {\n        const rootView = rootViews[viewId]!;\n        rootView.mood.setValue(mood, Affinity.Inherited);\n        rootView.requireUpdate(View.NeedsChange);\n      }\n      this.owner.callObservers(\"serviceDidSetMood\", mood, this.owner);\n    },\n  })\n  readonly mood!: Property<this, MoodVector>;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport {Length} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport {Color} from \"@swim/style\";\nimport type {ThemeAnimatorDescriptor} from \"@swim/theme\";\nimport type {ThemeAnimatorClass} from \"@swim/theme\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport type {Look} from \"@swim/theme\";\n\n/** @public */\nexport interface AttributeContext {\n  getAttribute(attributeName: string): string | null;\n\n  setAttribute(attributeName: string, value: unknown): this;\n}\n\n/** @public */\nexport const AttributeContext = {\n  [Symbol.hasInstance](instance: unknown): instance is AttributeContext {\n    return Objects.hasAllKeys<AttributeContext>(instance, \"getAttribute\", \"setAttribute\");\n  },\n};\n\n/** @public */\nexport interface AttributeAnimatorDescriptor<R, T> extends ThemeAnimatorDescriptor<R, T> {\n  extends?: Proto<AttributeAnimator<any, any, any>> | boolean | null;\n  attributeName?: string;\n}\n\n/** @public */\nexport interface AttributeAnimatorClass<A extends AttributeAnimator<any, any, any> = AttributeAnimator<any, any, any>> extends ThemeAnimatorClass<A> {\n}\n\n/** @public */\nexport interface AttributeAnimator<R = any, T = any, I extends any[] = [Look<NonNullable<T>> | T]> extends ThemeAnimator<R, T, I> {\n  /** @override */\n  get descriptorType(): Proto<AttributeAnimatorDescriptor<R, T>>;\n\n  get attributeName(): string;\n\n  get attributeValue(): T;\n\n  getAttributeValue(): NonNullable<T>;\n\n  /** @override @protected */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  parse(value: string): T;\n}\n\n/** @public */\nexport const AttributeAnimator = (<R, T, I extends any[], A extends AttributeAnimator<any, any, any>>() => ThemeAnimator.extend<AttributeAnimator<R, T, I>, AttributeAnimatorClass<A>>(\"AttributeAnimator\", {\n  get attributeName(): string {\n    throw new Error(\"no attribute name\");\n  },\n\n  get attributeValue(): T {\n    if (AttributeContext[Symbol.hasInstance](this.owner)) {\n      const value = this.owner.getAttribute(this.attributeName);\n      if (value !== null) {\n        try {\n          return this.parse(value);\n        } catch (e) {\n          // swallow parse errors\n        }\n      }\n    }\n    return (Object.getPrototypeOf(this) as AttributeAnimator<R, T, I>).value;\n  },\n\n  getAttributeValue(): NonNullable<T> {\n    const attributeValue = this.attributeValue;\n    if (attributeValue === void 0 || attributeValue === null) {\n      let message = attributeValue + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"attribute value\";\n      throw new TypeError(message);\n    }\n    return attributeValue as NonNullable<T>;\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    if (AttributeContext[Symbol.hasInstance](this.owner)) {\n      this.owner.setAttribute(this.attributeName, newValue);\n    }\n    super.onSetValue(newValue, oldValue);\n  },\n\n  parse(): T {\n    throw new Error();\n  },\n},\n{\n  construct(animator: A | null, owner: A extends Fastener<infer R, any, any> ? R : never): A {\n    animator = super.construct(animator, owner) as A;\n    return animator;\n  },\n\n  specialize(template: A extends {readonly descriptorType?: Proto<infer D>} ? D : never): FastenerClass<A> {\n    let superClass = template.extends as FastenerClass<A> | null | undefined;\n    if (superClass === void 0 || superClass === null) {\n      const valueType = template.valueType;\n      if (valueType === String) {\n        superClass = StringAttributeAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Number) {\n        superClass = NumberAttributeAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Boolean) {\n        superClass = BooleanAttributeAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Length) {\n        superClass = LengthAttributeAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Color) {\n        superClass = ColorAttributeAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Transform) {\n        superClass = TransformAttributeAnimator as unknown as FastenerClass<A>;\n      } else {\n        superClass = this;\n      }\n    }\n    return superClass;\n  },\n}))();\n\n/** @internal */\nexport interface StringAttributeAnimator<R = any, T extends string | undefined = string | undefined, I extends any[] = [Look<NonNullable<T>> | T]> extends AttributeAnimator<R, T, I> {\n}\n\n/** @internal */\nexport const StringAttributeAnimator = (<R, T extends string | undefined, I extends any[], A extends StringAttributeAnimator<any, any, any>>() => AttributeAnimator.extend<StringAttributeAnimator<R, T, I>, AttributeAnimatorClass<A>>(\"StringAttributeAnimator\", {\n  valueType: String,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return value as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    return value as T;\n  },\n}))();\n\n/** @internal */\nexport interface NumberAttributeAnimator<R = any, T extends number | undefined = number | undefined, I extends any[] = [Look<NonNullable<T>> | T]> extends AttributeAnimator<R, T, I> {\n}\n\n/** @internal */\nexport const NumberAttributeAnimator = (<R, T extends number | undefined, I extends any[], A extends NumberAttributeAnimator<any, any, any>>() => AttributeAnimator.extend<NumberAttributeAnimator<R, T, I>, AttributeAnimatorClass<A>>(\"NumberAttributeAnimator\", {\n  valueType: Number,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    const number = +value;\n    return isFinite(number) ? number as T : void 0 as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    if (typeof value === \"number\") {\n      return value as T;\n    }\n    const number = +(value as any);\n    return isFinite(number) ? number as T : void 0 as T;\n  },\n}))();\n\n/** @internal */\nexport interface BooleanAttributeAnimator<R = any, T extends boolean | undefined = boolean | undefined, I extends any[] = [Look<NonNullable<T>> | T]> extends AttributeAnimator<R, T, I> {\n}\n\n/** @internal */\nexport const BooleanAttributeAnimator = (<R, T extends boolean | undefined, I extends any[], A extends BooleanAttributeAnimator<any, any, any>>() => AttributeAnimator.extend<BooleanAttributeAnimator<R, T, I>, AttributeAnimatorClass<A>>(\"BooleanAttributeAnimator\", {\n  valueType: Boolean,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return !!value as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    return !!value as T;\n  },\n}))();\n\n/** @internal */\nexport interface LengthAttributeAnimator<R = any, T extends Length | null | undefined = Length | null, I extends any[] = [Look<NonNullable<T>> | T]> extends AttributeAnimator<R, T, I> {\n}\n\n/** @internal */\nexport const LengthAttributeAnimator = (<R, T extends Length | null | undefined, I extends any[], A extends LengthAttributeAnimator<any, any, any>>() => AttributeAnimator.extend<LengthAttributeAnimator<R, T, I>, AttributeAnimatorClass<A>>(\"LengthAttributeAnimator\", {\n  valueType: Length,\n  value: null as T,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return Length.parse(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return Length.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n\n/** @internal */\nexport interface ColorAttributeAnimator<R = any, T extends Color | null | undefined = Color | null, I extends any[] = [Look<NonNullable<T>> | T]> extends AttributeAnimator<R, T, I> {\n}\n\n/** @internal */\nexport const ColorAttributeAnimator = (<R, T extends Color | null | undefined, I extends any[], A extends ColorAttributeAnimator<any, any, any>>() => AttributeAnimator.extend<ColorAttributeAnimator<R, T, I>, AttributeAnimatorClass<A>>(\"ColorAttributeAnimator\", {\n  valueType: Color,\n  value: null as T,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return Color.parse(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return Color.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n\n/** @internal */\nexport interface TransformAttributeAnimator<R = any, T extends Transform | null | undefined = Transform | null, I extends any[] = [Look<NonNullable<T>> | T]> extends AttributeAnimator<R, T, I> {\n}\n\n/** @internal */\nexport const TransformAttributeAnimator = (<R, T extends Transform | null | undefined, I extends any[], A extends TransformAttributeAnimator<any, any, any>>() => AttributeAnimator.extend<TransformAttributeAnimator<R, T, I>, AttributeAnimatorClass<A>>(\"TransformAttributeAnimator\", {\n  valueType: Transform,\n  value: null as T,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return Transform.parse(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return Transform.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport type {LengthUnits} from \"@swim/math\";\nimport type {LengthBasis} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport {PxLength} from \"@swim/math\";\nimport {EmLength} from \"@swim/math\";\nimport {RemLength} from \"@swim/math\";\nimport {PctLength} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport {FontFamily} from \"@swim/style\";\nimport {Font} from \"@swim/style\";\nimport {Color} from \"@swim/style\";\nimport {BoxShadow} from \"@swim/style\";\nimport type {ThemeAnimatorDescriptor} from \"@swim/theme\";\nimport type {ThemeAnimatorClass} from \"@swim/theme\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport type {Look} from \"@swim/theme\";\n\n/** @public */\nexport interface StyleContext {\n  readonly node?: Node;\n\n  getStyle(propertyNames: string | readonly string[]): CSSStyleValue | string | undefined;\n\n  setStyle(propertyName: string, value: unknown, priority?: string): this;\n}\n\n/** @public */\nexport const StyleContext = {\n  [Symbol.hasInstance](instance: unknown): instance is StyleContext {\n    return Objects.hasAllKeys<StyleContext>(instance, \"getStyle\", \"setStyle\");\n  },\n};\n\n/** @public */\nexport interface StyleAnimatorDescriptor<R, T> extends ThemeAnimatorDescriptor<R, T> {\n  extends?: Proto<StyleAnimator<any, any, any>> | boolean | null;\n  propertyNames?: string | readonly string[];\n  priority?: string;\n}\n\n/** @public */\nexport interface StyleAnimatorClass<A extends StyleAnimator<any, any, any> = StyleAnimator> extends ThemeAnimatorClass<A> {\n}\n\n/** @public */\nexport interface StyleAnimator<R = any, T = any, I extends any[] = [Look<NonNullable<T>> | T]> extends ThemeAnimator<R, T, I> {\n  /** @override */\n  get descriptorType(): Proto<StyleAnimatorDescriptor<R, T>>;\n\n  get propertyNames(): string | readonly string[];\n\n  get propertyValue(): T;\n\n  getPropertyValue(): NonNullable<T>;\n\n  get computedValue(): T;\n\n  get cssValue(): T;\n\n  getCssValue(): NonNullable<T>;\n\n  get cssState(): T;\n\n  getCssState(): NonNullable<T>;\n\n  /** @override @protected */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  initPriority(): string | undefined;\n\n  get priority(): string | undefined;\n\n  setPriority(priority: string | undefined): void;\n\n  /** @internal */\n  applyStyle(value: T, priority: string | undefined): void;\n\n  parse(value: string): T;\n\n  fromCssValue(value: CSSStyleValue): T;\n}\n\n/** @public */\nexport const StyleAnimator = (<R, T, I extends any[], A extends StyleAnimator<any, any, any>>() => ThemeAnimator.extend<StyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"StyleAnimator\", {\n  get propertyNames(): string | readonly string[] {\n    throw new Error(\"no property names\");\n  },\n\n  get propertyValue(): T {\n    if (StyleContext[Symbol.hasInstance](this.owner)) {\n      let value: T | CSSStyleValue | string | undefined = this.owner.getStyle(this.propertyNames);\n      if (typeof CSSStyleValue !== \"undefined\" && value instanceof CSSStyleValue) { // CSS Typed OM support\n        try {\n          value = this.fromCssValue(value);\n        } catch (e) {\n          value = \"\" + value; // coerce to string on decode error\n        }\n      }\n      if (typeof value === \"string\" && value.length !== 0) {\n        try {\n          return this.parse(value);\n        } catch (e) {\n          // swallow parse errors\n        }\n      }\n    }\n    return (Object.getPrototypeOf(this) as StyleAnimator<R, T, I>).value;\n  },\n\n  getPropertyValue(): NonNullable<T> {\n    const propertyValue = this.propertyValue;\n    if (propertyValue === void 0 || propertyValue === null) {\n      let message = propertyValue + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"property value\";\n      throw new TypeError(message);\n    }\n    return propertyValue as NonNullable<T>;\n  },\n\n  get computedValue(): T {\n    let computedValue: T | undefined;\n    const node = StyleContext[Symbol.hasInstance](this.owner) ? this.owner.node : void 0;\n    if (node instanceof Element) {\n      const styles = getComputedStyle(node);\n      const propertyNames = this.propertyNames;\n      let propertyValue = \"\";\n      if (typeof propertyNames === \"string\") {\n        propertyValue = styles.getPropertyValue(propertyNames);\n      } else {\n        for (let i = 0; i < propertyNames.length && propertyValue.length === 0; i += 1) {\n          propertyValue = styles.getPropertyValue(propertyNames[i]!);\n        }\n      }\n      if (propertyValue.length !== 0) {\n        try {\n          computedValue = this.parse(propertyValue);\n        } catch (e) {\n          // swallow parse errors\n        }\n      }\n    }\n    if (computedValue === void 0) {\n      computedValue = (Object.getPrototypeOf(this) as StyleAnimator<R, T, I>).value;\n    }\n    return computedValue;\n  },\n\n  get cssValue(): T {\n    const value = this.value;\n    if (!this.definedValue(value)) {\n      return this.computedValue;\n    }\n    return value;\n  },\n\n  getCssValue(): NonNullable<T> {\n    const cssValue = this.cssValue;\n    if (cssValue === void 0 || cssValue === null) {\n      let message = cssValue + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"css value\";\n      throw new TypeError(message);\n    }\n    return cssValue as NonNullable<T>;\n  },\n\n  get cssState(): T {\n    const state = this.state;\n    if (!this.definedValue(state)) {\n      return this.computedValue;\n    }\n    return state;\n  },\n\n  getCssState(): NonNullable<T> {\n    const cssState = this.cssState;\n    if (cssState === void 0 || cssState === null) {\n      let message = cssState + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"css state\";\n      throw new TypeError(message);\n    }\n    return cssState as NonNullable<T>;\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    this.applyStyle(newValue, this.priority);\n    super.onSetValue(newValue, oldValue);\n  },\n\n  priority: void 0,\n\n  initPriority(): string | undefined {\n    return (Object.getPrototypeOf(this) as StyleAnimator<R, T, I>).priority;\n  },\n\n  setPriority(priority: string | undefined): void {\n    (this as Mutable<typeof this>).priority = priority;\n    this.applyStyle(this.value, priority);\n  },\n\n  applyStyle(value: T, priority: string | undefined): void {\n    if (!StyleContext[Symbol.hasInstance](this.owner)) {\n      return;\n    }\n    const propertyNames = this.propertyNames;\n    if (typeof propertyNames === \"string\") {\n      this.owner.setStyle(propertyNames, value, priority);\n    } else {\n      for (let i = 0; i <  propertyNames.length; i += 1) {\n        this.owner.setStyle(propertyNames[i]!, value, priority);\n      }\n    }\n  },\n\n  parse(): T {\n    throw new Error(\"abstract\");\n  },\n\n  fromCssValue(value: CSSStyleValue): T {\n    throw new Error(\"unsupported\");\n  },\n},\n{\n  construct(animator: A | null, owner: A extends Fastener<infer R, any, any> ? R : never): A {\n    animator = super.construct(animator, owner) as A;\n    (animator as Mutable<typeof animator>).priority = animator.initPriority();\n    return animator;\n  },\n\n  specialize(template: A extends {readonly descriptorType?: Proto<infer D>} ? D : never): FastenerClass<A> {\n    let superClass = template.extends as FastenerClass<A> | null | undefined;\n    if (superClass === void 0 || superClass === null) {\n      const valueType = template.valueType;\n      if (valueType === String) {\n        superClass = StringStyleAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Number) {\n        superClass = NumberStyleAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Length) {\n        superClass = LengthStyleAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Color) {\n        superClass = ColorStyleAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === FontFamily) {\n        superClass = FontFamilyStyleAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === BoxShadow) {\n        superClass = BoxShadowStyleAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Transform) {\n        superClass = TransformStyleAnimator as unknown as FastenerClass<A>;\n      } else {\n        superClass = this;\n      }\n    }\n    return superClass;\n  },\n}))();\n\n/** @public */\nexport interface StringStyleAnimator<R = any, T extends string | undefined = string | undefined, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I> {\n}\n\n/** @public */\nexport const StringStyleAnimator = (<R, T extends string | undefined, I extends any[], A extends StringStyleAnimator<any, any, any>>() => StyleAnimator.extend<StringStyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"StringStyleAnimator\", {\n  valueType: String,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return value as T;\n  },\n\n  fromCssValue(value: CSSStyleValue): T {\n    return value.toString() as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    return value as T;\n  },\n}))();\n\n/** @public */\nexport interface NumberStyleAnimator<R = any, T extends number | undefined = number | undefined, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I> {\n}\n\n/** @public */\nexport const NumberStyleAnimator = (<R, T extends number | undefined, I extends any[], A extends NumberStyleAnimator<any, any, any>>() => StyleAnimator.extend<NumberStyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"NumberStyleAnimator\", {\n  valueType: Number,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    const number = +value;\n    return isFinite(number) ? number as T : void 0 as T;\n  },\n\n  fromCssValue(value: CSSStyleValue): T {\n    if (value instanceof CSSNumericValue) {\n      return value.to(\"number\").value as T;\n    }\n    return void 0 as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    if (typeof value === \"number\") {\n      return value as T;\n    }\n    const number = +(value as any);\n    return isFinite(number) ? number as T : void 0 as T;\n  },\n}))();\n\n/** @public */\nexport interface LengthStyleAnimator<R = any, T extends Length | null | undefined = Length | null, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I>, LengthBasis {\n  get units(): LengthUnits | undefined;\n\n  pxValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  emValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  remValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  pctValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  pxState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  emState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  remState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  pctState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  px(basis?: LengthBasis | number, defaultValue?: number): PxLength;\n\n  em(basis?: LengthBasis | number, defaultValue?: number): EmLength;\n\n  rem(basis?: LengthBasis | number, defaultValue?: number): RemLength;\n\n  pct(basis?: LengthBasis | number, defaultValue?: number): PctLength;\n\n  to(units: LengthUnits, basis?: LengthBasis | number, defaultValue?: number): Length;\n\n  /** @override */\n  get emUnit(): Node | number | undefined;\n\n  /** @override */\n  get remUnit(): number | undefined;\n\n  /** @override */\n  get pctUnit(): number | undefined;\n\n  /** @override */\n  parse(value: string): T;\n\n  /** @override */\n  fromCssValue(value: CSSStyleValue): T;\n\n  /** @override */\n  equalValues(newValue: T, oldValue: T | undefined): boolean;\n\n  /** @override */\n  fromLike(value: T | LikeType<T>): T;\n}\n\n/** @public */\nexport const LengthStyleAnimator = (<R, T extends Length | null | undefined, I extends any[], A extends LengthStyleAnimator<any, any, any>>() => StyleAnimator.extend<LengthStyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"LengthStyleAnimator\", {\n  valueType: Length,\n  value: null as T,\n\n  get units(): LengthUnits | undefined {\n    const value = this.cssValue;\n    return value !== void 0 && value !== null ? value.units : void 0;\n  },\n\n  pxValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pxValue(basis);\n  },\n\n  emValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.emValue(basis);\n  },\n\n  remValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.remValue(basis);\n  },\n\n  pctValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pctValue(basis);\n  },\n\n  pxState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pxValue(basis);\n  },\n\n  emState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.emValue(basis);\n  },\n\n  remState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.remValue(basis);\n  },\n\n  pctState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pctValue(basis);\n  },\n\n  px(basis?: LengthBasis | number, defaultValue?: number): PxLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return PxLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.px(basis);\n  },\n\n  em(basis?: LengthBasis | number, defaultValue?: number): EmLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return EmLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.em(basis);\n  },\n\n  rem(basis?: LengthBasis | number, defaultValue?: number): RemLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return RemLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.rem(basis);\n  },\n\n  pct(basis?: LengthBasis | number, defaultValue?: number): PctLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return PctLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pct(basis);\n  },\n\n  to(units: LengthUnits, basis?: LengthBasis | number, defaultValue?: number): Length {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return Length.of(defaultValue !== void 0 ? defaultValue : 0, units);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.to(units, basis);\n  },\n\n  get emUnit(): Node | number | undefined {\n    if (StyleContext[Symbol.hasInstance](this.owner)) {\n      const node = this.owner.node;\n      if (node !== void 0) {\n        return node;\n      }\n    }\n    return 0;\n  },\n\n  get remUnit(): number {\n    return 0;\n  },\n\n  get pctUnit(): number {\n    return 0;\n  },\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return Length.parse(value) as T;\n  },\n\n  fromCssValue(value: CSSStyleValue): T {\n    return Length.fromCssValue(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return Length.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n\n/** @public */\nexport interface ColorStyleAnimator<R = any, T extends Color | null | undefined = Color | null, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I> {\n}\n\n/** @public */\nexport const ColorStyleAnimator = (<R, T extends Color | null | undefined, I extends any[], A extends ColorStyleAnimator<any, any, any>>() => StyleAnimator.extend<ColorStyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"ColorStyleAnimator\", {\n  valueType: Color,\n  value: null as T,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return Color.parse(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return Color.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n\n/** @public */\nexport interface FontFamilyStyleAnimator<R = any, T extends FontFamily | readonly FontFamily[] | undefined = FontFamily | readonly FontFamily[] | undefined, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I> {\n}\n\n/** @public */\nexport const FontFamilyStyleAnimator = (<R, T extends FontFamily | readonly FontFamily[] | undefined, I extends any[], A extends FontFamilyStyleAnimator<any, any, any>>() => StyleAnimator.extend<FontFamilyStyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"FontFamilyStyleAnimator\", {\n  valueType: FontFamily,\n\n  parse(value: string): T {\n    return Font.parse(value).family as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    return Font.family(value as FontFamily | readonly FontFamily[]).family as T;\n  },\n}))();\n\n/** @public */\nexport interface BoxShadowStyleAnimator<R = any, T extends BoxShadow | null | undefined = BoxShadow | null, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I> {\n}\n\n/** @public */\nexport const BoxShadowStyleAnimator = (<R, T extends BoxShadow | null | undefined, I extends any[], A extends BoxShadowStyleAnimator<any, any, any>>() => StyleAnimator.extend<BoxShadowStyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"BoxShadowStyleAnimator\", {\n  valueType: BoxShadow,\n  value: null as T,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return BoxShadow.parse(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return BoxShadow.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n\n/** @public */\nexport interface TransformStyleAnimator<R = any, T extends Transform | null | undefined = Transform | null, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I> {\n}\n\n/** @public */\nexport const TransformStyleAnimator = (<R, T extends Transform | null | undefined, I extends any[], A extends TransformStyleAnimator<any, any, any>>() => StyleAnimator.extend<TransformStyleAnimator<R, T, I>, StyleAnimatorClass<A>>(\"TransformStyleAnimator\", {\n  valueType: Transform,\n  value: null as T,\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    if (newValue !== void 0 && newValue !== null) {\n      return newValue.equals(oldValue);\n    }\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return Transform.parse(value) as T;\n  },\n\n  fromCssValue(value: CSSStyleValue): T {\n    return Transform.fromCssValue(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return Transform.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport type {ConstraintExpressionLike} from \"@swim/constraint\";\nimport {ConstraintExpression} from \"@swim/constraint\";\nimport type {ConstraintTerm} from \"@swim/constraint\";\nimport type {ConstraintVariable} from \"@swim/constraint\";\nimport type {ConstraintStrengthLike} from \"@swim/constraint\";\nimport {ConstraintStrength} from \"@swim/constraint\";\nimport type {Constraint} from \"@swim/constraint\";\nimport {ConstraintScope} from \"@swim/constraint\";\nimport type {ConstraintSolver} from \"@swim/constraint\";\nimport type {LengthUnits} from \"@swim/math\";\nimport type {LengthBasis} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport {PxLength} from \"@swim/math\";\nimport {EmLength} from \"@swim/math\";\nimport {RemLength} from \"@swim/math\";\nimport {PctLength} from \"@swim/math\";\nimport type {Look} from \"@swim/theme\";\nimport {StyleContext} from \"./StyleAnimator\";\nimport type {StyleAnimatorDescriptor} from \"./StyleAnimator\";\nimport type {StyleAnimatorClass} from \"./StyleAnimator\";\nimport {StyleAnimator} from \"./StyleAnimator\";\n\n/** @public */\nexport interface StyleConstraintAnimatorDescriptor<R, T> extends StyleAnimatorDescriptor<R, T> {\n  extends?: Proto<StyleConstraintAnimator<any, any, any>> | boolean | null;\n  strength?: ConstraintStrengthLike;\n  constrained?: boolean;\n}\n\n/** @public */\nexport interface StyleConstraintAnimatorClass<A extends StyleConstraintAnimator<any, any, any> = StyleConstraintAnimator> extends StyleAnimatorClass<A> {\n  /** @internal */\n  readonly ConstrainedFlag: FastenerFlags;\n  /** @internal */\n  readonly ConstrainingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface StyleConstraintAnimator<R = any, T = any, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleAnimator<R, T, I>, ConstraintVariable {\n  /** @override */\n  get descriptorType(): Proto<StyleConstraintAnimatorDescriptor<R, T>>;\n\n  /** @internal @override */\n  isExternal(): boolean;\n\n  /** @internal @override */\n  isDummy(): boolean;\n\n  /** @internal @override */\n  isInvalid(): boolean;\n\n  /** @override */\n  isConstant(): boolean;\n\n  /** @internal */\n  get constraintValue(): T;\n\n  /** @internal @override */\n  evaluateConstraintVariable(): void;\n\n  /** @internal @override */\n  updateConstraintSolution(value: number): void;\n\n  /** @internal @protected */\n  initStrength(): ConstraintStrength;\n\n  /** @override */\n  readonly strength: ConstraintStrength;\n\n  setStrength(strength: ConstraintStrengthLike): void;\n\n  /** @override */\n  get coefficient(): number;\n\n  /** @override */\n  get variable(): ConstraintVariable | null;\n\n  /** @override */\n  get terms(): ReadonlyMap<ConstraintVariable, number>;\n\n  /** @override */\n  get constant(): number;\n\n  /** @override */\n  plus(that: ConstraintExpressionLike): ConstraintExpression;\n\n  /** @override */\n  negative(): ConstraintTerm;\n\n  /** @override */\n  minus(that: ConstraintExpressionLike): ConstraintExpression;\n\n  /** @override */\n  times(scalar: number): ConstraintExpression;\n\n  /** @override */\n  divide(scalar: number): ConstraintExpression;\n\n  get constrained(): boolean;\n\n  constrain(constrained?: boolean): this;\n\n  /** @internal */\n  readonly conditionCount: number;\n\n  /** @internal @override */\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal @override */\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal */\n  get constraining(): boolean;\n\n  /** @internal */\n  startConstraining(): void;\n\n  /** @protected */\n  willStartConstraining(): void;\n\n  /** @protected */\n  onStartConstraining(): void;\n\n  /** @protected */\n  didStartConstraining(): void;\n\n  /** @internal */\n  stopConstraining(): void;\n\n  /** @protected */\n  willStopConstraining(): void;\n\n  /** @protected */\n  onStopConstraining(): void;\n\n  /** @protected */\n  didStopConstraining(): void;\n\n  /** @internal */\n  updateConstraintVariable(): void;\n\n  /** @protected @override */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n\n  /** @internal */\n  toNumber(value: T): number;\n}\n\n/** @public */\nexport const StyleConstraintAnimator = (<R, T, I extends any[], A extends StyleConstraintAnimator<any, any, any>>() => StyleAnimator.extend<StyleConstraintAnimator<R, T, I>, StyleConstraintAnimatorClass<A>>(\"StyleConstraintAnimator\", {\n  isExternal(): boolean {\n    return true;\n  },\n\n  isDummy(): boolean {\n    return false;\n  },\n\n  isInvalid(): boolean {\n    return false;\n  },\n\n  isConstant(): boolean {\n    return false;\n  },\n\n  get constraintValue(): T {\n    return this.computedValue;\n  },\n\n  evaluateConstraintVariable(): void {\n    const constraintScope = this.owner;\n    if (!ConstraintScope[Symbol.hasInstance](constraintScope) || this.constrained || !this.constraining) {\n      return;\n    }\n    const value = this.constraintValue;\n    if (!this.definedValue(value)) {\n      return;\n    }\n    constraintScope.setConstraintVariable(this, this.toNumber(value));\n  },\n\n  updateConstraintSolution(state: number): void {\n    if (this.constrained && this.toNumber(this.state) !== state) {\n      this.setState(state as unknown as T, Affinity.Reflexive);\n    }\n  },\n\n  initStrength(): ConstraintStrength {\n    let strength = (Object.getPrototypeOf(this) as StyleConstraintAnimator).strength as ConstraintStrength | undefined;\n    if (strength === void 0) {\n      strength = ConstraintStrength.Strong;\n    }\n    return strength;\n  },\n\n  setStrength(strength: ConstraintStrengthLike): void {\n    (this as Mutable<typeof this>).strength = ConstraintStrength.fromLike(strength);\n  },\n\n  get coefficient(): number {\n    return 1;\n  },\n\n  get variable(): ConstraintVariable {\n    return this;\n  },\n\n  get terms(): ReadonlyMap<ConstraintVariable, number> {\n    const terms = new Map<ConstraintVariable, number>();\n    terms.set(this, 1);\n    return terms;\n  },\n\n  get constant(): number {\n    return 0;\n  },\n\n  plus(that: ConstraintExpressionLike): ConstraintExpression {\n    that = ConstraintExpression.fromLike(that);\n    if (this === that) {\n      return ConstraintExpression.product(2, this);\n    }\n    return ConstraintExpression.sum(this, that);\n  },\n\n  negative(): ConstraintTerm {\n    return ConstraintExpression.product(-1, this);\n  },\n\n  minus(that: ConstraintExpressionLike): ConstraintExpression {\n    that = ConstraintExpression.fromLike(that);\n    if (this === that) {\n      return ConstraintExpression.zero();\n    }\n    return ConstraintExpression.sum(this, that.negative());\n  },\n\n  times(scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(scalar, this);\n  },\n\n  divide(scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(1 / scalar, this);\n  },\n\n  get constrained(): boolean {\n    return (this.flags & StyleConstraintAnimator.ConstrainedFlag) !== 0;\n  },\n\n  constrain(constrained?: boolean): typeof this {\n    if (constrained === void 0) {\n      constrained = true;\n    }\n    const flags = this.flags;\n    if (constrained && (flags & StyleConstraintAnimator.ConstrainedFlag) === 0) {\n      this.setFlags(flags | StyleConstraintAnimator.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.stopConstraining();\n      }\n    } else if (!constrained && (flags & StyleConstraintAnimator.ConstrainedFlag) !== 0) {\n      this.setFlags(flags & ~StyleConstraintAnimator.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.startConstraining();\n        this.updateConstraintVariable();\n      }\n    }\n    return this;\n  },\n\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount += 1;\n    if (!this.constrained && this.conditionCount === 1 && this.mounted) {\n      this.startConstraining();\n      this.updateConstraintVariable();\n    }\n  },\n\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount -= 1;\n    if (!this.constrained && this.conditionCount === 0 && this.mounted) {\n      this.stopConstraining();\n    }\n  },\n\n  get constraining(): boolean {\n    return (this.flags & StyleConstraintAnimator.ConstrainingFlag) !== 0;\n  },\n\n  startConstraining(): void {\n    if ((this.flags & StyleConstraintAnimator.ConstrainingFlag) !== 0) {\n      return;\n    }\n    this.willStartConstraining();\n    this.setFlags(this.flags | StyleConstraintAnimator.ConstrainingFlag);\n    this.onStartConstraining();\n    this.didStartConstraining();\n  },\n\n  willStartConstraining(): void {\n    // hook\n  },\n\n  onStartConstraining(): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      constraintScope.addConstraintVariable(this);\n    }\n  },\n\n  didStartConstraining(): void {\n    // hook\n  },\n\n  stopConstraining(): void {\n    if ((this.flags & StyleConstraintAnimator.ConstrainingFlag) === 0) {\n      return;\n    }\n    this.willStopConstraining();\n    this.setFlags(this.flags & ~StyleConstraintAnimator.ConstrainingFlag);\n    this.onStopConstraining();\n    this.didStopConstraining();\n  },\n\n  willStopConstraining(): void {\n    // hook\n  },\n\n  onStopConstraining(): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      constraintScope.removeConstraintVariable(this);\n    }\n  },\n\n  didStopConstraining(): void {\n    // hook\n  },\n\n  updateConstraintVariable(): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      let value = this.value;\n      if (!this.definedValue(value)) {\n        value = this.constraintValue;\n      }\n      constraintScope.setConstraintVariable(this, this.toNumber(value));\n    }\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    super.onSetValue(newValue, oldValue);\n    const constraintScope = this.owner;\n    if (this.constraining && ConstraintScope[Symbol.hasInstance](constraintScope)) {\n      constraintScope.setConstraintVariable(this, newValue !== void 0 && newValue !== null ? this.toNumber(newValue) : 0);\n    }\n  },\n\n  onMount(): void {\n    super.onMount();\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.startConstraining();\n    }\n  },\n\n  onUnmount(): void {\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.stopConstraining();\n    }\n    super.onUnmount();\n  },\n\n  toNumber(value: T): number {\n    return value !== void 0 && value !== null ? +value : 0;\n  },\n},\n{\n  construct(animator: A | null, owner: A extends Fastener<infer R, any, any> ? R : never): A {\n    animator = super.construct(animator, owner) as A;\n    (animator as Mutable<typeof animator>).strength = animator.initStrength();\n    (animator as Mutable<typeof animator>).conditionCount = 0;\n    return animator;\n  },\n\n  specialize(template: A extends {readonly descriptorType?: Proto<infer D>} ? D : never): FastenerClass<A> {\n    let superClass = template.extends as FastenerClass<A> | null | undefined;\n    if (superClass === void 0 || superClass === null) {\n      const valueType = template.valueType;\n      if (valueType === Number) {\n        superClass = NumberStyleConstraintAnimator as unknown as FastenerClass<A>;\n      } else if (valueType === Length) {\n        superClass = LengthStyleConstraintAnimator as unknown as FastenerClass<A>;\n      } else {\n        superClass = this;\n      }\n    }\n    return superClass;\n  },\n\n  refine(animatorClass: FastenerClass<StyleConstraintAnimator<any, any, any>>): void {\n    super.refine(animatorClass);\n    const animatorPrototype = animatorClass.prototype;\n\n    let flagsInit = animatorPrototype.flagsInit;\n    if (Object.prototype.hasOwnProperty.call(animatorPrototype, \"constrained\")) {\n      if (animatorPrototype.constrained) {\n        flagsInit |= StyleConstraintAnimator.ConstrainedFlag;\n      } else {\n        flagsInit &= ~StyleConstraintAnimator.ConstrainedFlag;\n      }\n      delete (animatorPrototype as StyleConstraintAnimatorDescriptor<any, any>).constrained;\n    }\n    Object.defineProperty(animatorPrototype, \"flagsInit\", {\n      value: flagsInit,\n      enumerable: true,\n      configurable: true,\n    });\n\n    const strengthDescriptor = Object.getOwnPropertyDescriptor(animatorPrototype, \"strength\");\n    if (strengthDescriptor !== void 0 && \"value\" in strengthDescriptor) {\n      strengthDescriptor.value = ConstraintStrength.fromLike(strengthDescriptor.value);\n      Object.defineProperty(animatorPrototype, \"strength\", strengthDescriptor);\n    }\n  },\n\n  ConstrainedFlag: 1 << (StyleAnimator.FlagShift + 0),\n  ConstrainingFlag: 1 << (StyleAnimator.FlagShift + 1),\n\n  FlagShift: StyleAnimator.FlagShift + 2,\n  FlagMask: (1 << (StyleAnimator.FlagShift + 2)) - 1,\n}))();\n\n/** @public */\nexport interface NumberStyleConstraintAnimator<R = any, T extends number | undefined = number | undefined, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleConstraintAnimator<R, T, I> {\n}\n\n/** @public */\nexport const NumberStyleConstraintAnimator = (<R, T extends number | undefined, I extends any[], A extends NumberStyleConstraintAnimator<any, any, any>>() => StyleConstraintAnimator.extend<NumberStyleConstraintAnimator<R, T, I>, StyleConstraintAnimatorClass<A>>(\"NumberStyleConstraintAnimator\", {\n  valueType: Number,\n\n  toNumber(value: T): number {\n    return typeof value === \"number\" ? value : 0;\n  },\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    const number = +value;\n    return isFinite(number) ? number as T : void 0 as T;\n  },\n\n  fromCssValue(value: CSSStyleValue): T {\n    if (value instanceof CSSNumericValue) {\n      return value.to(\"number\").value as T;\n    }\n    return void 0 as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    if (typeof value === \"number\") {\n      return value as T;\n    }\n    const number = +(value as any);\n    return isFinite(number) ? number as T : void 0 as T;\n  },\n}))();\n\n/** @public */\nexport interface LengthStyleConstraintAnimator<R = any, T extends Length | null | undefined = Length | null, I extends any[] = [Look<NonNullable<T>> | T]> extends StyleConstraintAnimator<R, T, I>, LengthBasis {\n  get units(): LengthUnits | undefined;\n\n  pxValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  emValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  remValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  pctValue(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  pxState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  emState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  remState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  pctState(basis?: LengthBasis | number, defaultValue?: number): number;\n\n  px(basis?: LengthBasis | number, defaultValue?: number): PxLength;\n\n  em(basis?: LengthBasis | number, defaultValue?: number): EmLength;\n\n  rem(basis?: LengthBasis | number, defaultValue?: number): RemLength;\n\n  pct(basis?: LengthBasis | number, defaultValue?: number): PctLength;\n\n  to(units: LengthUnits, basis?: LengthBasis | number, defaultValue?: number): Length;\n\n  /** @override */\n  get emUnit(): Node | number | undefined;\n\n  /** @override */\n  get remUnit(): number | undefined;\n\n  /** @override */\n  get pctUnit(): number | undefined;\n\n  /** @override */\n  parse(value: string): T;\n\n  /** @override */\n  fromCssValue(value: CSSStyleValue): T;\n\n  /** @override */\n  equalValues(newValue: T, oldValue: T | undefined): boolean;\n\n  /** @override */\n  fromLike(value: T | LikeType<T>): T;\n}\n\n/** @public */\nexport const LengthStyleConstraintAnimator = (<R, T extends Length | null | undefined, I extends any[], A extends LengthStyleConstraintAnimator<any, any, any>>() => StyleConstraintAnimator.extend<LengthStyleConstraintAnimator<R, T, I>, StyleConstraintAnimatorClass<A>>(\"LengthStyleConstraintAnimator\", {\n  valueType: Length,\n  value: null as T,\n\n  get units(): LengthUnits | undefined {\n    const value = this.cssValue;\n    return value !== void 0 && value !== null ? value.units : void 0;\n  },\n\n  pxValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pxValue(basis);\n  },\n\n  emValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.emValue(basis);\n  },\n\n  remValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.remValue(basis);\n  },\n\n  pctValue(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pctValue(basis);\n  },\n\n  pxState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pxValue(basis);\n  },\n\n  emState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.emValue(basis);\n  },\n\n  remState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.remValue(basis);\n  },\n\n  pctState(basis?: LengthBasis | number, defaultValue?: number): number {\n    const value = this.cssState;\n    if (value === void 0 || value === null) {\n      return defaultValue !== void 0 ? defaultValue : 0;\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pctValue(basis);\n  },\n\n  px(basis?: LengthBasis | number, defaultValue?: number): PxLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return PxLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.px(basis);\n  },\n\n  em(basis?: LengthBasis | number, defaultValue?: number): EmLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return EmLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.em(basis);\n  },\n\n  rem(basis?: LengthBasis | number, defaultValue?: number): RemLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return RemLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.rem(basis);\n  },\n\n  pct(basis?: LengthBasis | number, defaultValue?: number): PctLength {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return PctLength.of(defaultValue !== void 0 ? defaultValue : 0);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.pct(basis);\n  },\n\n  to(units: LengthUnits, basis?: LengthBasis | number, defaultValue?: number): Length {\n    const value = this.cssValue;\n    if (value === void 0 || value === null) {\n      return Length.of(defaultValue !== void 0 ? defaultValue : 0, units);\n    } else if (basis === void 0) {\n      basis = this;\n    }\n    return value.to(units, basis);\n  },\n\n  get emUnit(): Node | number | undefined {\n    const styleContext = this.owner;\n    if (StyleContext[Symbol.hasInstance](styleContext)) {\n      const node = styleContext.node;\n      if (node !== void 0) {\n        return node;\n      }\n    }\n    return 0;\n  },\n\n  get remUnit(): number {\n    return 0;\n  },\n\n  get pctUnit(): number {\n    return 0;\n  },\n\n  toNumber(value: T): number {\n    return value !== void 0 && value !== null ? value.pxValue() : 0;\n  },\n\n  equalValues(newValue: T, oldValue: T): boolean {\n    return newValue === oldValue;\n  },\n\n  parse(value: string): T {\n    return Length.parse(value) as T;\n  },\n\n  fromCssValue(value: CSSStyleValue): T {\n    return Length.fromCssValue(value) as T;\n  },\n\n  fromLike(value: T | LikeType<T>): T {\n    try {\n      return Length.fromLike(value) as T;\n    } catch (swallow) {\n      return null as T;\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport {Values} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport {Timing} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport type {ConstraintExpressionLike} from \"@swim/constraint\";\nimport type {ConstraintVariable} from \"@swim/constraint\";\nimport type {ConstraintProperty} from \"@swim/constraint\";\nimport type {ConstraintRelation} from \"@swim/constraint\";\nimport type {ConstraintStrengthLike} from \"@swim/constraint\";\nimport type {Constraint} from \"@swim/constraint\";\nimport {ConstraintScope} from \"@swim/constraint\";\nimport {Length} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport type {FontStyle} from \"@swim/style\";\nimport type {FontVariant} from \"@swim/style\";\nimport type {FontWeight} from \"@swim/style\";\nimport type {FontStretch} from \"@swim/style\";\nimport {FontFamily} from \"@swim/style\";\nimport type {FontLike} from \"@swim/style\";\nimport {Font} from \"@swim/style\";\nimport {Color} from \"@swim/style\";\nimport type {LinearGradientLike} from \"@swim/style\";\nimport {LinearGradient} from \"@swim/style\";\nimport {BoxShadow} from \"@swim/style\";\nimport {Look} from \"@swim/theme\";\nimport type {LengthOrLookLike} from \"@swim/theme\";\nimport type {ColorOrLookLike} from \"@swim/theme\";\nimport type {Feel} from \"@swim/theme\";\nimport {Mood} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport {ThemeContext} from \"@swim/theme\";\nimport {StyleAnimator} from \"./StyleAnimator\";\nimport {LengthStyleAnimator} from \"./StyleAnimator\";\nimport {LengthStyleConstraintAnimator} from \"./StyleConstraintAnimator\";\nimport type {AlignContent} from \"./csstypes\";\nimport type {AlignItems} from \"./csstypes\";\nimport type {AlignSelf} from \"./csstypes\";\nimport type {Appearance} from \"./csstypes\";\nimport type {BackgroundClip} from \"./csstypes\";\nimport type {BorderCollapse} from \"./csstypes\";\nimport type {BorderStyle} from \"./csstypes\";\nimport type {BoxSizing} from \"./csstypes\";\nimport type {CssCursor} from \"./csstypes\";\nimport type {CssDisplay} from \"./csstypes\";\nimport type {FlexBasis} from \"./csstypes\";\nimport type {FlexDirection} from \"./csstypes\";\nimport type {FlexWrap} from \"./csstypes\";\nimport type {JustifyContent} from \"./csstypes\";\nimport type {Overflow} from \"./csstypes\";\nimport type {OverscrollBehavior} from \"./csstypes\";\nimport type {PointerEvents} from \"./csstypes\";\nimport type {Position} from \"./csstypes\";\nimport type {TextAlign} from \"./csstypes\";\nimport type {TextDecorationStyle} from \"./csstypes\";\nimport type {TextTransform} from \"./csstypes\";\nimport type {TouchAction} from \"./csstypes\";\nimport type {UserSelect} from \"./csstypes\";\nimport type {VerticalAlign} from \"./csstypes\";\nimport type {Visibility} from \"./csstypes\";\nimport type {WhiteSpace} from \"./csstypes\";\nimport type {StyleContext} from \"./StyleAnimator\";\n\n/** @public */\nexport interface StyleAttributeDescriptor<R> extends FastenerDescriptor<R> {\n  extends?: Proto<StyleAttribute<any>> | boolean | null;\n}\n\n/** @public */\nexport interface StyleAttributeClass<F extends StyleAttribute<any> = StyleAttribute> extends FastenerClass<F> {\n  /** @internal */\n  pctWidthUnit(node: Node | undefined): number;\n\n  /** @internal */\n  pctHeightUnit(node: Node | undefined): number;\n}\n\n/** @public */\nexport interface StyleAttribute<R = any> extends Fastener<R>, ConstraintScope, ThemeContext, StyleContext {\n  /** @override */\n  get descriptorType(): Proto<StyleAttributeDescriptor<R>>;\n\n  /** @override */\n  get fastenerType(): Proto<StyleAttribute<any>>;\n\n  get alignContent(): StyleAnimator<this, AlignContent | undefined>;\n\n  get alignItems(): StyleAnimator<this, AlignItems | undefined>;\n\n  get alignSelf(): StyleAnimator<this, AlignSelf | undefined>;\n\n  get appearance(): StyleAnimator<this, Appearance | undefined>;\n\n  get backdropFilter(): StyleAnimator<this, string | undefined>;\n\n  get backgroundClip(): StyleAnimator<this, BackgroundClip | undefined>;\n\n  get backgroundColor(): StyleAnimator<this, Color | null>;\n\n  get backgroundImage(): StyleAnimator<this, LinearGradient | string | null>;\n\n  get borderCollapse(): StyleAnimator<this, BorderCollapse | undefined>;\n\n  get borderColor(): Fastener<this> & {\n    get(): [Color | null, Color | null, Color | null, Color | null] | Color | null;\n    set(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get borderTopColor(): StyleAnimator<this, Color | null>;\n\n  get borderRightColor(): StyleAnimator<this, Color | null>;\n\n  get borderBottomColor(): StyleAnimator<this, Color | null>;\n\n  get borderLeftColor(): StyleAnimator<this, Color | null>;\n\n  get borderRadius(): Fastener<this> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get borderTopLeftRadius(): LengthStyleAnimator<this, Length | null>;\n\n  get borderTopRightRadius(): LengthStyleAnimator<this, Length | null>;\n\n  get borderBottomRightRadius(): LengthStyleAnimator<this, Length | null>;\n\n  get borderBottomLeftRadius(): LengthStyleAnimator<this, Length | null>;\n\n  get borderSpacing(): StyleAnimator<this, string | undefined>;\n\n  get borderStyle(): Fastener<this> & {\n    get(): [BorderStyle | undefined, BorderStyle | undefined, BorderStyle | undefined, BorderStyle | undefined] | BorderStyle | undefined;\n    set(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get borderTopStyle(): StyleAnimator<this, BorderStyle | undefined>;\n\n  get borderRightStyle(): StyleAnimator<this, BorderStyle | undefined>;\n\n  get borderBottomStyle(): StyleAnimator<this, BorderStyle | undefined>;\n\n  get borderLeftStyle(): StyleAnimator<this, BorderStyle | undefined>;\n\n  get borderWidth(): Fastener<this> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get borderTopWidth(): LengthStyleAnimator<this, Length | null>;\n\n  get borderRightWidth(): LengthStyleAnimator<this, Length | null>;\n\n  get borderBottomWidth(): LengthStyleAnimator<this, Length | null>;\n\n  get borderLeftWidth(): LengthStyleAnimator<this, Length | null>;\n\n  get bottom(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get boxShadow(): StyleAnimator<this, BoxShadow | null>;\n\n  get boxSizing(): StyleAnimator<this, BoxSizing | undefined>;\n\n  get color(): StyleAnimator<this, Color | null>;\n\n  get cursor(): StyleAnimator<this, CssCursor | undefined>;\n\n  get display(): StyleAnimator<this, CssDisplay | undefined>;\n\n  get filter(): StyleAnimator<this, string | undefined>;\n\n  get flexBasis(): StyleAnimator<this, Length | FlexBasis | null>;\n\n  get flexDirection(): StyleAnimator<this, FlexDirection | string>;\n\n  get flexGrow(): StyleAnimator<this, number | undefined>;\n\n  get flexShrink(): StyleAnimator<this, number | undefined>;\n\n  get flexWrap(): StyleAnimator<this, FlexWrap | undefined>;\n\n  get font(): Fastener<this> & {\n    get(): Font | null;\n    set(value: FontLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: FontLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: FontLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get fontFamily(): StyleAnimator<this, FontFamily | readonly FontFamily[] | undefined>;\n\n  get fontSize(): LengthStyleAnimator<this, Length | null>;\n\n  get fontStretch(): StyleAnimator<this, FontStretch | undefined>;\n\n  get fontStyle(): StyleAnimator<this, FontStyle | undefined>;\n\n  get fontVariant(): StyleAnimator<this, FontVariant | undefined>;\n\n  get fontWeight(): StyleAnimator<this, FontWeight | undefined>;\n\n  get height(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get justifyContent(): StyleAnimator<this, JustifyContent | undefined>;\n\n  get left(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get lineHeight(): LengthStyleAnimator<this, Length | null>;\n\n  get margin(): Fastener<this> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get marginTop(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get marginRight(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get marginBottom(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get marginLeft(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get maxHeight(): LengthStyleAnimator<this, Length | null>;\n\n  get maxWidth(): LengthStyleAnimator<this, Length | null>;\n\n  get minHeight(): LengthStyleAnimator<this, Length | null>;\n\n  get minWidth(): LengthStyleAnimator<this, Length | null>;\n\n  get opacity(): StyleAnimator<this, number | undefined>;\n\n  get order(): StyleAnimator<this, number | undefined>;\n\n  get outlineColor(): StyleAnimator<this, Color | null>;\n\n  get outlineOffset(): LengthStyleAnimator<this, Length | null>;\n\n  get outlineStyle(): StyleAnimator<this, BorderStyle | undefined>;\n\n  get outlineWidth(): LengthStyleAnimator<this, Length | null>;\n\n  get overflow(): Fastener<this> & {\n    get(): [Overflow | undefined, Overflow | undefined] | Overflow | undefined;\n    set(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get overflowX(): StyleAnimator<this, Overflow | undefined>;\n\n  get overflowY(): StyleAnimator<this, Overflow | undefined>;\n\n  get overflowScrolling(): StyleAnimator<this, \"auto\" | \"touch\" | undefined>;\n\n  get overscrollBehavior(): Fastener<this> & {\n    get(): [OverscrollBehavior | undefined, OverscrollBehavior | undefined] | OverscrollBehavior | undefined;\n    set(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get overscrollBehaviorX(): StyleAnimator<this, OverscrollBehavior | undefined>;\n\n  get overscrollBehaviorY(): StyleAnimator<this, OverscrollBehavior | undefined>;\n\n  get padding(): Fastener<this> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  };\n\n  get paddingTop(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get paddingRight(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get paddingBottom(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get paddingLeft(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get pointerEvents(): StyleAnimator<this, PointerEvents | undefined>;\n\n  get position(): StyleAnimator<this, Position | undefined>;\n\n  get right(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get textAlign(): StyleAnimator<this, TextAlign | undefined>;\n\n  get textDecorationColor(): StyleAnimator<this, Color | null>;\n\n  get textDecorationLine(): StyleAnimator<this, string | undefined>;\n\n  get textDecorationStyle(): StyleAnimator<this, TextDecorationStyle | undefined>;\n\n  get textOverflow(): StyleAnimator<this, string | undefined>;\n\n  get textTransform(): StyleAnimator<this, TextTransform | undefined>;\n\n  get top(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get touchAction(): StyleAnimator<this, TouchAction | undefined>;\n\n  get transform(): StyleAnimator<this, Transform | null>;\n\n  get userSelect(): StyleAnimator<this, UserSelect | undefined>;\n\n  get verticalAlign(): StyleAnimator<this, VerticalAlign | undefined>;\n\n  get visibility(): StyleAnimator<this, Visibility | undefined>;\n\n  get whiteSpace(): StyleAnimator<this, WhiteSpace | undefined>;\n\n  get width(): LengthStyleConstraintAnimator<this, Length | null>;\n\n  get zIndex(): StyleAnimator<this, number | undefined>;\n\n  set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  set(properties: {[K in keyof StyleAttribute as StyleAttribute[K] extends {set(value: any): any} ? K : never]?: StyleAttribute[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n\n  setIntrinsic<S>(this: S, properties: {[K in keyof S as S[K] extends {setIntrinsic(value: any): any} ? K : never]?: S[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  setIntrinsic(properties: {[K in keyof StyleAttribute as StyleAttribute[K] extends {setIntrinsic(value: any): any} ? K : never]?: StyleAttribute[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n\n  get node(): Node | undefined;\n\n  /** @override */\n  getStyle(propertyNames: string | readonly string[]): CSSStyleValue | string | undefined;\n\n  /** @override */\n  setStyle(propertyName: string, value: unknown, priority?: string): this;\n\n  /** @protected */\n  willSetStyle(propertyName: string, value: unknown, priority: string | undefined): void;\n\n  /** @protected */\n  onSetStyle(propertyName: string, value: unknown, priority: string | undefined): void;\n\n  /** @protected */\n  didSetStyle(propertyName: string, value: unknown, priority: string | undefined): void;\n\n  /** @internal */\n  applyStyles(): void;\n\n  /** @override */\n  constraint(lhs: ConstraintExpressionLike, relation: ConstraintRelation,\n             rhs?: ConstraintExpressionLike, strength?: ConstraintStrengthLike): Constraint;\n\n  /** @override */\n  hasConstraint(constraint: Constraint): boolean;\n\n  /** @override */\n  addConstraint(constraint: Constraint): void;\n\n  /** @override */\n  removeConstraint(constraint: Constraint): void;\n\n  /** @override */\n  constraintVariable(name: string, value?: number, strength?: ConstraintStrengthLike): ConstraintProperty<any, number>;\n\n  /** @override */\n  hasConstraintVariable(variable: ConstraintVariable): boolean;\n\n  /** @override */\n  addConstraintVariable(variable: ConstraintVariable): void;\n\n  /** @override */\n  removeConstraintVariable(variable: ConstraintVariable): void;\n\n  /** @internal @override */\n  setConstraintVariable(constraintVariable: ConstraintVariable, state: number): void;\n\n  /** @override */\n  getLook<T>(look: Look<T>, mood?: MoodVector<Feel> | null): T | undefined;\n\n  /** @override */\n  getLookOr<T, E>(look: Look<T>, elseValue: E): T | E;\n  /** @override */\n  getLookOr<T, E>(look: Look<T>, mood: MoodVector<Feel> | null, elseValue: E): T | E;\n\n  /** @override */\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing?: TimingLike | boolean | null): void;\n}\n\n/** @public */\nexport const StyleAttribute = (<R, F extends StyleAttribute<any>>() => Fastener.extend<StyleAttribute<R>, StyleAttributeClass<F>>(\"StyleAttribute\", {\n  get fastenerType(): Proto<StyleAttribute<any>> {\n    return StyleAttribute;\n  },\n\n  set(properties: {[K in keyof StyleAttribute as StyleAttribute[K] extends {set(value: any): any} ? K : never]?: StyleAttribute[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R {\n    for (const key in properties) {\n      const value = properties[key as keyof typeof properties];\n      const property = (this as any)[key] as {set?(value: any): any} | undefined;\n      if (property === void 0 || property === null) {\n        throw new Error(\"unknown property \" + key);\n      } else if (property.set === void 0) {\n        throw new Error(\"unsettable property \" + key);\n      } else if (property instanceof Animator) {\n        property.set(value, timing);\n      } else {\n        property.set(value);\n      }\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(properties: {[K in keyof StyleAttribute as StyleAttribute[K] extends {setIntrinsic(value: any): any} ? K : never]?: StyleAttribute[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R {\n    for (const key in properties) {\n      const value = properties[key as keyof typeof properties];\n      const property = (this as any)[key] as {setIntrinsic?(value: any): any} | undefined;\n      if (property === void 0 || property === null) {\n        throw new Error(\"unknown property \" + key);\n      } else if (property.setIntrinsic === void 0) {\n        throw new Error(\"unsettable property \" + key);\n      } else if (property instanceof Animator) {\n        property.setIntrinsic(value, timing);\n      } else {\n        property.setIntrinsic(value);\n      }\n    }\n    return this.owner;\n  },\n\n  get node(): Node | undefined {\n    return (this.owner as StyleContext).node;\n  },\n\n  getStyle(propertyNames: string | readonly string[]): CSSStyleValue | string | undefined {\n    return (this.owner as StyleContext).getStyle(propertyNames);\n  },\n\n  setStyle(propertyName: string, value: unknown, priority?: string): StyleAttribute {\n    (this.owner as StyleContext).setStyle(propertyName, value, priority);\n    return this;\n  },\n\n  willSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    // hook\n  },\n\n  onSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    // hook\n  },\n\n  didSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    // hook\n  },\n\n  applyStyles(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof StyleAnimator) {\n        fastener.applyStyle(fastener.value, fastener.priority);\n      }\n    }\n  },\n\n  constraint(lhs: ConstraintExpressionLike, relation: ConstraintRelation,\n             rhs?: ConstraintExpressionLike, strength?: ConstraintStrengthLike): Constraint {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.constraint(lhs, relation, rhs, strength);\n  },\n\n  hasConstraint(constraint: Constraint): boolean {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.hasConstraint(constraint);\n  },\n\n  addConstraint(constraint: Constraint): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.addConstraint(constraint);\n  },\n\n  removeConstraint(constraint: Constraint): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.removeConstraint(constraint);\n  },\n\n  constraintVariable(name: string, value?: number, strength?: ConstraintStrengthLike): ConstraintProperty<any, number> {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.constraintVariable(name, value, strength);\n  },\n\n  hasConstraintVariable(constraintVariable: ConstraintVariable): boolean {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.hasConstraintVariable(constraintVariable);\n  },\n\n  addConstraintVariable(constraintVariable: ConstraintVariable): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.addConstraintVariable(constraintVariable);\n  },\n\n  removeConstraintVariable(constraintVariable: ConstraintVariable): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.removeConstraintVariable(constraintVariable);\n  },\n\n  setConstraintVariable(constraintVariable: ConstraintVariable, state: number): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.setConstraintVariable(constraintVariable, state);\n  },\n\n  getLook<T>(look: Look<T>, mood?: MoodVector<Feel> | null): T | undefined {\n    if (!ThemeContext[Symbol.hasInstance](this.owner)) {\n      return void 0;\n    }\n    return this.owner.getLook(look, mood);\n  },\n\n  getLookOr<T, E>(look: Look<T>, mood: MoodVector<Feel> | null | E, elseValue?: E): T | E {\n    if (ThemeContext[Symbol.hasInstance](this.owner)) {\n      if (arguments.length === 2) {\n        return this.owner.getLookOr(look, mood as E);\n      } else {\n        return this.owner.getLookOr(look, mood as MoodVector<Feel> | null, elseValue!);\n      }\n    } else if (arguments.length === 2) {\n      return mood as E;\n    }\n    return elseValue!;\n  },\n\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing?: TimingLike | boolean | null): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    } else if (timing === void 0 || timing === null || timing === true) {\n      timing = theme.getOr(Look.timing, Mood.ambient, false);\n    } else {\n      timing = Timing.fromLike(timing);\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!] as Fastener<any, any, any> | undefined;\n      if (fastener !== void 0 && \"applyTheme\" in (fastener as any)) {\n        (fastener as any).applyTheme(theme, mood, timing);\n      }\n    }\n  },\n},\n{\n  pctWidthUnit(node: Node | undefined): number {\n    if (node instanceof HTMLElement) {\n      const offsetParent = node.offsetParent;\n      if (offsetParent instanceof HTMLElement) {\n        return offsetParent.offsetWidth;\n      }\n    }\n    if (node === document.body || node === document.documentElement) {\n      return window.innerWidth;\n    }\n    return 0;\n  },\n\n  pctHeightUnit(node: Node | undefined): number {\n    if (node instanceof HTMLElement) {\n      const offsetParent = node.offsetParent;\n      if (offsetParent instanceof HTMLElement) {\n        return offsetParent.offsetHeight;\n      }\n    }\n    if (node === document.body || node === document.documentElement) {\n      return window.innerHeight;\n    }\n    return 0;\n  },\n\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    StyleAttribute.initFasteners(fastener);\n    return fastener;\n  },\n}))();\n\nStyleAttribute.defineGetter(\"alignContent\", [StyleAnimator({\n  propertyNames: \"align-content\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"alignItems\", [StyleAnimator({\n  propertyNames: \"align-items\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"alignSelf\", [StyleAnimator({\n  propertyNames: \"align-self\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"appearance\", [StyleAnimator({\n  propertyNames: [\"appearance\", \"-webkit-appearance\"],\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"backdropFilter\", [StyleAnimator({\n  propertyNames: [\"backdrop-filter\", \"-webkit-backdrop-filter\"],\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"backgroundClip\", [StyleAnimator({\n  propertyNames: [\"background-clip\", \"-webkit-background-clip\"],\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"backgroundColor\", [StyleAnimator({\n  propertyNames: \"background-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"backgroundImage\", [StyleAnimator({\n  propertyNames: \"background-image\",\n  value: null,\n  parse(value: string): LinearGradient | string | null {\n    try {\n      return LinearGradient.parse(value);\n    } catch (swallow) {\n      return value;\n    }\n  },\n  fromLike(value: LinearGradientLike | string | null): LinearGradient | string | null {\n    if (typeof value === \"string\") {\n      try {\n        return LinearGradient.parse(value);\n      } catch (swallow) {\n        return value;\n      }\n    } else {\n      return LinearGradient.fromLike(value);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"borderCollapse\", [StyleAnimator({\n  propertyNames: \"border-collapse\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"borderColor\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [Color | null, Color | null, Color | null, Color | null] | Color | null;\n    set(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [Color | null, Color | null, Color | null, Color | null] | Color | null {\n    const borderTopColor = this.owner.borderTopColor.value;\n    const borderRightColor = this.owner.borderRightColor.value;\n    const borderBottomColor = this.owner.borderBottomColor.value;\n    const borderLeftColor = this.owner.borderLeftColor.value;\n    if (Values.equal(borderTopColor, borderRightColor)\n        && Values.equal(borderRightColor, borderBottomColor)\n        && Values.equal(borderBottomColor, borderLeftColor)) {\n      return borderTopColor;\n    }\n    return [borderTopColor, borderRightColor, borderBottomColor, borderLeftColor];\n  },\n  set(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | Color | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [ColorOrLookLike | null, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?, (ColorOrLookLike | null)?] | ColorOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    let borderTopColor: ColorOrLookLike | null;\n    let borderRightColor: ColorOrLookLike | null;\n    let borderBottomColor: ColorOrLookLike | null;\n    let borderLeftColor: ColorOrLookLike | null;\n    if (!Array.isArray(value)) {\n      borderTopColor = value as ColorOrLookLike | null;\n      borderRightColor = value as ColorOrLookLike | null;\n      borderBottomColor = value as ColorOrLookLike | null;\n      borderLeftColor = value as ColorOrLookLike | null;\n    } else if (value.length === 1) {\n      borderTopColor = value[0];\n      borderRightColor = value[0];\n      borderBottomColor = value[0];\n      borderLeftColor = value[0];\n    } else if (value.length === 2) {\n      borderTopColor = value[0];\n      borderRightColor = value[1];\n      borderBottomColor = value[0];\n      borderLeftColor = value[1];\n    } else if (value.length === 3) {\n      borderTopColor = value[0];\n      borderRightColor = value[1];\n      borderBottomColor = value[2];\n      borderLeftColor = value[1];\n    } else if (value.length === 4) {\n      borderTopColor = value[0];\n      borderRightColor = value[1];\n      borderBottomColor = value[2];\n      borderLeftColor = value[3];\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n    if (borderTopColor instanceof Look) {\n      this.owner.borderTopColor.setLook(borderTopColor, timing, affinity);\n    } else {\n      this.owner.borderTopColor.setState(borderTopColor, timing, affinity);\n    }\n    if (borderRightColor instanceof Look) {\n      this.owner.borderRightColor.setLook(borderRightColor, timing, affinity);\n    } else {\n      this.owner.borderRightColor.setState(borderRightColor, timing, affinity);\n    }\n    if (borderBottomColor instanceof Look) {\n      this.owner.borderBottomColor.setLook(borderBottomColor, timing, affinity);\n    } else {\n      this.owner.borderBottomColor.setState(borderBottomColor, timing, affinity);\n    }\n    if (borderLeftColor instanceof Look) {\n      this.owner.borderLeftColor.setLook(borderLeftColor, timing, affinity);\n    } else {\n      this.owner.borderLeftColor.setState(borderLeftColor, timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"borderTopColor\", [StyleAnimator({\n  propertyNames: \"border-top-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderRightColor\", [StyleAnimator({\n  propertyNames: \"border-right-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderBottomColor\", [StyleAnimator({\n  propertyNames: \"border-bottom-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderLeftColor\", [StyleAnimator({\n  propertyNames: \"border-left-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderRadius\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [Length | null, Length | null, Length | null, Length | null] | Length | null {\n    const borderTopLeftRadius = this.owner.borderTopLeftRadius.value;\n    const borderTopRightRadius = this.owner.borderTopRightRadius.value;\n    const borderBottomRightRadius = this.owner.borderBottomRightRadius.value;\n    const borderBottomLeftRadius = this.owner.borderBottomLeftRadius.value;\n    if (Equals(borderTopLeftRadius, borderTopRightRadius)\n        && Equals(borderTopRightRadius, borderBottomRightRadius)\n        && Equals(borderBottomRightRadius, borderBottomLeftRadius)) {\n      return borderTopLeftRadius;\n    }\n    return [borderTopLeftRadius, borderTopRightRadius, borderBottomRightRadius, borderBottomLeftRadius];\n  },\n  set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    let borderTopLeftRadius: LengthOrLookLike | null;\n    let borderTopRightRadius: LengthOrLookLike | null;\n    let borderBottomRightRadius: LengthOrLookLike | null;\n    let borderBottomLeftRadius: LengthOrLookLike | null;\n    if (!Array.isArray(value)) {\n      borderTopLeftRadius = value as LengthOrLookLike | null;\n      borderTopRightRadius = value as LengthOrLookLike | null;\n      borderBottomRightRadius = value as LengthOrLookLike | null;\n      borderBottomLeftRadius = value as LengthOrLookLike | null;\n    } else if (value.length === 1) {\n      borderTopLeftRadius = value[0];\n      borderTopRightRadius = value[0];\n      borderBottomRightRadius = value[0];\n      borderBottomLeftRadius = value[0];\n    } else if (value.length === 2) {\n      borderTopLeftRadius = value[0];\n      borderTopRightRadius = value[1];\n      borderBottomRightRadius = value[0];\n      borderBottomLeftRadius = value[1];\n    } else if (value.length === 3) {\n      borderTopLeftRadius = value[0];\n      borderTopRightRadius = value[1];\n      borderBottomRightRadius = value[2];\n      borderBottomLeftRadius = value[1];\n    } else if (value.length === 4) {\n      borderTopLeftRadius = value[0];\n      borderTopRightRadius = value[1];\n      borderBottomRightRadius = value[2];\n      borderBottomLeftRadius = value[3];\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n    if (borderTopLeftRadius instanceof Look) {\n      this.owner.borderTopLeftRadius.setLook(borderTopLeftRadius, timing, affinity);\n    } else {\n      this.owner.borderTopLeftRadius.setState(borderTopLeftRadius, timing, affinity);\n    }\n    if (borderTopRightRadius instanceof Look) {\n      this.owner.borderTopRightRadius.setLook(borderTopRightRadius, timing, affinity);\n    } else {\n      this.owner.borderTopRightRadius.setState(borderTopRightRadius, timing, affinity);\n    }\n    if (borderBottomRightRadius instanceof Look) {\n      this.owner.borderBottomRightRadius.setLook(borderBottomRightRadius, timing, affinity);\n    } else {\n      this.owner.borderBottomRightRadius.setState(borderBottomRightRadius, timing, affinity);\n    }\n    if (borderBottomLeftRadius instanceof Look) {\n      this.owner.borderBottomLeftRadius.setLook(borderBottomLeftRadius, timing, affinity);\n    } else {\n      this.owner.borderBottomLeftRadius.setState(borderBottomLeftRadius, timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"borderTopLeftRadius\", [LengthStyleAnimator({\n  propertyNames: \"border-top-left-radius\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderTopRightRadius\", [LengthStyleAnimator({\n  propertyNames: \"border-top-right-radius\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderBottomRightRadius\", [LengthStyleAnimator({\n  propertyNames: \"border-bottom-right-radius\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderBottomLeftRadius\", [LengthStyleAnimator({\n  propertyNames: \"border-bottom-left-radius\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderSpacing\", [StyleAnimator({\n  propertyNames: \"border-spacing\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"borderStyle\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [BorderStyle | undefined, BorderStyle | undefined, BorderStyle | undefined, BorderStyle | undefined] | BorderStyle | undefined;\n    set(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [BorderStyle | undefined, BorderStyle | undefined, BorderStyle | undefined, BorderStyle | undefined] | BorderStyle | undefined {\n    const borderTopStyle = this.owner.borderTopStyle.value;\n    const borderRightStyle = this.owner.borderRightStyle.value;\n    const borderBottomStyle = this.owner.borderBottomStyle.value;\n    const borderLeftStyle = this.owner.borderLeftStyle.value;\n    if (borderTopStyle === borderRightStyle\n        && borderRightStyle === borderBottomStyle\n        && borderBottomStyle === borderLeftStyle) {\n      return borderTopStyle;\n    }\n    return [borderTopStyle, borderRightStyle, borderBottomStyle, borderLeftStyle];\n  },\n  set(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [BorderStyle | undefined, (BorderStyle | undefined)?, (BorderStyle | undefined)?, (BorderStyle | undefined)?] | BorderStyle | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    if (!Array.isArray(value)) {\n      this.owner.borderTopStyle.setState(value as BorderStyle | undefined, timing, affinity);\n      this.owner.borderRightStyle.setState(value as BorderStyle | undefined, timing, affinity);\n      this.owner.borderBottomStyle.setState(value as BorderStyle | undefined, timing, affinity);\n      this.owner.borderLeftStyle.setState(value as BorderStyle | undefined, timing, affinity);\n    } else if (value.length === 1) {\n      this.owner.borderTopStyle.setState(value[0], timing, affinity);\n      this.owner.borderRightStyle.setState(value[0], timing, affinity);\n      this.owner.borderBottomStyle.setState(value[0], timing, affinity);\n      this.owner.borderLeftStyle.setState(value[0], timing, affinity);\n    } else if (value.length === 2) {\n      this.owner.borderTopStyle.setState(value[0], timing, affinity);\n      this.owner.borderRightStyle.setState(value[1], timing, affinity);\n      this.owner.borderBottomStyle.setState(value[0], timing, affinity);\n      this.owner.borderLeftStyle.setState(value[1], timing, affinity);\n    } else if (value.length === 3) {\n      this.owner.borderTopStyle.setState(value[0], timing, affinity);\n      this.owner.borderRightStyle.setState(value[1], timing, affinity);\n      this.owner.borderBottomStyle.setState(value[2], timing, affinity);\n      this.owner.borderLeftStyle.setState(value[1], timing, affinity);\n    } else if (value.length === 4) {\n      this.owner.borderTopStyle.setState(value[0], timing, affinity);\n      this.owner.borderRightStyle.setState(value[1], timing, affinity);\n      this.owner.borderBottomStyle.setState(value[2], timing, affinity);\n      this.owner.borderLeftStyle.setState(value[3], timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"borderTopStyle\", [StyleAnimator({\n  propertyNames: \"border-top-style\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"borderRightStyle\", [StyleAnimator({\n  propertyNames: \"border-right-style\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"borderBottomStyle\", [StyleAnimator({\n  propertyNames: \"border-bottom-style\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"borderLeftStyle\", [StyleAnimator({\n  propertyNames: \"border-left-style\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"borderWidth\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [Length | null, Length | null, Length | null, Length | null] | Length | null {\n    const borderTopWidth = this.owner.borderTopWidth.value;\n    const borderRightWidth = this.owner.borderRightWidth.value;\n    const borderBottomWidth = this.owner.borderBottomWidth.value;\n    const borderLeftWidth = this.owner.borderLeftWidth.value;\n    if (Values.equal(borderTopWidth, borderRightWidth)\n        && Values.equal(borderRightWidth, borderBottomWidth)\n        && Values.equal(borderBottomWidth, borderLeftWidth)) {\n      return borderTopWidth;\n    }\n    return [borderTopWidth, borderRightWidth, borderBottomWidth, borderLeftWidth];\n  },\n  set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    let borderTopWidth: LengthOrLookLike | null;\n    let borderRightWidth: LengthOrLookLike | null;\n    let borderBottomWidth: LengthOrLookLike | null;\n    let borderLeftWidth: LengthOrLookLike | null;\n    if (!Array.isArray(value)) {\n      borderTopWidth = value as LengthOrLookLike | null;\n      borderRightWidth = value as LengthOrLookLike | null;\n      borderBottomWidth = value as LengthOrLookLike | null;\n      borderLeftWidth = value as LengthOrLookLike | null;\n    } else if (value.length === 1) {\n      borderTopWidth = value[0];\n      borderRightWidth = value[0];\n      borderBottomWidth = value[0];\n      borderLeftWidth = value[0];\n    } else if (value.length === 2) {\n      borderTopWidth = value[0];\n      borderRightWidth = value[1];\n      borderBottomWidth = value[0];\n      borderLeftWidth = value[1];\n    } else if (value.length === 3) {\n      borderTopWidth = value[0];\n      borderRightWidth = value[1];\n      borderBottomWidth = value[2];\n      borderLeftWidth = value[1];\n    } else if (value.length === 4) {\n      borderTopWidth = value[0];\n      borderRightWidth = value[1];\n      borderBottomWidth = value[2];\n      borderLeftWidth = value[3];\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n    if (borderTopWidth instanceof Look) {\n      this.owner.borderTopWidth.setLook(borderTopWidth, timing, affinity);\n    } else {\n      this.owner.borderTopWidth.setState(borderTopWidth, timing, affinity);\n    }\n    if (borderRightWidth instanceof Look) {\n      this.owner.borderRightWidth.setLook(borderRightWidth, timing, affinity);\n    } else {\n      this.owner.borderRightWidth.setState(borderRightWidth, timing, affinity);\n    }\n    if (borderBottomWidth instanceof Look) {\n      this.owner.borderBottomWidth.setLook(borderBottomWidth, timing, affinity);\n    } else {\n      this.owner.borderBottomWidth.setState(borderBottomWidth, timing, affinity);\n    }\n    if (borderLeftWidth instanceof Look) {\n      this.owner.borderLeftWidth.setLook(borderLeftWidth, timing, affinity);\n    } else {\n      this.owner.borderLeftWidth.setState(borderLeftWidth, timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"borderTopWidth\", [LengthStyleAnimator({\n  propertyNames: \"border-top-width\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderRightWidth\", [LengthStyleAnimator({\n  propertyNames: \"border-right-width\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderBottomWidth\", [LengthStyleAnimator({\n  propertyNames: \"border-bottom-width\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"borderLeftWidth\", [LengthStyleAnimator({\n  propertyNames: \"border-left-width\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"bottom\", [LengthStyleConstraintAnimator({\n  propertyNames: \"bottom\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctHeightUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"boxShadow\", [StyleAnimator({\n  propertyNames: \"box-shadow\",\n  valueType: BoxShadow,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"boxSizing\", [StyleAnimator({\n  propertyNames: \"box-sizing\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"color\", [StyleAnimator({\n  propertyNames: \"color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"cursor\", [StyleAnimator({\n  propertyNames: \"cursor\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"display\", [StyleAnimator({\n  propertyNames: \"display\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"filter\", [StyleAnimator({\n  propertyNames: \"filter\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"flexBasis\", [StyleAnimator({\n  propertyNames: \"flex-basis\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"flexDirection\", [StyleAnimator({\n  propertyNames: \"flex-direction\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"flexGrow\", [StyleAnimator({\n  propertyNames: \"flex-grow\",\n  valueType: Number,\n})]);\n\nStyleAttribute.defineGetter(\"flexShrink\", [StyleAnimator({\n  propertyNames: \"flex-shrink\",\n  valueType: Number,\n})]);\n\nStyleAttribute.defineGetter(\"flexWrap\", [StyleAnimator({\n  propertyNames: \"flex-wrap\",\n  valueType: Number,\n})]);\n\nStyleAttribute.defineGetter(\"font\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): Font | null;\n    set(value: FontLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: FontLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: FontLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): Font | null {\n    const style = this.owner.fontStyle.value;\n    const variant = this.owner.fontVariant.value;\n    const weight = this.owner.fontWeight.value;\n    const stretch = this.owner.fontStretch.value;\n    const size = this.owner.fontSize.value;\n    const height = this.owner.lineHeight.value;\n    const family = this.owner.fontFamily.value;\n    if (family === void 0) {\n      return null;\n    }\n    return Font.create(style, variant, weight, stretch, size, height, family);\n  },\n  set(value: FontLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: FontLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: FontLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    if (value === null) {\n      this.owner.fontStyle.setState(void 0, timing, affinity);\n      this.owner.fontVariant.setState(void 0, timing, affinity);\n      this.owner.fontWeight.setState(void 0, timing, affinity);\n      this.owner.fontStretch.setState(void 0, timing, affinity);\n      this.owner.fontSize.setState(null, timing, affinity);\n      this.owner.lineHeight.setState(null, timing, affinity);\n      this.owner.fontFamily.setState(void 0, timing, affinity);\n      return;\n    }\n    value = Font.fromLike(value);\n    this.owner.fontStyle.setState(value.style, timing, affinity);\n    this.owner.fontVariant.setState(value.variant, timing, affinity);\n    this.owner.fontWeight.setState(value.weight, timing, affinity);\n    this.owner.fontStretch.setState(value.stretch, timing, affinity);\n    this.owner.fontSize.setState(value.size, timing, affinity);\n    this.owner.lineHeight.setState(value.height, timing, affinity);\n    this.owner.fontFamily.setState(value.family, timing, affinity);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"fontFamily\", [StyleAnimator({\n  propertyNames: \"font-family\",\n  valueType: FontFamily,\n})]);\n\nStyleAttribute.defineGetter(\"fontSize\", [LengthStyleAnimator({\n  propertyNames: \"font-size\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"fontStretch\", [StyleAnimator({\n  propertyNames: \"font-stretch\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"fontStyle\", [StyleAnimator({\n  propertyNames: \"font-style\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"fontVariant\", [StyleAnimator({\n  propertyNames: \"font-variant\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"fontWeight\", [StyleAnimator({\n  propertyNames: \"font-weight\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"height\", [LengthStyleConstraintAnimator({\n  propertyNames: \"height\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctHeightUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"justifyContent\", [StyleAnimator({\n  propertyNames: \"justify-content\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"left\", [LengthStyleConstraintAnimator({\n  propertyNames: \"left\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"lineHeight\", [LengthStyleAnimator({\n  propertyNames: \"line-height\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"margin\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [Length | null, Length | null, Length | null, Length | null] | Length | null {\n    const marginTop = this.owner.marginTop.value;\n    const marginRight = this.owner.marginRight.value;\n    const marginBottom = this.owner.marginBottom.value;\n    const marginLeft = this.owner.marginLeft.value;\n    if (Values.equal(marginTop, marginRight)\n        && Values.equal(marginRight, marginBottom)\n        && Values.equal(marginBottom, marginLeft)) {\n      return marginTop;\n    }\n    return [marginTop, marginRight, marginBottom, marginLeft];\n  },\n  set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    let marginTop: LengthOrLookLike | null;\n    let marginRight: LengthOrLookLike | null;\n    let marginBottom: LengthOrLookLike | null;\n    let marginLeft: LengthOrLookLike | null;\n    if (!Array.isArray(value)) {\n      marginTop = value as LengthOrLookLike | null;\n      marginRight = value as LengthOrLookLike | null;\n      marginBottom = value as LengthOrLookLike | null;\n      marginLeft = value as LengthOrLookLike | null;\n    } else if (value.length === 1) {\n      marginTop = value[0];\n      marginRight = value[0];\n      marginBottom = value[0];\n      marginLeft = value[0];\n    } else if (value.length === 2) {\n      marginTop = value[0];\n      marginRight = value[1];\n      marginBottom = value[0];\n      marginLeft = value[1];\n    } else if (value.length === 3) {\n      marginTop = value[0];\n      marginRight = value[1];\n      marginBottom = value[2];\n      marginLeft = value[1];\n    } else if (value.length === 4) {\n      marginTop = value[0];\n      marginRight = value[1];\n      marginBottom = value[2];\n      marginLeft = value[3];\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n    if (marginTop instanceof Look) {\n      this.owner.marginTop.setLook(marginTop, timing, affinity);\n    } else {\n      this.owner.marginTop.setState(marginTop, timing, affinity);\n    }\n    if (marginRight instanceof Look) {\n      this.owner.marginRight.setLook(marginRight, timing, affinity);\n    } else {\n      this.owner.marginRight.setState(marginRight, timing, affinity);\n    }\n    if (marginBottom instanceof Look) {\n      this.owner.marginBottom.setLook(marginBottom, timing, affinity);\n    } else {\n      this.owner.marginBottom.setState(marginBottom, timing, affinity);\n    }\n    if (marginLeft instanceof Look) {\n      this.owner.marginLeft.setLook(marginLeft, timing, affinity);\n    } else {\n      this.owner.marginLeft.setState(marginLeft, timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"marginTop\", [LengthStyleConstraintAnimator({\n  propertyNames: \"margin-top\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"marginRight\", [LengthStyleConstraintAnimator({\n  propertyNames: \"margin-right\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"marginBottom\", [LengthStyleConstraintAnimator({\n  propertyNames: \"margin-bottom\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"marginLeft\", [LengthStyleConstraintAnimator({\n  propertyNames: \"margin-left\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"maxHeight\", [LengthStyleAnimator({\n  propertyNames: \"max-height\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"maxWidth\", [LengthStyleAnimator({\n  propertyNames: \"max-width\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"minHeight\", [LengthStyleAnimator({\n  propertyNames: \"min-height\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"minWidth\", [LengthStyleAnimator({\n  propertyNames: \"min-width\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"opacity\", [StyleAnimator({\n  propertyNames: \"opacity\",\n  valueType: Number,\n})]);\n\nStyleAttribute.defineGetter(\"order\", [StyleAnimator({\n  propertyNames: \"order\",\n  valueType: Number,\n})]);\n\nStyleAttribute.defineGetter(\"outlineColor\", [StyleAnimator({\n  propertyNames: \"outline-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"outlineOffset\", [LengthStyleAnimator({\n  propertyNames: \"outline-offset\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"outlineStyle\", [StyleAnimator({\n  propertyNames: \"outline-style\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"outlineWidth\", [LengthStyleAnimator({\n  propertyNames: \"outline-width\",\n  valueType: Length,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"overflow\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [Overflow | undefined, Overflow | undefined] | Overflow | undefined;\n    set(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [Overflow | undefined, Overflow | undefined] | Overflow | undefined {\n    const overflowX = this.owner.overflowX.value;\n    const overflowY = this.owner.overflowY.value;\n    if (overflowX === overflowY) {\n      return overflowX;\n    }\n    return [overflowX, overflowY];\n  },\n  set(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [Overflow | undefined, (Overflow | undefined)?] | Overflow | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    if (!Array.isArray(value)) {\n      this.owner.overflowX.setState(value as Overflow | undefined, timing, affinity);\n      this.owner.overflowY.setState(value as Overflow | undefined, timing, affinity);\n    } else if (value.length === 1) {\n      this.owner.overflowX.setState(value[0], timing, affinity);\n      this.owner.overflowY.setState(value[0], timing, affinity);\n    } else if (value.length === 2) {\n      this.owner.overflowX.setState(value[0], timing, affinity);\n      this.owner.overflowY.setState(value[1], timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"overflowX\", [StyleAnimator({\n  propertyNames: \"overflow-x\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"overflowY\", [StyleAnimator({\n  propertyNames: \"overflow-y\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"overflowScrolling\", [StyleAnimator({\n  propertyNames: \"-webkit-overflow-scrolling\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"overscrollBehavior\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [OverscrollBehavior | undefined, OverscrollBehavior | undefined] | OverscrollBehavior | undefined;\n    set(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [OverscrollBehavior | undefined, OverscrollBehavior | undefined] | OverscrollBehavior | undefined {\n    const overscrollBehaviorX = this.owner.overscrollBehaviorX.value;\n    const overscrollBehaviorY = this.owner.overscrollBehaviorY.value;\n    if (overscrollBehaviorX === overscrollBehaviorY) {\n      return overscrollBehaviorX;\n    }\n    return [overscrollBehaviorX, overscrollBehaviorY];\n  },\n  set(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [OverscrollBehavior | undefined, (OverscrollBehavior | undefined)?] | OverscrollBehavior | undefined, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    if (!Array.isArray(value)) {\n      this.owner.overscrollBehaviorX.setState(value as OverscrollBehavior | undefined, timing, affinity);\n      this.owner.overscrollBehaviorY.setState(value as OverscrollBehavior | undefined, timing, affinity);\n    } else if (value.length === 1) {\n      this.owner.overscrollBehaviorX.setState(value[0], timing, affinity);\n      this.owner.overscrollBehaviorY.setState(value[0], timing, affinity);\n    } else if (value.length === 2) {\n      this.owner.overscrollBehaviorX.setState(value[0], timing, affinity);\n      this.owner.overscrollBehaviorY.setState(value[1], timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"overscrollBehaviorX\", [StyleAnimator({\n  propertyNames: \"overscroll-behavior-x\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"overscrollBehaviorY\", [StyleAnimator({\n  propertyNames: \"overscroll-behavior-y\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"padding\", [Fastener<Fastener<StyleAttribute<unknown>> & {\n    get(): [Length | null, Length | null, Length | null, Length | null] | Length | null;\n    set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute;\n    setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void;\n  }>({\n  get(): [Length | null, Length | null, Length | null, Length | null] | Length | null {\n    const paddingTop = this.owner.paddingTop.value;\n    const paddingRight = this.owner.paddingRight.value;\n    const paddingBottom = this.owner.paddingBottom.value;\n    const paddingLeft = this.owner.paddingLeft.value;\n    if (Values.equal(paddingTop, paddingRight)\n        && Values.equal(paddingRight, paddingBottom)\n        && Values.equal(paddingBottom, paddingLeft)) {\n      return paddingTop;\n    }\n    return [paddingTop, paddingRight, paddingBottom, paddingLeft];\n  },\n  set(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Extrinsic);\n    return this.owner;\n  },\n  setIntrinsic(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing?: TimingLike | boolean | null): StyleAttribute {\n    this.setState(value, timing, Affinity.Intrinsic);\n    return this.owner;\n  },\n  setState(value: readonly [LengthOrLookLike | null, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?, (LengthOrLookLike | null)?] | LengthOrLookLike | null, timing: TimingLike | boolean | null | undefined, affinity: Affinity): void {\n    let paddingTop: LengthOrLookLike | null;\n    let paddingRight: LengthOrLookLike | null;\n    let paddingBottom: LengthOrLookLike | null;\n    let paddingLeft: LengthOrLookLike | null;\n    if (!Array.isArray(value)) {\n      paddingTop = value as LengthOrLookLike | null;\n      paddingRight = value as LengthOrLookLike | null;\n      paddingBottom = value as LengthOrLookLike | null;\n      paddingLeft = value as LengthOrLookLike | null;\n    } else if (value.length === 1) {\n      paddingTop = value[0];\n      paddingRight = value[0];\n      paddingBottom = value[0];\n      paddingLeft = value[0];\n    } else if (value.length === 2) {\n      paddingTop = value[0];\n      paddingRight = value[1];\n      paddingBottom = value[0];\n      paddingLeft = value[1];\n    } else if (value.length === 3) {\n      paddingTop = value[0];\n      paddingRight = value[1];\n      paddingBottom = value[2];\n      paddingLeft = value[1];\n    } else if (value.length === 4) {\n      paddingTop = value[0];\n      paddingRight = value[1];\n      paddingBottom = value[2];\n      paddingLeft = value[3];\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n    if (paddingTop instanceof Look) {\n      this.owner.paddingTop.setLook(paddingTop, timing, affinity);\n    } else {\n      this.owner.paddingTop.setState(paddingTop, timing, affinity);\n    }\n    if (paddingRight instanceof Look) {\n      this.owner.paddingRight.setLook(paddingRight, timing, affinity);\n    } else {\n      this.owner.paddingRight.setState(paddingRight, timing, affinity);\n    }\n    if (paddingBottom instanceof Look) {\n      this.owner.paddingBottom.setLook(paddingBottom, timing, affinity);\n    } else {\n      this.owner.paddingBottom.setState(paddingBottom, timing, affinity);\n    }\n    if (paddingLeft instanceof Look) {\n      this.owner.paddingLeft.setLook(paddingLeft, timing, affinity);\n    } else {\n      this.owner.paddingLeft.setState(paddingLeft, timing, affinity);\n    }\n  },\n})]);\n\nStyleAttribute.defineGetter(\"paddingTop\", [LengthStyleConstraintAnimator({\n  propertyNames: \"padding-top\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"paddingRight\", [LengthStyleConstraintAnimator({\n  propertyNames: \"padding-right\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"paddingBottom\", [LengthStyleConstraintAnimator({\n  propertyNames: \"padding-bottom\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"paddingLeft\", [LengthStyleConstraintAnimator({\n  propertyNames: \"padding-left\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"pointerEvents\", [StyleAnimator({\n  propertyNames: \"pointer-events\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"position\", [StyleAnimator({\n  propertyNames: \"position\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"right\", [LengthStyleConstraintAnimator({\n  propertyNames: \"right\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"textAlign\", [StyleAnimator({\n  propertyNames: \"text-align\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"textDecorationColor\", [StyleAnimator({\n  propertyNames: \"text-decoration-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"textDecorationLine\", [StyleAnimator({\n  propertyNames: \"text-decoration-line\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"textDecorationStyle\", [StyleAnimator({\n  propertyNames: \"text-decoration-style\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"textOverflow\", [StyleAnimator({\n  propertyNames: \"text-overflow\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"textTransform\", [StyleAnimator({\n  propertyNames: \"text-transform\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"top\", [LengthStyleConstraintAnimator({\n  propertyNames: \"top\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctHeightUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"touchAction\", [StyleAnimator({\n  propertyNames: \"touch-action\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"transform\", [StyleAnimator({\n  propertyNames: \"transform\",\n  valueType: Transform,\n  value: null,\n})]);\n\nStyleAttribute.defineGetter(\"userSelect\", [StyleAnimator({\n  propertyNames: [\"user-select\", \"-webkit-user-select\", \"-moz-user-select\", \"-ms-user-select\"],\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"verticalAlign\", [StyleAnimator({\n  propertyNames: \"vertical-align\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"visibility\", [StyleAnimator({\n  propertyNames: \"visibility\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"whiteSpace\", [StyleAnimator({\n  propertyNames: \"white-space\",\n  valueType: String,\n})]);\n\nStyleAttribute.defineGetter(\"width\", [LengthStyleConstraintAnimator({\n  propertyNames: \"width\",\n  valueType: Length,\n  value: null,\n  get pctUnit(): number {\n    return StyleAttribute.pctWidthUnit(this.owner.node);\n  },\n})]);\n\nStyleAttribute.defineGetter(\"zIndex\", [StyleAnimator({\n  propertyNames: \"z-index\",\n  valueType: Number,\n})]);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\n\n/** @public */\nexport interface CssScopeDescriptor<R, S extends CSSStyleSheet | CSSRule> extends FastenerDescriptor<R> {\n  extends?: Proto<CssScope<any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface CssScopeClass<F extends CssScope<any, any> = CssScope<any, any>> extends FastenerClass<F> {\n}\n\n/** @public */\nexport interface CssScope<R = any, S extends CSSStyleSheet | CSSRule = any> extends Fastener<R> {\n  /** @override */\n  get descriptorType(): Proto<CssScopeDescriptor<R, S>>;\n\n  /** @override */\n  get fastenerType(): Proto<CssScope<any, any>>;\n\n  /** @protected @override */\n  onUnbindInlet(inlet: Fastener<any, any, any>): void;\n\n  /** @override */\n  get parent(): CssScope<any, any> | null;\n\n  /** @internal */\n  readonly outlets: ReadonlySet<Fastener<any, any, any>> | null;\n\n  /** @internal @override */\n  attachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @override */\n  detachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @protected */\n  decohereOutlets(): void;\n\n  getOutletCss(outlet: Fastener<any, any, any>): CSSStyleSheet | CSSRule | null;\n\n  get inletCss(): CSSStyleSheet | CSSRule | null;\n\n  getInletCss(): CSSStyleSheet | CSSRule;\n\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): S | null;\n\n  readonly css: S | null;\n\n  getCss(): S;\n\n  setCss(css: S | null): S | null;\n\n  attachCss(css: S): S;\n\n  /** @protected */\n  initCss(css: S): void;\n\n  /** @protected */\n  willAttachCss(css: S): void;\n\n  /** @protected */\n  onAttachCss(css: S): void;\n\n  /** @protected */\n  didAttachCss(css: S): void;\n\n  detachCss(): S | null;\n\n  /** @protected */\n  deinitCss(css: S): void;\n\n  /** @protected */\n  willDetachCss(css: S): void;\n\n  /** @protected */\n  onDetachCss(css: S): void;\n\n  /** @protected */\n  didDetachCss(css: S): void;\n\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing?: TimingLike | boolean | null): void;\n\n  /** @override */\n  recohere(t: number): void;\n}\n\n/** @public */\nexport const CssScope = (<R, S extends CSSStyleSheet | CSSRule, F extends CssScope<any, any>>() => Fastener.extend<CssScope<R, S>, CssScopeClass<F>>(\"CssScope\", {\n  get fastenerType(): Proto<CssScope<any, any>> {\n    return CssScope;\n  },\n\n  onUnbindInlet(inlet: Fastener<any, any, any>): void {\n    super.onUnbindInlet(inlet);\n    this.detachCss();\n  },\n\n  attachOutlet(outlet: Fastener<any, any, any>): void {\n    let outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      outlets = new Set<Fastener<any, any, any>>();\n      (this as Mutable<typeof this>).outlets = outlets;\n    }\n    outlets.add(outlet);\n  },\n\n  detachOutlet(outlet: Fastener<any, any, any>): void {\n    const outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      return;\n    }\n    outlets.delete(outlet);\n  },\n\n  decohereOutlets(): void {\n    const outlets = this.outlets;\n    if (outlets !== null) {\n      for (const outlet of outlets) {\n        outlet.decohere(this);\n      }\n    }\n  },\n\n  getOutletCss(outlet: Fastener<any, any, any>): CSSStyleSheet | CSSRule | null {\n    return this.css;\n  },\n\n  get inletCss(): CSSStyleSheet | CSSRule | null {\n    const inlet = this.inlet;\n    return inlet instanceof CssScope ? inlet.getOutletCss(this) : null;\n  },\n\n  getInletCss(): CSSStyleSheet | CSSRule {\n    const inletCss = this.inletCss;\n    if (inletCss === void 0 || inletCss === null) {\n      let message = inletCss + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"inlet css\";\n      throw new TypeError(message);\n    }\n    return inletCss;\n  },\n\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): S | null {\n    return null;\n  },\n\n  getCss(): S {\n    const css = this.css;\n    if (css === null) {\n      let message = css + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"css\";\n      throw new TypeError(message);\n    }\n    return css;\n  },\n\n  setCss(newCss: S  | null): S | null {\n    const oldCss = this.css;\n    if (oldCss === newCss) {\n      this.setCoherent(true);\n      return oldCss;\n    } else if (oldCss !== null) {\n      (this as Mutable<typeof this>).css = null;\n      this.willDetachCss(oldCss);\n      this.onDetachCss(oldCss);\n      this.deinitCss(oldCss);\n      this.didDetachCss(oldCss);\n    }\n    if (newCss !== null) {\n      (this as Mutable<typeof this>).css = newCss;\n      this.willAttachCss(newCss);\n      this.onAttachCss(newCss);\n      this.initCss(newCss);\n      this.didAttachCss(newCss);\n    }\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldCss;\n  },\n\n  attachCss(newCss: S): S {\n    const oldCss = this.css;\n    if (oldCss === newCss) {\n      return newCss;\n    }\n    if (oldCss !== null) {\n      (this as Mutable<typeof this>).css = null;\n      this.willDetachCss(oldCss);\n      this.onDetachCss(oldCss);\n      this.deinitCss(oldCss);\n      this.didDetachCss(oldCss);\n    }\n    (this as Mutable<typeof this>).css = newCss;\n    this.willAttachCss(newCss);\n    this.onAttachCss(newCss);\n    this.initCss(newCss);\n    this.didAttachCss(newCss);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newCss;\n  },\n\n  initCss(css: S): void {\n    // hook\n  },\n\n  willAttachCss(css: S): void {\n    // hook\n  },\n\n  onAttachCss(css: S): void {\n    // hook\n  },\n\n  didAttachCss(css: S): void {\n    // hook\n  },\n\n  detachCss(): S | null {\n    const oldCss = this.css;\n    if (oldCss === null) {\n      return oldCss;\n    }\n    (this as Mutable<typeof this>).css = null;\n    this.willDetachCss(oldCss);\n    this.onDetachCss(oldCss);\n    this.deinitCss(oldCss);\n    this.didDetachCss(oldCss);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldCss;\n  },\n\n  deinitCss(css: S): void {\n    // hook\n  },\n\n  willDetachCss(css: S): void {\n    // hook\n  },\n\n  onDetachCss(css: S): void {\n    // hook\n  },\n\n  didDetachCss(css: S): void {\n    // hook\n  },\n\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing?: TimingLike | boolean | null): void {\n    const outlets = this.outlets;\n    if (outlets === null) {\n      return;\n    }\n    for (const outlet of outlets) {\n      if (outlet instanceof CssScope) {\n        outlet.applyTheme(theme, mood, timing);\n      }\n    }\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof CssScope) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        const inletCss = inlet.getOutletCss(this);\n        if (inletCss !== null && this.css === null) {\n          this.setCss(this.transformInletCss(inletCss));\n        } else if (inletCss === null && this.css !== null) {\n          this.setCss(null);\n        } else {\n          this.setDerived(false);\n        }\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).outlets = null;\n    (fastener as Mutable<typeof fastener>).css = null;\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {CssScopeDescriptor} from \"./CssScope\";\nimport type {CssScopeClass} from \"./CssScope\";\nimport {CssScope} from \"./CssScope\";\n\n/** @public */\nexport interface StyleSheetDescriptor<R> extends CssScopeDescriptor<R, CSSStyleSheet> {\n  extends?: Proto<StyleSheet<any>> | boolean | null;\n}\n\n/** @public */\nexport interface StyleSheetClass<F extends StyleSheet<any> = StyleSheet> extends CssScopeClass<F> {\n}\n\n/** @public */\nexport interface StyleSheet<R = any> extends CssScope<R, CSSStyleSheet> {\n  /** @override */\n  get descriptorType(): Proto<StyleSheetDescriptor<R>>;\n\n  /** @override */\n  get fastenerType(): Proto<StyleSheet<any>>;\n\n  /** @override */\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): CSSStyleSheet | null;\n}\n\n/** @public */\nexport const StyleSheet = (<R, F extends StyleSheet<any>>() => CssScope.extend<StyleSheet<R>, StyleSheetClass<F>>(\"StyleSheet\", {\n  get fastenerType(): Proto<StyleSheet<any>> {\n    return StyleSheet;\n  },\n\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): CSSStyleSheet | null {\n    if (inletCss instanceof CSSStyleSheet) {\n      return inletCss;\n    }\n    return null;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {CssScopeDescriptor} from \"./CssScope\";\nimport type {CssScopeClass} from \"./CssScope\";\nimport {CssScope} from \"./CssScope\";\n\n/** @public */\nexport interface CssRuleDescriptor<R, S extends CSSRule> extends CssScopeDescriptor<R, S> {\n  extends?: Proto<CssRule<any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface CssRuleClass<F extends CssRule<any, any> = CssRule> extends CssScopeClass<F> {\n}\n\n/** @public */\nexport interface CssRule<R = any, S extends CSSRule = any> extends CssScope<R, S> {\n  /** @override */\n  get descriptorType(): Proto<CssRuleDescriptor<R, S>>;\n\n  /** @override */\n  get fastenerType(): Proto<CssRule<any, any>>;\n\n  get selector(): string;\n\n  get cssText(): string;\n\n  /** @override */\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): S | null;\n\n  createRule(inletCss: CSSStyleSheet | CSSGroupingRule): S | null;\n}\n\n/** @public */\nexport const CssRule = (<R, S extends CSSRule, F extends CssRule<any, any>>() => CssScope.extend<CssRule<R, S>, CssRuleClass<F>>(\"CssRule\", {\n  get fastenerType(): Proto<CssRule<any, any>> {\n    return CssRule;\n  },\n\n  selector: \"*\",\n\n  get cssText(): string {\n    return this.selector + \" {}\";\n  },\n\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): S | null {\n    if (inletCss instanceof CSSStyleSheet || inletCss instanceof CSSGroupingRule) {\n      return this.createRule(inletCss);\n    }\n    return null;\n  },\n\n  createRule(inletCss: CSSStyleSheet | CSSGroupingRule): S | null {\n    const index = inletCss.insertRule(this.cssText);\n    return inletCss.cssRules.item(index) as S;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport {Timing} from \"@swim/util\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport type {ConstraintExpressionLike} from \"@swim/constraint\";\nimport type {ConstraintVariable} from \"@swim/constraint\";\nimport type {ConstraintProperty} from \"@swim/constraint\";\nimport type {ConstraintRelation} from \"@swim/constraint\";\nimport type {ConstraintStrengthLike} from \"@swim/constraint\";\nimport type {Constraint} from \"@swim/constraint\";\nimport {ConstraintScope} from \"@swim/constraint\";\nimport {ToStyleString} from \"@swim/style\";\nimport {ToCssValue} from \"@swim/style\";\nimport {Look} from \"@swim/theme\";\nimport type {Feel} from \"@swim/theme\";\nimport {Mood} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport {ThemeContext} from \"@swim/theme\";\nimport type {StyleContext} from \"./StyleAnimator\";\nimport {StyleAttribute} from \"./StyleAttribute\";\nimport type {CssRuleDescriptor} from \"./CssRule\";\nimport type {CssRuleClass} from \"./CssRule\";\nimport {CssRule} from \"./CssRule\";\n\n/** @public */\nexport interface StyleRuleDescriptor<R> extends CssRuleDescriptor<R, CSSStyleRule> {\n  extends?: Proto<StyleRule<any>> | boolean | null;\n}\n\n/** @public */\nexport interface StyleRuleClass<F extends StyleRule<any> = StyleRule> extends CssRuleClass<F> {\n}\n\n/** @public */\nexport interface StyleRule<R = any> extends CssRule<R, CSSStyleRule>, ConstraintScope, ThemeContext, StyleContext {\n  /** @override */\n  get descriptorType(): Proto<StyleRuleDescriptor<R>>;\n\n  /** @override */\n  get fastenerType(): Proto<StyleRule<any>>;\n\n  /** @override */\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): CSSStyleRule | null;\n\n  /** @override */\n  createRule(inletCss: CSSStyleSheet | CSSGroupingRule): CSSStyleRule | null;\n\n  /** @protected @override */\n  onAttachCss(css: CSSStyleRule): void;\n\n  /** @override */\n  get selector(): string;\n\n  readonly style: StyleAttribute<this>;\n\n  /** @override */\n  getStyle(propertyNames: string | readonly string[]): CSSStyleValue | string | undefined;\n\n  /** @override */\n  setStyle(propertyName: string, value: unknown, priority?: string): this;\n\n  /** @protected */\n  willSetStyle(propertyName: string, value: unknown, priority: string | undefined): void;\n\n  /** @protected */\n  onSetStyle(propertyName: string, value: unknown, priority: string | undefined): void;\n\n  /** @protected */\n  didSetStyle(propertyName: string, value: unknown, priority: string | undefined): void;\n\n  /** @override */\n  constraint(lhs: ConstraintExpressionLike, relation: ConstraintRelation,\n             rhs?: ConstraintExpressionLike, strength?: ConstraintStrengthLike): Constraint;\n\n  /** @override */\n  hasConstraint(constraint: Constraint): boolean;\n\n  /** @override */\n  addConstraint(constraint: Constraint): void;\n\n  /** @override */\n  removeConstraint(constraint: Constraint): void;\n\n  /** @override */\n  constraintVariable(name: string, value?: number, strength?: ConstraintStrengthLike): ConstraintProperty<any, number>;\n\n  /** @override */\n  hasConstraintVariable(variable: ConstraintVariable): boolean;\n\n  /** @override */\n  addConstraintVariable(variable: ConstraintVariable): void;\n\n  /** @override */\n  removeConstraintVariable(variable: ConstraintVariable): void;\n\n  /** @internal @override */\n  setConstraintVariable(constraintVariable: ConstraintVariable, state: number): void;\n\n  /** @override */\n  getLook<T>(look: Look<T>, mood?: MoodVector<Feel> | null): T | undefined;\n\n  /** @override */\n  getLookOr<T, E>(look: Look<T>, elseValue: E): T | E;\n  /** @override */\n  getLookOr<T, E>(look: Look<T>, mood: MoodVector<Feel> | null, elseValue: E): T | E;\n\n  /** @override */\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing?: TimingLike | boolean | null): void;\n\n  /** @protected @override */\n  didMount(): void;\n}\n\n/** @public */\nexport const StyleRule = (<R, F extends StyleRule<any>>() => CssRule.extend<StyleRule<R>, StyleRuleClass<F>>(\"StyleRule\", {\n  get fastenerType(): Proto<StyleRule<any>> {\n    return StyleRule;\n  },\n\n  selector: \"*\",\n\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): CSSStyleRule | null {\n    if (inletCss !== null) {\n      (inletCss as any).RANDOM_MARKER_ID = Math.random();\n    }\n    if (inletCss instanceof CSSStyleRule) {\n      return inletCss;\n    } else if (inletCss instanceof CSSStyleSheet || inletCss instanceof CSSGroupingRule) {\n      return this.createRule(inletCss);\n    }\n    return null;\n  },\n\n  createRule(inletCss: CSSStyleSheet | CSSGroupingRule): CSSStyleRule | null {\n    const index = inletCss.insertRule(this.cssText);\n    const rule = inletCss.cssRules.item(index);\n    if (!(rule instanceof CSSStyleRule)) {\n      throw new TypeError(\"not a style rule: \" + rule);\n    }\n    return rule;\n  },\n\n  onAttachCss(css: CSSStyleRule): void {\n    if (this.mounted) {\n      this.style.applyStyles();\n    }\n  },\n\n  getStyle(propertyNames: string | readonly string[]): CSSStyleValue | string | undefined {\n    const css = this.css;\n    if (css === null) {\n      return void 0;\n    }\n    if (typeof CSSStyleValue !== \"undefined\") { // CSS Typed OM support\n      const style = css.styleMap;\n      if (typeof propertyNames === \"string\") {\n        return style.get(propertyNames);\n      }\n      for (let i = 0; i < propertyNames.length; i += 1) {\n        const value = style.get(propertyNames[i]!);\n        if (value !== void 0) {\n          return value;\n        }\n      }\n      return \"\";\n    }\n    const style = css.style;\n    if (typeof propertyNames === \"string\") {\n      return style.getPropertyValue(propertyNames);\n    }\n    for (let i = 0; i < propertyNames.length; i += 1) {\n      const value = style.getPropertyValue(propertyNames[i]!);\n      if (value.length !== 0) {\n        return value;\n      }\n    }\n    return \"\";\n  },\n\n  setStyle(propertyName: string, value: unknown, priority?: string): StyleRule {\n    const css = this.css;\n    if (css === null) {\n      return this;\n    }\n    this.willSetStyle(propertyName, value, priority);\n    if (typeof CSSStyleValue !== \"undefined\") { // CSS Typed OM support\n      if (value !== void 0 && value !== null) {\n        const cssValue = ToCssValue(value);\n        if (cssValue !== null) {\n          try {\n            css.styleMap.set(propertyName, cssValue);\n          } catch (e) {\n            // swallow\n          }\n        } else {\n          css.style.setProperty(propertyName, ToStyleString(value), priority);\n        }\n      } else {\n        try {\n          css.styleMap.delete(propertyName);\n        } catch (e) {\n          // swallow\n        }\n      }\n    } else if (value !== void 0 && value !== null) {\n      css.style.setProperty(propertyName, ToStyleString(value), priority);\n    } else {\n      css.style.removeProperty(propertyName);\n    }\n    this.onSetStyle(propertyName, value, priority);\n    this.didSetStyle(propertyName, value, priority);\n    return this;\n  },\n\n  willSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    // hook\n  },\n\n  onSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    // hook\n  },\n\n  didSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    // hook\n  },\n\n  constraint(lhs: ConstraintExpressionLike, relation: ConstraintRelation,\n             rhs?: ConstraintExpressionLike, strength?: ConstraintStrengthLike): Constraint {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.constraint(lhs, relation, rhs, strength);\n  },\n\n  hasConstraint(constraint: Constraint): boolean {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.hasConstraint(constraint);\n  },\n\n  addConstraint(constraint: Constraint): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.addConstraint(constraint);\n  },\n\n  removeConstraint(constraint: Constraint): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.removeConstraint(constraint);\n  },\n\n  constraintVariable(name: string, value?: number, strength?: ConstraintStrengthLike): ConstraintProperty<any, number> {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.constraintVariable(name, value, strength);\n  },\n\n  hasConstraintVariable(constraintVariable: ConstraintVariable): boolean {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    return this.owner.hasConstraintVariable(constraintVariable);\n  },\n\n  addConstraintVariable(constraintVariable: ConstraintVariable): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.addConstraintVariable(constraintVariable);\n  },\n\n  removeConstraintVariable(constraintVariable: ConstraintVariable): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.removeConstraintVariable(constraintVariable);\n  },\n\n  setConstraintVariable(constraintVariable: ConstraintVariable, state: number): void {\n    if (!ConstraintScope[Symbol.hasInstance](this.owner)) {\n      throw new Error(\"no constraint scope\");\n    }\n    this.owner.setConstraintVariable(constraintVariable, state);\n  },\n\n  getLook<T>(look: Look<T>, mood?: MoodVector<Feel> | null): T | undefined {\n    if (!ThemeContext[Symbol.hasInstance](this.owner)) {\n      return void 0;\n    }\n    return this.owner.getLook(look, mood);\n  },\n\n  getLookOr<T, E>(look: Look<T>, mood: MoodVector<Feel> | null | E, elseValue?: E): T | E {\n    if (ThemeContext[Symbol.hasInstance](this.owner)) {\n      if (arguments.length === 2) {\n        return this.owner.getLookOr(look, mood as E);\n      } else {\n        return this.owner.getLookOr(look, mood as MoodVector<Feel> | null, elseValue!);\n      }\n    } else if (arguments.length === 2) {\n      return mood as E;\n    }\n    return elseValue!;\n  },\n\n  applyTheme(theme: ThemeMatrix, mood: MoodVector, timing?: TimingLike | boolean | null): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    } else if (timing === void 0 || timing === null || timing === true) {\n      timing = theme.getOr(Look.timing, Mood.ambient, false);\n    } else {\n      timing = Timing.fromLike(timing);\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!] as Fastener<any, any, any> | undefined;\n      if (fastener !== void 0 && \"applyTheme\" in (fastener as any)) {\n        (fastener as any).applyTheme(theme, mood, timing);\n      }\n    }\n    super.applyTheme(theme, mood, timing);\n  },\n\n  didMount(): void {\n    super.didMount();\n    if (this.css !== null) {\n      this.style.applyStyles();\n    }\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    StyleRule.initFasteners(fastener);\n    return fastener;\n  },\n}))();\n\nStyleRule.defineField(\"style\", [StyleAttribute({})]);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {CssRuleDescriptor} from \"./CssRule\";\nimport type {CssRuleClass} from \"./CssRule\";\nimport {CssRule} from \"./CssRule\";\n\n/** @public */\nexport interface MediaRuleDescriptor<R> extends CssRuleDescriptor<R, CSSMediaRule> {\n  extends?: Proto<MediaRule<any>> | boolean | null;\n}\n\n/** @public */\nexport interface MediaRuleClass<F extends MediaRule<any> = MediaRule> extends CssRuleClass<F> {\n}\n\n/** @public */\nexport interface MediaRule<R = any> extends CssRule<R, CSSMediaRule> {\n  /** @override */\n  get descriptorType(): Proto<MediaRuleDescriptor<R>>;\n\n  /** @override */\n  get fastenerType(): Proto<MediaRule<any>>;\n\n  get selector(): string;\n\n  /** @override */\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): CSSMediaRule | null;\n\n  /** @override */\n  createRule(inletCss: CSSStyleSheet | CSSGroupingRule): CSSMediaRule | null;\n}\n\n/** @public */\nexport const MediaRule = (<R, F extends MediaRule<any>>() => CssRule.extend<MediaRule<R>, MediaRuleClass<F>>(\"MediaRule\", {\n  get fastenerType(): Proto<MediaRule<any>> {\n    return MediaRule;\n  },\n\n  selector: \"@media\",\n\n  transformInletCss(inletCss: CSSStyleSheet | CSSRule | null): CSSMediaRule | null {\n    if (inletCss instanceof CSSMediaRule) {\n      return inletCss;\n    } else if (inletCss instanceof CSSStyleSheet || inletCss instanceof CSSGroupingRule) {\n      return this.createRule(inletCss);\n    }\n    return null;\n  },\n\n  createRule(inletCss: CSSStyleSheet | CSSGroupingRule): CSSMediaRule | null {\n    const index = inletCss.insertRule(this.cssText);\n    const rule = inletCss.cssRules.item(index);\n    if (!(rule instanceof CSSMediaRule)) {\n      throw new TypeError(\"not a media rule: \" + rule);\n    }\n    return rule;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\n\n/** @public */\nexport interface ClassList<R = any> extends Fastener<R> {\n  /** @override */\n  get fastenerType(): Proto<ClassList<any>>;\n\n  get value(): string;\n\n  get(): DOMTokenList;\n\n  set(classNames: readonly string[]): R;\n\n  setIntrinsic(classNames: readonly string[]): R;\n\n  contains(className: string): boolean;\n\n  add(...classNames: readonly string[]): R;\n\n  /** @protected */\n  willAdd(className: string): void;\n\n  /** @protected */\n  onAdd(className: string): void;\n\n  /** @protected */\n  didAdd(className: string): void;\n\n  remove(...classNames: readonly string[]): R;\n\n  /** @protected */\n  willRemove(className: string): void;\n\n  /** @protected */\n  onRemove(className: string): void;\n\n  /** @protected */\n  didRemove(className: string): void;\n\n  replace(oldClassName: string, newClassName: string): boolean;\n\n  toggle(className: string, force?: boolean): boolean;\n\n  forEach<T>(callback: (className: string, index: number, classList: ClassList<this>) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, className: string, index: number, classList: ClassList<this>) => T | void, thisArg: S): T | undefined;\n}\n\n/** @public */\nexport const ClassList = (<R, F extends ClassList<any>>() => Fastener.extend<ClassList<R>, FastenerClass<F>>(\"ClassList\", {\n  get fastenerType(): Proto<ClassList<any>> {\n    return ClassList;\n  },\n\n  get value(): string {\n    const classList = ((this.owner as any).node as Element).classList;\n    return classList.value;\n  },\n\n  get(): DOMTokenList {\n    return ((this.owner as any).node as Element).classList;\n  },\n\n  set(classNames: readonly string[]): R {\n    return this.add(...classNames);\n  },\n\n  setIntrinsic(classNames: readonly string[]): R {\n    return this.add(...classNames);\n  },\n\n  contains(className: string): boolean {\n    const classList = ((this.owner as any).node as Element).classList;\n    return classList.contains(className);\n  },\n\n  add(...classNames: readonly string[]): R {\n    const classList = ((this.owner as any).node as Element).classList;\n    for (let i = 0; i < classNames.length; i += 1) {\n      const className = classNames[i]!;\n      if (!classList.contains(className)) {\n        this.willAdd(className);\n        classList.add(className);\n        this.onAdd(className);\n        this.didAdd(className);\n      }\n    }\n    return this.owner;\n  },\n\n  willAdd(className: string): void {\n    // hook\n  },\n\n  onAdd(className: string): void {\n    // hook\n  },\n\n  didAdd(className: string): void {\n    // hook\n  },\n\n  remove(...classNames: readonly string[]): R {\n    const classList = ((this.owner as any).node as Element).classList;\n    for (let i = 0; i < classNames.length; i += 1) {\n      const className = classNames[i]!;\n      if (classList.contains(className)) {\n        this.willRemove(className);\n        classList.remove(className);\n        this.onRemove(className);\n        this.didRemove(className);\n      }\n    }\n    return this.owner;\n  },\n\n  willRemove(className: string): void {\n    // hook\n  },\n\n  onRemove(className: string): void {\n    // hook\n  },\n\n  didRemove(className: string): void {\n    // hook\n  },\n\n  replace(oldClassName: string, newClassName: string): boolean {\n    const classList = ((this.owner as any).node as Element).classList;\n    if (!classList.contains(oldClassName)) {\n      return false;\n    }\n\n    this.willRemove(oldClassName);\n    classList.remove(oldClassName);\n    this.onRemove(oldClassName);\n    this.didRemove(oldClassName);\n\n    this.willAdd(newClassName);\n    classList.add(newClassName);\n    this.onAdd(newClassName);\n    this.didAdd(newClassName);\n\n    return true;\n  },\n\n  toggle(className: string, state?: boolean): boolean {\n    const classList = ((this.owner as any).node as Element).classList;\n    if (state === true) {\n      if (!classList.contains(className)) {\n        this.willAdd(className);\n        classList.add(className);\n        this.onAdd(className);\n        this.didAdd(className);\n      }\n      return true;\n    } else if (state === false) {\n      if (classList.contains(className)) {\n        this.willRemove(className);\n        classList.remove(className);\n        this.onRemove(className);\n        this.didRemove(className);\n      }\n      return false;\n    } else if (!classList.contains(className)) {\n      this.willAdd(className);\n      classList.add(className);\n      this.onAdd(className);\n      this.didAdd(className);\n      return true;\n    } else {\n      this.willRemove(className);\n      classList.remove(className);\n      this.onRemove(className);\n      this.didRemove(className);\n      return false;\n    }\n  },\n\n  forEach<T, S>(callback: (this: S | undefined, className: string, index: number, classList: ClassList<any>) => T | void, thisArg?: S): T | undefined {\n    const classList = ((this.owner as any).node as Element).classList;\n    for (let i = 0; i < classList.length; i += 1) {\n      const className = classList[i]!;\n      const result = callback.call(thisArg, className, i, this);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {AnimatorDescriptor} from \"@swim/component\";\nimport type {AnimatorClass} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\n\n/** @public */\nexport interface TextContext {\n  get textContent(): string | null | undefined;\n\n  set textContent(textContent: string | null | undefined);\n}\n\n/** @public */\nexport const TextContext = {\n  [Symbol.hasInstance](instance: unknown): instance is TextContext {\n    return Objects.hasAllKeys<TextContext>(instance, \"textContent\");\n  },\n};\n\n/** @public */\nexport interface TextAnimatorDescriptor<R, T> extends AnimatorDescriptor<R, T> {\n  extends?: Proto<TextAnimator<any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface TextAnimatorClass<A extends TextAnimator<any, any, any> = TextAnimator<any, any, any>> extends AnimatorClass<A> {\n}\n\n/** @public */\nexport interface TextAnimator<R = any, T = any, I extends any[] = [T]> extends Animator<R, T, I> {\n  /** @override */\n  get descriptorType(): Proto<TextAnimatorDescriptor<R, T>>;\n\n  get textContent(): string | null | undefined;\n\n  set textContent(textContent: string | null | undefined);\n\n  format: (value: T) => string | null | undefined;\n}\n\n/** @public */\nexport const TextAnimator = (<R, T, I extends any[], A extends TextAnimator<any, any, any>>() => Animator.extend<TextAnimator<R, T, I>, TextAnimatorClass<A>>(\"TextAnimator\", {\n  get textContent(): string | null | undefined {\n    if (TextContext[Symbol.hasInstance](this.owner)) {\n      return this.owner.textContent;\n    }\n    return void 0;\n  },\n\n  set textContent(textContent: string | null | undefined) {\n    if (TextContext[Symbol.hasInstance](this.owner)) {\n      this.owner.textContent = textContent;\n    }\n  },\n\n  onSetValue(newValue: T, oldValue: T): void {\n    if (TextContext[Symbol.hasInstance](this.owner)) {\n      this.owner.textContent = this.format(newValue);\n    }\n    super.onSetValue(newValue, oldValue);\n  },\n\n  format(value: T): string | null | undefined {\n    return String(value);\n  },\n},\n{\n  construct(animator: A | null, owner: A extends Fastener<infer R, any, any> ? R : never): A {\n    animator = super.construct(animator, owner) as A;\n    animator.format = (Object.getPrototypeOf(animator) as TextAnimator).format;\n    return animator;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {Instance} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Creatable} from \"@swim/util\";\nimport {R2Box} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport type {ViewFactory} from \"@swim/view\";\nimport type {ViewClass} from \"@swim/view\";\nimport type {ViewObserver} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport type {TextContext} from \"./TextAnimator\";\nimport {TextAnimator} from \"./TextAnimator\";\nimport {TextView} from \"./\"; // forward import\nimport {ElementView} from \"./\"; // forward import\nimport {HtmlView} from \"./\"; // forward import\nimport {SvgView} from \"./\"; // forward import\n\n/** @public */\nexport interface NodeViewFactory<V extends NodeView = NodeView> extends ViewFactory<V> {\n  fromNode(node: Node): V\n}\n\n/** @public */\nexport interface NodeViewClass<V extends NodeView = NodeView> extends ViewClass<V>, NodeViewFactory<V> {\n}\n\n/** @public */\nexport interface NodeViewConstructor<V extends NodeView = NodeView> extends NodeViewClass<V> {\n  new(node: Node): V;\n}\n\n/** @public */\nexport interface NodeViewObserver<V extends NodeView = NodeView> extends ViewObserver<V> {\n}\n\n/** @public */\nexport class NodeView extends View implements TextContext {\n  constructor(node: Node) {\n    super();\n    this.node = node;\n\n    if (NodeView.nodeMap.has(node)) {\n      throw new Error(node + \" already has an associated view\");\n    }\n    NodeView.nodeMap.set(node, this);\n  }\n\n  override likeType?(like: {create?(): View} | Node): void;\n\n  declare readonly observerType?: Class<NodeViewObserver>;\n\n  readonly node: Node;\n\n  get textContent(): string | null | undefined {\n    return this.node.textContent;\n  }\n\n  set textContent(textContent: string | null | undefined) {\n    if (textContent === void 0) {\n      textContent = null;\n    }\n    this.node.textContent = textContent;\n  }\n\n  @TextAnimator({})\n  get text(): TextAnimator<this, any> {\n    return TextAnimator.getter();\n  }\n\n  override setChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(key: string, newChildFactory: F): View | null;\n  override setChild(key: string, newChild: View | LikeType<NodeView> | null): View | null;\n  override setChild(key: string, newChild: View | LikeType<NodeView> | null): View | null {\n    if (newChild instanceof Node) {\n      newChild = NodeView.fromNode(newChild);\n    } else if (newChild !== null) {\n      newChild = View.fromLike(newChild);\n    }\n    const oldChild = this.getChild(key);\n    let target: View | null;\n\n    if (oldChild !== null && newChild !== null && oldChild !== newChild) { // replace\n      newChild.remove();\n      target = oldChild.nextSibling;\n\n      if ((oldChild.flags & View.RemovingFlag) === 0) {\n        oldChild.setFlags(oldChild.flags | View.RemovingFlag);\n        this.willRemoveChild(oldChild);\n        oldChild.detachParent(this);\n        this.removeChildMap(oldChild);\n        this.onRemoveChild(oldChild);\n        this.didRemoveChild(oldChild);\n        oldChild.setKey(void 0);\n        oldChild.setFlags(oldChild.flags & ~View.RemovingFlag);\n      }\n\n      newChild.setFlags(newChild.flags | View.InsertingFlag);\n      newChild.setKey(oldChild.key);\n      this.willInsertChild(newChild, target);\n      if (newChild instanceof NodeView) {\n        if (oldChild instanceof NodeView) {\n          this.node.replaceChild(newChild.node, oldChild.node);\n        } else if (target !== null) {\n          let targetNode: Node | null = null;\n          let nextView: View | null = target;\n          do {\n            if (nextView instanceof NodeView) {\n              targetNode = nextView.node;\n              break;\n            }\n            nextView = nextView.nextSibling;\n          } while (nextView !== null);\n          this.node.insertBefore(newChild.node, targetNode);\n        } else {\n          this.node.appendChild(newChild.node);\n        }\n      } else if (oldChild instanceof NodeView) {\n        this.node.removeChild(oldChild.node);\n      }\n      this.insertChildMap(newChild);\n      newChild.attachParent(this, target);\n      this.onInsertChild(newChild, target);\n      this.didInsertChild(newChild, target);\n      newChild.cascadeInsert();\n      newChild.setFlags(newChild.flags & ~View.InsertingFlag);\n    } else if (newChild !== oldChild || newChild !== null && newChild.key !== key) {\n      if (oldChild !== null) { // remove\n        target = oldChild.nextSibling;\n        if ((oldChild.flags & View.RemovingFlag) === 0) {\n          oldChild.setFlags(oldChild.flags | View.RemovingFlag);\n          this.willRemoveChild(oldChild);\n          oldChild.detachParent(this);\n          this.removeChildMap(oldChild);\n          if (oldChild instanceof NodeView) {\n            this.node.removeChild(oldChild.node);\n          }\n          this.onRemoveChild(oldChild);\n          this.didRemoveChild(oldChild);\n          oldChild.setKey(void 0);\n          oldChild.setFlags(oldChild.flags & ~View.RemovingFlag);\n        }\n      } else {\n        target = null;\n      }\n\n      if (newChild !== null) { // insert\n        newChild.remove();\n\n        newChild.setFlags(newChild.flags | View.InsertingFlag);\n        newChild.setKey(key);\n        this.willInsertChild(newChild, target);\n        if (newChild instanceof NodeView) {\n          let targetNode: Node | null = null;\n          if (target !== null) {\n            let nextView: View | null = target;\n            do {\n              if (nextView instanceof NodeView) {\n                targetNode = nextView.node;\n                break;\n              }\n              nextView = nextView.nextSibling;\n            } while (nextView !== null);\n          }\n          this.node.insertBefore(newChild.node, targetNode);\n        }\n        this.insertChildMap(newChild);\n        newChild.attachParent(this, target);\n        this.onInsertChild(newChild, target);\n        this.didInsertChild(newChild, target);\n        newChild.cascadeInsert();\n        newChild.setFlags(newChild.flags & ~View.InsertingFlag);\n      }\n    }\n\n    return oldChild;\n  }\n\n  override appendChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, key?: string): InstanceType<F>;\n  override appendChild<V extends View>(child: V | LikeType<V>, key?: string): V;\n  override appendChild(child: View | LikeType<NodeView>, key?: string): View;\n  override appendChild(child: View | LikeType<NodeView>, key?: string): View {\n    if (child instanceof Node) {\n      child = NodeView.fromNode(child);\n    } else {\n      child = View.fromLike(child);\n    }\n\n    child.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n    }\n\n    child.setFlags(child.flags | View.InsertingFlag);\n    child.setKey(key);\n    this.willInsertChild(child, null);\n    if (child instanceof NodeView) {\n      this.node.appendChild(child.node);\n    }\n    this.insertChildMap(child);\n    child.attachParent(this, null);\n    this.onInsertChild(child, null);\n    this.didInsertChild(child, null);\n    child.cascadeInsert();\n    child.setFlags(child.flags & ~View.InsertingFlag);\n\n    return child;\n  }\n\n  override prependChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, key?: string): InstanceType<F>;\n  override prependChild<V extends View>(child: V | LikeType<V>, key?: string): V;\n  override prependChild(child: View | LikeType<NodeView>, key?: string): View;\n  override prependChild(child: View | LikeType<NodeView>, key?: string): View {\n    if (child instanceof Node) {\n      child = NodeView.fromNode(child);\n    } else {\n      child = View.fromLike(child);\n    }\n\n    child.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n    }\n    const target = this.firstChild;\n\n    child.setFlags(child.flags | View.InsertingFlag);\n    child.setKey(key);\n    this.willInsertChild(child, target);\n    if (child instanceof NodeView) {\n      this.node.insertBefore(child.node, this.node.firstChild);\n    }\n    this.insertChildMap(child);\n    child.attachParent(this, target);\n    this.onInsertChild(child, target);\n    this.didInsertChild(child, target);\n    child.cascadeInsert();\n    child.setFlags(child.flags & ~View.InsertingFlag);\n\n    return child;\n  }\n\n  override insertChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, target: View | Node | null, key?: string): InstanceType<F>;\n  override insertChild<V extends View>(child: V | LikeType<V>, target: View | Node | null, key?: string): V;\n  override insertChild(child: View | LikeType<NodeView>, target: View | Node | null, key?: string): View;\n  override insertChild(child: View | LikeType<NodeView>, target: View | Node | null, key?: string): View {\n    if (target instanceof View && target.parent !== this || target instanceof Node && target.parentNode !== this.node) {\n      target = null;\n    }\n\n    if (child instanceof Node) {\n      child = NodeView.fromNode(child);\n    } else {\n      child = View.fromLike(child);\n    }\n\n    child.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n    }\n\n    let targetView: View | null;\n    let targetNode: Node | null;\n    if (target instanceof Node) {\n      targetView = null;\n      targetNode = target;\n      let nextNode: Node | null = target;\n      do {\n        const nextView = NodeView.get(nextNode);\n        if (nextView !== null) {\n          targetView = nextView;\n          break;\n        }\n        nextNode = nextNode.nextSibling;\n      } while (nextNode !== null);\n    } else {\n      targetView = target;\n      targetNode = null;\n    }\n\n    child.setFlags(child.flags | View.InsertingFlag);\n    child.setKey(key);\n    this.willInsertChild(child, targetView);\n    if (child instanceof NodeView) {\n      if (targetNode === null && targetView !== null) {\n        let nextView: View | null = targetView;\n        do {\n          if (nextView instanceof NodeView) {\n            targetNode = nextView.node;\n            break;\n          }\n          nextView = nextView.nextSibling;\n        } while (nextView !== null);\n      }\n      this.node.insertBefore(child.node, targetNode);\n    }\n    this.insertChildMap(child);\n    child.attachParent(this, targetView);\n    this.onInsertChild(child, targetView);\n    this.didInsertChild(child, targetView);\n    child.cascadeInsert();\n    child.setFlags(child.flags & ~View.InsertingFlag);\n\n    return child;\n  }\n\n  injectChild<F extends Class<Instance<F, NodeView>> & Creatable<Instance<F, NodeView>>>(childFactory: F, target: NodeView | Node | null, key?: string): InstanceType<F>;\n  injectChild<V extends NodeView>(child: V | LikeType<V>, target: NodeView | Node | null, key?: string): V;\n  injectChild(child: NodeView | LikeType<NodeView>, target: NodeView | Node | null, key?: string): NodeView;\n  injectChild(child: NodeView | LikeType<NodeView>, target: NodeView | Node | null, key?: string): NodeView {\n    if (target instanceof View && target.parent !== this || target instanceof Node && target.parentNode !== this.node) {\n      throw new TypeError(\"\" + target);\n    }\n\n    child = NodeView.fromLike(child);\n\n    if (key !== void 0) {\n      this.removeChild(key);\n    }\n\n    if (target instanceof Node) {\n      let nextNode: Node | null = target;\n      target = null;\n      do {\n        const nextView = NodeView.get(nextNode);\n        if (nextView !== null) {\n          target = nextView;\n          break;\n        }\n        nextNode = nextNode.nextSibling;\n      } while (nextNode !== null);\n    }\n\n    child.setFlags(child.flags | View.InsertingFlag);\n    child.setKey(key);\n    this.willInsertChild(child, target);\n    this.insertChildMap(child);\n    child.attachParent(this, target);\n    this.onInsertChild(child, target);\n    this.didInsertChild(child, target);\n    child.cascadeInsert();\n    child.setFlags(child.flags & ~View.InsertingFlag);\n\n    return child;\n  }\n\n  override replaceChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(newChildFactory: F, oldChild: View): View;\n  override replaceChild<V extends View>(newChild: View | LikeType<NodeView>, oldChild: V): V;\n  override replaceChild(newChild: View | LikeType<NodeView>, oldChild: View): View;\n  override replaceChild(newChild: View | LikeType<NodeView>, oldChild: View): View {\n    if (oldChild.parent !== this) {\n      throw new TypeError(\"\" + oldChild);\n    } else if (newChild instanceof Node) {\n      newChild = NodeView.fromNode(newChild);\n    } else {\n      newChild = View.fromLike(newChild);\n    }\n    if (newChild === oldChild) {\n      return oldChild;\n    }\n\n    newChild.remove();\n    const target = oldChild.nextSibling;\n\n    if ((oldChild.flags & View.RemovingFlag) === 0) {\n      oldChild.setFlags(oldChild.flags | View.RemovingFlag);\n      this.willRemoveChild(oldChild);\n      oldChild.detachParent(this);\n      this.removeChildMap(oldChild);\n      this.onRemoveChild(oldChild);\n      this.didRemoveChild(oldChild);\n      oldChild.setKey(void 0);\n      oldChild.setFlags(oldChild.flags & ~View.RemovingFlag);\n    }\n\n    newChild.setFlags(newChild.flags | View.InsertingFlag);\n    newChild.setKey(oldChild.key);\n    this.willInsertChild(newChild, target);\n    if (newChild instanceof NodeView) {\n      if (oldChild instanceof NodeView) {\n        this.node.replaceChild(newChild.node, oldChild.node);\n      } else if (target !== null) {\n        let targetNode: Node | null = null;\n        let nextView: View | null = target;\n        do {\n          if (nextView instanceof NodeView) {\n            targetNode = nextView.node;\n            break;\n          }\n          nextView = nextView.nextSibling;\n        } while (nextView !== null);\n        this.node.insertBefore(newChild.node, targetNode);\n      } else {\n        this.node.appendChild(newChild.node);\n      }\n    } else if (oldChild instanceof NodeView) {\n      this.node.removeChild(oldChild.node);\n    }\n    this.insertChildMap(newChild);\n    newChild.attachParent(this, target);\n    this.onInsertChild(newChild, target);\n    this.didInsertChild(newChild, target);\n    newChild.cascadeInsert();\n    newChild.setFlags(newChild.flags & ~View.InsertingFlag);\n\n    return oldChild;\n  }\n\n  override removeChild<V extends View | Node>(child: V): V;\n  override removeChild(key: string | View): View | null;\n  override removeChild(key: string | View | Node): View | Node | null;\n  override removeChild(key: string | View | Node): View | Node | null {\n    let child: View | null;\n    if (typeof key === \"string\") {\n      child = this.getChild(key);\n      if (child === null) {\n        return null;\n      }\n    } else if (key instanceof Node) {\n      if (key.parentNode !== this.node) {\n        throw new Error(\"not a child node\");\n      }\n      const view = NodeView.get(key);\n      if (view !== null) {\n        child = view;\n      } else {\n        this.node.removeChild(key);\n        return key;\n      }\n    } else {\n      child = key;\n      if (child.parent !== this) {\n        throw new Error(\"not a child\");\n      }\n    }\n\n    if ((child.flags & View.RemovingFlag) === 0) {\n      child.setFlags(child.flags | View.RemovingFlag);\n      this.willRemoveChild(child);\n      child.detachParent(this);\n      this.removeChildMap(child);\n      if (child instanceof NodeView) {\n        this.node.removeChild(child.node);\n      }\n      this.onRemoveChild(child);\n      this.didRemoveChild(child);\n      child.setKey(void 0);\n      child.setFlags(child.flags & ~View.RemovingFlag);\n    }\n\n    return child;\n  }\n\n  override removeChildren(): void {\n    let child: View | null;\n    while (child = this.lastChild, child !== null) {\n      if ((child.flags & View.RemovingFlag) !== 0) {\n        throw new Error(\"inconsistent removeChildren\");\n      }\n      this.willRemoveChild(child);\n      child.detachParent(this);\n      this.removeChildMap(child);\n      if (child instanceof NodeView) {\n        this.node.removeChild(child.node);\n      }\n      this.onRemoveChild(child);\n      this.didRemoveChild(child);\n      child.setKey(void 0);\n      child.setFlags(child.flags & ~View.RemovingFlag);\n    }\n  }\n\n  override reinsertChild(child: View, target: View | null): void {\n    if (child.parent !== this) {\n      throw new Error(\"not a child\");\n    } else if (target !== null && target.parent !== this) {\n      throw new Error(\"reinsert target is not a child\");\n    } else if (child.nextSibling === target) {\n      return;\n    }\n\n    this.willReinsertChild(child, target);\n    if (child instanceof NodeView) {\n      this.node.removeChild(child.node);\n      this.node.insertBefore(child.node, target instanceof NodeView ? target.node : null);\n    }\n    child.reattachParent(target);\n    this.onReinsertChild(child, target);\n    this.didReinsertChild(child, target);\n  }\n\n  /** @internal */\n  static isRootView(node: Node): boolean {\n    do {\n      const parentNode: Node | null = node.parentNode;\n      if (parentNode === null) {\n        return true;\n      }\n      const parentView = NodeView.get(parentNode);\n      if (parentView !== null) {\n        return false;\n      }\n      node = parentNode;\n    } while (true);\n  }\n\n  /** @internal */\n  static isNodeMounted(node: Node): boolean {\n    let isConnected: boolean | undefined = node.isConnected;\n    if (typeof isConnected !== \"boolean\") {\n      const ownerDocument = node.ownerDocument;\n      if (ownerDocument === null) {\n        isConnected = false;\n      } else {\n        const position = ownerDocument.compareDocumentPosition(node);\n        isConnected = (position & node.DOCUMENT_POSITION_DISCONNECTED) === 0;\n      }\n    }\n    return isConnected;\n  }\n\n  /** @internal */\n  static mount(view: NodeView): void {\n    if (view.parent !== null) {\n      return;\n    }\n    const parentView = NodeView.get(view.node.parentNode);\n    if (parentView === null) {\n      view.mount();\n      return;\n    }\n    let targetView: View | null = null;\n    let targetNode = view.node.nextSibling;\n    while (targetNode !== null) {\n      targetView = NodeView.get(targetNode);\n      if (targetView !== null) {\n        break;\n      }\n      targetNode = targetNode.nextSibling;\n    }\n    view.setFlags(view.flags | View.InsertingFlag);\n    view.attachParent(parentView, targetView);\n    view.cascadeInsert();\n    view.setFlags(view.flags & ~View.InsertingFlag);\n  }\n\n  /** @internal */\n  override mount(): void {\n    if (this.mounted || !NodeView.isNodeMounted(this.node) || !NodeView.isRootView(this.node)) {\n      return;\n    }\n    this.setFlags(this.flags | View.InsertingFlag);\n    this.cascadeMount();\n    this.cascadeInsert();\n    this.setFlags(this.flags & ~View.InsertingFlag);\n  }\n\n  override get parentTransform(): Transform {\n    return Transform.identity();\n  }\n\n  override get clientBounds(): R2Box {\n    const range = document.createRange();\n    range.selectNode(this.node);\n    const bounds = range.getBoundingClientRect();\n    range.detach();\n    return new R2Box(bounds.left, bounds.top, bounds.right, bounds.bottom);\n  }\n\n  override get pageBounds(): R2Box {\n    const range = document.createRange();\n    range.selectNode(this.node);\n    const bounds = range.getBoundingClientRect();\n    range.detach();\n    const scrollX = window.pageXOffset;\n    const scrollY = window.pageYOffset;\n    return new R2Box(bounds.left + scrollX, bounds.top + scrollY,\n                     bounds.right + scrollX, bounds.bottom + scrollY);\n  }\n\n  override dispatchEvent(event: Event): boolean {\n    return this.node.dispatchEvent(event);\n  }\n\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void {\n    this.node.addEventListener(type, listener, options);\n  }\n\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void {\n    this.node.removeEventListener(type, listener, options);\n  }\n\n  /** @internal */\n  static readonly nodeMap: WeakMap<Node, NodeView> = new WeakMap();\n\n  static get<S extends Class<Instance<S, NodeView>>>(this: S, node: Node | null | undefined): InstanceType<S> | null {\n    const view = node !== void 0 && node !== null ? NodeView.nodeMap.get(node) : void 0;\n    if (view === void 0) {\n      return null;\n    } else if (!(view instanceof this)) {\n      throw new TypeError(node + \" not an instance of \" + this.name);\n    }\n    return view;\n  }\n\n  static override fromLike<S extends Class<Instance<S, View>>>(this: S, value: InstanceType<S> | LikeType<InstanceType<S>>): InstanceType<S> {\n    if (value === void 0 || value === null) {\n      return value as InstanceType<S>;\n    } else if (value instanceof View) {\n      if (!(value instanceof this)) {\n        throw new TypeError(value + \" not an instance of \" + this);\n      }\n      return value;\n    } else if (value instanceof Node) {\n      return (this as unknown as typeof NodeView).fromNode(value) as InstanceType<S>;\n    } else if (Creatable[Symbol.hasInstance](value)) {\n      return (value as Creatable<InstanceType<S>>).create();\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromNode<S extends new (node: Node) => Instance<S, NodeView>>(this: S, node: Node): InstanceType<S>;\n  static fromNode(node: Node): NodeView;\n  static fromNode(node: Node): NodeView {\n    let view = this.get(node);\n    if (view === null) {\n      if (node instanceof HTMLElement) {\n        view = new HtmlView(node);\n      } else if (node instanceof SVGElement) {\n        view = new SvgView(node);\n      } else if (node instanceof Element) {\n        view = new ElementView(node);\n      } else if (node instanceof Text) {\n        view = new TextView(node);\n      } else {\n        view = new NodeView(node);\n      }\n      this.mount(view);\n    }\n    return view;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {Instance} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Creatable} from \"@swim/util\";\nimport {View} from \"@swim/view\";\nimport type {NodeViewConstructor} from \"./NodeView\";\nimport type {NodeViewObserver} from \"./NodeView\";\nimport {NodeView} from \"./NodeView\";\n\n/** @public */\nexport interface TextViewConstructor<V extends TextView = TextView> extends NodeViewConstructor<V> {\n  new(node: Text): V;\n}\n\n/** @public */\nexport interface TextViewObserver<V extends TextView = TextView> extends NodeViewObserver<V> {\n}\n\n/** @public */\nexport class TextView extends NodeView {\n  constructor(node: Text) {\n    super(node);\n  }\n\n  override likeType?(like: {create?(): View} | Node | string): void;\n\n  declare readonly observerType?: Class<TextViewObserver>;\n\n  declare readonly node: Text;\n\n  static override create<S extends new (node: Text) => Instance<S, TextView>>(this: S, text?: string): InstanceType<S>;\n  static override create(text?: string): TextView;\n  static override create(text?: string): TextView {\n    if (text === void 0) {\n      text = \"\";\n    }\n    const node = document.createTextNode(text);\n    return new this(node);\n  }\n\n  static override fromLike<S extends Class<Instance<S, View>>>(this: S, value: InstanceType<S> | LikeType<InstanceType<S>>): InstanceType<S> {\n    if (value === void 0 || value === null) {\n      return value as InstanceType<S>;\n    } else if (value instanceof View) {\n      if (!(value instanceof this)) {\n        throw new TypeError(value + \" not an instance of \" + this);\n      }\n      return value;\n    } else if (value instanceof Text) {\n      return (this as unknown as typeof TextView).fromNode(value) as InstanceType<S>;\n    } else if (Creatable[Symbol.hasInstance](value)) {\n      return (value as Creatable<InstanceType<S>>).create();\n    } else if (typeof value === \"string\") {\n      return (this as unknown as typeof TextView).create(value) as InstanceType<S>;\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromNode<S extends new (node: Text) => Instance<S, TextView>>(this: S, node: Text): InstanceType<S>;\n  static override fromNode(node: Text): TextView;\n  static override fromNode(node: Text): TextView {\n    let view = this.get(node);\n    if (view === null) {\n      view = new this(node);\n      this.mount(view);\n    }\n    return view;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {Instance} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Creatable} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport {R2Box} from \"@swim/math\";\nimport {ThemeMatrix} from \"@swim/theme\";\nimport {Theme} from \"@swim/theme\";\nimport {ToAttributeString} from \"@swim/style\";\nimport {ToStyleString} from \"@swim/style\";\nimport {ToCssValue} from \"@swim/style\";\nimport {View} from \"@swim/view\";\nimport type {ViewportColorScheme} from \"@swim/view\";\nimport type {ViewportService} from \"@swim/view\";\nimport type {AttributeContext} from \"./AttributeAnimator\";\nimport {AttributeAnimator} from \"./AttributeAnimator\";\nimport type {StyleContext} from \"./StyleAnimator\";\nimport {StyleAttribute} from \"./StyleAttribute\";\nimport {ClassList} from \"./ClassList\";\nimport type {NodeViewFactory} from \"./NodeView\";\nimport type {NodeViewClass} from \"./NodeView\";\nimport type {NodeViewConstructor} from \"./NodeView\";\nimport type {NodeViewObserver} from \"./NodeView\";\nimport {NodeView} from \"./NodeView\";\nimport {HtmlView} from \"./\"; // forward import\nimport {SvgView} from \"./\"; // forward import\nimport {DomService} from \"./\"; // forward import\nimport type {ModalOptions} from \"./\"; // forward import\nimport {ModalView} from \"./\"; // forward import\nimport {ModalService} from \"./\"; // forward import\n\n/** @public */\nexport interface ElementAttributes<R = any> extends Fastener<R>, AttributeContext {\n  /** @override */\n  get fastenerType(): Proto<ElementAttributes<any>>;\n\n  get id(): AttributeAnimator<this, string | undefined>;\n\n  set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  set(properties: {[K in keyof ElementAttributes as ElementAttributes[K] extends {set(value: any): any} ? K : never]?: ElementAttributes[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n\n  setIntrinsic<S>(this: S, properties: {[K in keyof S as S[K] extends {setIntrinsic(value: any): any} ? K : never]?: S[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  setIntrinsic(properties: {[K in keyof ElementAttributes as ElementAttributes[K] extends {setIntrinsic(value: any): any} ? K : never]?: ElementAttributes[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n\n  /** @override */\n  getAttribute(attributeName: string): string | null;\n\n  /** @override */\n  setAttribute(attributeName: string, value: unknown): this;\n}\n\n/** @public */\nexport const ElementAttributes = (<R, F extends ElementAttributes<any>>() => Fastener.extend<ElementAttributes<R>, FastenerClass<F>>(\"ElementAttributes\", {\n  get fastenerType(): Proto<ElementAttributes<any>> {\n    return ElementAttributes;\n  },\n\n  set(properties: {[K in keyof ElementAttributes as ElementAttributes[K] extends {set(value: any): any} ? K : never]?: ElementAttributes[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R {\n    for (const key in properties) {\n      const value = properties[key as keyof typeof properties];\n      const property = (this as any)[key] as {set?(value: any): any} | undefined;\n      if (property === void 0 || property === null) {\n        throw new Error(\"unknown property \" + key);\n      } else if (property.set === void 0) {\n        throw new Error(\"unsettable property \" + key);\n      } else if (property instanceof Animator) {\n        property.set(value, timing);\n      } else {\n        property.set(value);\n      }\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(properties: {[K in keyof ElementAttributes as ElementAttributes[K] extends {setIntrinsic(value: any): any} ? K : never]?: ElementAttributes[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R {\n    for (const key in properties) {\n      const value = properties[key as keyof typeof properties];\n      const property = (this as any)[key] as {setIntrinsic?(value: any): any} | undefined;\n      if (property === void 0 || property === null) {\n        throw new Error(\"unknown property \" + key);\n      } else if (property.setIntrinsic === void 0) {\n        throw new Error(\"unsettable property \" + key);\n      } else if (property instanceof Animator) {\n        property.setIntrinsic(value, timing);\n      } else {\n        property.setIntrinsic(value);\n      }\n    }\n    return this.owner;\n  },\n\n  getAttribute(attributeName: string): string | null {\n    return (this.owner as AttributeContext).getAttribute(attributeName);\n  },\n\n  setAttribute(attributeName: string, value: unknown): ElementAttributes {\n    (this.owner as AttributeContext).setAttribute(attributeName, value);\n    return this;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    ElementAttributes.initFasteners(fastener);\n    return fastener;\n  },\n}))();\n\nElementAttributes.defineGetter(\"id\", [AttributeAnimator({\n  attributeName: \"id\",\n  valueType: String,\n})]);\n\n/** @public */\nexport interface ElementViewFactory<V extends ElementView = ElementView> extends NodeViewFactory<V> {\n  fromTag(tag: string): V;\n}\n\n/** @public */\nexport interface ElementViewClass<V extends ElementView = ElementView> extends NodeViewClass<V>, ElementViewFactory<V> {\n  readonly tag?: string;\n  readonly namespace?: string;\n}\n\n/** @public */\nexport interface ElementViewConstructor<V extends ElementView = ElementView> extends NodeViewConstructor<V>, ElementViewClass<V> {\n}\n\n/** @public */\nexport interface ElementViewObserver<V extends ElementView = ElementView> extends NodeViewObserver<V> {\n  viewWillSetAttribute?(name: string, value: unknown, view: V): void;\n\n  viewDidSetAttribute?(name: string, value: unknown, view: V): void;\n\n  viewWillSetStyle?(name: string, value: unknown, priority: string | undefined, view: V): void;\n\n  viewDidSetStyle?(name: string, value: unknown, priority: string | undefined, view: V): void;\n}\n\n/** @public */\nexport class ElementView extends NodeView implements AttributeContext, StyleContext {\n  constructor(node: Element) {\n    super(node);\n    this.willSetAttributeObservers = null;\n    this.didSetAttributeObservers = null;\n    this.willSetStyleObservers = null;\n    this.didSetStyleObservers = null;\n  }\n\n  override likeType?(like: {create?(): View} | Node | string): void;\n\n  declare readonly observerType?: Class<ElementViewObserver>;\n\n  declare readonly node: Element & ElementCSSInlineStyle;\n\n  @ElementAttributes({})\n  get attributes(): ElementAttributes<this> {\n    return ElementAttributes.getter();\n  }\n\n  /** @override */\n  getAttribute(attributeName: string): string | null {\n    return this.node.getAttribute(attributeName);\n  }\n\n  /** @override */\n  setAttribute(attributeName: string, value: unknown): this {\n    this.willSetAttribute(attributeName, value);\n    if (value !== void 0 && value !== null) {\n      this.node.setAttribute(attributeName, ToAttributeString(value));\n    } else {\n      this.node.removeAttribute(attributeName);\n    }\n    this.onSetAttribute(attributeName, value);\n    this.didSetAttribute(attributeName, value);\n    return this;\n  }\n\n  /** @internal */\n  protected willSetAttributeObservers: Set<Required<Pick<ElementViewObserver, \"viewWillSetAttribute\">>> | null;\n  protected willSetAttribute(attributeName: string, value: unknown): void {\n    const observers = this.willSetAttributeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillSetAttribute(attributeName, value, this);\n      }\n    }\n  }\n\n  protected onSetAttribute(attributeName: string, value: unknown): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didSetAttributeObservers: Set<Required<Pick<ElementViewObserver, \"viewDidSetAttribute\">>> | null;\n  protected didSetAttribute(attributeName: string, value: unknown): void {\n    const observers = this.didSetAttributeObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidSetAttribute(attributeName, value, this);\n      }\n    }\n  }\n\n  @StyleAttribute({})\n  get style(): StyleAttribute<this> {\n    return StyleAttribute.getter();\n  }\n\n  getStyle(propertyNames: string | readonly string[]): CSSStyleValue | string | undefined {\n    if (typeof CSSStyleValue !== \"undefined\") { // CSS Typed OM support\n      const style = this.node.attributeStyleMap;\n      if (typeof propertyNames === \"string\") {\n        try {\n          return style.get(propertyNames);\n        } catch (e) {\n          return void 0;\n        }\n      } else {\n        for (let i = 0; i < propertyNames.length; i += 1) {\n          const value = style.get(propertyNames[i]!);\n          if (value !== void 0) {\n            return value;\n          }\n        }\n        return \"\";\n      }\n    } else {\n      const style = this.node.style;\n      if (typeof propertyNames === \"string\") {\n        return style.getPropertyValue(propertyNames);\n      } else {\n        for (let i = 0; i < propertyNames.length; i += 1) {\n          const value = style.getPropertyValue(propertyNames[i]!);\n          if (value.length !== 0) {\n            return value;\n          }\n        }\n        return \"\";\n      }\n    }\n  }\n\n  setStyle(propertyName: string, value: unknown, priority?: string): this {\n    this.willSetStyle(propertyName, value, priority);\n    if (typeof CSSStyleValue !== \"undefined\") { // CSS Typed OM support\n      if (value !== void 0 && value !== null) {\n        const cssValue = ToCssValue(value);\n        if (cssValue !== null) {\n          try {\n            this.node.attributeStyleMap.set(propertyName, cssValue);\n          } catch (e) {\n            // swallow\n          }\n        } else {\n          this.node.style.setProperty(propertyName, ToStyleString(value), priority);\n        }\n      } else {\n        try {\n          this.node.attributeStyleMap.delete(propertyName);\n        } catch (e) {\n          // swallow\n        }\n      }\n    } else {\n      if (value !== void 0 && value !== null) {\n        this.node.style.setProperty(propertyName, ToStyleString(value), priority);\n      } else {\n        this.node.style.removeProperty(propertyName);\n      }\n    }\n    this.onSetStyle(propertyName, value, priority);\n    this.didSetStyle(propertyName, value, priority);\n    return this;\n  }\n\n  /** @internal */\n  protected willSetStyleObservers: Set<Required<Pick<ElementViewObserver, \"viewWillSetStyle\">>> | null;\n  protected willSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    const observers = this.willSetStyleObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewWillSetStyle(propertyName, value, priority, this);\n      }\n    }\n  }\n\n  protected onSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    // hook\n  }\n\n  /** @internal */\n  protected didSetStyleObservers: Set<Required<Pick<ElementViewObserver, \"viewDidSetStyle\">>> | null;\n  protected didSetStyle(propertyName: string, value: unknown, priority: string | undefined): void {\n    const observers = this.didSetStyleObservers;\n    if (observers !== null) {\n      for (const observer of observers) {\n        observer.viewDidSetStyle(propertyName, value, priority, this);\n      }\n    }\n  }\n\n  @ClassList({})\n  get classList(): ClassList<this> {\n    return ClassList.getter();\n  }\n\n  protected detectTheme(): void {\n    let themeName = this.node.getAttribute(\"swim-theme\");\n    if (themeName === \"\") {\n      themeName = \"auto\";\n    }\n    if (themeName === null) {\n      return;\n    }\n    let theme: ThemeMatrix | undefined;\n    if (themeName === \"auto\") {\n      const viewportService = this.viewport.getService();\n      const colorScheme = viewportService.colorScheme.value;\n      if (colorScheme === \"dark\") {\n        theme = Theme.dark;\n      } else {\n        theme = Theme.light;\n      }\n    } else if (themeName.indexOf('.') < 0) {\n      theme = (Theme as any)[themeName];\n    } else {\n      theme = DomService.eval(themeName) as ThemeMatrix | undefined;\n    }\n    if (!(theme instanceof ThemeMatrix)) {\n      throw new TypeError(\"unknown swim-theme: \" + themeName);\n    }\n    this.theme.set(theme);\n  }\n\n  @Provider({\n    extends: true,\n    observes: true,\n    serviceDidSetViewportColorScheme(colorScheme: ViewportColorScheme): void {\n      this.owner.detectTheme();\n    },\n  })\n  override get viewport(): Provider<this, ViewportService> & NodeView[\"viewport\"] & Observes<ViewportService> {\n    return Provider.getter();\n  }\n\n  @Provider({\n    get serviceType(): typeof DomService { // avoid static forward reference\n      return DomService;\n    },\n    mountRootService(service: DomService,): void {\n      super.mountRootService(service);\n      service.roots.addView(this.owner);\n    },\n    unmountRootService(service: DomService): void {\n      super.unmountService(service);\n      service.roots.removeView(this.owner);\n    },\n  })\n  get dom(): Provider<this, DomService> {\n    return Provider.getter();\n  }\n\n  @Provider({\n    get serviceType(): typeof ModalService { // avoid static forward reference\n      return ModalService;\n    },\n    present(modalView?: ModalView, options?: ModalOptions): void {\n      if (modalView === void 0 && ModalView[Symbol.hasInstance](this.owner)) {\n        modalView = this.owner;\n      }\n      if (modalView !== void 0) {\n        this.getService().presentModal(modalView, options);\n      }\n    },\n    dismiss(modalView?: ModalView): void {\n      if (modalView === void 0 && ModalView[Symbol.hasInstance](this.owner)) {\n        modalView = this.owner;\n      }\n      if (modalView !== void 0) {\n        this.getService().dismissModal(modalView);\n      }\n    },\n    toggle(modalView?: ModalView, options?: ModalOptions): void {\n      if (modalView === void 0 && ModalView[Symbol.hasInstance](this.owner)) {\n        modalView = this.owner;\n      }\n      if (modalView !== void 0) {\n        this.getService().toggleModal(modalView, options);\n      }\n    },\n  })\n  get modal(): Provider<this, ModalService> & {\n    present(modalView?: ModalView, options?: ModalOptions): void,\n    dismiss(modalView?: ModalView): void,\n    toggle(modalView?: ModalView): void,\n  } {\n    return Provider.getter();\n  }\n\n  override get clientBounds(): R2Box {\n    const bounds = this.node.getBoundingClientRect();\n    return new R2Box(bounds.left, bounds.top, bounds.right, bounds.bottom);\n  }\n\n  override get pageBounds(): R2Box {\n    const bounds = this.node.getBoundingClientRect();\n    const scrollX = window.pageXOffset;\n    const scrollY = window.pageYOffset;\n    return new R2Box(bounds.left + scrollX, bounds.top + scrollY,\n                     bounds.right + scrollX, bounds.bottom + scrollY);\n  }\n\n  override addEventListener<K extends keyof ElementEventMap>(type: K, listener: (this: Element, event: ElementEventMap[K]) => unknown, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void {\n    this.node.addEventListener(type, listener, options);\n  }\n\n  override removeEventListener<K extends keyof ElementEventMap>(type: K, listener: (this: Element, event: ElementEventMap[K]) => unknown, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void {\n    this.node.removeEventListener(type, listener, options);\n  }\n\n  protected override onObserve(observer: Observes<this>): void {\n    super.onObserve(observer);\n    if (observer.viewWillSetAttribute !== void 0) {\n      if (this.willSetAttributeObservers === null) {\n        this.willSetAttributeObservers = new Set();\n      }\n      this.willSetAttributeObservers.add(observer as Required<Pick<ElementViewObserver, \"viewWillSetAttribute\">>);\n    }\n    if (observer.viewDidSetAttribute !== void 0) {\n      if (this.didSetAttributeObservers === null) {\n        this.didSetAttributeObservers = new Set();\n      }\n      this.didSetAttributeObservers.add(observer as Required<Pick<ElementViewObserver, \"viewDidSetAttribute\">>);\n    }\n    if (observer.viewWillSetStyle !== void 0) {\n      if (this.willSetStyleObservers === null) {\n        this.willSetStyleObservers = new Set();\n      }\n      this.willSetStyleObservers.add(observer as Required<Pick<ElementViewObserver, \"viewWillSetStyle\">>);\n    }\n    if (observer.viewDidSetStyle !== void 0) {\n      if (this.didSetStyleObservers === null) {\n        this.didSetStyleObservers = new Set();\n      }\n      this.didSetStyleObservers.add(observer as Required<Pick<ElementViewObserver, \"viewDidSetStyle\">>);\n    }\n  }\n\n  protected override onUnobserve(observer: Observes<this>): void {\n    super.onUnobserve(observer);\n    if (observer.viewWillSetAttribute !== void 0 && this.willSetAttributeObservers !== null) {\n      this.willSetAttributeObservers.delete(observer as Required<Pick<ElementViewObserver, \"viewWillSetAttribute\">>);\n    }\n    if (observer.viewDidSetAttribute !== void 0 && this.didSetAttributeObservers !== null) {\n      this.didSetAttributeObservers.delete(observer as Required<Pick<ElementViewObserver, \"viewDidSetAttribute\">>);\n    }\n    if (observer.viewWillSetStyle !== void 0 && this.willSetStyleObservers !== null) {\n      this.willSetStyleObservers.delete(observer as Required<Pick<ElementViewObserver, \"viewWillSetStyle\">>);\n    }\n    if (observer.viewDidSetStyle !== void 0 && this.didSetStyleObservers !== null) {\n      this.didSetStyleObservers.delete(observer as Required<Pick<ElementViewObserver, \"viewDidSetStyle\">>);\n    }\n  }\n\n  protected override onMount(): void {\n    super.onMount();\n    if (this.node.hasAttribute(\"swim-theme\")) {\n      this.detectTheme();\n      this.viewport.getService().observe(this.viewport);\n    }\n  }\n\n  protected override onUnmount(): void {\n    super.onUnmount();\n    if (this.node.hasAttribute(\"swim-theme\")) {\n      this.viewport.getService().unobserve(this.viewport);\n    }\n  }\n\n  /** @internal */\n  static readonly tag?: string;\n\n  /** @internal */\n  static readonly namespace?: string;\n\n  static override create<S extends Class<Instance<S, ElementView>>>(this: S): InstanceType<S>;\n  static override create(): ElementView;\n  static override create(): ElementView {\n    let tag = this.tag;\n    if (tag === void 0) {\n      tag = \"div\";\n    }\n    return this.fromTag(tag);\n  }\n\n  static override fromLike<S extends Class<Instance<S, View>>>(this: S, value: InstanceType<S> | LikeType<InstanceType<S>>): InstanceType<S> {\n    if (value === void 0 || value === null) {\n      return value as InstanceType<S>;\n    } else if (value instanceof View) {\n      if (!(value instanceof this)) {\n        throw new TypeError(value + \" not an instance of \" + this);\n      }\n      return value;\n    } else if (value instanceof Element) {\n      return (this as unknown as typeof ElementView).fromNode(value) as InstanceType<S>;\n    } else if (Creatable[Symbol.hasInstance](value)) {\n      return (value as Creatable<InstanceType<S>>).create();\n    } else if (typeof value === \"string\") {\n      return (this as unknown as typeof ElementView).fromTag(value) as InstanceType<S>;\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromNode<S extends new (node: Element) => Instance<S, ElementView>>(this: S, node: Element): InstanceType<S>;\n  static override fromNode(node: Element): ElementView;\n  static override fromNode(node: Element): ElementView {\n    let view = this.get(node);\n    if (view === null) {\n      if (node instanceof HTMLElement) {\n        view = new HtmlView(node);\n      } else if (node instanceof SVGElement) {\n        view = new SvgView(node);\n      } else {\n        view = new ElementView(node);\n      }\n      this.mount(view);\n    }\n    return view;\n  }\n\n  static fromTag<S extends Class<Instance<S, ElementView>>>(this: S, tag: string, namespace?: string): InstanceType<S>;\n  static fromTag(tag: string, namespace?: string): ElementView;\n  static fromTag(tag: string, namespace?: string): ElementView {\n    if (namespace === void 0) {\n      if (tag === \"svg\") {\n        namespace = SvgView.namespace;\n      }\n    }\n    let node: Element;\n    if (namespace !== void 0) {\n      node = document.createElementNS(namespace, tag);\n    } else {\n      node = document.createElement(tag);\n    }\n    return this.fromNode(node);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {__runInitializers} from \"tslib\";\nimport type {Class} from \"@swim/util\";\nimport type {Instance} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {Timing} from \"@swim/util\";\nimport {Creatable} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport {Transform} from \"@swim/math\";\nimport {Look} from \"@swim/theme\";\nimport {Mood} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport {View} from \"@swim/view\";\nimport {AttributeAnimator} from \"./AttributeAnimator\";\nimport {ElementAttributes} from \"./ElementView\";\nimport type {ElementViewFactory} from \"./ElementView\";\nimport type {ElementViewClass} from \"./ElementView\";\nimport type {ElementViewConstructor} from \"./ElementView\";\nimport type {ElementViewObserver} from \"./ElementView\";\nimport {ElementView} from \"./ElementView\";\nimport {StyleView} from \"./\"; // forward import\nimport {SvgView} from \"./\"; // forward import\n\n/** @public */\nexport interface HtmlAttributes<R = any> extends ElementAttributes<R> {\n  get autocomplete(): AttributeAnimator<this, string | undefined>;\n\n  get checked(): AttributeAnimator<this, boolean | undefined>;\n\n  get colspan(): AttributeAnimator<this, number | undefined>;\n\n  get disabled(): AttributeAnimator<this, boolean | undefined>;\n\n  get href(): AttributeAnimator<this, string | undefined>;\n\n  get placeholder(): AttributeAnimator<this, string | undefined>;\n\n  get rowspan(): AttributeAnimator<this, number | undefined>;\n\n  get selected(): AttributeAnimator<this, boolean | undefined>;\n\n  get title(): AttributeAnimator<this, string | undefined>;\n\n  get type(): AttributeAnimator<this, string | undefined>;\n\n  get value(): AttributeAnimator<this, string | undefined>;\n\n  /** @override */\n  set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  /** @override */\n  set(properties: {[K in keyof HtmlAttributes as HtmlAttributes[K] extends {set(value: any): any} ? K : never]?: HtmlAttributes[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n\n  /** @override */\n  setIntrinsic<S>(this: S, properties: {[K in keyof S as S[K] extends {setIntrinsic(value: any): any} ? K : never]?: S[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  /** @override */\n  setIntrinsic(properties: {[K in keyof HtmlAttributes as HtmlAttributes[K] extends {setIntrinsic(value: any): any} ? K : never]?: HtmlAttributes[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n}\n\n/** @public */\nexport const HtmlAttributes = (<R, F extends HtmlAttributes<any>>() => ElementAttributes.extend<HtmlAttributes<R>, FastenerClass<F>>(\"HtmlAttributes\", {\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    HtmlAttributes.initFasteners(fastener);\n    return fastener;\n  },\n}))();\n\nHtmlAttributes.defineGetter(\"autocomplete\", [AttributeAnimator({\n  attributeName: \"autocomplete\",\n  valueType: String,\n})]);\n\nHtmlAttributes.defineGetter(\"checked\", [AttributeAnimator({\n  attributeName: \"checked\",\n  valueType: Boolean,\n})]);\n\nHtmlAttributes.defineGetter(\"colspan\", [AttributeAnimator({\n  attributeName: \"colspan\",\n  valueType: Number,\n})]);\n\nHtmlAttributes.defineGetter(\"disabled\", [AttributeAnimator({\n  attributeName: \"disabled\",\n  valueType: Boolean,\n})]);\n\nHtmlAttributes.defineGetter(\"href\", [AttributeAnimator({\n  attributeName: \"href\",\n  valueType: String,\n})]);\n\nHtmlAttributes.defineGetter(\"placeholder\", [AttributeAnimator({\n  attributeName: \"placeholder\",\n  valueType: String,\n})]);\n\nHtmlAttributes.defineGetter(\"rowspan\", [AttributeAnimator({\n  attributeName: \"rowspan\",\n  valueType: Number,\n})]);\n\nHtmlAttributes.defineGetter(\"selected\", [AttributeAnimator({\n  attributeName: \"selected\",\n  valueType: Boolean,\n})]);\n\nHtmlAttributes.defineGetter(\"title\", [AttributeAnimator({\n  attributeName: \"title\",\n  valueType: String,\n})]);\n\nHtmlAttributes.defineGetter(\"type\", [AttributeAnimator({\n  attributeName: \"type\",\n  valueType: String,\n})]);\n\nHtmlAttributes.defineGetter(\"value\", [AttributeAnimator({\n  attributeName: \"value\",\n  valueType: String,\n})]);\n\n/** @public */\nexport interface HtmlViewTagMap {\n  a: HtmlView;\n  abbr: HtmlView;\n  address: HtmlView;\n  area: HtmlView;\n  article: HtmlView;\n  aside: HtmlView;\n  audio: HtmlView;\n  b: HtmlView;\n  base: HtmlView;\n  bdi: HtmlView;\n  bdo: HtmlView;\n  blockquote: HtmlView;\n  body: HtmlView;\n  br: HtmlView;\n  button: HtmlView;\n  canvas: HtmlView;\n  caption: HtmlView;\n  cite: HtmlView;\n  code: HtmlView;\n  col: HtmlView;\n  colgroup: HtmlView;\n  data: HtmlView;\n  datalist: HtmlView;\n  dd: HtmlView;\n  del: HtmlView;\n  details: HtmlView;\n  dfn: HtmlView;\n  dialog: HtmlView;\n  div: HtmlView;\n  dl: HtmlView;\n  dt: HtmlView;\n  em: HtmlView;\n  embed: HtmlView;\n  fieldset: HtmlView;\n  figcaption: HtmlView;\n  figure: HtmlView;\n  footer: HtmlView;\n  form: HtmlView;\n  h1: HtmlView;\n  h2: HtmlView;\n  h3: HtmlView;\n  h4: HtmlView;\n  h5: HtmlView;\n  h6: HtmlView;\n  head: HtmlView;\n  header: HtmlView;\n  hr: HtmlView;\n  html: HtmlView;\n  i: HtmlView;\n  iframe: HtmlView;\n  img: HtmlView;\n  input: HtmlView;\n  ins: HtmlView;\n  kbd: HtmlView;\n  label: HtmlView;\n  legend: HtmlView;\n  li: HtmlView;\n  link: HtmlView;\n  main: HtmlView;\n  map: HtmlView;\n  mark: HtmlView;\n  meta: HtmlView;\n  meter: HtmlView;\n  nav: HtmlView;\n  noscript: HtmlView;\n  object: HtmlView;\n  ol: HtmlView;\n  optgroup: HtmlView;\n  option: HtmlView;\n  output: HtmlView;\n  p: HtmlView;\n  param: HtmlView;\n  picture: HtmlView;\n  pre: HtmlView;\n  progress: HtmlView;\n  q: HtmlView;\n  rb: HtmlView;\n  rp: HtmlView;\n  rt: HtmlView;\n  rtc: HtmlView;\n  ruby: HtmlView;\n  s: HtmlView;\n  samp: HtmlView;\n  script: HtmlView;\n  section: HtmlView;\n  select: HtmlView;\n  small: HtmlView;\n  slot: HtmlView;\n  source: HtmlView;\n  span: HtmlView;\n  strong: HtmlView;\n  style: StyleView;\n  sub: HtmlView;\n  summary: HtmlView;\n  sup: HtmlView;\n  table: HtmlView;\n  tbody: HtmlView;\n  td: HtmlView;\n  template: HtmlView;\n  textarea: HtmlView;\n  tfoot: HtmlView;\n  th: HtmlView;\n  thead: HtmlView;\n  time: HtmlView;\n  title: HtmlView;\n  tr: HtmlView;\n  track: HtmlView;\n  u: HtmlView;\n  ul: HtmlView;\n  var: HtmlView;\n  video: HtmlView;\n  wbr: HtmlView;\n}\n\n/** @public */\nexport interface HtmlViewFactory<V extends HtmlView = HtmlView> extends ElementViewFactory<V> {\n}\n\n/** @public */\nexport interface HtmlViewClass<V extends HtmlView = HtmlView> extends ElementViewClass<V>, HtmlViewFactory<V> {\n  readonly tag: string;\n}\n\n/** @public */\nexport interface HtmlViewConstructor<V extends HtmlView = HtmlView> extends ElementViewConstructor<V>, HtmlViewClass<V> {\n  readonly tag: string;\n}\n\n/** @public */\nexport interface HtmlViewObserver<V extends HtmlView = HtmlView> extends ElementViewObserver<V> {\n}\n\n/** @public */\nexport class HtmlView extends ElementView {\n  constructor(node: HTMLElement) {\n    super(node);\n  }\n\n  override likeType?(like: {create?(): View} | Node | keyof HtmlViewTagMap): void;\n\n  declare readonly observerType?: Class<HtmlViewObserver>;\n\n  declare readonly node: HTMLElement;\n\n  @HtmlAttributes({})\n  override get attributes(): HtmlAttributes<this> {\n    return HtmlAttributes.getter();\n  }\n\n  override setChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(key: string, newChildFactory: F): View | null;\n  override setChild(key: string, newChild: View | LikeType<HtmlView> | null): View | null;\n  override setChild(key: string, newChild: View | LikeType<HtmlView> | null): View | null {\n    if (typeof newChild === \"string\") {\n      newChild = HtmlView.fromTag(newChild);\n    }\n    return super.setChild(key, newChild);\n  }\n\n  override appendChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, key?: string): InstanceType<F>;\n  override appendChild<V extends View>(child: V | LikeType<V>, key?: string): V;\n  override appendChild<K extends keyof HtmlViewTagMap>(tag: K, key?: string): HtmlViewTagMap[K];\n  override appendChild(child: View | LikeType<HtmlView>, key?: string): View;\n  override appendChild(child: View | LikeType<HtmlView>, key?: string): View {\n    if (typeof child === \"string\") {\n      child = HtmlView.fromTag(child);\n    }\n    return super.appendChild(child, key);\n  }\n\n  override prependChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, key?: string): InstanceType<F>;\n  override prependChild<V extends View>(child: V | LikeType<V>, key?: string): V;\n  override prependChild<K extends keyof HtmlViewTagMap>(tag: K, key?: string): HtmlViewTagMap[K];\n  override prependChild(child: View | LikeType<HtmlView>, key?: string): View;\n  override prependChild(child: View | LikeType<HtmlView>, key?: string): View {\n    if (typeof child === \"string\") {\n      child = HtmlView.fromTag(child);\n    }\n    return super.prependChild(child, key);\n  }\n\n  override insertChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, target: View | Node | null, key?: string): InstanceType<F>;\n  override insertChild<V extends View>(child: V | LikeType<V>, target: View | Node | null, key?: string): V;\n  override insertChild<K extends keyof HtmlViewTagMap>(tag: K, target: View | Node | null, key?: string): HtmlViewTagMap[K];\n  override insertChild(child: View | LikeType<HtmlView>, target: View | Node | null, key?: string): View;\n  override insertChild(child: View | LikeType<HtmlView>, target: View | Node | null, key?: string): View {\n    if (typeof child === \"string\") {\n      child = HtmlView.fromTag(child);\n    }\n    return super.insertChild(child, target, key);\n  }\n\n  override replaceChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(newChildFactory: F, oldChild: View): View;\n  override replaceChild<V extends View>(newChild: View | LikeType<HtmlView>, oldChild: V): V;\n  override replaceChild(newChild: View | LikeType<HtmlView>, oldChild: View): View;\n  override replaceChild(newChild: View | LikeType<HtmlView>, oldChild: View): View {\n    if (typeof newChild === \"string\") {\n      newChild = HtmlView.fromTag(newChild);\n    }\n    return super.replaceChild(newChild, oldChild);\n  }\n\n  protected override onApplyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    super.onApplyTheme(theme, mood, timing);\n    if (this.node.hasAttribute(\"swim-theme\")) {\n      this.applyRootTheme(theme, mood, timing);\n    }\n  }\n\n  /** @internal */\n  applyRootTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    const font = theme.getOr(Look.font, Mood.ambient, null);\n    if (font !== null) {\n      if (font.style !== void 0) {\n        this.style.fontStyle.setState(font.style, void 0, Affinity.Transient);\n      }\n      if (font.variant !== void 0) {\n        this.style.fontVariant.setState(font.variant, void 0, Affinity.Transient);\n      }\n      if (font.weight !== void 0) {\n        this.style.fontWeight.setState(font.weight, void 0, Affinity.Transient);\n      }\n      if (font.stretch !== void 0) {\n        this.style.fontStretch.setState(font.stretch, void 0, Affinity.Transient);\n      }\n      if (font.size !== null) {\n        this.style.fontSize.setState(font.size, void 0, Affinity.Transient);\n      }\n      if (font.height !== null) {\n        this.style.lineHeight.setState(font.height, void 0, Affinity.Transient);\n      }\n      this.style.fontFamily.setState(font.family, void 0, Affinity.Transient);\n    }\n    this.style.backgroundColor.setIntrinsic(theme.getOr(Look.backgroundColor, Mood.ambient, null), timing);\n    this.style.color.setIntrinsic(theme.getOr(Look.textColor, Mood.ambient, null), timing);\n  }\n\n  /** @internal */\n  static isPositioned(element: HTMLElement): boolean {\n    const style = window.getComputedStyle(element);\n    return style.position === \"relative\" || style.position === \"absolute\";\n  }\n\n  isPositioned(): boolean {\n    return HtmlView.isPositioned(this.node);\n  }\n\n  /** @internal */\n  static parentTransform(element: HTMLElement): Transform {\n    if (HtmlView.isPositioned(element)) {\n      const dx = element.offsetLeft;\n      const dy = element.offsetTop;\n      if (dx !== 0 || dy !== 0) {\n        return Transform.translate(-dx, -dy);\n      }\n    }\n    return Transform.identity();\n  }\n\n  /** @internal */\n  static pageTransform(element: HTMLElement): Transform {\n    const parentNode = element.parentNode;\n    if (parentNode instanceof HTMLElement) {\n      return HtmlView.pageTransform(parentNode).transform(HtmlView.parentTransform(element));\n    }\n    return Transform.identity();\n  }\n\n  override get parentTransform(): Transform {\n    const transform = this.style.transform.value;\n    if (transform !== null) {\n      return transform;\n    } else if (this.isPositioned()) {\n      const dx = this.node.offsetLeft;\n      const dy = this.node.offsetTop;\n      if (dx !== 0 || dy !== 0) {\n        return Transform.translate(-dx, -dy);\n      }\n    }\n    return Transform.identity();\n  }\n\n  override get pageTransform(): Transform {\n    const parentView = this.parent;\n    if (parentView !== null) {\n      return parentView.pageTransform.transform(this.parentTransform);\n    }\n    const parentNode = this.node.parentNode;\n    if (parentNode instanceof HTMLElement) {\n      return HtmlView.pageTransform(parentNode).transform(this.parentTransform);\n    }\n    return Transform.identity();\n  }\n\n  override addEventListener<K extends keyof HTMLElementEventMap>(type: K, listener: (this: HTMLElement, event: HTMLElementEventMap[K]) => unknown, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void {\n    this.node.addEventListener(type, listener, options);\n  }\n\n  override removeEventListener<K extends keyof HTMLElementEventMap>(type: K, listener: (this: HTMLElement, event: HTMLElementEventMap[K]) => unknown, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void {\n    this.node.removeEventListener(type, listener, options);\n  }\n\n  static override readonly tag: string = \"div\";\n\n  static override create<S extends Class<Instance<S, HtmlView>>>(this: S): InstanceType<S>;\n  static override create(): HtmlView;\n  static override create(): HtmlView {\n    return this.fromTag(this.tag);\n  }\n\n  static override fromLike<S extends Class<Instance<S, View>>>(this: S, value: InstanceType<S> | LikeType<InstanceType<S>>): InstanceType<S> {\n    if (value === void 0 || value === null) {\n      return value as InstanceType<S>;\n    } else if (value instanceof View) {\n      if (!(value instanceof this)) {\n        throw new TypeError(value + \" not an instance of \" + this);\n      }\n      return value;\n    } else if (value instanceof HTMLElement) {\n      return (this as unknown as typeof HtmlView).fromNode(value) as InstanceType<S>;\n    } else if (Creatable[Symbol.hasInstance](value)) {\n      return (value as Creatable<InstanceType<S>>).create();\n    } else if (typeof value === \"string\") {\n      return (this as unknown as typeof HtmlView).fromTag(value) as InstanceType<S>;\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromNode<S extends new (node: HTMLElement) => Instance<S, HtmlView>>(this: S, node: HTMLElement): InstanceType<S>;\n  static override fromNode(node: HTMLElement): HtmlView;\n  static override fromNode(node: HTMLElement): HtmlView {\n    let view = this.get(node);\n    if (view === null) {\n      view = new this(node);\n      this.mount(view);\n    }\n    return view;\n  }\n\n  static override fromTag(tag: \"style\"): StyleView;\n  static override fromTag(tag: \"svg\"): SvgView;\n  static override fromTag<S extends Class<Instance<S, HtmlView>>>(this: S, tag: string): InstanceType<S>;\n  static override fromTag(tag: string): HtmlView;\n  static override fromTag(tag: string): ElementView {\n    if (tag === \"style\" && this !== StyleView) {\n      return StyleView.create();\n    } else if (tag === \"svg\") {\n      return SvgView.create();\n    }\n    const node = document.createElement(tag);\n    return this.fromNode(node);\n  }\n\n  static forTag<S extends Class<Instance<S, HtmlView>>>(this: S, tag: string): HtmlViewFactory<InstanceType<S>>;\n  static forTag(tag: string): HtmlViewFactory;\n  static forTag(tag: string): HtmlViewFactory {\n    if (tag === this.tag) {\n      return this;\n    }\n    return new HtmlViewTagFactory(this, tag);\n  }\n}\n\n/** @internal */\nexport class HtmlViewTagFactory<V extends HtmlView> implements HtmlViewFactory<V> {\n  constructor(factory: HtmlViewFactory<V>, tag: string) {\n    this.factory = factory;\n    this.tag = tag;\n  }\n\n  /** @internal */\n  readonly factory: HtmlViewFactory<V>;\n\n  readonly tag: string;\n\n  create(): V {\n    return this.fromTag(this.tag);\n  }\n\n  fromLike(value: V | LikeType<V>): V {\n    return this.factory.fromLike(value);\n  }\n\n  fromNode(node: HTMLElement): V {\n    return this.factory.fromNode(node);\n  }\n\n  fromTag(tag: string): V {\n    const node = document.createElement(tag);\n    return this.fromNode(node);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {StyleContext} from \"./StyleAnimator\";\nimport {StyleSheet} from \"./StyleSheet\";\nimport type {HtmlViewObserver} from \"./HtmlView\";\nimport {HtmlView} from \"./HtmlView\";\n\n/** @public */\nexport interface StyleViewObserver<V extends StyleView = StyleView> extends HtmlViewObserver<V> {\n}\n\n/** @public */\nexport class StyleView extends HtmlView implements StyleContext {\n  constructor(node: HTMLStyleElement) {\n    super(node);\n  }\n\n  declare readonly observerType?: Class<StyleViewObserver>;\n\n  declare readonly node: HTMLStyleElement;\n\n  @StyleSheet({})\n  readonly sheet!: StyleSheet<this>;\n\n  protected override onMount(): void {\n    super.onMount();\n    this.sheet.attachCss(this.node.sheet!);\n  }\n\n  protected override onUnmount(): void {\n    this.sheet.detachCss();\n    super.onUnmount();\n  }\n\n  /** @internal */\n  static override readonly tag: string = \"style\";\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {Instance} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Creatable} from \"@swim/util\";\nimport type {TimingLike} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport {Length} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport {Color} from \"@swim/style\";\nimport {View} from \"@swim/view\";\nimport {AttributeAnimator} from \"./AttributeAnimator\";\nimport type {AlignmentBaseline} from \"./csstypes\";\nimport type {CssCursor} from \"./csstypes\";\nimport type {FillRule} from \"./csstypes\";\nimport type {StrokeLinecap} from \"./csstypes\";\nimport type {StrokeLinejoin} from \"./csstypes\";\nimport type {SvgPointerEvents} from \"./csstypes\";\nimport type {TextAnchor} from \"./csstypes\";\nimport {ElementAttributes} from \"./ElementView\";\nimport type {ElementViewFactory} from \"./ElementView\";\nimport type {ElementViewClass} from \"./ElementView\";\nimport type {ElementViewConstructor} from \"./ElementView\";\nimport type {ElementViewObserver} from \"./ElementView\";\nimport {ElementView} from \"./ElementView\";\n\n/** @public */\nexport interface SvgAttributes<R = any> extends ElementAttributes<R> {\n  get alignmentBaseline(): AttributeAnimator<this, AlignmentBaseline | undefined>;\n\n  get clipPath(): AttributeAnimator<this, string | undefined>;\n\n  get cursor(): AttributeAnimator<this, CssCursor | undefined>;\n\n  get cx(): AttributeAnimator<this, number | undefined>;\n\n  get cy(): AttributeAnimator<this, number | undefined>;\n\n  get d(): AttributeAnimator<this, string | undefined>;\n\n  get dx(): AttributeAnimator<this, Length | null>;\n\n  get dy(): AttributeAnimator<this, Length | null>;\n\n  get edgeMode(): AttributeAnimator<this, string | undefined>;\n\n  get fill(): AttributeAnimator<this, Color | null>;\n\n  get fillOpacity(): AttributeAnimator<this, number | undefined>;\n\n  get fillRule(): AttributeAnimator<this, FillRule | undefined>;\n\n  get floodColor(): AttributeAnimator<this, Color | null>;\n\n  get floodOpacity(): AttributeAnimator<this, number | undefined>;\n\n  get height(): AttributeAnimator<this, Length | null>;\n\n  get in(): AttributeAnimator<this, string | undefined>;\n\n  get in2(): AttributeAnimator<this, string | undefined>;\n\n  get lengthAdjust(): AttributeAnimator<this, \"spacing\" | \"spacingAndGlyphs\" | undefined>;\n\n  get mode(): AttributeAnimator<this, string | undefined>;\n\n  get opacity(): AttributeAnimator<this, number | undefined>;\n\n  get pointerEvents(): AttributeAnimator<this, SvgPointerEvents | undefined>;\n\n  get points(): AttributeAnimator<this, string | undefined>;\n\n  get preserveAspectRatio(): AttributeAnimator<this, boolean | undefined>;\n\n  get r(): AttributeAnimator<this, number | undefined>;\n\n  get result(): AttributeAnimator<this, string | undefined>;\n\n  get stdDeviation(): AttributeAnimator<this, number | undefined>;\n\n  get stroke(): AttributeAnimator<this, Color | null>;\n\n  get strokeDasharray(): AttributeAnimator<this, string | undefined>;\n\n  get strokeDashoffset(): AttributeAnimator<this, number | undefined>;\n\n  get strokeLinecap(): AttributeAnimator<this, StrokeLinecap | undefined>;\n\n  get strokeLinejoin(): AttributeAnimator<this, StrokeLinejoin | undefined>;\n\n  get strokeMiterlimit(): AttributeAnimator<this, number | undefined>;\n\n  get strokeOpacity(): AttributeAnimator<this, number | undefined>;\n\n  get strokeWidth(): AttributeAnimator<this, number | undefined>;\n\n  get textAnchor(): AttributeAnimator<this, TextAnchor | undefined>;\n\n  get textLength(): AttributeAnimator<this, Length | null>;\n\n  get transform(): AttributeAnimator<this, Transform | null>;\n\n  get type(): AttributeAnimator<this, string | undefined>;\n\n  get values(): AttributeAnimator<this, string | undefined>;\n\n  get viewBox(): AttributeAnimator<this, string | undefined>;\n\n  get width(): AttributeAnimator<this, Length | null>;\n\n  get x(): AttributeAnimator<this, number | undefined>;\n\n  get x1(): AttributeAnimator<this, number | undefined>;\n\n  get x2(): AttributeAnimator<this, number | undefined>;\n\n  get y(): AttributeAnimator<this, number | undefined>;\n\n  get y1(): AttributeAnimator<this, number | undefined>;\n\n  get y2(): AttributeAnimator<this, number | undefined>;\n\n  /** @override */\n  set<S>(this: S, properties: {[K in keyof S as S[K] extends {set(value: any): any} ? K : never]?: S[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  /** @override */\n  set(properties: {[K in keyof SvgAttributes as SvgAttributes[K] extends {set(value: any): any} ? K : never]?: SvgAttributes[K] extends {set(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n\n  /** @override */\n  setIntrinsic<S>(this: S, properties: {[K in keyof S as S[K] extends {setIntrinsic(value: any): any} ? K : never]?: S[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n  /** @override */\n  setIntrinsic(properties: {[K in keyof SvgAttributes as SvgAttributes[K] extends {setIntrinsic(value: any): any} ? K : never]?: SvgAttributes[K] extends {setIntrinsic(value: infer T): any} ? T : never}, timing?: TimingLike | boolean | null): R;\n}\n\n/** @public */\nexport const SvgAttributes = (<R, F extends SvgAttributes<any>>() => ElementAttributes.extend<SvgAttributes<R>, FastenerClass<F>>(\"SvgAttributes\", {\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    SvgAttributes.initFasteners(fastener);\n    return fastener;\n  },\n}))();\n\nSvgAttributes.defineGetter(\"alignmentBaseline\", [AttributeAnimator({\n  attributeName: \"alignment-baseline\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"clipPath\", [AttributeAnimator({\n  attributeName: \"clip-path\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"cursor\", [AttributeAnimator({\n  attributeName: \"cursor\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"cx\", [AttributeAnimator({\n  attributeName: \"cx\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"cy\", [AttributeAnimator({\n  attributeName: \"cy\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"d\", [AttributeAnimator({\n  attributeName: \"d\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"dx\", [AttributeAnimator({\n  attributeName: \"dx\",\n  valueType: Length,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"dy\", [AttributeAnimator({\n  attributeName: \"dy\",\n  valueType: Length,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"edgeMode\", [AttributeAnimator({\n  attributeName: \"edgeMode\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"fill\", [AttributeAnimator({\n  attributeName: \"fill\",\n  valueType: Color,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"fillOpacity\", [AttributeAnimator({\n  attributeName: \"fill-opacity\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"fillRule\", [AttributeAnimator({\n  attributeName: \"fill-rule\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"floodColor\", [AttributeAnimator({\n  attributeName: \"flood-color\",\n  valueType: Color,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"floodOpacity\", [AttributeAnimator({\n  attributeName: \"flood-opacity\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"height\", [AttributeAnimator({\n  attributeName: \"height\",\n  valueType: Length,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"in\", [AttributeAnimator({\n  attributeName: \"in\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"in2\", [AttributeAnimator({\n  attributeName: \"in2\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"lengthAdjust\", [AttributeAnimator({\n  attributeName: \"lengthAdjust\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"mode\", [AttributeAnimator({\n  attributeName: \"mode\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"opacity\", [AttributeAnimator({\n  attributeName: \"opacity\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"pointerEvents\", [AttributeAnimator({\n  attributeName: \"pointer-events\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"points\", [AttributeAnimator({\n  attributeName: \"points\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"preserveAspectRatio\", [AttributeAnimator({\n  attributeName: \"preserveAspectRatio\",\n  valueType: Boolean,\n})]);\n\nSvgAttributes.defineGetter(\"r\", [AttributeAnimator({\n  attributeName: \"r\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"result\", [AttributeAnimator({\n  attributeName: \"result\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"stdDeviation\", [AttributeAnimator({\n  attributeName: \"stdDeviation\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"stroke\", [AttributeAnimator({\n  attributeName: \"stroke\",\n  valueType: Color,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"strokeDasharray\", [AttributeAnimator({\n  attributeName: \"stroke-dasharray\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"strokeDashoffset\", [AttributeAnimator({\n  attributeName: \"stroke-dashoffset\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"strokeLinecap\", [AttributeAnimator({\n  attributeName: \"stroke-linecap\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"strokeLinejoin\", [AttributeAnimator({\n  attributeName: \"stroke-linejoin\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"strokeMiterlimit\", [AttributeAnimator({\n  attributeName: \"stroke-miterlimit\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"strokeOpacity\", [AttributeAnimator({\n  attributeName: \"stroke-opacity\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"strokeWidth\", [AttributeAnimator({\n  attributeName: \"stroke-width\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"textAnchor\", [AttributeAnimator({\n  attributeName: \"text-anchor\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"textLength\", [AttributeAnimator({\n  attributeName: \"textLength\",\n  valueType: Length,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"transform\", [AttributeAnimator({\n  attributeName: \"transform\",\n  valueType: Transform,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"type\", [AttributeAnimator({\n  attributeName: \"type\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"values\", [AttributeAnimator({\n  attributeName: \"values\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"viewBox\", [AttributeAnimator({\n  attributeName: \"viewBox\",\n  valueType: String,\n})]);\n\nSvgAttributes.defineGetter(\"width\", [AttributeAnimator({\n  attributeName: \"width\",\n  valueType: Length,\n  value: null,\n})]);\n\nSvgAttributes.defineGetter(\"x\", [AttributeAnimator({\n  attributeName: \"x\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"x1\", [AttributeAnimator({\n  attributeName: \"x1\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"x2\", [AttributeAnimator({\n  attributeName: \"x2\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"y\", [AttributeAnimator({\n  attributeName: \"y\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"y1\", [AttributeAnimator({\n  attributeName: \"y1\",\n  valueType: Number,\n})]);\n\nSvgAttributes.defineGetter(\"y2\", [AttributeAnimator({\n  attributeName: \"y2\",\n  valueType: Number,\n})]);\n\n/** @public */\nexport interface SvgViewTagMap {\n  a: SvgView;\n  animate: SvgView;\n  animateMotion: SvgView;\n  animateTransform: SvgView;\n  audio: SvgView;\n  canvas: SvgView;\n  circle: SvgView;\n  clipPath: SvgView;\n  defs: SvgView;\n  desc: SvgView;\n  discard: SvgView;\n  ellipse: SvgView;\n  feBlend: SvgView;\n  feColorMatrix: SvgView;\n  feComponentTransfer: SvgView;\n  feComposite: SvgView;\n  feConvolveMatrix: SvgView;\n  feDiffuseLighting: SvgView;\n  feDisplacementMap: SvgView;\n  feDistantLight: SvgView;\n  feDropShadow: SvgView;\n  feFlood: SvgView;\n  feFuncA: SvgView;\n  feFuncB: SvgView;\n  feFuncG: SvgView;\n  feFuncR: SvgView;\n  feGaussianBlur: SvgView;\n  feImage: SvgView;\n  feMerge: SvgView;\n  feMergeNode: SvgView;\n  feMorphology: SvgView;\n  feOffset: SvgView;\n  fePointLight: SvgView;\n  feSpecularLighting: SvgView;\n  feSpotLight: SvgView;\n  feTile: SvgView;\n  feTurbulence: SvgView;\n  filter: SvgView;\n  foreignObject: SvgView;\n  g: SvgView;\n  iframe: SvgView;\n  image: SvgView;\n  line: SvgView;\n  linearGradient: SvgView;\n  marker: SvgView;\n  mask: SvgView;\n  metadata: SvgView;\n  mpath: SvgView;\n  path: SvgView;\n  pattern: SvgView;\n  polygon: SvgView;\n  polyline: SvgView;\n  radialGradient: SvgView;\n  rect: SvgView;\n  script: SvgView;\n  set: SvgView;\n  stop: SvgView;\n  style: SvgView;\n  svg: SvgView;\n  switch: SvgView;\n  symbol: SvgView;\n  text: SvgView;\n  textPath: SvgView;\n  title: SvgView;\n  tspan: SvgView;\n  unknown: SvgView;\n  use: SvgView;\n  video: SvgView;\n  view: SvgView;\n}\n\n/** @public */\nexport interface SvgViewFactory<V extends SvgView = SvgView> extends ElementViewFactory<V> {\n}\n\n/** @public */\nexport interface SvgViewClass<V extends SvgView = SvgView> extends ElementViewClass<V>, SvgViewFactory<V> {\n  readonly tag: string;\n  readonly namespace: string;\n}\n\n/** @public */\nexport interface SvgViewConstructor<V extends SvgView = SvgView> extends ElementViewConstructor<V>, SvgViewClass<V> {\n  readonly tag: string;\n  readonly namespace: string;\n}\n\n/** @public */\nexport interface SvgViewObserver<V extends SvgView = SvgView> extends ElementViewObserver<V> {\n}\n\n/** @public */\nexport class SvgView extends ElementView {\n  constructor(node: SVGElement) {\n    super(node);\n  }\n\n  override likeType?(like: {create?(): View} | Node | keyof SvgViewTagMap): void;\n\n  declare readonly observerType?: Class<SvgViewObserver>;\n\n  declare readonly node: SVGElement;\n\n  @SvgAttributes({})\n  override get attributes(): SvgAttributes<this> {\n    return SvgAttributes.getter();\n  }\n\n  override setChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(key: string, newChildFactory: F): View | null;\n  override setChild(key: string, newChild: View | LikeType<SvgView> | null): View | null;\n  override setChild(key: string, newChild: View | LikeType<SvgView> | null): View | null {\n    if (typeof newChild === \"string\") {\n      newChild = SvgView.fromTag(newChild);\n    }\n    return super.setChild(key, newChild);\n  }\n\n  override appendChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, key?: string): InstanceType<F>;\n  override appendChild<V extends View>(child: V | LikeType<V>, key?: string): V;\n  override appendChild<K extends keyof SvgViewTagMap>(tag: K, key?: string): SvgViewTagMap[K];\n  override appendChild(child: View | LikeType<SvgView>, key?: string): View;\n  override appendChild(child: View | LikeType<SvgView>, key?: string): View {\n    if (typeof child === \"string\") {\n      child = SvgView.fromTag(child);\n    }\n    return super.appendChild(child, key);\n  }\n\n  override prependChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, key?: string): InstanceType<F>;\n  override prependChild<V extends View>(child: V | LikeType<V>, key?: string): V;\n  override prependChild<K extends keyof SvgViewTagMap>(tag: K, key?: string): SvgViewTagMap[K];\n  override prependChild(child: View | LikeType<SvgView>, key?: string): View;\n  override prependChild(child: View | LikeType<SvgView>, key?: string): View {\n    if (typeof child === \"string\") {\n      child = SvgView.fromTag(child);\n    }\n    return super.prependChild(child, key);\n  }\n\n  override insertChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(childFactory: F, target: View | Node | null, key?: string): InstanceType<F>;\n  override insertChild<V extends View>(child: V | LikeType<V>, target: View | Node | null, key?: string): V;\n  override insertChild<K extends keyof SvgViewTagMap>(tag: K, target: View | Node | null, key?: string): SvgViewTagMap[K];\n  override insertChild(child: View | LikeType<SvgView>, target: View | Node | null, key?: string): View;\n  override insertChild(child: View | LikeType<SvgView>, target: View | Node | null, key?: string): View {\n    if (typeof child === \"string\") {\n      child = SvgView.fromTag(child);\n    }\n    return super.insertChild(child, target, key);\n  }\n\n  override replaceChild<F extends Class<Instance<F, View>> & Creatable<Instance<F, View>>>(newChildFactory: F, oldChild: View): View;\n  override replaceChild<V extends View>(newChild: View | LikeType<SvgView>, oldChild: V): V;\n  override replaceChild(newChild: View | LikeType<SvgView>, oldChild: View): View;\n  override replaceChild(newChild: View | LikeType<SvgView>, oldChild: View): View {\n    if (typeof newChild === \"string\") {\n      newChild = SvgView.fromTag(newChild);\n    }\n    return super.replaceChild(newChild, oldChild);\n  }\n\n  override get parentTransform(): Transform {\n    const transform = this.attributes.transform.value;\n    return transform !== null ? transform : Transform.identity();\n  }\n\n  override addEventListener<K extends keyof SVGElementEventMap>(type: K, listener: (this: SVGElement, event: SVGElementEventMap[K]) => unknown, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void {\n    this.node.addEventListener(type, listener, options);\n  }\n\n  override removeEventListener<K extends keyof SVGElementEventMap>(type: K, listener: (this: SVGElement, event: SVGElementEventMap[K]) => unknown, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void {\n    this.node.removeEventListener(type, listener, options);\n  }\n\n  static override readonly tag: string = \"svg\";\n\n  static override readonly namespace: string = \"http://www.w3.org/2000/svg\";\n\n  static override create<S extends Class<Instance<S, SvgView>>>(this: S): InstanceType<S>;\n  static override create(): SvgView;\n  static override create(): SvgView {\n    return this.fromTag(this.tag);\n  }\n\n  static override fromLike<S extends Class<Instance<S, View>>>(this: S, value: InstanceType<S> | LikeType<InstanceType<S>>): InstanceType<S> {\n    if (value === void 0 || value === null) {\n      return value as InstanceType<S>;\n    } else if (value instanceof View) {\n      if (!(value instanceof this)) {\n        throw new TypeError(value + \" not an instance of \" + this);\n      }\n      return value;\n    } else if (value instanceof SVGElement) {\n      return (this as unknown as typeof SvgView).fromNode(value) as InstanceType<S>;\n    } else if (Creatable[Symbol.hasInstance](value)) {\n      return (value as Creatable<InstanceType<S>>).create();\n    } else if (typeof value === \"string\") {\n      return (this as unknown as typeof SvgView).fromTag(value) as InstanceType<S>;\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromNode<S extends new (node: SVGElement) => Instance<S, SvgView>>(this: S, node: SVGElement): InstanceType<S>;\n  static override fromNode(node: SVGElement): SvgView;\n  static override fromNode(node: SVGElement): SvgView {\n    let view = this.get(node);\n    if (view === null) {\n      view = new this(node);\n      this.mount(view);\n    }\n    return view;\n  }\n\n  static override fromTag<S extends Class<Instance<S, SvgView>>>(this: S, tag: string): InstanceType<S>;\n  static override fromTag(tag: string): SvgView;\n  static override fromTag(tag: string): SvgView {\n    const node = document.createElementNS(this.namespace, tag) as SVGElement;\n    return this.fromNode(node);\n  }\n\n  static forTag<S extends Class<Instance<S, SvgView>>>(this: S, tag: string): SvgViewFactory<InstanceType<S>>;\n  static forTag(tag: string): SvgViewFactory;\n  static forTag(tag: string): SvgViewFactory {\n    if (tag === this.tag) {\n      return this;\n    }\n    return new SvgViewTagFactory(this, tag);\n  }\n}\n\n/** @internal */\nexport class SvgViewTagFactory<V extends SvgView> implements SvgViewFactory<V> {\n  constructor(factory: SvgViewFactory<V>, tag: string) {\n    this.factory = factory;\n    this.tag = tag;\n  }\n\n  /** @internal */\n  readonly factory: SvgViewFactory<V>;\n\n  readonly tag: string;\n\n  get namespace(): string {\n    return SvgView.namespace;\n  }\n\n  create(): V {\n    return this.fromTag(this.tag);\n  }\n\n  fromLike(value: V | LikeType<V>): V {\n    return this.factory.fromLike(value);\n  }\n\n  fromNode(node: SVGElement): V {\n    return this.factory.fromNode(node);\n  }\n\n  fromTag(tag: string): V {\n    const node = document.createElementNS(this.namespace, tag) as SVGElement;\n    return this.fromNode(node);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport {ViewSet} from \"@swim/view\";\nimport {NodeView} from \"./NodeView\";\nimport type {TextView} from \"./TextView\";\nimport {ElementView} from \"./ElementView\";\nimport {HtmlView} from \"./HtmlView\";\nimport {SvgView} from \"./SvgView\";\n\n/** @public */\nexport interface DomServiceObserver<S extends DomService = DomService> extends ServiceObserver<S> {\n  serviceWillAttachRoot?(rootView: ElementView, service: S): void;\n\n  serviceDidAttachRoot?(rootView: ElementView, service: S): void;\n\n  serviceWillDetachRoot?(rootView: ElementView, service: S): void;\n\n  serviceDidDetachRoot?(rootView: ElementView, service: S): void;\n}\n\n/** @public */\nexport class DomService extends Service {\n  /** @override */\n  declare readonly observerType?: Class<DomServiceObserver>;\n\n  @ViewSet({\n    initView(rootView: ElementView): void {\n      if (rootView.node.hasAttribute(\"swim-app\")) {\n        this.owner.materializeView(rootView);\n      }\n    },\n    willAttachView(rootView: ElementView): void {\n      this.owner.callObservers(\"serviceWillAttachRoot\", rootView, this.owner);\n    },\n    didAttachView(rootView: ElementView): void {\n      this.owner.callObservers(\"serviceDidAttachRoot\", rootView, this.owner);\n    },\n    willDetachView(rootView: ElementView): void {\n      this.owner.callObservers(\"serviceWillDetachRoot\", rootView, this.owner);\n    },\n    didDetachView(rootView: ElementView): void {\n      this.owner.callObservers(\"serviceDidDetachRoot\", rootView, this.owner);\n    },\n  })\n  readonly roots!: ViewSet<this, ElementView>;\n\n  materializeView(parentView: NodeView): void {\n    const childNodes = parentView.node.childNodes;\n    for (let i = 0; i < childNodes.length; i += 1) {\n      const childNode = childNodes[i]!;\n      const childView = this.materializeNode(parentView, childNode);\n      if (childView !== null) {\n        this.materializeView(childView);\n      }\n    }\n  }\n\n  materializeNode(parentView: NodeView, childNode: Node): NodeView | null {\n    const childView = NodeView.get(childNode);\n    if (childView !== null) {\n      return childView;\n    } else if (childNode instanceof Element) {\n      return this.materializeElement(parentView, childNode);\n    } else if (childNode instanceof Text) {\n      return this.materializeText(parentView, childNode);\n    }\n    return null;\n  }\n\n  materializeElement(parentView: NodeView, childNode: Element): ElementView | null {\n    let viewClass: typeof ElementView | undefined;\n    const viewClassName = childNode.getAttribute(\"swim-view\");\n    if (viewClassName !== null) {\n      viewClass = DomService.eval(viewClassName) as typeof ElementView | undefined;\n      if (typeof viewClass !== \"function\") {\n        throw new TypeError(viewClassName);\n      }\n    }\n    if (viewClass === void 0) {\n      if (childNode instanceof HTMLElement) {\n        viewClass = HtmlView;\n      } else if (childNode instanceof SVGElement) {\n        viewClass = SvgView;\n      } else {\n        viewClass = ElementView;\n      }\n    }\n    const childView = new viewClass(childNode);\n    const key = childNode.getAttribute(\"key\");\n    parentView.injectChild(childView, null, key !== null ? key : void 0);\n    return childView;\n  }\n\n  materializeText(parentView: NodeView, childNode: Text): TextView | null {\n    return null;\n  }\n\n  static boot(): ElementView[] {\n    const views: ElementView[] = [];\n    const nodes = document.querySelectorAll(\"[swim-app]\");\n    for (let i = 0; i < nodes.length; i += 1) {\n      const node = nodes[i];\n      if (node instanceof HTMLElement) {\n        const view = DomService.bootElement(node);\n        views.push(view);\n      }\n    }\n    return views;\n  }\n\n  static bootElement(node: Element): ElementView {\n    let view = ElementView.get(node);\n    if (view !== null) {\n      return view;\n    }\n    let viewClass: typeof ElementView | undefined;\n    const viewClassName = node.getAttribute(\"swim-app\");\n    if (viewClassName !== null && viewClassName !== \"\") {\n      viewClass = DomService.eval(viewClassName) as typeof ElementView | undefined;\n      if (typeof viewClass !== \"function\") {\n        throw new TypeError(viewClassName);\n      }\n    }\n    if (viewClass === void 0) {\n      if (node instanceof HTMLElement) {\n        viewClass = HtmlView;\n      } else if (node instanceof SVGElement) {\n        viewClass = SvgView;\n      } else {\n        viewClass = ElementView;\n      }\n    }\n    view = new viewClass(node);\n    viewClass.mount(view);\n    return view;\n  }\n\n  /** @internal */\n  static eval(qname: string): unknown {\n    let value: any = typeof globalThis !== \"undefined\" ? globalThis\n                   : typeof self !== \"undefined\" ? self\n                   : typeof window !== \"undefined\" ? window\n                   : typeof global !== \"undefined\" ? global\n                   : void 0;\n    const idents = qname.split(\".\");\n    for (let i = 0; typeof value === \"object\" && value !== null && i < idents.length; i += 1) {\n      const ident = idents[i]!;\n      value = value[ident];\n    }\n    return value;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {Property} from \"@swim/component\";\nimport type {Presence} from \"@swim/style\";\nimport type {PresenceAnimator} from \"@swim/style\";\nimport type {ElementViewObserver} from \"./ElementView\";\nimport {ElementView} from \"./ElementView\";\n\n/** @public */\nexport interface ModalOptions {\n  modal?: boolean;\n  multi?: boolean;\n}\n\n/** @public */\nexport interface ModalViewObserver<V extends ModalView = ModalView> extends ElementViewObserver<V> {\n  viewWillPresent?(view: V): void;\n\n  viewDidPresent?(view: V): void;\n\n  viewWillDismiss?(view: V): void;\n\n  viewDidDismiss?(view: V): void;\n\n  viewDidSetPresence?(presence: Presence, view: V): void;\n\n  viewDidSetModality?(modality: number, view: V): void;\n}\n\n/** @public */\nexport interface ModalView extends ElementView {\n  /** @override */\n  readonly observerType?: Class<ModalViewObserver<any>>;\n\n  readonly presence: PresenceAnimator<this, Presence>;\n\n  readonly modality: Property<this, number>;\n}\n\n/** @public */\nexport const ModalView = {\n  [Symbol.hasInstance](instance: unknown): instance is ModalView {\n    return instance instanceof ElementView\n        && \"presence\" in instance\n        && \"modality\" in instance;\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport {EventHandler} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport type {View} from \"@swim/view\";\nimport {ViewRef} from \"@swim/view\";\nimport {ViewSet} from \"@swim/view\";\nimport {ElementView} from \"./ElementView\";\nimport type {ModalOptions} from \"./ModalView\";\nimport type {ModalView} from \"./ModalView\";\n\n/** @public */\nexport interface ModalServiceObserver<S extends ModalService = ModalService> extends ServiceObserver<S> {\n  serviceWillAttachModal?(modalView: ModalView, service: S): void;\n\n  serviceDidAttachModal?(modalView: ModalView, service: S): void;\n\n  serviceWillDetachModal?(modalView: ModalView, service: S): void;\n\n  serviceDidDetachModal?(modalView: ModalView, service: S): void;\n\n  serviceWillPresentModal?(modalView: ModalView, service: S): void;\n\n  serviceDidPresentModal?(modalView: ModalView, service: S): void;\n\n  serviceWillDismissModal?(modalView: ModalView, service: S): void;\n\n  serviceDidDismissModal?(modalView: ModalView, service: S): void;\n\n  serviceDidSetModality?(newModality: number, oldModality: number, service: S): void;\n}\n\n/** @public */\nexport class ModalService extends Service {\n  /** @override */\n  declare readonly observerType?: Class<ModalServiceObserver>;\n\n  @ViewRef({\n    viewType: ElementView,\n  })\n  readonly matte!: ViewRef<this, ElementView>;\n\n  @ViewSet({\n    observes: true,\n    get parentView(): ElementView | null {\n      const parentView = this.owner.matte.view;\n      if (parentView !== null) {\n        return parentView;\n      }\n      return ElementView.get(document.body);\n    },\n    insertChild(parent: View, child: ElementView, target: View | null, key: string | undefined): void {\n      super.insertChild(parent, child, target, key);\n      if (child.parent === null && !child.mounted) {\n        document.body.appendChild(child.node);\n        child.mount();\n      }\n    },\n    initView(modalView: ModalView): void {\n      this.owner.modality.update();\n    },\n    willAttachView(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceWillAttachModal\", modalView, this.owner);\n    },\n    didAttachView(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceDidAttachModal\", modalView, this.owner);\n    },\n    deinitView(modalView: ModalView): void {\n      this.owner.modality.update();\n    },\n    willDetachView(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceWillDetachModal\", modalView, this.owner);\n    },\n    didDetachView(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceDidDetachModal\", modalView, this.owner);\n    },\n    viewWillPresent(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceWillPresentModal\", modalView, this.owner);\n    },\n    viewDidPresent(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceDidPresentModal\", modalView, this.owner);\n    },\n    viewWillDismiss(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceWillDismissModal\", modalView, this.owner);\n    },\n    viewDidDismiss(modalView: ModalView): void {\n      this.owner.callObservers(\"serviceDidDismissModal\", modalView, this.owner);\n      this.detachView(modalView);\n    },\n    viewDidSetModality(modality: number, modalView: ModalView): void {\n      this.owner.modality.update();\n    },\n  })\n  readonly modals!: ViewSet<this, ModalView> & Observes<ModalView>;\n\n  presentModal(modalView: ModalView, options: ModalOptions = {}): void {\n    if (!options.multi) {\n      this.dismissModals();\n    }\n    this.modals.insertView(null, modalView);\n    modalView.presence.present(true);\n  }\n\n  dismissModal(modalView: ModalView): void {\n    if (this.modals.hasView(modalView)) {\n      modalView.presence.dismiss(true);\n    }\n  }\n\n  dismissModals(): void {\n    const modalViews = this.modals.views;\n    for (const viewId in modalViews) {\n      const modalView = modalViews[viewId]!;\n      this.dismissModal(modalView);\n    }\n  }\n\n  displaceModals(): void {\n    const modalViews = this.modals.views;\n    for (const viewId in modalViews) {\n      const modalView = modalViews[viewId]!;\n      if (modalView.presence.presented) {\n        this.dismissModal(modalView);\n      }\n    }\n  }\n\n  toggleModal(modalView: ModalView, options?: ModalOptions): void {\n    const presence = modalView.presence.value;\n    if (presence.dismissed || presence.dismissing) {\n      this.presentModal(modalView, options);\n    } else if (presence.presented || presence.presenting) {\n      this.dismissModal(modalView);\n    }\n  }\n\n  @Property({\n    valueType: Number,\n    value: 0,\n    update(): void {\n      if (!this.hasAffinity(Affinity.Intrinsic)) {\n        return;\n      }\n      let modality = 0;\n      const modalViews = this.owner.modals.views;\n      for (const viewId in modalViews) {\n        const modalView = modalViews[viewId]!;\n        modality = Math.min(Math.max(modality, modalView.modality.value), 1);\n      }\n      this.setIntrinsic(modality);\n    },\n    didSetValue(newModality: number, oldModality: number): void {\n      this.owner.callObservers(\"serviceDidSetModality\", newModality, oldModality, this.owner);\n    },\n  })\n  readonly modality!: Property<this, number> & {\n    /** @internal */\n    update(): void,\n  };\n\n  @EventHandler({\n    eventType: \"click\",\n    target: typeof document !== \"undefined\" ? document : null,\n    handle(event: Event): void {\n      this.owner.displaceModals();\n    },\n  })\n  readonly fallthrough!: EventHandler<this>;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport type GraphicsRendererLike = GraphicsRenderer | GraphicsRendererType;\n\n/** @public */\nexport type GraphicsRendererType = \"canvas\" | \"webgl\";\n\n/** @public */\nexport abstract class GraphicsRenderer {\n  likeType?(like: GraphicsRendererType): void;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Objects} from \"@swim/util\";\nimport type {R2Box} from \"@swim/math\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\n\n/** @public */\nexport interface Graphics {\n  render(renderer: GraphicsRenderer, frame: R2Box): void;\n}\n\n/** @public */\nexport const Graphics = {\n  [Symbol.hasInstance](instance: unknown): instance is Graphics {\n    return Objects.hasAllKeys<Graphics>(instance, \"render\");\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport {Property} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport {R2Box} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport type {Color} from \"@swim/style\";\nimport type {ViewFlags} from \"@swim/view\";\nimport type {ViewObserver} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport type {GraphicsEvent} from \"./GraphicsEvent\";\nimport type {GraphicsEventHandler} from \"./GraphicsEvent\";\nimport {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {CanvasContext} from \"./CanvasContext\";\nimport {CanvasView} from \"./\"; // forward import\nimport {SpriteService} from \"./\"; // forward import\n\n/** @public */\nexport interface GraphicsViewEventMap {\n  \"auxclick\": MouseEvent;\n  \"click\": MouseEvent;\n  \"contextmenu\": MouseEvent;\n  \"dblclick\": MouseEvent;\n  \"mousedown\": MouseEvent;\n  \"mouseenter\": MouseEvent;\n  \"mouseleave\": MouseEvent;\n  \"mousemove\": MouseEvent;\n  \"mouseout\": MouseEvent;\n  \"mouseover\": MouseEvent;\n  \"mouseup\": MouseEvent;\n  \"pointercancel\": PointerEvent;\n  \"pointerdown\": PointerEvent;\n  \"pointerenter\": PointerEvent;\n  \"pointerleave\": PointerEvent;\n  \"pointermove\": PointerEvent;\n  \"pointerout\": PointerEvent;\n  \"pointerover\": PointerEvent;\n  \"pointerup\": PointerEvent;\n  \"touchcancel\": TouchEvent;\n  \"touchend\": TouchEvent;\n  \"touchmove\": TouchEvent;\n  \"touchstart\": TouchEvent;\n  \"wheel\": WheelEvent;\n}\n\n/** @public */\nexport interface GraphicsViewObserver<V extends GraphicsView = GraphicsView> extends ViewObserver<V> {\n}\n\n/** @public */\nexport class GraphicsView extends View {\n  constructor() {\n    super();\n    this.ownViewFrame = null;\n    this.eventHandlers = null;\n  }\n\n  declare readonly observerType?: Class<GraphicsViewObserver>;\n\n  @Property({\n    valueType: GraphicsRenderer,\n    value: null,\n    inherits: true,\n  })\n  readonly renderer!: Property<this, GraphicsRenderer | null>;\n\n  protected override needsProcess(processFlags: ViewFlags): ViewFlags {\n    if ((this.flags & View.NeedsAnimate) === 0) {\n      processFlags &= ~View.NeedsAnimate;\n    }\n    return processFlags;\n  }\n\n  protected renderViewOutline(viewBox: R2Box, context: CanvasContext, outlineColor: Color, outlineWidth: number): void {\n    if (!viewBox.isDefined()) {\n      return;\n    }\n\n    // save\n    const contextLineWidth = context.lineWidth;\n    const contextStrokeStyle = context.strokeStyle;\n\n    context.beginPath();\n    context.moveTo(viewBox.xMin, viewBox.yMin);\n    context.lineTo(viewBox.xMin, viewBox.yMax);\n    context.lineTo(viewBox.xMax, viewBox.yMax);\n    context.lineTo(viewBox.xMax, viewBox.yMin);\n    context.closePath();\n    context.lineWidth = outlineWidth;\n    context.strokeStyle = outlineColor.toString();\n    context.stroke();\n\n    // restore\n    context.lineWidth = contextLineWidth;\n    context.strokeStyle = contextStrokeStyle;\n  }\n\n  @Provider({\n    get serviceType(): typeof SpriteService { // avoid static forward reference\n      return SpriteService;\n    },\n  })\n  get sprites(): Provider<this, SpriteService> {\n    return Provider.getter();\n  }\n\n  /** @internal */\n  readonly ownViewFrame: R2Box | null;\n\n  /**\n   * The parent-specified view-coordinate bounding box in which this view\n   * should layout and render graphics.\n   */\n  get viewFrame(): R2Box {\n    let viewFrame = this.ownViewFrame;\n    if (viewFrame === null) {\n      viewFrame = this.deriveViewFrame();\n    }\n    return viewFrame;\n  }\n\n  /**\n   * Sets the view-coordinate bounding box in which this view should layout\n   * and render graphics. Should only be invoked by the view's parent view.\n   */\n  setViewFrame(viewFrame: R2Box | null): void {\n    (this as Mutable<this>).ownViewFrame = viewFrame;\n  }\n\n  protected deriveViewFrame(): R2Box {\n    const parent = this.parent;\n    if (parent instanceof GraphicsView || parent instanceof CanvasView) {\n      return parent.viewFrame;\n    }\n    return R2Box.undefined();\n  }\n\n  cullViewFrame(viewFrame: R2Box = this.viewFrame): void {\n    this.setCulled(!viewFrame.intersects(this.viewBounds));\n  }\n\n  /**\n   * The self-defined view-coordinate bounding box surrounding all graphics\n   * this view could possibly render. Views with view bounds that don't\n   * overlap their view frames may be culled from rendering and hit testing.\n   */\n  declare readonly viewBounds: R2Box; // getter defined below to work around useDefineForClassFields lunacy\n\n  get ownViewBounds(): R2Box | null {\n    return null;\n  }\n\n  deriveViewBounds(): R2Box {\n    let viewBounds: R2Box | undefined;\n    let child = this.firstChild;\n    while (child !== null) {\n      if (child instanceof GraphicsView && !child.hidden && !child.unbounded) {\n        const childViewBounds = child.viewBounds;\n        if (childViewBounds.isDefined()) {\n          if (viewBounds !== void 0) {\n            viewBounds = viewBounds.union(childViewBounds);\n          } else {\n            viewBounds = childViewBounds;\n          }\n        }\n      }\n      child = child.nextSibling;\n    }\n    if (viewBounds === void 0) {\n      viewBounds = this.viewFrame;\n    }\n    return viewBounds;\n  }\n\n  /**\n   * The self-defined view-coordinate bounding box surrounding all hit regions\n   * in this view.\n   */\n  get hitBounds(): R2Box {\n    return this.viewBounds;\n  }\n\n  deriveHitBounds(): R2Box {\n    let hitBounds: R2Box | undefined;\n    let child = this.firstChild;\n    while (child !== null) {\n      if (child instanceof GraphicsView && !child.hidden && !child.intangible) {\n        const childHitBounds = child.hitBounds;\n        if (hitBounds === void 0) {\n          hitBounds = childHitBounds;\n        } else {\n          hitBounds = hitBounds.union(childHitBounds);\n        }\n      }\n      child = child.nextSibling;\n    }\n    if (hitBounds === void 0) {\n      hitBounds = this.viewBounds;\n    }\n    return hitBounds;\n  }\n\n  cascadeHitTest(x: number, y: number): GraphicsView | null {\n    if (this.hidden || this.culled || this.intangible || !this.hitBounds.contains(x, y)) {\n      return null;\n    }\n    let hit = this.hitTestChildren(x, y);\n    if (hit === null) {\n      hit = this.hitTest(x, y);\n    }\n    return hit;\n  }\n\n  protected hitTest(x: number, y: number): GraphicsView | null {\n    return null;\n  }\n\n  protected hitTestChildren(x: number, y: number): GraphicsView | null {\n    let child = this.firstChild;\n    while (child !== null) {\n      if (child instanceof GraphicsView) {\n        const hit = this.hitTestChild(child, x, y);\n        if (hit !== null) {\n          return hit;\n        }\n      }\n      child = child.nextSibling;\n    }\n    return null;\n  }\n\n  protected hitTestChild(child: GraphicsView, x: number, y: number): GraphicsView | null {\n    return child.cascadeHitTest(x, y);\n  }\n\n  override get parentTransform(): Transform {\n    return Transform.identity();\n  }\n\n  override get clientBounds(): R2Box {\n    const inverseClientTransform = this.clientTransform.inverse();\n    return this.viewBounds.transform(inverseClientTransform);\n  }\n\n  override get popoverFrame(): R2Box {\n    const inversePageTransform = this.pageTransform.inverse();\n    return this.viewBounds.transform(inversePageTransform);\n  }\n\n  /** @internal */\n  readonly eventHandlers: {[type: string]: GraphicsEventHandler[] | undefined} | null;\n\n  override addEventListener<K extends keyof GraphicsViewEventMap>(type: K, listener: (this: this, event: GraphicsViewEventMap[K]) => unknown, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void;\n  override addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: AddEventListenerOptions | boolean): void {\n    let eventHandlers = this.eventHandlers;\n    if (eventHandlers === null) {\n      eventHandlers = {};\n      (this as Mutable<this>).eventHandlers = eventHandlers;\n    }\n    let handlers = eventHandlers[type];\n    const capture = typeof options === \"boolean\" ? options : typeof options === \"object\" && options !== null && options.capture || false;\n    const passive = options && typeof options === \"object\" && options.passive || false;\n    const once = options && typeof options === \"object\" && options.once || false;\n    let handler: GraphicsEventHandler | undefined;\n    if (handlers === void 0) {\n      handler = {listener, capture, passive, once};\n      handlers = [handler];\n      eventHandlers[type] = handlers;\n      return;\n    }\n    const n = handlers.length;\n    let i = 0;\n    while (i < n) {\n      handler = handlers[i]!;\n      if (handler.listener === listener && handler.capture === capture) {\n        break;\n      }\n      i += 1;\n    }\n    if (i < n) {\n      handler!.passive = passive;\n      handler!.once = once;\n    } else {\n      handler = {listener, capture, passive, once};\n      handlers.push(handler);\n    }\n  }\n\n  override removeEventListener<K extends keyof GraphicsViewEventMap>(type: K, listener: (this: View, event: GraphicsViewEventMap[K]) => unknown, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void;\n  override removeEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: EventListenerOptions | boolean): void {\n    const eventHandlers = this.eventHandlers;\n    if (eventHandlers === null) {\n      return;\n    }\n    const handlers = eventHandlers[type];\n    if (handlers === void 0) {\n      return;\n    }\n    const capture = typeof options === \"boolean\" ? options : typeof options === \"object\" && options !== null && options.capture || false;\n    const n = handlers.length;\n    let i = 0;\n    while (i < n) {\n      const handler = handlers[i]!;\n      if (handler.listener === listener && handler.capture === capture) {\n        handlers.splice(i, 1);\n        if (handlers.length === 0) {\n          delete eventHandlers[type];\n        }\n        break;\n      }\n      i += 1;\n    }\n  }\n\n  /** @internal */\n  handleEvent(event: GraphicsEvent): void {\n    const type = event.type;\n    const eventHandlers = this.eventHandlers;\n    if (eventHandlers === null) {\n      return;\n    }\n    const handlers = eventHandlers[type];\n    if (handlers === void 0) {\n      return;\n    }\n    let i = 0;\n    while (i < handlers.length) {\n      const handler = handlers[i]!;\n      if (!handler.capture) {\n        const listener = handler.listener;\n        if (typeof listener === \"function\") {\n          if (typeof listener.call === \"function\") {\n            listener.call(this, event);\n          } else {\n            listener(event);\n          }\n        } else if (typeof listener === \"object\" && listener !== null) {\n          listener.handleEvent(event);\n        }\n        if (handler.once) {\n          handlers.splice(i, 1);\n          continue;\n        }\n      }\n      i += 1;\n    }\n    if (handlers.length === 0) {\n      delete eventHandlers[type];\n    }\n  }\n\n  /**\n   * Invokes event handlers registered with this `View` before propagating the\n   * `event` up the view hierarchy. Returns a `View`, without invoking any\n   * registered event handlers, on which `dispatchEvent` should be called to\n   * continue event propagation.\n   * @internal\n   */\n  bubbleEvent(event: GraphicsEvent): View | null {\n    this.handleEvent(event);\n    if (!event.bubbles || event.cancelBubble) {\n      return null;\n    }\n    const parent = this.parent;\n    if (parent instanceof GraphicsView || parent instanceof CanvasView) {\n      return parent.bubbleEvent(event);\n    }\n    return parent;\n  }\n\n  override dispatchEvent(event: GraphicsEvent): boolean {\n    event.targetView = this;\n    const next = this.bubbleEvent(event);\n    if (next === null) {\n      return !event.cancelBubble;\n    }\n    return next.dispatchEvent(event);\n  }\n\n  static override readonly UncullFlags: ViewFlags = View.UncullFlags | View.NeedsRender;\n  static override readonly UnhideFlags: ViewFlags = View.UnhideFlags | View.NeedsRender;\n  static override readonly InsertChildFlags: ViewFlags = View.InsertChildFlags | View.NeedsRender;\n  static override readonly RemoveChildFlags: ViewFlags = View.RemoveChildFlags | View.NeedsRender;\n}\nObject.defineProperty(GraphicsView.prototype, \"viewBounds\", {\n  get(this: GraphicsView): R2Box {\n    return this.viewFrame;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Transform} from \"@swim/math\";\nimport {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {DrawingContext} from \"./DrawingContext\";\n\n/** @public */\nexport abstract class DrawingRenderer extends GraphicsRenderer {\n  abstract readonly context: DrawingContext;\n\n  abstract readonly transform: Transform;\n\n  abstract readonly pixelRatio: number;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Format} from \"@swim/codec\";\nimport type {DrawingContext} from \"./DrawingContext\";\n\n/** @public */\nexport class PathContext implements DrawingContext {\n  constructor() {\n    this.precision = -1;\n    this.x0 = NaN;\n    this.y0 = NaN;\n    this.x1 = NaN;\n    this.y1 = NaN;\n    this.d = \"\";\n  }\n\n  readonly precision!: number;\n\n  setPrecision(precision: number): void {\n    (this as Mutable<this>).precision = precision;\n  }\n\n  /** @internal */\n  get anglePrecision(): number {\n    const precision = this.precision;\n    return precision > 0 ? Math.max(5, precision) : precision;\n  }\n\n  /** @internal */\n  x0: number;\n  /** @internal */\n  y0: number;\n  /** @internal */\n  x1: number;\n  /** @internal */\n  y1: number;\n  /** @internal */\n  d: string;\n\n  moveTo(x: number, y: number): void {\n    this.d += \"M\" + Format.decimal(x, this.precision)\n            + \",\" + Format.decimal(y, this.precision);\n    this.x0 = x;\n    this.y0 = y;\n    this.x1 = x;\n    this.y1 = y;\n  }\n\n  lineTo(x: number, y: number): void {\n    this.d += \"L\" + Format.decimal(x, this.precision)\n            + \",\" + Format.decimal(y, this.precision);\n    this.x1 = x;\n    this.y1 = y;\n  }\n\n  quadraticCurveTo(x1: number, y1: number, x: number, y: number): void {\n    this.d += \"Q\" + Format.decimal(x1, this.precision)\n            + \",\" + Format.decimal(y1, this.precision)\n            + \",\" + Format.decimal(x, this.precision)\n            + \",\" + Format.decimal(y, this.precision);\n    this.x1 = x;\n    this.y1 = y;\n  }\n\n  bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x: number, y: number): void {\n    this.d += \"C\" + Format.decimal(x1, this.precision)\n            + \",\" + Format.decimal(y1, this.precision)\n            + \",\" + Format.decimal(x2, this.precision)\n            + \",\" + Format.decimal(y2, this.precision)\n            + \",\" + Format.decimal(x, this.precision)\n            + \",\" + Format.decimal(y, this.precision);\n    this.x1 = x;\n    this.y1 = y;\n  }\n\n  arcTo(x1: number, y1: number, x2: number, y2: number, r: number): void {\n    const x0 = this.x1;\n    const y0 = this.y1;\n    const x21 = x2 - x1;\n    const y21 = y2 - y1;\n    const x01 = x0 - x1;\n    const y01 = y0 - y1;\n    const l01_2 = x01 * x01 + y01 * y01;\n\n    if (r < 0) {\n      throw new Error(\"negative radius: \" + r);\n    } else if (isNaN(this.x1)) {\n      // empty path\n      this.d += \"M\" + Format.decimal(x1, this.precision)\n              + \",\" + Format.decimal(y1, this.precision);\n      this.x1 = x1;\n      this.y1 = y1;\n    } else if (!(l01_2 > PathContext.Epsilon)) {\n      // coincident endpoints\n    } else if (!(Math.abs(y01 * x21 - y21 * x01) > PathContext.Epsilon) || r === 0) {\n      // colinear control points\n      this.d += \"L\" + Format.decimal(x1, this.precision)\n              + \",\" + Format.decimal(y1, this.precision);\n      this.x1 = x1;\n      this.y1 = y1;\n    } else {\n      const x20 = x2 - x0;\n      const y20 = y2 - y0;\n      const l21_2 = x21 * x21 + y21 * y21;\n      const l20_2 = x20 * x20 + y20 * y20;\n      const l21 = Math.sqrt(l21_2);\n      const l01 = Math.sqrt(l01_2);\n      const l = r * Math.tan((Math.PI - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2);\n      const t01 = l / l01;\n      const t21 = l / l21;\n      if (Math.abs(t01 - 1) > PathContext.Epsilon) {\n        // line to start tangent\n        this.d += \"L\" + Format.decimal(x1 + t01 * x01, this.precision)\n                + \",\" + Format.decimal(y1 + t01 * y01, this.precision);\n      }\n      x1 = x1 + t21 * x21;\n      y1 = y1 + t21 * y21;\n      const rs = Format.decimal(r, this.precision);\n      this.d += \"A\" + rs\n              + \",\" + rs\n              + \",0\"\n              + \",0\"\n              + \",\" + (y01 * x20 > x01 * y20 ? \"1\" : \"0\")\n              + \",\" + Format.decimal(x1, this.precision)\n              + \",\" + Format.decimal(y1, this.precision);\n      this.x1 = x1;\n      this.y1 = y1;\n    }\n  }\n\n  arc(cx: number, cy: number, r: number, a0: number, a1: number, ccw: boolean = false): void {\n    const dx = r * Math.cos(a0);\n    const dy = r * Math.sin(a0);\n    const x0 = cx + dx;\n    const y0 = cy + dy;\n    const cw = 1 ^ +ccw;\n    let da = ccw ? a0 - a1 : a1 - a0;\n\n    if (r < 0) {\n      throw new Error(\"negative radius: \" + r);\n    } else if (isNaN(this.x1)) {\n      // empty path\n      this.d += \"M\" + Format.decimal(x0, this.precision)\n              + \",\" + Format.decimal(y0, this.precision);\n    } else if (Math.abs(this.x1 - x0) > PathContext.Epsilon || Math.abs(this.y1 - y0) > PathContext.Epsilon) {\n      // line to start point\n      this.d += \"L\" + Format.decimal(x0, this.precision)\n              + \",\" + Format.decimal(y0, this.precision);\n    }\n\n    if (r === 0) {\n      return;\n    } else if (da < 0) {\n      // reverse direction\n      da = da % (2 * Math.PI) + 2 * Math.PI;\n    }\n\n    const rs = Format.decimal(r, this.precision);\n    if (da > 2 * Math.PI - PathContext.Epsilon) {\n      // complete circle\n      this.d += \"A\" + rs\n              + \",\" + rs\n              + \",0\"\n              + \",1\"\n              + \",\" + (cw ? \"1\" : \"0\")\n              + \",\" + Format.decimal(x0, this.precision)\n              + \",\" + Format.decimal(y0, this.precision);\n      this.x1 = x0;\n      this.y1 = y0;\n    } else if (da > PathContext.Epsilon) {\n      // non-zero arc angle\n      const x1 = cx + r * Math.cos(a1);\n      const y1 = cy + r * Math.sin(a1);\n      this.d += \"A\" + rs\n              + \",\" + rs\n              + \",0\"\n              + \",\" + (da >= Math.PI ? \"1\" : \"0\")\n              + \",\" + (cw ? \"1\" : \"0\")\n              + \",\" + Format.decimal(x1, this.precision)\n              + \",\" + Format.decimal(y1, this.precision);\n      this.x1 = x1;\n      this.y1 = y1;\n    }\n  }\n\n  rect(x: number, y: number, w: number, h: number): void {\n    this.d += \"M\" + Format.decimal(x, this.precision)\n            + \",\" + Format.decimal(y, this.precision)\n            + \"h\" + Format.decimal(w, this.precision)\n            + \"v\" + Format.decimal(h, this.precision)\n            + \"h\" + Format.decimal(-w, this.precision)\n            + \"Z\";\n    this.x0 = x;\n    this.y0 = y;\n    this.x1 = x;\n    this.y1 = y;\n  }\n\n  ellipse(cx: number, cy: number, rx: number, ry: number, phi: number, a0: number, a1: number, ccw: boolean = false): void {\n    const cosPhi = Math.cos(phi);\n    const sinPhi = Math.sin(phi);\n    const cosA1 = Math.cos(a1);\n    const sinA1 = Math.sin(a1);\n    const x1 = cosPhi * rx * cosA1 - sinPhi * ry * sinA1 + cx;\n    const y1 = sinPhi * rx * cosA1 + cosPhi * ry * sinA1 + cy;\n    const da = a1 - a0;\n    const large = Math.abs(da) > Math.PI;\n    const sweep = !ccw;\n    this.d += \"A\" + Format.decimal(rx, this.precision)\n            + \",\" + Format.decimal(ry, this.precision)\n            + \",\" + Format.decimal(phi, this.anglePrecision)\n            + \",\" + (large ? \"1\" : \"0\")\n            + \",\" + (sweep ? \"1\" : \"0\")\n            + \",\" + Format.decimal(x1, this.precision)\n            + \",\" + Format.decimal(y1, this.precision);\n    this.x1 = x1;\n    this.y1 = y1;\n  }\n\n  closePath(): void {\n    if (isNaN(this.x1)) {\n      return;\n    }\n    this.d += \"Z\";\n    this.x1 = this.x0;\n    this.y1 = this.y0;\n  }\n\n  toString(): string {\n    return this.d;\n  }\n\n  /** @internal */\n  static Epsilon: number = 1e-6;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Transform} from \"@swim/math\";\nimport {DrawingRenderer} from \"./DrawingRenderer\";\nimport type {PathContext} from \"./PathContext\";\n\n/** @public */\nexport class PathRenderer extends DrawingRenderer {\n  constructor(context: PathContext) {\n    super();\n    this.context = context;\n  }\n\n  readonly context: PathContext;\n\n  override get transform(): Transform {\n    return Transform.identity();\n  }\n\n  override get pixelRatio(): number {\n    return 1;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {DrawingRenderer} from \"./DrawingRenderer\";\nimport type {PaintingContext} from \"./PaintingContext\";\n\n/** @public */\nexport abstract class PaintingRenderer extends DrawingRenderer {\n  abstract override readonly context: PaintingContext;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {NodeView} from \"@swim/dom\";\nimport {SvgView} from \"@swim/dom\";\nimport {PathContext} from \"./PathContext\";\nimport type {PaintingFillRule} from \"./PaintingContext\";\nimport type {PaintingContext} from \"./PaintingContext\";\n\n/** @public */\nexport class SvgContext implements PaintingContext {\n  constructor(view: SvgView) {\n    this.view = view;\n    this.precision = -1;\n    this.pathContext = null;\n    this.pathView = null;\n    this.pathFlags = 0;\n    this.globalAlpha = 1;\n    this.globalCompositeOperation = \"source-over\";\n    this.fillStyle = \"\";\n    this.strokeStyle = \"\";\n    this.lineWidth = 1;\n    this.lineCap = \"butt\";\n    this.lineJoin = \"miter\";\n    this.miterLimit = 10;\n    this.lineDashOffset = 0;\n    this.lineDash = [];\n  }\n\n  readonly view: SvgView;\n\n  readonly precision: number;\n\n  setPrecision(precision: number): void {\n    (this as Mutable<this>).precision = precision;\n  }\n\n  /** @internal */\n  readonly pathContext: PathContext | null;\n\n  protected getPathContext(): PathContext {\n    const pathContext = this.pathContext;\n    if (pathContext === null) {\n      throw new Error(\"no path\");\n    }\n    return pathContext;\n  }\n\n  protected getOrCreatePathContext(): PathContext {\n    let pathContext = this.pathContext;\n    if (pathContext === null) {\n      pathContext = this.createPathContext();\n      (this as Mutable<this>).pathContext = pathContext;\n      if (this.pathView === null || this.pathFlags !== 0) {\n        this.finalizePath();\n        const pathView = this.nextPathView();\n        this.setPathView(pathView);\n      }\n      this.setPathFlags(0);\n    }\n    return pathContext;\n  }\n\n  protected createPathContext(): PathContext {\n    const pathContext = new PathContext();\n    pathContext.setPrecision(this.precision);\n    return pathContext;\n  }\n\n  /** @internal */\n  readonly pathView: SvgView | null;\n\n  /** @internal */\n  setPathView(pathView: SvgView | null): void {\n    (this as Mutable<this>).pathView = pathView;\n  }\n\n  /** @internal */\n  nextPathView(): SvgView | null {\n    const pathView = this.pathView;\n    if (pathView === null) {\n      return null;\n    }\n    let nextNode = pathView.node.nextSibling;\n    while (nextNode !== null) {\n      if (nextNode instanceof SVGPathElement) {\n        return SvgView.fromNode(nextNode);\n      }\n      nextNode = nextNode.nextSibling;\n    }\n    return null;\n  }\n\n  /** @internal */\n  finalizePath(): void {\n    const pathView = this.pathView;\n    if (pathView === null) {\n      return;\n    }\n    const pathFlags = this.pathFlags;\n    if ((pathFlags & SvgContext.FillFlag) === 0) {\n      pathView.attributes.fill.setIntrinsic(null);\n    }\n    if ((pathFlags & SvgContext.FillRuleFlag) === 0) {\n      pathView.attributes.fillRule.setIntrinsic(void 0);\n    }\n    if ((pathFlags & SvgContext.StrokeFlag) === 0) {\n      pathView.attributes.stroke.setIntrinsic(null);\n    }\n    if ((pathFlags & SvgContext.PathFlag) === 0) {\n      pathView.attributes.d.setIntrinsic(void 0);\n    }\n  }\n\n  /** @internal */\n  readonly pathFlags: number;\n\n  /** @internal */\n  setPathFlags(pathFlags: number): void {\n    (this as Mutable<this>).pathFlags = pathFlags;\n  }\n\n  globalAlpha: number;\n\n  globalCompositeOperation: string;\n\n  fillStyle: string | CanvasGradient | CanvasPattern;\n\n  strokeStyle: string | CanvasGradient | CanvasPattern;\n\n  lineWidth: number;\n\n  lineCap: CanvasLineCap;\n\n  lineJoin: CanvasLineJoin;\n\n  miterLimit: number;\n\n  lineDashOffset: number;\n\n  /** @internal */\n  lineDash: number[];\n\n  getLineDash(): number[] {\n    return this.lineDash;\n  }\n\n  setLineDash(segments: number[]): void {\n    this.lineDash = segments;\n  }\n\n  beginPath(): void {\n    (this as Mutable<this>).pathContext = null;\n  }\n\n  moveTo(x: number, y: number): void {\n    this.getOrCreatePathContext().moveTo(x, y);\n  }\n\n  lineTo(x: number, y: number): void {\n    this.getPathContext().lineTo(x, y);\n  }\n\n  quadraticCurveTo(x1: number, y1: number, x: number, y: number): void {\n    this.getPathContext().quadraticCurveTo(x1, y1, x, y);\n  }\n\n  bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x: number, y: number): void {\n    this.getPathContext().bezierCurveTo(x1, y1, x2, y2, x, y);\n  }\n\n  arcTo(x1: number, y1: number, x2: number, y2: number, r: number): void {\n    this.getPathContext().arcTo(x1, y1, x2, y2, r);\n  }\n\n  arc(cx: number, cy: number, r: number, a0: number, a1: number, ccw?: boolean): void {\n    this.getOrCreatePathContext().arc(cx, cy, r, a0, a1, ccw);\n  }\n\n  ellipse(cx: number, cy: number, rx: number, ry: number, phi: number, a0: number, a1: number, ccw?: boolean): void {\n    this.getOrCreatePathContext().ellipse(cx, cy, rx, ry, phi, a0, a1, ccw);\n  }\n\n  rect(x: number, y: number, w: number, h: number): void {\n    this.getOrCreatePathContext().rect(x, y, w, h);\n  }\n\n  closePath(): void {\n    const pathContext = this.pathContext;\n    if (pathContext !== null) {\n      pathContext.closePath();\n    }\n  }\n\n  fill(fillRule?: PaintingFillRule): void {\n    const fillStyle = this.fillStyle;\n    if (typeof fillStyle !== \"string\") {\n      throw new Error(\"unsupported fill style: \" + fillStyle);\n    }\n    let pathView = this.pathView;\n    if (pathView !== null && (this.pathFlags & SvgContext.FillFlag) !== 0) {\n      this.finalizePath();\n      pathView = this.nextPathView();\n      this.setPathView(pathView);\n    }\n    let created = false;\n    if (pathView === null) {\n      pathView = SvgView.fromTag(\"path\");\n      this.setPathView(pathView);\n      created = true;\n    }\n    pathView.attributes.fill.setIntrinsic(fillStyle);\n    pathView.attributes.fillOpacity.setIntrinsic(this.globalAlpha !== 1 ? this.globalAlpha : void 0);\n    this.setPathFlags(this.pathFlags | SvgContext.FillFlag);\n    if (fillRule !== void 0) {\n      pathView.attributes.fillRule.setIntrinsic(fillRule);\n      this.setPathFlags(this.pathFlags | SvgContext.FillRuleFlag);\n    }\n    if ((this.pathFlags & SvgContext.PathFlag) === 0) {\n      const pathString = this.getPathContext().toString();\n      pathView.attributes.d.setIntrinsic(pathString);\n      this.setPathFlags(this.pathFlags | SvgContext.PathFlag);\n    }\n    if (created) {\n      this.view.appendChild(pathView);\n    }\n  }\n\n  stroke(): void {\n    const strokeStyle = this.strokeStyle;\n    const lineWidth = this.lineWidth;\n    if (typeof strokeStyle !== \"string\" || lineWidth === 0 || !isFinite(lineWidth)) {\n      throw new Error(\"unsupported stroke style: \" + strokeStyle);\n    }\n    let pathView = this.pathView;\n    if (pathView !== null && (this.pathFlags & SvgContext.StrokeFlag) !== 0) {\n      this.finalizePath();\n      pathView = this.nextPathView();\n      this.setPathView(pathView);\n    }\n    let created = false;\n    if (pathView === null) {\n      pathView = SvgView.fromTag(\"path\");\n      this.setPathView(pathView);\n      created = true;\n    }\n    pathView.attributes.setIntrinsic({\n      stroke: strokeStyle,\n      strokeWidth: lineWidth,\n      strokeLinecap: this.lineCap,\n      strokeLinejoin: this.lineJoin,\n      strokeOpacity: this.globalAlpha !== 1 ? this.globalAlpha : void 0,\n      strokeMiterlimit: this.lineJoin === \"miter\" ? this.miterLimit : void 0,\n    });\n    if (this.lineDash.length !== 0) {\n      let dash = \"\";\n      for (let i = 0; i < this.lineDash.length; i += 1) {\n        if (i !== 0) {\n          dash += \" \";\n        }\n        dash += this.lineDash[i];\n      }\n      pathView.attributes.setIntrinsic({\n        strokeDasharray: dash,\n        strokeDashoffset: this.lineDashOffset !== 0 ? this.lineDashOffset : void 0,\n      });\n    } else {\n      pathView.attributes.setIntrinsic({\n        strokeDasharray: void 0,\n        strokeDashoffset: void 0,\n      });\n    }\n    this.setPathFlags(this.pathFlags | SvgContext.StrokeFlag);\n    if ((this.pathFlags & SvgContext.PathFlag) === 0) {\n      const pathString = this.getPathContext().toString();\n      pathView.attributes.d.setIntrinsic(pathString);\n      this.setPathFlags(this.pathFlags | SvgContext.PathFlag);\n    }\n    if (created) {\n      this.view.appendChild(pathView);\n    }\n  }\n\n  beginSvg(): void {\n    let pathView: SvgView | null = null;\n    let nextNode = this.view.node.firstChild;\n    while (nextNode !== null) {\n      if (nextNode instanceof SVGPathElement) {\n        pathView = SvgView.fromNode(nextNode);\n        break;\n      }\n      nextNode = nextNode.nextSibling;\n    }\n    this.setPathView(pathView);\n    this.setPathFlags(0);\n  }\n\n  finalizeSvg(): void {\n    let pathView = this.pathView;\n    if (pathView === null) {\n      return;\n    }\n    let nextNode = pathView.node.nextSibling;\n    if (pathView.attributes.fill.state === null && pathView.attributes.stroke.state === null) {\n      (this as Mutable<this>).pathView = null;\n      pathView.remove();\n    }\n    pathView = null;\n    while (nextNode !== null) {\n      const nextView = NodeView.get(nextNode);\n      nextNode = nextNode.nextSibling;\n      if (nextView !== null) {\n        nextView.remove();\n      }\n    }\n  }\n\n  /** @internal */\n  static readonly FillFlag: number = 1 << 0;\n  /** @internal */\n  static readonly FillRuleFlag: number = 1 << 1;\n  /** @internal */\n  static readonly StrokeFlag: number = 1 << 2;\n  /** @internal */\n  static readonly PathFlag: number = 1 << 3;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Transform} from \"@swim/math\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport type {SvgContext} from \"./SvgContext\";\n\n/** @public */\nexport class SvgRenderer extends PaintingRenderer {\n  constructor(context: SvgContext) {\n    super();\n    this.context = context;\n  }\n\n  override readonly context: SvgContext;\n\n  override get transform(): Transform {\n    return Transform.identity();\n  }\n\n  override get pixelRatio(): number {\n    return 1;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Transform} from \"@swim/math\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport type {CanvasContext} from \"./CanvasContext\";\n\n/** @public */\nexport class CanvasRenderer extends PaintingRenderer {\n  constructor(context: CanvasContext, transform: Transform, pixelRatio: number) {\n    super();\n    this.context = context;\n    this.transform = transform;\n    this.pixelRatio = pixelRatio;\n  }\n\n  override readonly context: CanvasContext;\n\n  override readonly transform: Transform;\n\n  setTransform(transform: Transform): void {\n    (this as Mutable<this>).transform = transform;\n  }\n\n  override readonly pixelRatio: number;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {WebGLContext} from \"./WebGLContext\";\n\n/** @public */\nexport class WebGLRenderer extends GraphicsRenderer {\n  constructor(context: WebGLContext, pixelRatio?: number) {\n    super();\n    this.context = context;\n    this.pixelRatio = pixelRatio !== void 0 ? pixelRatio : window.devicePixelRatio || 1;\n  }\n\n  readonly context: WebGLContext;\n\n  readonly pixelRatio: number;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Box} from \"@swim/math\";\nimport type {CanvasContext} from \"./CanvasContext\";\nimport type {CanvasRenderer} from \"./CanvasRenderer\";\nimport type {SpriteSheet} from \"./SpriteSheet\";\n\n/** @public */\nexport class Sprite {\n  /** @internal */\n  constructor(sheet: SpriteSheet, rowIndex: number, colIndex: number) {\n    this.sheet = sheet;\n    this.rowIndex = rowIndex;\n    this.colIndex = colIndex;\n  }\n\n  /** @internal */\n  readonly sheet: SpriteSheet;\n\n  /** @internal */\n  readonly rowIndex: number;\n\n  /** @internal */\n  readonly colIndex: number;\n\n  get width(): number {\n    return this.sheet.spriteWidth;\n  }\n\n  get height(): number {\n    return this.sheet.spriteHeight;\n  }\n\n  get pixelRatio(): number {\n    return this.sheet.pixelRatio;\n  }\n\n  getRenderer(): CanvasRenderer {\n    return this.sheet.getSpriteRenderer(this.rowIndex, this.colIndex);\n  }\n\n  clear(): void {\n    return this.sheet.clearSprite(this.rowIndex, this.colIndex);\n  }\n\n  draw(context: CanvasContext, frame: R2Box): void {\n    this.sheet.drawSprite(context, frame, this.rowIndex, this.colIndex);\n  }\n\n  release(): void {\n    this.sheet.releaseSprite(this);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Box} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport {Sprite} from \"./Sprite\";\nimport type {CanvasContext} from \"./CanvasContext\";\nimport {CanvasRenderer} from \"./\"; // forward import\n\n/** @public */\nexport class SpriteSheet {\n  constructor(spriteWidth: number, spriteHeight: number,\n              canvasWidth: number, canvasHeight: number, pixelRatio: number) {\n    const rowCount = Math.floor(canvasHeight / spriteHeight);\n    const colCount = Math.floor(canvasWidth / spriteWidth);\n    const spriteCount = rowCount * colCount;\n    const sprites = new Array<Sprite>(spriteCount);\n    const freeSprites = new Array<Sprite>(spriteCount);\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = canvasWidth * pixelRatio;\n    canvas.height = canvasHeight * pixelRatio;\n    canvas.style.width = canvasWidth + \"px\";\n    canvas.style.height = canvasHeight + \"px\";\n    const context = canvas.getContext(\"2d\")!;\n    const renderer = new CanvasRenderer(context, Transform.identity(), pixelRatio);\n\n    this.spriteWidth = spriteWidth;\n    this.spriteHeight = spriteHeight;\n    this.sprites = sprites;\n    this.freeSprites = freeSprites;\n    this.canvas = canvas;\n    this.renderer = renderer;\n    this.nextSheet = null;\n\n    this.createSprites(sprites, rowCount, colCount);\n\n    for (let k = 0; k < spriteCount; k += 1) {\n      freeSprites[k] = sprites[spriteCount - k - 1]!;\n    }\n  }\n\n  protected createSprites(sprites: Sprite[], rowCount: number, colCount: number): void {\n    let k = 0;\n    for (let rowIndex = 0; rowIndex < rowCount; rowIndex += 1) {\n      for (let colIndex = 0; colIndex < colCount; colIndex += 1) {\n        const sprite = this.createSprite(rowIndex, colIndex);\n        sprites[k] = sprite;\n        k += 1;\n      }\n    }\n  }\n\n  protected createSprite(rowIndex: number, colIndex: number): Sprite {\n    return new Sprite(this, rowIndex, colIndex);\n  }\n\n  readonly spriteWidth: number;\n\n  readonly spriteHeight: number;\n\n  readonly sprites: readonly Sprite[];\n\n  /** @internal */\n  readonly freeSprites: Sprite[];\n\n  readonly canvas: HTMLCanvasElement;\n\n  readonly renderer: CanvasRenderer;\n\n  /** @internal */\n  nextSheet: SpriteSheet | null;\n\n  get pixelRatio(): number {\n    return this.renderer.pixelRatio;\n  }\n\n  get canvasWidth(): number {\n    return this.canvas.width / this.pixelRatio;\n  }\n\n  get canvasHeight(): number {\n    return this.canvas.height / this.pixelRatio;\n  }\n\n  get rowCount(): number {\n    return Math.floor(this.canvasHeight / this.spriteHeight);\n  }\n\n  get colCount(): number {\n    return Math.floor(this.canvasWidth / this.spriteWidth);\n  }\n\n  get spriteCount(): number {\n    return this.rowCount * this.colCount;\n  }\n\n  get freeCount(): number {\n    return this.freeSprites.length;\n  }\n\n  /** @internal */\n  static acquireNextFreeSheet(sheet: SpriteSheet): SpriteSheet | null {\n    do {\n      const nextSheet = sheet.nextSheet;\n      if (nextSheet === null) {\n        return null;\n      } else if (nextSheet.freeCount !== 0) {\n        sheet.nextSheet = nextSheet.nextSheet;\n        nextSheet.nextSheet = null;\n        return nextSheet;\n      } else {\n        sheet = nextSheet;\n      }\n    } while (true);\n  }\n\n  acquireSprite(): Sprite | null {\n    const sprite = this.freeSprites.pop();\n    return sprite !== void 0 ? sprite : null;\n  }\n\n  /** @internal */\n  releaseSprite(sprite: Sprite): void {\n    // assert(sprite.sheet === this);\n    // assert(this.freeSprites.indexOf(sprite) < 0);\n    this.clearSprite(sprite.rowIndex, sprite.colIndex);\n    this.freeSprites.push(sprite);\n  }\n\n  /** @internal */\n  clearSprite(rowIndex: number, colIndex: number): void {\n    const renderer = this.getSpriteRenderer(rowIndex, colIndex);\n    renderer.context.clearRect(0, 0, this.spriteWidth, this.spriteHeight);\n  }\n\n  /** @internal */\n  getSpriteRenderer(rowIndex: number, colIndex: number): CanvasRenderer {\n    const renderer = this.renderer;\n    const context = renderer.context;\n    const pixelRatio = renderer.pixelRatio;\n    const dx = rowIndex * this.spriteWidth * pixelRatio;\n    const dy = colIndex * this.spriteHeight * pixelRatio;\n    context.setTransform(pixelRatio, 0, 0, pixelRatio, dx, dy);\n    renderer.setTransform(Transform.affine(pixelRatio, 0, 0, pixelRatio, dx, dy));\n    return renderer;\n  }\n\n  /** @internal */\n  drawSprite(context: CanvasContext, frame: R2Box, rowIndex: number, colIndex: number): void {\n    const spritePixelRatio = this.renderer.pixelRatio;\n    const spriteWidth = this.spriteWidth * spritePixelRatio;\n    const spriteHeight = this.spriteHeight * spritePixelRatio;\n    const spriteX = rowIndex * spriteWidth;\n    const spriteY = colIndex * spriteHeight;\n    context.drawImage(this.canvas, spriteX, spriteY, spriteWidth, spriteHeight,\n                      frame.x, frame.y, this.spriteWidth, this.spriteHeight);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Service} from \"@swim/component\";\nimport type {Sprite} from \"./Sprite\";\nimport {SpriteSheet} from \"./SpriteSheet\";\n\n/** @public */\nexport class SpriteService extends Service {\n  constructor(canvasWidth?: number, canvasHeight?: number, pixelRatio?: number,\n              minSizeClass?: number, maxSizeClass?: number) {\n    super();\n    if (pixelRatio === void 0) {\n      pixelRatio = window.devicePixelRatio || 1;\n    }\n    if (canvasWidth === void 0) {\n      canvasWidth = Math.floor(SpriteService.TextureWidth / pixelRatio);\n    }\n    if (canvasHeight === void 0) {\n      canvasHeight = Math.floor(SpriteService.TextureHeight / pixelRatio);\n    }\n    if (maxSizeClass === void 0) {\n      maxSizeClass = Math.floor(Math.log2(Math.min(canvasWidth, canvasHeight) / 4));\n    }\n    if (minSizeClass === void 0) {\n      minSizeClass = Math.min(4, maxSizeClass);\n    }\n    this.canvasWidth = canvasWidth;\n    this.canvasHeight = canvasHeight;\n    this.minSizeClass = minSizeClass;\n    this.maxSizeClass = maxSizeClass;\n    this.pixelRatio = pixelRatio;\n\n    const slabCount = maxSizeClass - minSizeClass + 1;\n    const slabs = new Array<SpriteSheet | null>(slabCount);\n    for (let i = 0; i < slabCount; i += 1) {\n      slabs[i] = null;\n    }\n    this.slabs = slabs;\n  }\n\n  readonly canvasWidth: number;\n\n  readonly canvasHeight: number;\n\n  readonly pixelRatio: number;\n\n  readonly minSizeClass: number;\n\n  readonly maxSizeClass: number;\n\n  readonly slabs: readonly (SpriteSheet | null)[];\n\n  /** @internal */\n  protected createSlab(sizeClass: number): SpriteSheet {\n    const spriteSize = 1 << sizeClass;\n    return new SpriteSheet(spriteSize, spriteSize, this.canvasWidth, this.canvasHeight, this.pixelRatio);\n  }\n\n  /** @internal */\n  getFreeSlab(sizeClass: number): SpriteSheet | null {\n    sizeClass = Math.max(this.minSizeClass, sizeClass);\n    if (sizeClass > this.maxSizeClass) {\n      return null;\n    }\n    const index = sizeClass - this.minSizeClass;\n    const slabs = this.slabs as Array<SpriteSheet | null>;\n    let slab: SpriteSheet | null = slabs[index]!;\n    if (slab === null) {\n      slab = this.createSlab(sizeClass);\n      slabs[index] = slab;\n    } else if (slab.freeCount === 0) {\n      let freeSlab = SpriteSheet.acquireNextFreeSheet(slab);\n      if (freeSlab === null) {\n        freeSlab = this.createSlab(sizeClass);\n      }\n      freeSlab.nextSheet = slab;\n      slab = freeSlab;\n      slabs[index] = slab;\n    }\n    return slab;\n  }\n\n  /** @internal */\n  protected createSheet(width: number, height: number): SpriteSheet {\n    return new SpriteSheet(width, height, width, height, this.pixelRatio);\n  }\n\n  /** @internal */\n  getFreeSheet(width: number, height: number): SpriteSheet {\n    const widthClass = Math.ceil(Math.log2(width));\n    const heightClass = Math.ceil(Math.log2(height));\n    const sizeClass = Math.max(widthClass, heightClass);\n    let sheet = this.getFreeSlab(sizeClass);\n    if (sheet === null) {\n      sheet = this.createSheet(width, height);\n    }\n    return sheet;\n  }\n\n  acquireSprite(width: number, height: number): Sprite {\n    const sheet = this.getFreeSheet(width, height);\n    const sprite = sheet.acquireSprite()!;\n    // assert(sprite !== null);\n    return sprite;\n  }\n\n  /** @internal */\n  static readonly TextureWidth: number = 512;\n  /** @internal */\n  static readonly TextureHeight: number = 512;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport {Property} from \"@swim/component\";\nimport {EventHandler} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport {R2Box} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport type {ViewFlags} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport type {HtmlViewObserver} from \"@swim/dom\";\nimport {HtmlView} from \"@swim/dom\";\nimport type {GraphicsEvent} from \"./GraphicsEvent\";\nimport type {GraphicsMouseEventInit} from \"./GraphicsEvent\";\nimport type {GraphicsMouseEvent} from \"./GraphicsEvent\";\nimport type {GraphicsPointerEventInit} from \"./GraphicsEvent\";\nimport type {GraphicsPointerEvent} from \"./GraphicsEvent\";\nimport type {GraphicsTouchInit} from \"./GraphicsEvent\";\nimport type {GraphicsTouch} from \"./GraphicsEvent\";\nimport type {GraphicsTouchEvent} from \"./GraphicsEvent\";\nimport type {GraphicsRendererLike} from \"./GraphicsRenderer\";\nimport type {GraphicsRendererType} from \"./GraphicsRenderer\";\nimport {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport {GraphicsView} from \"./GraphicsView\";\nimport {WebGLRenderer} from \"./WebGLRenderer\";\nimport {CanvasRenderer} from \"./CanvasRenderer\";\nimport {SpriteService} from \"./SpriteService\";\n\n/** @internal */\nexport type CanvasFlags = number;\n\n/** @public */\nexport interface CanvasViewObserver<V extends CanvasView = CanvasView> extends HtmlViewObserver<V> {\n}\n\n/** @public */\nexport class CanvasView extends HtmlView {\n  constructor(node: HTMLCanvasElement) {\n    super(node);\n    this.viewFrame = R2Box.undefined();\n    this.mouse = null;\n    this.pointers = null;\n    this.touches = null;\n\n    this.style.setIntrinsic({\n      position: \"absolute\",\n      left: 0,\n      top: 0,\n    });\n  }\n\n  declare readonly observerType?: Class<CanvasViewObserver>;\n\n  declare readonly node: HTMLCanvasElement;\n\n  protected override needsUpdate(updateFlags: ViewFlags, immediate: boolean): ViewFlags {\n    updateFlags = super.needsUpdate(updateFlags, immediate);\n    updateFlags |= View.NeedsRender | View.NeedsComposite;\n    this.setFlags(this.flags | (View.NeedsRender | View.NeedsComposite));\n    return updateFlags;\n  }\n\n  protected override needsProcess(processFlags: ViewFlags): ViewFlags {\n    if ((processFlags & View.ProcessMask) !== 0) {\n      this.requireUpdate(View.NeedsRender | View.NeedsComposite);\n    }\n    return processFlags;\n  }\n\n  protected override onResize(): void {\n    super.onResize();\n    this.resizeCanvas(this.node);\n    this.resetRenderer();\n    this.requireUpdate(View.NeedsLayout | View.NeedsRender | View.NeedsComposite);\n  }\n\n  protected override onScroll(): void {\n    super.onScroll();\n    this.setCulled(!this.intersectsViewport());\n  }\n\n  protected override didDisplay(displayFlags: ViewFlags): void {\n    this.detectHitTargets();\n    super.didDisplay(displayFlags);\n  }\n\n  protected override onRender(): void {\n    this.clearCanvas();\n  }\n\n  protected override needsDisplay(displayFlags: ViewFlags): ViewFlags {\n    displayFlags |= View.NeedsRender | View.NeedsComposite;\n    return displayFlags;\n  }\n\n  @Provider({\n    serviceType: SpriteService,\n    inherits: false,\n    createService(): SpriteService {\n      return new SpriteService();\n    },\n  })\n  get sprites(): Provider<this, SpriteService> {\n    return Provider.getter();\n  }\n\n  get pixelRatio(): number {\n    return window.devicePixelRatio || 1;\n  }\n\n  @Property({\n    valueType: GraphicsRenderer,\n    inherits: true,\n    initValue(): GraphicsRenderer | null {\n      return this.owner.createRenderer();\n    },\n    didSetValue(renderer: GraphicsRenderer | null): void {\n      this.owner.resetRenderer();\n    },\n    fromLike(renderer: GraphicsRendererLike | null): GraphicsRenderer | null {\n      if (typeof renderer === \"string\") {\n        renderer = this.owner.createRenderer(renderer as GraphicsRendererType);\n      }\n      return renderer;\n    },\n  })\n  readonly renderer!: Property<this, GraphicsRenderer | null>;\n\n  protected createRenderer(rendererType: GraphicsRendererType = \"canvas\"): GraphicsRenderer | null {\n    if (rendererType === \"canvas\") {\n      const context = this.node.getContext(\"2d\");\n      if (context === null) {\n        throw new Error(\"Failed to create canvas rendering context\");\n      }\n      const pixelRatio = this.pixelRatio;\n      const transform = Transform.affine(pixelRatio, 0, 0, pixelRatio, 0, 0);\n      return new CanvasRenderer(context, transform, pixelRatio);\n    } else if (rendererType === \"webgl\") {\n      const context = this.node.getContext(\"webgl\");\n      if (context === null) {\n        throw new Error(\"Failed to create webgl rendering context\");\n      }\n      return new WebGLRenderer(context, this.pixelRatio);\n    }\n    throw new Error(\"Failed to create \" + rendererType + \" renderer\");\n  }\n\n  /** @internal */\n  readonly viewFrame: R2Box;\n\n  setViewFrame(viewFrame: R2Box | null): void {\n    // nop\n  }\n\n  get viewBounds(): R2Box {\n    return this.viewFrame;\n  }\n\n  get hitBounds(): R2Box {\n    return this.viewFrame;\n  }\n\n  cascadeHitTest(x: number, y: number): GraphicsView | null {\n    if (this.hidden || this.culled || this.intangible || !this.hitBounds.contains(x, y)) {\n      return null;\n    }\n    let hit = this.hitTestChildren(x, y);\n    if (hit === null) {\n      hit = this.hitTest(x, y);\n    }\n    return hit;\n  }\n\n  protected hitTest(x: number, y: number): GraphicsView | null {\n    return null;\n  }\n\n  protected hitTestChildren(x: number, y: number): GraphicsView | null {\n    let child = this.firstChild;\n    while (child !== null) {\n      if (child instanceof GraphicsView) {\n        const hit = this.hitTestChild(child, x, y);\n        if (hit !== null) {\n          return hit;\n        }\n      }\n      child = child.nextSibling;\n    }\n    return null;\n  }\n\n  protected hitTestChild(childView: GraphicsView, x: number, y: number): GraphicsView | null {\n    return childView.cascadeHitTest(x, y);\n  }\n\n  /** @internal */\n  protected detectHitTargets(clientBounds?: R2Box): void {\n    if (this.mouseEvents.value) {\n      const mouse = this.mouse;\n      if (mouse !== null) {\n        if (clientBounds === void 0) {\n          clientBounds = this.clientBounds;\n        }\n        this.detectMouseTarget(mouse, this.clientBounds);\n      }\n    }\n    if (this.pointerEvents.value) {\n      const pointers = this.pointers;\n      for (const id in pointers) {\n        const pointer = pointers[id]!;\n        if (clientBounds === void 0) {\n          clientBounds = this.clientBounds;\n        }\n        this.detectPointerTarget(pointer, clientBounds);\n      }\n    }\n  }\n\n  setEventTarget(eventTarget: EventTarget | null): void {\n    if (eventTarget === null) {\n      eventTarget = this;\n    }\n\n    this.click.setTarget(eventTarget);\n    this.dblclick.setTarget(eventTarget);\n    this.contextmenu.setTarget(eventTarget);\n    this.wheel.setTarget(eventTarget);\n\n    this.mouseenter.setTarget(eventTarget);\n    this.mouseleave.setTarget(eventTarget);\n    this.mousedown.setTarget(eventTarget);\n\n    this.pointerenter.setTarget(eventTarget);\n    this.pointerleave.setTarget(eventTarget);\n    this.pointerdown.setTarget(eventTarget);\n\n    this.touchstart.setTarget(eventTarget);\n    this.touchmove.setTarget(eventTarget);\n    this.touchend.setTarget(eventTarget);\n    this.touchcancel.setTarget(eventTarget);\n  }\n\n  @Property({\n    valueType: Boolean,\n    value: true,\n    didSetValue(clickEvents: boolean): void {\n      this.owner.click.enabled = clickEvents;\n      this.owner.dblclick.enabled = clickEvents;\n      this.owner.contextmenu.enabled = clickEvents;\n    },\n  })\n  readonly clickEvents!: Property<this, boolean>;\n\n  @Property({\n    valueType: Boolean,\n    value: false,\n    didSetValue(wheelEvents: boolean): void {\n      this.owner.wheel.enabled = wheelEvents;\n    },\n  })\n  readonly wheelEvents!: Property<this, boolean>;\n\n  @Property({\n    valueType: Boolean,\n    value: false,\n    didSetValue(mouseEvents: boolean): void {\n      this.owner.mouseenter.enabled = mouseEvents;\n      this.owner.mouseleave.enabled = mouseEvents;\n      this.owner.mousedown.enabled = mouseEvents;\n    },\n  })\n  readonly mouseEvents!: Property<this, boolean>;\n\n  @Property({\n    valueType: Boolean,\n    value: false,\n    didSetValue(pointerEvents: boolean): void {\n      this.owner.pointerenter.enabled = pointerEvents;\n      this.owner.pointerleave.enabled = pointerEvents;\n      this.owner.pointerdown.enabled = pointerEvents;\n    },\n  })\n  readonly pointerEvents!: Property<this, boolean>;\n\n  @Property({\n    valueType: Boolean,\n    value: false,\n    didSetValue(touchEvents: boolean): void {\n      this.owner.touchstart.enabled = touchEvents;\n    },\n  })\n  readonly touchEvents!: Property<this, boolean>;\n\n  /** @internal */\n  handleEvent(event: GraphicsEvent): void {\n    // nop\n  }\n\n  /** @internal */\n  bubbleEvent(event: GraphicsEvent): View | null {\n    this.handleEvent(event);\n    return this;\n  }\n\n  /** @internal */\n  fireEvent(event: GraphicsEvent, clientX: number, clientY: number): GraphicsView | null {\n    const clientBounds = this.clientBounds;\n    if (!clientBounds.contains(clientX, clientY)) {\n      return null;\n    }\n    const x = clientX - clientBounds.x;\n    const y = clientY - clientBounds.y;\n    const hit = this.cascadeHitTest(x, y);\n    if (hit === null) {\n      return null;\n    }\n    event.targetView = hit;\n    hit.bubbleEvent(event);\n    return hit;\n  }\n\n  /** @internal */\n  readonly mouse: GraphicsMouseEventInit | null;\n\n  /** @internal */\n  protected updateMouse(mouse: GraphicsMouseEventInit, event: MouseEvent): void {\n    mouse.button = event.button;\n    mouse.buttons = event.buttons;\n    mouse.altKey = event.altKey;\n    mouse.ctrlKey = event.ctrlKey;\n    mouse.metaKey = event.metaKey;\n    mouse.shiftKey = event.shiftKey;\n\n    mouse.clientX = event.clientX;\n    mouse.clientY = event.clientY;\n    mouse.screenX = event.screenX;\n    mouse.screenY = event.screenY;\n    mouse.movementX = event.movementX;\n    mouse.movementY = event.movementY;\n\n    mouse.view = event.view;\n    mouse.detail = event.detail;\n    mouse.relatedTarget = event.relatedTarget;\n  }\n\n  /** @internal */\n  protected fireMouseEvent(event: MouseEvent): GraphicsView | null {\n    return this.fireEvent(event, event.clientX, event.clientY);\n  }\n\n  @EventHandler({\n    eventType: \"click\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.clickEvents.value;\n    },\n    handle(event: MouseEvent): void {\n      const mouse = this.owner.mouse;\n      if (mouse !== null) {\n        this.owner.updateMouse(mouse, event);\n      }\n      this.owner.fireMouseEvent(event);\n    },\n  })\n  readonly click!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"dblclick\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.clickEvents.value;\n    },\n    handle(event: MouseEvent): void {\n      const mouse = this.owner.mouse;\n      if (mouse !== null) {\n        this.owner.updateMouse(mouse, event);\n      }\n      this.owner.fireMouseEvent(event);\n    },\n  })\n  readonly dblclick!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"contextmenu\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.clickEvents.value;\n    },\n    handle(event: MouseEvent): void {\n      const mouse = this.owner.mouse;\n      if (mouse !== null) {\n        this.owner.updateMouse(mouse, event);\n      }\n      this.owner.fireMouseEvent(event);\n    },\n  })\n  readonly contextmenu!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"wheel\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.wheelEvents.value;\n    },\n    handle(event: WheelEvent): void {\n      const mouse = this.owner.mouse;\n      if (mouse !== null) {\n        this.owner.updateMouse(mouse, event);\n      }\n      this.owner.fireMouseEvent(event);\n    },\n  })\n  readonly wheel!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"mouseenter\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.mouseEvents.value;\n    },\n    handle(event: MouseEvent): void {\n      let mouse = this.owner.mouse;\n      if (mouse === null) {\n        mouse = {};\n        (this.owner as Mutable<CanvasView>).mouse = mouse;\n      }\n      this.owner.mousemove.enabled = true;\n      this.owner.updateMouse(mouse, event);\n    },\n  })\n  readonly mouseenter!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"mouseleave\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.mouseEvents.value;\n    },\n    handle(event: MouseEvent): void {\n      (this.owner as Mutable<CanvasView>).mouse = null;\n      this.owner.mousemove.enabled = false;\n    },\n  })\n  readonly mouseleave!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"mousedown\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.mouseEvents.value;\n    },\n    handle(event: MouseEvent): void {\n      let mouse = this.owner.mouse;\n      if (mouse === null) {\n        mouse = {};\n        (this.owner as Mutable<CanvasView>).mouse = mouse;\n      }\n      this.owner.mouseup.enabled = true;\n      this.owner.updateMouse(mouse, event);\n      this.owner.fireMouseEvent(event);\n    },\n  })\n  readonly mousedown!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"mousemove\",\n    enabled: false,\n    initTarget(): EventTarget | null {\n      return document.body;\n    },\n    handle(event: MouseEvent): void {\n      let mouse = this.owner.mouse;\n      if (mouse === null) {\n        mouse = {};\n        (this.owner as Mutable<CanvasView>).mouse = mouse;\n      }\n      this.owner.updateMouse(mouse, event);\n      let oldTargetView = mouse.targetView as GraphicsView | null | undefined;\n      if (oldTargetView === void 0) {\n        oldTargetView = null;\n      }\n      const newTargetView = this.owner.fireMouseEvent(event);\n      if (newTargetView !== oldTargetView) {\n        this.owner.onMouseTargetChange(mouse, newTargetView, oldTargetView);\n      }\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly mousemove!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"mouseup\",\n    enabled: false,\n    initTarget(): EventTarget | null {\n      return document.body;\n    },\n    handle(event: MouseEvent): void {\n      const mouse = this.owner.mouse;\n      if (mouse !== null) {\n        this.owner.updateMouse(mouse, event);\n      }\n      this.owner.fireMouseEvent(event);\n      this.owner.mouseup.enabled = false;\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly mouseup!: EventHandler<this>;\n\n  /** @internal */\n  protected onMouseTargetChange(mouse: GraphicsMouseEventInit, newTargetView: GraphicsView | null,\n                                oldTargetView: GraphicsView | null): void {\n    mouse.bubbles = true;\n    let commonAncestorView: GraphicsView | null = null;\n    if (oldTargetView !== null && newTargetView !== null) {\n      commonAncestorView = oldTargetView.commonAncestor(newTargetView) as GraphicsView | null;\n    }\n    if (oldTargetView !== null) {\n      const outEvent = new MouseEvent(\"mouseout\", mouse) as GraphicsMouseEvent;\n      outEvent.targetView = oldTargetView;\n      outEvent.relatedTargetView = newTargetView;\n      oldTargetView.bubbleEvent(outEvent);\n      let leaveView: GraphicsView | null = oldTargetView;\n      do {\n        const leaveEvent = new MouseEvent(\"mouseleave\", {\n          bubbles: false,\n          ...mouse,\n        }) as GraphicsMouseEvent;\n        leaveEvent.targetView = leaveView;\n        leaveEvent.relatedTargetView = newTargetView;\n        leaveView.handleEvent(leaveEvent);\n        leaveView = leaveView.parent as GraphicsView | null;\n      } while (leaveView instanceof GraphicsView && leaveView !== commonAncestorView);\n    }\n    mouse.targetView = newTargetView !== null ? newTargetView : void 0;\n    if (newTargetView !== null) {\n      const overEvent = new MouseEvent(\"mouseover\", mouse) as GraphicsMouseEvent;\n      overEvent.targetView = newTargetView;\n      overEvent.relatedTargetView = oldTargetView;\n      newTargetView.bubbleEvent(overEvent);\n      let enterView: GraphicsView | null = newTargetView;\n      do {\n        const enterEvent = new MouseEvent(\"mouseenter\", {\n          bubbles: false,\n          ...mouse,\n        }) as GraphicsMouseEvent;\n        enterEvent.targetView = enterView;\n        enterEvent.relatedTargetView = oldTargetView;\n        enterView.handleEvent(enterEvent);\n        enterView = enterView.parent as GraphicsView | null;\n      } while (enterView instanceof GraphicsView && enterView !== commonAncestorView);\n    }\n  }\n\n  /** @internal */\n  protected detectMouseTarget(mouse: GraphicsMouseEventInit, clientBounds: R2Box): void {\n    const clientX = mouse.clientX!;\n    const clientY = mouse.clientY!;\n    if (clientBounds.contains(clientX, clientY)) {\n      const x = clientX - clientBounds.x;\n      const y = clientY - clientBounds.y;\n      let oldTargetView = mouse.targetView as GraphicsView | null | undefined;\n      if (oldTargetView === void 0) {\n        oldTargetView = null;\n      }\n      const newTargetView = this.cascadeHitTest(x, y);\n      if (newTargetView !== oldTargetView) {\n        this.onMouseTargetChange(mouse, newTargetView, oldTargetView);\n      }\n    }\n  }\n\n  /** @internal */\n  readonly pointers: {[id: string]: GraphicsPointerEventInit | undefined} | null;\n\n  /** @internal */\n  protected updatePointer(pointer: GraphicsPointerEventInit, event: PointerEvent): void {\n    pointer.pointerId = event.pointerId;\n    pointer.pointerType = event.pointerType;\n    pointer.isPrimary = event.isPrimary;\n\n    pointer.button = event.button;\n    pointer.buttons = event.buttons;\n    pointer.altKey = event.altKey;\n    pointer.ctrlKey = event.ctrlKey;\n    pointer.metaKey = event.metaKey;\n    pointer.shiftKey = event.shiftKey;\n\n    pointer.clientX = event.clientX;\n    pointer.clientY = event.clientY;\n    pointer.screenX = event.screenX;\n    pointer.screenY = event.screenY;\n    pointer.movementX = event.movementX;\n    pointer.movementY = event.movementY;\n\n    pointer.width = event.width;\n    pointer.height = event.height;\n    pointer.tiltX = event.tiltX;\n    pointer.tiltY = event.tiltY;\n    pointer.twist = event.twist;\n    pointer.pressure = event.pressure;\n    pointer.tangentialPressure = event.tangentialPressure;\n\n    pointer.view = event.view;\n    pointer.detail = event.detail;\n    pointer.relatedTarget = event.relatedTarget;\n  }\n\n  /** @internal */\n  protected firePointerEvent(event: PointerEvent): GraphicsView | null {\n    return this.fireEvent(event, event.clientX, event.clientY);\n  }\n\n  @EventHandler({\n    eventType: \"pointerenter\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.pointerEvents.value;\n    },\n    handle(event: PointerEvent): void {\n      const id = \"\" + event.pointerId;\n      let pointers = this.owner.pointers;\n      if (pointers === null) {\n        pointers = {};\n        (this.owner as Mutable<CanvasView>).pointers = pointers;\n      }\n      let pointer = pointers[id];\n      if (pointer === void 0) {\n        pointer = {};\n        pointers[id] = pointer;\n      }\n      this.owner.pointermove.enabled = true;\n      this.owner.pointerup.enabled = true;\n      this.owner.pointercancel.enabled = true;\n      this.owner.updatePointer(pointer, event);\n    },\n  })\n  readonly pointerenter!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"pointerleave\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.pointerEvents.value;\n    },\n    handle(event: PointerEvent): void {\n      const id = \"\" + event.pointerId;\n      let pointers = this.owner.pointers;\n      if (pointers === null) {\n        pointers = {};\n        (this.owner as Mutable<CanvasView>).pointers = pointers;\n      }\n      const pointer = pointers[id];\n      if (pointer !== void 0) {\n        if (pointer.targetView !== void 0) {\n          this.owner.onPointerTargetChange(pointer, null, pointer.targetView as GraphicsView);\n        }\n        delete pointers[id];\n        if (Object.keys(pointers).length === 0) {\n          this.owner.pointermove.enabled = false;\n          this.owner.pointerup.enabled = false;\n          this.owner.pointercancel.enabled = false;\n        }\n      }\n    },\n  })\n  readonly pointerleave!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"pointerdown\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.pointerEvents.value;\n    },\n    handle(event: PointerEvent): void {\n      const id = \"\" + event.pointerId;\n      let pointers = this.owner.pointers;\n      if (pointers === null) {\n        pointers = {};\n        (this.owner as Mutable<CanvasView>).pointers = pointers;\n      }\n      let pointer = pointers[id];\n      if (pointer === void 0) {\n        pointer = {};\n        pointers[id] = pointer;\n      }\n      this.owner.pointermove.enabled = true;\n      this.owner.pointerup.enabled = true;\n      this.owner.pointercancel.enabled = true;\n      this.owner.updatePointer(pointer, event);\n      this.owner.firePointerEvent(event);\n    },\n  })\n  readonly pointerdown!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"pointermove\",\n    enabled: false,\n    initTarget(): EventTarget | null {\n      return document.body;\n    },\n    handle(event: PointerEvent): void {\n      const id = \"\" + event.pointerId;\n      let pointers = this.owner.pointers;\n      if (pointers === null) {\n        pointers = {};\n        (this.owner as Mutable<CanvasView>).pointers = pointers;\n      }\n      let pointer = pointers[id];\n      if (pointer === void 0) {\n        pointer = {};\n        pointers[id] = pointer;\n      }\n      this.owner.pointermove.enabled = true;\n      this.owner.pointerup.enabled = true;\n      this.owner.pointercancel.enabled = true;\n      this.owner.updatePointer(pointer, event);\n      let oldTargetView = pointer.targetView as GraphicsView | null | undefined;\n      if (oldTargetView === void 0) {\n        oldTargetView = null;\n      }\n      const newTargetView = this.owner.firePointerEvent(event);\n      if (newTargetView !== oldTargetView) {\n        this.owner.onPointerTargetChange(pointer, newTargetView, oldTargetView);\n      }\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly pointermove!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"pointerup\",\n    enabled: false,\n    initTarget(): EventTarget | null {\n      return document.body;\n    },\n    handle(event: PointerEvent): void {\n      const id = \"\" + event.pointerId;\n      let pointers = this.owner.pointers;\n      if (pointers === null) {\n        pointers = {};\n        (this.owner as Mutable<CanvasView>).pointers = pointers;\n      }\n      const pointer = pointers[id];\n      if (pointer !== void 0) {\n        this.owner.updatePointer(pointer, event);\n      }\n      this.owner.firePointerEvent(event);\n      if (pointer !== void 0 && event.pointerType !== \"mouse\") {\n        if (pointer.targetView !== void 0) {\n          this.owner.onPointerTargetChange(pointer, null, pointer.targetView as GraphicsView);\n        }\n        delete pointers[id];\n        if (Object.keys(pointers).length === 0) {\n          this.owner.pointermove.enabled = false;\n          this.owner.pointerup.enabled = false;\n          this.owner.pointercancel.enabled = false;\n        }\n      }\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly pointerup!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"pointercancel\",\n    enabled: false,\n    initTarget(): EventTarget | null {\n      return document.body;\n    },\n    handle(event: PointerEvent): void {\n      const id = \"\" + event.pointerId;\n      let pointers = this.owner.pointers;\n      if (pointers === null) {\n        pointers = {};\n        (this.owner as Mutable<CanvasView>).pointers = pointers;\n      }\n      const pointer = pointers[id];\n      if (pointer !== void 0) {\n        this.owner.updatePointer(pointer, event);\n      }\n      this.owner.firePointerEvent(event);\n      if (pointer !== void 0 && event.pointerType !== \"mouse\") {\n        if (pointer.targetView !== void 0) {\n          this.owner.onPointerTargetChange(pointer, null, pointer.targetView as GraphicsView);\n        }\n        delete pointers[id];\n        if (Object.keys(pointers).length === 0) {\n          this.owner.pointermove.enabled = false;\n          this.owner.pointerup.enabled = false;\n          this.owner.pointercancel.enabled = false;\n        }\n      }\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly pointercancel!: EventHandler<this>;\n\n  /** @internal */\n  protected onPointerTargetChange(pointer: GraphicsPointerEventInit, newTargetView: GraphicsView | null,\n                                  oldTargetView: GraphicsView | null): void {\n    pointer.bubbles = true;\n    let commonAncestorView: GraphicsView | null = null;\n    if (oldTargetView !== null && newTargetView !== null) {\n      commonAncestorView = oldTargetView.commonAncestor(newTargetView) as GraphicsView | null;\n    }\n    if (oldTargetView !== null) {\n      const outEvent = new PointerEvent(\"pointerout\", pointer) as GraphicsPointerEvent;\n      outEvent.targetView = oldTargetView;\n      outEvent.relatedTargetView = newTargetView;\n      oldTargetView.bubbleEvent(outEvent);\n      let leaveView: GraphicsView | null = oldTargetView;\n      do {\n        const leaveEvent = new PointerEvent(\"pointerleave\", {\n          bubbles: false,\n          ...pointer,\n        }) as GraphicsPointerEvent;\n        leaveEvent.targetView = leaveView;\n        leaveEvent.relatedTargetView = newTargetView;\n        leaveView.handleEvent(leaveEvent);\n        leaveView = leaveView.parent as GraphicsView | null;\n      } while (leaveView instanceof GraphicsView && leaveView !== commonAncestorView);\n    }\n    pointer.targetView = newTargetView !== null ? newTargetView : void 0;\n    if (newTargetView !== null) {\n      const overEvent = new PointerEvent(\"pointerover\", pointer) as GraphicsPointerEvent;\n      overEvent.targetView = newTargetView;\n      overEvent.relatedTargetView = oldTargetView;\n      newTargetView.bubbleEvent(overEvent);\n      let enterView: GraphicsView | null = newTargetView;\n      do {\n        const enterEvent = new PointerEvent(\"pointerenter\", {\n          bubbles: false,\n          ...pointer,\n        }) as GraphicsPointerEvent;\n        enterEvent.targetView = enterView;\n        enterEvent.relatedTargetView = oldTargetView;\n        enterView.handleEvent(enterEvent);\n        enterView = enterView.parent as GraphicsView | null;\n      } while (enterView instanceof GraphicsView && enterView !== commonAncestorView);\n    }\n  }\n\n  /** @internal */\n  protected detectPointerTarget(pointer: GraphicsPointerEventInit, clientBounds: R2Box): void {\n    const clientX = pointer.clientX!;\n    const clientY = pointer.clientY!;\n    if (clientBounds.contains(clientX, clientY)) {\n      const x = clientX - clientBounds.x;\n      const y = clientY - clientBounds.y;\n      let oldTargetView = pointer.targetView as GraphicsView | null | undefined;\n      if (oldTargetView === void 0) {\n        oldTargetView = null;\n      }\n      const newTargetView = this.cascadeHitTest(x, y);\n      if (newTargetView !== oldTargetView) {\n        this.onPointerTargetChange(pointer, newTargetView, oldTargetView);\n      }\n    }\n  }\n\n  /** @internal */\n  readonly touches: {[id: string]: GraphicsTouchInit | undefined} | null;\n\n  /** @internal */\n  protected updateTouch(touch: GraphicsTouchInit, event: Touch): void {\n    touch.clientX = event.clientX;\n    touch.clientY = event.clientY;\n    touch.screenX = event.screenX;\n    touch.screenY = event.screenY;\n    touch.pageX = event.pageX;\n    touch.pageY = event.pageY;\n\n    touch.radiusX = event.radiusX;\n    touch.radiusY = event.radiusY;\n    touch.rotationAngle = event.rotationAngle;\n    touch.force = event.force;\n  }\n\n  /** @internal */\n  protected fireTouchEvent(type: string, originalEvent: TouchEvent): void {\n    const changedTouches = originalEvent.changedTouches;\n    const dispatched: GraphicsView[] = [];\n    for (let i = 0; i < changedTouches.length; i += 1) {\n      const changedTouch = changedTouches[i]! as GraphicsTouch;\n      const targetView = changedTouch.targetView as GraphicsView | undefined;\n      if (targetView !== void 0 && dispatched.indexOf(targetView) < 0) {\n        const startEvent: GraphicsTouchEvent = new TouchEvent(type, {\n          changedTouches: changedTouches as unknown as Touch[],\n          targetTouches: originalEvent.targetTouches as unknown as Touch[],\n          touches: originalEvent.touches as unknown as Touch[],\n          bubbles: true,\n        });\n        startEvent.targetView = targetView;\n        const targetViewTouches: Touch[] = [changedTouch];\n        for (let j = i + 1; j < changedTouches.length; j += 1) {\n          const nextTouch = changedTouches[j]! as GraphicsTouch;\n          if (nextTouch.targetView === targetView) {\n            targetViewTouches.push(nextTouch);\n          }\n        }\n\n        const touchDocument = document as Document & {createTouchList?(...touches: Touch[]): TouchList};\n        if (touchDocument.createTouchList !== void 0) {\n          startEvent.targetViewTouches = touchDocument.createTouchList(...targetViewTouches);\n        } else {\n          (targetViewTouches as unknown as TouchList).item = function (index: number): Touch {\n            return targetViewTouches[index]!;\n          };\n          startEvent.targetViewTouches = targetViewTouches as unknown as TouchList;\n        }\n        targetView.bubbleEvent(startEvent);\n        dispatched.push(targetView);\n      }\n    }\n  }\n\n  @EventHandler({\n    eventType: \"touchstart\",\n    bindsOwner: true,\n    enabled: false,\n    init(): void {\n      this.enabled = this.owner.touchEvents.value;\n    },\n    handle(event: TouchEvent): void {\n      let clientBounds: R2Box | undefined;\n      let touches = this.owner.touches;\n      if (touches === null) {\n        touches = {};\n        (this.owner as Mutable<CanvasView>).touches = touches;\n      }\n      const changedTouches = event.changedTouches;\n      for (let i = 0; i < changedTouches.length; i += 1) {\n        const changedTouch = changedTouches[i] as GraphicsTouch;\n        const id = \"\" + changedTouch.identifier;\n        let touch = touches[id];\n        if (touch === void 0) {\n          touch = {\n            identifier: changedTouch.identifier,\n            target: changedTouch.target,\n          };\n          touches[id] = touch;\n        }\n        this.owner.touchmove.enabled = true;\n        this.owner.touchend.enabled = true;\n        this.owner.touchcancel.enabled = true;\n        this.owner.updateTouch(touch, changedTouch);\n        const clientX = touch.clientX!;\n        const clientY = touch.clientY!;\n        if (clientBounds === void 0) {\n          clientBounds = this.owner.clientBounds;\n        }\n        if (clientBounds.contains(clientX, clientY)) {\n          const x = clientX - clientBounds.x;\n          const y = clientY - clientBounds.y;\n          const hit = this.owner.cascadeHitTest(x, y);\n          if (hit !== null) {\n            touch.targetView = hit;\n            changedTouch.targetView = hit;\n          }\n        }\n      }\n      this.owner.fireTouchEvent(\"touchstart\", event);\n    },\n  })\n  readonly touchstart!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"touchmove\",\n    bindsOwner: true,\n    enabled: false,\n    handle(event: TouchEvent): void {\n      let touches = this.owner.touches;\n      if (touches === null) {\n        touches = {};\n        (this.owner as Mutable<CanvasView>).touches = touches;\n      }\n      const changedTouches = event.changedTouches;\n      for (let i = 0; i < changedTouches.length; i += 1) {\n        const changedTouch = changedTouches[i] as GraphicsTouch;\n        const id = \"\" + changedTouch.identifier;\n        let touch = touches[id];\n        if (touch === void 0) {\n          touch = {\n            identifier: changedTouch.identifier,\n            target: changedTouch.target,\n          };\n          touches[id] = touch;\n        }\n        this.owner.updateTouch(touch, changedTouch);\n        changedTouch.targetView = touch.targetView;\n      }\n      this.owner.fireTouchEvent(\"touchmove\", event);\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly touchmove!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"touchend\",\n    bindsOwner: true,\n    enabled: false,\n    handle(event: TouchEvent): void {\n      let touches = this.owner.touches;\n      if (touches === null) {\n        touches = {};\n        (this.owner as Mutable<CanvasView>).touches = touches;\n      }\n      const changedTouches = event.changedTouches;\n      for (let i = 0; i < changedTouches.length; i += 1) {\n        const changedTouch = changedTouches[i] as GraphicsTouch;\n        const id = \"\" + changedTouch.identifier;\n        let touch = touches[id];\n        if (touch === void 0) {\n          touch = {\n            identifier: changedTouch.identifier,\n            target: changedTouch.target,\n          };\n          touches[id] = touch;\n        }\n        this.owner.updateTouch(touch, changedTouch);\n        changedTouch.targetView = touch.targetView;\n      }\n      this.owner.fireTouchEvent(\"touchend\", event);\n      for (let i = 0; i < changedTouches.length; i += 1) {\n        const changedTouch = changedTouches[i] as GraphicsTouch;\n        const id = \"\" + changedTouch.identifier;\n        delete touches[id];\n        if (Object.keys(touches).length === 0) {\n          this.owner.touchmove.enabled = false;\n          this.owner.touchend.enabled = false;\n          this.owner.touchcancel.enabled = false;\n        }\n      }\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly touchend!: EventHandler<this>;\n\n  @EventHandler({\n    eventType: \"touchcancel\",\n    bindsOwner: true,\n    enabled: false,\n    handle(event: TouchEvent): void {\n      let touches = this.owner.touches;\n      if (touches === null) {\n        touches = {};\n        (this.owner as Mutable<CanvasView>).touches = touches;\n      }\n      const changedTouches = event.changedTouches;\n      for (let i = 0; i < changedTouches.length; i += 1) {\n        const changedTouch = changedTouches[i] as GraphicsTouch;\n        const id = \"\" + changedTouch.identifier;\n        let touch = touches[id];\n        if (touch === void 0) {\n          touch = {\n            identifier: changedTouch.identifier,\n            target: changedTouch.target,\n          };\n          touches[id] = touch;\n        }\n        this.owner.updateTouch(touch, changedTouch);\n        changedTouch.targetView = touch.targetView;\n      }\n      this.owner.fireTouchEvent(\"touchcancel\", event);\n      for (let i = 0; i < changedTouches.length; i += 1) {\n        const changedTouch = changedTouches[i] as GraphicsTouch;\n        const id = \"\" + changedTouch.identifier;\n        delete touches[id];\n        if (Object.keys(touches).length === 0) {\n          this.owner.touchmove.enabled = false;\n          this.owner.touchend.enabled = false;\n          this.owner.touchcancel.enabled = false;\n        }\n      }\n    },\n    didUnmount(): void {\n      this.enabled = false;\n      super.didUnmount();\n    },\n  })\n  readonly touchcancel!: EventHandler<this>;\n\n  protected resizeCanvas(canvas: HTMLCanvasElement): void {\n    let width: number;\n    let height: number;\n    let pixelRatio: number;\n    let parentNode = canvas.parentNode;\n    if (parentNode instanceof HTMLElement) {\n      do {\n        width = Math.floor(parentNode.offsetWidth);\n        height = Math.floor(parentNode.offsetHeight);\n        if (width !== 0 && height !== 0) {\n          break;\n        } else if ((width === 0 || height === 0) && HtmlView.isPositioned(parentNode)) {\n          this.requireUpdate(View.NeedsResize); // view might not yet have been laid out\n        }\n        parentNode = parentNode.parentNode;\n      } while (parentNode instanceof HTMLElement);\n      pixelRatio = this.pixelRatio;\n      canvas.width = width * pixelRatio;\n      canvas.height = height * pixelRatio;\n      canvas.style.width = width + \"px\";\n      canvas.style.height = height + \"px\";\n    } else {\n      width = Math.floor(canvas.width);\n      height = Math.floor(canvas.height);\n      pixelRatio = 1;\n    }\n    (this as Mutable<this>).viewFrame = new R2Box(0, 0, width, height);\n  }\n\n  clearCanvas(): void {\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer) {\n      const frame = this.viewFrame;\n      renderer.context.clearRect(0, 0, frame.width, frame.height);\n    } else if (renderer instanceof WebGLRenderer) {\n      const context = renderer.context;\n      context.clear(context.COLOR_BUFFER_BIT | context.DEPTH_BUFFER_BIT);\n    }\n  }\n\n  resetRenderer(): void {\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer) {\n      const pixelRatio = this.pixelRatio;\n      renderer.context.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n    } else if (renderer instanceof WebGLRenderer) {\n      const frame = this.viewFrame;\n      renderer.context.viewport(0, 0, frame.width, frame.height);\n    }\n  }\n\n  /** @internal */\n  static override readonly tag: string = \"canvas\";\n\n  static override readonly UncullFlags: ViewFlags = HtmlView.UncullFlags | View.NeedsRender | View.NeedsComposite;\n  static override readonly UnhideFlags: ViewFlags = HtmlView.UnhideFlags | View.NeedsRender | View.NeedsComposite;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Property} from \"@swim/component\";\nimport type {R2Box} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport {ThemeConstraintAnimator} from \"@swim/theme\";\nimport type {ViewFlags} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport type {GraphicsRendererLike} from \"./GraphicsRenderer\";\nimport type {GraphicsRendererType} from \"./GraphicsRenderer\";\nimport {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport {GraphicsView} from \"./GraphicsView\";\nimport {WebGLRenderer} from \"./WebGLRenderer\";\nimport type {CanvasCompositeOperation} from \"./CanvasContext\";\nimport {CanvasRenderer} from \"./CanvasRenderer\";\n\n/** @public */\nexport class RasterView extends GraphicsView {\n  constructor() {\n    super();\n    this.canvas = this.createCanvas();\n    this.ownRasterFrame = null;\n    (this.renderer as Mutable<typeof this.renderer>).value = this.createRenderer();\n  }\n\n  @ThemeConstraintAnimator({valueType: Number, value: 1, updateFlags: View.NeedsComposite})\n  readonly opacity!: ThemeConstraintAnimator<this, number>;\n\n  @Property({valueType: String, value: \"source-over\", updateFlags: View.NeedsComposite})\n  readonly compositeOperation!: Property<this, CanvasCompositeOperation>;\n\n  get pixelRatio(): number {\n    return window.devicePixelRatio || 1;\n  }\n\n  /** @internal */\n  readonly canvas: HTMLCanvasElement;\n\n  @Property({\n    valueType: GraphicsRenderer,\n    value: null,\n    inherits: \"renderer\",\n  })\n  readonly compositor!: Property<this, GraphicsRenderer | null>;\n\n  @Property({\n    extends: true,\n    inherits: false,\n    updateFlags: View.NeedsRender | View.NeedsComposite,\n    fromLike(renderer: GraphicsRendererLike | null): GraphicsRenderer | null {\n      if (typeof renderer === \"string\") {\n        renderer = this.owner.createRenderer(renderer as GraphicsRendererType);\n      }\n      return renderer;\n    },\n  })\n  override readonly renderer!: Property<this, GraphicsRenderer | null>;\n\n  protected createRenderer(rendererType: GraphicsRendererType = \"canvas\"): GraphicsRenderer | null {\n    if (rendererType === \"canvas\") {\n      const context = this.canvas.getContext(\"2d\");\n      if (context === null) {\n        throw new Error(\"Failed to create canvas rendering context\");\n      }\n      return new CanvasRenderer(context, Transform.identity(), this.pixelRatio);\n    } else if (rendererType === \"webgl\") {\n      const context = this.canvas.getContext(\"webgl\");\n      if (context === null) {\n        throw new Error(\"Failed to create webgl rendering context\");\n      }\n      return new WebGLRenderer(context, this.pixelRatio);\n    }\n    throw new Error(\"Failed to create \" + rendererType + \" renderer\");\n  }\n\n  protected override needsUpdate(updateFlags: ViewFlags, immediate: boolean): ViewFlags {\n    updateFlags = super.needsUpdate(updateFlags, immediate);\n    const rasterFlags = updateFlags & (View.NeedsRender | View.NeedsComposite);\n    if (rasterFlags !== 0) {\n      updateFlags |= View.NeedsComposite;\n      this.setFlags(this.flags | View.NeedsDisplay | View.NeedsComposite | rasterFlags);\n    }\n    return updateFlags;\n  }\n\n  protected override needsProcess(processFlags: ViewFlags): ViewFlags {\n    if ((this.flags & View.ProcessMask) === 0 && (processFlags & View.NeedsResize) === 0) {\n      processFlags = 0;\n    }\n    return processFlags;\n  }\n\n  protected override onResize(): void {\n    super.onResize();\n    this.requireUpdate(View.NeedsRender | View.NeedsComposite);\n  }\n\n  protected override needsDisplay(displayFlags: ViewFlags): ViewFlags {\n    if ((this.flags & View.DisplayMask) !== 0) {\n      displayFlags |= View.NeedsComposite;\n    } else if ((displayFlags & View.NeedsComposite) !== 0) {\n      displayFlags = View.NeedsDisplay | View.NeedsComposite;\n    } else {\n      displayFlags = 0;\n    }\n    return displayFlags;\n  }\n\n  protected override onRender(): void {\n    const rasterFrame = this.rasterFrame;\n    this.resizeCanvas(this.canvas, rasterFrame);\n    this.resetRenderer(rasterFrame);\n    this.clearCanvas(rasterFrame);\n    super.onRender();\n  }\n\n  protected override didComposite(): void {\n    this.compositeImage();\n    super.didComposite();\n  }\n\n  declare readonly viewBounds: R2Box; // getter defined below to work around useDefineForClassFields lunacy\n\n  /** @internal */\n  readonly ownRasterFrame: R2Box | null;\n\n  get rasterFrame(): R2Box {\n    let rasterFrame = this.ownRasterFrame;\n    if (rasterFrame === null) {\n      rasterFrame = this.deriveRasterFrame();\n    }\n    return rasterFrame;\n  }\n\n  /** @internal */\n  setRasterFrame(rasterFrame: R2Box | null): void {\n    (this as Mutable<this>).ownRasterFrame = rasterFrame;\n  }\n\n  protected deriveRasterFrame(): R2Box {\n    return this.viewBounds;\n  }\n\n  protected createCanvas(): HTMLCanvasElement {\n    return document.createElement(\"canvas\");\n  }\n\n  protected resizeCanvas(canvas: HTMLCanvasElement, rasterFrame: R2Box): void {\n    const pixelRatio = this.pixelRatio;\n    const newWidth = rasterFrame.width;\n    const newHeight = rasterFrame.height;\n    const newCanvasWidth = newWidth * pixelRatio;\n    const newCanvasHeight = newHeight * pixelRatio;\n    const oldCanvasWidth = canvas.width;\n    const oldCanvasHeight = canvas.height;\n    if (newCanvasWidth !== oldCanvasWidth || newCanvasHeight !== oldCanvasHeight) {\n      canvas.width = newCanvasWidth;\n      canvas.height = newCanvasHeight;\n      canvas.style.width = newWidth + \"px\";\n      canvas.style.height = newHeight + \"px\";\n    }\n  }\n\n  protected clearCanvas(rasterFrame: R2Box): void {\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer) {\n      renderer.context.clearRect(0, 0, rasterFrame.xMax, rasterFrame.yMax);\n    } else if (renderer instanceof WebGLRenderer) {\n      const context = renderer.context;\n      context.clear(context.COLOR_BUFFER_BIT | context.DEPTH_BUFFER_BIT);\n    }\n  }\n\n  protected resetRenderer(rasterFrame: R2Box): void {\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer) {\n      const pixelRatio = this.pixelRatio;\n      const dx = rasterFrame.xMin * pixelRatio;\n      const dy = rasterFrame.yMin * pixelRatio;\n      renderer.context.setTransform(pixelRatio, 0, 0, pixelRatio, -dx, -dy);\n      renderer.setTransform(Transform.affine(pixelRatio, 0, 0, pixelRatio, -dx, -dy));\n    } else if (renderer instanceof WebGLRenderer) {\n      renderer.context.viewport(rasterFrame.x, rasterFrame.y, rasterFrame.xMax, rasterFrame.yMax);\n    }\n  }\n\n  protected compositeImage(): void {\n    const compositor = this.compositor.value;\n    if (compositor instanceof CanvasRenderer) {\n      const context = compositor.context;\n      const rasterFrame = this.rasterFrame;\n      const canvas = this.canvas;\n      if (rasterFrame.isDefined() && rasterFrame.width !== 0 && rasterFrame.height !== 0 &&\n          canvas.width !== 0 && canvas.height !== 0) {\n        const globalAlpha = context.globalAlpha;\n        const globalCompositeOperation = context.globalCompositeOperation;\n        context.globalAlpha = this.opacity.getValue();\n        context.globalCompositeOperation = this.compositeOperation.getValue();\n        context.drawImage(canvas, rasterFrame.x, rasterFrame.y, rasterFrame.width, rasterFrame.height);\n        context.globalAlpha = globalAlpha;\n        context.globalCompositeOperation = globalCompositeOperation;\n      }\n    }\n  }\n\n  static override readonly MountFlags: ViewFlags = GraphicsView.MountFlags | View.NeedsComposite;\n  static override readonly UncullFlags: ViewFlags = GraphicsView.UncullFlags | View.NeedsComposite;\n  static override readonly UnhideFlags: ViewFlags = GraphicsView.UnhideFlags | View.NeedsComposite;\n}\nObject.defineProperty(RasterView.prototype, \"viewBounds\", {\n  get(this: RasterView): R2Box {\n    return this.deriveViewBounds();\n  },\n  configurable: true,\n});\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Color} from \"@swim/style\";\nimport type {ThemeAnimator} from \"@swim/theme\";\nimport {GraphicsView} from \"./GraphicsView\";\n\n/** @public */\nexport interface FillView extends GraphicsView {\n  readonly fill: ThemeAnimator<this, Color | null>;\n}\n\n/** @public */\nexport const FillView = {\n  [Symbol.hasInstance](instance: unknown): instance is FillView {\n    return instance instanceof GraphicsView\n        && \"fill\" in instance;\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Length} from \"@swim/math\";\nimport type {Color} from \"@swim/style\";\nimport type {ThemeAnimator} from \"@swim/theme\";\nimport {GraphicsView} from \"./GraphicsView\";\n\n/** @public */\nexport interface StrokeView extends GraphicsView {\n  readonly stroke: ThemeAnimator<this, Color | null>;\n\n  readonly strokeWidth: ThemeAnimator<this, Length | null>;\n}\n\n/** @public */\nexport const StrokeView = {\n  [Symbol.hasInstance](instance: unknown): instance is StrokeView {\n    return instance instanceof GraphicsView\n        && \"stroke\" in instance\n        && \"strokeWidth\" in instance;\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport type {R2Box} from \"@swim/math\";\nimport type {Graphics} from \"./Graphics\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {DrawingContext} from \"./DrawingContext\";\nimport {PathContext} from \"./PathContext\";\nimport {PathRenderer} from \"./PathRenderer\";\n\n/** @public */\nexport type RectLike = Rect | RectInit;\n\n/** @public */\nexport interface RectInit {\n  x: LengthLike;\n  y: LengthLike;\n  width: LengthLike;\n  height: LengthLike;\n}\n\n/** @public */\nexport class Rect implements Graphics, Equals, Debug {\n  constructor(x: Length, y: Length, width: Length, height: Length) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  readonly x: Length;\n\n  withX(x: LengthLike): Rect {\n    x = Length.fromLike(x);\n    if (this.x.equals(x)) {\n      return this;\n    }\n    return this.copy(x, this.y, this.width, this.height);\n  }\n\n  readonly y: Length;\n\n  withY(y: LengthLike): Rect {\n    y = Length.fromLike(y);\n    if (this.y.equals(y)) {\n      return this;\n    }\n    return this.copy(this.x, y, this.width, this.height);\n  }\n\n  readonly width: Length;\n\n  withWidth(width: LengthLike): Rect {\n    width = Length.fromLike(width);\n    if (this.width.equals(width)) {\n      return this;\n    }\n    return this.copy(this.x, this.y, width, this.height);\n  }\n\n  readonly height: Length;\n\n  withHeight(height: LengthLike): Rect {\n    height = Length.fromLike(height);\n    if (this.height.equals(height)) {\n      return this;\n    }\n    return this.copy(this.x, this.y, this.width, height);\n  }\n\n  render(): string;\n  render(renderer: GraphicsRenderer, frame?: R2Box): void;\n  render(renderer?: GraphicsRenderer, frame?: R2Box): string | void {\n    if (renderer === void 0) {\n      const context = new PathContext();\n      context.setPrecision(3);\n      this.draw(context, frame);\n      return context.toString();\n    } else if (renderer instanceof PathRenderer) {\n      this.draw(renderer.context, frame);\n    }\n  }\n\n  draw(context: DrawingContext, frame: R2Box | null = null): void {\n    this.renderRect(context, frame);\n  }\n\n  protected renderRect(context: DrawingContext, frame: R2Box | null): void {\n    context.rect(this.x.pxValue(), this.y.pxValue(),\n                 this.width.pxValue(), this.height.pxValue());\n  }\n\n  protected copy(x: Length, y: Length, width: Length, height: Length): Rect {\n    return new Rect(x, y, width, height);\n  }\n\n  toLike(): RectInit {\n    return {\n      x: this.x,\n      y: this.y,\n      width: this.width,\n      height: this.height,\n    };\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Rect) {\n      return this.x.equals(that.x) && this.y.equals(that.y)\n          && this.width.equals(that.width) && this.height.equals(that.height);\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Rect\").write(46/*'.'*/).write(\"create\").write(40/*'('*/)\n                   .debug(this.x).write(\", \").debug(this.y).write(\", \")\n                   .debug(this.width).write(\", \").debug(this.height).write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  static create(x: LengthLike, y: LengthLike, width: LengthLike, height: LengthLike): Rect {\n    x = Length.fromLike(x);\n    y = Length.fromLike(y);\n    width = Length.fromLike(width);\n    height = Length.fromLike(height);\n    return new Rect(x, y, width, height);\n  }\n\n  static fromLike<T extends RectLike | null | undefined>(value: T): Rect | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Rect) {\n      return value as Rect | Uninitable<T>;\n    } else if (typeof value === \"object\") {\n      return Rect.create(value.x, value.y, value.width, value.height);\n    }\n    throw new TypeError(\"\" + value);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {TimingLike} from \"@swim/util\";\nimport {Animator} from \"@swim/component\";\nimport {Length} from \"@swim/math\";\nimport {R2Box} from \"@swim/math\";\nimport {Color} from \"@swim/style\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport {View} from \"@swim/view\";\nimport {GraphicsView} from \"./GraphicsView\";\nimport type {PaintingContext} from \"./PaintingContext\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport type {CanvasContext} from \"./CanvasContext\";\nimport {CanvasRenderer} from \"./CanvasRenderer\";\nimport type {FillView} from \"./FillView\";\nimport type {StrokeView} from \"./StrokeView\";\nimport type {RectInit} from \"./Rect\";\nimport {Rect} from \"./Rect\";\n\n/** @public */\nexport class RectView extends GraphicsView implements FillView, StrokeView {\n  @Animator({valueType: Length, value: Length.zero(), updateFlags: View.NeedsRender})\n  readonly x!: Animator<this, Length>;\n\n  @Animator({valueType: Length, value: Length.zero(), updateFlags: View.NeedsRender})\n  readonly y!: Animator<this, Length>;\n\n  @Animator({valueType: Length, value: Length.zero(), updateFlags: View.NeedsRender})\n  readonly width!: Animator<this, Length>;\n\n  @Animator({valueType: Length, value: Length.zero(), updateFlags: View.NeedsRender})\n  readonly height!: Animator<this, Length>;\n\n  @ThemeAnimator({valueType: Color, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly fill!: ThemeAnimator<this, Color | null>;\n\n  @ThemeAnimator({valueType: Color, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly stroke!: ThemeAnimator<this, Color | null>;\n\n  @ThemeAnimator({valueType: Length, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly strokeWidth!: ThemeAnimator<this, Length | null>;\n\n  get value(): Rect {\n    return new Rect(this.x.getValue(), this.y.getValue(), this.width.getValue(), this.height.getValue());\n  }\n\n  get state(): Rect {\n    return new Rect(this.x.getState(), this.y.getState(), this.width.getState(), this.height.getState());\n  }\n\n  setState(rect: Rect | RectInit, timing?: TimingLike | boolean): void {\n    if (rect instanceof Rect) {\n      rect = rect.toLike();\n    }\n    if (rect.x !== void 0) {\n      this.x.setState(rect.x, timing);\n    }\n    if (rect.y !== void 0) {\n      this.y.setState(rect.y, timing);\n    }\n    if (rect.width !== void 0) {\n      this.width.setState(rect.width, timing);\n    }\n    if (rect.height !== void 0) {\n      this.height.setState(rect.height, timing);\n    }\n  }\n\n  protected override onRender(): void {\n    super.onRender();\n    const renderer = this.renderer.value;\n    if (renderer instanceof PaintingRenderer && !this.hidden && !this.culled) {\n      this.renderRect(renderer.context, this.viewFrame);\n    }\n  }\n\n  protected renderRect(context: PaintingContext, frame: R2Box): void {\n    const x = this.x.getValue().pxValue(frame.width);\n    const y = this.y.getValue().pxValue(frame.height);\n    const width = this.width.getValue().pxValue(frame.width);\n    const height = this.height.getValue().pxValue(frame.height);\n\n    // save\n    const contextFillStyle = context.fillStyle;\n    const contextLineWidth = context.lineWidth;\n    const contextStrokeStyle = context.strokeStyle;\n\n    context.beginPath();\n    context.rect(x, y, width, height);\n\n    const fill = this.fill.value;\n    if (fill !== null) {\n      context.fillStyle = fill.toString();\n      context.fill();\n    }\n\n    const stroke = this.stroke.value;\n    if (stroke !== null) {\n      const strokeWidth = this.strokeWidth.value;\n      if (strokeWidth !== null) {\n        const size = Math.min(frame.width, frame.height);\n        context.lineWidth = strokeWidth.pxValue(size);\n      }\n      context.strokeStyle = stroke.toString();\n      context.stroke();\n    }\n\n    // restore\n    context.fillStyle = contextFillStyle;\n    context.lineWidth = contextLineWidth;\n    context.strokeStyle = contextStrokeStyle;\n  }\n\n  declare readonly viewBounds: R2Box; // getter defined below to work around useDefineForClassFields lunacy\n\n  protected override hitTest(x: number, y: number): GraphicsView | null {\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer) {\n      const p = renderer.transform.transform(x, y);\n      return this.hitTestRect(p.x, p.y, renderer.context, this.viewFrame);\n    }\n    return null;\n  }\n\n  protected hitTestRect(hx: number, hy: number, context: CanvasContext, frame: R2Box): GraphicsView | null {\n    const x = this.x.getValue().pxValue(frame.width);\n    const y = this.y.getValue().pxValue(frame.height);\n    const width = this.width.getValue().pxValue(frame.width);\n    const height = this.height.getValue().pxValue(frame.height);\n    context.beginPath();\n    context.rect(x, y, width, height);\n\n    if (this.fill.value !== null && context.isPointInPath(hx, hy)) {\n      return this;\n    }\n    let strokeWidth: Length | null;\n    if (this.stroke.value === null || (strokeWidth = this.strokeWidth.value) === null) {\n      return null;\n    }\n\n    // save\n    const contextLineWidth = context.lineWidth;\n\n    const size = Math.min(frame.width, frame.height);\n    context.lineWidth = strokeWidth.pxValue(size);\n    const pointInStroke = context.isPointInStroke(hx, hy);\n\n    // restore\n    context.lineWidth = contextLineWidth;\n\n    return pointInStroke ? this : null;\n  }\n}\nObject.defineProperty(RectView.prototype, \"viewBounds\", {\n  get(this: RectView): R2Box {\n    const frame = this.viewFrame;\n    const x = this.x.getValue().pxValue(frame.width);\n    const y = this.y.getValue().pxValue(frame.height);\n    const width = this.width.getValue().pxValue(frame.width);\n    const height = this.height.getValue().pxValue(frame.height);\n    return new R2Box(x, y, x + width, y + height);\n  },\n  configurable: true,\n});\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\nimport type {AngleLike} from \"@swim/math\";\nimport {Angle} from \"@swim/math\";\nimport type {R2PointLike} from \"@swim/math\";\nimport {R2Point} from \"@swim/math\";\nimport type {R2Box} from \"@swim/math\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {Graphics} from \"./Graphics\";\nimport type {DrawingContext} from \"./DrawingContext\";\nimport {PathContext} from \"./PathContext\";\nimport {PathRenderer} from \"./PathRenderer\";\n\n/** @public */\nexport type ArcLike = Arc | ArcInit;\n\n/** @public */\nexport interface ArcInit {\n  center?: R2Point;\n  innerRadius?: LengthLike;\n  outerRadius?: LengthLike;\n  startAngle?: AngleLike;\n  sweepAngle?: AngleLike;\n  padAngle?: AngleLike;\n  padRadius?: LengthLike | null;\n  cornerRadius?: LengthLike;\n}\n\n/** @public */\nexport class Arc implements Graphics, Equals, Debug {\n  constructor(center: R2Point, innerRadius: Length, outerRadius: Length, startAngle: Angle,\n              sweepAngle: Angle, padAngle: Angle, padRadius: Length | null, cornerRadius: Length) {\n    this.center = center;\n    this.innerRadius = innerRadius;\n    this.outerRadius = outerRadius;\n    this.startAngle = startAngle;\n    this.sweepAngle = sweepAngle;\n    this.padAngle = padAngle;\n    this.padRadius = padRadius;\n    this.cornerRadius = cornerRadius;\n  }\n\n  readonly center: R2Point;\n\n  withCenter(center: R2PointLike): Arc {\n    center = R2Point.fromLike(center);\n    if (this.center.equals(center)) {\n      return this;\n    }\n    return this.copy(center, this.innerRadius, this.outerRadius, this.startAngle,\n                     this.sweepAngle, this.padAngle, this.padRadius, this.cornerRadius);\n  }\n\n  readonly innerRadius: Length;\n\n  withInnerRadius(innerRadius: LengthLike): Arc {\n    innerRadius = Length.fromLike(innerRadius);\n    if (this.innerRadius.equals(innerRadius)) {\n      return this;\n    }\n    return this.copy(this.center, innerRadius, this.outerRadius, this.startAngle,\n                     this.sweepAngle, this.padAngle, this.padRadius, this.cornerRadius);\n  }\n\n  readonly outerRadius: Length;\n\n  withOuterRadius(outerRadius: LengthLike): Arc {\n    outerRadius = Length.fromLike(outerRadius);\n    if (this.outerRadius.equals(outerRadius)) {\n      return this;\n    }\n    return this.copy(this.center, this.innerRadius, outerRadius, this.startAngle,\n                     this.sweepAngle, this.padAngle, this.padRadius, this.cornerRadius);\n  }\n\n  readonly startAngle: Angle;\n\n  withStartAngle(startAngle: AngleLike): Arc {\n    startAngle = Angle.fromLike(startAngle);\n    if (this.startAngle.equals(startAngle)) {\n      return this;\n    }\n    return this.copy(this.center, this.innerRadius, this.outerRadius, startAngle,\n                     this.sweepAngle, this.padAngle, this.padRadius, this.cornerRadius);\n  }\n\n  readonly sweepAngle: Angle;\n\n  withSweepAngle(sweepAngle: AngleLike): Arc {\n    sweepAngle = Angle.fromLike(sweepAngle);\n    if (this.sweepAngle.equals(sweepAngle)) {\n      return this;\n    }\n    return this.copy(this.center, this.innerRadius, this.outerRadius, this.startAngle,\n                     sweepAngle, this.padAngle, this.padRadius, this.cornerRadius);\n  }\n\n  readonly padAngle: Angle;\n\n  withPadAngle(padAngle: AngleLike): Arc {\n    padAngle = Angle.fromLike(padAngle);\n    if (this.padAngle.equals(padAngle)) {\n      return this;\n    }\n    return this.copy(this.center, this.innerRadius, this.outerRadius, this.startAngle,\n                     this.sweepAngle, padAngle, this.padRadius, this.cornerRadius);\n  }\n\n  readonly padRadius: Length | null;\n\n  withPadRadius(padRadius: LengthLike | null): Arc {\n    if (padRadius !== null) {\n      padRadius = Length.fromLike(padRadius);\n    }\n    if (Equals(this.padRadius, padRadius)) {\n      return this;\n    }\n    return this.copy(this.center, this.innerRadius, this.outerRadius, this.startAngle,\n                     this.sweepAngle, this.padAngle, padRadius, this.cornerRadius);\n  }\n\n  readonly cornerRadius: Length;\n\n  withCornerRadius(cornerRadius: LengthLike): Arc {\n    cornerRadius = Length.fromLike(cornerRadius);\n    if (this.cornerRadius.equals(cornerRadius)) {\n      return this;\n    }\n    return this.copy(this.center, this.innerRadius, this.outerRadius, this.startAngle,\n                     this.sweepAngle, this.padAngle, this.padRadius, cornerRadius);\n  }\n\n  render(): string;\n  render(renderer: GraphicsRenderer, frame?: R2Box): void;\n  render(renderer?: GraphicsRenderer, frame?: R2Box): string | void {\n    if (renderer === void 0) {\n      const context = new PathContext();\n      context.setPrecision(3);\n      this.draw(context, frame);\n      return context.toString();\n    } else if (renderer instanceof PathRenderer) {\n      this.draw(renderer.context, frame);\n    }\n  }\n\n  draw(context: DrawingContext, frame?: R2Box): void {\n    this.renderArc(context, frame);\n  }\n\n  protected renderArc(context: DrawingContext, frame: R2Box | undefined): void {\n    let size: number | undefined;\n    if (frame !== void 0) {\n      size = Math.min(frame.width, frame.height);\n    }\n\n    const center = this.center;\n    const cx = center.x;\n    const cy = center.y;\n    let r0 = this.innerRadius.pxValue(size);\n    let r1 = this.outerRadius.pxValue(size);\n    const a0 = this.startAngle.radValue();\n    const da = this.sweepAngle.radValue();\n    const a1 = a0 + da;\n    const cw = da >= 0;\n\n    if (r1 < r0) {\n      // swap inner and outer radii\n      const r = r1;\n      r1 = r0;\n      r0 = r;\n    }\n\n    if (!(r1 > Arc.Epsilon)) {\n      // degenerate point\n      context.moveTo(cx, cy);\n    } else if (da > 2 * Math.PI - Arc.Epsilon) {\n      // full circle or annulus\n      context.moveTo(cx + r1 * Math.cos(a0), cy + r1 * Math.sin(a0));\n      context.arc(cx, cy, r1, a0, a1, !cw);\n      if (r0 > Arc.Epsilon) {\n        context.moveTo(cx + r0 * Math.cos(a1), cy + r0 * Math.sin(a1));\n        context.arc(cx, cy, r0, a1, a0, cw);\n      }\n    } else {\n      // circular or annular sector\n      let a01 = a0;\n      let a11 = a1;\n      let a00 = a0;\n      let a10 = a1;\n      let da0 = da;\n      let da1 = da;\n      const ap = (this.padAngle.radValue()) / 2;\n      const rp = +(ap > Arc.Epsilon) && (this.padRadius !== null ? this.padRadius.pxValue(size) : Math.sqrt(r0 * r0 + r1 * r1));\n      const rc = Math.min(Math.abs(r1 - r0) / 2, this.cornerRadius.pxValue(size));\n      let rc0 = rc;\n      let rc1 = rc;\n\n      if (rp > Arc.Epsilon) {\n        // apply padding\n        let p0 = Math.asin(rp / r0 * Math.sin(ap));\n        let p1 = Math.asin(rp / r1 * Math.sin(ap));\n        if ((da0 -= p0 * 2) > Arc.Epsilon) {\n          p0 *= cw ? 1 : -1;\n          a00 += p0;\n          a10 -= p0;\n        } else {\n          da0 = 0;\n          a00 = a10 = (a0 + a1) / 2;\n        }\n        if ((da1 -= p1 * 2) > Arc.Epsilon) {\n          p1 *= cw ? 1 : -1;\n          a01 += p1;\n          a11 -= p1;\n        } else {\n          da1 = 0;\n          a01 = a11 = (a0 + a1) / 2;\n        }\n      }\n\n      let x00: number | undefined;\n      let y00: number | undefined;\n      const x01 = r1 * Math.cos(a01);\n      const y01 = r1 * Math.sin(a01);\n      const x10 = r0 * Math.cos(a10);\n      const y10 = r0 * Math.sin(a10);\n      let x11: number | undefined;\n      let y11: number | undefined;\n\n      if (rc > Arc.Epsilon) {\n        // rounded corners\n        x11 = r1 * Math.cos(a11);\n        y11 = r1 * Math.sin(a11);\n        x00 = r0 * Math.cos(a00);\n        y00 = r0 * Math.sin(a00);\n\n        if (da < Math.PI) {\n          // limit corner radius to sector angle\n          const oc = da0 > Arc.Epsilon ? Arc.intersect(x01, y01, x00, y00, x11, y11, x10, y10) : [x10, y10];\n          const ax = x01 - oc[0]!;\n          const ay = y01 - oc[1]!;\n          const bx = x11 - oc[0]!;\n          const by = y11 - oc[1]!;\n          const kc = 1 / Math.sin(0.5 * Math.acos((ax * bx + ay * by) /\n                                                  (Math.sqrt(ax * ax + ay * ay) *\n                                                   Math.sqrt(bx * bx + by * by))));\n          const lc = Math.sqrt(oc[0]! * oc[0]! + oc[1]! * oc[1]!);\n          rc0 = Math.min(rc, (r0 - lc) / (kc - 1));\n          rc1 = Math.min(rc, (r1 - lc) / (kc + 1));\n        }\n      }\n\n      if (!(da1 > Arc.Epsilon)) {\n        // collapsed sector\n        context.moveTo(cx + x01, cy + y01);\n      } else if (rc1 > Arc.Epsilon) {\n        // rounded outer corners\n        const t0 = Arc.cornerTangents(x00!, y00!, x01, y01, r1, rc1, cw);\n        const t1 = Arc.cornerTangents(x11!, y11!, x10, y10, r1, rc1, cw);\n\n        context.moveTo(cx + t0.cx + t0.x01, cy + t0.cy + t0.y01);\n\n        if (rc1 < rc) {\n          // draw merged outer corners\n          context.arc(cx + t0.cx, cy + t0.cy, rc1, Math.atan2(t0.y01, t0.x01), Math.atan2(t1.y01, t1.x01), !cw);\n        } else {\n          // draw outer corners and arc\n          context.arc(cx + t0.cx, cy + t0.cy, rc1, Math.atan2(t0.y01, t0.x01), Math.atan2(t0.y11, t0.x11), !cw);\n          context.arc(cx, cy, r1, Math.atan2(t0.cy + t0.y11, t0.cx + t0.x11),\n                      Math.atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);\n          context.arc(cx + t1.cx, cy + t1.cy, rc1, Math.atan2(t1.y11, t1.x11), Math.atan2(t1.y01, t1.x01), !cw);\n        }\n      } else {\n        // draw outer circular arc\n        context.moveTo(cx + x01, cy + y01);\n        context.arc(cx, cy, r1, a01, a11, !cw);\n      }\n\n      if (!(r0 > Arc.Epsilon) || !(da0 > Arc.Epsilon)) {\n        // collapsed sector\n        context.lineTo(cx + x10, cy + y10);\n      } else if (rc0 > Arc.Epsilon) {\n        // rounded inner corners\n        const t0 = Arc.cornerTangents(x10, y10, x11!, y11!, r0, -rc0, cw);\n        const t1 = Arc.cornerTangents(x01, y01, x00!, y00!, r0, -rc0, cw);\n\n        context.lineTo(cx + t0.cx + t0.x01, cy + t0.cy + t0.y01);\n\n        if (rc0 < rc) {\n          // draw merged inner corners\n          context.arc(cx + t0.cx, cy + t0.cy, rc0, Math.atan2(t0.y01, t0.x01), Math.atan2(t1.y01, t1.x01), !cw);\n        } else {\n          // draw inner corners and arc\n          context.arc(cx + t0.cx, cy + t0.cy, rc0, Math.atan2(t0.y01, t0.x01), Math.atan2(t0.y11, t0.x11), !cw);\n          context.arc(cx, cy, r0, Math.atan2(t0.cy + t0.y11, t0.cx + t0.x11),\n                      Math.atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);\n          context.arc(cx + t1.cx, cy + t1.cy, rc0, Math.atan2(t1.y11, t1.x11), Math.atan2(t1.y01, t1.x01), !cw);\n        }\n      } else {\n        // draw inner circular arc\n        context.arc(cx, cy, r0, a10, a00, cw);\n      }\n    }\n\n    context.closePath();\n  }\n\n  protected copy(center: R2Point, innerRadius: Length, outerRadius: Length, startAngle: Angle,\n                 sweepAngle: Angle, padAngle: Angle, padRadius: Length | null, cornerRadius: Length): Arc {\n    return new Arc(center, innerRadius, outerRadius, startAngle, sweepAngle, padAngle, padRadius, cornerRadius);\n  }\n\n  toLike(): ArcInit {\n    return {\n      center: this.center,\n      innerRadius: this.innerRadius,\n      outerRadius: this.outerRadius,\n      startAngle: this.startAngle,\n      sweepAngle: this.sweepAngle,\n      padAngle: this.padAngle,\n      padRadius: this.padRadius,\n      cornerRadius: this.cornerRadius,\n    };\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Arc) {\n      return this.center.equals(that.center)\n          && this.innerRadius.equals(that.innerRadius)\n          && this.outerRadius.equals(that.outerRadius)\n          && this.startAngle.equals(that.startAngle)\n          && this.sweepAngle.equals(that.sweepAngle)\n          && this.padAngle.equals(that.padAngle)\n          && Equals(this.padRadius, that.padRadius)\n          && this.cornerRadius.equals(that.cornerRadius);\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Arc\").write(46/*'.'*/).write(\"create\").write(40/*'('*/).write(41/*')'*/);\n    if (this.center.isDefined()) {\n      output = output.write(46/*'.'*/).write(\"center\").write(40/*'('*/).debug(this.center).write(41/*')'*/);\n    }\n    if (this.innerRadius.isDefined()) {\n      output = output.write(46/*'.'*/).write(\"innerRadius\").write(40/*'('*/).debug(this.innerRadius).write(41/*')'*/);\n    }\n    if (this.outerRadius.isDefined()) {\n      output = output.write(46/*'.'*/).write(\"outerRadius\").write(40/*'('*/).debug(this.outerRadius).write(41/*')'*/);\n    }\n    if (this.startAngle.isDefined()) {\n      output = output.write(46/*'.'*/).write(\"startAngle\").write(40/*'('*/).debug(this.startAngle).write(41/*')'*/);\n    }\n    if (this.sweepAngle.isDefined()) {\n      output = output.write(46/*'.'*/).write(\"sweepAngle\").write(40/*'('*/).debug(this.sweepAngle).write(41/*')'*/);\n    }\n    if (this.padAngle.isDefined()) {\n      output = output.write(46/*'.'*/).write(\"padAngle\").write(40/*'('*/).debug(this.padAngle).write(41/*')'*/);\n    }\n    if (this.padRadius !== null) {\n      output = output.write(46/*'.'*/).write(\"padRadius\").write(40/*'('*/).debug(this.padRadius).write(41/*')'*/);\n    }\n    if (this.cornerRadius.isDefined()) {\n      output = output.write(46/*'.'*/).write(\"cornerRadius\").write(40/*'('*/).debug(this.cornerRadius).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  static create(center: R2PointLike = R2Point.origin(),\n                innerRadius: LengthLike = Length.zero(),\n                outerRadius: LengthLike = Length.zero(),\n                startAngle: AngleLike = Angle.zero(),\n                sweepAngle: AngleLike = Angle.zero(),\n                padAngle: AngleLike = Angle.zero(),\n                padRadius: LengthLike | null = null,\n                cornerRadius: LengthLike = Length.zero()): Arc {\n    center = R2Point.fromLike(center);\n    innerRadius = Length.fromLike(innerRadius);\n    outerRadius = Length.fromLike(outerRadius);\n    startAngle = Angle.fromLike(startAngle);\n    sweepAngle = Angle.fromLike(sweepAngle);\n    padAngle = Angle.fromLike(padAngle);\n    padRadius = padRadius !== null ? Length.fromLike(padRadius) : null;\n    cornerRadius = Length.fromLike(cornerRadius);\n    return new Arc(center, innerRadius, outerRadius, startAngle,\n                   sweepAngle, padAngle, padRadius, cornerRadius);\n  }\n\n  static fromLike<T extends ArcLike | null | undefined>(value: T): Arc | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof Arc) {\n      return value as Arc | Uninitable<T>;\n    } else if (typeof value === \"object\") {\n      return Arc.create(value.center, value.innerRadius, value.outerRadius, value.startAngle,\n                        value.sweepAngle, value.padAngle, value.padRadius, value.cornerRadius);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  private static intersect(x0: number, y0: number, x1: number, y1: number, x2: number, y2: number,\n                           x3: number, y3: number): [number, number] {\n    const x10 = x1 - x0;\n    const y10 = y1 - y0;\n    const x32 = x3 - x2;\n    const y32 = y3 - y2;\n    const t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / (y32 * x10 - x32 * y10);\n    return [x0 + t * x10, y0 + t * y10];\n  }\n\n  private static cornerTangents(x0: number, y0: number, x1: number, y1: number, r1: number, rc: number, cw: boolean)\n                             : {cx: number, cy: number, x01: number, y01: number, x11: number, y11: number} {\n    // http://mathworld.wolfram.com/Circle-LineIntersection.html\n    const x01 = x0 - x1;\n    const y01 = y0 - y1;\n    const lo = (cw ? rc : -rc) / Math.sqrt(x01 * x01 + y01 * y01);\n    const ox = lo * y01;\n    const oy = -lo * x01;\n    const x11 = x0 + ox;\n    const y11 = y0 + oy;\n    const x10 = x1 + ox;\n    const y10 = y1 + oy;\n    const x00 = (x11 + x10) / 2;\n    const y00 = (y11 + y10) / 2;\n    const dx = x10 - x11;\n    const dy = y10 - y11;\n    const d2 = dx * dx + dy * dy;\n    const r = r1 - rc;\n    const D = x11 * y10 - x10 * y11;\n    const d = (dy < 0 ? -1 : 1) * Math.sqrt(Math.max(0, r * r * d2 - D * D));\n    let cx0 = (D * dy - dx * d) / d2;\n    let cy0 = (-D * dx - dy * d) / d2;\n    const cx1 = (D * dy + dx * d) / d2;\n    const cy1 = (-D * dx + dy * d) / d2;\n    const dx0 = cx0 - x00;\n    const dy0 = cy0 - y00;\n    const dx1 = cx1 - x00;\n    const dy1 = cy1 - y00;\n    if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) {\n      // pick closest intersection\n      cx0 = cx1;\n      cy0 = cy1;\n    }\n    return {\n      cx: cx0,\n      cy: cy0,\n      x01: -ox,\n      y01: -oy,\n      x11: cx0 * (r1 / r - 1),\n      y11: cy0 * (r1 / r - 1),\n    };\n  }\n\n  /** @internal */\n  static Epsilon: number = 1e-12;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {TimingLike} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport {Length} from \"@swim/math\";\nimport {Angle} from \"@swim/math\";\nimport {R2Point} from \"@swim/math\";\nimport {R2Box} from \"@swim/math\";\nimport {Color} from \"@swim/style\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport {View} from \"@swim/view\";\nimport {GraphicsView} from \"./GraphicsView\";\nimport type {PaintingContext} from \"./PaintingContext\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport type {CanvasContext} from \"./CanvasContext\";\nimport {CanvasRenderer} from \"./CanvasRenderer\";\nimport type {FillView} from \"./FillView\";\nimport type {StrokeView} from \"./StrokeView\";\nimport type {ArcInit} from \"./Arc\";\nimport {Arc} from \"./Arc\";\n\n/** @public */\nexport class ArcView extends GraphicsView implements FillView, StrokeView {\n  @Animator({valueType: Number, value: 0.5, updateFlags: View.NeedsRender})\n  readonly xAlign!: Animator<this, number>;\n\n  @Animator({valueType: Number, value: 0.5, updateFlags: View.NeedsRender})\n  readonly yAlign!: Animator<this, number>;\n\n  @Animator({valueType: R2Point, value: R2Point.origin(), updateFlags: View.NeedsRender})\n  readonly center!: Animator<this, R2Point>;\n\n  @ThemeAnimator({valueType: Length, value: Length.zero(), updateFlags: View.NeedsRender})\n  readonly innerRadius!: ThemeAnimator<this, Length>;\n\n  @ThemeAnimator({valueType: Length, value: Length.zero(), updateFlags: View.NeedsRender})\n  readonly outerRadius!: ThemeAnimator<this, Length>;\n\n  @ThemeAnimator({valueType: Angle, value: Angle.zero(), updateFlags: View.NeedsRender})\n  readonly startAngle!: ThemeAnimator<this, Angle>;\n\n  @ThemeAnimator({valueType: Angle, value: Angle.zero(), updateFlags: View.NeedsRender})\n  readonly sweepAngle!: ThemeAnimator<this, Angle>;\n\n  @ThemeAnimator({valueType: Angle, value: Angle.zero(), updateFlags: View.NeedsRender})\n  readonly padAngle!: ThemeAnimator<this, Angle>;\n\n  @ThemeAnimator({valueType: Length, value: null, updateFlags: View.NeedsRender})\n  readonly padRadius!: ThemeAnimator<this, Length | null>;\n\n  @ThemeAnimator({valueType: Length, value: Length.zero(), updateFlags: View.NeedsRender})\n  readonly cornerRadius!: ThemeAnimator<this, Length>;\n\n  @ThemeAnimator({valueType: Color, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly fill!: ThemeAnimator<this, Color | null>;\n\n  @ThemeAnimator({valueType: Color, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly stroke!: ThemeAnimator<this, Color | null>;\n\n  @ThemeAnimator({valueType: Length, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly strokeWidth!: ThemeAnimator<this, Length | null>;\n\n  get value(): Arc {\n    return new Arc(this.center.value, this.innerRadius.value, this.outerRadius.value,\n                   this.startAngle.value, this.sweepAngle.value, this.padAngle.value,\n                   this.padRadius.value, this.cornerRadius.value);\n  }\n\n  get state(): Arc {\n    return new Arc(this.center.state, this.innerRadius.state, this.outerRadius.state,\n                   this.startAngle.state, this.sweepAngle.state, this.padAngle.state,\n                   this.padRadius.state, this.cornerRadius.state);\n  }\n\n  setState(arc: Arc | ArcInit, timing?: TimingLike | boolean): void {\n    if (arc instanceof Arc) {\n      arc = arc.toLike();\n    }\n    if (arc.center !== void 0) {\n      this.center.setState(arc.center, timing);\n    }\n    if (arc.innerRadius !== void 0) {\n      this.innerRadius.setState(arc.innerRadius, timing);\n    }\n    if (arc.outerRadius !== void 0) {\n      this.outerRadius.setState(arc.outerRadius, timing);\n    }\n    if (arc.startAngle !== void 0) {\n      this.startAngle.setState(arc.startAngle, timing);\n    }\n    if (arc.sweepAngle !== void 0) {\n      this.sweepAngle.setState(arc.sweepAngle, timing);\n    }\n    if (arc.padAngle !== void 0) {\n      this.padAngle.setState(arc.padAngle, timing);\n    }\n    if (arc.padRadius !== void 0) {\n      this.padRadius.setState(arc.padRadius, timing);\n    }\n    if (arc.cornerRadius !== void 0) {\n      this.cornerRadius.setState(arc.cornerRadius, timing);\n    }\n  }\n\n  protected layoutArc(): void {\n    if (this.center.hasAffinity(Affinity.Intrinsic)) {\n      const viewFrame = this.viewFrame;\n      const cx = viewFrame.xMin + viewFrame.width * this.xAlign.getValue();\n      const cy = viewFrame.yMin + viewFrame.height * this.yAlign.getValue();\n      this.center.setIntrinsic(new R2Point(cx, cy));\n    }\n  }\n\n  protected override onRender(): void {\n    super.onRender();\n    const renderer = this.renderer.value;\n    if (renderer instanceof PaintingRenderer && !this.hidden && !this.culled) {\n      this.layoutArc();\n      this.renderArc(renderer.context, this.viewFrame);\n    }\n  }\n\n  protected renderArc(context: PaintingContext, frame: R2Box): void {\n    // save\n    const contextFillStyle = context.fillStyle;\n    const contextLineWidth = context.lineWidth;\n    const contextStrokeStyle = context.strokeStyle;\n\n    const arc = this.value;\n    context.beginPath();\n    arc.draw(context, frame);\n\n    const fill = this.fill.value;\n    if (fill !== null) {\n      context.fillStyle = fill.toString();\n      context.fill();\n    }\n\n    const stroke = this.stroke.value;\n    if (stroke !== null) {\n      const strokeWidth = this.strokeWidth.value;\n      if (strokeWidth !== null) {\n        const size = Math.min(frame.width, frame.height);\n        context.lineWidth = strokeWidth.pxValue(size);\n      }\n      context.strokeStyle = stroke.toString();\n      context.stroke();\n    }\n\n    // restore\n    context.fillStyle = contextFillStyle;\n    context.lineWidth = contextLineWidth;\n    context.strokeStyle = contextStrokeStyle;\n  }\n\n  override get popoverFrame(): R2Box {\n    const frame = this.viewFrame;\n    const size = Math.min(frame.width, frame.height);\n    const inversePageTransform = this.pageTransform.inverse();\n    const center = this.center.getValue();\n    const px = inversePageTransform.transformX(center.x, center.y);\n    const py = inversePageTransform.transformY(center.x, center.y);\n    const r = (this.innerRadius.getValue().pxValue(size) + this.outerRadius.getValue().pxValue(size)) / 2;\n    const a = this.startAngle.getValue().radValue() + this.sweepAngle.getValue().radValue() / 2;\n    const x = px + r * Math.cos(a);\n    const y = py + r * Math.sin(a);\n    return new R2Box(x, y, x, y);\n  }\n\n  declare readonly viewBounds: R2Box; // getter defined below to work around useDefineForClassFields lunacy\n\n  protected override hitTest(x: number, y: number): GraphicsView | null {\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer) {\n      const p = renderer.transform.transform(x, y);\n      this.layoutArc();\n      return this.hitTestArc(p.x, p.y, renderer.context, this.viewFrame);\n    }\n    return null;\n  }\n\n  protected hitTestArc(x: number, y: number, context: CanvasContext, frame: R2Box): GraphicsView | null {\n    const arc = this.value;\n    context.beginPath();\n    arc.draw(context, frame);\n\n    let strokeWidth: Length | null;\n    if (this.fill.value !== null && context.isPointInPath(x, y)) {\n      return this;\n    } else if (this.stroke.value === null || (strokeWidth = this.strokeWidth.value) === null) {\n      return null;\n    }\n\n    // save\n    const contextLineWidth = context.lineWidth;\n\n    const size = Math.min(frame.width, frame.height);\n    context.lineWidth = strokeWidth.pxValue(size);\n    const pointInStroke = context.isPointInStroke(x, y);\n\n    // restore\n    context.lineWidth = contextLineWidth;\n\n    return pointInStroke ? this : null;\n  }\n}\nObject.defineProperty(ArcView.prototype, \"viewBounds\", {\n  get(this: ArcView): R2Box {\n    const frame = this.viewFrame;\n    const size = Math.min(frame.width, frame.height);\n    const center = this.center.getValue();\n    const radius = this.outerRadius.getValue().pxValue(size);\n    return new R2Box(center.x - radius, center.y - radius,\n                     center.x + radius, center.y + radius);\n  },\n  configurable: true,\n});\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Point} from \"@swim/math\";\nimport type {Font} from \"@swim/style\";\nimport type {Color} from \"@swim/style\";\nimport type {ThemeAnimator} from \"@swim/theme\";\nimport {GraphicsView} from \"./GraphicsView\";\n\n/** @public */\nexport interface TypesetView extends GraphicsView {\n  readonly font: ThemeAnimator<this, Font | null>;\n\n  readonly textAlign: ThemeAnimator<this, CanvasTextAlign | undefined>;\n\n  readonly textBaseline: ThemeAnimator<this, CanvasTextBaseline | undefined>;\n\n  readonly textOrigin: ThemeAnimator<this, R2Point | null>;\n\n  readonly textColor: ThemeAnimator<this, Color | null>;\n}\n\n/** @public */\nexport const TypesetView = {\n  [Symbol.hasInstance](instance: unknown): instance is TypesetView {\n    return instance instanceof GraphicsView\n          && \"font\" in instance\n          && \"textAlign\" in instance\n          && \"textBaseline\" in instance\n          && \"textOrigin\" in instance\n          && \"textColor\" in instance;\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {R2PointLike} from \"@swim/math\";\nimport {R2Point} from \"@swim/math\";\nimport type {R2Box} from \"@swim/math\";\nimport type {FontLike} from \"@swim/style\";\nimport {Font} from \"@swim/style\";\nimport type {ColorLike} from \"@swim/style\";\nimport {Color} from \"@swim/style\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {Graphics} from \"./Graphics\";\nimport type {CanvasContext} from \"./CanvasContext\";\nimport {CanvasRenderer} from \"./CanvasRenderer\";\n\n/** @public */\nexport type TextRunLike = TextRun | TextRunInit | string;\n\n/** @public */\nexport interface TextRunInit {\n  text: string;\n  font?: FontLike;\n  textAlign?: CanvasTextAlign;\n  textBaseline?: CanvasTextBaseline;\n  textOrigin?: R2PointLike;\n  textColor?: ColorLike;\n}\n\n/** @public */\nexport class TextRun implements Graphics, Equals, Debug {\n  constructor(text: string, font: Font | null, textAlign: CanvasTextAlign | null,\n              textBaseline: CanvasTextBaseline | null, textOrigin: R2Point | null,\n              textColor: Color | null) {\n    this.text = text;\n    this.font = font;\n    this.textAlign = textAlign;\n    this.textBaseline = textBaseline;\n    this.textOrigin = textOrigin;\n    this.textColor = textColor;\n  }\n\n  readonly text: string;\n\n  withText(text: string): TextRun {\n    if (this.text === text) {\n      return this;\n    }\n    return this.copy(text, this.font, this.textAlign,\n                     this.textBaseline, this.textOrigin, this.textColor);\n  }\n\n  readonly font: Font | null;\n\n  withFont(font: FontLike | null): TextRun {\n    font = Font.fromLike(font);\n    if (this.font === font) {\n      return this;\n    }\n    return this.copy(this.text, font, this.textAlign,\n                     this.textBaseline, this.textOrigin, this.textColor);\n  }\n\n  readonly textAlign: CanvasTextAlign | null;\n\n  withTextAlign(textAlign: CanvasTextAlign | null): TextRun {\n    if (this.textAlign === textAlign) {\n      return this;\n    }\n    return this.copy(this.text, this.font, textAlign,\n                     this.textBaseline, this.textOrigin, this.textColor);\n  }\n\n  readonly textBaseline: CanvasTextBaseline | null;\n\n  withTextBaseline(textBaseline: CanvasTextBaseline | null): TextRun {\n    if (this.textBaseline === textBaseline) {\n      return this;\n    }\n    return this.copy(this.text, this.font, this.textAlign,\n                     textBaseline, this.textOrigin, this.textColor);\n  }\n\n  readonly textOrigin: R2Point | null;\n\n  withTextOrigin(textOrigin: R2PointLike | null): TextRun | null {\n    textOrigin = R2Point.fromLike(textOrigin);\n    if (Equals(this.textOrigin, textOrigin)) {\n      return this;\n    }\n    return this.copy(this.text, this.font, this.textAlign,\n                     this.textBaseline, textOrigin, this.textColor);\n  }\n\n  readonly textColor: Color | null;\n\n  withTextColor(textColor: ColorLike | null): TextRun {\n    textColor = Color.fromLike(textColor);\n    if (Equals(this.textColor, textColor)) {\n      return this;\n    }\n    return this.copy(this.text, this.font, this.textAlign,\n                     this.textBaseline, this.textOrigin, textColor);\n  }\n\n  render(renderer: GraphicsRenderer, frame: R2Box): void {\n    if (renderer instanceof CanvasRenderer) {\n      this.draw(renderer.context, frame);\n    }\n  }\n\n  draw(context: CanvasContext, frame: R2Box): void {\n    this.renderText(context, frame);\n  }\n\n  protected renderText(context: CanvasContext, frame: R2Box): void {\n    // save\n    const contextFont = context.font;\n    const contextTextAlign = context.textAlign;\n    const contextTextBaseline = context.textBaseline;\n    const contextFillStyle = context.fillStyle;\n\n    if (this.font !== null) {\n      context.font = this.font.toString();\n    }\n    if (this.textAlign !== null) {\n      context.textAlign = this.textAlign;\n    }\n    if (this.textBaseline !== null) {\n      context.textBaseline = this.textBaseline;\n    }\n    if (this.textColor !== null) {\n      context.fillStyle = this.textColor.toString();\n    }\n    let textOrigin = this.textOrigin;\n    if (textOrigin === null) {\n      textOrigin = R2Point.origin();\n    }\n    context.fillText(this.text, textOrigin.x, textOrigin.y);\n\n    // restore\n    context.font = contextFont;\n    context.textAlign = contextTextAlign;\n    context.textBaseline = contextTextBaseline;\n    context.fillStyle = contextFillStyle;\n  }\n\n  protected copy(text: string, font: Font | null, textAlign: CanvasTextAlign | null,\n                 textBaseline: CanvasTextBaseline | null, textOrigin: R2Point | null,\n                 textColor: Color | null): TextRun {\n    return new TextRun(text, font, textAlign, textBaseline, textOrigin, textColor);\n  }\n\n  toLike(): TextRunInit {\n    const init: TextRunInit = {text: this.text};\n    init.text = this.text;\n    if (this.font !== null) {\n      init.font = this.font;\n    }\n    if (this.font !== null) {\n      init.font = this.font;\n    }\n    if (this.textAlign !== null) {\n      init.textAlign = this.textAlign;\n    }\n    if (this.textBaseline !== null) {\n      init.textBaseline = this.textBaseline;\n    }\n    if (this.textOrigin !== null) {\n      init.textOrigin = this.textOrigin;\n    }\n    if (this.textColor !== null) {\n      init.textColor = this.textColor;\n    }\n    return init;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TextRun) {\n      return this.text === that.text\n          && Equals(this.font, that.font)\n          && this.textAlign === that.textAlign\n          && this.textBaseline === that.textBaseline\n          && Equals(this.textOrigin, that.textOrigin)\n          && Equals(this.textColor, that.textColor);\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"TextRun\").write(46/*'.'*/).write(\"create\").write(40/*'('*/)\n                   .debug(this.text).write(41/*')'*/);\n    if (this.font !== null) {\n      output = output.write(46/*'.'*/).write(\"font\").write(40/*'('*/).debug(this.font).write(41/*')'*/);\n    }\n    if (this.textAlign !== null) {\n      output = output.write(46/*'.'*/).write(\"textAlign\").write(40/*'('*/).debug(this.textAlign).write(41/*')'*/);\n    }\n    if (this.textBaseline !== null) {\n      output = output.write(46/*'.'*/).write(\"textBaseline\").write(40/*'('*/).debug(this.textBaseline).write(41/*')'*/);\n    }\n    if (this.textOrigin !== null) {\n      output = output.write(46/*'.'*/).write(\"textOrigin\").write(40/*'('*/).debug(this.textOrigin).write(41/*')'*/);\n    }\n    if (this.textColor !== null) {\n      output = output.write(46/*'.'*/).write(\"textColor\").write(40/*'('*/).debug(this.textColor).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  static create(text: string,\n                font: FontLike | null = null,\n                textAlign: CanvasTextAlign | null = null,\n                textBaseline: CanvasTextBaseline | null = null,\n                textOrigin: R2PointLike | null = null,\n                textColor: ColorLike | null = null): TextRun {\n    font = Font.fromLike(font);\n    textOrigin = R2Point.fromLike(textOrigin);\n    textColor = Color.fromLike(textColor);\n    return new TextRun(text, font, textAlign, textBaseline, textOrigin, textColor);\n  }\n\n  static fromLike<T extends TextRunLike | null | undefined>(value: T): TextRun | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof TextRun) {\n      return value as TextRun | Uninitable<T>;\n    } else if (typeof value === \"string\") {\n      return TextRun.create(value);\n    } else if (typeof value === \"object\") {\n      return TextRun.create(value.text, value.font, value.textAlign, value.textBaseline,\n                            value.textOrigin, value.textColor);\n    }\n    throw new TypeError(\"\" + value);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {TimingLike} from \"@swim/util\";\nimport {Animator} from \"@swim/component\";\nimport {R2Point} from \"@swim/math\";\nimport {Font} from \"@swim/style\";\nimport {Color} from \"@swim/style\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport {View} from \"@swim/view\";\nimport {GraphicsView} from \"./GraphicsView\";\nimport type {CanvasContext} from \"./CanvasContext\";\nimport {CanvasRenderer} from \"./CanvasRenderer\";\nimport type {TypesetView} from \"./TypesetView\";\nimport type {TextRunInit} from \"./TextRun\";\nimport {TextRun} from \"./TextRun\";\n\n/** @public */\nexport class TextRunView extends GraphicsView implements TypesetView {\n  @Animator({valueType: String, value: \"\", updateFlags: View.NeedsRender})\n  readonly text!: Animator<this, string>;\n\n  @ThemeAnimator({valueType: Font, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly font!: ThemeAnimator<this, Font | null>;\n\n  @ThemeAnimator({valueType: String, inherits: true, updateFlags: View.NeedsRender})\n  readonly textAlign!: ThemeAnimator<this, CanvasTextAlign | undefined>;\n\n  @ThemeAnimator({valueType: String, inherits: true, updateFlags: View.NeedsRender})\n  readonly textBaseline!: ThemeAnimator<this, CanvasTextBaseline | undefined>;\n\n  @ThemeAnimator({valueType: R2Point, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly textOrigin!: ThemeAnimator<this, R2Point | null>;\n\n  @ThemeAnimator({valueType: Color, value: null, inherits: true, updateFlags: View.NeedsRender})\n  readonly textColor!: ThemeAnimator<this, Color | null>;\n\n  get value(): TextRun {\n    return new TextRun(this.text.getValue(), this.font.getValue(), this.textAlign.getValue(),\n                       this.textBaseline.getValue(), this.textOrigin.getValue(), this.textColor.getValue());\n  }\n\n  get state(): TextRun {\n    return new TextRun(this.text.getState(), this.font.getState(), this.textAlign.getState(),\n                       this.textBaseline.getState(), this.textOrigin.getState(), this.textColor.getState());\n  }\n\n  setState(run: TextRun | TextRunInit | string, timing?: TimingLike | boolean): void {\n    if (typeof run === \"string\") {\n      this.text.setState(run, timing);\n    } else {\n      if (run instanceof TextRun) {\n        run = run.toLike();\n      }\n      if (run.text !== void 0) {\n        this.text.setState(run.text, timing);\n      }\n      if (run.font !== void 0) {\n        this.font.setState(run.font, timing);\n      }\n      if (run.textAlign !== void 0) {\n        this.textAlign.setState(run.textAlign, timing);\n      }\n      if (run.textBaseline !== void 0) {\n        this.textBaseline.setState(run.textBaseline, timing);\n      }\n      if (run.textOrigin !== void 0) {\n        this.textOrigin.setState(run.textOrigin, timing);\n      }\n      if (run.textColor !== void 0) {\n        this.textColor.setState(run.textColor, timing);\n      }\n    }\n  }\n\n  protected override onRender(): void {\n    super.onRender();\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer && !this.hidden && !this.culled) {\n      this.renderText(renderer.context);\n    }\n  }\n\n  protected renderText(context: CanvasContext): void {\n    // save\n    const contextFont = context.font;\n    const contextTextAlign = context.textAlign;\n    const contextTextBaseline = context.textBaseline;\n    const contextFillStyle = context.fillStyle;\n\n    const font = this.font.value;\n    if (font !== null) {\n      context.font = font.toString();\n    }\n    const textAlign = this.textAlign.value;\n    if (textAlign !== void 0) {\n      context.textAlign = textAlign;\n    }\n    const textBaseline = this.textBaseline.value;\n    if (textBaseline !== void 0) {\n      context.textBaseline = textBaseline;\n    }\n    const textColor = this.textColor.value;\n    if (textColor !== null) {\n      context.fillStyle = textColor.toString();\n    }\n    let textOrigin = this.textOrigin.value;\n    if (textOrigin === null) {\n      textOrigin = R2Point.origin();\n    }\n    context.fillText(this.text.getValue(), textOrigin.x, textOrigin.y);\n\n    // restore\n    context.font = contextFont;\n    context.textAlign = contextTextAlign;\n    context.textBaseline = contextTextBaseline;\n    context.fillStyle = contextFillStyle;\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport type {Mutable} from \"@swim/util\";\nimport {Murmur3} from \"@swim/util\";\nimport {Numbers} from \"@swim/util\";\nimport {Constructors} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {HashCode} from \"@swim/util\";\nimport type {Equivalent} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {LengthLike} from \"@swim/math\";\nimport {Length} from \"@swim/math\";\n\n/** @public */\nexport type IconLayoutLike = IconLayout | IconLayoutInit;\n\n/** @public */\nexport const IconLayoutLike = {\n  [Symbol.hasInstance](instance: unknown): instance is IconLayoutLike {\n    return instance instanceof IconLayout\n        || IconLayoutInit[Symbol.hasInstance](instance);\n  },\n};\n\n/** @public */\nexport interface IconLayoutInit {\n  /** @internal */\n  readonly typeid?: \"IconLayoutInit\";\n  width: LengthLike;\n  height: LengthLike;\n  xAlign?: number;\n  yAlign?: number;\n}\n\n/** @public */\nexport const IconLayoutInit = {\n  [Symbol.hasInstance](instance: unknown): instance is IconLayoutInit {\n    return Objects.hasAllKeys<IconLayoutInit>(instance, \"width\", \"height\");\n  },\n};\n\n/** @public */\nexport class IconLayout implements Interpolate<IconLayout>, Equivalent, HashCode, Debug {\n  constructor(width: Length, height: Length, xAlign: number, yAlign: number) {\n    this.width = width;\n    this.height = height;\n    this.xAlign = xAlign;\n    this.yAlign = yAlign;\n  }\n\n  /** @internal */\n  declare readonly typeid?: \"IconLayout\";\n\n  likeType?(like: IconLayoutInit): void;\n\n  readonly width: Length;\n\n  withWidth(width: LengthLike): IconLayout {\n    width = Length.fromLike(width);\n    if (width.equals(this.width)) {\n      return this;\n    }\n    return this.copy(width, this.height, this.xAlign, this.yAlign);\n  }\n\n  readonly height: Length;\n\n  withHeight(height: LengthLike): IconLayout {\n    height = Length.fromLike(height);\n    if (height.equals(this.height)) {\n      return this;\n    }\n    return this.copy(this.width, height, this.xAlign, this.yAlign);\n  }\n\n  withSize(width: LengthLike, height: LengthLike): IconLayout {\n    width = Length.fromLike(width);\n    height = Length.fromLike(height);\n    if (width.equals(this.width) && height.equals(this.height)) {\n      return this;\n    }\n    return this.copy(width, height, this.xAlign, this.yAlign);\n  }\n\n  readonly xAlign: number;\n\n  withXAlign(xAlign: number): IconLayout {\n    if (xAlign === this.xAlign) {\n      return this;\n    }\n    return this.copy(this.width, this.height, xAlign, this.yAlign);\n  }\n\n  readonly yAlign: number;\n\n  withYAlign(yAlign: number): IconLayout {\n    if (yAlign === this.yAlign) {\n      return this;\n    }\n    return this.copy(this.width, this.height, this.xAlign, yAlign);\n  }\n\n  withAlign(xAlign: number, yAlign: number): IconLayout {\n    if (xAlign === this.xAlign && yAlign === this.yAlign) {\n      return this;\n    }\n    return this.copy(this.width, this.height, xAlign, yAlign);\n  }\n\n  toLike(): IconLayoutInit {\n    return {\n      width: this.width,\n      height: this.height,\n      xAlign: this.xAlign,\n      yAlign: this.yAlign,\n    };\n  }\n\n  protected copy(width: Length, height: Length, xAlign: number, yAlign: number): IconLayout {\n    return new IconLayout(width, height, xAlign, yAlign);\n  }\n\n  /** @override */\n  interpolateTo(that: IconLayout): Interpolator<IconLayout>;\n  interpolateTo(that: unknown): Interpolator<IconLayout> | null;\n  interpolateTo(that: unknown): Interpolator<IconLayout> | null {\n    if (that instanceof IconLayout) {\n      return IconLayoutInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof IconLayout) {\n      return this.width.equivalentTo(that.width, epsilon)\n          && this.height.equivalentTo(that.height, epsilon)\n          && Numbers.equivalent(this.xAlign, that.xAlign, epsilon)\n          && Numbers.equivalent(this.yAlign, that.yAlign, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof IconLayout) {\n      return this.width.equals(that.width) && this.height.equals(that.height)\n          && this.xAlign === that.xAlign && this.yAlign === that.yAlign;\n    }\n    return false;\n  }\n\n  /** @override */\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(IconLayout), this.width.hashCode()), this.height.hashCode()),\n        Numbers.hash(this.xAlign)), Numbers.hash(this.yAlign)));\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"IconLayout\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.width).write(\", \").debug(this.height).write(\", \")\n                   .debug(this.xAlign).write(\", \").debug(this.yAlign).write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  static of(width: LengthLike, height: LengthLike, xAlign?: number, yAlign?: number): IconLayout {\n    width = Length.fromLike(width);\n    height = Length.fromLike(height);\n    if (xAlign === void 0) {\n      xAlign = 0.5;\n    }\n    if (yAlign === void 0) {\n      yAlign = 0.5;\n    }\n    return new IconLayout(width, height, xAlign, yAlign);\n  }\n\n  static fromLike<T extends IconLayoutLike | null | undefined>(value: T): IconLayout | Uninitable<T> {\n    if (value === void 0 || value === null || value instanceof IconLayout) {\n      return value as IconLayout | Uninitable<T>;\n    } else if (IconLayoutInit[Symbol.hasInstance](value)) {\n      return IconLayout.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromInit(init: IconLayoutInit): IconLayout {\n    const width = Length.fromLike(init.width);\n    const height = Length.fromLike(init.height);\n    let xAlign = init.xAlign;\n    let yAlign = init.yAlign;\n    if (xAlign === void 0) {\n      xAlign = 0.5;\n    }\n    if (yAlign === void 0) {\n      yAlign = 0.5;\n    }\n    return new IconLayout(width, height, xAlign, yAlign);\n  }\n}\n\n/** @internal */\nexport const IconLayoutInterpolator = (function (_super: typeof Interpolator) {\n  const IconLayoutInterpolator = function (l0: IconLayout, l1: IconLayout): Interpolator<IconLayout> {\n    const interpolator = function (u: number): IconLayout {\n      const l0 = interpolator[0];\n      const l1 = interpolator[1];\n      const width = Length.of(l0.width.value + u * (l1.width.value - l0.width.value), l1.width.units);\n      const height = Length.of(l0.height.value + u * (l1.height.value - l0.height.value), l1.height.units);\n      const xAlign = l0.xAlign + u * (l1.xAlign - l0.xAlign);\n      const yAlign = l0.yAlign + u * (l1.yAlign - l0.yAlign);\n      return new IconLayout(width, height, xAlign, yAlign);\n    } as Interpolator<IconLayout>;\n    Object.setPrototypeOf(interpolator, IconLayoutInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = l0.width.units === l1.width.units && l0.height.units === l1.height.units\n                                                      ? l0 : new IconLayout(l0.width.to(l1.width.units), l0.height.to(l1.height.units), l0.xAlign, l0.yAlign);\n    (interpolator as Mutable<typeof interpolator>)[1] = l1;\n    return interpolator;\n  } as {\n    (l0: IconLayout, l1: IconLayout): Interpolator<IconLayout>;\n\n    /** @internal */\n    prototype: Interpolator<IconLayout>;\n  };\n\n  IconLayoutInterpolator.prototype = Object.create(_super.prototype);\n  IconLayoutInterpolator.prototype.constructor = IconLayoutInterpolator;\n\n  return IconLayoutInterpolator;\n})(Interpolator);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Box} from \"@swim/math\";\nimport type {Feel} from \"@swim/theme\";\nimport type {MoodVectorUpdates} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {MoodMatrix} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {Graphics} from \"./Graphics\";\nimport type {DrawingContext} from \"./DrawingContext\";\nimport type {PaintingContext} from \"./PaintingContext\";\n\n/** @public */\nexport abstract class Icon implements Graphics {\n  abstract readonly moodModifier: MoodMatrix | null;\n\n  abstract withMoodModifier(moodModifier: MoodMatrix | null): Icon;\n\n  abstract modifyMood(feel: Feel, updates: MoodVectorUpdates<Feel>): Icon;\n\n  abstract isThemed(): boolean;\n\n  abstract withTheme(theme: ThemeMatrix, mood: MoodVector): Icon;\n\n  abstract render(renderer: GraphicsRenderer, frame: R2Box): void;\n\n  abstract paint(context: PaintingContext, frame: R2Box): void;\n\n  abstract draw(context: DrawingContext, frame: R2Box): void;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Color} from \"@swim/style\";\nimport type {Look} from \"@swim/theme\";\nimport type {Feel} from \"@swim/theme\";\nimport type {MoodVectorUpdates} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {MoodMatrix} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport {Icon} from \"./Icon\";\n\n/** @public */\nexport abstract class FilledIcon extends Icon {\n  abstract readonly fillColor: Color | null;\n\n  abstract withFillColor(fillColor: Color | null): FilledIcon;\n\n  abstract readonly fillLook: Look<Color> | null;\n\n  abstract withFillLook(fillLook: Look<Color> | null): FilledIcon;\n\n  abstract override withMoodModifier(moodModifier: MoodMatrix | null): FilledIcon;\n\n  abstract override modifyMood(feel: Feel, updates: MoodVectorUpdates<Feel>): FilledIcon;\n\n  abstract override withTheme(theme: ThemeMatrix, mood: MoodVector): FilledIcon;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport {Equivalent} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {R2PathLike} from \"@swim/math\";\nimport {R2Path} from \"@swim/math\";\nimport type {R2Box} from \"@swim/math\";\nimport {Transform} from \"@swim/math\";\nimport type {Color} from \"@swim/style\";\nimport {Look} from \"@swim/theme\";\nimport type {Feel} from \"@swim/theme\";\nimport type {MoodVectorUpdates} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport {MoodMatrix} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {DrawingContext} from \"./DrawingContext\";\nimport {DrawingRenderer} from \"./DrawingRenderer\";\nimport type {PaintingFillRule} from \"./PaintingContext\";\nimport type {PaintingContext} from \"./PaintingContext\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport {FilledIcon} from \"./FilledIcon\";\n\n/** @public */\nexport class VectorIcon extends FilledIcon implements Interpolate<VectorIcon>, Equals, Equivalent, Debug {\n  constructor(path: R2Path, fillRule: PaintingFillRule, fillColor: Color | null,\n              fillLook: Look<Color> | null, moodModifier: MoodMatrix | null) {\n    super();\n    this.path = path;\n    this.fillRule = fillRule;\n    this.fillColor = fillColor;\n    this.fillLook = fillLook;\n    this.moodModifier = moodModifier;\n  }\n\n  readonly path: R2Path;\n\n  readonly fillRule: PaintingFillRule;\n\n  withFillRule(fillRule: PaintingFillRule): VectorIcon {\n    if (Equals(this.fillRule, fillRule)) {\n      return this;\n    }\n    return this.copy(this.path, fillRule, this.fillColor,\n                     this.fillLook, this.moodModifier);\n  }\n\n  override readonly fillColor: Color | null;\n\n  override withFillColor(fillColor: Color | null): VectorIcon {\n    if (Equals(this.fillColor, fillColor)) {\n      return this;\n    }\n    return this.copy(this.path, this.fillRule, fillColor,\n                     this.fillLook, this.moodModifier);\n  }\n\n  override readonly fillLook: Look<Color> | null;\n\n  override withFillLook(fillLook: Look<Color> | null): VectorIcon {\n    if (this.fillLook === fillLook) {\n      return this;\n    }\n    return this.copy(this.path, this.fillRule, this.fillColor,\n                     fillLook, this.moodModifier);\n  }\n\n  override readonly moodModifier: MoodMatrix | null;\n\n  override withMoodModifier(moodModifier: MoodMatrix | null): VectorIcon {\n    if (Equals(this.moodModifier, moodModifier)) {\n      return this;\n    }\n    return this.copy(this.path, this.fillRule, this.fillColor,\n                     this.fillLook, moodModifier);\n  }\n\n  override modifyMood(feel: Feel, updates: MoodVectorUpdates<Feel>): VectorIcon {\n    let oldMoodModifier = this.moodModifier;\n    if (oldMoodModifier === null) {\n      oldMoodModifier = MoodMatrix.empty();\n    }\n    const newMoodModifier = oldMoodModifier.updatedCol(feel, updates, true);\n    if (newMoodModifier.equals(oldMoodModifier)) {\n      return this;\n    }\n    return this.withMoodModifier(newMoodModifier);\n  }\n\n  override isThemed(): boolean {\n    return this.fillColor !== null;\n  }\n\n  override withTheme(theme: ThemeMatrix, mood: MoodVector): VectorIcon {\n    const fillLook = this.fillLook;\n    if (fillLook === null) {\n      return this;\n    }\n    const moodModifier = this.moodModifier;\n    if (moodModifier !== null) {\n      mood = moodModifier.timesCol(mood, true);\n    }\n    return this.withFillColor(theme.getOr(fillLook, mood, null));\n  }\n\n  override render(renderer: GraphicsRenderer, frame: R2Box): void {\n    if (renderer instanceof PaintingRenderer) {\n      this.paint(renderer.context, frame);\n    } else if (renderer instanceof DrawingRenderer) {\n      this.draw(renderer.context, frame);\n    }\n  }\n\n  override paint(context: PaintingContext, frame: R2Box): void {\n    // save\n    const contextGlobalAlpha = context.globalAlpha;\n    const contextFillStyle = context.fillStyle;\n\n    context.beginPath();\n    this.draw(context, frame);\n    if (this.fillColor !== null) {\n      context.globalAlpha = this.fillColor.alpha();\n      context.fillStyle = this.fillColor.toHexString();\n    }\n    context.fill(this.fillRule);\n\n    // restore\n    context.globalAlpha = contextGlobalAlpha;\n    context.fillStyle = contextFillStyle;\n  }\n\n  override draw(context: DrawingContext, frame: R2Box): void {\n    const transform = Transform.scale(frame.width, frame.height).translate(frame.x, frame.y);\n    this.path.transformDraw(context, transform);\n  }\n\n  protected copy(path: R2Path, fillRule: PaintingFillRule, fillColor: Color | null,\n                 fillLook: Look<Color> | null, moodModifier: MoodMatrix | null): VectorIcon {\n    return new VectorIcon(path, fillRule, fillColor, fillLook, moodModifier);\n  }\n\n  /** @override */\n  interpolateTo(that: VectorIcon): Interpolator<VectorIcon>;\n  interpolateTo(that: unknown): Interpolator<VectorIcon> | null;\n  interpolateTo(that: unknown): Interpolator<VectorIcon> | null {\n    if (that instanceof VectorIcon) {\n      return VectorIconInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof VectorIcon) {\n      return this.path.equivalentTo(that.path, epsilon)\n          && this.fillRule === that.fillRule\n          && Equivalent(this.fillColor, that.fillColor, epsilon)\n          && this.fillLook === that.fillLook\n          && Equivalent(this.moodModifier, that.moodModifier, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof VectorIcon) {\n      return this.path.equals(that.path)\n          && this.fillRule === that.fillRule\n          && Equals(this.fillColor, that.fillColor)\n          && this.fillLook === that.fillLook\n          && Equals(this.moodModifier, that.moodModifier);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"new\").write(32/*' '*/).write(\"VectorIcon\").write(40/*'('*/)\n                   .debug(this.path).write(\", \")\n                   .debug(this.fillRule).write(\", \")\n                   .debug(this.fillColor).write(\", \")\n                   .debug(this.fillLook).write(\", \")\n                   .debug(this.moodModifier).write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static create(width: number, height: number, path: R2PathLike,\n                fillRule?: PaintingFillRule): VectorIcon {\n    path = R2Path.fromLike(path);\n    if (width !== 1 || height !== 1) {\n      path = path.transform(Transform.scale(1 / width, 1 / height));\n    }\n    if (fillRule === void 0) {\n      fillRule = \"nonzero\";\n    }\n    return new VectorIcon(path, fillRule, null, Look.iconColor, null);\n  }\n}\n\n/** @internal */\nexport interface VectorIconInterpolator extends Interpolator<VectorIcon> {\n  /** @internal */\n  readonly path: R2Path;\n\n  /** @internal */\n  readonly fillRule: PaintingFillRule;\n\n  /** @internal */\n  readonly fillColorInterpolator: Interpolator<Color | null>;\n\n  /** @internal */\n  readonly fillLook: Look<Color> | null;\n\n  /** @internal */\n  readonly moodModifier: MoodMatrix | null;\n\n  readonly 0: VectorIcon;\n\n  readonly 1: VectorIcon;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const VectorIconInterpolator = (function (_super: typeof Interpolator) {\n  const VectorIconInterpolator = function (i0: VectorIcon, i1: VectorIcon): VectorIconInterpolator {\n    const interpolator = function (u: number): VectorIcon {\n      const path = interpolator.path;\n      const fillRule = interpolator.fillRule;\n      const fillColor = interpolator.fillColorInterpolator(u);\n      const fillLook = interpolator.fillLook;\n      const moodModifier = interpolator.moodModifier;\n      return new VectorIcon(path, fillRule, fillColor, fillLook, moodModifier);\n    } as VectorIconInterpolator;\n    Object.setPrototypeOf(interpolator, VectorIconInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).path = i1.path;\n    (interpolator as Mutable<typeof interpolator>).fillRule = i1.fillRule;\n    (interpolator as Mutable<typeof interpolator>).fillColorInterpolator = Interpolator(i0.fillColor, i1.fillColor);\n    (interpolator as Mutable<typeof interpolator>).fillLook = i1.fillLook;\n    (interpolator as Mutable<typeof interpolator>).moodModifier = i1.moodModifier;\n    return interpolator;\n  } as {\n    (i0: VectorIcon, i1: VectorIcon): VectorIconInterpolator;\n\n    /** @internal */\n    prototype: VectorIconInterpolator;\n  };\n\n  VectorIconInterpolator.prototype = Object.create(_super.prototype);\n  VectorIconInterpolator.prototype.constructor = VectorIconInterpolator;\n\n  Object.defineProperty(VectorIconInterpolator.prototype, 0, {\n    get(this: VectorIconInterpolator): VectorIcon {\n      const path = this.path;\n      const fillRule = this.fillRule;\n      const fillColor = this.fillColorInterpolator[0];\n      const fillLook = this.fillLook;\n      const moodModifier = this.moodModifier;\n      return new VectorIcon(path, fillRule, fillColor, fillLook, moodModifier);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(VectorIconInterpolator.prototype, 1, {\n    get(this: VectorIconInterpolator): VectorIcon {\n      const path = this.path;\n      const fillRule = this.fillRule;\n      const fillColor = this.fillColorInterpolator[1];\n      const fillLook = this.fillLook;\n      const moodModifier = this.moodModifier;\n      return new VectorIcon(path, fillRule, fillColor, fillLook, moodModifier);\n    },\n    configurable: true,\n  });\n\n  VectorIconInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof VectorIconInterpolator) {\n      return this.path.equals(that.path)\n          && this.fillRule === that.fillRule\n          && this.fillColorInterpolator.equals(that.fillColorInterpolator)\n          && this.fillLook === that.fillLook\n          && Equals(this.moodModifier, that.moodModifier);\n    }\n    return false;\n  };\n\n  return VectorIconInterpolator;\n})(Interpolator);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport {Equivalent} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {R2Box} from \"@swim/math\";\nimport type {Color} from \"@swim/style\";\nimport {Look} from \"@swim/theme\";\nimport type {Feel} from \"@swim/theme\";\nimport type {MoodVectorUpdates} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport {MoodMatrix} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {DrawingContext} from \"./DrawingContext\";\nimport {DrawingRenderer} from \"./DrawingRenderer\";\nimport type {PaintingContext} from \"./PaintingContext\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport {FilledIcon} from \"./FilledIcon\";\n\n/** @public */\nexport class CircleIcon extends FilledIcon implements Interpolate<CircleIcon>, Equals, Equivalent, Debug {\n  constructor(fillColor: Color | null, fillLook: Look<Color> | null, moodModifier: MoodMatrix | null) {\n    super();\n    this.fillColor = fillColor;\n    this.fillLook = fillLook;\n    this.moodModifier = moodModifier;\n  }\n\n  override readonly fillColor: Color | null;\n\n  override withFillColor(fillColor: Color | null): CircleIcon {\n    if (Equals(this.fillColor, fillColor)) {\n      return this;\n    }\n    return this.copy(fillColor, this.fillLook, this.moodModifier);\n  }\n\n  override readonly fillLook: Look<Color> | null;\n\n  override withFillLook(fillLook: Look<Color> | null): CircleIcon {\n    if (this.fillLook === fillLook) {\n      return this;\n    }\n    return this.copy(this.fillColor, fillLook, this.moodModifier);\n  }\n\n  override readonly moodModifier: MoodMatrix | null;\n\n  override withMoodModifier(moodModifier: MoodMatrix | null): CircleIcon {\n    if (Equals(this.moodModifier, moodModifier)) {\n      return this;\n    }\n    return this.copy(this.fillColor, this.fillLook, moodModifier);\n  }\n\n  override modifyMood(feel: Feel, updates: MoodVectorUpdates<Feel>): CircleIcon {\n    let oldMoodModifier = this.moodModifier;\n    if (oldMoodModifier === null) {\n      oldMoodModifier = MoodMatrix.empty();\n    }\n    const newMoodModifier = oldMoodModifier.updatedCol(feel, updates, true);\n    if (newMoodModifier.equals(oldMoodModifier)) {\n      return this;\n    }\n    return this.withMoodModifier(newMoodModifier);\n  }\n\n  override isThemed(): boolean {\n    return this.fillColor !== null;\n  }\n\n  override withTheme(theme: ThemeMatrix, mood: MoodVector): CircleIcon {\n    const fillLook = this.fillLook;\n    if (fillLook === null) {\n      return this;\n    }\n    const moodModifier = this.moodModifier;\n    if (moodModifier !== null) {\n      mood = moodModifier.timesCol(mood, true);\n    }\n    return this.withFillColor(theme.getOr(fillLook, mood, null));\n  }\n\n  override render(renderer: GraphicsRenderer, frame: R2Box): void {\n    if (renderer instanceof PaintingRenderer) {\n      this.paint(renderer.context, frame);\n    } else if (renderer instanceof DrawingRenderer) {\n      this.draw(renderer.context, frame);\n    }\n  }\n\n  override paint(context: PaintingContext, frame: R2Box): void {\n    // save\n    const contextGlobalAlpha = context.globalAlpha;\n    const contextFillStyle = context.fillStyle;\n\n    context.beginPath();\n    this.draw(context, frame);\n    if (this.fillColor !== null) {\n      context.globalAlpha = this.fillColor.alpha();\n      context.fillStyle = this.fillColor.toHexString();\n    }\n    context.fill();\n\n    // restore\n    context.globalAlpha = contextGlobalAlpha;\n    context.fillStyle = contextFillStyle;\n  }\n\n  override draw(context: DrawingContext, frame: R2Box): void {\n    const centerX = (frame.xMin + frame.xMax) / 2;\n    const centerY = (frame.yMin + frame.yMax) / 2;\n    const width = frame.width;\n    const height = frame.height;\n    const radius = Math.min(width, height) / 2;\n    context.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n    context.closePath();\n  }\n\n  protected copy(fillColor: Color | null, fillLook: Look<Color> | null,\n                 moodModifier: MoodMatrix | null): CircleIcon {\n    return new CircleIcon(fillColor, fillLook, moodModifier);\n  }\n\n  /** @override */\n  interpolateTo(that: CircleIcon): Interpolator<CircleIcon>;\n  interpolateTo(that: unknown): Interpolator<CircleIcon> | null;\n  interpolateTo(that: unknown): Interpolator<CircleIcon> | null {\n    if (that instanceof CircleIcon) {\n      return CircleIconInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof CircleIcon) {\n      return Equivalent(this.fillColor, that.fillColor, epsilon)\n          && this.fillLook === that.fillLook\n          && Equivalent(this.moodModifier, that.moodModifier, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof CircleIcon) {\n      return Equals(this.fillColor, that.fillColor)\n          && this.fillLook === that.fillLook\n          && Equals(this.moodModifier, that.moodModifier);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"new\").write(32/*' '*/).write(\"CircleIcon\").write(40/*'('*/)\n                   .debug(this.fillColor).write(\", \")\n                   .debug(this.fillLook).write(\", \")\n                   .debug(this.moodModifier).write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static create(): CircleIcon {\n    return new CircleIcon(null, Look.accentColor, null);\n  }\n}\n\n/** @internal */\nexport interface CircleIconInterpolator extends Interpolator<CircleIcon> {\n  /** @internal */\n  readonly fillColorInterpolator: Interpolator<Color | null>;\n\n  /** @internal */\n  readonly fillLook: Look<Color> | null;\n\n  /** @internal */\n  readonly moodModifier: MoodMatrix | null;\n\n  readonly 0: CircleIcon;\n\n  readonly 1: CircleIcon;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const CircleIconInterpolator = (function (_super: typeof Interpolator) {\n  const CircleIconInterpolator = function (i0: CircleIcon, i1: CircleIcon): CircleIconInterpolator {\n    const interpolator = function (u: number): CircleIcon {\n      const fillColor = interpolator.fillColorInterpolator(u);\n      const fillLook = interpolator.fillLook;\n      const moodModifier = interpolator.moodModifier;\n      return new CircleIcon(fillColor, fillLook, moodModifier);\n    } as CircleIconInterpolator;\n    Object.setPrototypeOf(interpolator, CircleIconInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).fillColorInterpolator = Interpolator(i0.fillColor, i1.fillColor);\n    (interpolator as Mutable<typeof interpolator>).fillLook = i1.fillLook;\n    (interpolator as Mutable<typeof interpolator>).moodModifier = i1.moodModifier;\n    return interpolator;\n  } as {\n    (i0: CircleIcon, i1: CircleIcon): CircleIconInterpolator;\n\n    /** @internal */\n    prototype: CircleIconInterpolator;\n  };\n\n  CircleIconInterpolator.prototype = Object.create(_super.prototype);\n  CircleIconInterpolator.prototype.constructor = CircleIconInterpolator;\n\n  Object.defineProperty(CircleIconInterpolator.prototype, 0, {\n    get(this: CircleIconInterpolator): CircleIcon {\n      const fillColor = this.fillColorInterpolator[0];\n      const fillLook = this.fillLook;\n      const moodModifier = this.moodModifier;\n      return new CircleIcon(fillColor, fillLook, moodModifier);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(CircleIconInterpolator.prototype, 1, {\n    get(this: CircleIconInterpolator): CircleIcon {\n      const fillColor = this.fillColorInterpolator[1];\n      const fillLook = this.fillLook;\n      const moodModifier = this.moodModifier;\n      return new CircleIcon(fillColor, fillLook, moodModifier);\n    },\n    configurable: true,\n  });\n\n  CircleIconInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof CircleIconInterpolator) {\n      return this.fillColorInterpolator.equals(that.fillColorInterpolator)\n          && this.fillLook === that.fillLook\n          && Equals(this.moodModifier, that.moodModifier);\n    }\n    return false;\n  };\n\n  return CircleIconInterpolator;\n})(Interpolator);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport {Equivalent} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {AngleLike} from \"@swim/math\";\nimport {Angle} from \"@swim/math\";\nimport type {R2Box} from \"@swim/math\";\nimport type {Color} from \"@swim/style\";\nimport {Look} from \"@swim/theme\";\nimport type {Feel} from \"@swim/theme\";\nimport type {MoodVectorUpdates} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport {MoodMatrix} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {DrawingContext} from \"./DrawingContext\";\nimport {DrawingRenderer} from \"./DrawingRenderer\";\nimport type {PaintingContext} from \"./PaintingContext\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport {FilledIcon} from \"./FilledIcon\";\n\n/** @public */\nexport class PolygonIcon extends FilledIcon implements Interpolate<PolygonIcon>, Equals, Equivalent, Debug {\n  constructor(sides: number, rotation: Angle, fillColor: Color | null,\n              fillLook: Look<Color> | null, moodModifier: MoodMatrix | null) {\n    super();\n    this.sides = sides;\n    this.rotation = rotation;\n    this.fillColor = fillColor;\n    this.fillLook = fillLook;\n    this.moodModifier = moodModifier;\n  }\n\n  readonly sides: number;\n\n  readonly rotation: Angle;\n\n  override readonly fillColor: Color | null;\n\n  override withFillColor(fillColor: Color | null): PolygonIcon {\n    if (Equals(this.fillColor, fillColor)) {\n      return this;\n    }\n    return this.copy(this.sides, this.rotation, fillColor,\n                     this.fillLook, this.moodModifier);\n  }\n\n  override readonly fillLook: Look<Color> | null;\n\n  override withFillLook(fillLook: Look<Color> | null): PolygonIcon {\n    if (this.fillLook === fillLook) {\n      return this;\n    }\n    return this.copy(this.sides, this.rotation, this.fillColor,\n                     fillLook, this.moodModifier);\n  }\n\n  override readonly moodModifier: MoodMatrix | null;\n\n  override withMoodModifier(moodModifier: MoodMatrix | null): PolygonIcon {\n    if (Equals(this.moodModifier, moodModifier)) {\n      return this;\n    }\n    return this.copy(this.sides, this.rotation, this.fillColor,\n                     this.fillLook, moodModifier);\n  }\n\n  override modifyMood(feel: Feel, updates: MoodVectorUpdates<Feel>): PolygonIcon {\n    let oldMoodModifier = this.moodModifier;\n    if (oldMoodModifier === null) {\n      oldMoodModifier = MoodMatrix.empty();\n    }\n    const newMoodModifier = oldMoodModifier.updatedCol(feel, updates, true);\n    if (newMoodModifier.equals(oldMoodModifier)) {\n      return this;\n    }\n    return this.withMoodModifier(newMoodModifier);\n  }\n\n  override isThemed(): boolean {\n    return this.fillColor !== null;\n  }\n\n  override withTheme(theme: ThemeMatrix, mood: MoodVector): PolygonIcon {\n    const fillLook = this.fillLook;\n    if (fillLook === null) {\n      return this;\n    }\n    const moodModifier = this.moodModifier;\n    if (moodModifier !== null) {\n      mood = moodModifier.timesCol(mood, true);\n    }\n    return this.withFillColor(theme.getOr(fillLook, mood, null));\n  }\n\n  override render(renderer: GraphicsRenderer, frame: R2Box): void {\n    if (renderer instanceof PaintingRenderer) {\n      this.paint(renderer.context, frame);\n    } else if (renderer instanceof DrawingRenderer) {\n      this.draw(renderer.context, frame);\n    }\n  }\n\n  override paint(context: PaintingContext, frame: R2Box): void {\n    // save\n    const contextGlobalAlpha = context.globalAlpha;\n    const contextFillStyle = context.fillStyle;\n\n    context.beginPath();\n    this.draw(context, frame);\n    if (this.fillColor !== null) {\n      context.globalAlpha = this.fillColor.alpha();\n      context.fillStyle = this.fillColor.toHexString();\n    }\n    context.fill();\n\n    // restore\n    context.globalAlpha = contextGlobalAlpha;\n    context.fillStyle = contextFillStyle;\n  }\n\n  override draw(context: DrawingContext, frame: R2Box): void {\n    const sides = this.sides;\n    if (sides < 3) {\n      return;\n    }\n    const centerX = (frame.xMin + frame.xMax) / 2;\n    const centerY = (frame.yMin + frame.yMax) / 2;\n    const width = frame.width;\n    const height = frame.height;\n    const radius = Math.min(width, height) / 2;\n    const sector = 2 * Math.PI / sides;\n    let angle = this.rotation.radValue();\n    context.moveTo(centerX + radius * Math.cos(angle),\n                   centerY + radius * Math.sin(angle));\n    angle += sector;\n    for (let i = 1; i < sides; i += 1) {\n      context.lineTo(centerX + radius * Math.cos(angle),\n                     centerY + radius * Math.sin(angle));\n      angle += sector;\n    }\n    context.closePath();\n  }\n\n  protected copy(sides: number, rotation: Angle, fillColor: Color | null,\n                 fillLook: Look<Color> | null, moodModifier: MoodMatrix | null): PolygonIcon {\n    return new PolygonIcon(sides, rotation, fillColor, fillLook, moodModifier);\n  }\n\n  /** @override */\n  interpolateTo(that: PolygonIcon): Interpolator<PolygonIcon>;\n  interpolateTo(that: unknown): Interpolator<PolygonIcon> | null;\n  interpolateTo(that: unknown): Interpolator<PolygonIcon> | null {\n    if (that instanceof PolygonIcon) {\n      return PolygonIconInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof PolygonIcon) {\n      return this.sides === that.sides\n          && this.rotation.equivalentTo(that.rotation, epsilon)\n          && Equivalent(this.fillColor, that.fillColor, epsilon)\n          && this.fillLook === that.fillLook\n          && Equivalent(this.moodModifier, that.moodModifier, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof PolygonIcon) {\n      return this.sides === that.sides\n          && this.rotation.equals(that.rotation)\n          && Equals(this.fillColor, that.fillColor)\n          && this.fillLook === that.fillLook\n          && Equals(this.moodModifier, that.moodModifier);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"new\").write(32/*' '*/).write(\"PolygonIcon\").write(40/*'('*/)\n                   .debug(this.sides).write(\", \")\n                   .debug(this.rotation).write(\", \")\n                   .debug(this.fillColor).write(\", \")\n                   .debug(this.fillLook).write(\", \")\n                   .debug(this.moodModifier).write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static create(sides: number, rotation?: AngleLike): PolygonIcon {\n    if (rotation !== void 0) {\n      rotation = Angle.fromLike(rotation);\n    } else {\n      rotation = Angle.zero();\n    }\n    return new PolygonIcon(sides, rotation, null, Look.accentColor, null);\n  }\n}\n\n/** @internal */\nexport interface PolygonIconInterpolator extends Interpolator<PolygonIcon> {\n  /** @internal */\n  readonly sides: number;\n\n  /** @internal */\n  readonly rotationInterpolator: Interpolator<Angle>;\n\n  /** @internal */\n  readonly fillColorInterpolator: Interpolator<Color | null>;\n\n  /** @internal */\n  readonly fillLook: Look<Color> | null;\n\n  /** @internal */\n  readonly moodModifier: MoodMatrix | null;\n\n  readonly 0: PolygonIcon;\n\n  readonly 1: PolygonIcon;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const PolygonIconInterpolator = (function (_super: typeof Interpolator) {\n  const PolygonIconInterpolator = function (i0: PolygonIcon, i1: PolygonIcon): PolygonIconInterpolator {\n    const interpolator = function (u: number): PolygonIcon {\n      const sides = interpolator.sides;\n      const rotation = interpolator.rotationInterpolator(u);\n      const fillColor = interpolator.fillColorInterpolator(u);\n      const fillLook = interpolator.fillLook;\n      const moodModifier = interpolator.moodModifier;\n      return new PolygonIcon(sides, rotation, fillColor, fillLook, moodModifier);\n    } as PolygonIconInterpolator;\n    Object.setPrototypeOf(interpolator, PolygonIconInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).sides = i1.sides;\n    (interpolator as Mutable<typeof interpolator>).rotationInterpolator = i0.rotation.interpolateTo(i1.rotation);\n    (interpolator as Mutable<typeof interpolator>).fillColorInterpolator = Interpolator(i0.fillColor, i1.fillColor);\n    (interpolator as Mutable<typeof interpolator>).fillLook = i1.fillLook;\n    (interpolator as Mutable<typeof interpolator>).moodModifier = i1.moodModifier;\n    return interpolator;\n  } as {\n    (i0: PolygonIcon, i1: PolygonIcon): PolygonIconInterpolator;\n\n    /** @internal */\n    prototype: PolygonIconInterpolator;\n  };\n\n  PolygonIconInterpolator.prototype = Object.create(_super.prototype);\n  PolygonIconInterpolator.prototype.constructor = PolygonIconInterpolator;\n\n  Object.defineProperty(PolygonIconInterpolator.prototype, 0, {\n    get(this: PolygonIconInterpolator): PolygonIcon {\n      const sides = this.sides;\n      const rotation = this.rotationInterpolator[0];\n      const fillColor = this.fillColorInterpolator[0];\n      const fillLook = this.fillLook;\n      const moodModifier = this.moodModifier;\n      return new PolygonIcon(sides, rotation, fillColor, fillLook, moodModifier);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(PolygonIconInterpolator.prototype, 1, {\n    get(this: PolygonIconInterpolator): PolygonIcon {\n      const sides = this.sides;\n      const rotation = this.rotationInterpolator[1];\n      const fillColor = this.fillColorInterpolator[1];\n      const fillLook = this.fillLook;\n      const moodModifier = this.moodModifier;\n      return new PolygonIcon(sides, rotation, fillColor, fillLook, moodModifier);\n    },\n    configurable: true,\n  });\n\n  PolygonIconInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof PolygonIconInterpolator) {\n      return this.sides === that.sides\n          && this.rotationInterpolator.equals(that.rotationInterpolator)\n          && this.fillColorInterpolator.equals(that.fillColorInterpolator)\n          && this.fillLook === that.fillLook\n          && Equals(this.moodModifier, that.moodModifier);\n    }\n    return false;\n  };\n\n  return PolygonIconInterpolator;\n})(Interpolator);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Lazy} from \"@swim/util\";\nimport {Equals} from \"@swim/util\";\nimport {Equivalent} from \"@swim/util\";\nimport type {Interpolate} from \"@swim/util\";\nimport {Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport {R2Box} from \"@swim/math\";\nimport {Feel} from \"@swim/theme\";\nimport type {MoodVectorUpdates} from \"@swim/theme\";\nimport type {MoodVector} from \"@swim/theme\";\nimport {MoodMatrix} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport type {GraphicsRenderer} from \"./GraphicsRenderer\";\nimport type {DrawingContext} from \"./DrawingContext\";\nimport {DrawingRenderer} from \"./DrawingRenderer\";\nimport type {PaintingContext} from \"./PaintingContext\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport {Icon} from \"./Icon\";\n\n/** @public */\nexport class EnclosedIcon extends Icon implements Interpolate<EnclosedIcon>, Equals, Equivalent, Debug {\n  constructor(outer: Icon | null, inner: Icon | null, innerScale: number, moodModifier: MoodMatrix | null,\n              outerMoodModifier: MoodMatrix | null, innerMoodModifier: MoodMatrix | null) {\n    super();\n    this.outer = outer;\n    this.inner = inner;\n    this.innerScale = innerScale;\n    this.moodModifier = moodModifier;\n    this.outerMoodModifier = outerMoodModifier;\n    this.innerMoodModifier = innerMoodModifier;\n  }\n\n  readonly outer: Icon | null;\n\n  withOuter(outer: Icon | null): EnclosedIcon {\n    if (this.outer === outer) {\n      return this;\n    }\n    return this.copy(outer, this.inner, this.innerScale, this.moodModifier,\n                     this.outerMoodModifier, this.innerMoodModifier);\n  }\n\n  readonly inner: Icon | null;\n\n  withInner(inner: Icon | null): EnclosedIcon {\n    if (this.inner === inner) {\n      return this;\n    }\n    return this.copy(this.outer, inner, this.innerScale, this.moodModifier,\n                     this.outerMoodModifier, this.innerMoodModifier);\n  }\n\n  readonly innerScale: number;\n\n  withInnerScale(innerScale: number): EnclosedIcon {\n    if (this.innerScale === innerScale) {\n      return this;\n    }\n    return this.copy(this.outer, this.inner, innerScale, this.moodModifier,\n                     this.outerMoodModifier, this.innerMoodModifier);\n  }\n\n  override readonly moodModifier: MoodMatrix | null;\n\n  override withMoodModifier(moodModifier: MoodMatrix | null): EnclosedIcon {\n    if (Equals(this.moodModifier, moodModifier)) {\n      return this;\n    }\n    return this.copy(this.outer, this.inner, this.innerScale, moodModifier,\n                     this.outerMoodModifier, this.innerMoodModifier);\n  }\n\n  override modifyMood(feel: Feel, updates: MoodVectorUpdates<Feel>): EnclosedIcon {\n    let oldMoodModifier = this.moodModifier;\n    if (oldMoodModifier === null) {\n      oldMoodModifier = MoodMatrix.empty();\n    }\n    const newMoodModifier = oldMoodModifier.updatedCol(feel, updates, true);\n    if (newMoodModifier.equals(oldMoodModifier)) {\n      return this;\n    }\n    return this.withMoodModifier(newMoodModifier);\n  }\n\n  /** @internal */\n  readonly outerMoodModifier: MoodMatrix | null;\n\n  withOuterMoodModifier(outerMoodModifier: MoodMatrix | null): EnclosedIcon {\n    if (Equals(this.outerMoodModifier, outerMoodModifier)) {\n      return this;\n    }\n    return this.copy(this.outer, this.inner, this.innerScale, this.moodModifier,\n                     outerMoodModifier, this.innerMoodModifier);\n  }\n\n  modifyOuterMood(feel: Feel, updates: MoodVectorUpdates<Feel>): EnclosedIcon {\n    let oldOuterMoodModifier = this.outerMoodModifier;\n    if (oldOuterMoodModifier === null) {\n      oldOuterMoodModifier = MoodMatrix.empty();\n    }\n    const newOuterMoodModifier = oldOuterMoodModifier.updatedCol(feel, updates, true);\n    if (newOuterMoodModifier.equals(oldOuterMoodModifier)) {\n      return this;\n    }\n    return this.withOuterMoodModifier(newOuterMoodModifier);\n  }\n\n  /** @internal */\n  readonly innerMoodModifier: MoodMatrix | null;\n\n  withInnerMoodModifier(innerMoodModifier: MoodMatrix | null): EnclosedIcon {\n    if (Equals(this.innerMoodModifier, innerMoodModifier)) {\n      return this;\n    }\n    return this.copy(this.outer, this.inner, this.innerScale, this.moodModifier,\n                     this.outerMoodModifier, innerMoodModifier);\n  }\n\n  modifyInnerMood(feel: Feel, updates: MoodVectorUpdates<Feel>): EnclosedIcon {\n    let oldInnerMoodModifier = this.innerMoodModifier;\n    if (oldInnerMoodModifier === null) {\n      oldInnerMoodModifier = MoodMatrix.empty();\n    }\n    const newInnerMoodModifier = oldInnerMoodModifier.updatedCol(feel, updates, true);\n    if (newInnerMoodModifier.equals(oldInnerMoodModifier)) {\n      return this;\n    }\n    return this.withInnerMoodModifier(newInnerMoodModifier);\n  }\n\n  override isThemed(): boolean {\n    const outer = this.outer;\n    const inner = this.inner;\n    return (outer === null || outer.isThemed())\n        && (inner === null || inner.isThemed());\n  }\n\n  override withTheme(theme: ThemeMatrix, mood: MoodVector): EnclosedIcon {\n    const moodModifier = this.moodModifier;\n    const outerMoodModifier = this.outerMoodModifier;\n    const innerMoodModifier = this.innerMoodModifier;\n\n    let modifiedMood = mood;\n    if (moodModifier !== null) {\n      modifiedMood = moodModifier.timesCol(modifiedMood, true);\n    }\n\n    const oldOuter = this.outer;\n    let newOuter: Icon | null;\n    if (oldOuter === null) {\n      newOuter = null;\n    } else {\n      let outerMood = modifiedMood;\n      if (outerMoodModifier !== null) {\n        outerMood = outerMoodModifier.timesCol(outerMood, true);\n      }\n      newOuter = oldOuter.withTheme(theme, outerMood);\n    }\n\n    const oldInner = this.inner;\n    let newInner: Icon | null;\n    if (oldInner === null) {\n      newInner = null;\n    } else {\n      let innerMood = modifiedMood;\n      if (innerMoodModifier !== null) {\n        innerMood = innerMoodModifier.timesCol(innerMood, true);\n      }\n      newInner = oldInner.withTheme(theme, innerMood);\n    }\n\n    if (newOuter === oldOuter && newInner === oldInner) {\n      return this;\n    }\n    return this.copy(newOuter, newInner, this.innerScale, moodModifier,\n                     outerMoodModifier, innerMoodModifier);\n  }\n\n  override render(renderer: GraphicsRenderer, frame: R2Box): void {\n    if (renderer instanceof PaintingRenderer) {\n      this.paint(renderer.context, frame);\n    } else if (renderer instanceof DrawingRenderer) {\n      this.draw(renderer.context, frame);\n    }\n  }\n\n  override paint(context: PaintingContext, frame: R2Box): void {\n    const outer = this.outer;\n    if (outer !== null) {\n      outer.paint(context, this.outerFrame(frame));\n    }\n    const inner = this.inner;\n    if (inner !== null) {\n      inner.paint(context, this.innerFrame(frame));\n    }\n  }\n\n  override draw(context: DrawingContext, frame: R2Box): void {\n    const outer = this.outer;\n    if (outer !== null) {\n      outer.draw(context, this.outerFrame(frame));\n    }\n    const inner = this.inner;\n    if (inner !== null) {\n      inner.draw(context, this.innerFrame(frame));\n    }\n  }\n\n  outerFrame(frame: R2Box): R2Box {\n    return frame;\n  }\n\n  innerFrame(frame: R2Box): R2Box {\n    let {xMin, xMax, yMin, yMax} = frame;\n    let width = xMax - xMin;\n    let height = yMax - yMin;\n    const innerScale = this.innerScale;\n    if (innerScale !== 1) {\n      const cx = (xMin + xMax) / 2;\n      const cy = (yMin + yMax) / 2;\n      width = width * innerScale;\n      height = height * innerScale;\n      xMin = cx - width / 2;\n      yMin = cy - height / 2;\n      xMax = cx + width / 2;\n      yMax = cy + height / 2;\n    }\n    if (width > height) {\n      const ex = (width - height) / 2;\n      xMin += ex;\n      xMax -= ex;\n    } else if (width < height) {\n      const ey = (height - width) / 2;\n      yMin += ey;\n      yMax -= ey;\n    }\n    if (width === height && innerScale === 1) {\n      return frame;\n    }\n    return new R2Box(xMin, yMin, xMax, yMax);\n  }\n\n  protected copy(outer: Icon | null, inner: Icon | null, innerScale: number, moodModifier: MoodMatrix | null,\n                 outerMoodModifier: MoodMatrix | null, innerMoodModifier: MoodMatrix | null): EnclosedIcon {\n    return new EnclosedIcon(outer, inner, innerScale, moodModifier, outerMoodModifier, innerMoodModifier);\n  }\n\n  /** @override */\n  interpolateTo(that: EnclosedIcon): Interpolator<EnclosedIcon>;\n  interpolateTo(that: unknown): Interpolator<EnclosedIcon> | null;\n  interpolateTo(that: unknown): Interpolator<EnclosedIcon> | null {\n    if (that instanceof EnclosedIcon) {\n      return EnclosedIconInterpolator(this, that);\n    }\n    return null;\n  }\n\n  /** @override */\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof EnclosedIcon) {\n      return Equivalent(this.outer, that.outer, epsilon)\n          && Equivalent(this.inner, that.inner, epsilon)\n          && Equivalent(this.innerScale, that.innerScale, epsilon)\n          && Equivalent(this.moodModifier, that.moodModifier, epsilon)\n          && Equivalent(this.outerMoodModifier, that.outerMoodModifier, epsilon)\n          && Equivalent(this.innerMoodModifier, that.innerMoodModifier, epsilon);\n    }\n    return false;\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof EnclosedIcon) {\n      return Equals(this.outer, that.outer)\n          && Equals(this.inner, that.inner)\n          && Equals(this.innerScale, that.innerScale)\n          && Equals(this.moodModifier, that.moodModifier)\n          && Equals(this.outerMoodModifier, that.outerMoodModifier)\n          && Equals(this.innerMoodModifier, that.innerMoodModifier);\n    }\n    return false;\n  }\n\n  /** @override */\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"new\").write(32/*' '*/).write(\"EnclosedIcon\").write(40/*'('*/)\n                   .debug(this.outer).write(\", \")\n                   .debug(this.inner).write(\", \")\n                   .debug(this.innerScale).write(\", \")\n                   .debug(this.moodModifier).write(\", \")\n                   .debug(this.outerMoodModifier).write(\", \")\n                   .debug(this.innerMoodModifier).write(41/*')'*/);\n    return output;\n  }\n\n  /** @override */\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static create(outer: Icon | null, inner: Icon | null): EnclosedIcon {\n    return new EnclosedIcon(outer, inner, 1, null, null, null);\n  }\n\n  static embossed(outer: Icon | null, inner: Icon | null): EnclosedIcon {\n    return new EnclosedIcon(outer, inner, 1, null, null, EnclosedIcon.embossedMoodModifier);\n  }\n\n  @Lazy\n  static get embossedMoodModifier(): MoodMatrix {\n    return MoodMatrix.empty().updatedCol(Feel.default, [[Feel.embossed, 1]], true);\n  }\n}\n\n/** @internal */\nexport interface EnclosedIconInterpolator extends Interpolator<EnclosedIcon> {\n  /** @internal */\n  readonly outerInterpolator: Interpolator<Icon | null>;\n\n  /** @internal */\n  readonly innerInterpolator: Interpolator<Icon | null>;\n\n  /** @internal */\n  readonly innerScaleInterpolator: Interpolator<number>;\n\n  /** @internal */\n  readonly moodModifier: MoodMatrix | null;\n\n  /** @internal */\n  readonly outerMoodModifier: MoodMatrix | null;\n\n  /** @internal */\n  readonly innerMoodModifier: MoodMatrix | null;\n\n  readonly 0: EnclosedIcon;\n\n  readonly 1: EnclosedIcon;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const EnclosedIconInterpolator = (function (_super: typeof Interpolator) {\n  const EnclosedIconInterpolator = function (i0: EnclosedIcon, i1: EnclosedIcon): EnclosedIconInterpolator {\n    const interpolator = function (u: number): EnclosedIcon {\n      const outer = interpolator.outerInterpolator(u);\n      const inner = interpolator.innerInterpolator(u);\n      const innerScale = interpolator.innerScaleInterpolator(u);\n      const moodModifier = interpolator.moodModifier;\n      const outerMoodModifier = interpolator.outerMoodModifier;\n      const innerMoodModifier = interpolator.innerMoodModifier;\n      return new EnclosedIcon(outer, inner, innerScale, moodModifier,\n                              outerMoodModifier, innerMoodModifier);\n    } as EnclosedIconInterpolator;\n    Object.setPrototypeOf(interpolator, EnclosedIconInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).outerInterpolator = Interpolator(i0.outer, i1.outer);\n    (interpolator as Mutable<typeof interpolator>).innerInterpolator = Interpolator(i0.inner, i1.inner);\n    (interpolator as Mutable<typeof interpolator>).innerScaleInterpolator = Interpolator(i0.innerScale, i1.innerScale);\n    (interpolator as Mutable<typeof interpolator>).moodModifier = i1.moodModifier;\n    (interpolator as Mutable<typeof interpolator>).outerMoodModifier = i1.outerMoodModifier;\n    (interpolator as Mutable<typeof interpolator>).innerMoodModifier = i1.innerMoodModifier;\n    return interpolator;\n  } as {\n    (i0: EnclosedIcon, i1: EnclosedIcon): EnclosedIconInterpolator;\n\n    /** @internal */\n    prototype: EnclosedIconInterpolator;\n  };\n\n  EnclosedIconInterpolator.prototype = Object.create(_super.prototype);\n  EnclosedIconInterpolator.prototype.constructor = EnclosedIconInterpolator;\n\n  Object.defineProperty(EnclosedIconInterpolator.prototype, 0, {\n    get(this: EnclosedIconInterpolator): EnclosedIcon {\n      const outer = this.outerInterpolator[0];\n      const inner = this.innerInterpolator[0];\n      const innerScale = this.innerScaleInterpolator[0];\n      const moodModifier = this.moodModifier;\n      const outerMoodModifier = this.outerMoodModifier;\n      const innerMoodModifier = this.innerMoodModifier;\n      return new EnclosedIcon(outer, inner, innerScale, moodModifier,\n                              outerMoodModifier, innerMoodModifier);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(EnclosedIconInterpolator.prototype, 1, {\n    get(this: EnclosedIconInterpolator): EnclosedIcon {\n      const outer = this.outerInterpolator[1];\n      const inner = this.innerInterpolator[1];\n      const innerScale = this.innerScaleInterpolator[1];\n      const moodModifier = this.moodModifier;\n      const outerMoodModifier = this.outerMoodModifier;\n      const innerMoodModifier = this.innerMoodModifier;\n      return new EnclosedIcon(outer, inner, innerScale, moodModifier,\n                              outerMoodModifier, innerMoodModifier);\n    },\n    configurable: true,\n  });\n\n  EnclosedIconInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof EnclosedIconInterpolator) {\n      return this.outerInterpolator.equals(that.outerInterpolator)\n          && this.innerInterpolator.equals(that.innerInterpolator)\n          && this.innerScaleInterpolator.equals(that.innerScaleInterpolator)\n          && Equals(this.moodModifier, that.moodModifier)\n          && Equals(this.outerMoodModifier, that.outerMoodModifier)\n          && Equals(this.innerMoodModifier, that.innerMoodModifier);\n    }\n    return false;\n  };\n\n  return EnclosedIconInterpolator;\n})(Interpolator);\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Animator} from \"@swim/component\";\nimport type {Color} from \"@swim/style\";\nimport type {ThemeAnimatorClass} from \"@swim/theme\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport {View} from \"@swim/view\";\nimport {Graphics} from \"./Graphics\";\nimport type {IconLayout} from \"./IconLayout\";\nimport {Icon} from \"./Icon\";\nimport {FilledIcon} from \"./FilledIcon\";\n\n/** @public */\nexport interface IconView extends View {\n  readonly iconLayout: Animator<this, IconLayout | null>;\n\n  readonly iconColor: ThemeAnimator<this, Color | null>;\n\n  readonly graphics: ThemeAnimator<this, Graphics | null>;\n}\n\n/** @public */\nexport const IconView = {\n  [Symbol.hasInstance](instance: unknown): instance is IconView {\n    return instance instanceof View\n        && \"iconLayout\" in instance\n        && \"iconColor\" in instance\n        && \"graphics\" in instance;\n  },\n};\n\n/** @internal */\nexport const IconGraphicsAnimator = (<R, A extends ThemeAnimator<any, any, any>>() => ThemeAnimator.extend<ThemeAnimator<R, Graphics | null>, ThemeAnimatorClass<A>>(\"IconGraphicsAnimator\", {\n  valueType: Graphics,\n\n  deriveValue(graphics: Graphics | null): Graphics | null {\n    const iconView = this.owner;\n    if (!IconView[Symbol.hasInstance](iconView) || !(graphics instanceof Icon)) {\n      return graphics;\n    }\n    const iconColor = iconView.iconColor.state;\n    if (iconColor !== null && graphics instanceof FilledIcon && graphics.fillLook !== iconView.iconColor.look) {\n      graphics = graphics.withFillColor(iconColor);\n    }\n    return graphics;\n  },\n\n  transformState(graphics: Graphics | null): Graphics | null {\n    const iconView = this.owner;\n    if (!IconView[Symbol.hasInstance](iconView) || !(graphics instanceof Icon)) {\n      return graphics;\n    }\n    const iconColor = iconView.iconColor.state;\n    if (iconColor !== null && graphics instanceof FilledIcon) {\n      graphics = graphics.withFillColor(iconColor);\n    } else {\n      const theme = iconView.theme.value;\n      const mood = iconView.mood.value;\n      if (theme !== null && mood !== null) {\n        graphics = graphics.withTheme(theme, mood);\n      }\n    }\n    return graphics;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Timing} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport {R2Box} from \"@swim/math\";\nimport {Color} from \"@swim/style\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport {View} from \"@swim/view\";\nimport {Graphics} from \"./Graphics\";\nimport {GraphicsView} from \"./GraphicsView\";\nimport {PaintingRenderer} from \"./PaintingRenderer\";\nimport {CanvasRenderer} from \"./CanvasRenderer\";\nimport {IconLayout} from \"./IconLayout\";\nimport {Icon} from \"./Icon\";\nimport type {IconView} from \"./IconView\";\nimport {IconGraphicsAnimator} from \"./IconView\";\n\n/** @public */\nexport class GraphicsIconView extends GraphicsView implements IconView {\n  /** @override */\n  @Animator({valueType: IconLayout, value: null, updateFlags: View.NeedsRender})\n  readonly iconLayout!: Animator<this, IconLayout | null>;\n\n  /** @override */\n  @ThemeAnimator({\n    valueType: Color,\n    value: null,\n    updateFlags: View.NeedsRender,\n    didSetState(iconColor: Color | null): void {\n      const timing = this.timing !== null ? this.timing : false;\n      this.owner.graphics.setState(this.owner.graphics.state, timing, Affinity.Reflexive);\n    },\n  })\n  get iconColor(): ThemeAnimator<this, Color | null> {\n    return ThemeAnimator.getter();\n  }\n\n  /** @override */\n  @ThemeAnimator({\n    extends: IconGraphicsAnimator,\n    valueType: Graphics,\n    value: null,\n    updateFlags: View.NeedsRender,\n  })\n  readonly graphics!: ThemeAnimator<this, Graphics | null>;\n\n  protected override onApplyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    super.onApplyTheme(theme, mood, timing);\n    if (!this.graphics.derived) {\n      const oldGraphics = this.graphics.value;\n      if (oldGraphics instanceof Icon) {\n        const newGraphics = oldGraphics.withTheme(theme, mood);\n        this.graphics.setState(newGraphics, oldGraphics.isThemed() ? timing : false, Affinity.Reflexive);\n      }\n    }\n  }\n\n  protected override onRender(): void {\n    super.onRender();\n    const renderer = this.renderer.value;\n    if (renderer instanceof PaintingRenderer && !this.hidden && !this.culled) {\n      this.renderIcon(renderer, this.viewBounds);\n    }\n  }\n\n  protected renderIcon(renderer: PaintingRenderer, frame: R2Box): void {\n    const graphics = this.graphics.value;\n    if (graphics !== null) {\n      const context = renderer.context;\n      context.beginPath();\n      graphics.render(renderer, frame);\n    }\n  }\n\n  declare readonly viewBounds: R2Box; // getter defined below to work around useDefineForClassFields lunacy\n\n  protected override hitTest(x: number, y: number): GraphicsView | null {\n    const renderer = this.renderer.value;\n    if (renderer instanceof CanvasRenderer) {\n      return this.hitTestIcon(x, y, renderer, this.viewBounds);\n    }\n    return null;\n  }\n\n  protected hitTestIcon(x: number, y: number, renderer: CanvasRenderer, frame: R2Box): GraphicsView | null {\n    // TODO: icon hit test mode\n    if (this.hitBounds.contains(x, y)) {\n      return this;\n    }\n    //const graphics = this.graphics.value;\n    //if (graphics !== null) {\n    //  const context = renderer.context;\n    //  graphics.render(renderer, frame);\n    //  const p = renderer.transform.transform(x, y);\n    //  if (context.isPointInPath(p.x, p.y)) {\n    //    return this;\n    //  }\n    //}\n    return null;\n  }\n}\nObject.defineProperty(GraphicsIconView.prototype, \"viewBounds\", {\n  get(this: GraphicsIconView): R2Box {\n    const viewFrame = this.viewFrame;\n    const viewWidth = viewFrame.width;\n    const viewHeight = viewFrame.height;\n    const viewSize = Math.min(viewWidth, viewHeight);\n    const iconLayout = this.iconLayout.value;\n    const iconWidth = iconLayout !== null ? iconLayout.width.pxValue(viewSize) : viewSize;\n    const iconHeight = iconLayout !== null ? iconLayout.height.pxValue(viewSize) : viewSize;\n    const xAlign = iconLayout !== null ? iconLayout.xAlign : 0.5;\n    const yAlign = iconLayout !== null ? iconLayout.yAlign : 0.5;\n    const x = viewFrame.x + (viewWidth - iconWidth) * xAlign;\n    const y = viewFrame.y + (viewHeight - iconHeight) * yAlign;\n    return new R2Box(x, y, x + iconWidth, y + iconHeight);\n  },\n  configurable: true,\n});\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Timing} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport {R2Box} from \"@swim/math\";\nimport {Color} from \"@swim/style\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport type {ViewFlags} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport {SvgView} from \"@swim/dom\";\nimport {Graphics} from \"./Graphics\";\nimport {SvgContext} from \"./SvgContext\";\nimport {SvgRenderer} from \"./SvgRenderer\";\nimport {IconLayout} from \"./IconLayout\";\nimport {Icon} from \"./Icon\";\nimport type {IconView} from \"./IconView\";\nimport {IconGraphicsAnimator} from \"./IconView\";\n\n/** @public */\nexport class SvgIconView extends SvgView implements IconView {\n  /** @override */\n  @Animator({valueType: IconLayout, value: null, updateFlags: View.NeedsLayout})\n  readonly iconLayout!: Animator<this, IconLayout | null>;\n\n  /** @override */\n  @ThemeAnimator({\n    valueType: Color,\n    value: null,\n    updateFlags: View.NeedsLayout,\n    didSetState(iconColor: Color | null): void {\n      const timing = this.timing !== null ? this.timing : false;\n      this.owner.graphics.setState(this.owner.graphics.state, timing, Affinity.Reflexive);\n    },\n  })\n  get iconColor(): ThemeAnimator<this, Color | null> {\n    return ThemeAnimator.getter();\n  }\n\n  /** @override */\n  @ThemeAnimator({\n    extends: IconGraphicsAnimator,\n    valueType: Graphics,\n    value: null,\n    updateFlags: View.NeedsLayout,\n  })\n  readonly graphics!: ThemeAnimator<this, Graphics | null>;\n\n  protected override onApplyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    super.onApplyTheme(theme, mood, timing);\n    if (!this.graphics.derived) {\n      const oldGraphics = this.graphics.value;\n      if (oldGraphics instanceof Icon) {\n        const newGraphics = oldGraphics.withTheme(theme, mood);\n        this.graphics.setState(newGraphics, oldGraphics.isThemed() ? timing : false, Affinity.Reflexive);\n      }\n    }\n  }\n\n  protected override onResize(): void {\n    super.onResize();\n    this.requireUpdate(View.NeedsLayout);\n  }\n\n  protected override needsDisplay(displayFlags: ViewFlags): ViewFlags {\n    if ((this.flags & View.NeedsLayout) === 0) {\n      displayFlags &= ~View.NeedsLayout;\n    }\n    return displayFlags;\n  }\n\n  protected override onLayout(): void {\n    super.onLayout();\n    this.renderIcon();\n  }\n\n  protected renderIcon(): void {\n    const context = new SvgContext(this);\n    context.setPrecision(3);\n    context.beginSvg();\n    const graphics = this.graphics.value;\n    if (graphics !== null) {\n      const frame = this.iconBounds;\n      if (frame.isDefined() && frame.width > 0 && frame.height > 0) {\n        context.beginPath();\n        const renderer = new SvgRenderer(context);\n        graphics.render(renderer, frame);\n      }\n    }\n    context.finalizeSvg();\n  }\n\n  get iconBounds(): R2Box {\n    let viewportElement = this.node.viewportElement;\n    if (viewportElement === null) {\n      viewportElement = this.node;\n    }\n    if (!(viewportElement instanceof SVGSVGElement)) {\n      return R2Box.undefined();\n    }\n    const viewBox = viewportElement.viewBox.animVal;\n    const viewWidth = viewBox.width;\n    const viewHeight = viewBox.height;\n    const viewSize = Math.min(viewWidth, viewHeight);\n    const iconLayout = this.iconLayout.value;\n    const iconWidth = iconLayout !== null ? iconLayout.width.pxValue(viewSize) : viewSize;\n    const iconHeight = iconLayout !== null ? iconLayout.height.pxValue(viewSize) : viewSize;\n    const xAlign = iconLayout !== null ? iconLayout.xAlign : 0.5;\n    const yAlign = iconLayout !== null ? iconLayout.yAlign : 0.5;\n    const x = viewBox.x + (viewWidth - iconWidth) * xAlign;\n    const y = viewBox.y + (viewHeight - iconHeight) * yAlign;\n    return new R2Box(x, y, x + iconWidth, y + iconHeight);\n  }\n\n  static override readonly MountFlags: ViewFlags = SvgView.MountFlags | View.NeedsAnimate;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Timing} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {Animator} from \"@swim/component\";\nimport {Color} from \"@swim/style\";\nimport type {MoodVector} from \"@swim/theme\";\nimport type {ThemeMatrix} from \"@swim/theme\";\nimport {ThemeAnimator} from \"@swim/theme\";\nimport type {ViewFlags} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport {ViewRef} from \"@swim/view\";\nimport {HtmlView} from \"@swim/dom\";\nimport {Graphics} from \"./Graphics\";\nimport {IconLayout} from \"./IconLayout\";\nimport {Icon} from \"./Icon\";\nimport type {IconView} from \"./IconView\";\nimport {IconGraphicsAnimator} from \"./IconView\";\nimport {SvgIconView} from \"./SvgIconView\";\n\n/** @public */\nexport class HtmlIconView extends HtmlView implements IconView {\n  constructor(node: HTMLElement) {\n    super(node);\n    this.initIcon();\n  }\n\n  protected initIcon(): void {\n    this.style.position.setIntrinsic(\"relative\");\n  }\n\n  /** @override */\n  @Animator({valueType: IconLayout, value: null, updateFlags: View.NeedsLayout})\n  readonly iconLayout!: Animator<this, IconLayout | null>;\n\n  /** @override */\n  @ThemeAnimator({\n    valueType: Color,\n    value: null,\n    updateFlags: View.NeedsLayout,\n    didSetState(iconColor: Color | null): void {\n      const timing = this.timing !== null ? this.timing : false;\n      this.owner.graphics.setState(this.owner.graphics.state, timing, Affinity.Reflexive);\n    },\n  })\n  get iconColor(): ThemeAnimator<this, Color | null> {\n    return ThemeAnimator.getter();\n  }\n\n  /** @override */\n  @ThemeAnimator({\n    extends: IconGraphicsAnimator,\n    valueType: Graphics,\n    value: null,\n    updateFlags: View.NeedsLayout,\n  })\n  readonly graphics!: ThemeAnimator<this, Graphics | null>;\n\n  @ViewRef({\n    viewType: SvgIconView,\n    viewKey: true,\n    binds: true,\n    init(): void {\n      this.insertView();\n    },\n    initView(svgView: SvgIconView): void {\n      svgView.style.position.set(\"absolute\");\n      svgView.iconLayout.setInherits(true);\n      svgView.iconColor.setInherits(true);\n      svgView.graphics.setInherits(true);\n    },\n  })\n  readonly svg!: ViewRef<this, SvgIconView>;\n\n  protected override onApplyTheme(theme: ThemeMatrix, mood: MoodVector, timing: Timing | boolean): void {\n    super.onApplyTheme(theme, mood, timing);\n    if (!this.graphics.derived) {\n      const oldGraphics = this.graphics.value;\n      if (oldGraphics instanceof Icon) {\n        const newGraphics = oldGraphics.withTheme(theme, mood);\n        this.graphics.setState(newGraphics, oldGraphics.isThemed() ? timing : false, Affinity.Reflexive);\n      }\n    }\n  }\n\n  protected override onResize(): void {\n    super.onResize();\n    this.requireUpdate(View.NeedsLayout);\n  }\n\n  protected override needsDisplay(displayFlags: ViewFlags): ViewFlags {\n    if ((this.flags & View.NeedsLayout) === 0) {\n      displayFlags &= ~View.NeedsLayout;\n    }\n    return displayFlags;\n  }\n\n  protected override onLayout(): void {\n    super.onLayout();\n    this.layoutIcon();\n  }\n\n  protected layoutIcon(): void {\n    const svgView = this.svg.view;\n    if (svgView === null || !svgView.attributes.width.hasAffinity(Affinity.Intrinsic)\n                         && !svgView.attributes.height.hasAffinity(Affinity.Intrinsic)\n                         && !svgView.attributes.viewBox.hasAffinity(Affinity.Intrinsic)) {\n      return;\n    }\n    const width = this.style.width.pxValue();\n    const height = this.style.height.pxValue();\n    svgView.attributes.setIntrinsic({\n      width, height,\n      viewBox: \"0 0 \" + width + \" \" + height,\n    });\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport type {FromLike} from \"@swim/util\";\nimport type {Creatable} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Consumable} from \"@swim/util\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerTemplate} from \"@swim/component\";\nimport type {Fastener} from \"@swim/component\";\nimport {Property} from \"@swim/component\";\nimport {Provider} from \"@swim/component\";\nimport type {ComponentFlags} from \"@swim/component\";\nimport type {ComponentObserver} from \"@swim/component\";\nimport {Component} from \"@swim/component\";\nimport type {ValueLike} from \"@swim/structure\";\nimport {Value} from \"@swim/structure\";\nimport type {UriLike} from \"@swim/uri\";\nimport {Uri} from \"@swim/uri\";\nimport type {WarpDownlinkModel} from \"@swim/client\";\nimport {WarpDownlink} from \"@swim/client\";\nimport {EventDownlink} from \"@swim/client\";\nimport {ValueDownlink} from \"@swim/client\";\nimport {ListDownlink} from \"@swim/client\";\nimport {MapDownlink} from \"@swim/client\";\nimport {WarpRef} from \"@swim/client\";\nimport {WarpClient} from \"@swim/client\";\nimport {ModelRelation} from \"@swim/model\";\nimport {TraitRelation} from \"@swim/model\";\nimport {ControllerRelation} from \"./\"; // forward import\nimport {TraitViewRef} from \"./\"; // forward import\nimport {ExecutorService} from \"./\"; // forward import\n\n/** @public */\nexport type ControllerFlags = ComponentFlags;\n\n/** @public */\nexport interface ControllerFactory<C extends Controller = Controller> extends Creatable<C>, FromLike<C> {\n}\n\n/** @public */\nexport interface ControllerClass<C extends Controller = Controller> extends Function, ControllerFactory<C> {\n  readonly prototype: C;\n}\n\n/** @public */\nexport interface ControllerConstructor<C extends Controller = Controller> extends ControllerClass<C> {\n  new(): C;\n}\n\n/** @public */\nexport interface ControllerObserver<C extends Controller = Controller> extends ComponentObserver<C> {\n  controllerWillAttachParent?(parent: Controller, controller: C): void;\n\n  controllerDidAttachParent?(parent: Controller, controller: C): void;\n\n  controllerWillDetachParent?(parent: Controller, controller: C): void;\n\n  controllerDidDetachParent?(parent: Controller, controller: C): void;\n\n  controllerWillInsertChild?(child: Controller, target: Controller | null, controller: C): void;\n\n  controllerDidInsertChild?(child: Controller, target: Controller | null, controller: C): void;\n\n  controllerWillRemoveChild?(child: Controller, controller: C): void;\n\n  controllerDidRemoveChild?(child: Controller, controller: C): void;\n\n  controllerWillReinsertChild?(child: Controller, target: Controller | null, controller: C): void;\n\n  controllerDidReinsertChild?(child: Controller, target: Controller | null, controller: C): void;\n\n  controllerWillMount?(controller: Controller): void;\n\n  controllerDidMount?(controller: Controller): void;\n\n  controllerWillUnmount?(controller: Controller): void;\n\n  controllerDidUnmount?(controller: Controller): void;\n\n  controllerWillResolve?(controller: C): void;\n\n  controllerDidResolve?(controller: C): void;\n\n  controllerWillGenerate?(controller: C): void;\n\n  controllerDidGenerate?(controller: C): void;\n\n  controllerWillAssemble?(controller: C): void;\n\n  controllerDidAssemble?(controller: C): void;\n\n  controllerWillRevise?(controller: C): void;\n\n  controllerDidRevise?(controller: C): void;\n\n  controllerWillCompute?(controller: C): void;\n\n  controllerDidCompute?(controller: C): void;\n\n  controllerWillStartConsuming?(controller: C): void;\n\n  controllerDidStartConsuming?(controller: C): void;\n\n  controllerWillStopConsuming?(controller: C): void;\n\n  controllerDidStopConsuming?(controller: C): void;\n}\n\n/** @public */\nexport class Controller extends Component<Controller> implements Consumable, WarpRef {\n  constructor() {\n    super();\n    this.consumers = null;\n  }\n\n  /** @override */\n  declare readonly observerType?: Class<ControllerObserver>;\n\n  override get componentType(): Class<Controller> {\n    return Controller;\n  }\n\n  protected override willAttachParent(parent: Controller): void {\n    this.callObservers(\"controllerWillAttachParent\", parent, this);\n  }\n\n  protected override onAttachParent(parent: Controller): void {\n    // hook\n  }\n\n  protected override didAttachParent(parent: Controller): void {\n    this.callObservers(\"controllerDidAttachParent\", parent, this);\n  }\n\n  protected override willDetachParent(parent: Controller): void {\n    this.callObservers(\"controllerWillDetachParent\", parent, this);\n  }\n\n  protected override onDetachParent(parent: Controller): void {\n    // hook\n  }\n\n  protected override didDetachParent(parent: Controller): void {\n    this.callObservers(\"controllerDidDetachParent\", parent, this);\n  }\n\n  protected override willInsertChild(child: Controller, target: Controller | null): void {\n    super.willInsertChild(child, target);\n    this.callObservers(\"controllerWillInsertChild\", child, target, this);\n  }\n\n  protected override onInsertChild(child: Controller, target: Controller | null): void {\n    super.onInsertChild(child, target);\n  }\n\n  protected override didInsertChild(child: Controller, target: Controller | null): void {\n    this.callObservers(\"controllerDidInsertChild\", child, target, this);\n    super.didInsertChild(child, target);\n  }\n\n  /** @internal */\n  override cascadeInsert(updateFlags?: ControllerFlags): void {\n    if ((this.flags & Controller.MountedFlag) === 0) {\n      return;\n    } else if (updateFlags === void 0) {\n      updateFlags = 0;\n    }\n    updateFlags |= this.flags & Controller.UpdateMask;\n    if ((updateFlags & Controller.CompileMask) !== 0) {\n      this.cascadeCompile(updateFlags);\n    }\n  }\n\n  protected override willRemoveChild(child: Controller): void {\n    super.willRemoveChild(child);\n    this.callObservers(\"controllerWillRemoveChild\", child, this);\n  }\n\n  protected override onRemoveChild(child: Controller): void {\n    super.onRemoveChild(child);\n  }\n\n  protected override didRemoveChild(child: Controller): void {\n    this.callObservers(\"controllerDidRemoveChild\", child, this);\n    super.didRemoveChild(child);\n  }\n\n  protected override willReinsertChild(child: Controller, target: Controller | null): void {\n    super.willReinsertChild(child, target);\n    this.callObservers(\"controllerWillReinsertChild\", child, target, this);\n  }\n\n  protected override onReinsertChild(child: Controller, target: Controller | null): void {\n    super.onReinsertChild(child, target);\n  }\n\n  protected override didReinsertChild(child: Controller, target: Controller | null): void {\n    this.callObservers(\"controllerDidReinsertChild\", child, target, this);\n    super.didReinsertChild(child, target);\n  }\n\n  protected override willMount(): void {\n    super.willMount();\n    this.callObservers(\"controllerWillMount\", this);\n  }\n\n  protected override didMount(): void {\n    // subsume super\n    this.requestUpdate(this, this.flags & Controller.UpdateMask, false);\n    this.requireUpdate(this.mountFlags);\n\n    if (this.decoherent !== null && this.decoherent.length !== 0) {\n      this.requireUpdate(Controller.NeedsRevise);\n    }\n\n    this.mountFasteners();\n\n    if (this.consumers !== null && this.consumers.size !== 0) {\n      this.startConsuming();\n    }\n\n    this.callObservers(\"controllerDidMount\", this);\n    super.didMount();\n  }\n\n  protected override willUnmount(): void {\n    super.willUnmount();\n    this.callObservers(\"controllerWillUnmount\", this);\n\n    this.stopConsuming();\n  }\n\n  protected override didUnmount(): void {\n    this.callObservers(\"controllerDidUnmount\", this);\n    super.didUnmount();\n  }\n\n  override requireUpdate(updateFlags: ControllerFlags, immediate: boolean = false): void {\n    const flags = this.flags;\n    const deltaUpdateFlags = updateFlags & ~flags & Controller.UpdateMask;\n    if (deltaUpdateFlags === 0) {\n      return;\n    }\n    this.setFlags(flags | deltaUpdateFlags);\n    this.requestUpdate(this, deltaUpdateFlags, immediate);\n  }\n\n  protected needsUpdate(updateFlags: ControllerFlags, immediate: boolean): ControllerFlags {\n    return updateFlags;\n  }\n\n  requestUpdate(target: Controller, updateFlags: ControllerFlags, immediate: boolean): void {\n    updateFlags = this.needsUpdate(updateFlags, immediate);\n    let deltaUpdateFlags = this.flags & ~updateFlags & Controller.UpdateMask;\n    if ((updateFlags & Controller.CompileMask) !== 0) {\n      deltaUpdateFlags |= Controller.NeedsCompile;\n    }\n    if ((updateFlags & Controller.ExecuteMask) !== 0) {\n      deltaUpdateFlags |= Controller.NeedsExecute;\n    }\n    if (deltaUpdateFlags === 0 && !immediate) {\n      return;\n    }\n    this.setFlags(this.flags | deltaUpdateFlags);\n    const parent = this.parent;\n    if (parent !== null) {\n      parent.requestUpdate(target, updateFlags, immediate);\n    } else if (this.mounted) {\n      const updaterService = this.updater.service;\n      if (updaterService !== null) {\n        updaterService.requestUpdate(target, updateFlags, immediate);\n      }\n    }\n  }\n\n  get updating(): boolean {\n    return (this.flags & Controller.UpdatingMask) !== 0;\n  }\n\n  get compiling(): boolean {\n    return (this.flags & Controller.CompilingFlag) !== 0;\n  }\n\n  protected needsCompile(compileFlags: ControllerFlags): ControllerFlags {\n    return compileFlags;\n  }\n\n  cascadeCompile(compileFlags: ControllerFlags): void {\n    try {\n      compileFlags &= ~Controller.NeedsCompile;\n      compileFlags |= this.flags & Controller.UpdateMask;\n      compileFlags = this.needsCompile(compileFlags);\n      if ((compileFlags & Controller.CompileMask) === 0) {\n        return;\n      }\n      let cascadeFlags = compileFlags;\n      this.setFlags(this.flags & ~Controller.NeedsCompile | Controller.CompilingFlag);\n      this.willCompile(cascadeFlags);\n      if (((this.flags | compileFlags) & Controller.NeedsResolve) !== 0) {\n        cascadeFlags |= Controller.NeedsResolve;\n        this.setFlags(this.flags & ~Controller.NeedsResolve);\n        this.willResolve();\n      }\n      if (((this.flags | compileFlags) & Controller.NeedsGenerate) !== 0) {\n        cascadeFlags |= Controller.NeedsGenerate;\n        this.setFlags(this.flags & ~Controller.NeedsGenerate);\n        this.willGenerate();\n      }\n      if (((this.flags | compileFlags) & Controller.NeedsAssemble) !== 0) {\n        cascadeFlags |= Controller.NeedsAssemble;\n        this.setFlags(this.flags & ~Controller.NeedsAssemble);\n        this.willAssemble();\n      }\n\n      this.onCompile(cascadeFlags);\n      if ((cascadeFlags & Controller.NeedsResolve) !== 0) {\n        this.onResolve();\n      }\n      if ((cascadeFlags & Controller.NeedsGenerate) !== 0) {\n        this.onGenerate();\n      }\n      if ((cascadeFlags & Controller.NeedsAssemble) !== 0) {\n        this.onAssemble();\n      }\n\n      if ((cascadeFlags & Controller.CompileMask) !== 0) {\n        this.compileChildren(cascadeFlags, this.compileChild);\n      }\n\n      if ((cascadeFlags & Controller.NeedsAssemble) !== 0) {\n        this.didAssemble();\n      }\n      if ((cascadeFlags & Controller.NeedsGenerate) !== 0) {\n        this.didGenerate();\n      }\n      if ((cascadeFlags & Controller.NeedsResolve) !== 0) {\n        this.didResolve();\n      }\n      this.didCompile(cascadeFlags);\n    } finally {\n      this.setFlags(this.flags & ~Controller.CompilingFlag);\n    }\n  }\n\n  protected willCompile(compileFlags: ControllerFlags): void {\n    // hook\n  }\n\n  protected onCompile(compileFlags: ControllerFlags): void {\n    // hook\n  }\n\n  protected didCompile(compileFlags: ControllerFlags): void {\n    // hook\n  }\n\n  protected willResolve(): void {\n    this.callObservers(\"controllerWillResolve\", this);\n  }\n\n  protected onResolve(): void {\n    // hook\n  }\n\n  protected didResolve(): void {\n    this.callObservers(\"controllerDidResolve\", this);\n  }\n\n  protected willGenerate(): void {\n    this.callObservers(\"controllerWillGenerate\", this);\n  }\n\n  protected onGenerate(): void {\n    // hook\n  }\n\n  protected didGenerate(): void {\n    this.callObservers(\"controllerDidGenerate\", this);\n  }\n\n  protected willAssemble(): void {\n    this.callObservers(\"controllerWillAssemble\", this);\n  }\n\n  protected onAssemble(): void {\n    // hook\n  }\n\n  protected didAssemble(): void {\n    this.callObservers(\"controllerDidAssemble\", this);\n  }\n\n  protected compileChildren(compileFlags: ControllerFlags, compileChild: (this: this, child: Controller, compileFlags: ControllerFlags) => void): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      compileChild.call(this, child, compileFlags);\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent compile pass\");\n      }\n      child = next;\n    }\n  }\n\n  protected compileChild(child: Controller, compileFlags: ControllerFlags): void {\n    child.cascadeCompile(compileFlags);\n  }\n\n  get executing(): boolean {\n    return (this.flags & Controller.ExecutingFlag) !== 0;\n  }\n\n  protected needsExecute(executeFlags: ControllerFlags): ControllerFlags {\n    return executeFlags;\n  }\n\n  cascadeExecute(executeFlags: ControllerFlags): void {\n    try {\n      executeFlags &= ~Controller.NeedsExecute;\n      executeFlags |= this.flags & Controller.UpdateMask;\n      executeFlags = this.needsExecute(executeFlags);\n      if ((executeFlags & Controller.ExecuteMask) === 0) {\n        return;\n      }\n      let cascadeFlags = executeFlags;\n      this.setFlags(this.flags & ~Controller.NeedsExecute | Controller.ExecutingFlag);\n      this.willExecute(cascadeFlags);\n      if (((this.flags | executeFlags) & Controller.NeedsRevise) !== 0) {\n        cascadeFlags |= Controller.NeedsRevise;\n        this.setFlags(this.flags & ~Controller.NeedsRevise);\n        this.willRevise();\n      }\n      if (((this.flags | executeFlags) & Controller.NeedsCompute) !== 0) {\n        cascadeFlags |= Controller.NeedsCompute;\n        this.setFlags(this.flags & ~Controller.NeedsCompute);\n        this.willCompute();\n      }\n\n      this.onExecute(cascadeFlags);\n      if ((cascadeFlags & Controller.NeedsRevise) !== 0) {\n        this.onRevise();\n      }\n      if ((cascadeFlags & Controller.NeedsCompute) !== 0) {\n        this.onCompute();\n      }\n\n      if ((cascadeFlags & Controller.ExecuteMask) !== 0) {\n        this.executeChildren(cascadeFlags, this.executeChild);\n      }\n\n      if ((cascadeFlags & Controller.NeedsCompute) !== 0) {\n        this.didCompute();\n      }\n      if ((cascadeFlags & Controller.NeedsRevise) !== 0) {\n        this.didRevise();\n      }\n      this.didExecute(cascadeFlags);\n    } finally {\n      this.setFlags(this.flags & ~Controller.ExecutingFlag);\n    }\n  }\n\n  protected willExecute(executeFlags: ControllerFlags): void {\n    // hook\n  }\n\n  protected onExecute(executeFlags: ControllerFlags): void {\n    // hook\n  }\n\n  protected didExecute(executeFlags: ControllerFlags): void {\n    // hook\n  }\n\n  protected willRevise(): void {\n    this.callObservers(\"controllerWillRevise\", this);\n  }\n\n  protected onRevise(): void {\n    this.recohereFasteners(this.updateTime);\n  }\n\n  protected didRevise(): void {\n    this.callObservers(\"controllerDidRevise\", this);\n  }\n\n  protected willCompute(): void {\n    this.callObservers(\"controllerWillCompute\", this);\n  }\n\n  protected onCompute(): void {\n    // hook\n  }\n\n  protected didCompute(): void {\n    this.callObservers(\"controllerDidCompute\", this);\n  }\n\n  protected executeChildren(executeFlags: ControllerFlags, executeChild: (this: this, child: Controller, executeFlags: ControllerFlags) => void): void {\n    let child = this.firstChild;\n    while (child !== null) {\n      const next = child.nextSibling;\n      executeChild.call(this, child, executeFlags);\n      if (next !== null && next.parent !== this) {\n        throw new Error(\"inconsistent execute pass\");\n      }\n      child = next;\n    }\n  }\n\n  /** @internal */\n  protected executeChild(child: Controller, executeFlags: ControllerFlags): void {\n    child.cascadeExecute(executeFlags);\n  }\n\n  protected override bindFastener(fastener: Fastener): void {\n    super.bindFastener(fastener);\n    if (this.consuming) {\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ControllerRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitViewRef && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected override bindChildFastener(fastener: Fastener, child: Controller, target: Controller | null): void {\n    super.bindChildFastener(fastener, child, target);\n    if (fastener instanceof ControllerRelation) {\n      fastener.bindController(child, target);\n    }\n  }\n\n  /** @internal */\n  protected override unbindChildFastener(fastener: Fastener, child: Controller): void {\n    if (fastener instanceof ControllerRelation) {\n      fastener.unbindController(child);\n    }\n    super.unbindChildFastener(fastener, child);\n  }\n\n  /** @internal */\n  protected override enqueueFastener(fastener: Fastener): void {\n    super.enqueueFastener(fastener);\n    this.requireUpdate(Controller.NeedsRevise);\n  }\n\n  /** @internal */\n  override recohereFasteners(t?: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent === null || decoherent.length === 0) {\n      return;\n    } else if (t === void 0) {\n      t = performance.now();\n    }\n    let coherentDownlinkProps = false;\n    (this as Mutable<this>).coherentTime = t;\n    (this as Mutable<this>).decoherent = null;\n    (this as Mutable<this>).recohering = decoherent;\n    try {\n      for (let i = 0; i < decoherent.length; i += 1) {\n        const fastener = decoherent[i]!;\n        if (fastener instanceof WarpDownlink && !coherentDownlinkProps) {\n          coherentDownlinkProps = true;\n          this.hostUri.recohere(t);\n          this.nodeUri.recohere(t);\n          this.laneUri.recohere(t);\n        }\n        fastener.recohere(t);\n      }\n    } finally {\n      (this as Mutable<this>).recohering = null;\n    }\n  }\n\n  /** @internal */\n  readonly consumers: ReadonlySet<Consumer> | null;\n\n  /** @override */\n  consume(consumer: Consumer): void {\n    let consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null) {\n      consumers = new Set<Consumer>();\n      (this as Mutable<this>).consumers = consumers;\n    } else if (consumers.has(consumer)) {\n      return;\n    }\n    this.willConsume(consumer);\n    consumers.add(consumer);\n    this.onConsume(consumer);\n    this.didConsume(consumer);\n    if (consumers.size === 1 && this.mounted) {\n      this.startConsuming();\n    }\n  }\n\n  protected willConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected onConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected didConsume(consumer: Consumer): void {\n    // hook\n  }\n\n  /** @override */\n  unconsume(consumer: Consumer): void {\n    const consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null || !consumers.has(consumer)) {\n      return;\n    }\n    this.willUnconsume(consumer);\n    consumers.delete(consumer);\n    this.onUnconsume(consumer);\n    this.didUnconsume(consumer);\n    if (consumers.size === 0) {\n      this.stopConsuming();\n    }\n  }\n\n  protected willUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected onUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  protected didUnconsume(consumer: Consumer): void {\n    // hook\n  }\n\n  get consuming(): boolean {\n    return (this.flags & Controller.ConsumingFlag) !== 0;\n  }\n\n  get startConsumingFlags(): ControllerFlags {\n    return (this.constructor as typeof Controller).StartConsumingFlags;\n  }\n\n  protected startConsuming(): void {\n    if ((this.flags & Controller.ConsumingFlag) !== 0) {\n      return;\n    }\n    this.willStartConsuming();\n    this.setFlags(this.flags | Controller.ConsumingFlag);\n    this.onStartConsuming();\n    this.didStartConsuming();\n  }\n\n  protected willStartConsuming(): void {\n    this.callObservers(\"controllerWillStartConsuming\", this);\n  }\n\n  protected onStartConsuming(): void {\n    this.requireUpdate(this.startConsumingFlags);\n    this.startConsumingFasteners();\n  }\n\n  protected didStartConsuming(): void {\n    this.callObservers(\"controllerDidStartConsuming\", this);\n  }\n\n  get stopConsumingFlags(): ControllerFlags {\n    return (this.constructor as typeof Controller).StopConsumingFlags;\n  }\n\n  protected stopConsuming(): void {\n    if ((this.flags & Controller.ConsumingFlag) === 0) {\n      return;\n    }\n    this.willStopConsuming();\n    this.setFlags(this.flags & ~Controller.ConsumingFlag);\n    this.onStopConsuming();\n    this.didStopConsuming();\n  }\n\n  protected willStopConsuming(): void {\n    this.callObservers(\"controllerWillStopConsuming\", this);\n  }\n\n  protected onStopConsuming(): void {\n    this.requireUpdate(this.stopConsumingFlags);\n    this.stopConsumingFasteners();\n  }\n\n  protected didStopConsuming(): void {\n    this.callObservers(\"controllerDidStopConsuming\", this);\n  }\n\n  /** @internal */\n  protected startConsumingFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ControllerRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitViewRef && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.consume(this);\n      }\n    }\n  }\n\n  /** @internal */\n  protected stopConsumingFasteners(): void {\n    const metaclass = FastenerContext.getMetaclass(this);\n    if (metaclass === null) {\n      return;\n    }\n    const fastenerSlots = metaclass.slots;\n    for (let i = 0; i < fastenerSlots.length; i += 1) {\n      const fastener = this[fastenerSlots[i]!];\n      if (fastener instanceof WarpDownlink && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof ControllerRelation && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof TraitViewRef && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof TraitRelation && fastener.consumed === true) {\n        fastener.unconsume(this);\n      } else if (fastener instanceof ModelRelation && fastener.consumed === true) {\n        fastener.unconsume(this);\n      }\n    }\n  }\n\n  get updateTime(): number {\n    return this.updater.getService().updateTime;\n  }\n\n  @Provider({\n    get serviceType(): typeof ExecutorService { // avoid static forward reference\n      return ExecutorService;\n    },\n    mountRootService(service: ExecutorService): void {\n      super.mountRootService(service);\n      service.roots.addController(this.owner);\n    },\n    unmountRootService(service: ExecutorService): void {\n      super.unmountRootService(service);\n      service.roots.removeController(this.owner);\n    },\n  })\n  readonly updater!: Provider<this, ExecutorService>;\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get updateFlags(): ControllerFlags {\n      return Controller.NeedsRevise;\n    },\n  })\n  get hostUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get updateFlags(): ControllerFlags {\n      return Controller.NeedsRevise;\n    },\n  })\n  get nodeUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  @Property({\n    valueType: Uri,\n    value: null,\n    inherits: true,\n    get updateFlags(): ControllerFlags {\n      return Controller.NeedsRevise;\n    },\n  })\n  get laneUri(): Property<this, Uri | null> {\n    return Property.getter();\n  }\n\n  /** @override */\n  downlink(template?: FastenerTemplate<EventDownlink<WarpRef>>): EventDownlink<WarpRef> {\n    let downlinkClass = EventDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlink\", template) as typeof EventDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkValue<V = Value>(template?: FastenerTemplate<ValueDownlink<WarpRef, V>>): ValueDownlink<WarpRef, V> {\n    let downlinkClass = ValueDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkValue\", template) as typeof ValueDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkList<V = Value>(template?: FastenerTemplate<ListDownlink<WarpRef, V>>): ListDownlink<WarpRef, V> {\n    let downlinkClass = ListDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkList\", template) as typeof ListDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  downlinkMap<K = Value, V = Value>(template?: FastenerTemplate<MapDownlink<WarpRef, K, V>>): MapDownlink<WarpRef, K, V> {\n    let downlinkClass = MapDownlink;\n    if (template !== void 0) {\n      downlinkClass = downlinkClass.define(\"downlinkMap\", template) as typeof MapDownlink;\n    }\n    return downlinkClass.create(this);\n  }\n\n  /** @override */\n  command(hostUri: UriLike, nodeUri: UriLike, laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(nodeUri: UriLike, laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(laneUri: UriLike, body: ValueLike): void;\n  /** @override */\n  command(body: ValueLike): void;\n  command(hostUri: UriLike | ValueLike, nodeUri?: UriLike | ValueLike, laneUri?: UriLike | ValueLike, body?: ValueLike): void {\n    if (nodeUri === void 0) {\n      body = Value.fromLike(hostUri as ValueLike);\n      laneUri = this.laneUri.getValue();\n      nodeUri = this.nodeUri.getValue();\n      hostUri = this.hostUri.value;\n    } else if (laneUri === void 0) {\n      body = Value.fromLike(nodeUri as ValueLike);\n      laneUri = Uri.fromLike(hostUri as UriLike);\n      nodeUri = this.nodeUri.getValue();\n      hostUri = this.hostUri.value;\n    } else if (body === void 0) {\n      body = Value.fromLike(laneUri as ValueLike);\n      laneUri = Uri.fromLike(nodeUri as UriLike);\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = this.hostUri.value;\n    } else {\n      body = Value.fromLike(body);\n      laneUri = Uri.fromLike(laneUri as UriLike);\n      nodeUri = Uri.fromLike(nodeUri as UriLike);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    if (hostUri === null) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    const warpRef = this.warpRef.value;\n    warpRef.command(hostUri, nodeUri, laneUri, body);\n  }\n\n  /** @override */\n  authenticate(hostUri: UriLike, credentials: ValueLike): void;\n  /** @override */\n  authenticate(credentials: ValueLike): void;\n  authenticate(hostUri: UriLike | ValueLike, credentials?: ValueLike): void {\n    if (credentials === void 0) {\n      credentials = Value.fromLike(hostUri as ValueLike);\n      hostUri = this.hostUri.getValue();\n    } else {\n      credentials = Value.fromLike(credentials);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const warpRef = this.warpRef.value;\n    warpRef.authenticate(hostUri, credentials);\n  }\n\n  /** @override */\n  hostRef(hostUri: UriLike): WarpRef {\n    hostUri = Uri.fromLike(hostUri);\n    const childRef = new Controller();\n    childRef.hostUri.set(hostUri);\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @override */\n  nodeRef(hostUri: UriLike, nodeUri: UriLike): WarpRef;\n  /** @override */\n  nodeRef(nodeUri: UriLike): WarpRef;\n  nodeRef(hostUri: UriLike | undefined, nodeUri?: UriLike): WarpRef {\n    if (nodeUri === void 0) {\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = nodeUri.endpoint();\n      if (hostUri.isDefined()) {\n        nodeUri = hostUri.unresolve(nodeUri);\n      } else {\n        hostUri = void 0;\n      }\n    } else {\n      nodeUri = Uri.fromLike(nodeUri);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const childRef = new Controller();\n    if (hostUri !== void 0) {\n      childRef.hostUri.set(hostUri);\n    }\n    if (nodeUri !== void 0) {\n      childRef.nodeUri.set(nodeUri);\n    }\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @override */\n  laneRef(hostUri: UriLike, nodeUri: UriLike, laneUri: UriLike): WarpRef;\n  /** @override */\n  laneRef(nodeUri: UriLike, laneUri: UriLike): WarpRef;\n  /** @override */\n  laneRef(laneUri: UriLike): WarpRef;\n  laneRef(hostUri: UriLike | undefined, nodeUri?: UriLike, laneUri?: UriLike): WarpRef {\n    if (nodeUri === void 0) {\n      laneUri = Uri.fromLike(hostUri as UriLike);\n      nodeUri = void 0;\n      hostUri = void 0;\n    } else if (laneUri === void 0) {\n      laneUri = Uri.fromLike(nodeUri);\n      nodeUri = Uri.fromLike(hostUri as UriLike);\n      hostUri = nodeUri.endpoint();\n      if (hostUri.isDefined()) {\n        nodeUri = hostUri.unresolve(nodeUri);\n      } else {\n        hostUri = void 0;\n      }\n    } else {\n      laneUri = Uri.fromLike(laneUri);\n      nodeUri = Uri.fromLike(nodeUri);\n      hostUri = Uri.fromLike(hostUri as UriLike);\n    }\n    const childRef = new Controller();\n    if (hostUri !== void 0) {\n      childRef.hostUri.set(hostUri);\n    }\n    if (nodeUri !== void 0) {\n      childRef.nodeUri.set(nodeUri);\n    }\n    if (laneUri !== void 0) {\n      childRef.laneUri.set(laneUri);\n    }\n    this.appendChild(childRef);\n    return childRef;\n  }\n\n  /** @internal @override */\n  getDownlink(hostUri: Uri, nodeUri: Uri, laneUri: Uri): WarpDownlinkModel | null {\n    const warpRef = this.warpRef.value;\n    return warpRef.getDownlink(hostUri, nodeUri, laneUri);\n  }\n\n  /** @internal @override */\n  openDownlink(downlink: WarpDownlinkModel): void {\n    const warpRef = this.warpRef.value;\n    warpRef.openDownlink(downlink);\n  }\n\n  @Property({\n    valueType: WarpRef,\n    inherits: true,\n    get updateFlags(): ControllerFlags {\n      return Controller.NeedsRevise;\n    },\n    initValue(): WarpRef {\n      return WarpClient.global();\n    },\n    equalValues(newValue: WarpRef, oldValue: WarpRef): boolean {\n      return newValue === oldValue;\n    },\n  })\n  get warpRef(): Property<this, WarpRef> {\n    return Property.getter();\n  }\n\n  /** @internal */\n  static override uid: () => string = (function () {\n    let nextId = 1;\n    return function uid(): string {\n      const id = ~~nextId;\n      nextId += 1;\n      return \"controller\" + id;\n    };\n  })();\n\n  /** @internal */\n  static override readonly MountedFlag: ControllerFlags = Component.MountedFlag;\n  /** @internal */\n  static override readonly InsertingFlag: ControllerFlags = Component.InsertingFlag;\n  /** @internal */\n  static override readonly RemovingFlag: ControllerFlags = Component.RemovingFlag;\n  /** @internal */\n  static readonly CompilingFlag: ControllerFlags = 1 << (Component.FlagShift + 0);\n  /** @internal */\n  static readonly ExecutingFlag: ControllerFlags = 1 << (Component.FlagShift + 1);\n  /** @internal */\n  static readonly ConsumingFlag: ControllerFlags = 1 << (Component.FlagShift + 2);\n  /** @internal */\n  static readonly UpdatingMask: ControllerFlags = this.CompilingFlag\n                                                | this.ExecutingFlag;\n  /** @internal */\n  static readonly StatusMask: ControllerFlags = this.MountedFlag\n                                              | this.InsertingFlag\n                                              | this.RemovingFlag\n                                              | this.CompilingFlag\n                                              | this.ExecutingFlag;\n\n  static readonly NeedsCompile: ControllerFlags = 1 << (Component.FlagShift + 3);\n  static readonly NeedsResolve: ControllerFlags = 1 << (Component.FlagShift + 4);\n  static readonly NeedsGenerate: ControllerFlags = 1 << (Component.FlagShift + 5);\n  static readonly NeedsAssemble: ControllerFlags = 1 << (Component.FlagShift + 6);\n  /** @internal */\n  static readonly CompileMask: ControllerFlags = this.NeedsCompile\n                                               | this.NeedsResolve\n                                               | this.NeedsGenerate\n                                               | this.NeedsAssemble;\n\n  static readonly NeedsExecute: ControllerFlags = 1 << (Component.FlagShift + 7);\n  static readonly NeedsRevise: ControllerFlags = 1 << (Component.FlagShift + 8);\n  static readonly NeedsCompute: ControllerFlags = 1 << (Component.FlagShift + 9);\n  /** @internal */\n  static readonly ExecuteMask: ControllerFlags = this.NeedsExecute\n                                               | this.NeedsRevise\n                                               | this.NeedsCompute;\n\n  /** @internal */\n  static readonly UpdateMask: ControllerFlags = this.CompileMask\n                                              | this.ExecuteMask;\n\n  /** @internal */\n  static override readonly FlagShift: number = Component.FlagShift + 10;\n  /** @internal */\n  static override readonly FlagMask: ControllerFlags = (1 << this.FlagShift) - 1;\n\n  static override readonly MountFlags: ControllerFlags = 0;\n  static override readonly InsertChildFlags: ControllerFlags = 0;\n  static override readonly RemoveChildFlags: ControllerFlags = 0;\n  static override readonly ReinsertChildFlags: ControllerFlags = 0;\n  static readonly StartConsumingFlags: ControllerFlags = 0;\n  static readonly StopConsumingFlags: ControllerFlags = 0;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Consumable} from \"@swim/util\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {ControllerFactory} from \"./Controller\";\nimport {Controller} from \"./Controller\";\n\n/** @public */\nexport interface ControllerRelationDescriptor<R, C extends Controller> extends FastenerDescriptor<R> {\n  extends?: Proto<ControllerRelation<any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface ControllerRelationClass<F extends ControllerRelation<any, any, any> = ControllerRelation<any, any, any>> extends FastenerClass<F> {\n  /** @internal */\n  readonly ConsumingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ControllerRelation<R = any, C extends Controller = Controller, I extends any[] = [C | null]> extends Fastener<R, C | null, I>, Consumable {\n  /** @override */\n  get descriptorType(): Proto<ControllerRelationDescriptor<R, C>>;\n\n  /** @override */\n  get fastenerType(): Proto<ControllerRelation<any, any, any>>;\n\n  get consumed(): boolean;\n\n  get controllerType(): ControllerFactory<C> | null;\n\n  get observes(): boolean;\n\n  /** @override */\n  get parent(): ControllerRelation<any, C, any> | null;\n\n  /** @internal */\n  readonly outlets: ReadonlySet<Fastener<any, any, any>> | null;\n\n  /** @internal @override */\n  attachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @override */\n  detachOutlet(outlet: Fastener<any, any, any>): void;\n\n  /** @internal @protected */\n  decohereOutlets(): void;\n\n  /** @protected */\n  initController(controller: C): void;\n\n  /** @protected */\n  willAttachController(controller: C, target: Controller | null): void;\n\n  /** @protected */\n  onAttachController(controller: C, target: Controller | null): void;\n\n  /** @protected */\n  didAttachController(controller: C, target: Controller | null): void;\n\n  /** @protected */\n  deinitController(controller: C): void;\n\n  /** @protected */\n  willDetachController(controller: C): void;\n\n  /** @protected */\n  onDetachController(controller: C): void;\n\n  /** @protected */\n  didDetachController(controller: C): void;\n\n  get parentController(): Controller | null;\n\n  /** @protected */\n  insertChild(parent: Controller, child: C, target: Controller | null, key: string | undefined): void;\n\n  /** @internal */\n  bindController(controller: Controller, target: Controller | null): void;\n\n  /** @internal */\n  unbindController(controller: Controller): void;\n\n  detectController(controller: Controller): C | null;\n\n  createController(): C;\n\n  /** @protected */\n  fromLike(value: C | LikeType<C>): C;\n\n  /** @internal */\n  readonly consumers: ReadonlySet<Consumer> | null;\n\n  /** @override */\n  consume(consumer: Consumer): void\n\n  /** @protected */\n  willConsume(consumer: Consumer): void;\n\n  /** @protected */\n  onConsume(consumer: Consumer): void;\n\n  /** @protected */\n  didConsume(consumer: Consumer): void;\n\n  /** @override */\n  unconsume(consumer: Consumer): void\n\n  /** @protected */\n  willUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  onUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  didUnconsume(consumer: Consumer): void;\n\n  get consuming(): boolean;\n\n  /** @internal */\n  startConsuming(): void;\n\n  /** @protected */\n  willStartConsuming(): void;\n\n  /** @protected */\n  onStartConsuming(): void;\n\n  /** @protected */\n  didStartConsuming(): void;\n\n  /** @internal */\n  stopConsuming(): void;\n\n  /** @protected */\n  willStopConsuming(): void;\n\n  /** @protected */\n  onStopConsuming(): void;\n\n  /** @protected */\n  didStopConsuming(): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n}\n\n/** @public */\nexport const ControllerRelation = (<R, C extends Controller, I extends any[], F extends ControllerRelation<any, any, any>>() => Fastener.extend<ControllerRelation<R, C, I>, ControllerRelationClass<F>>(\"ControllerRelation\", {\n  get fastenerType(): Proto<ControllerRelation<any, any, any>> {\n    return ControllerRelation;\n  },\n\n  consumed: false,\n\n  controllerType: null,\n\n  observes: false,\n\n  attachOutlet(outlet: Fastener<any, any, any>): void {\n    let outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      outlets = new Set<Fastener<any, any, any>>();\n      (this as Mutable<typeof this>).outlets = outlets;\n    }\n    outlets.add(outlet);\n  },\n\n  detachOutlet(outlet: Fastener<any, any, any>): void {\n    const outlets = this.outlets as Set<Fastener<any, any, any>> | null;\n    if (outlets === null) {\n      return;\n    }\n    outlets.delete(outlet);\n  },\n\n  decohereOutlets(): void {\n    const outlets = this.outlets;\n    if (outlets === null) {\n      return;\n    }\n    for (const outlet of outlets) {\n      outlet.decohere(this);\n    }\n  },\n\n  initController(controller: C): void {\n    // hook\n  },\n\n  willAttachController(controller: C, target: Controller | null): void {\n    // hook\n  },\n\n  onAttachController(controller: C, target: Controller | null): void {\n    if (this.observes === true) {\n      controller.observe(this as Observes<C>);\n    }\n    if ((this.flags & ControllerRelation.ConsumingFlag) !== 0) {\n      controller.consume(this);\n    }\n  },\n\n  didAttachController(controller: C, target: Controller | null): void {\n    // hook\n  },\n\n  deinitController(controller: C): void {\n    // hook\n  },\n\n  willDetachController(controller: C): void {\n    // hook\n  },\n\n  onDetachController(controller: C): void {\n    if ((this.flags & ControllerRelation.ConsumingFlag) !== 0) {\n      controller.unconsume(this);\n    }\n    if (this.observes === true) {\n      controller.unobserve(this as Observes<C>);\n    }\n  },\n\n  didDetachController(controller: C): void {\n    // hook\n  },\n\n  get parentController(): Controller | null {\n    const owner = this.owner;\n    return owner instanceof Controller ? owner : null;\n  },\n\n  insertChild(parent: Controller, child: C, target: Controller | null, key: string | undefined): void {\n    parent.insertChild(child, target, key);\n  },\n\n  bindController(controller: Controller, target: Controller | null): void {\n    // hook\n  },\n\n  unbindController(controller: Controller): void {\n    // hook\n  },\n\n  detectController(controller: Controller): C | null {\n    return null;\n  },\n\n  createController(): C {\n    let controller: C | undefined;\n    const controllerType = this.controllerType;\n    if (controllerType !== null) {\n      controller = controllerType.create();\n    }\n    if (controller === void 0 || controller === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"controller\";\n      throw new Error(message);\n    }\n    return controller;\n  },\n\n  fromLike(value: C | LikeType<C>): C {\n    const controllerType = this.controllerType;\n    if (controllerType !== null) {\n      return controllerType.fromLike(value);\n    }\n    return Controller.fromLike(value) as C;\n  },\n\n  consume(consumer: Consumer): void {\n    let consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null) {\n      consumers = new Set<Consumer>();\n      (this as Mutable<typeof this>).consumers = consumers;\n    } else if (consumers.has(consumer)) {\n      return;\n    }\n    this.willConsume(consumer);\n    consumers.add(consumer);\n    this.onConsume(consumer);\n    this.didConsume(consumer);\n    if (consumers.size === 1 && this.mounted) {\n      this.startConsuming();\n    }\n  },\n\n  willConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  unconsume(consumer: Consumer): void {\n    const consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null || !consumers.has(consumer)) {\n      return;\n    }\n    this.willUnconsume(consumer);\n    consumers.delete(consumer);\n    this.onUnconsume(consumer);\n    this.didUnconsume(consumer);\n    if (consumers.size === 0) {\n      this.stopConsuming();\n    }\n  },\n\n  willUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  get consuming(): boolean {\n    return (this.flags & ControllerRelation.ConsumingFlag) !== 0;\n  },\n\n  startConsuming(): void {\n    if ((this.flags & ControllerRelation.ConsumingFlag) !== 0) {\n      return;\n    }\n    this.willStartConsuming();\n    this.setFlags(this.flags | ControllerRelation.ConsumingFlag);\n    this.onStartConsuming();\n    this.didStartConsuming();\n  },\n\n  willStartConsuming(): void {\n    // hook\n  },\n\n  onStartConsuming(): void {\n    // hook\n  },\n\n  didStartConsuming(): void {\n    // hook\n  },\n\n  stopConsuming(): void {\n    if ((this.flags & ControllerRelation.ConsumingFlag) === 0) {\n      return;\n    }\n    this.willStopConsuming();\n    this.setFlags(this.flags & ~ControllerRelation.ConsumingFlag);\n    this.onStopConsuming();\n    this.didStopConsuming();\n  },\n\n  willStopConsuming(): void {\n    // hook\n  },\n\n  onStopConsuming(): void {\n    // hook\n  },\n\n  didStopConsuming(): void {\n    // hook\n  },\n\n  onMount(): void {\n    super.onMount();\n    if (this.consumers !== null && this.consumers.size !== 0) {\n      this.startConsuming();\n    }\n  },\n\n  onUnmount(): void {\n    super.onUnmount();\n    this.stopConsuming();\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).outlets = null;\n    (fastener as Mutable<typeof fastener>).consumers = null;\n    return fastener;\n  },\n\n  ConsumingFlag: 1 << (Fastener.FlagShift + 0),\n\n  FlagShift: Fastener.FlagShift + 1,\n  FlagMask: (1 << (Fastener.FlagShift + 1)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport {FastenerContext} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerRelationDescriptor} from \"./ControllerRelation\";\nimport type {ControllerRelationClass} from \"./ControllerRelation\";\nimport {ControllerRelation} from \"./ControllerRelation\";\n\n/** @public */\nexport interface ControllerRefDescriptor<R, C extends Controller> extends ControllerRelationDescriptor<R, C> {\n  extends?: Proto<ControllerRef<any, any, any>> | boolean | null;\n  controllerKey?: string | boolean;\n}\n\n/** @public */\nexport interface ControllerRefClass<F extends ControllerRef<any, any, any> = ControllerRef<any, any, any>> extends ControllerRelationClass<F> {\n  tryController<R, K extends keyof R, F extends R[K] = R[K]>(owner: R, fastenerName: K): (F extends {readonly controller: infer C | null} ? C | null : never) | null;\n}\n\n/** @public */\nexport interface ControllerRef<R = any, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerRelation<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<ControllerRefDescriptor<R, C>>;\n\n  /** @override */\n  get fastenerType(): Proto<ControllerRef<any, any, any>>;\n\n  /** @override */\n  get parent(): ControllerRef<any, C, any> | null;\n\n  get inletController(): C | null;\n\n  getInletController(): C;\n\n  get controllerKey(): string | undefined;\n\n  get(): C | null;\n\n  set(controller: C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  setIntrinsic(controller: C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  readonly controller: C | null;\n\n  getController(): C;\n\n  setController(controller: C | LikeType<C> | null, target?: Controller | null, key?: string): C | null;\n\n  attachController(controller?: C | LikeType<C> | null, target?: Controller | null): C;\n\n  detachController(): C | null;\n\n  insertController(parent?: Controller | null, controller?: C | LikeType<C>, target?: Controller | null, key?: string): C;\n\n  removeController(): C | null;\n\n  deleteController(): C | null;\n\n  /** @internal @override */\n  bindController(controller: Controller, target: Controller | null): void;\n\n  /** @internal @override */\n  unbindController(controller: Controller): void;\n\n  /** @override */\n  detectController(controller: Controller): C | null;\n\n  /** @protected @override */\n  onStartConsuming(): void;\n\n  /** @protected @override */\n  onStopConsuming(): void;\n\n  /** @override */\n  recohere(t: number): void;\n}\n\n/** @public */\nexport const ControllerRef = (<R, C extends Controller, I extends any[], F extends ControllerRef<any, any, any>>() => ControllerRelation.extend<ControllerRef<R, C, I>, ControllerRefClass<F>>(\"ControllerRef\", {\n  get fastenerType(): Proto<ControllerRef<any, any, any>> {\n    return ControllerRef;\n  },\n\n  get inletController(): C | null {\n    const inlet = this.inlet;\n    return inlet instanceof ControllerRef ? inlet.controller : null;\n  },\n\n  getInletController(): C {\n    const inletController = this.inletController;\n    if (inletController === void 0 || inletController === null) {\n      let message = inletController + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"inlet controller\";\n      throw new TypeError(message);\n    }\n    return inletController;\n  },\n\n  get(): C | null {\n    return this.controller;\n  },\n\n  set(controller: C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (controller instanceof Fastener) {\n      this.bindInlet(controller);\n    } else {\n      this.setController(controller);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(controller: C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (controller instanceof Fastener) {\n      this.bindInlet(controller);\n    } else {\n      this.setController(controller);\n    }\n    return this.owner;\n  },\n\n  controllerKey: void 0,\n\n  getController(): C {\n    const controller = this.controller;\n    if (controller === null) {\n      let message = controller + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"controller\";\n      throw new TypeError(message);\n    }\n    return controller;\n  },\n\n  setController(newController: C  | null, target?: Controller | null, key?: string): C | null {\n    if (newController !== null) {\n      newController = this.fromLike(newController);\n    }\n    let oldController = this.controller;\n    if (oldController === newController) {\n      this.setCoherent(true);\n      return oldController;\n    } else if (target === void 0) {\n      target = null;\n    }\n    let parent: Controller | null;\n    if (this.binds && (parent = this.parentController, parent !== null)) {\n      if (oldController !== null && oldController.parent === parent) {\n        if (target === null) {\n          target = oldController.nextSibling;\n        }\n        oldController.remove();\n      }\n      if (newController !== null) {\n        if (key === void 0) {\n          key = this.controllerKey;\n        }\n        this.insertChild(parent, newController, target, key);\n      }\n      oldController = this.controller;\n      if (oldController === newController) {\n        return oldController;\n      }\n    }\n    if (oldController !== null) {\n      (this as Mutable<typeof this>).controller = null;\n      this.willDetachController(oldController);\n      this.onDetachController(oldController);\n      this.deinitController(oldController);\n      this.didDetachController(oldController);\n    }\n    if (newController !== null) {\n      (this as Mutable<typeof this>).controller = newController;\n      this.willAttachController(newController, target);\n      this.onAttachController(newController, target);\n      this.initController(newController);\n      this.didAttachController(newController, target);\n    }\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldController;\n  },\n\n  attachController(newController?: C | LikeType<C> | null, target?: Controller | null): C {\n    const oldController = this.controller;\n    if (newController !== void 0 && newController !== null) {\n      newController = this.fromLike(newController);\n    } else if (oldController === null) {\n      newController = this.createController();\n    } else {\n      newController = oldController;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (oldController === newController) {\n      return newController;\n    } else if (oldController !== null) {\n      (this as Mutable<typeof this>).controller = null;\n      this.willDetachController(oldController);\n      this.onDetachController(oldController);\n      this.deinitController(oldController);\n      this.didDetachController(oldController);\n    }\n    (this as Mutable<typeof this>).controller = newController;\n    this.willAttachController(newController, target);\n    this.onAttachController(newController, target);\n    this.initController(newController);\n    this.didAttachController(newController, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newController;\n  },\n\n  detachController(): C | null {\n    const oldController = this.controller;\n    if (oldController === null) {\n      return null;\n    }\n    (this as Mutable<typeof this>).controller = null;\n    this.willDetachController(oldController);\n    this.onDetachController(oldController);\n    this.deinitController(oldController);\n    this.didDetachController(oldController);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldController;\n  },\n\n  insertController(parent?: Controller | null, newController?: C | LikeType<C>, target?: Controller | null, key?: string): C {\n    let oldController = this.controller;\n    if (newController !== void 0 && newController !== null) {\n      newController = this.fromLike(newController);\n    } else if (oldController === null) {\n      newController = this.createController();\n    } else {\n      newController = oldController;\n    }\n    if (parent === void 0) {\n      parent = null;\n    }\n    if (!this.binds && oldController === newController && newController.parent !== null && parent === null && key === void 0) {\n      return newController;\n    }\n    if (parent === null) {\n      parent = this.parentController;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.controllerKey;\n    }\n    if (parent !== null && (newController.parent !== parent || newController.key !== key)) {\n      this.insertChild(parent, newController, target, key);\n    }\n    oldController = this.controller;\n    if (oldController === newController) {\n      return newController;\n    } else if (oldController !== null) {\n      (this as Mutable<typeof this>).controller = null;\n      this.willDetachController(oldController);\n      this.onDetachController(oldController);\n      this.deinitController(oldController);\n      this.didDetachController(oldController);\n      if (this.binds && parent !== null && oldController.parent === parent) {\n        oldController.remove();\n      }\n    }\n    (this as Mutable<typeof this>).controller = newController;\n    this.willAttachController(newController, target);\n    this.onAttachController(newController, target);\n    this.initController(newController);\n    this.didAttachController(newController, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newController;\n  },\n\n  removeController(): C | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    controller.remove();\n    return controller;\n  },\n\n  deleteController(): C | null {\n    const controller = this.detachController();\n    if (controller === null) {\n      return null;\n    }\n    controller.remove();\n    return controller;\n  },\n\n  bindController(controller: Controller, target: Controller | null): void {\n    if (!this.binds || this.controller !== null) {\n      return;\n    }\n    const newController = this.detectController(controller);\n    if (newController === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).controller = newController;\n    this.willAttachController(newController, target);\n    this.onAttachController(newController, target);\n    this.initController(newController);\n    this.didAttachController(newController, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindController(controller: Controller): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldController = this.detectController(controller);\n    if (oldController === null || this.controller !== oldController) {\n      return;\n    }\n    (this as Mutable<typeof this>).controller = null;\n    this.willDetachController(oldController);\n    this.onDetachController(oldController);\n    this.deinitController(oldController);\n    this.didDetachController(oldController);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectController(controller: Controller): C | null {\n    const key = this.controllerKey;\n    if (key !== void 0 && key === controller.key) {\n      return controller as C;\n    }\n    return null;\n  },\n\n  onStartConsuming(): void {\n    const controller = this.controller;\n    if (controller !== null) {\n      controller.consume(this);\n    }\n  },\n\n  onStopConsuming(): void {\n    const controller = this.controller;\n    if (controller !== null) {\n      controller.unconsume(this);\n    }\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof ControllerRef) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setController(inlet.controller);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n},\n{\n  tryController<R, K extends keyof R, F extends R[K]>(owner: R, fastenerName: K): (F extends {readonly controller: infer C | null} ? C | null : never) | null {\n    const metaclass = FastenerContext.getMetaclass(owner);\n    const controllerRef = metaclass !== null ? metaclass.tryFastener(owner, fastenerName) : null;\n    return controllerRef instanceof ControllerRef ? controllerRef.controller : null;\n  },\n\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).controller = null;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<ControllerRef<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const controllerKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"controllerKey\");\n    if (controllerKeyDescriptor !== void 0 && \"value\" in controllerKeyDescriptor) {\n      if (controllerKeyDescriptor.value === true) {\n        controllerKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"controllerKey\", controllerKeyDescriptor);\n      } else if (controllerKeyDescriptor.value === false) {\n        controllerKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"controllerKey\", controllerKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Comparator} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerRelationDescriptor} from \"./ControllerRelation\";\nimport type {ControllerRelationClass} from \"./ControllerRelation\";\nimport {ControllerRelation} from \"./ControllerRelation\";\n\n/** @public */\nexport interface ControllerSetDescriptor<R, C extends Controller> extends ControllerRelationDescriptor<R, C> {\n  extends?: Proto<ControllerSet<any, any, any>> | boolean | null;\n  ordered?: boolean;\n  sorted?: boolean;\n}\n\n/** @public */\nexport interface ControllerSetClass<F extends ControllerSet<any, any, any> = ControllerSet<any, any, any>> extends ControllerRelationClass<F> {\n  /** @internal */\n  readonly OrderedFlag: FastenerFlags;\n  /** @internal */\n  readonly SortedFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ControllerSet<R = any, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerRelation<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<ControllerSetDescriptor<R, C>>;\n\n  /** @override */\n  get fastenerType(): Proto<ControllerSet<any, any, any>>;\n\n  /** @override */\n  get parent(): ControllerSet<any, C, any> | null;\n\n  /** @internal @protected */\n  controllerKey(controller: C): string | undefined;\n\n  /** @internal */\n  readonly controllers: {readonly [controllerId: string]: C | undefined};\n\n  readonly controllerCount: number;\n\n  /** @internal */\n  insertControllerMap(newController: C, target: Controller | null): void;\n\n  /** @internal */\n  removeControllerMap(oldController: C): void;\n\n  hasController(controller: Controller): boolean;\n\n  addController(controller?: C | LikeType<C>, target?: Controller | null, key?: string): C;\n\n  addControllers(controllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void;\n\n  setControllers(controllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void;\n\n  attachController(controller?: C | LikeType<C> | null, target?: Controller | null): C;\n\n  attachControllers(controllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void;\n\n  detachController(controller: C): C | null;\n\n  detachControllers(controllers?: {readonly [controllerId: string]: C | undefined}): void;\n\n  insertController(parent?: Controller | null, controller?: C | LikeType<C>, target?: Controller | null, key?: string): C;\n\n  insertControllers(parent: Controller | null, controllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void;\n\n  removeController(controller: C): C | null;\n\n  removeControllers(controllers?: {readonly [controllerId: string]: C | undefined}): void;\n\n  deleteController(controller: C): C | null;\n\n  deleteControllers(controllers?: {readonly [controllerId: string]: C | undefined}): void;\n\n  reinsertController(controller: C, target?: Controller | null): void;\n\n  /** @internal @override */\n  bindController(controller: Controller, target: Controller | null): void;\n\n  /** @internal @override */\n  unbindController(controller: Controller): void;\n\n  /** @override */\n  detectController(controller: Controller): C | null;\n\n  consumeControllers(consumer: Consumer): void;\n\n  unconsumeControllers(consumer: Consumer): void;\n\n  /** @protected @override */\n  onStartConsuming(): void;\n\n  /** @protected @override */\n  onStopConsuming(): void;\n\n  /** @override */\n  recohere(t: number): void;\n\n  get ordered(): boolean;\n\n  order(ordered?: boolean): this;\n\n  get sorted(): boolean;\n\n  sort(sorted?: boolean): this;\n\n  /** @protected */\n  willSort(parent: Controller | null): void;\n\n  /** @protected */\n  onSort(parent: Controller | null): void;\n\n  /** @protected */\n  didSort(parent: Controller | null): void;\n\n  /** @internal */\n  sortChildren(parent: Controller, comparator?: Comparator<C>): void;\n\n  /** @internal */\n  getTargetChild(parent: Controller, child: C): Controller | null;\n\n  /** @internal */\n  compareChildren(a: Controller, b: Controller): number;\n\n  /** @internal */\n  compareTargetChild(a: Controller, b: Controller): number;\n\n  /** @protected */\n  compare(a: C, b: C): number;\n}\n\n/** @public */\nexport const ControllerSet = (<R, C extends Controller, I extends any[], F extends ControllerSet<any, any, any>>() => ControllerRelation.extend<ControllerSet<R, C, I>, ControllerSetClass<F>>(\"ControllerSet\", {\n  get fastenerType(): Proto<ControllerSet<any, any, any>> {\n    return ControllerSet;\n  },\n\n  controllerKey(controller: C): string | undefined {\n    return void 0;\n  },\n\n  insertControllerMap(newController: C, target: Controller | null): void {\n    const controllers = this.controllers as {[controllerId: string]: C | undefined};\n    if (target !== null && (this.flags & ControllerSet.OrderedFlag) !== 0) {\n      (this as Mutable<typeof this>).controllers = Objects.inserted(controllers, newController.uid, newController, target);\n    } else {\n      controllers[newController.uid] = newController;\n    }\n  },\n\n  removeControllerMap(oldController: C): void {\n    const controllers = this.controllers as {[controllerId: string]: C | undefined};\n    delete controllers[oldController.uid];\n  },\n\n  hasController(controller: Controller): boolean {\n    return this.controllers[controller.uid] !== void 0;\n  },\n\n  addController(newController?: C | LikeType<C>, target?: Controller | null, key?: string): C {\n    if (newController !== void 0 && newController !== null) {\n      newController = this.fromLike(newController);\n    } else {\n      newController = this.createController();\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    let parent: Controller | null;\n    if (this.binds && (parent = this.parentController, parent !== null)) {\n      if (target === null) {\n        if (newController.parent === parent) {\n          target = newController.nextSibling;\n        } else {\n          target = this.getTargetChild(parent, newController);\n        }\n      }\n      if (key === void 0) {\n        key = this.controllerKey(newController);\n      }\n      if (newController.parent !== parent || newController.nextSibling !== target || newController.key !== key) {\n        this.insertChild(parent, newController, target, key);\n      }\n    }\n    if (this.controllers[newController.uid] !== void 0) {\n      return newController;\n    }\n    this.insertControllerMap(newController, target);\n    (this as Mutable<typeof this>).controllerCount += 1;\n    this.willAttachController(newController, target);\n    this.onAttachController(newController, target);\n    this.initController(newController);\n    this.didAttachController(newController, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newController;\n  },\n\n  addControllers(newControllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void {\n    for (const controllerId in newControllers) {\n      this.addController(newControllers[controllerId]!, target);\n    }\n  },\n\n  setControllers(newControllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void {\n    const binds = this.binds;\n    const parent = binds ? this.parentController : null;\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      if (newControllers[controllerId] === void 0) {\n        const oldController = this.detachController(controllers[controllerId]!);\n        if (oldController !== null && binds && parent !== null && oldController.parent === parent) {\n          oldController.remove();\n        }\n      }\n    }\n    if ((this.flags & ControllerSet.OrderedFlag) !== 0) {\n      const orderedControllers = new Array<C>();\n      for (const controllerId in newControllers) {\n        orderedControllers.push(newControllers[controllerId]!);\n      }\n      for (let i = 0, n = orderedControllers.length; i < n; i += 1) {\n        const newController = orderedControllers[i]!;\n        if (controllers[newController.uid] === void 0) {\n          const targetController = i < n + 1 ? orderedControllers[i + 1] : target;\n          this.addController(newController, targetController);\n        }\n      }\n    } else {\n      for (const controllerId in newControllers) {\n        if (controllers[controllerId] === void 0) {\n          this.addController(newControllers[controllerId]!, target);\n        }\n      }\n    }\n  },\n\n  attachController(newController?: C | LikeType<C> | null, target?: Controller | null): C {\n    if (newController !== void 0 && newController !== null) {\n      newController = this.fromLike(newController);\n    } else {\n      newController = this.createController();\n    }\n    if (this.controllers[newController.uid] !== void 0) {\n      return newController;\n    } else if (target === void 0) {\n      target = null;\n    }\n    this.insertControllerMap(newController, target);\n    (this as Mutable<typeof this>).controllerCount += 1;\n    this.willAttachController(newController, target);\n    this.onAttachController(newController, target);\n    this.initController(newController);\n    this.didAttachController(newController, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newController;\n  },\n\n  attachControllers(newControllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void {\n    for (const controllerId in newControllers) {\n      this.attachController(newControllers[controllerId]!, target);\n    }\n  },\n\n  detachController(oldController: C): C | null {\n    if (this.controllers[oldController.uid] === void 0) {\n      return null;\n    }\n    (this as Mutable<typeof this>).controllerCount -= 1;\n    this.removeControllerMap(oldController);\n    this.willDetachController(oldController);\n    this.onDetachController(oldController);\n    this.deinitController(oldController);\n    this.didDetachController(oldController);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return oldController;\n  },\n\n  detachControllers(controllers?: {readonly [controllerId: string]: C | undefined}): void {\n    if (controllers === void 0) {\n      controllers = this.controllers;\n    }\n    for (const controllerId in controllers) {\n      this.detachController(controllers[controllerId]!);\n    }\n  },\n\n  insertController(parent?: Controller | null, newController?: C | LikeType<C>, target?: Controller | null, key?: string): C {\n    if (newController !== void 0 && newController !== null) {\n      newController = this.fromLike(newController);\n    } else {\n      newController = this.createController();\n    }\n    if (parent === void 0) {\n      parent = null;\n    }\n    if (!this.binds && this.controllers[newController.uid] !== void 0 && newController.parent !== null && parent === null && key === void 0) {\n      return newController;\n    }\n    if (parent === null) {\n      parent = this.parentController;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.controllerKey(newController);\n    }\n    if (parent !== null && (newController.parent !== parent || newController.key !== key)) {\n      if (target === null) {\n        target = this.getTargetChild(parent, newController);\n      }\n      this.insertChild(parent, newController, target, key);\n    }\n    if (this.controllers[newController.uid] !== void 0) {\n      return newController;\n    }\n    this.insertControllerMap(newController, target);\n    (this as Mutable<typeof this>).controllerCount += 1;\n    this.willAttachController(newController, target);\n    this.onAttachController(newController, target);\n    this.initController(newController);\n    this.didAttachController(newController, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n    return newController;\n  },\n\n  insertControllers(parent: Controller | null, newControllers: {readonly [controllerId: string]: C | undefined}, target?: Controller | null): void {\n    for (const controllerId in newControllers) {\n      this.insertController(parent, newControllers[controllerId]!, target);\n    }\n  },\n\n  removeController(controller: C): C | null {\n    if (!this.hasController(controller)) {\n      return null;\n    }\n    controller.remove();\n    return controller;\n  },\n\n  removeControllers(controllers?: {readonly [controllerId: string]: C | undefined}): void {\n    if (controllers === void 0) {\n      controllers = this.controllers;\n    }\n    for (const controllerId in controllers) {\n      this.removeController(controllers[controllerId]!);\n    }\n  },\n\n  deleteController(controller: C): C | null {\n    const oldController = this.detachController(controller);\n    if (oldController === null) {\n      return null;\n    }\n    oldController.remove();\n    return oldController;\n  },\n\n  deleteControllers(controllers?: {readonly [controllerId: string]: C | undefined}): void {\n    if (controllers === void 0) {\n      controllers = this.controllers;\n    }\n    for (const controllerId in controllers) {\n      this.deleteController(controllers[controllerId]!);\n    }\n  },\n\n  reinsertController(controller: C, target?: Controller | null): void {\n    if (this.controllers[controller.uid] === void 0 || (target === void 0 && (this.flags & ControllerSet.SortedFlag) === 0)) {\n      return;\n    }\n    const parent = controller.parent;\n    if (parent === null) {\n      return;\n    } else if (target === void 0) {\n      target = this.getTargetChild(parent, controller);\n    }\n    parent.reinsertChild(controller, target);\n  },\n\n  bindController(controller: Controller, target: Controller | null): void {\n    if (!this.binds) {\n      return;\n    }\n    const newController = this.detectController(controller);\n    if (newController === null || this.controllers[newController.uid] !== void 0) {\n      return;\n    }\n    this.insertControllerMap(newController, target);\n    (this as Mutable<typeof this>).controllerCount += 1;\n    this.willAttachController(newController, target);\n    this.onAttachController(newController, target);\n    this.initController(newController);\n    this.didAttachController(newController, target);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  unbindController(controller: Controller): void {\n    if (!this.binds) {\n      return;\n    }\n    const oldController = this.detectController(controller);\n    if (oldController === null || this.controllers[oldController.uid] === void 0) {\n      return;\n    }\n    (this as Mutable<typeof this>).controllerCount -= 1;\n    this.removeControllerMap(oldController);\n    this.willDetachController(oldController);\n    this.onDetachController(oldController);\n    this.deinitController(oldController);\n    this.didDetachController(oldController);\n    this.setCoherent(true);\n    this.decohereOutlets();\n  },\n\n  detectController(controller: Controller): C | null {\n    if (typeof this.controllerType === \"function\" && controller instanceof this.controllerType) {\n      return controller as C;\n    }\n    return null;\n  },\n\n  consumeControllers(consumer: Consumer): void {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      controller.consume(consumer);\n    }\n  },\n\n  unconsumeControllers(consumer: Consumer): void {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      controller.unconsume(consumer);\n    }\n  },\n\n  onStartConsuming(): void {\n    this.consumeControllers(this);\n  },\n\n  onStopConsuming(): void {\n    this.unconsumeControllers(this);\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof ControllerSet) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setControllers(inlet.controllers);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n\n  get ordered(): boolean {\n    return (this.flags & ControllerSet.OrderedFlag) !== 0;\n  },\n\n  order(ordered?: boolean): typeof this {\n    if (ordered === void 0) {\n      ordered = true;\n    }\n    if (ordered) {\n      this.setFlags(this.flags | ControllerSet.OrderedFlag);\n    } else {\n      this.setFlags(this.flags & ~ControllerSet.OrderedFlag);\n    }\n    return this;\n  },\n\n  get sorted(): boolean {\n    return (this.flags & ControllerSet.SortedFlag) !== 0;\n  },\n\n  sort(sorted?: boolean): typeof this {\n    if (sorted === void 0) {\n      sorted = true;\n    }\n    if (sorted) {\n      const parent = this.parentController;\n      this.willSort(parent);\n      this.setFlags(this.flags | ControllerSet.SortedFlag);\n      this.onSort(parent);\n      this.didSort(parent);\n    } else {\n      this.setFlags(this.flags & ~ControllerSet.SortedFlag);\n    }\n    return this;\n  },\n\n  willSort(parent: Controller | null): void {\n    // hook\n  },\n\n  onSort(parent: Controller | null): void {\n    if (parent !== null) {\n      this.sortChildren(parent);\n    }\n  },\n\n  didSort(parent: Controller | null): void {\n    // hook\n  },\n\n  sortChildren(parent: Controller, comparator?: Comparator<C>): void {\n    parent.sortChildren(this.compareChildren.bind(this));\n  },\n\n  getTargetChild(parent: Controller, child: C): Controller | null {\n    if ((this.flags & ControllerSet.SortedFlag) !== 0) {\n      return parent.getTargetChild(child, this.compareTargetChild.bind(this));\n    }\n    return null;\n  },\n\n  compareChildren(a: Controller, b: Controller): number {\n    const controllers = this.controllers;\n    const x = controllers[a.uid];\n    const y = controllers[b.uid];\n    if (x !== void 0 && y !== void 0) {\n      return this.compare(x, y);\n    }\n    return x !== void 0 ? 1 : y !== void 0 ? -1 : 0;\n  },\n\n  compareTargetChild(a: C, b: Controller): number {\n    const controllers = this.controllers;\n    const y = controllers[b.uid];\n    if (y !== void 0) {\n      return this.compare(a, y);\n    }\n    return y !== void 0 ? -1 : 0;\n  },\n\n  compare(a: C, b: C): number {\n    return a.uid < b.uid ? -1 : a.uid > b.uid ? 1 : 0;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).controllers = {};\n    (fastener as Mutable<typeof fastener>).controllerCount = 0;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<ControllerSet<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    let flagsInit = fastenerPrototype.flagsInit;\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"ordered\")) {\n      if (fastenerPrototype.ordered) {\n        flagsInit |= ControllerSet.OrderedFlag;\n      } else {\n        flagsInit &= ~ControllerSet.OrderedFlag;\n      }\n      delete (fastenerPrototype as ControllerSetDescriptor<any, any>).ordered;\n    }\n    if (Object.prototype.hasOwnProperty.call(fastenerPrototype, \"sorted\")) {\n      if (fastenerPrototype.sorted) {\n        flagsInit |= ControllerSet.SortedFlag;\n      } else {\n        flagsInit &= ~ControllerSet.SortedFlag;\n      }\n      delete (fastenerPrototype as ControllerSetDescriptor<any, any>).sorted;\n    }\n    Object.defineProperty(fastenerPrototype, \"flagsInit\", {\n      value: flagsInit,\n      enumerable: true,\n      configurable: true,\n    });\n  },\n\n  OrderedFlag: 1 << (ControllerRelation.FlagShift + 0),\n  SortedFlag: 1 << (ControllerRelation.FlagShift + 1),\n\n  FlagShift: ControllerRelation.FlagShift + 2,\n  FlagMask: (1 << (ControllerRelation.FlagShift + 2)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Consumable} from \"@swim/util\";\nimport {Affinity} from \"@swim/component\";\nimport type {FastenerFlags} from \"@swim/component\";\nimport type {FastenerDescriptor} from \"@swim/component\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport {Model} from \"@swim/model\";\nimport type {TraitFactory} from \"@swim/model\";\nimport {Trait} from \"@swim/model\";\nimport type {ViewFactory} from \"@swim/view\";\nimport {View} from \"@swim/view\";\n\n/** @public */\nexport interface TraitViewRefDescriptor<R, T extends Trait, V extends View> extends FastenerDescriptor<R> {\n  extends?: Proto<TraitViewRef<any, any, any>> | boolean | null;\n  traitKey?: string | boolean;\n  viewKey?: string | boolean;\n}\n\n/** @public */\nexport interface TraitViewRefClass<F extends TraitViewRef<any, any, any> = TraitViewRef<any, any, any>> extends FastenerClass<F> {\n  /** @internal */\n  readonly ConsumingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface TraitViewRef<R = any, T extends Trait = Trait, V extends View = View> extends Fastener<R>, Consumable {\n  /** @override */\n  get descriptorType(): Proto<TraitViewRefDescriptor<R, T, V>>;\n\n  /** @override */\n  get fastenerType(): Proto<TraitViewRef<any, any, any>>;\n\n  get consumed(): boolean | undefined;\n\n  get traitType(): TraitFactory<T> | null;\n\n  get traitKey(): string | undefined;\n\n  get bindsTrait(): boolean;\n\n  get observesTrait(): boolean;\n\n  readonly trait: T | null;\n\n  getTrait(): T;\n\n  setTrait(trait: T | LikeType<T> | null, target?: Trait | null, key?: string): T | null;\n\n  attachTrait(trait?: T | LikeType<T>, target?: Trait | null): T;\n\n  detachTrait(): T | null;\n\n  /** @protected */\n  initTrait(trait: T): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, target: Trait | null): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, target: Trait | null): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, target: Trait | null): void;\n\n  /** @protected */\n  deinitTrait(trait: T): void;\n\n  /** @protected */\n  willDetachTrait(trait: T): void;\n\n  /** @protected */\n  onDetachTrait(trait: T): void;\n\n  /** @protected */\n  didDetachTrait(trait: T): void;\n\n  insertTrait(model?: Model | null, trait?: T | LikeType<T> | null, target?: Trait | null, key?: string): T;\n\n  removeTrait(): T | null;\n\n  deleteTrait(): T | null;\n\n  get parentModel(): Model | null;\n\n  /** @protected */\n  insertChildTrait(model: Model, trait: T, target: Trait | null, key: string | undefined): void;\n\n  /** @internal */\n  bindModel(model: Model, targetModel: Model | null): void;\n\n  /** @internal */\n  unbindModel(model: Model): void;\n\n  /** @override */\n  detectModel(model: Model): T | null;\n\n  /** @internal */\n  bindTrait(trait: Trait, target: Trait | null): void;\n\n  /** @internal */\n  unbindTrait(trait: Trait): void;\n\n  detectTrait(trait: Trait): T | null;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromTraitLike(value: T | LikeType<T>): T;\n\n  get viewType(): ViewFactory<V> | null;\n\n  get viewKey(): string | undefined;\n\n  get bindsView(): boolean;\n\n  get observesView(): boolean;\n\n  readonly view: V | null;\n\n  getView(): V;\n\n  setView(view: V | LikeType<V> | null, target?: View | null, key?: string): V | null;\n\n  attachView(view?: V | LikeType<V> | null, target?: View | null): V;\n\n  detachView(): V | null;\n\n  /** @protected */\n  initView(view: V): void;\n\n  /** @protected */\n  willAttachView(view: V, target: View | null): void;\n\n  /** @protected */\n  onAttachView(view: V, target: View | null): void;\n\n  /** @protected */\n  didAttachView(view: V, target: View | null): void;\n\n  /** @protected */\n  deinitView(view: V): void;\n\n  /** @protected */\n  willDetachView(view: V): void;\n\n  /** @protected */\n  onDetachView(view: V): void;\n\n  /** @protected */\n  didDetachView(view: V): void;\n\n  insertView(parent?: View | null, view?: V | LikeType<V> | null, target?: View | null, key?: string): V;\n\n  removeView(): V | null;\n\n  deleteView(): V | null;\n\n  get parentView(): View | null;\n\n  /** @protected */\n  insertChildView(parent: View, child: V, target: View | null, key: string | undefined): void;\n\n  /** @internal */\n  bindView(view: View, target: View | null): void;\n\n  /** @internal */\n  unbindView(view: View): void;\n\n  detectView(view: View): V | null;\n\n  createView(): V;\n\n  /** @internal @protected */\n  fromViewLike(value: V | LikeType<V>): V;\n\n  /** @override */\n  recohere(t: number): void;\n\n  /** @internal */\n  readonly consumers: ReadonlySet<Consumer> | null;\n\n  /** @override */\n  consume(consumer: Consumer): void\n\n  /** @protected */\n  willConsume(consumer: Consumer): void;\n\n  /** @protected */\n  onConsume(consumer: Consumer): void;\n\n  /** @protected */\n  didConsume(consumer: Consumer): void;\n\n  /** @override */\n  unconsume(consumer: Consumer): void\n\n  /** @protected */\n  willUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  onUnconsume(consumer: Consumer): void;\n\n  /** @protected */\n  didUnconsume(consumer: Consumer): void;\n\n  get consuming(): boolean;\n\n  /** @internal */\n  startConsuming(): void;\n\n  /** @protected */\n  willStartConsuming(): void;\n\n  /** @protected */\n  onStartConsuming(): void;\n\n  /** @protected */\n  didStartConsuming(): void;\n\n  /** @internal */\n  stopConsuming(): void;\n\n  /** @protected */\n  willStopConsuming(): void;\n\n  /** @protected */\n  onStopConsuming(): void;\n\n  /** @protected */\n  didStopConsuming(): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n}\n\n/** @public */\nexport const TraitViewRef = (<R, T extends Trait, V extends View, F extends TraitViewRef<any, any, any>>() => Fastener.extend<TraitViewRef<R, T, V>, TraitViewRefClass<F>>(\"TraitViewRef\", {\n  get fastenerType(): Proto<TraitViewRef<any, any, any>> {\n    return TraitViewRef;\n  },\n\n  consumed: false,\n\n  traitType: null,\n\n  traitKey: void 0,\n\n  bindsTrait: false,\n\n  observesTrait: false,\n\n  getTrait(): T {\n    const trait = this.trait;\n    if (trait === null) {\n      let message = trait + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new TypeError(message);\n    }\n    return trait;\n  },\n\n  setTrait(newTrait: T | LikeType<T> | null, target?: Trait | null, key?: string): T | null {\n    let oldTrait = this.trait;\n    if (newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    }\n    if (oldTrait === newTrait) {\n      return oldTrait;\n    } else if (target === void 0) {\n      target = null;\n    }\n    let model: Model | null;\n    if (this.bindsTrait && (model = this.parentModel, model !== null)) {\n      if (oldTrait !== null && oldTrait.model === model) {\n        if (target === null) {\n          target = oldTrait.nextTrait;\n        }\n        oldTrait.remove();\n      }\n      if (newTrait !== null) {\n        if (key === void 0) {\n          key = this.traitKey;\n        }\n        this.insertChildTrait(model, newTrait, target, key);\n      }\n      oldTrait = this.trait;\n      if (oldTrait === newTrait) {\n        return oldTrait;\n      }\n    }\n    if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n    }\n    if (newTrait !== null) {\n      (this as Mutable<typeof this>).trait = newTrait;\n      this.willAttachTrait(newTrait, target);\n      this.onAttachTrait(newTrait, target);\n      this.initTrait(newTrait);\n      this.didAttachTrait(newTrait, target);\n    }\n    return oldTrait;\n  },\n\n  attachTrait(newTrait?: T | LikeType<T>, target?: Trait | null): T {\n    const oldTrait = this.trait;\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    } else if (oldTrait === null) {\n      newTrait = this.createTrait();\n    } else {\n      newTrait = oldTrait;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (oldTrait === newTrait) {\n      return newTrait;\n    } else if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    return newTrait;\n  },\n\n  detachTrait(): T | null {\n    const oldTrait = this.trait;\n    if (oldTrait === null) {\n      return null;\n    }\n    (this as Mutable<typeof this>).trait = null;\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n    return oldTrait;\n  },\n\n  initTrait(trait: T): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, target: Trait | null): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, target: Trait | null): void {\n    if (this.observesTrait) {\n      trait.observe(this as Observes<T>);\n    }\n    if ((this.flags & TraitViewRef.ConsumingFlag) !== 0) {\n      trait.consume(this);\n    }\n  },\n\n  didAttachTrait(trait: T, target: Trait | null): void {\n    // hook\n  },\n\n  deinitTrait(trait: T): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T): void {\n    if ((this.flags & TraitViewRef.ConsumingFlag) !== 0) {\n      trait.unconsume(this);\n    }\n    if (this.observesTrait) {\n      trait.unobserve(this as Observes<T>);\n    }\n  },\n\n  didDetachTrait(trait: T): void {\n    // hook\n  },\n\n  insertTrait(model?: Model | null, newTrait?: T | LikeType<T> | null, target?: Trait | null, key?: string): T {\n    let oldTrait = this.trait;\n    if (newTrait !== void 0 && newTrait !== null) {\n      newTrait = this.fromTraitLike(newTrait);\n    } else if (oldTrait === null) {\n      newTrait = this.createTrait();\n    } else {\n      newTrait = oldTrait;\n    }\n    if (model === void 0) {\n      model = null;\n    }\n    if (!this.bindsTrait && oldTrait === newTrait && newTrait.model !== null && model === null && key === void 0) {\n      return newTrait;\n    }\n    if (model === null) {\n      model = this.parentModel;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.traitKey;\n    }\n    if (model !== null && (newTrait.model !== model || newTrait.key !== key)) {\n      this.insertChildTrait(model, newTrait, target, key);\n    }\n    oldTrait = this.trait;\n    if (oldTrait === newTrait) {\n      return newTrait;\n    } else if (oldTrait !== null) {\n      (this as Mutable<typeof this>).trait = null;\n      this.willDetachTrait(oldTrait);\n      this.onDetachTrait(oldTrait);\n      this.deinitTrait(oldTrait);\n      this.didDetachTrait(oldTrait);\n      if (this.bindsTrait && model !== null && oldTrait.parent === model) {\n        oldTrait.remove();\n      }\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n    return newTrait;\n  },\n\n  removeTrait(): T | null {\n    const trait = this.trait;\n    if (trait === null) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  deleteTrait(): T | null {\n    const trait = this.detachTrait();\n    if (trait === null) {\n      return null;\n    }\n    trait.remove();\n    return trait;\n  },\n\n  get parentModel(): Model | null {\n    const owner = this.owner;\n    if (owner instanceof Model) {\n      return owner;\n    } else if (owner instanceof Trait) {\n      return owner.model;\n    }\n    return null;\n  },\n\n  insertChildTrait(model: Model, trait: T, target: Trait | null, key: string | undefined): void {\n    model.insertTrait(trait, target, key);\n  },\n\n  bindModel(model: Model, targetModel: Model | null): void {\n    if (!this.bindsTrait || this.trait !== null) {\n      return;\n    }\n    const newTrait = this.detectModel(model);\n    if (newTrait === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, null);\n    this.onAttachTrait(newTrait, null);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, null);\n  },\n\n  unbindModel(model: Model): void {\n    if (!this.bindsTrait) {\n      return;\n    }\n    const oldTrait = this.detectModel(model);\n    if (oldTrait === null || this.trait !== oldTrait) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = null;\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n  },\n\n  detectModel(model: Model): T | null {\n    return null;\n  },\n\n  bindTrait(trait: Trait, target: Trait | null): void {\n    if (!this.bindsTrait || this.trait !== null) {\n      return;\n    }\n    const newTrait = this.detectTrait(trait);\n    if (newTrait === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = newTrait;\n    this.willAttachTrait(newTrait, target);\n    this.onAttachTrait(newTrait, target);\n    this.initTrait(newTrait);\n    this.didAttachTrait(newTrait, target);\n  },\n\n  unbindTrait(trait: Trait): void {\n    if (!this.bindsTrait) {\n      return;\n    }\n    const oldTrait = this.detectTrait(trait);\n    if (oldTrait === null || this.trait !== oldTrait) {\n      return;\n    }\n    (this as Mutable<typeof this>).trait = null;\n    this.willDetachTrait(oldTrait);\n    this.onDetachTrait(oldTrait);\n    this.deinitTrait(oldTrait);\n    this.didDetachTrait(oldTrait);\n  },\n\n  detectTrait(trait: Trait): T | null {\n    const key = this.traitKey;\n    if (key !== void 0 && key === trait.key) {\n      return trait as T;\n    }\n    return null;\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n\n  fromTraitLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  viewType: null,\n\n  viewKey: void 0,\n\n  bindsView: false,\n\n  observesView: false,\n\n  getView(): V {\n    const view = this.view;\n    if (view === null) {\n      let message = view + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new TypeError(message);\n    }\n    return view;\n  },\n\n  setView(newView: V | LikeType<V> | null, target?: View | null, key?: string): V | null {\n    if (newView !== null) {\n      newView = this.fromViewLike(newView);\n    }\n    let oldView = this.view;\n    if (oldView === newView) {\n      return oldView;\n    } else if (target === void 0) {\n      target = null;\n    }\n    let parent: View | null;\n    if (this.bindsView && (parent = this.parentView, parent !== null)) {\n      if (oldView !== null && oldView.parent === parent) {\n        if (target === null) {\n          target = oldView.nextSibling;\n        }\n        oldView.remove();\n      }\n      if (newView !== null) {\n        if (key === void 0) {\n          key = this.viewKey;\n        }\n        this.insertChildView(parent, newView, target, key);\n      }\n      oldView = this.view;\n      if (oldView === newView) {\n        return oldView;\n      }\n    }\n    if (oldView !== null) {\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n    }\n    if (newView !== null) {\n      (this as Mutable<typeof this>).view = newView;\n      this.willAttachView(newView, target);\n      this.onAttachView(newView, target);\n      this.initView(newView);\n      this.didAttachView(newView, target);\n    }\n    return oldView;\n  },\n\n  attachView(newView?: V | LikeType<V> | null, target?: View | null): V {\n    const oldView = this.view;\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromViewLike(newView);\n    } else if (oldView === null) {\n      newView = this.createView();\n    } else {\n      newView = oldView;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (oldView === newView) {\n      return newView;\n    } else if (oldView !== null) {\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    return newView;\n  },\n\n  detachView(): V | null {\n    const oldView = this.view;\n    if (oldView === null) {\n      return null;\n    }\n    (this as Mutable<typeof this>).view = null;\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n    return oldView;\n  },\n\n  initView(view: V): void {\n    // hook\n  },\n\n  willAttachView(view: V, target: View | null): void {\n    // hook\n  },\n\n  onAttachView(view: V, target: View | null): void {\n    if (this.observesView) {\n      view.observe(this as Observes<V>);\n    }\n  },\n\n  didAttachView(view: V, target: View | null): void {\n    // hook\n  },\n\n  deinitView(view: V): void {\n    // hook\n  },\n\n  willDetachView(view: V): void {\n    // hook\n  },\n\n  onDetachView(view: V): void {\n    if (this.observesView) {\n      view.unobserve(this as Observes<V>);\n    }\n  },\n\n  didDetachView(view: V): void {\n    // hook\n  },\n\n  insertView(parent?: View | null, newView?: V | LikeType<V> | null, target?: View | null, key?: string): V {\n    let oldView = this.view;\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromViewLike(newView);\n    } else if (oldView === null) {\n      newView = this.createView();\n    } else {\n      newView = oldView;\n    }\n    if (parent === void 0) {\n      parent = null;\n    }\n    if (!this.bindsView && oldView === newView && newView.parent !== null && parent === null && key === void 0) {\n      return newView;\n    }\n    if (parent === null) {\n      parent = this.parentView;\n    }\n    if (target === void 0) {\n      target = null;\n    }\n    if (key === void 0) {\n      key = this.viewKey;\n    }\n    if (parent !== null && (newView.parent !== parent || newView.key !== key)) {\n      this.insertChildView(parent, newView, target, key);\n    }\n    oldView = this.view;\n    if (oldView === newView) {\n      return newView;\n    } else if (oldView !== null) {\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n      if (this.bindsView && parent !== null && oldView.parent === parent) {\n        oldView.remove();\n      }\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n    return newView;\n  },\n\n  removeView(): V | null {\n    const view = this.view;\n    if (view === null) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  deleteView(): V | null {\n    const view = this.detachView();\n    if (view === null) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  get parentView(): View | null {\n    const owner = this.owner;\n    return owner instanceof View ? owner : null;\n  },\n\n  insertChildView(parent: View, child: V, target: View | null, key: string | undefined): void {\n    parent.insertChild(child, target, key);\n  },\n\n  bindView(view: View, target: View | null): void {\n    if (!this.bindsView || this.view !== null) {\n      return;\n    }\n    const newView = this.detectView(view);\n    if (newView === null) {\n      return;\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, target);\n    this.onAttachView(newView, target);\n    this.initView(newView);\n    this.didAttachView(newView, target);\n  },\n\n  unbindView(view: View): void {\n    if (!this.bindsView) {\n      return;\n    }\n    const oldView = this.detectView(view);\n    if (oldView === null || this.view !== oldView) {\n      return;\n    }\n    (this as Mutable<typeof this>).view = null;\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n  },\n\n  detectView(view: View): V | null {\n    const key = this.viewKey;\n    if (key !== void 0 && key === view.key) {\n      return view as V;\n    }\n    return null;\n  },\n\n  createView(): V {\n    let view: V | undefined;\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      view = viewType.create();\n    }\n    if (view === void 0 || view === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new Error(message);\n    }\n    return view;\n  },\n\n  fromViewLike(value: V | LikeType<V>): V {\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      return viewType.fromLike(value);\n    }\n    return View.fromLike(value) as V;\n  },\n\n  recohere(t: number): void {\n    this.setCoherentTime(t);\n    const inlet = this.inlet;\n    if (inlet instanceof TraitViewRef) {\n      this.setDerived((this.flags & Affinity.Mask) <= Math.min(inlet.flags & Affinity.Mask, Affinity.Intrinsic));\n      if ((this.flags & Fastener.DerivedFlag) !== 0) {\n        this.setTrait(inlet.trait);\n        this.setView(inlet.view);\n        this.setCoherent(true);\n      }\n    } else {\n      this.setDerived(false);\n    }\n  },\n\n  consume(consumer: Consumer): void {\n    let consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null) {\n      consumers = new Set<Consumer>();\n      (this as Mutable<typeof this>).consumers = consumers;\n    } else if (consumers.has(consumer)) {\n      return;\n    }\n    this.willConsume(consumer);\n    consumers.add(consumer);\n    this.onConsume(consumer);\n    this.didConsume(consumer);\n    if (consumers.size === 1 && this.mounted) {\n      this.startConsuming();\n    }\n  },\n\n  willConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didConsume(consumer: Consumer): void {\n    // hook\n  },\n\n  unconsume(consumer: Consumer): void {\n    const consumers = this.consumers as Set<Consumer> | null;\n    if (consumers === null || !consumers.has(consumer)) {\n      return;\n    }\n    this.willUnconsume(consumer);\n    consumers.delete(consumer);\n    this.onUnconsume(consumer);\n    this.didUnconsume(consumer);\n    if (consumers.size === 0) {\n      this.stopConsuming();\n    }\n  },\n\n  willUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  onUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  didUnconsume(consumer: Consumer): void {\n    // hook\n  },\n\n  get consuming(): boolean {\n    return (this.flags & TraitViewRef.ConsumingFlag) !== 0;\n  },\n\n  startConsuming(): void {\n    if ((this.flags & TraitViewRef.ConsumingFlag) !== 0) {\n      return;\n    }\n    this.willStartConsuming();\n    this.setFlags(this.flags | TraitViewRef.ConsumingFlag);\n    this.onStartConsuming();\n    this.didStartConsuming();\n  },\n\n  willStartConsuming(): void {\n    // hook\n  },\n\n  onStartConsuming(): void {\n    const trait = this.trait;\n    if (trait !== null) {\n      trait.consume(this);\n    }\n  },\n\n  didStartConsuming(): void {\n    // hook\n  },\n\n  stopConsuming(): void {\n    if ((this.flags & TraitViewRef.ConsumingFlag) === 0) {\n      return;\n    }\n    this.willStopConsuming();\n    this.setFlags(this.flags & ~TraitViewRef.ConsumingFlag);\n    this.onStopConsuming();\n    this.didStopConsuming();\n  },\n\n  willStopConsuming(): void {\n    // hook\n  },\n\n  onStopConsuming(): void {\n    const trait = this.trait;\n    if (trait !== null) {\n      trait.unconsume(this);\n    }\n  },\n\n  didStopConsuming(): void {\n    // hook\n  },\n\n  onMount(): void {\n    super.onMount();\n    if (this.consumers !== null && this.consumers.size !== 0) {\n      this.startConsuming();\n    }\n  },\n\n  onUnmount(): void {\n    super.onUnmount();\n    this.stopConsuming();\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).consumers = null;\n    (fastener as Mutable<typeof fastener>).trait = null;\n    (fastener as Mutable<typeof fastener>).view = null;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<TraitViewRef<any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const traitKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"traitKey\");\n    if (traitKeyDescriptor !== void 0 && \"value\" in traitKeyDescriptor) {\n      if (traitKeyDescriptor.value === true) {\n        traitKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      } else if (traitKeyDescriptor.value === false) {\n        traitKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      }\n    }\n\n    const viewKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"viewKey\");\n    if (viewKeyDescriptor !== void 0 && \"value\" in viewKeyDescriptor) {\n      if (viewKeyDescriptor.value === true) {\n        viewKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      } else if (viewKeyDescriptor.value === false) {\n        viewKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      }\n    }\n  },\n\n  ConsumingFlag: 1 << (Fastener.FlagShift + 0),\n\n  FlagShift: Fastener.FlagShift + 1,\n  FlagMask: (1 << (Fastener.FlagShift + 1)) - 1,\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {ViewFactory} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerRefDescriptor} from \"./ControllerRef\";\nimport type {ControllerRefClass} from \"./ControllerRef\";\nimport {ControllerRef} from \"./ControllerRef\";\n\n/** @public */\nexport interface ViewControllerRefDescriptor<R, V extends View, C extends Controller> extends ControllerRefDescriptor<R, C> {\n  extends?: Proto<ViewControllerRef<any, any, any, any>> | boolean | null;\n  viewKey?: string | boolean;\n}\n\n/** @public */\nexport interface ViewControllerRefClass<F extends ViewControllerRef<any, any, any, any> = ViewControllerRef<any, any, any, any>> extends ControllerRefClass<F> {\n}\n\n/** @public */\nexport interface ViewControllerRef<R = any, V extends View = View, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerRef<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<ViewControllerRefDescriptor<R, V, C>>;\n\n  set(viewOrController: V | C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  setIntrinsic(viewOrController: V | C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  get viewType(): ViewFactory<V> | null;\n\n  get viewKey(): string | undefined;\n\n  get observesView(): boolean;\n\n  readonly view: V | null;\n\n  getView(): V;\n\n  setView(view: V | LikeType<V> | null, targetView?: View | null, controllerKey?: string): V | null;\n\n  attachView(view?: V | LikeType<V> | null, targetView?: View | null): V;\n\n  /** @protected */\n  initView(view: V): void;\n\n  /** @protected */\n  willAttachView(view: V, targetView: View | null): void;\n\n  /** @protected */\n  onAttachView(view: V, targetView: View | null): void;\n\n  /** @protected */\n  didAttachView(view: V, targetView: View | null): void;\n\n  detachView(): V | null;\n\n  /** @protected */\n  deinitView(view: V): void;\n\n  /** @protected */\n  willDetachView(view: V): void;\n\n  /** @protected */\n  onDetachView(view: V): void;\n\n  /** @protected */\n  didDetachView(view: V): void;\n\n  insertView(controller?: C | null, view?: V | LikeType<V>, targetView?: View | null, controllerKey?: string): V;\n\n  removeView(): V | null;\n\n  deleteView(): V | null;\n\n  createView(): V;\n\n  /** @protected */\n  fromViewLike(value: V | LikeType<V>): V;\n\n  /** @protected */\n  detectControllerView(controller: Controller): V | null;\n\n  /** @protected */\n  insertControllerView(controller: C, view: V | null, targetView: View | null, viewKey: string | undefined): void;\n\n  /** @protected @override */\n  onAttachController(controller: C, targetController: Controller | null): void;\n\n  /** @protected @override */\n  onDetachController(controller: C): void;\n\n  /** @override */\n  createController(view?: V): C;\n}\n\n/** @public */\nexport const ViewControllerRef = (<R, V extends View, C extends Controller, I extends any[], F extends ViewControllerRef<any, any, any, any>>() => ControllerRef.extend<ViewControllerRef<R, V, C, I>, ViewControllerRefClass<F>>(\"ViewControllerRef\", {\n  set(viewOrController: V | C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (viewOrController instanceof Fastener) {\n      this.bindInlet(viewOrController);\n    } else if (viewOrController instanceof View) {\n      this.setView(viewOrController);\n    } else {\n      this.setController(viewOrController);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(viewOrController: V | C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (viewOrController instanceof Fastener) {\n      this.bindInlet(viewOrController);\n    } else if (viewOrController instanceof View) {\n      this.setView(viewOrController);\n    } else {\n      this.setController(viewOrController);\n    }\n    return this.owner;\n  },\n\n  viewType: null,\n\n  viewKey: void 0,\n\n  observesView: false,\n\n  getView(): V {\n    const view = this.view;\n    if (view === null) {\n      let message = view + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new TypeError(message);\n    }\n    return view;\n  },\n\n  setView(newView: V | LikeType<V> | null, targetView?: View | null, controllerKey?: string): V | null {\n    if (newView !== null) {\n      newView = this.fromViewLike(newView);\n    }\n    let oldView = this.view;\n    if (oldView === newView) {\n      return oldView;\n    } else if (targetView === void 0) {\n      targetView = null;\n    }\n    let controller = this.controller;\n    if (controller === null && newView !== null) {\n      controller = this.createController(newView);\n      this.setController(controller, null, controllerKey);\n    }\n    if (controller !== null) {\n      if (oldView !== null) {\n        if (targetView === null) {\n          targetView = oldView.nextSibling;\n        }\n        oldView.remove();\n      }\n      if (newView !== null) {\n        this.insertControllerView(controller, newView, targetView, this.viewKey);\n      }\n      oldView = this.view;\n      if (oldView === newView) {\n        return oldView;\n      }\n    }\n    if (oldView !== null) {\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n    }\n    if (newView !== null) {\n      (this as Mutable<typeof this>).view = newView;\n      this.willAttachView(newView, targetView);\n      this.onAttachView(newView, targetView);\n      this.initView(newView);\n      this.didAttachView(newView, targetView);\n    }\n    return oldView;\n  },\n\n  attachView(newView?: V | LikeType<V> | null, targetView?: View | null): V {\n    let oldView = this.view;\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromViewLike(newView);\n    } else if (oldView === null) {\n      newView = this.createView();\n    } else {\n      newView = oldView;\n    }\n    let controller = this.controller;\n    if (controller === null) {\n      controller = this.createController(newView);\n      this.attachController(controller);\n      oldView = this.view;\n    }\n    if (targetView === void 0) {\n      targetView = null;\n    }\n    if (oldView === newView) {\n      return newView;\n    } else if (oldView !== null) {\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, targetView);\n    this.onAttachView(newView, targetView);\n    this.initView(newView);\n    this.didAttachView(newView, targetView);\n    return newView;\n  },\n\n  initView(view: V): void {\n    // hook\n  },\n\n  willAttachView(view: V, targetView: View | null): void {\n    // hook\n  },\n\n  onAttachView(view: V, targetView: View | null): void {\n    if (this.observesView) {\n      view.observe(this as Observes<V>);\n    }\n  },\n\n  didAttachView(view: V, targetView: View | null): void {\n    // hook\n  },\n\n  detachView(): V | null {\n    const oldView = this.view;\n    if (oldView === null) {\n      return null;\n    }\n    (this as Mutable<typeof this>).view = null;\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n    return oldView;\n  },\n\n  deinitView(view: V): void {\n    // hook\n  },\n\n  willDetachView(view: V): void {\n    // hook\n  },\n\n  onDetachView(view: V): void {\n    if (this.observesView) {\n      view.unobserve(this as Observes<V>);\n    }\n  },\n\n  didDetachView(view: V): void {\n    // hook\n  },\n\n  insertView(controller?: C | null, newView?: V | LikeType<V>, targetView?: View | null, controllerKey?: string): V {\n    let oldView = this.view;\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromViewLike(newView);\n    } else if (oldView === null) {\n      newView = this.createView();\n    } else {\n      newView = oldView;\n    }\n    if (controller === void 0) {\n      controller = null;\n    }\n    if (oldView === newView && controller === null) {\n      return newView;\n    }\n    if (controller === null) {\n      controller = this.createController(newView);\n      this.insertController(null, controller);\n    }\n    if (targetView === void 0) {\n      targetView = null;\n    }\n    if (controller !== null) {\n      this.insertControllerView(controller, newView, targetView, this.viewKey);\n    }\n    oldView = this.view;\n    if (oldView === newView) {\n      return newView;\n    } else if (oldView !== null) {\n      (this as Mutable<typeof this>).view = null;\n      this.willDetachView(oldView);\n      this.onDetachView(oldView);\n      this.deinitView(oldView);\n      this.didDetachView(oldView);\n      oldView.remove();\n    }\n    (this as Mutable<typeof this>).view = newView;\n    this.willAttachView(newView, targetView);\n    this.onAttachView(newView, targetView);\n    this.initView(newView);\n    this.didAttachView(newView, targetView);\n    return newView;\n  },\n\n  removeView(): V | null {\n    const view = this.view;\n    if (view === null) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  deleteView(): V | null {\n    const view = this.detachView();\n    if (view === null) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  createView(): V {\n    let view: V | undefined;\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      view = viewType.create();\n    }\n    if (view === void 0 || view === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new Error(message);\n    }\n    return view;\n  },\n\n  fromViewLike(value: V | LikeType<V>): V {\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      return viewType.fromLike(value);\n    }\n    return View.fromLike(value) as V;\n  },\n\n  detectControllerView(controller: Controller): V | null {\n    return null; // hook\n  },\n\n  insertControllerView(controller: C, view: V, targetView: View | null, viewKey: string | undefined): void {\n    // hook\n  },\n\n  onAttachController(controller: C, targetController: Controller | null): void {\n    const view = this.detectControllerView(controller);\n    if (view !== null) {\n      const targetView = targetController !== null ? this.detectControllerView(targetController) : null;\n      this.attachView(view, targetView);\n    }\n    super.onAttachController(controller, targetController);\n  },\n\n  onDetachController(controller: C): void {\n    super.onDetachController(controller);\n    const view = this.detectControllerView(controller);\n    if (view !== null && view === this.view) {\n      this.detachView();\n    }\n  },\n\n  createController(view?: V): C {\n    const controller = super.createController() as C;\n    if (view === void 0) {\n      view = this.createView();\n    }\n    this.insertControllerView(controller, view, null, this.viewKey);\n    return controller;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).view = null;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<ViewControllerRef<any, any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const viewKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"viewKey\");\n    if (viewKeyDescriptor !== void 0 && \"value\" in viewKeyDescriptor) {\n      if (viewKeyDescriptor.value === true) {\n        viewKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      } else if (viewKeyDescriptor.value === false) {\n        viewKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Observes} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {ViewFactory} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerSetDescriptor} from \"./ControllerSet\";\nimport type {ControllerSetClass} from \"./ControllerSet\";\nimport {ControllerSet} from \"./ControllerSet\";\n\n/** @public */\nexport interface ViewControllerSetDescriptor<R, V extends View, C extends Controller> extends ControllerSetDescriptor<R, C> {\n  extends?: Proto<ViewControllerSet<any, any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface ViewControllerSetClass<F extends ViewControllerSet<any, any, any, any> = ViewControllerSet<any, any, any, any>> extends ControllerSetClass<F> {\n}\n\n/** @public */\nexport interface ViewControllerSet<R = any, V extends View = View, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerSet<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<ViewControllerSetDescriptor<R, V, C>>;\n\n  get viewType(): ViewFactory<V> | null;\n\n  /** @protected */\n  viewKey(view: V): string | undefined;\n\n  get observesView(): boolean;\n\n  /** @internal */\n  readonly viewControllers: {readonly [viewId: string]: C | undefined};\n\n  getViewController(view: V): C | null;\n\n  /** @protected */\n  associateViewController(view: V, controller: C): void;\n\n  /** @protected */\n  dissociateViewController(view: V, controller: C): void;\n\n  /** @internal */\n  readonly views: {readonly [viewId: string]: V | undefined};\n\n  readonly viewCount: number;\n\n  hasView(view: View): boolean;\n\n  addView(view?: V | LikeType<V>, targetController?: Controller | null, controllerKey?: string): V;\n\n  addViews(views: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void;\n\n  setViews(views: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void;\n\n  attachView(view?: V | LikeType<V> | null, targetController?: Controller | null): V;\n\n  /** @protected */\n  initView(view: V): void;\n\n  /** @protected */\n  willAttachView(view: V, targetController: Controller | null): void;\n\n  /** @protected */\n  onAttachView(view: V, targetController: Controller | null): void;\n\n  /** @protected */\n  didAttachView(view: V, targetController: Controller | null): void;\n\n  attachViews(views: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void;\n\n  detachView(view: V): V | null;\n\n  /** @protected */\n  deinitView(view: V): void;\n\n  /** @protected */\n  willDetachView(view: V): void;\n\n  /** @protected */\n  onDetachView(view: V): void;\n\n  /** @protected */\n  didDetachView(view: V): void;\n\n  detachViews(views?: {readonly [viewId: string]: V | undefined}): void;\n\n  insertView(parent?: Controller | null, view?: V | LikeType<V>, targetController?: Controller | null, controllerKey?: string): V;\n\n  insertViews(parent: Controller | null, views: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void;\n\n  removeView(view: V): V | null;\n\n  removeViews(views?: {readonly [viewId: string]: V | undefined}): void;\n\n  deleteView(view: V): V | null;\n\n  deleteViews(views?: {readonly [viewId: string]: V | undefined}): void;\n\n  reinsertView(view: V, targetView?: V | null): void;\n\n  createView(): V;\n\n  /** @protected */\n  fromViewLike(value: V | LikeType<V>): V;\n\n  /** @protected */\n  detectControllerView(controller: Controller): V | null;\n\n  /** @protected */\n  insertControllerView(controller: C, view: V | null, targetView: View | null, viewKey: string | undefined): void;\n\n  /** @override */\n  detectController(controller: Controller): C | null;\n\n  /** @protected @override */\n  onAttachController(controller: C, targetController: Controller | null): void;\n\n  /** @protected @override */\n  onDetachController(controller: C): void;\n\n  /** @override */\n  createController(view?: V): C;\n\n  /** @protected @override */\n  compare(a: C, b: C): number;\n\n  /** @protected */\n  compareViews(a: V, b: V): number;\n}\n\n/** @public */\nexport const ViewControllerSet = (<R, V extends View, C extends Controller, I extends any[], F extends ViewControllerSet<any, any, any, any>>() => ControllerSet.extend<ViewControllerSet<R, V, C, I>, ViewControllerSetClass<F>>(\"ViewControllerSet\", {\n  viewType: null,\n\n  viewKey(view: V): string | undefined {\n    return void 0;\n  },\n\n  observesView: false,\n\n  getViewController(view: V): C | null {\n    const controller = this.viewControllers[view.uid];\n    return controller !== void 0 ? controller : null;\n  },\n\n  associateViewController(view: V, controller: C): void {\n    const viewControllers = this.viewControllers as {[viewId: string]: C | undefined};\n    viewControllers[view.uid] = controller;\n  },\n\n  dissociateViewController(view: V, controller: C): void {\n    const viewControllers = this.viewControllers as {[viewId: string]: C | undefined};\n    delete viewControllers[view.uid];\n  },\n\n  hasView(view: View): boolean {\n    return this.views[view.uid] !== void 0;\n  },\n\n  addView(newView?: V | LikeType<V>, targetController?: Controller | null, controllerKey?: string): V {\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromViewLike(newView);\n    } else {\n      newView = this.createView();\n    }\n    let controller = this.getViewController(newView);\n    if (controller === null) {\n      controller = this.createController(newView);\n    }\n    this.addController(controller, targetController, controllerKey);\n    return newView;\n  },\n\n  addViews(newViews: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void {\n    for (const viewId in newViews) {\n      this.addView(newViews[viewId]!, targetController);\n    }\n  },\n\n  setViews(newViews: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void {\n    const views = this.views;\n    for (const viewId in views) {\n      if (newViews[viewId] === void 0) {\n        this.detachView(views[viewId]!);\n      }\n    }\n    for (const viewId in newViews) {\n      if (views[viewId] === void 0) {\n        this.attachView(newViews[viewId]!, targetController);\n      }\n    }\n  },\n\n  attachView(newView?: V | LikeType<V> | null, targetController?: Controller | null): V {\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromViewLike(newView);\n    } else {\n      newView = this.createView();\n    }\n    const views = this.views as {[viewId: string]: V | undefined};\n    if (views[newView.uid] !== void 0) {\n      return newView;\n    }\n    views[newView.uid] = newView;\n    (this as Mutable<typeof this>).viewCount += 1;\n    if (targetController === void 0) {\n      targetController = null;\n    }\n    let controller = this.getViewController(newView);\n    if (controller === null) {\n      controller = this.createController(newView);\n    }\n    this.attachController(controller, targetController);\n    this.willAttachView(newView, targetController);\n    this.onAttachView(newView, targetController);\n    this.initView(newView);\n    this.didAttachView(newView, targetController);\n    return newView;\n  },\n\n  initView(view: V): void {\n    // hook\n  },\n\n  willAttachView(view: V, targetController: Controller | null): void {\n    // hook\n  },\n\n  onAttachView(view: V, targetController: Controller | null): void {\n    if (this.observesView) {\n      view.observe(this as Observes<V>);\n    }\n  },\n\n  didAttachView(view: V, targetController: Controller | null): void {\n    // hook\n  },\n\n  attachViews(newViews: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void {\n    for (const viewId in newViews) {\n      this.attachView(newViews[viewId]!, targetController);\n    }\n  },\n\n  detachView(oldView: V): V | null {\n    const views = this.views as {[viewId: string]: V | undefined};\n    if (views[oldView.uid] === void 0) {\n      return null;\n    }\n    (this as Mutable<typeof this>).viewCount -= 1;\n    delete views[oldView.uid];\n    this.willDetachView(oldView);\n    this.onDetachView(oldView);\n    this.deinitView(oldView);\n    this.didDetachView(oldView);\n    const controller = this.getViewController(oldView);\n    if (controller !== null) {\n      this.detachController(controller);\n    }\n    return oldView;\n  },\n\n  deinitView(view: V): void {\n    // hook\n  },\n\n  willDetachView(view: V): void {\n    // hook\n  },\n\n  onDetachView(view: V): void {\n    if (this.observesView) {\n      view.unobserve(this as Observes<V>);\n    }\n  },\n\n  didDetachView(view: V): void {\n    // hook\n  },\n\n  detachViews(views?: {readonly [viewId: string]: V | undefined}): void {\n    if (views === void 0) {\n      views = this.views;\n    }\n    for (const viewId in views) {\n      this.detachView(views[viewId]!);\n    }\n  },\n\n  insertView(parent?: Controller | null, newView?: V | LikeType<V>, targetController?: Controller | null, controllerKey?: string): V {\n    if (newView !== void 0 && newView !== null) {\n      newView = this.fromViewLike(newView);\n    } else {\n      newView = this.createView();\n    }\n    let controller = this.getViewController(newView);\n    if (controller === null) {\n      controller = this.createController(newView);\n    }\n    this.insertController(parent, controller, targetController, controllerKey);\n    return newView;\n  },\n\n  insertViews(parent: Controller | null, newViews: {readonly [viewId: string]: V | undefined}, targetController?: Controller | null): void {\n    for (const viewId in newViews) {\n      this.insertView(parent, newViews[viewId]!, targetController);\n    }\n  },\n\n  removeView(view: V): V | null {\n    if (!this.hasView(view)) {\n      return null;\n    }\n    view.remove();\n    return view;\n  },\n\n  removeViews(views?: {readonly [viewId: string]: V | undefined}): void {\n    if (views === void 0) {\n      views = this.views;\n    }\n    for (const viewId in views) {\n      this.removeView(views[viewId]!);\n    }\n  },\n\n  deleteView(view: V): V | null {\n    const oldView = this.detachView(view);\n    if (oldView === null) {\n      return null;\n    }\n    oldView.remove();\n    return oldView;\n  },\n\n  deleteViews(views?: {readonly [viewId: string]: V | undefined}): void {\n    if (views === void 0) {\n      views = this.views;\n    }\n    for (const viewId in views) {\n      this.deleteView(views[viewId]!);\n    }\n  },\n\n  reinsertView(view: V, targetView: V | null): void {\n    const controller = this.getViewController(view);\n    if (controller === null) {\n      return;\n    }\n    const targetController = targetView !== null ? this.getViewController(targetView) : null;\n    this.reinsertController(controller, targetController);\n  },\n\n  createView(): V {\n    let view: V | undefined;\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      view = viewType.create();\n    }\n    if (view === void 0 || view === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new Error(message);\n    }\n    return view;\n  },\n\n  fromViewLike(value: V | LikeType<V>): V {\n    const viewType = this.viewType;\n    if (viewType !== null) {\n      return viewType.fromLike(value);\n    }\n    return View.fromLike(value) as V;\n  },\n\n  detectControllerView(controller: Controller): V | null {\n    return null; // hook\n  },\n\n  insertControllerView(controller: C, view: V, targetView: View | null, viewKey: string | undefined): void {\n    // hook\n  },\n\n  detectController(controller: Controller): C | null {\n    if (this.detectControllerView(controller) !== null) {\n      return controller as C;\n    }\n    return null;\n  },\n\n  onAttachController(controller: C, targetController: Controller | null): void {\n    const view = this.detectControllerView(controller);\n    if (view !== null) {\n      this.associateViewController(view, controller);\n      this.attachView(view, targetController);\n    }\n    super.onAttachController(controller, targetController);\n  },\n\n  onDetachController(controller: C): void {\n    super.onDetachController(controller);\n    const view = this.detectControllerView(controller);\n    if (view !== null) {\n      this.detachView(view);\n      this.dissociateViewController(view, controller);\n    }\n  },\n\n  createController(view?: V): C {\n    const controller = super.createController() as C;\n    if (view === void 0) {\n      view = this.createView();\n    }\n    const viewKey = this.viewKey(view);\n    this.insertControllerView(controller, view, null, viewKey);\n    return controller;\n  },\n\n  compare(a: C, b: C): number {\n    const x = this.detectControllerView(a);\n    const y = this.detectControllerView(b);\n    if (x !== null && y !== null) {\n      return this.compareViews(x, y);\n    }\n    return x !== null ? 1 : y !== null ? -1 : 0;\n  },\n\n  compareViews(a: V, b: V): number {\n    return a.uid < b.uid ? -1 : a.uid > b.uid ? 1 : 0;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).viewControllers = {};\n    (fastener as Mutable<typeof fastener>).views = {};\n    (fastener as Mutable<typeof fastener>).viewCount = 0;\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {TraitFactory} from \"@swim/model\";\nimport {Trait} from \"@swim/model\";\nimport type {TraitRef} from \"@swim/model\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerRefDescriptor} from \"./ControllerRef\";\nimport type {ControllerRefClass} from \"./ControllerRef\";\nimport {ControllerRef} from \"./ControllerRef\";\n\n/** @public */\nexport interface TraitControllerRefDescriptor<R, T extends Trait, C extends Controller> extends ControllerRefDescriptor<R, C> {\n  extends?: Proto<TraitControllerRef<any, any, any, any>> | boolean | null;\n  traitKey?: string | boolean;\n}\n\n/** @public */\nexport interface TraitControllerRefClass<F extends TraitControllerRef<any, any, any, any> = TraitControllerRef<any, any, any, any>> extends ControllerRefClass<F> {\n}\n\n/** @public */\nexport interface TraitControllerRef<R = any, T extends Trait = Trait, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerRef<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitControllerRefDescriptor<R, T, C>>;\n\n  getTraitRef(controller: C): TraitRef<any, T>;\n\n  /** @override */\n  set(traitOrController: T | C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  /** @override */\n  setIntrinsic(traitOrController: T | C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  get traitType(): TraitFactory<T> | null;\n\n  get traitKey(): string | undefined;\n\n  get trait(): T | null;\n\n  getTrait(): T;\n\n  setTrait(trait: T | LikeType<T> | null, targetTrait?: Trait | null, key?: string): C | null;\n\n  attachTrait(trait?: T | LikeType<T> | null, targetTrait?: Trait | null): C;\n\n  /** @protected */\n  initTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  detachTrait(trait?: T): C | null;\n\n  /** @protected */\n  deinitTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  onDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  didDetachTrait(trait: T, controller: C): void;\n\n  insertTrait(parent?: Controller | null, trait?: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C;\n\n  removeTrait(trait: T | null): C | null;\n\n  deleteTrait(trait: T | null): C | null;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromTraitLike(value: T | LikeType<T>): T;\n\n  /** @protected @override */\n  onAttachController(controller: C, targetController: Controller | null): void;\n\n  /** @protected @override */\n  onDetachController(controller: C): void;\n\n  createController(trait?: T): C;\n}\n\n/** @public */\nexport const TraitControllerRef = (<R, T extends Trait, C extends Controller, I extends any[], F extends TraitControllerRef<any, any, any, any>>() => ControllerRef.extend<TraitControllerRef<R, T, C, I>, TraitControllerRefClass<F>>(\"TraitControllerRef\", {\n  getTraitRef(controller: C): TraitRef<any, T> {\n    throw new Error(\"missing implementation\");\n  },\n\n  set(traitOrController: T | C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (traitOrController instanceof Fastener) {\n      this.bindInlet(traitOrController);\n    } else if (traitOrController instanceof Trait) {\n      this.setTrait(traitOrController);\n    } else {\n      this.setController(traitOrController);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(traitOrController: T | C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (traitOrController instanceof Fastener) {\n      this.bindInlet(traitOrController);\n    } else if (traitOrController instanceof Trait) {\n      this.setTrait(traitOrController);\n    } else {\n      this.setController(traitOrController);\n    }\n    return this.owner;\n  },\n\n  traitType: null,\n\n  traitKey: void 0,\n\n  get trait(): T | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitRef = this.getTraitRef(controller);\n    return traitRef.trait;\n  },\n\n  getTrait(): T {\n    const trait = this.trait;\n    if (trait === null) {\n      let message = trait + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new TypeError(message);\n    }\n    return trait;\n  },\n\n  setTrait(trait: T | LikeType<T> | null, targetTrait?: Trait | null, key?: string): C | null {\n    let controller = this.controller;\n    if (trait !== null) {\n      trait = this.fromTraitLike(trait);\n      if (controller === null) {\n        controller = this.createController(trait);\n      }\n      const traitRef = this.getTraitRef(controller);\n      traitRef.setTrait(trait, targetTrait, this.traitKey);\n      this.setController(controller, null, key);\n    } else if (controller !== null) {\n      const traitRef = this.getTraitRef(controller);\n      traitRef.setTrait(null);\n    }\n    return controller;\n  },\n\n  attachTrait(trait?: T | LikeType<T> | null, targetTrait?: Trait | null): C {\n    if (trait === void 0 || trait === null) {\n      trait = this.createTrait();\n    } else {\n      trait = this.fromTraitLike(trait);\n    }\n    let controller = this.controller;\n    if (controller === null) {\n      controller = this.createController(trait);\n    }\n    const traitRef = this.getTraitRef(controller);\n    traitRef.setTrait(trait, targetTrait, this.traitKey);\n    this.attachController(controller, null);\n    return controller;\n  },\n\n  initTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  detachTrait(trait?: T): C | null {\n    const controller = this.controller;\n    if (controller === null || this.getTraitRef(controller).trait !== trait) {\n      return null;\n    }\n    this.willDetachTrait(trait, controller);\n    this.onDetachTrait(trait, controller);\n    this.deinitTrait(trait, controller);\n    this.didDetachTrait(trait, controller);\n    return controller;\n  },\n\n  deinitTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  didDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  insertTrait(parent?: Controller | null, trait?: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C {\n    if (trait === void 0 || trait === null) {\n      trait = this.createTrait();\n    } else {\n      trait = this.fromTraitLike(trait);\n    }\n    let controller = this.controller;\n    if (controller === null) {\n      controller = this.createController(trait);\n    }\n    const traitRef = this.getTraitRef(controller);\n    traitRef.setTrait(trait, targetTrait, this.traitKey);\n    this.insertController(parent, controller);\n    return controller;\n  },\n\n  removeTrait(trait: T | null): C | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitRef = this.getTraitRef(controller);\n    if (traitRef.trait !== trait) {\n      return null;\n    }\n    controller.remove();\n    return controller;\n  },\n\n  deleteTrait(trait: T | null): C | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitRef = this.getTraitRef(controller);\n    if (traitRef.trait !== trait) {\n      return null;\n    }\n    controller.remove();\n    this.setController(null);\n    return controller;\n  },\n\n  fromTraitLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  onAttachController(controller: C, targetController: Controller | null): void {\n    const trait = this.getTraitRef(controller).trait;\n    if (trait !== null) {\n      const targetTrait = targetController !== null ? this.getTraitRef(targetController as C).trait : null;\n      this.attachTrait(trait, targetTrait);\n    }\n    super.onAttachController(controller, targetController);\n  },\n\n  onDetachController(controller: C): void {\n    super.onDetachController(controller);\n    const trait = this.getTraitRef(controller).trait;\n    if (trait !== null) {\n      this.detachTrait(trait);\n    }\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<TraitControllerRef<any, any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const traitKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"traitKey\");\n    if (traitKeyDescriptor !== void 0 && \"value\" in traitKeyDescriptor) {\n      if (traitKeyDescriptor.value === true) {\n        traitKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      } else if (traitKeyDescriptor.value === false) {\n        traitKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {TraitFactory} from \"@swim/model\";\nimport {Trait} from \"@swim/model\";\nimport type {TraitRef} from \"@swim/model\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerSetDescriptor} from \"./ControllerSet\";\nimport type {ControllerSetClass} from \"./ControllerSet\";\nimport {ControllerSet} from \"./ControllerSet\";\n\n/** @public */\nexport interface TraitControllerSetDescriptor<R, T extends Trait, C extends Controller> extends ControllerSetDescriptor<R, C> {\n  extends?: Proto<TraitControllerSet<any, any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface TraitControllerSetClass<F extends TraitControllerSet<any, any, any, any> = TraitControllerSet<any, any, any, any>> extends ControllerSetClass<F> {\n}\n\n/** @public */\nexport interface TraitControllerSet<R = any, T extends Trait = Trait, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerSet<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitControllerSetDescriptor<R, T, C>>;\n\n  get traitType(): TraitFactory<T> | null;\n\n  getTraitRef(controller: C): TraitRef<any, T>;\n\n  /** @internal */\n  readonly traitControllers: {readonly [traitId: string]: C | undefined};\n\n  hasTrait(trait: Trait): boolean;\n\n  addTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C;\n\n  addTraits(traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null): void;\n\n  setTraits(traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null): void;\n\n  attachTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, controller?: C): C;\n\n  /** @protected */\n  initTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  attachTraits(traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null): void;\n\n  detachTrait(trait: T): C | null;\n\n  /** @protected */\n  deinitTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  onDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  didDetachTrait(trait: T, controller: C): void;\n\n  detachTraits(traits: {readonly [traitId: string]: T | undefined}): void;\n\n  insertTrait(parent: Controller | null | undefined, trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C;\n\n  insertTraits(parent: Controller | null | undefined, traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null, key?: string): void;\n\n  removeTrait(trait: T): C | null;\n\n  removeTraits(traits: {readonly [traitId: string]: T | undefined}): void;\n\n  deleteTrait(trait: T): C | null;\n\n  deleteTraits(traits: {readonly [traitId: string]: T | undefined}): void;\n\n  reinsertTrait(trait: T, targetTrait?: T | null): void;\n\n  consumeTraits(consumer: Consumer): void;\n\n  unconsumeTraits(consumer: Consumer): void;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromTraitLike(value: T | LikeType<T>): T;\n\n  /** @protected @override */\n  onAttachController(controller: C, targetController: Controller | null): void;\n\n  /** @protected @override */\n  onDetachController(controller: C): void;\n\n  /** @override */\n  createController(trait?: T): C;\n}\n\n/** @public */\nexport const TraitControllerSet = (<R, T extends Trait, C extends Controller, I extends any[], F extends TraitControllerSet<any, any, any, any>>() => ControllerSet.extend<TraitControllerSet<R, T, C, I>, TraitControllerSetClass<F>>(\"TraitControllerSet\", {\n  getTraitRef(controller: C): TraitRef<any, T> {\n    throw new Error(\"missing implementation\");\n  },\n\n  traitType: null,\n\n  hasTrait(trait: Trait): boolean {\n    return this.traitControllers[trait.uid] !== void 0;\n  },\n\n  addTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C {\n    trait = this.fromTraitLike(trait);\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    let controller = traitControllers[trait.uid];\n    if (controller !== void 0) {\n      return controller;\n    } else if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    controller = this.createController(trait);\n    const traitRef = this.getTraitRef(controller);\n    traitRef.setTrait(trait, targetTrait, key);\n    const targetController = targetTrait !== null ? traitControllers[targetTrait.uid] : void 0;\n    this.addController(controller, targetController, key);\n    return controller;\n  },\n\n  addTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    for (const traitId in newTraits) {\n      this.addTrait(newTraits[traitId]!, target);\n    }\n  },\n\n  setTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    const binds = this.binds;\n    const parent = binds ? this.parentController : null;\n    const traitControllers = this.traitControllers;\n    for (const traitId in traitControllers) {\n      if (newTraits[traitId] === void 0) {\n        const oldController = this.detachController(traitControllers[traitId]!);\n        if (oldController !== null && binds && parent !== null && oldController.parent === parent) {\n          oldController.remove();\n        }\n      }\n    }\n    if ((this.flags & ControllerSet.OrderedFlag) !== 0) {\n      const orderedTraits = new Array<T>();\n      for (const traitId in newTraits) {\n        orderedTraits.push(newTraits[traitId]!);\n      }\n      for (let i = 0, n = orderedTraits.length; i < n; i += 1) {\n        const newController = orderedTraits[i]!;\n        if (traitControllers[newController.uid] === void 0) {\n          const targetTrait = i < n + 1 ? orderedTraits[i + 1] : target;\n          this.addTrait(newController, targetTrait);\n        }\n      }\n    } else {\n      for (const traitId in newTraits) {\n        if (traitControllers[traitId] === void 0) {\n          this.addTrait(newTraits[traitId]!, target);\n        }\n      }\n    }\n  },\n\n  attachTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, controller?: C): C {\n    trait = this.fromTraitLike(trait);\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    if (controller === void 0) {\n      controller = traitControllers[trait.uid];\n    }\n    if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    if (controller === void 0) {\n      controller = this.createController();\n      const traitRef = this.getTraitRef(controller);\n      traitRef.setTrait(trait, targetTrait);\n      const targetController = targetTrait !== null ? traitControllers[targetTrait.uid] : void 0;\n      this.attachController(controller, targetController);\n    }\n    if (traitControllers[trait.uid] !== void 0) {\n      return controller;\n    }\n    traitControllers[trait.uid] = controller;\n    this.willAttachTrait(trait, targetTrait, controller);\n    this.onAttachTrait(trait, targetTrait, controller);\n    this.initTrait(trait, controller);\n    this.didAttachTrait(trait, targetTrait, controller);\n    return controller;\n  },\n\n  initTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  attachTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    for (const traitId in newTraits) {\n      this.attachTrait(newTraits[traitId]!, target);\n    }\n  },\n\n  detachTrait(trait: T): C | null {\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    const controller = traitControllers[trait.uid];\n    if (controller === void 0) {\n      return null;\n    }\n    delete traitControllers[trait.uid];\n    this.willDetachTrait(trait, controller);\n    this.onDetachTrait(trait, controller);\n    this.deinitTrait(trait, controller);\n    this.didDetachTrait(trait, controller);\n    return controller;\n  },\n\n  deinitTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  didDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  detachTraits(traits: {readonly [traitId: string]: T | undefined}): void {\n    for (const traitId in traits) {\n      this.detachTrait(traits[traitId]!);\n    }\n  },\n\n  insertTrait(parent: Controller | null | undefined, trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C {\n    trait = this.fromTraitLike(trait);\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    let controller = traitControllers[trait.uid];\n    if (controller !== void 0) {\n      return controller;\n    } else if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    controller = this.createController();\n    const traitRef = this.getTraitRef(controller);\n    traitRef.setTrait(trait, targetTrait);\n    const targetController = targetTrait !== null ? traitControllers[targetTrait.uid] : void 0;\n    this.insertController(parent, controller, targetController, key);\n    return controller;\n  },\n\n  insertTraits(parent: Controller | null | undefined, newTraits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null, key?: string): void {\n    for (const traitId in newTraits) {\n      this.insertTrait(parent, newTraits[traitId]!, targetTrait, key);\n    }\n  },\n\n  removeTrait(trait: T): C | null {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const traitRef = this.getTraitRef(controller);\n      if (traitRef.trait !== trait) {\n        continue;\n      }\n      this.removeController(controller);\n      return controller;\n    }\n    return null;\n  },\n\n  removeTraits(traits: {readonly [traitId: string]: T | undefined}): void {\n    for (const traitId in traits) {\n      this.removeTrait(traits[traitId]!);\n    }\n  },\n\n  deleteTrait(trait: T): C | null {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const traitRef = this.getTraitRef(controller);\n      if (traitRef.trait !== trait) {\n        continue;\n      }\n      this.deleteController(controller);\n      return controller;\n    }\n    return null;\n  },\n\n  deleteTraits(traits: {readonly [traitId: string]: T | undefined}): void {\n    for (const traitId in traits) {\n      this.deleteTrait(traits[traitId]!);\n    }\n  },\n\n  reinsertTrait(trait: T, targetTrait: T | null): void {\n    const controller = this.traitControllers[trait.uid];\n    if (controller === void 0) {\n      return;\n    }\n    const targetController = targetTrait !== null ? this.traitControllers[targetTrait.uid] : void 0;\n    this.reinsertController(controller, targetController !== void 0 ? targetController : null);\n  },\n\n  consumeTraits(consumer: Consumer): void {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const trait = this.getTraitRef(controller).trait;\n      if (trait !== null) {\n        trait.consume(consumer);\n      }\n    }\n  },\n\n  unconsumeTraits(consumer: Consumer): void {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const trait = this.getTraitRef(controller).trait;\n      if (trait !== null) {\n        trait.unconsume(consumer);\n      }\n    }\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n\n  fromTraitLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  onAttachController(controller: C, targetController: Controller | null): void {\n    const trait = this.getTraitRef(controller).trait;\n    if (trait !== null) {\n      const targetTrait = targetController !== null && this.hasController(targetController) ? this.getTraitRef(targetController as C).trait : null;\n      this.attachTrait(trait, targetTrait, controller);\n    }\n    super.onAttachController(controller, targetController);\n  },\n\n  onDetachController(controller: C): void {\n    super.onDetachController(controller);\n    const trait = this.getTraitRef(controller).trait;\n    if (trait !== null) {\n      this.detachTrait(trait);\n    }\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).traitControllers = {};\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {FastenerClass} from \"@swim/component\";\nimport {Fastener} from \"@swim/component\";\nimport type {TraitFactory} from \"@swim/model\";\nimport {Trait} from \"@swim/model\";\nimport type {ViewFactory} from \"@swim/view\";\nimport {View} from \"@swim/view\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerRefDescriptor} from \"./ControllerRef\";\nimport type {ControllerRefClass} from \"./ControllerRef\";\nimport {ControllerRef} from \"./ControllerRef\";\nimport type {TraitViewRef} from \"./TraitViewRef\";\n\n/** @public */\nexport interface TraitViewControllerRefDescriptor<R, T extends Trait, V extends View, C extends Controller> extends ControllerRefDescriptor<R, C> {\n  extends?: Proto<TraitViewControllerRef<any, any, any, any, any>> | boolean | null;\n  traitKey?: string | boolean;\n  viewKey?: string | boolean;\n}\n\n/** @public */\nexport interface TraitViewControllerRefClass<F extends TraitViewControllerRef<any, any, any, any, any> = TraitViewControllerRef<any, any, any, any, any>> extends ControllerRefClass<F> {\n}\n\n/** @public */\nexport interface TraitViewControllerRef<R = any, T extends Trait = Trait, V extends View = View, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerRef<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitViewControllerRefDescriptor<R, T, V, C>>;\n\n  getTraitViewRef(controller: C): TraitViewRef<any, T, V>;\n\n  set(traitOrViewOrController: T | V | C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  setIntrinsic(traitOrViewOrController: T | V | C | LikeType<C> | Fastener<any, I[0], any> | null): R;\n\n  get traitType(): TraitFactory<T> | null;\n\n  get traitKey(): string | undefined;\n\n  get trait(): T | null;\n\n  getTrait(): T;\n\n  setTrait(trait: T | LikeType<T> | null, targetTrait?: Trait | null, key?: string): C | null;\n\n  attachTrait(trait?: T | LikeType<T> | null, targetTrait?: Trait | null): C;\n\n  /** @protected */\n  initTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  detachTrait(trait?: T): C | null;\n\n  /** @protected */\n  deinitTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  onDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  didDetachTrait(trait: T, controller: C): void;\n\n  insertTrait(parent?: Controller | null, trait?: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C;\n\n  removeTrait(trait: T | null): C | null;\n\n  deleteTrait(trait: T | null): C | null;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromTraitLike(value: T | LikeType<T>): T;\n\n  get viewType(): ViewFactory<V> | null;\n\n  get viewKey(): string | undefined;\n\n  get view(): V | null;\n\n  getView(): V;\n\n  setView(view: V | LikeType<V> | null, targetView?: View | null, key?: string): V | null;\n\n  attachView(view?: V | LikeType<V> | null, targetView?: View | null): V;\n\n  detachView(): V | null;\n\n  get parentView(): View | null;\n\n  insertView(parentView?: View | null, view?: V | LikeType<V>, targetView?: View | null, key?: string): V;\n\n  removeView(): V | null;\n\n  deleteView(): V | null;\n\n  createView(): V | null;\n\n  /** @protected */\n  fromViewLike(value: V | LikeType<V>): V | LikeType<V>;\n\n  /** @override */\n  createController(trait?: T): C;\n}\n\n/** @public */\nexport const TraitViewControllerRef = (<R, T extends Trait, V extends View, C extends Controller, I extends any[], F extends TraitViewControllerRef<any, any, any, any, any>>() => ControllerRef.extend<TraitViewControllerRef<R, T, V, C, I>, TraitViewControllerRefClass<F>>(\"TraitViewControllerRef\", {\n  getTraitViewRef(controller: C): TraitViewRef<any, T, V> {\n    throw new Error(\"missing implementation\");\n  },\n\n  set(traitOrViewOrController: T | V | C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (traitOrViewOrController instanceof Fastener) {\n      this.bindInlet(traitOrViewOrController);\n    } else if (traitOrViewOrController instanceof Trait) {\n      this.setTrait(traitOrViewOrController);\n    } else if (traitOrViewOrController instanceof View) {\n      this.setView(traitOrViewOrController);\n    } else {\n      this.setController(traitOrViewOrController);\n    }\n    return this.owner;\n  },\n\n  setIntrinsic(traitOrViewOrController: T | V | C | LikeType<C> | Fastener<any, I[0], any> | null): R {\n    if (traitOrViewOrController instanceof Fastener) {\n      this.bindInlet(traitOrViewOrController);\n    } else if (traitOrViewOrController instanceof Trait) {\n      this.setTrait(traitOrViewOrController);\n    } else if (traitOrViewOrController instanceof View) {\n      this.setView(traitOrViewOrController);\n    } else {\n      this.setController(traitOrViewOrController);\n    }\n    return this.owner;\n  },\n\n  traitType: null,\n\n  traitKey: void 0,\n\n  get trait(): T | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    return traitViewRef.trait;\n  },\n\n  getTrait(): T {\n    const trait = this.trait;\n    if (trait === null) {\n      let message = trait + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new TypeError(message);\n    }\n    return trait;\n  },\n\n  setTrait(trait: T | LikeType<T> | null, targetTrait?: Trait | null, key?: string): C | null {\n    let controller = this.controller;\n    if (trait !== null) {\n      trait = this.fromTraitLike(trait);\n      if (controller === null) {\n        controller = this.createController(trait);\n      }\n      const traitViewRef = this.getTraitViewRef(controller);\n      traitViewRef.setTrait(trait, targetTrait, this.traitKey);\n      this.setController(controller);\n      if (traitViewRef.view === null) {\n        traitViewRef.insertView(this.parentView, null, null, this.viewKey);\n      }\n    } else if (controller !== null) {\n      const traitViewRef = this.getTraitViewRef(controller);\n      traitViewRef.setTrait(null);\n    }\n    return controller;\n  },\n\n  attachTrait(trait?: T | LikeType<T> | null, targetTrait?: Trait | null): C {\n    if (trait === void 0 || trait === null) {\n      trait = this.createTrait();\n    } else {\n      trait = this.fromTraitLike(trait);\n    }\n    let controller = this.controller;\n    if (controller === null) {\n      controller = this.createController(trait);\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    traitViewRef.setTrait(trait, targetTrait, this.traitKey);\n    this.attachController(controller, null);\n    return controller;\n  },\n\n  initTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  detachTrait(trait?: T): C | null {\n    const controller = this.controller;\n    if (controller === null || this.getTraitViewRef(controller).trait !== trait) {\n      return null;\n    }\n    this.willDetachTrait(trait, controller);\n    this.onDetachTrait(trait, controller);\n    this.deinitTrait(trait, controller);\n    this.didDetachTrait(trait, controller);\n    return controller;\n  },\n\n  deinitTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  didDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  insertTrait(parent?: Controller | null, trait?: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C {\n    if (trait === void 0 || trait === null) {\n      trait = this.createTrait();\n    } else {\n      trait = this.fromTraitLike(trait);\n    }\n    let controller = this.controller;\n    if (controller === null) {\n      controller = this.createController(trait);\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    traitViewRef.setTrait(trait, targetTrait, this.traitKey);\n    this.insertController(parent, controller);\n    return controller;\n  },\n\n  removeTrait(trait: T | null): C | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    if (traitViewRef.trait !== trait) {\n      return null;\n    }\n    controller.remove();\n    return controller;\n  },\n\n  deleteTrait(trait: T | null): C | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    if (traitViewRef.trait !== trait) {\n      return null;\n    }\n    controller.remove();\n    this.setController(null);\n    return controller;\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n\n  fromTraitLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  viewType: null,\n\n  viewKey: void 0,\n\n  get view(): V | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    return traitViewRef.view;\n  },\n\n  getView(): V {\n    const view = this.view;\n    if (view === null) {\n      let message = view + \" \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"view\";\n      throw new TypeError(message);\n    }\n    return view;\n  },\n\n  setView(view: V | LikeType<V> | null, targetView?: View | null, key?: string): V | null {\n    if (view !== null) {\n      view = this.fromViewLike(view);\n    }\n    const controller = this.attachController();\n    const traitViewRef = this.getTraitViewRef(controller);\n    if (key === void 0) {\n      key = this.viewKey;\n    }\n    return traitViewRef.setView(view, targetView, key);\n  },\n\n  attachView(view?: V | LikeType<V> | null, targetView?: View | null): V {\n    if (view !== void 0 && view !== null) {\n      view = this.fromViewLike(view);\n    } else {\n      view = this.createView();\n    }\n    const controller = this.attachController();\n    const traitViewRef = this.getTraitViewRef(controller);\n    return traitViewRef.attachView(view, targetView);\n  },\n\n  detachView(): V | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    return traitViewRef.detachView();\n  },\n\n  get parentView(): View | null {\n    return null;\n  },\n\n  insertView(parentView?: View | null, view?: V | LikeType<V>, targetView?: View | null, key?: string): V {\n    const controller = this.attachController();\n    const traitViewRef = this.getTraitViewRef(controller);\n    if (parentView === void 0 || parentView === null) {\n      parentView = this.parentView;\n    }\n    if (key === void 0) {\n      key = this.viewKey;\n    }\n    return traitViewRef.insertView(parentView, view, targetView, key);\n  },\n\n  removeView(): V | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    return traitViewRef.removeView();\n  },\n\n  deleteView(): V | null {\n    const controller = this.controller;\n    if (controller === null) {\n      return null;\n    }\n    const traitViewRef = this.getTraitViewRef(controller);\n    return traitViewRef.deleteView();\n  },\n\n  createView(): V | null {\n    const viewType = this.viewType;\n    if (viewType === null) {\n      return null;\n    }\n    return viewType.create();\n  },\n\n  fromViewLike(value: V | LikeType<V>): V | LikeType<V> {\n    const viewType = this.viewType;\n    if (viewType === null) {\n      return value;\n    }\n    return viewType.fromLike(value);\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    return fastener;\n  },\n\n  refine(fastenerClass: FastenerClass<TraitViewControllerRef<any, any, any, any, any>>): void {\n    super.refine(fastenerClass);\n    const fastenerPrototype = fastenerClass.prototype;\n\n    const traitKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"traitKey\");\n    if (traitKeyDescriptor !== void 0 && \"value\" in traitKeyDescriptor) {\n      if (traitKeyDescriptor.value === true) {\n        traitKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      } else if (traitKeyDescriptor.value === false) {\n        traitKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"traitKey\", traitKeyDescriptor);\n      }\n    }\n\n    const viewKeyDescriptor = Object.getOwnPropertyDescriptor(fastenerPrototype, \"viewKey\");\n    if (viewKeyDescriptor !== void 0 && \"value\" in viewKeyDescriptor) {\n      if (viewKeyDescriptor.value === true) {\n        viewKeyDescriptor.value = fastenerClass.name;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      } else if (viewKeyDescriptor.value === false) {\n        viewKeyDescriptor.value = void 0;\n        Object.defineProperty(fastenerPrototype, \"viewKey\", viewKeyDescriptor);\n      }\n    }\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Proto} from \"@swim/util\";\nimport type {LikeType} from \"@swim/util\";\nimport type {Consumer} from \"@swim/util\";\nimport type {Fastener} from \"@swim/component\";\nimport type {TraitFactory} from \"@swim/model\";\nimport {Trait} from \"@swim/model\";\nimport type {ViewFactory} from \"@swim/view\";\nimport type {View} from \"@swim/view\";\nimport type {Controller} from \"./Controller\";\nimport type {ControllerSetDescriptor} from \"./ControllerSet\";\nimport type {ControllerSetClass} from \"./ControllerSet\";\nimport {ControllerSet} from \"./ControllerSet\";\nimport type {TraitViewRef} from \"./TraitViewRef\";\n\n/** @public */\nexport interface TraitViewControllerSetDescriptor<R, T extends Trait, V extends View, C extends Controller> extends ControllerSetDescriptor<R, C> {\n  extends?: Proto<TraitViewControllerSet<any, any, any, any, any>> | boolean | null;\n}\n\n/** @public */\nexport interface TraitViewControllerSetClass<F extends TraitViewControllerSet<any, any, any, any, any> = TraitViewControllerSet<any, any, any, any, any>> extends ControllerSetClass<F> {\n}\n\n/** @public */\nexport interface TraitViewControllerSet<R = any, T extends Trait = Trait, V extends View = View, C extends Controller = Controller, I extends any[] = [C | null]> extends ControllerSet<R, C, I> {\n  /** @override */\n  get descriptorType(): Proto<TraitViewControllerSetDescriptor<R, T, V, C>>;\n\n  getTraitViewRef(controller: C): TraitViewRef<any, T, V>;\n\n  get traitType(): TraitFactory<T> | null;\n\n  /** @internal */\n  readonly traitControllers: {readonly [traitId: string]: C | undefined};\n\n  hasTrait(trait: Trait): boolean;\n\n  addTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C;\n\n  addTraits(traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null): void;\n\n  setTraits(traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null): void;\n\n  attachTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, controller?: C): C;\n\n  /** @protected */\n  initTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  /** @protected */\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void;\n\n  attachTraits(traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null): void;\n\n  detachTrait(trait: T): C | null;\n\n  /** @protected */\n  deinitTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  willDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  onDetachTrait(trait: T, controller: C): void;\n\n  /** @protected */\n  didDetachTrait(trait: T, controller: C): void;\n\n  detachTraits(traits: {readonly [traitId: string]: T | undefined}): void;\n\n  insertTrait(parent: Controller | null | undefined, trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C;\n\n  insertTraits(parent: Controller | null | undefined, traits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null, key?: string): void;\n\n  removeTrait(trait: T): C | null;\n\n  removeTraits(traits: {readonly [traitId: string]: T | undefined}): void;\n\n  deleteTrait(trait: T): C | null;\n\n  deleteTraits(traits: {readonly [traitId: string]: T | undefined}): void;\n\n  reinsertTrait(trait: T, targetTrait?: T | null): void;\n\n  consumeTraits(consumer: Consumer): void;\n\n  unconsumeTraits(consumer: Consumer): void;\n\n  createTrait(): T;\n\n  /** @protected */\n  fromTraitLike(value: T | LikeType<T>): T;\n\n  get viewType(): ViewFactory<V> | null;\n\n  get parentView(): View | null;\n\n  getTargetView(controller: C): V | null;\n\n  /** @protected @override */\n  onAttachController(controller: C, targetController: Controller | null): void;\n\n  /** @protected @override */\n  onDetachController(controller: C): void;\n\n  /** @override */\n  createController(trait?: T): C;\n}\n\n/** @public */\nexport const TraitViewControllerSet = (<R, T extends Trait, V extends View, C extends Controller, I extends any[], F extends TraitViewControllerSet<any, any, any, any, any>>() => ControllerSet.extend<TraitViewControllerSet<R, T, V, C, I>, TraitViewControllerSetClass<F>>(\"TraitViewControllerSet\", {\n  getTraitViewRef(controller: C): TraitViewRef<any, T, V> {\n    throw new Error(\"missing implementation\");\n  },\n\n  traitType: null,\n\n  hasTrait(trait: Trait): boolean {\n    return this.traitControllers[trait.uid] !== void 0;\n  },\n\n  addTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C {\n    trait = this.fromTraitLike(trait);\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    let controller = traitControllers[trait.uid];\n    if (controller !== void 0) {\n      return controller;\n    } else if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    controller = this.createController(trait);\n    const traitViewRef = this.getTraitViewRef(controller);\n    traitViewRef.setTrait(trait, targetTrait, key);\n    const targetController = targetTrait !== null ? traitControllers[targetTrait.uid] : void 0;\n    this.addController(controller, targetController, key);\n    if (traitViewRef.view === null) {\n      const view = traitViewRef.createView();\n      const targetView = targetController !== void 0 ? this.getTraitViewRef(targetController).view : null;\n      traitViewRef.insertView(this.parentView, view, targetView, key);\n    }\n    return controller;\n  },\n\n  addTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    for (const traitId in newTraits) {\n      this.addTrait(newTraits[traitId]!, target);\n    }\n  },\n\n  setTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    const binds = this.binds;\n    const parent = binds ? this.parentController : null;\n    const traitControllers = this.traitControllers;\n    for (const traitId in traitControllers) {\n      if (newTraits[traitId] === void 0) {\n        const oldController = this.detachController(traitControllers[traitId]!);\n        if (oldController !== null && binds && parent !== null && oldController.parent === parent) {\n          oldController.remove();\n        }\n      }\n    }\n    if ((this.flags & ControllerSet.OrderedFlag) !== 0) {\n      const orderedTraits = new Array<T>();\n      for (const traitId in newTraits) {\n        orderedTraits.push(newTraits[traitId]!);\n      }\n      for (let i = 0, n = orderedTraits.length; i < n; i += 1) {\n        const newController = orderedTraits[i]!;\n        if (traitControllers[newController.uid] === void 0) {\n          const targetTrait = i < n + 1 ? orderedTraits[i + 1] : target;\n          this.addTrait(newController, targetTrait);\n        }\n      }\n    } else {\n      for (const traitId in newTraits) {\n        if (traitControllers[traitId] === void 0) {\n          this.addTrait(newTraits[traitId]!, target);\n        }\n      }\n    }\n  },\n\n  attachTrait(trait: T | LikeType<T>, targetTrait?: Trait | null, controller?: C): C {\n    trait = this.fromTraitLike(trait);\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    if (controller === void 0) {\n      controller = traitControllers[trait.uid];\n    }\n    if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    if (controller === void 0) {\n      controller = this.createController();\n      const traitViewRef = this.getTraitViewRef(controller);\n      traitViewRef.setTrait(trait, targetTrait);\n      const targetController = targetTrait !== null ? traitControllers[targetTrait.uid] : void 0;\n      this.attachController(controller, targetController);\n    }\n    if (traitControllers[trait.uid] === void 0) {\n      traitControllers[trait.uid] = controller;\n      this.willAttachTrait(trait, targetTrait, controller);\n      this.onAttachTrait(trait, targetTrait, controller);\n      this.initTrait(trait, controller);\n      this.didAttachTrait(trait, targetTrait, controller);\n    }\n    return controller;\n  },\n\n  initTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  onAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  didAttachTrait(trait: T, targetTrait: Trait | null, controller: C): void {\n    // hook\n  },\n\n  attachTraits(newTraits: {readonly [traitId: string]: T | undefined}, target?: Trait | null): void {\n    for (const traitId in newTraits) {\n      this.attachTrait(newTraits[traitId]!, target);\n    }\n  },\n\n  detachTrait(trait: T): C | null {\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    const controller = traitControllers[trait.uid];\n    if (controller === void 0) {\n      return null;\n    }\n    delete traitControllers[trait.uid];\n    this.willDetachTrait(trait, controller);\n    this.onDetachTrait(trait, controller);\n    this.deinitTrait(trait, controller);\n    this.didDetachTrait(trait, controller);\n    return controller;\n  },\n\n  deinitTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  willDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  onDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  didDetachTrait(trait: T, controller: C): void {\n    // hook\n  },\n\n  detachTraits(traits: {readonly [traitId: string]: T | undefined}): void {\n    for (const traitId in traits) {\n      this.detachTrait(traits[traitId]!);\n    }\n  },\n\n  insertTrait(parent: Controller | null | undefined, trait: T | LikeType<T>, targetTrait?: Trait | null, key?: string): C {\n    trait = this.fromTraitLike(trait);\n    const traitControllers = this.traitControllers as {[traitId: string]: C | undefined};\n    let controller = traitControllers[trait.uid];\n    if (controller !== void 0) {\n      return controller;\n    } else if (targetTrait === void 0) {\n      targetTrait = null;\n    }\n    controller = this.createController();\n    const traitViewRef = this.getTraitViewRef(controller);\n    traitViewRef.setTrait(trait, targetTrait);\n    const targetController = targetTrait !== null ? traitControllers[targetTrait.uid] : void 0;\n    this.insertController(parent, controller, targetController, key);\n    if (traitViewRef.view === null) {\n      const view = traitViewRef.createView();\n      const targetView = targetController !== void 0 ? this.getTraitViewRef(targetController).view : null;\n      traitViewRef.insertView(this.parentView, view, targetView, key);\n    }\n    return controller;\n  },\n\n  insertTraits(parent: Controller | null | undefined, newTraits: {readonly [traitId: string]: T | undefined}, targetTrait?: Trait | null, key?: string): void {\n    for (const traitId in newTraits) {\n      this.insertTrait(parent, newTraits[traitId]!, targetTrait, key);\n    }\n  },\n\n  removeTrait(trait: T): C | null {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const traitViewRef = this.getTraitViewRef(controller);\n      if (traitViewRef.trait !== trait) {\n        continue;\n      }\n      this.removeController(controller);\n      return controller;\n    }\n    return null;\n  },\n\n  removeTraits(traits: {readonly [traitId: string]: T | undefined}): void {\n    for (const traitId in traits) {\n      this.removeTrait(traits[traitId]!);\n    }\n  },\n\n  deleteTrait(trait: T): C | null {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const traitViewRef = this.getTraitViewRef(controller);\n      if (traitViewRef.trait !== trait) {\n        continue;\n      }\n      this.deleteController(controller);\n      return controller;\n    }\n    return null;\n  },\n\n  deleteTraits(traits: {readonly [traitId: string]: T | undefined}): void {\n    for (const traitId in traits) {\n      this.deleteTrait(traits[traitId]!);\n    }\n  },\n\n  reinsertTrait(trait: T, targetTrait: T | null): void {\n    const controller = this.traitControllers[trait.uid];\n    if (controller === void 0) {\n      return;\n    }\n    const targetController = targetTrait !== null ? this.traitControllers[targetTrait.uid] : void 0;\n    this.reinsertController(controller, targetController !== void 0 ? targetController : null);\n  },\n\n  consumeTraits(consumer: Consumer): void {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const trait = this.getTraitViewRef(controller).trait;\n      if (trait !== null) {\n        trait.consume(consumer);\n      }\n    }\n  },\n\n  unconsumeTraits(consumer: Consumer): void {\n    const controllers = this.controllers;\n    for (const controllerId in controllers) {\n      const controller = controllers[controllerId]!;\n      const trait = this.getTraitViewRef(controller).trait;\n      if (trait !== null) {\n        trait.unconsume(consumer);\n      }\n    }\n  },\n\n  createTrait(): T {\n    let trait: T | undefined;\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      trait = traitType.create();\n    }\n    if (trait === void 0 || trait === null) {\n      let message = \"unable to create \";\n      const name = this.name.toString();\n      if (name.length !== 0) {\n        message += name + \" \";\n      }\n      message += \"trait\";\n      throw new Error(message);\n    }\n    return trait;\n  },\n\n  fromTraitLike(value: T | LikeType<T>): T {\n    const traitType = this.traitType;\n    if (traitType !== null) {\n      return traitType.fromLike(value);\n    }\n    return Trait.fromLike(value) as T;\n  },\n\n  get parentView(): View | null {\n    return null;\n  },\n\n  getTargetView(controller: C): V | null {\n    if ((this.flags & ControllerSet.SortedFlag) === 0) {\n      return null;\n    }\n    const nextController = controller.nextSibling;\n    if (nextController === null || this.controllers[nextController.uid] === void 0) {\n      return null;\n    }\n    return this.getTraitViewRef(nextController as C).view;\n  },\n\n  onAttachController(controller: C, targetController: Controller | null): void {\n    const trait = this.getTraitViewRef(controller).trait;\n    if (trait !== null) {\n      const targetTrait = targetController !== null && this.hasController(targetController) ? this.getTraitViewRef(targetController as C).trait : null;\n      this.attachTrait(trait, targetTrait, controller);\n    }\n    super.onAttachController(controller, targetController);\n  },\n\n  onDetachController(controller: C): void {\n    super.onDetachController(controller);\n    const trait = this.getTraitViewRef(controller).trait;\n    if (trait !== null) {\n      this.detachTrait(trait);\n    }\n  },\n},\n{\n  construct(fastener: F | null, owner: F extends Fastener<infer R, any, any> ? R : never): F {\n    fastener = super.construct(fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).traitControllers = {};\n    return fastener;\n  },\n}))();\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport {EventHandler} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport type {ControllerFlags} from \"./Controller\";\nimport {Controller} from \"./Controller\";\nimport {ControllerSet} from \"./ControllerSet\";\n\n/** @public */\nexport interface ExecutorServiceObserver<S extends ExecutorService = ExecutorService> extends ServiceObserver<S> {\n  serviceWillAttachRoot?(rootController: Controller, service: S): void;\n\n  serviceDidAttachRoot?(rootController: Controller, service: S): void;\n\n  serviceWillDetachRoot?(rootController: Controller, service: S): void;\n\n  serviceDidDetachRoot?(rootController: Controller, service: S): void;\n}\n\n/** @public */\nexport class ExecutorService extends Service {\n  constructor() {\n    super();\n    this.updateFlags = 0;\n    this.updateTime = performance.now();\n    this.updateDelay = ExecutorService.MinUpdateDelay;\n    this.compileTimer = 0;\n    this.executeTimer = 0;\n\n    this.runCompilePass = this.runCompilePass.bind(this);\n    this.runExecutePass = this.runExecutePass.bind(this);\n  }\n\n  declare readonly observerType?: Class<ExecutorServiceObserver>;\n\n  @ControllerSet({\n    initController(rootController: Controller): void {\n      this.owner.requestUpdate(rootController, rootController.flags & Controller.UpdateMask, false);\n    },\n    willAttachController(rootController: Controller): void {\n      this.owner.callObservers(\"serviceWillAttachRoot\", rootController, this.owner);\n    },\n    didAttachController(rootController: Controller): void {\n      this.owner.callObservers(\"serviceDidAttachRoot\", rootController, this.owner);\n    },\n    willDetachController(rootController: Controller): void {\n      this.owner.callObservers(\"serviceWillDetachRoot\", rootController, this.owner);\n    },\n    didDetachController(rootController: Controller): void {\n      this.owner.callObservers(\"serviceDidDetachRoot\", rootController, this.owner);\n    },\n  })\n  readonly roots!: ControllerSet<this, Controller>;\n\n  /** @internal */\n  readonly updateFlags: ControllerFlags;\n\n  /** @internal */\n  setUpdateFlags(updateFlags: ControllerFlags): void {\n    (this as Mutable<this>).updateFlags = updateFlags;\n  }\n\n  readonly updateTime: number;\n\n  /** @internal */\n  updateDelay: number;\n\n  protected needsUpdate(updateFlags: ControllerFlags, immediate: boolean): ControllerFlags {\n    return updateFlags;\n  }\n\n  requestUpdate(targetController: Controller, updateFlags: ControllerFlags, immediate: boolean): void {\n    updateFlags = this.needsUpdate(updateFlags, immediate);\n    let deltaUpdateFlags = this.updateFlags & ~updateFlags & Controller.UpdateMask;\n    if ((updateFlags & Controller.CompileMask) !== 0) {\n      deltaUpdateFlags |= Controller.NeedsCompile;\n    }\n    if ((updateFlags & Controller.ExecuteMask) !== 0) {\n      deltaUpdateFlags |= Controller.NeedsExecute;\n    }\n    this.setUpdateFlags(this.updateFlags | deltaUpdateFlags);\n    if (immediate && (this.updateFlags & (Controller.CompilingFlag | Controller.ExecutingFlag)) === 0 && this.updateDelay <= ExecutorService.MaxCompileInterval) {\n      this.runImmediatePass();\n    } else {\n      this.scheduleUpdate();\n    }\n  }\n\n  protected scheduleUpdate(): void {\n    const flags = this.updateFlags;\n    if ((flags & Controller.CompilingFlag) === 0 && (flags & Controller.CompileMask) !== 0) {\n      this.scheduleCompilePass(this.updateDelay);\n    } else if ((flags & Controller.ExecutingFlag) === 0 && (flags & Controller.ExecuteMask) !== 0) {\n      this.scheduleExecutePass(ExecutorService.MinExecuteInterval);\n    }\n  }\n\n  protected cancelUpdate(): void {\n    this.cancelCompilePass();\n    this.cancelExecutePass();\n  }\n\n  protected runImmediatePass(): void {\n    if ((this.updateFlags & Controller.CompileMask) !== 0) {\n      this.cancelUpdate();\n      this.runCompilePass(true);\n    }\n    if ((this.updateFlags & Controller.ExecuteMask) !== 0 && this.updateDelay <= ExecutorService.MaxCompileInterval) {\n      this.cancelUpdate();\n      this.runExecutePass(true);\n    }\n  }\n\n  /** @internal */\n  compileTimer: number;\n\n  protected scheduleCompilePass(updateDelay: number): void {\n    if (this.compileTimer === 0) {\n      this.compileTimer = setTimeout(this.runCompilePass, updateDelay) as any;\n    }\n  }\n\n  protected cancelCompilePass(): void {\n    if (this.compileTimer !== 0) {\n      clearTimeout(this.compileTimer);\n      this.compileTimer = 0;\n    }\n  }\n\n  protected runCompilePass(immediate: boolean = false): void {\n    if (!immediate) {\n      this.compileTimer = 0;\n    }\n    this.setUpdateFlags(this.updateFlags & ~Controller.CompileMask | Controller.CompilingFlag);\n    try {\n      const t0 = performance.now();\n      (this as Mutable<this>).updateTime = t0;\n\n      const rootControllers = this.roots.controllers;\n      for (const controllerId in rootControllers) {\n        const rootController = rootControllers[controllerId]!;\n        if ((rootController.flags & Controller.CompileMask) !== 0) {\n          rootController.cascadeCompile(0);\n        }\n      }\n\n      const t1 = performance.now();\n      let compileDelay = Math.max(ExecutorService.MinCompileInterval, this.updateDelay);\n      if (t1 - t0 > compileDelay) {\n        this.updateDelay = Math.min(Math.max(2, this.updateDelay * 2), ExecutorService.MaxUpdateDelay);\n      } else {\n        this.updateDelay = Math.min(ExecutorService.MinUpdateDelay, this.updateDelay / 2);\n      }\n\n      this.cancelCompilePass();\n      if ((this.updateFlags & Controller.ExecuteMask) !== 0) {\n        this.scheduleExecutePass(ExecutorService.MinExecuteInterval);\n      } else if ((this.updateFlags & Controller.CompileMask) !== 0) {\n        if (immediate) {\n          compileDelay = Math.max(ExecutorService.MaxCompileInterval, compileDelay);\n        }\n        this.cancelExecutePass();\n        this.scheduleCompilePass(compileDelay);\n      }\n    } finally {\n      this.setUpdateFlags(this.updateFlags & ~Controller.CompilingFlag);\n    }\n  }\n\n  /** @internal */\n  executeTimer: number;\n\n  protected scheduleExecutePass(updateDelay: number): void {\n    if (this.executeTimer === 0) {\n      this.executeTimer = setTimeout(this.runExecutePass, updateDelay) as any;\n    }\n  }\n\n  protected cancelExecutePass(): void {\n    if (this.executeTimer !== 0) {\n      clearTimeout(this.executeTimer);\n      this.executeTimer = 0;\n    }\n  }\n\n  protected runExecutePass(immediate: boolean = false): void {\n    if (!immediate) {\n      this.executeTimer = 0;\n    }\n    this.setUpdateFlags(this.updateFlags & ~Controller.ExecuteMask | Controller.ExecutingFlag);\n    try {\n      const time = performance.now();\n      (this as Mutable<this>).updateTime = time;\n\n      const rootControllers = this.roots.controllers;\n      for (const controllerId in rootControllers) {\n        const rootController = rootControllers[controllerId]!;\n        if ((rootController.flags & Controller.ExecuteMask) !== 0) {\n          rootController.cascadeExecute(0);\n        }\n      }\n\n      this.cancelExecutePass();\n      if ((this.updateFlags & Controller.CompileMask) !== 0) {\n        let compileDelay = this.updateDelay;\n        if (immediate) {\n          compileDelay = Math.max(ExecutorService.MaxCompileInterval, compileDelay);\n        }\n        this.scheduleCompilePass(compileDelay);\n      } else if ((this.updateFlags & Controller.ExecuteMask) !== 0) {\n        this.cancelCompilePass();\n        this.scheduleExecutePass(ExecutorService.MaxExecuteInterval);\n      }\n    } finally {\n      this.setUpdateFlags(this.updateFlags & ~Controller.ExecutingFlag);\n    }\n  }\n\n  get powerFlags(): ControllerFlags {\n    return 0;\n  }\n\n  power(): void {\n    const rootControllers = this.roots.controllers;\n    for (const controllerId in rootControllers) {\n      const rootController = rootControllers[controllerId]!;\n      rootController.requireUpdate(this.powerFlags);\n    }\n  }\n\n  unpower(): void {\n    this.cancelUpdate();\n    this.updateDelay = ExecutorService.MinUpdateDelay;\n  }\n\n  @EventHandler({\n    eventType: \"visibilitychange\",\n    target: typeof document !== \"undefined\" ? document : null,\n    handle(event: Event): void {\n      if (document.visibilityState === \"visible\") {\n        this.owner.power();\n      } else {\n        this.owner.unpower();\n      }\n    },\n  })\n  readonly visibilityChange!: EventHandler<this>;\n\n  /** @internal */\n  static MinUpdateDelay: number = 0;\n  /** @internal */\n  static MaxUpdateDelay: number = 167;\n  /** @internal */\n  static MinCompileInterval: number = 12;\n  /** @internal */\n  static MaxCompileInterval: number = 33;\n  /** @internal */\n  static MinExecuteInterval: number = 4;\n  /** @internal */\n  static MaxExecuteInterval: number = 16;\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport type {UriLike} from \"@swim/uri\";\nimport {Uri} from \"@swim/uri\";\nimport {UriQuery} from \"@swim/uri\";\nimport type {UriFragmentLike} from \"@swim/uri\";\nimport {UriFragment} from \"@swim/uri\";\n\n/** @public */\nexport interface HistoryStateInit {\n  fragment?: string;\n\n  parameters?: {[key: string]: string | undefined};\n\n  environment?: {[key: string]: any};\n}\n\n/** @internal */\nexport interface MutableHistoryState {\n  fragment: string | undefined;\n\n  parameters: {[key: string]: string | undefined};\n\n  environment: {[key: string]: any};\n}\n\n/** @public */\nexport interface HistoryState {\n  readonly fragment: string | undefined;\n\n  readonly parameters: {readonly [key: string]: string | undefined};\n\n  readonly environment: {readonly [key: string]: any};\n}\n\n/** @public */\nexport const HistoryState = {\n  /** @internal */\n  empty: Lazy(function (): HistoryState {\n    return Object.freeze({\n      fragment: void 0,\n      parameters: {},\n      environment: {},\n    });\n  }),\n\n  /** @internal */\n  current(): MutableHistoryState {\n    try {\n      return HistoryState.fromUri(window.location.href);\n    } catch (e) {\n      console.error(e);\n      return HistoryState.empty();\n    }\n  },\n\n  /** @internal */\n  updated(delta: HistoryStateInit, state?: MutableHistoryState): MutableHistoryState {\n    if (state === void 0) {\n      state = HistoryState.current();\n    }\n    if (\"fragment\" in delta) {\n      state.fragment = delta.fragment;\n    }\n    for (const key in delta.parameters) {\n      const value = delta.parameters[key];\n      if (value !== void 0) {\n        state.parameters[key] = value;\n      } else {\n        delete state.parameters[key];\n      }\n    }\n    for (const key in delta.environment) {\n      const value = delta.environment[key];\n      if (value !== void 0) {\n        state.environment[key] = value;\n      } else {\n        delete state.environment[key];\n      }\n    }\n    return state;\n  },\n\n  /** @internal */\n  cloned(oldState: HistoryState): MutableHistoryState {\n    const newState: MutableHistoryState = {\n      fragment: oldState.fragment,\n      parameters: {},\n      environment: {},\n    };\n    for (const key in oldState.parameters) {\n      newState.parameters[key] = oldState.parameters[key];\n    }\n    for (const key in oldState.environment) {\n      newState.environment[key] = oldState.environment[key];\n    }\n    return newState;\n  },\n\n  /** @internal */\n  fromUri(uri: UriLike): HistoryState {\n    uri = Uri.fromLike(uri);\n    const fragment = uri.fragment;\n    if (!fragment.isDefined()) {\n      return HistoryState.empty();\n    }\n    return HistoryState.fromUriFragment(fragment);\n  },\n\n  /** @internal */\n  fromUriFragment(fragment: UriFragmentLike): HistoryState {\n    fragment = UriFragment.fromLike(fragment);\n    let query = fragment.identifier !== void 0\n              ? UriQuery.parse(fragment.identifier)\n              : UriQuery.undefined();\n    const state: MutableHistoryState = {\n      fragment: void 0,\n      parameters: {},\n      environment: {},\n    };\n    while (!query.isEmpty()) {\n      const key = query.key;\n      const value = query.value;\n      if (key !== void 0) {\n        state.parameters[key] = value;\n      } else {\n        state.fragment = value;\n      }\n      query = query.tail();\n    }\n    return state;\n  },\n\n  /** @internal */\n  toUri(state: HistoryState): Uri {\n    const queryBuilder = UriQuery.builder();\n    if (state.fragment !== void 0) {\n      queryBuilder.add(void 0, state.fragment);\n    }\n    for (const key in state.parameters) {\n      const value = state.parameters[key]!;\n      queryBuilder.add(key, value);\n    }\n    return Uri.fragment(UriFragment.create(queryBuilder.build().toString()));\n  },\n};\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Class} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport {EventHandler} from \"@swim/component\";\nimport type {ServiceObserver} from \"@swim/component\";\nimport {Service} from \"@swim/component\";\nimport type {Uri} from \"@swim/uri\";\nimport type {HistoryStateInit} from \"./HistoryState\";\nimport {HistoryState} from \"./HistoryState\";\n\n/** @public */\nexport interface HistoryServiceObserver<S extends HistoryService = HistoryService> extends ServiceObserver<S> {\n  serviceWillPushHistory?(newState: HistoryState, oldState: HistoryState, service: S): void;\n\n  serviceDidPushHistory?(newState: HistoryState, oldState: HistoryState, service: S): void;\n\n  serviceWillReplaceHistory?(newState: HistoryState, oldState: HistoryState, service: S): void;\n\n  serviceDidReplaceHistory?(newState: HistoryState, oldState: HistoryState, service: S): void;\n\n  serviceWillPopHistory?(newState: HistoryState, oldState: HistoryState, service: S): void | boolean;\n\n  serviceDidPopHistory?(newState: HistoryState, oldState: HistoryState, service: S): void;\n}\n\n/** @public */\nexport class HistoryService extends Service {\n  constructor() {\n    super();\n    this.historyState = HistoryState.current();\n  }\n\n  declare readonly observerType?: Class<HistoryServiceObserver>;\n\n  /** @internal */\n  readonly historyState: HistoryState;\n\n  get historyUri(): Uri {\n    return HistoryState.toUri(this.historyState);\n  }\n\n  pushHistory(deltaState: HistoryStateInit): void {\n    const oldState = this.historyState;\n    const newState = HistoryState.updated(deltaState, HistoryState.cloned(oldState));\n    const newUri = HistoryState.toUri(newState);\n    this.willPushHistory(newState, oldState);\n    (this as Mutable<this>).historyState = newState;\n    window.history.pushState(newState.environment, \"\", newUri.toString());\n    this.onPushHistory(newState, oldState);\n    this.didPushHistory(newState, oldState);\n  }\n\n  protected willPushHistory(newState: HistoryState, oldState: HistoryState): void {\n    this.callObservers(\"serviceWillPushHistory\", newState, oldState, this);\n  }\n\n  protected onPushHistory(newState: HistoryState, oldState: HistoryState): void {\n    // hook\n  }\n\n  protected didPushHistory(newState: HistoryState, oldState: HistoryState): void {\n    this.callObservers(\"serviceDidPushHistory\", newState, oldState, this);\n  }\n\n  replaceHistory(deltaState: HistoryStateInit): void {\n    const oldState = this.historyState;\n    const newState = HistoryState.updated(deltaState, HistoryState.cloned(oldState));\n    if (Objects.equal(oldState, newState)) {\n      return;\n    }\n    const newUri = HistoryState.toUri(newState);\n    this.willReplaceHistory(newState, oldState);\n    (this as Mutable<this>).historyState = newState;\n    window.history.replaceState(newState.environment, \"\", newUri.toString());\n    this.onReplaceHistory(newState, oldState);\n    this.didReplaceHistory(newState, oldState);\n  }\n\n  protected willReplaceHistory(newState: HistoryState, oldState: HistoryState): void {\n    this.callObservers(\"serviceWillReplaceHistory\", newState, oldState, this);\n  }\n\n  protected onReplaceHistory(newState: HistoryState, oldState: HistoryState): void {\n    // hook\n  }\n\n  protected didReplaceHistory(newState: HistoryState, oldState: HistoryState): void {\n    this.callObservers(\"serviceDidReplaceHistory\", newState, oldState, this);\n  }\n\n  @EventHandler({\n    eventType: \"popstate\",\n    target: typeof window !== \"undefined\" ? window : null,\n    handle(event: PopStateEvent): void {\n      const deltaState: HistoryStateInit = {};\n      if (typeof event.state === \"object\" && event.state !== null) {\n        deltaState.environment = event.state;\n      }\n      const oldState = this.owner.historyState;\n      const newState = HistoryState.updated(deltaState, HistoryState.current());\n      this.owner.willPopHistory(newState, oldState);\n      (this.owner as Mutable<typeof this.owner>).historyState = newState;\n      this.owner.onPopHistory(newState, oldState);\n      this.owner.didPopHistory(newState, oldState);\n    },\n  })\n  readonly popstate!: EventHandler<this>;\n\n  protected willPopHistory(newState: HistoryState, oldState: HistoryState): void {\n    this.callObservers(\"serviceWillPopHistory\", newState, oldState, this);\n  }\n\n  protected onPopHistory(newState: HistoryState, oldState: HistoryState): void {\n    // hook\n  }\n\n  protected didPopHistory(newState: HistoryState, oldState: HistoryState): void {\n    this.callObservers(\"serviceDidPopHistory\", newState, oldState, this);\n  }\n}\n","// Copyright 2015-2023 Nstream, inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Uninitable} from \"@swim/util\";\nimport {Objects} from \"@swim/util\";\nimport type {Equals} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Debug} from \"@swim/codec\";\nimport {Format} from \"@swim/codec\";\nimport type {HistoryStateInit} from \"./HistoryState\";\nimport {HistoryService} from \"./HistoryService\";\n\n/** @public */\nexport type HyperlinkLike = Hyperlink | HyperlinkInit | string;\n\n/** @public */\nexport type HyperlinkInit = HistoryHyperlinkInit | LocationHyperlinkInit;\n\n/** @public */\nexport abstract class Hyperlink implements Equals, Debug {\n  likeType?(like: HyperlinkInit | string): void;\n\n  abstract readonly state: Readonly<HistoryStateInit> | null;\n\n  abstract readonly href: string | undefined;\n\n  abstract readonly title: string | undefined;\n\n  abstract activate(event?: Event | null): void;\n\n  /** @override */\n  abstract equals(that: unknown): boolean;\n\n  /** @override */\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  /** @override */\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  static history(state: HistoryStateInit, href?: string, title?: string): HistoryHyperlink {\n    return new HistoryHyperlink(state, href, title);\n  }\n\n  static location(href: string, title?: string): LocationHyperlink {\n    return new LocationHyperlink(href, title);\n  }\n\n  static fromLike<T extends HyperlinkLike | null | undefined>(hyperlink: T): Hyperlink | Uninitable<T> {\n    if (hyperlink === void 0 || hyperlink === null || hyperlink instanceof Hyperlink) {\n      return hyperlink as Hyperlink | Uninitable<T>;\n    } else if (typeof hyperlink === \"string\") {\n      return new LocationHyperlink(hyperlink, void 0);\n    } else if (!(\"state\" in hyperlink) && !(\"href\" in hyperlink)) {\n      return new HistoryHyperlink(hyperlink, void 0, void 0);\n    }\n    return this.fromInit(hyperlink);\n  }\n\n  static fromInit(init: HyperlinkInit): Hyperlink {\n    if (\"fragment\" in init || \"parameters\" in init || \"environment\" in init) {\n      const state: HistoryStateInit = {};\n      if (init.fragment !== void 0) {\n        state.fragment = init.fragment;\n      }\n      if (init.parameters !== void 0) {\n        state.parameters = init.parameters;\n      }\n      if (init.environment !== void 0) {\n        state.environment = init.environment;\n      }\n      return new HistoryHyperlink(state, init.href, init.title);\n    } else if (init.href !== void 0) {\n      return new LocationHyperlink(init.href, init.title);\n    }\n    throw new TypeError(\"invalid hyperlink\");\n  }\n}\n\n/** @public */\nexport interface HistoryHyperlinkInit extends HistoryStateInit {\n  href?: string;\n  title?: string;\n}\n\n/** @public */\nexport class HistoryHyperlink extends Hyperlink {\n  constructor(state: Readonly<HistoryStateInit>, href: string | undefined,\n              title: string | undefined) {\n    super();\n    this.state = state;\n    this.href = href;\n    this.title = title;\n  }\n\n  override readonly state: Readonly<HistoryStateInit>;\n\n  override readonly href: string | undefined;\n\n  override readonly title: string | undefined;\n\n  override activate(event?: Event | null): void {\n    if (event !== void 0 && event !== null) {\n      event.preventDefault();\n    }\n    HistoryService.global().pushHistory(this.state);\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof HistoryHyperlink) {\n      return Objects.equal(this.state, that.state)\n          && this.href === that.href && this.title === that.title;\n    }\n    return false;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Hyperlink\").write(46/*'.'*/).write(\"history\")\n                   .write(40/*'('*/).debug(this.state);\n    if (this.href !== void 0) {\n      output = output.write(\", \").debug(this.href);\n    }\n    if (this.title !== void 0) {\n      output = output.write(\", \").debug(this.title);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n}\n\n/** @public */\nexport interface LocationHyperlinkInit {\n  state?: undefined;\n  href: string;\n  title?: string;\n}\n\n/** @public */\nexport class LocationHyperlink extends Hyperlink {\n  constructor(href: string, title: string | undefined) {\n    super();\n    this.href = href;\n    this.title = title;\n  }\n\n  get state(): Readonly<HistoryStateInit> | null {\n    return null;\n  }\n\n  override readonly href: string;\n\n  override readonly title: string | undefined;\n\n  override activate(event?: Event | null): void {\n    if (event !== void 0 && event !== null) {\n      event.preventDefault();\n    }\n    window.location.assign(this.href);\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LocationHyperlink) {\n      return this.href === that.href && this.title === that.title;\n    }\n    return false;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Hyperlink\").write(46/*'.'*/).write(\"location\")\n                   .write(40/*'('*/).debug(this.href);\n    if (this.title !== void 0) {\n      output = output.write(\", \").debug(this.title);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n}\n"],"names":["__esDecorate","ctor","descriptorIn","decorators","contextIn","initializers","extraInitializers","accept","f","TypeError","_","kind","key","target","prototype","descriptor","Object","getOwnPropertyDescriptor","name","done","i","length","context","p","access","addInitializer","push","result","get","set","init","unshift","defineProperty","__runInitializers","thisArg","value","useValue","arguments","call","SuppressedError","Model","Component","_a","_classSuper","constructor","super","this","firstTrait","_instanceExtraInitializers","updater","_updater_initializers","consumers","lastTrait","traitMap","componentType","willAttachParent","parent","callObservers","trait","next","nextTrait","model","onAttachParent","didAttachParent","willDetachParent","onDetachParent","didDetachParent","willInsertChild","child","onInsertChild","didInsertChild","cascadeInsert","updateFlags","flags","MountedFlag","UpdateMask","AnalyzeMask","cascadeAnalyze","willRemoveChild","onRemoveChild","didRemoveChild","willReinsertChild","onReinsertChild","didReinsertChild","cascadeMount","Error","willMount","setFlags","onMount","mountTraits","mountChildren","didMount","requestUpdate","requireUpdate","mountFlags","decoherent","NeedsMutate","mountFasteners","size","startConsuming","cascadeUnmount","willUnmount","unmountChildren","unmountTraits","onUnmount","didUnmount","stopConsuming","getTraitFastener","fastenerName","fastenerType","contextType","fastener","getFastener","immediate","deltaUpdateFlags","needsUpdate","NeedsAnalyze","RefreshMask","NeedsRefresh","mounted","updaterService","service","updating","UpdatingMask","analyzing","AnalyzingFlag","needsAnalyze","analyzeFlags","cascadeFlags","willAnalyze","willMutate","NeedsAggregate","willAggregate","NeedsCorrelate","willCorrelate","onAnalyze","onMutate","onAggregate","onCorrelate","analyzeChildren","analyzeChild","didCorrelate","didAggregate","didMutate","didAnalyze","recohereFasteners","updateTime","analyzeTraitChildren","analyzeOwnChildren","bind","firstChild","nextSibling","refreshing","RefreshingFlag","needsRefresh","refreshFlags","cascadeRefresh","willRefresh","NeedsValidate","willValidate","NeedsReconcile","willReconcile","onRefresh","onValidate","onReconcile","refreshChildren","refreshChild","didReconcile","didValidate","didRefresh","recohereDownlinks","refreshTraitChildren","refreshOwnChildren","setFirstTrait","setLastTrait","forEachTrait","callback","insertTraitMap","removeTraitMap","findTrait","traitClass","hasTrait","getTrait","setTrait","newTrait","Trait","fromLike","oldTrait","remove","willRemoveTrait","detachModel","onRemoveTrait","didRemoveTrait","setKey","InsertingFlag","willInsertTrait","attachModel","onInsertTrait","didInsertTrait","appendTrait","removeChild","prependTrait","insertTrait","replaceTrait","insertTraitFlags","InsertTraitFlags","prev","bindTraitFasteners","removeTrait","removeTraitFlags","RemoveTraitFlags","unbindTraitFasteners","sortTraits","comparator","traits","sort","setPreviousTrait","setNextTrait","mountTrait","unmountTrait","getAncestorTrait","ancestorType","ancestor","ancestorTrait","getRootTrait","rootType","rootTrait","bindFastener","TraitRelation","binds","bindTrait","consuming","WarpDownlink","consumed","ModelRelation","consume","bindChildFastener","bindModel","unbindChildFastener","unbindModel","metaclass","FastenerContext","getMetaclass","fastenerSlots","slots","Fastener","bindTraitFastener","unbindTraitFastener","unbindTrait","enqueueFastener","t","performance","now","coherentTime","recohering","recohere","coherentDownlinkProps","hostUri","nodeUri","laneUri","consumer","Set","has","willConsume","add","onConsume","didConsume","unconsume","willUnconsume","delete","onUnconsume","didUnconsume","ConsumingFlag","startConsumingFlags","StartConsumingFlags","willStartConsuming","onStartConsuming","didStartConsuming","startConsumingFasteners","stopConsumingFlags","StopConsumingFlags","willStopConsuming","onStopConsuming","didStopConsuming","stopConsumingFasteners","getService","selection","Provider","getter","Property","downlink","template","downlinkClass","EventDownlink","define","create","downlinkValue","ValueDownlink","downlinkList","ListDownlink","downlinkMap","MapDownlink","command","body","Value","getValue","Uri","endpoint","unresolve","warpRef","authenticate","credentials","hostRef","childRef","appendChild","nodeRef","isDefined","laneRef","getDownlink","openDownlink","_updater_decorators","serviceType","RefresherService","mountRootService","roots","addModel","owner","unmountRootService","removeModel","_get_selection_decorators","SelectionService","_get_hostUri_decorators","valueType","inherits","_get_nodeUri_decorators","_get_laneUri_decorators","_get_warpRef_decorators","WarpRef","initValue","WarpClient","global","equalValues","newValue","oldValue","static","private","obj","metadata","_metadata","uid","nextId","id","RemovingFlag","FlagShift","StatusMask","FlagMask","MountFlags","InsertChildFlags","RemoveChildFlags","ReinsertChildFlags","extend","modelType","observes","attachOutlet","outlet","outlets","detachOutlet","decohereOutlets","decohere","initModel","willAttachModel","onAttachModel","observe","didAttachModel","deinitModel","willDetachModel","onDetachModel","unobserve","didDetachModel","parentModel","insertChild","detectModel","createModel","message","toString","construct","ModelRef","inletModel","inlet","getInletModel","bindInlet","setModel","setIntrinsic","modelKey","getModel","newModel","oldModel","setCoherent","insertModel","deleteModel","setCoherentTime","setDerived","Affinity","Mask","Math","min","Intrinsic","DerivedFlag","tryModel","modelRef","tryFastener","refine","fastenerClass","fastenerPrototype","modelKeyDescriptor","ModelSet","insertModelMap","models","OrderedFlag","Objects","inserted","removeModelMap","hasModel","getTargetChild","modelCount","addModels","newModels","modelId","setModels","orderedModels","Array","modeld","n","targetModel","attachModels","detachModels","insertModels","removeModels","deleteModels","reinsertModel","SortedFlag","reinsertChild","consumeModels","unconsumeModels","ordered","order","sorted","willSort","onSort","didSort","sortChildren","compareChildren","compareTargetChild","a","b","x","y","compare","flagsInit","hasOwnProperty","enumerable","configurable","__runInitializers_1","previousTrait","observers","bindModelFasteners","unbindModelFasteners","modelFlags","setModelFlags","previousSibling","lastChild","forEachChild","getChild","childType","setChild","newChild","prependChild","replaceChild","oldChild","insertChildFlags","bindChildFasteners","removeChildFlags","unbindChildFasteners","reinsertChildFlags","removeChildren","getAncestor","getRoot","inserting","removing","unmountFasteners","getParentFastener","attachFastener","mount","unmount","properties","timing","property","Animator","decohereFastener","observer","willObserve","onObserve","didObserve","willUnobserve","onUnobserve","didUnobserve","args","method","equals","that","hashCode","Murmur3","mash","mixString","Creatable","Symbol","hasInstance","initDecorators","superMetadata","getPrototypeOf","writable","defineField","fieldInitializers","instanceInitializers","defineGetter","initFasteners","parentType","__esDecorate_1","traitType","initTrait","willAttachTrait","onAttachTrait","didAttachTrait","deinitTrait","willDetachTrait","onDetachTrait","didDetachTrait","detectTrait","createTrait","TraitRef","inletTrait","getInletTrait","traitKey","attachTrait","detachTrait","deleteTrait","tryTrait","traitRef","traitKeyDescriptor","TraitSet","addTrait","traitCount","addTraits","newTraits","traitId","setTraits","orderedTraits","targetTrait","attachTraits","detachTraits","insertTraits","removeTraits","deleteTraits","reinsertTrait","consumeTraits","unconsumeTraits","q","TraitModelRef","traitOrModel","observesTrait","fromTraitLike","insertModelTrait","detectModelTrait","TraitModelSet","compareTraits","Service","_roots_initializers","visibilityChange","_visibilityChange_initializers","updateDelay","MinUpdateDelay","analyzeTimer","refreshTimer","runAnalyzePass","runRefreshPass","setUpdateFlags","MaxAnalyzeInterval","runImmediatePass","scheduleUpdate","scheduleAnalyzePass","scheduleRefreshPass","MinAnalyzeInterval","cancelUpdate","cancelAnalyzePass","cancelRefreshPass","setTimeout","clearTimeout","t0","rootModels","rootModel","t1","analyzeDelay","max","MaxUpdateDelay","MinRefreshInterval","time","MaxRefreshInterval","powerFlags","power","unpower","_roots_decorators","_visibilityChange_decorators","EventHandler","eventType","document","handle","event","visibilityState","StorageService","willSet","onSet","didSet","willClear","onClear","didClear","WebStorageService","local","EphemeralStorageService","storageArea","storageEvent","_storageEvent_initializers","getItem","setItem","removeItem","clear","Local","window","localStorage","e","session","Session","sessionStorage","_storageEvent_decorators","selections","isSelected","indexOf","select","options","index","multi","unselectAll","selectableTrait","SelectableTrait","willSelect","splice","onSelect","didSelect","unselect","internal","willUnselect","onUnselect","didUnselect","didUnselectAll","toggle","selectedIndex","selected","_selection_initializers","_selection_decorators","FontSize","Length","fromValue","string","stringValue","form","cast","LineHeight","height","FontFamily","family","forEach","item","format","isIdent","Unicode","isAlpha","charCodeAt","Strings","offsetByCodePoints","c","output","stringOutput","write","base16","Base16","uppercase","encodeDigit","FontLike","instance","Font","FontInit","hasAllKeys","style","variant","weight","stretch","withStyle","withVariant","withWeight","withStretch","withSize","Values","equal","withHeight","withFamily","isArray","toLike","slice","interpolateTo","FontInterpolator","equivalentTo","epsilon","equivalent","debug","s","_b","_c","_d","fromInit","parse","header","input","stringInput","isCont","isWhitespace","head","step","parser","FontParser","isDone","isError","Parser","error","Diagnostic","unexpected","FontForm","Lazy","_static_form_decorators","_staticExtraInitializers","_super","f0","f1","interpolator","u","styleInterpolator","variantInterpolator","weightInterpolator","stretchInterpolator","sizeInterpolator","heightInterpolator","familyInterpolator","setPrototypeOf","Interpolator","Form","unit","withUnit","mold","font","Record","slot","of","Attr","toValue","FontFamilyParser","quote","code","feed","isSpace","expected","isEmpty","isDigit","decodeDigit","identOutput","lengthParser","familyParser","ident","LengthParser","units","String","asError","parseRest","ColorLike","Color","ColorInit","RgbColorInit","HslColorInit","contrast","k","lightness","lighter","darker","RgbColorInterpolator","rgb","transparent","RgbColor","black","alpha","white","r","g","hsl","h","l","Angle","degValue","HslColor","forName","color","ColorParser","ColorForm","Darker","Brighter","Text","from","HexColorParser","RgbColorParser","HslColorParser","ColorChannel","scale","ColorChannelParser","valueParser","Base10","parseNumber","RgbColorLike","isFinite","plus","times","scalar","combine","pow","fromRgb","Numbers","mix","Constructors","hash","toHexString","round","base16Alphabet","lowercase","alphabet","charAt","toRgbString","isNaN","toHslString","fromHsl","m2","m1","fromHslChannel","tag","positional","member","numberValue","str","_static_transparent_decorators","c0","c1","rgb0","rgb1","rParser","gParser","bParser","aParser","HslColorLike","HslColorInterpolator","NaN","hsl0","hsl1","hParser","sParser","lParser","AngleParser","ColorStopLike","ColorStop","ColorStopInit","ColorStopTuple","LengthLike","stop","hint","withColor","withStop","withHint","ColorStopInterpolator","Equivalent","Equals","fromTuple","ColorStopParser","parseHint","parseList","ColorStopListParser","y0","y1","colorInterpolator","stopInterpolator","hintInterpolator","colorParser","stopParser","hintParser","stops","LinearGradientLike","LinearGradient","LinearGradientInit","angle","withAngle","withStops","array","LinearGradientInterpolator","Arrays","LinearGradientParser","parseAngle","LinearGradientAngleParser","g0","g1","angleInterpolator","stopInterpolators","stopCount","stops0","stops1","angleParser","side","stopsParser","BoxShadowLike","BoxShadow","BoxShadowInit","hasAnyKey","inset","offsetX","offsetY","blurRadius","spreadRadius","withInset","withOffsetX","withOffsetY","withBlurRadius","withSpreadRadius","and","apply","BoxShadowInterpolator","zero","values","fromArray","boxShadow","booleanValue","BoxShadowParser","BoxShadowForm","b0","b1","insetInterpolator","offsetXInterpolator","offsetYInterpolator","blurRadiusInterpolator","spreadRadiusInterpolator","nextInterpolator","shadow","record","attr","offsetXParser","offsetYParser","blurRadiusParser","spreadRadiusParser","StyleValue","DateTime","Transform","DateTimeLike","StyleValueParser","StyleValueForm","Item","extant","Num","Bool","date","transform","unitsOutput","TranslateTransformParser","ScaleTransformParser","RotateTransformParser","SkewTransformParser","AffineTransformParser","identity","parseDecimal","year","DateTimeFormat","pattern","parseDate","styleValue","deg","rad","grad","turn","px","em","rem","pct","ToAttributeString","toAttributeString","ToStyleString","toStyleString","ToCssValue","CSSStyleValue","toCssValue","CSSUnitValue","FocusLike","Focus","FocusInit","phase","direction","withPhase","withDirection","unfocused","focused","focusing","unfocusing","asFocusing","asUnfocusing","asToggling","asToggled","FocusInterpolator","Format","_static_unfocused_decorators","_static_focused_decorators","FocusAnimator","getPhase","getPhaseOr","elsePhase","setPhase","newPhase","affinity","setState","setDirection","newDirection","focus","unfocus","willSetState","newState","oldState","setValue","Reflexive","onSetValue","willFocus","didFocus","willUnfocus","didUnfocus","PresenceLike","Presence","PresenceInit","dismissed","presented","presenting","dismissing","asPresenting","asDismissing","PresenceInterpolator","_static_dismissed_decorators","_static_presented_decorators","p0","p1","PresenceAnimator","present","dismiss","willPresent","didPresent","willDismiss","didDismiss","ExpansionLike","Expansion","ExpansionInit","collapsed","expanded","expanding","collapsing","asExpanding","asCollapsing","ExpansionInterpolator","_static_collapsed_decorators","_static_expanded_decorators","e0","e1","ExpansionAnimator","expand","collapse","willExpand","didExpand","willCollapse","didCollapse","LookVector","feel","entry","getOr","elseValue","updated","updates","oldArray","oldIndex","updateCount","updateIndex","newArray","newIndex","j","copy","empty","feels","_static_empty_decorators","FeelVector","look","thisArray","thatArray","negative","minus","FeelVectorInterpolator","looks","coerce","v0","v1","interpolators","interpolatorCount","between","MoodVector","dot","combination","keys","MoodMatrix","rowArray","rowIndex","colArray","colIndex","rowCount","colCount","hasRow","rowKey","hasCol","colKey","getRow","getCol","thisColArray","thatColArray","newColArray","newColIndex","fromColArray","oldColArray","col","timesCol","implicitIdentity","row","timesRow","thisRowArray","newRowArray","newRowIndex","i2","newRow","j2","newCol","identityFor","fromRowArray","oldRowArray","oldRowIndex","oldColIndex","updatedRow","defaultRow","oldRow","updatedCol","defaultCol","oldCol","cols","forRows","rows","m","forCols","ThemeMatrix","mood","dotOr","ThemeContext","ThemeAnimator","onSetAffinity","newAffinity","oldAffinity","setLook","Look","Extrinsic","inletLook","getInletLook","getInletLookOr","elseLook","initLook","getLook","getLookOr","newLook","minAffinity","oldLook","transition","Timing","getTransition","willSetLook","incrementVersion","onSetLook","didSetLook","applyLook","state","applyTheme","theme","tweenInherited","TweeningFlag","tween","inletVersion","version","inletValue","getOutletValue","derivedValue","deriveValue","inletVersions","inletValues","animator","ThemeConstraintAnimator","isExternal","isDummy","isInvalid","isConstant","evaluateConstraintVariable","updateConstraintSolution","constrained","toNumber","initStrength","strength","ConstraintStrength","Strong","setStrength","coefficient","variable","terms","Map","constant","ConstraintExpression","product","sum","divide","ConstrainedFlag","constrain","conditionCount","stopConstraining","startConstraining","updateConstraintVariable","addConstraintCondition","constraint","solver","removeConstraintCondition","constraining","ConstrainingFlag","willStartConstraining","onStartConstraining","didStartConstraining","constraintScope","ConstraintScope","addConstraintVariable","willStopConstraining","onStopConstraining","didStopConstraining","removeConstraintVariable","setConstraintVariable","animatorClass","animatorPrototype","strengthDescriptor","aArray","bArray","negate","subtract","multiply","NumberLook","NumberInterpolator","LengthLook","LengthInterpolator","ColorLook","FontLook","ShadowLook","TimingLook","smallFont","largeFont","textColor","iconColor","labelColor","legendColor","placeholderColor","highlightColor","statusColor","accentColor","backgroundColor","selectionColor","borderColor","focusColor","etchColor","maskColor","tickColor","gridColor","opacity","spacing","Feel","InterpolatedFeel","BrightnessFeel","amount","OpacityFeel","alpha0","ambient","default","primary","secondary","disabled","inactive","warning","alert","unselected","contrasted","raised","covered","opaque","floating","embossed","nested","hovering","translucent","navigating","Mood","Theme","dark","primaryColor","secondaryColor","disabledColor","inactiveColor","warningColor","alertColor","primarySelectionColor","secondarySelectionColor","warningSelectionColor","alertSelectionColor","raisedColor","coveredColor","ambientFeel","Easing","linear","withDuration","defaultFeel","cubicOut","primaryFeel","secondaryFeel","disabledFeel","inactiveFeel","warningFeel","alertFeel","unselectedFeel","selectedFeel","raisedFeel","coveredFeel","opaqueFeel","floatingFeel","darkerFeel","lighterFeel","contrastedFeel","embossedFeel","nestedFeel","hoveringFeel","translucentFeel","transparentFeel","navigatingFeel","light","ViewInsets","freeze","insetTop","insetRight","insetBottom","insetLeft","View","willAttachParentObservers","styler","_styler_initializers","_mood_initializers","_theme_initializers","moodModifier","_moodModifier_initializers","themeModifier","_themeModifier_initializers","constraints","constraintVariables","didAttachParentObservers","willDetachParentObservers","didDetachParentObservers","willInsertChildObservers","didInsertChildObservers","willRemoveChildObservers","didRemoveChildObservers","willMountObservers","didMountObservers","willUnmountObservers","didUnmountObservers","willResizeObservers","didResizeObservers","willScrollObservers","didScrollObservers","willChangeObservers","didChangeObservers","willAnimateObservers","didAnimateObservers","willProjectObservers","didProjectObservers","willLayoutObservers","didLayoutObservers","willRenderObservers","didRenderObservers","willRasterizeObservers","didRasterizeObservers","willCompositeObservers","didCompositeObservers","attachParent","setNextSibling","setPreviousSibling","setLastChild","setFirstChild","culled","cascadeCull","viewWillAttachParent","viewDidAttachParent","viewWillDetachParent","viewDidDetachParent","viewWillInsertChild","viewDidInsertChild","ProcessMask","cascadeProcess","viewWillRemoveChild","viewDidRemoveChild","viewWillMount","NeedsChange","NeedsAnimate","activateLayout","viewDidMount","viewWillUnmount","deactivateLayout","viewDidUnmount","CulledMask","setCulled","CulledFlag","CullFlag","willCull","onCull","cullChildren","didCull","willUncull","uncullChildren","onUncull","didUncull","cascadeUncull","uncullFlags","UncullFlags","derived","hidden","HiddenMask","setHidden","HiddenFlag","HideFlag","willHide","onHide","hideChildren","didHide","willUnhide","unhideChildren","onUnhide","didUnhide","cascadeHide","cascadeUnhide","unhideFlags","UnhideFlags","unbounded","UnboundedFlag","setUnbounded","unboundedFlag","willSetUnbounded","onSetUnbounded","didSetUnbounded","intangible","IntangibleFlag","setIntangible","willSetIntangible","onSetIntangible","didSetIntangible","NeedsProcess","DisplayMask","NeedsDisplay","processing","ProcessingFlag","needsProcess","processFlags","willProcess","NeedsResize","willResize","NeedsScroll","willScroll","willChange","willAnimate","NeedsProject","willProject","onProcess","onResize","onScroll","onChange","onAnimate","onProject","processChildren","processChild","didProject","didAnimate","didChange","didScroll","didResize","didProcess","viewWillResize","evaluateConstraintVariables","viewDidResize","viewWillScroll","viewDidScroll","viewWillChange","viewDidChange","viewWillAnimate","recohereAnimators","viewDidAnimate","viewWillProject","viewDidProject","displaying","DisplayingFlag","needsDisplay","displayFlags","cascadeDisplay","willDisplay","NeedsLayout","willLayout","NeedsRender","willRender","NeedsRasterize","willRasterize","NeedsComposite","willComposite","onDisplay","onLayout","onRender","onRasterize","onComposite","displayChildren","displayChild","didComposite","didRasterize","didRender","didLayout","didDisplay","viewWillLayout","viewDidLayout","viewWillRender","viewDidRender","viewWillRasterize","viewDidRasterize","viewWillComposite","viewDidComposite","viewport","willApplyTheme","onApplyTheme","didApplyTheme","themeFsteners","modifyMood","hasAffinity","oldMoodModifier","getValueOr","newMoodModifier","modifyTheme","oldThemeModifier","newThemeModifier","ViewRelation","Gesture","bindView","unbindView","DisplayerService","MaxProcessInterval","lhs","relation","rhs","expression","Required","Constraint","addConstraint","hasConstraint","activateConstraint","removeConstraint","deactivateConstraint","solverService","constraintVariable","ConstraintProperty","hasConstraintVariable","activateConstraintVariable","deactivateConstraintVariable","tryService","layoutViewport","visualViewport","viewIdiom","edgeInsets","parentTransform","pageTransform","pageBounds","clientBounds","clientTransform","popoverFrame","scrollX","pageXOffset","scrollY","pageYOffset","translate","R2Box","undefined","intersectsViewport","bounds","viewportWidth","documentElement","clientWidth","viewportHeight","clientHeight","top","bottom","left","right","dispatchEvent","addEventListener","type","listener","removeEventListener","_get_viewport_decorators","ViewportService","addView","removeView","_get_solver_decorators","SolverService","_styler_decorators","StylerService","_mood_decorators","Inherited","superMood","moodModifierProperty","didSetValue","_theme_decorators","superTheme","themeModifierProperty","_moodModifier_decorators","stylerService","_themeModifier_decorators","_get_edgeInsets_decorators","viewType","initView","view","willAttachView","onAttachView","didAttachView","deinitView","willDetachView","onDetachView","didDetachView","parentView","detectView","createView","ViewRef","inletView","getInletView","setView","viewKey","getView","newView","oldView","attachView","detachView","insertView","deleteView","ConstraintContext","tryView","viewRef","viewKeyDescriptor","ViewSet","insertViewMap","views","removeViewMap","hasView","viewCount","addViews","newViews","viewId","setViews","orderedViews","targetView","attachViews","detachViews","insertViews","removeViews","deleteViews","reinsertView","GestureInput","inputId","inputType","isPrimary","button","buttons","altKey","ctrlKey","metaKey","shiftKey","width","tiltX","tiltY","twist","pressure","tangentialPressure","x0","dx","dy","dt","detail","defaultPrevented","preventDefault","pointerInputType","bindsOwner","attachEvents","clearInputs","detachEvents","getInput","inputs","createInput","getOrCreateInput","inputCount","clearInput","resetInput","resetInputs","gesture","PositionGestureInput","pressing","holdTimer","holdDelay","isRunaway","setHoldTimer","clearHoldTimer","PositionGesture","attachHoverEvents","detachPressEvents","detachHoverEvents","attachPressEvents","hoverCount","pressCount","cancelPress","endHover","startHovering","willStartHovering","onStartHovering","didStartHovering","stopHovering","willStopHovering","onStopHovering","didStopHovering","beginHover","willBeginHover","onBeginHover","didBeginHover","willEndHover","onEndHover","didEndHover","startPressing","willStartPressing","onStartPressing","didStartPressing","stopPressing","willStopPressing","onStopPressing","didStopPressing","beginPress","allowPress","willBeginPress","onBeginPress","longPress","didBeginPress","movePress","willMovePress","onMovePress","didMovePress","endPress","willEndPress","onEndPress","didEndPress","willCancelPress","onCancelPress","didCancelPress","press","willPress","onPress","didPress","willLongPress","onLongPress","didLongPress","specialize","superClass","extends","PointerPositionGesture","TouchPositionGesture","MousePositionGesture","PointerEvent","TouchEvent","onPointerEnter","onPointerLeave","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerLeaveDocument","updateInput","clientX","clientY","timeStamp","pointerType","pointerId","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","touch","touches","targetTouches","identifier","changedTouches","onMouseEnter","onMouseLeave","onMouseDown","onMouseMove","onMouseUp","onMouseLeaveDocument","MomentumGestureInput","vx","vy","ax","ay","path","coasting","updatePosition","hysteresis","shift","deriveVelocity","vMax","v2","v","sqrt","integrateVelocity","MomentumGesture","coastCount","endCoast","initHysteresis","acceleration","initAcceleration","velocityMax","initVelocityMax","doCoast","interrupt","cancel","startInteracting","willStartInteracting","onStartInteracting","didStartInteracting","stopInteracting","willStopInteracting","onStopInteracting","didStopInteracting","beginCoast","startCoasting","willStartCoasting","onStartCoasting","didStartCoasting","stopCoasting","willStopCoasting","onStopCoasting","didStopCoasting","atan2","abs","cos","sin","allowCoast","willBeginCoast","onBeginCoast","didBeginCoast","willEndCoast","onEndCoast","didEndCoast","willCoast","integrate","onCoast","didCoast","PointerMomentumGesture","TouchMomentumGesture","MouseMomentumGesture","ScaleGestureInput","xCoord","yCoord","disableX","disableY","ScaleGesture","NeedsRescale","distanceMin","initDistanceMin","preserveAspectRatio","PreserveAspectRatioFlag","wheel","WheelFlag","getXScale","setXScale","xScale","getYScale","setYScale","yScale","clientToRangeX","viewX","xMin","xRange","range","xMax","clientToRangeY","viewY","yMin","yRange","yMax","unscaleX","inverse","unscaleY","rescale","updateInputDomain","conserveMomentum","neutralizeX","neutralizeY","input0","input1","rescaleRadial","rescaleXY","rescaleX","rescaleY","oldXScale","oldYScale","px0","py0","qx0","qy0","vx0","vy0","ax0","ay0","x1","px1","py1","qx1","qy1","vx1","vy1","ax1","ay1","dpx","dpy","dp","upx","upy","dpqx0","dpqy0","dpqx1","dpqy1","ip0","ip1","jp0","jp1","jpx","jpy","rx0","ry0","rx1","ry1","iv0","iv1","jv0","jv1","jvx","jvy","rvx0","rvy0","rvx1","rvy1","uvx0","uvy0","uvx1","uvy1","a0","a1","rax0","ray0","rax1","ray1","newXScale","solvedXScale","solveDomain","newYScale","solvedYScale","sx1","sy1","sx0","sy0","dsx","dsy","esx","esy","distributeXYMomentum","distributeXMomentum","distributeYMomentum","uax0","uay0","uax1","uay1","coast0","coast1","dx0","dy0","d0","dx1","dy1","zoom","dz","PI","zoom0","zoom1","dzx","dzy","zx","zy","PointerScaleGesture","TouchScaleGesture","MouseScaleGesture","gestureClass","onWheel","deltaY","LayoutViewport","pageLeft","pageTop","VisualViewport","offsetLeft","offsetTop","_layoutViewport_initializers","layoutViewportChange","_layoutViewportChange_initializers","_visualViewport_initializers","visualViewportChange","_visualViewportChange_initializers","safeArea","_safeArea_initializers","orientation","_orientation_initializers","orientationChange","_orientationChange_initializers","colorScheme","_colorScheme_initializers","colorSchemeChange","_colorSchemeChange_initializers","_viewIdiom_initializers","load","_load_initializers","_layoutViewport_decorators","detect","update","newLayoutViewport","oldLayoutViewport","_layoutViewportChange_decorators","EventTimer","delay","initTarget","_visualViewport_decorators","_visualViewportChange_decorators","_safeArea_decorators","documentStyle","getComputedStyle","getPropertyValue","pxValue","swallow","CSS","supports","setProperty","_orientation_decorators","matchMedia","matches","_orientationChange_decorators","_colorScheme_decorators","_colorSchemeChange_decorators","_viewIdiom_decorators","_load_decorators","_viewport_initializers","processTimer","displayFrame","runProcessPass","runDisplayPass","scheduleProcessPass","scheduleDisplayPass","cancelProcessPass","cancelDisplayPass","rootViews","rootView","processDelay","MinProcessInterval","requestAnimationFrame","cancelAnimationFrame","updateSafeArea","_viewport_decorators","initService","viewportService","serviceDidScrollLayoutViewport","serviceDidResizeLayoutViewport","serviceDidResizeVisualViewport","serviceDidResizeViewportSafeArea","serviceDidSetViewportOrientation","serviceDidSetViewIdiom","createSolver","ConstraintSolver","serviceDidSetViewportColorScheme","AttributeContext","AttributeAnimator","attributeName","attributeValue","getAttribute","getAttributeValue","setAttribute","StringAttributeAnimator","Number","NumberAttributeAnimator","Boolean","BooleanAttributeAnimator","LengthAttributeAnimator","ColorAttributeAnimator","TransformAttributeAnimator","number","StyleContext","StyleAnimator","propertyNames","propertyValue","getStyle","fromCssValue","computedValue","node","Element","styles","cssValue","definedValue","getCssValue","cssState","getCssState","applyStyle","priority","initPriority","setPriority","setStyle","StringStyleAnimator","NumberStyleAnimator","LengthStyleAnimator","ColorStyleAnimator","FontFamilyStyleAnimator","BoxShadowStyleAnimator","TransformStyleAnimator","CSSNumericValue","to","basis","defaultValue","emValue","remValue","pctValue","pxState","emState","remState","pctState","PxLength","EmLength","RemLength","PctLength","emUnit","remUnit","pctUnit","StyleConstraintAnimator","constraintValue","NumberStyleConstraintAnimator","LengthStyleConstraintAnimator","styleContext","StyleAttribute","propertyName","willSetStyle","onSetStyle","didSetStyle","applyStyles","pctWidthUnit","HTMLElement","offsetParent","offsetWidth","innerWidth","pctHeightUnit","offsetHeight","innerHeight","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","marginTop","marginRight","marginBottom","marginLeft","overflowX","overflowY","overscrollBehaviorX","overscrollBehaviorY","paddingTop","paddingRight","paddingBottom","paddingLeft","CssScope","onUnbindInlet","detachCss","getOutletCss","css","inletCss","getInletCss","transformInletCss","getCss","setCss","newCss","oldCss","willDetachCss","onDetachCss","deinitCss","didDetachCss","willAttachCss","onAttachCss","initCss","didAttachCss","attachCss","StyleSheet","CSSStyleSheet","CssRule","selector","cssText","CSSGroupingRule","createRule","insertRule","cssRules","StyleRule","RANDOM_MARKER_ID","random","CSSStyleRule","rule","styleMap","removeProperty","MediaRule","CSSMediaRule","ClassList","classList","classNames","contains","className","willAdd","onAdd","didAdd","willRemove","onRemove","didRemove","replace","oldClassName","newClassName","TextContext","TextAnimator","textContent","NodeView","nodeMap","text","Node","fromNode","detachParent","removeChildMap","targetNode","nextView","insertBefore","insertChildMap","parentNode","nextNode","injectChild","reattachParent","isRootView","isNodeMounted","isConnected","ownerDocument","compareDocumentPosition","DOCUMENT_POSITION_DISCONNECTED","createRange","selectNode","getBoundingClientRect","detach","HtmlView","SVGElement","SvgView","ElementView","TextView","_get_text_decorators","WeakMap","createTextNode","ElementAttributes","willSetAttributeObservers","didSetAttributeObservers","willSetStyleObservers","didSetStyleObservers","attributes","willSetAttribute","removeAttribute","onSetAttribute","didSetAttribute","viewWillSetAttribute","viewDidSetAttribute","attributeStyleMap","viewWillSetStyle","viewDidSetStyle","detectTheme","themeName","DomService","eval","dom","modal","hasAttribute","fromTag","namespace","createElementNS","createElement","_get_dom_decorators","unmountService","_get_modal_decorators","ModalService","modalView","ModalView","presentModal","dismissModal","toggleModal","_get_attributes_decorators","_get_style_decorators","_get_classList_decorators","HtmlAttributes","applyRootTheme","Transient","isPositioned","element","position","StyleView","forTag","HtmlViewTagFactory","factory","sheet","_sheet_initializers","_sheet_decorators","SvgAttributes","SvgViewTagFactory","materializeView","childNodes","childNode","childView","materializeNode","materializeElement","materializeText","viewClass","viewClassName","boot","nodes","querySelectorAll","bootElement","qname","globalThis","self","idents","split","matte","_matte_initializers","modals","_modals_initializers","modality","_modality_initializers","fallthrough","_fallthrough_initializers","dismissModals","presence","modalViews","displaceModals","_matte_decorators","_modals_decorators","viewWillPresent","viewDidPresent","viewWillDismiss","viewDidDismiss","viewDidSetModality","_modality_decorators","newModality","oldModality","_fallthrough_decorators","GraphicsRenderer","Graphics","GraphicsView","renderer","_renderer_initializers","ownViewFrame","eventHandlers","renderViewOutline","viewBox","outlineColor","outlineWidth","contextLineWidth","lineWidth","contextStrokeStyle","strokeStyle","beginPath","moveTo","lineTo","closePath","stroke","sprites","viewFrame","deriveViewFrame","setViewFrame","CanvasView","cullViewFrame","intersects","viewBounds","ownViewBounds","deriveViewBounds","childViewBounds","union","hitBounds","deriveHitBounds","childHitBounds","cascadeHitTest","hit","hitTestChildren","hitTest","hitTestChild","inverseClientTransform","inversePageTransform","handlers","capture","passive","once","handler","handleEvent","bubbleEvent","bubbles","cancelBubble","_renderer_decorators","_get_sprites_decorators","SpriteService","DrawingRenderer","PathContext","precision","d","setPrecision","anglePrecision","decimal","quadraticCurveTo","bezierCurveTo","x2","y2","arcTo","x21","y21","x01","y01","l01_2","Epsilon","x20","y20","l21_2","l20_2","l21","l01","tan","acos","t01","t21","rs","arc","cx","cy","ccw","cw","da","rect","w","ellipse","rx","ry","phi","cosPhi","sinPhi","cosA1","sinA1","large","sweep","PathRenderer","pixelRatio","PaintingRenderer","SvgContext","pathContext","pathView","pathFlags","globalAlpha","globalCompositeOperation","fillStyle","lineCap","lineJoin","miterLimit","lineDashOffset","lineDash","getPathContext","getOrCreatePathContext","createPathContext","finalizePath","nextPathView","setPathView","setPathFlags","SVGPathElement","FillFlag","fill","FillRuleFlag","fillRule","StrokeFlag","PathFlag","getLineDash","setLineDash","segments","created","fillOpacity","pathString","strokeWidth","strokeLinecap","strokeLinejoin","strokeOpacity","strokeMiterlimit","dash","strokeDasharray","strokeDashoffset","beginSvg","finalizeSvg","SvgRenderer","CanvasRenderer","setTransform","WebGLRenderer","devicePixelRatio","Sprite","spriteWidth","spriteHeight","getRenderer","getSpriteRenderer","clearSprite","draw","frame","drawSprite","release","releaseSprite","SpriteSheet","canvasWidth","canvasHeight","floor","spriteCount","freeSprites","canvas","getContext","nextSheet","createSprites","sprite","createSprite","freeCount","acquireNextFreeSheet","acquireSprite","pop","clearRect","affine","spritePixelRatio","spriteX","spriteY","drawImage","minSizeClass","maxSizeClass","TextureWidth","TextureHeight","log2","slabCount","slabs","createSlab","sizeClass","spriteSize","getFreeSlab","slab","freeSlab","createSheet","getFreeSheet","widthClass","ceil","heightClass","clickEvents","_clickEvents_initializers","wheelEvents","_wheelEvents_initializers","mouseEvents","_mouseEvents_initializers","pointerEvents","_pointerEvents_initializers","touchEvents","_touchEvents_initializers","click","_click_initializers","dblclick","_dblclick_initializers","contextmenu","_contextmenu_initializers","_wheel_initializers","mouseenter","_mouseenter_initializers","mouseleave","_mouseleave_initializers","mousedown","_mousedown_initializers","mousemove","_mousemove_initializers","mouseup","_mouseup_initializers","pointerenter","_pointerenter_initializers","pointerleave","_pointerleave_initializers","pointerdown","_pointerdown_initializers","pointermove","_pointermove_initializers","pointerup","_pointerup_initializers","pointercancel","_pointercancel_initializers","touchstart","_touchstart_initializers","touchmove","_touchmove_initializers","touchend","_touchend_initializers","touchcancel","_touchcancel_initializers","mouse","pointers","resizeCanvas","resetRenderer","detectHitTargets","clearCanvas","createRenderer","rendererType","detectMouseTarget","pointer","detectPointerTarget","setEventTarget","eventTarget","setTarget","fireEvent","updateMouse","screenX","screenY","movementX","movementY","relatedTarget","fireMouseEvent","onMouseTargetChange","newTargetView","oldTargetView","commonAncestorView","commonAncestor","outEvent","MouseEvent","relatedTargetView","leaveView","leaveEvent","assign","overEvent","enterView","enterEvent","updatePointer","firePointerEvent","onPointerTargetChange","updateTouch","pageX","pageY","radiusX","radiusY","rotationAngle","force","fireTouchEvent","originalEvent","dispatched","changedTouch","startEvent","targetViewTouches","nextTouch","touchDocument","createTouchList","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","createService","_clickEvents_decorators","enabled","_wheelEvents_decorators","_mouseEvents_decorators","_pointerEvents_decorators","_touchEvents_decorators","_click_decorators","_dblclick_decorators","_contextmenu_decorators","_wheel_decorators","_mouseenter_decorators","_mouseleave_decorators","_mousedown_decorators","_mousemove_decorators","_mouseup_decorators","_pointerenter_decorators","_pointerleave_decorators","_pointerdown_decorators","_pointermove_decorators","_pointerup_decorators","_pointercancel_decorators","_touchstart_decorators","_touchmove_decorators","_touchend_decorators","_touchcancel_decorators","RasterView","_opacity_initializers","compositeOperation","_compositeOperation_initializers","compositor","_compositor_initializers","createCanvas","ownRasterFrame","rasterFlags","rasterFrame","compositeImage","deriveRasterFrame","setRasterFrame","newWidth","newHeight","newCanvasWidth","newCanvasHeight","oldCanvasWidth","oldCanvasHeight","_opacity_decorators","_compositeOperation_decorators","_compositor_decorators","FillView","StrokeView","Rect","withX","withY","withWidth","render","renderRect","RectView","_x_initializers","_y_initializers","_width_initializers","_height_initializers","_fill_initializers","_stroke_initializers","_strokeWidth_initializers","getState","contextFillStyle","hitTestRect","hx","hy","isPointInPath","pointInStroke","isPointInStroke","_x_decorators","_y_decorators","_width_decorators","_height_decorators","_fill_decorators","_stroke_decorators","_strokeWidth_decorators","Arc","center","innerRadius","outerRadius","startAngle","sweepAngle","padAngle","padRadius","cornerRadius","withCenter","R2Point","withInnerRadius","withOuterRadius","withStartAngle","withSweepAngle","withPadAngle","withPadRadius","withCornerRadius","renderArc","r0","r1","radValue","a01","a11","a00","a10","da0","da1","ap","rp","rc","x00","y00","rc0","rc1","asin","x10","y10","x11","y11","oc","intersect","bx","by","kc","lc","cornerTangents","origin","x3","y3","x32","y32","lo","ox","oy","d2","D","cx0","cy0","cx1","cy1","ArcView","xAlign","_xAlign_initializers","yAlign","_yAlign_initializers","_center_initializers","_innerRadius_initializers","_outerRadius_initializers","_startAngle_initializers","_sweepAngle_initializers","_padAngle_initializers","_padRadius_initializers","_cornerRadius_initializers","layoutArc","transformX","py","transformY","hitTestArc","_xAlign_decorators","_yAlign_decorators","_center_decorators","_innerRadius_decorators","_outerRadius_decorators","_startAngle_decorators","_sweepAngle_decorators","_padAngle_decorators","_padRadius_decorators","_cornerRadius_decorators","radius","TypesetView","TextRun","textAlign","textBaseline","textOrigin","withText","withFont","withTextAlign","withTextBaseline","withTextOrigin","withTextColor","renderText","contextFont","contextTextAlign","contextTextBaseline","fillText","TextRunView","_text_initializers","_font_initializers","_textAlign_initializers","_textBaseline_initializers","_textOrigin_initializers","_textColor_initializers","run","_text_decorators","_textAlign_decorators","_textBaseline_decorators","_font_decorators","_textOrigin_decorators","_textColor_decorators","IconLayoutLike","IconLayout","IconLayoutInit","withXAlign","withYAlign","withAlign","IconLayoutInterpolator","l0","l1","Icon","FilledIcon","VectorIcon","fillColor","fillLook","withFillRule","withFillColor","withFillLook","withMoodModifier","isThemed","withTheme","paint","contextGlobalAlpha","transformDraw","VectorIconInterpolator","R2Path","i0","i1","fillColorInterpolator","CircleIcon","centerX","centerY","CircleIconInterpolator","PolygonIcon","sides","rotation","sector","PolygonIconInterpolator","rotationInterpolator","EnclosedIcon","outer","inner","innerScale","outerMoodModifier","innerMoodModifier","withOuter","withInner","withInnerScale","withOuterMoodModifier","modifyOuterMood","oldOuterMoodModifier","newOuterMoodModifier","withInnerMoodModifier","modifyInnerMood","oldInnerMoodModifier","newInnerMoodModifier","modifiedMood","oldOuter","newOuter","outerMood","oldInner","newInner","innerMood","outerFrame","innerFrame","ex","ey","EnclosedIconInterpolator","embossedMoodModifier","_static_get_embossedMoodModifier_decorators","outerInterpolator","innerInterpolator","innerScaleInterpolator","IconView","IconGraphicsAnimator","graphics","iconView","transformState","GraphicsIconView","iconLayout","_iconLayout_initializers","_graphics_initializers","oldGraphics","newGraphics","renderIcon","hitTestIcon","_iconLayout_decorators","_get_iconColor_decorators","didSetState","_graphics_decorators","viewWidth","viewHeight","viewSize","iconWidth","iconHeight","SvgIconView","iconBounds","viewportElement","SVGSVGElement","animVal","HtmlIconView","svg","_svg_initializers","initIcon","layoutIcon","svgView","_svg_decorators","setInherits","Controller","CompileMask","cascadeCompile","NeedsRevise","NeedsCompile","ExecuteMask","NeedsExecute","compiling","CompilingFlag","needsCompile","compileFlags","willCompile","NeedsResolve","willResolve","NeedsGenerate","willGenerate","NeedsAssemble","willAssemble","onCompile","onResolve","onGenerate","onAssemble","compileChildren","compileChild","didAssemble","didGenerate","didResolve","didCompile","executing","ExecutingFlag","needsExecute","executeFlags","cascadeExecute","willExecute","willRevise","NeedsCompute","willCompute","onExecute","onRevise","onCompute","executeChildren","executeChild","didCompute","didRevise","didExecute","ControllerRelation","TraitViewRef","bindController","unbindController","ExecutorService","addController","removeController","controllerType","initController","controller","willAttachController","onAttachController","didAttachController","deinitController","willDetachController","onDetachController","didDetachController","parentController","detectController","createController","ControllerRef","inletController","getInletController","setController","controllerKey","getController","newController","oldController","attachController","detachController","insertController","deleteController","tryController","controllerRef","controllerKeyDescriptor","ControllerSet","insertControllerMap","controllers","removeControllerMap","hasController","controllerCount","addControllers","newControllers","controllerId","setControllers","orderedControllers","targetController","attachControllers","detachControllers","insertControllers","removeControllers","deleteControllers","reinsertController","consumeControllers","unconsumeControllers","bindsTrait","insertChildTrait","bindsView","observesView","fromViewLike","insertChildView","ViewControllerRef","viewOrController","insertControllerView","detectControllerView","ViewControllerSet","getViewController","viewControllers","associateViewController","dissociateViewController","compareViews","TraitControllerRef","getTraitRef","traitOrController","TraitControllerSet","traitControllers","TraitViewControllerRef","getTraitViewRef","traitOrViewOrController","traitViewRef","TraitViewControllerSet","getTargetView","nextController","compileTimer","executeTimer","runCompilePass","runExecutePass","MaxCompileInterval","scheduleCompilePass","scheduleExecutePass","MinExecuteInterval","cancelCompilePass","cancelExecutePass","rootControllers","rootController","compileDelay","MinCompileInterval","MaxExecuteInterval","HistoryState","fragment","parameters","environment","current","fromUri","location","href","console","delta","cloned","uri","fromUriFragment","query","UriFragment","UriQuery","tail","toUri","queryBuilder","builder","build","HistoryService","historyState","popstate","_popstate_initializers","historyUri","pushHistory","deltaState","newUri","willPushHistory","history","pushState","onPushHistory","didPushHistory","replaceHistory","willReplaceHistory","replaceState","onReplaceHistory","didReplaceHistory","willPopHistory","onPopHistory","didPopHistory","_popstate_decorators","Hyperlink","title","HistoryHyperlink","LocationHyperlink","hyperlink","activate"],"mappings":"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","x_google_ignoreList":[0]}