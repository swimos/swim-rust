{"version":3,"file":"swim-transit.js","sources":["../../node_modules/tslib/tslib.es6.js","../../main/kpi/KpiViewController.ts","../../main/kpi/Kpi1ViewController.ts","../../main/kpi/Kpi2ViewController.ts","../../main/kpi/Kpi3ViewController.ts","../../main/map/TransitMapView.ts","../../main/map/AgencyMapView.ts","../../main/map/AgencyPopoverViewController.ts","../../main/map/VehicleMapView.ts","../../main/map/VehiclePopoverViewController.ts","../../main/map/VehicleMapViewController.ts","../../main/map/AgencyMapViewController.ts","../../main/map/TransitMapViewController.ts","../../main/TransitViewController.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Length} from \"@swim/length\";\nimport {Color} from \"@swim/color\";\nimport {HtmlView, HtmlViewController} from \"@swim/view\";\nimport {TextRunView} from \"@swim/typeset\";\nimport {PieView,\n  // SliceView\n} from \"@swim/pie\";\n\nexport abstract class KpiViewController extends HtmlViewController {\n  /** @hidden */\n  _updateTimer: number;\n\n  /** @hidden */\n  _kpiTitle?: HtmlView;\n\n  /** @hidden */\n  _subtitle?: HtmlView;\n\n  /** @hidden */\n  _pieView: PieView;\n\n  /** @hidden */\n  _pieTitle?: TextRunView;\n\n  constructor() {\n    super();\n    this._updateTimer = 0;\n  }\n\n  abstract get primaryColor(): Color;\n\n  abstract updateKpi(): void;\n\n  get kpiTitle(): HtmlView | undefined {\n    return this._kpiTitle;\n  }\n\n  get pieTitle(): TextRunView | undefined {\n    return this._pieTitle;\n  }\n\n  get pieView(): PieView {\n    return this._pieView;\n  }\n\n  didSetView(view: HtmlView): void {\n    const primaryColor = this.primaryColor;\n\n    view.display(\"flex\")\n        .flexDirection(\"column\")\n        .padding(8)\n        .fontFamily(\"\\\"Open Sans\\\", sans-serif\")\n        .fontSize(12);\n\n    const header = view.append(\"div\")\n        .display(\"flex\")\n        .justifyContent(\"space-between\")\n        .textTransform(\"uppercase\")\n        .color(primaryColor);\n\n    const headerLeft = header.append(\"div\");\n    this._kpiTitle = headerLeft.append(\"span\").display(\"block\").text(\" -- \");\n\n    const headerRight = header.append(\"div\");\n    headerRight.append(\"span\").text(\"Real-Time\");\n\n    const body = view.append(\"div\").key(\"body\").position(\"relative\").flexGrow(1).width(\"100%\");\n    const bodyCanvas = body.append(\"canvas\").key(\"canvas\");\n\n    this._pieView = new PieView()\n        .key(\"pie\")\n        .innerRadius(Length.pct(34))\n        .outerRadius(Length.pct(40))\n        .cornerRadius(Length.pct(50))\n        .tickRadius(Length.pct(45))\n        .font(\"12px \\\"Open Sans\\\", sans-serif\")\n        .textColor(primaryColor);\n    bodyCanvas.append(this._pieView);\n\n    this._pieTitle = new TextRunView()\n        .font(\"36px \\\"Open Sans\\\", sans-serif\")\n        .textColor(primaryColor);\n    this._pieView.title(this._pieTitle);\n  }\n\n  viewDidMount(view: HtmlView): void {\n    // force resize after flexbox layout\n    //requestAnimationFrame(function () { view.cascadeResize(); });\n\n    this._updateTimer = setInterval(this.updateKpi.bind(this), 1000) as any;\n    this.updateKpi();\n  }\n\n  viewWillUnmount(view: HtmlView): void {\n    clearInterval(this._updateTimer);\n    this._updateTimer = 0;\n  }\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n// import { Value } from '@swim/structure';\nimport {NodeRef} from \"@swim/client\";\nimport {Color} from \"@swim/color\";\n// import {Transition} from \"@swim/transition\";\nimport {MapGraphicView} from \"@swim/map\";\n//import {AgencyMapView} from \"../map/AgencyMapView\";\nimport {KpiViewController} from \"./KpiViewController\";\n\nexport class Kpi1ViewController extends KpiViewController {\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _transitMapView: MapGraphicView;\n\n  constructor(nodeRef: NodeRef, transitMapView: MapGraphicView) {\n    super();\n    this._nodeRef = nodeRef;\n    this._transitMapView = transitMapView;\n  }\n\n  get primaryColor(): Color {\n    return Color.parse(\"#00a6ed\");\n  }\n\n  updateKpi(): void {\n    this.kpiTitle!.text('speed (km/h)');\n    // let meterValue = 0;\n    // let spaceValue = 0;\n    //const agencyMapViews = this._transitMapView.childViews;\n    //console.log('agencyMapViews: ', agencyMapViews);\n    //for (let i = 0; i < agencyMapViews.length; i += 1) {\n    //  const agencyMapView = agencyMapViews[i];\n    //  if (agencyMapView instanceof AgencyMapView ) {\n    //    const agencyMapViewController = agencyMapView.viewController!;\n    //    //console.log('agencyMapViewController: ', agencyMapViewController);\n    //     if (intersectionMapViewController._pedCall) {\n    //       meterValue += 1;\n    //     } else {\n    //       spaceValue += 1;\n    //     }\n    //  }\n    //}\n\n    // const title = this.titleView;\n    // const meter = this.meterView;\n    // const empty = this.emptyView;\n    // const tween = Transition.duration<any>(1000);\n\n    // this.title!.text('Palo Alto - PEDESTRIAN BACKUP');\n    // this.subtitle!.text('@ CROSSWALKS');\n\n    // meter.value(meterValue, tween);\n    // empty.value(spaceValue, tween);\n    // this.meterLegend!.text(\"Waiting (\" + meterValue + \")\");\n    // this.clearLegend!.text(\"Clear (\" + spaceValue + \")\");\n    // title.text(Math.round(100 * meterValue / ((meterValue + spaceValue) || 1)) + \"%\");\n  }\n\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Value } from '@swim/structure';\nimport {NodeRef} from \"@swim/client\";\nimport {Color} from \"@swim/color\";\nimport {Transition} from \"@swim/transition\";\nimport {MapGraphicView} from \"@swim/map\";\n// import {IntersectionMapView} from \"../map/IntersectionMapView\";\nimport {KpiViewController} from \"./KpiViewController\";\nimport {SliceView} from \"@swim/pie\";\n\nexport class Kpi2ViewController extends KpiViewController {\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _trafficMapView: MapGraphicView;\n\n  constructor(nodeRef: NodeRef, trafficMapView: MapGraphicView) {\n    super();\n    this._nodeRef = nodeRef;\n    this._trafficMapView = trafficMapView;\n  }\n\n  get primaryColor(): Color {\n    return Color.parse(\"#00a6ed\");\n  }\n\n  updateKpi(): void {\n    // console.info('Update KPI');\n    // this.linkData();\n    this.kpiTitle!.text('speed (km/h)');\n\n  }\n\n  updateData(key: Value, value: Value) {\n    // console.log('updateData: k: ', key, ' v: ', value);\n    const sliceColors = [Color.parse(\"#00a6ed\"), Color.parse(\"#7ed321\"),\n                          Color.parse(\"#c200fb\"), Color.parse(\"#50e3c2\"),\n                          Color.parse(\"#57b8ff\"), Color.parse(\"#5aff15\"),\n                          Color.parse(\"#55dde0\"), Color.parse(\"#f7aef8\")];\n\n    const tween: Transition<number> = Transition.duration(1000);\n    const id = key.get(\"id\").stringValue() || '';\n    const index = key.get(\"index\").numberValue() || 0;\n    const sliceColor = sliceColors[index % 8];\n    const sliceValue = value.numberValue() || 0;\n    const pie = this.pieView;\n    if (sliceValue > 0) {\n      let slice: SliceView = pie.getChildView(id) as SliceView;\n      if (slice) {\n        slice.value(sliceValue, tween);\n        // slice.label().text(sliceValue.toFixed());\n      } else {\n        slice = new SliceView()\n            .value(sliceValue)\n            .sliceColor(sliceColor)\n            .label(sliceValue.toFixed())\n            .legend(id);\n        pie.setChildView(id, slice);\n      }\n    }\n  }\n\n  protected linkData() {\n    // console.info('link data');\n    this._nodeRef.downlinkMap()\n      .nodeUri(\"/state/US/S-CA\")\n      .laneUri(\"agencySpeed\")\n      .didUpdate(this.updateData.bind(this))\n      .open();\n  }\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Value } from '@swim/structure';\nimport {NodeRef} from \"@swim/client\";\nimport {Color} from \"@swim/color\";\nimport {MapGraphicView} from \"@swim/map\";\nimport {KpiViewController} from \"./KpiViewController\";\n\nexport class Kpi3ViewController extends KpiViewController {\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _trafficMapView: MapGraphicView;\n\n  constructor(nodeRef: NodeRef, trafficMapView: MapGraphicView) {\n    super();\n    this._nodeRef = nodeRef;\n    this._trafficMapView = trafficMapView;\n  }\n\n  get primaryColor(): Color {\n    return Color.parse(\"#00a6ed\");\n  }\n\n  updateKpi(): void {\n    this.kpiTitle!.text('Total Count');\n  }\n\n  updateData(k: Value, v: Value) {\n    // console.log('k: ', k, ' v: ', v);\n  }\n\n  protected linkData() {\n    this._nodeRef.downlinkMap()\n      .laneUri(\"count\")\n      .didUpdate(this.updateData.bind(this))\n      .open();\n  }\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyColor, Color} from \"@swim/color\";\nimport {MemberAnimator} from \"@swim/view\";\nimport {MapGraphicView} from \"@swim/map\";\nimport {TransitMapViewController} from \"./TransitMapViewController\";\n\nexport class TransitMapView extends MapGraphicView {\n  /** @hidden */\n  _viewController: TransitMapViewController | null;\n\n  constructor() {\n    super();\n    this.agencyMarkerColor.setState(Color.parse(\"#5aff15\"));\n    this.vehicleMarkerColor.setState(Color.parse(\"#00a6ed\"));\n  }\n\n  get viewController(): TransitMapViewController | null {\n    return this._viewController;\n  }\n\n  @MemberAnimator(Color)\n  agencyMarkerColor: MemberAnimator<this, Color, AnyColor>;\n\n  @MemberAnimator(Color)\n  vehicleMarkerColor: MemberAnimator<this, Color, AnyColor>;\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyColor, Color} from \"@swim/color\";\nimport {MemberAnimator} from \"@swim/view\";\nimport {MapGraphicView} from \"@swim/map\";\nimport {AgencyMapViewController} from \"./AgencyMapViewController\";\n\nexport class AgencyMapView extends MapGraphicView {\n  /** @hidden */\n  _viewController: AgencyMapViewController | null;\n\n  get viewController(): AgencyMapViewController | null {\n    return this._viewController;\n  }\n\n  @MemberAnimator(Color, {inherit: true})\n  agencyMarkerColor: MemberAnimator<this, Color, AnyColor>;\n\n  @MemberAnimator(Color, {inherit: true})\n  vehicleMarkerColor: MemberAnimator<this, Color, AnyColor>;\n\n  // protected onCull(): void {\n  //   super.onCull();\n  //   if (this._hitBounds === null) {\n  //     this.setCulled(true);\n  //   }\n  // }\n\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {NodeRef} from \"@swim/client\";\nimport {Color} from \"@swim/color\";\nimport {PopoverView, PopoverViewController} from \"@swim/view\";\nimport {AgencyInfo} from \"./AgencyModel\";\n\nexport class AgencyPopoverViewController extends PopoverViewController {\n  /** @hodden */\n  _info: AgencyInfo;\n  /** @hidden */\n  _nodeRef: NodeRef;\n\n  constructor(info: AgencyInfo, nodeRef: NodeRef) {\n    super();\n    this._info = info;\n    this._nodeRef = nodeRef;\n  }\n\n  didSetView(view: PopoverView): void {\n    view.width(240)\n        .height(360)\n        .borderRadius(5)\n        .padding(10)\n        .backgroundColor(Color.parse(\"#071013\").alpha(0.9))\n        .backdropFilter(\"blur(2px)\");\n\n    const agency = this._info;\n\n    const container = view.append(\"div\").color(\"#ffffff\");\n\n    container.append(\"span\").key(\"name\").text(\"\" + agency.id);\n\n    // TODO: layout popover\n  }\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Length} from \"@swim/length\";\nimport {AnyColor, Color} from \"@swim/color\";\nimport {MemberAnimator} from \"@swim/view\";\nimport {MapCircleView} from \"@swim/map\";\nimport {VehicleMapViewController} from \"./VehicleMapViewController\";\n\nexport class VehicleMapView extends MapCircleView {\n  /** @hidden */\n  _viewController: VehicleMapViewController | null;\n\n  constructor() {\n    super();\n    this.fill.setState(Color.transparent());\n    this.radius.setState(Length.px(5));\n  }\n\n  get viewController(): VehicleMapViewController | null {\n    return this._viewController;\n  }\n\n  @MemberAnimator(Color, {inherit: true})\n  vehicleMarkerColor: MemberAnimator<this, Color, AnyColor>;\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {MapDownlink, NodeRef} from \"@swim/client\";\nimport {Color} from \"@swim/color\";\nimport {PopoverView, PopoverViewController, HtmlView} from \"@swim/view\";\nimport {VehicleInfo} from \"./VehicleModel\";\nimport {ChartView, LineGraphView} from \"@swim/chart\";\n\nexport class VehiclePopoverViewController extends PopoverViewController {\n  /** @hidden */\n  _info: VehicleInfo;\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _colorRage: string[];\n  /** @hidden */\n  _speedChart: ChartView;\n  /** @hidden */\n  _linkSpeedHistory?: MapDownlink<Value, Value, AnyValue, AnyValue>;\n  /** @hidden */\n  _speedPlot: any;\n  /** @hidden */\n  _linkAccelHistory?: MapDownlink<Value, Value, AnyValue, AnyValue>;\n  /** @hidden */\n  _accelerationPlot: any;\n  /** @hidden */\n  _speedItem: any;\n\n  constructor(info: VehicleInfo, nodeRef: NodeRef) {\n    super();\n    this._info = info;\n    this._nodeRef = nodeRef;\n    this._colorRage = [\n      '#00A6ED',\n      '#7ED321',\n      '#57B8FF',\n      '#50E3C2',\n      '#C200FB',\n      '#5AFF15',\n      '#55DDE0',\n      '#F7AEF8'\n    ]\n  }\n\n  didSetView(view: PopoverView): void {\n    view.width(240)\n        .height(360)\n        .borderRadius(5)\n        .padding(10)\n        .backgroundColor(Color.parse(\"#071013\").alpha(0.9))\n        .backdropFilter(\"blur(2px)\");\n\n\n    const vehicle = this._info;\n    const agencyIndex = vehicle.index%8;\n    const colorAgency = this._colorRage[agencyIndex];\n    //const agency = vehicle.agencyInfo!;\n\n    // main container\n    const busPopover = view.append(\"div\").color(Color.parse(\"#ffffff\").alpha(0.9));\n    busPopover.className('busPopover');\n\n    // header\n    const placardHeader: HtmlView = busPopover.append(\"div\").color(colorAgency);\n    placardHeader.className('placardHeader');\n\n    const ledIcon: HtmlView = placardHeader.append(\"div\");\n    ledIcon.className('ledIcon');\n    ledIcon.backgroundColor(colorAgency);\n    \n    const ledLabel = ledIcon.append(\"h3\").text(vehicle.routeTag);\n    ledLabel.className('ledLabel');\n\n    const placardLabel = placardHeader.append('h2');\n    placardLabel.className('placardLabel');\n    placardLabel.text(`bus #${vehicle.id}`);\n\n    const popoverMeter = placardHeader.append(\"div\");\n    popoverMeter.className(\"popover-meter\")\n    popoverMeter.borderColor(colorAgency)\n\n    const meterFill = popoverMeter.append(\"div\");\n    meterFill.className('fill');\n    meterFill.backgroundColor(colorAgency)\n      .height(`${(vehicle.speed/130)*100}%`);\n\n    // add gap\n    busPopover.append(\"div\")\n      .className(\"placardSubheader\");\n\n    // subheader\n    const placardSubheader = busPopover.append(\"div\");\n    placardSubheader.className(\"placardSubheader\");\n\n    // speed\n    this._speedItem = placardSubheader.append(\"div\")\n      .text(`${vehicle.speed} km/h`)\n      .backgroundColor(colorAgency);\n    this._speedItem.className(\"placardSubheaderItem\");\n\n    // direction\n    placardSubheader.append(\"div\")\n      .text(`${vehicle.dirId}`)\n      .backgroundColor(colorAgency)\n      .className(\"placardSubheaderItem\");\n\n    // heading\n    placardSubheader.append(\"div\")\n      .text(`${vehicle.heading}`)\n      .backgroundColor(colorAgency)\n      .className(\"placardSubheaderItem\");\n\n    // route name\n    busPopover.append(\"div\").text(vehicle.routeTitle)\n      .className(\"placard-route\");\n\n    // agency name\n    busPopover.append(\"div\").text(vehicle.agency)\n      .paddingTop(10)\n      .className(\"placard-agency\");\n\n    // start charts\n    const chartsContainer = busPopover.append(\"div\");\n    chartsContainer.className('busCharts');\n\n    // speed chart title\n    const speedChartTitle = chartsContainer.append(\"h3\").text(\"Speed\");\n    speedChartTitle.className(\"chartTitle\");\n\n    // chart container\n    const speedChartContainer = chartsContainer.append(\"div\");\n    speedChartContainer.className('chartContainer');\n\n    // speed chart\n    const speedChartCanvas = speedChartContainer.append(\"canvas\").height(200);\n    this._speedChart = new ChartView()\n      .bottomAxis(\"time\")\n      .leftAxis(\"linear\")\n      .bottomGesture(false)\n      .leftDomainPadding([0.1, 0.1])\n      .topGutter(0)\n      .rightGutter(0)\n      .bottomGutter(0)\n      .leftGutter(-1)\n      .domainColor(Color.transparent(0))\n      .tickMarkColor(Color.transparent(0));\n    \n    speedChartCanvas.append(this._speedChart);    \n\n    this._speedPlot = new LineGraphView()\n      .stroke(colorAgency)\n      .strokeWidth(1);\n\n    this._speedChart.addPlot(this._speedPlot);    \n    \n    // acceleration chart title\n    const accelChartTitle = chartsContainer.append(\"h3\").text(\"Acceleration\");\n    accelChartTitle.className(\"chartTitle\");\n\n    // chart container\n    const accelChartContainer = chartsContainer.append(\"div\");\n    accelChartContainer.className('chartContainer');\n\n    // speed chart\n    const accelChartCanvas = accelChartContainer.append(\"canvas\").height(200);\n    const accelerationChart = new ChartView()\n      .bottomAxis(\"time\")\n      .leftAxis(\"linear\")\n      .bottomGesture(false)\n      .leftDomainPadding([0.1, 0.1])\n      .topGutter(0)\n      .rightGutter(0)\n      .bottomGutter(0)\n      .leftGutter(-1)\n      .domainColor(Color.transparent(0))\n      .tickMarkColor(Color.transparent(0));\n    \n      accelChartCanvas.append(accelerationChart);    \n\n    this._accelerationPlot = new LineGraphView()\n      .stroke(colorAgency)\n      .strokeWidth(1);\n\n    accelerationChart.addPlot(this._accelerationPlot);       \n\n    // headerRow.append(\"span\").key(\"routeTitle\").text(vehicle.routeTitle);\n\n    //console.info('vehicle', vehicle);\n    // TODO: layout popover\n  }\n\n  popoverDidShow(view: any): void {\n    this.linkSpeedHistory();\n    this.linkAccelHistory();\n  }\n\n  popoverDidHide(view: any): void {\n    this.unlinkSpeedHistory();\n    this.unlinkAccelHistory();\n  }  \n\n  // speed history data handlers\n  protected linkSpeedHistory() {\n    if(!this._linkSpeedHistory) {\n      this._linkSpeedHistory = this._nodeRef.downlinkMap()\n        .nodeUri(this._info.uri)\n        .laneUri(\"speeds\")\n        .didUpdate(this.didUpdateSpeedHistory.bind(this))\n        .didRemove(this.didRemoveSpeedHistory.bind(this))\n        .open();\n    }\n  }\n\n  protected unlinkSpeedHistory() {\n    if (this._linkSpeedHistory) {\n      this._linkSpeedHistory.close();\n      this._linkSpeedHistory = undefined;\n    }\n  }  \n\n  didUpdateSpeedHistory(k: Value, v: Value) {\n    this._speedItem.text(`${v.numberValue()} km/h`)\n    this._speedPlot.insertDatum({x: k.numberValue(), y: v.numberValue()});\n  }\n\n  didRemoveSpeedHistory(k: Value, v: Value) {\n    this._speedPlot.removeDatum({x: k.numberValue(), y: v.numberValue()});\n  }  \n\n  // acceleration history data handlers\n  protected linkAccelHistory() {\n    if(!this._linkAccelHistory) {\n      this._linkAccelHistory = this._nodeRef.downlinkMap()\n        .nodeUri(this._info.uri)\n        .laneUri(\"accelerations\")\n        .didUpdate(this.didUpdateAccelHistory.bind(this))\n        .didRemove(this.didRemoveAccelHistory.bind(this))\n        .open();\n    }\n  }\n\n  protected unlinkAccelHistory() {\n    if (this._linkAccelHistory) {\n      this._linkAccelHistory.close();\n      this._linkAccelHistory = undefined;\n    }\n  }  \n\n  didUpdateAccelHistory(k: Value, v: Value) {\n    this._accelerationPlot.insertDatum({x: k.numberValue(), y: v.numberValue()});\n  }\n\n  didRemoveAccelHistory(k: Value, v: Value) {\n    this._accelerationPlot.removeDatum({x: k.numberValue(), y: v.numberValue()});\n  }    \n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {NodeRef} from \"@swim/client\";\nimport {Color} from \"@swim/color\";\nimport {Transition} from \"@swim/transition\";\nimport {PopoverView} from \"@swim/view\";\nimport {LngLat, MapGraphicViewController, MapCircleView} from \"@swim/map\";\nimport {VehicleInfo} from \"./VehicleModel\";\nimport {VehicleMapView} from \"./VehicleMapView\";\nimport {VehiclePopoverViewController} from \"./VehiclePopoverViewController\";\n\nexport class VehicleMapViewController extends MapGraphicViewController<VehicleMapView> {\n  /** @hodden */\n  _info: VehicleInfo;\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _popoverView: PopoverView | null;\n\n  constructor(info: VehicleInfo, nodeRef: NodeRef) {\n    super();\n    this._info = info;\n    this._nodeRef = nodeRef;\n  }\n\n  setInfo(info: VehicleInfo): void {\n    this._info = info;\n    this.updateVehicle();\n  }\n\n  updateVehicle(): void {\n    const view = this._view!;\n    const info = this._info;\n    if (info.longitude && info.latitude) {\n      const oldCenter = view.center.value!;\n      const newCenter = new LngLat(info.longitude, info.latitude);\n      if (!oldCenter.equals(newCenter)) {\n        view.center.setState(newCenter, Transition.duration(10000));\n        this.ripple(this._view!.vehicleMarkerColor.value!);\n      }\n    }\n    view.fill(view.vehicleMarkerColor.value!, Transition.duration(500));\n  }\n\n  didSetView(view: VehicleMapView): void {\n    view.on(\"click\", this.onClick.bind(this));\n\n    const info = this._info;\n    if (info.longitude && info.latitude) {\n      this._view!.center.setState(new LngLat(info.longitude, info.latitude));\n    }\n    view.fill(view.vehicleMarkerColor.value!);\n  }\n\n  protected ripple(color: Color): void {\n    const info = this._info;\n    if (document.hidden || this.culled) {\n      return;\n    }\n    const ripple = new MapCircleView()\n        .center(new LngLat(info.longitude, info.latitude))\n        .radius(0)\n        .fill(null)\n        .stroke(color.alpha(1))\n        .strokeWidth(1);\n    this.appendChildView(ripple);\n    const radius = Math.min(this.bounds.width, this.bounds.height) / 8;\n    const tween = Transition.duration<any>(5000);\n    ripple.stroke(color.alpha(0), tween)\n          .radius(radius, tween.onEnd(function () { ripple.remove(); }));\n  }\n\n  protected onClick(event: MouseEvent): void {\n    event.stopPropagation();\n    if (!this._popoverView) {\n      this._popoverView = new PopoverView();\n      const popoverViewController = new VehiclePopoverViewController(this._info, this._nodeRef);\n      this._popoverView.setViewController(popoverViewController);\n      this._popoverView.setSource(this._view!);\n      this._popoverView.hidePopover();\n    }\n    this.appView!.togglePopover(this._popoverView, {multi: event.altKey});\n  }\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {MapDownlink, ValueDownlink, NodeRef} from \"@swim/client\";\nimport {Length} from \"@swim/length\";\nimport {Color} from \"@swim/color\";\nimport {Transition} from \"@swim/transition\";\nimport {PopoverView} from \"@swim/view\";\nimport {LngLat, MapViewContext, MapGraphicViewController, MapCircleView} from \"@swim/map\";\nimport {AgencyInfo, AgencyBoundingBox} from \"./AgencyModel\";\nimport {AgencyMapView} from \"./AgencyMapView\";\nimport {AgencyPopoverViewController} from \"./AgencyPopoverViewController\";\nimport {VehicleInfo} from \"./VehicleModel\";\nimport {VehicleMapView} from \"./VehicleMapView\";\nimport {VehicleMapViewController} from \"./VehicleMapViewController\";\n\nconst VEHICLE_ZOOM = 11;\n\nexport class AgencyMapViewController extends MapGraphicViewController<AgencyMapView> {\n  /** @hodden */\n  _info: AgencyInfo;\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _boundingBoxLink: ValueDownlink<Value, AnyValue> | null;\n  /** @hidden */\n  _vehiclesLink: MapDownlink<Value, Value, AnyValue, AnyValue> | null;\n  /** @hidden */\n  _popoverView: PopoverView | null;\n  /** @hidden*/\n  _reduced: boolean | undefined;\n\n  constructor(info: AgencyInfo, nodeRef: NodeRef) {\n    super();\n    this._info = info;\n    this._nodeRef = nodeRef;\n    this._boundingBoxLink = null;\n    this._vehiclesLink = null;\n    this._popoverView = null;\n  }\n\n  protected didSetBoundingBox(value: Value): void {\n    //console.log(\"agency \" + this._info.id + \" didSetBoundingBox:\", value.toAny());\n    if (this._reduced === true) {\n      this.ripple(this._view!.agencyMarkerColor.value!);\n    }\n    //this.animate();\n  }\n\n  protected didUpdateVehicle(key: Value, value: Value): void {\n    const vehicleInfo = value.toAny() as unknown as VehicleInfo;\n    const vehicleId = \"\" + vehicleInfo.id;\n    vehicleInfo.agencyInfo = this._info;\n    //console.log(\"didUpdateVehicle:\", vehicleInfo);\n\n    let vehicleMapView = this.getChildView(vehicleId) as VehicleMapView | null;\n    if (!vehicleMapView) {\n      const vehicleNodeUri = key.stringValue()!;\n      const vehicleNodeRef = this._nodeRef.nodeRef(vehicleNodeUri);\n\n      vehicleMapView = new VehicleMapView();\n      const vehcileMapViewController = new VehicleMapViewController(vehicleInfo, vehicleNodeRef);\n      vehicleMapView.setViewController(vehcileMapViewController);\n      this.setChildView(vehicleId, vehicleMapView);\n    } else {\n      const vehicleMapViewController = vehicleMapView.viewController!;\n      vehicleMapViewController.setInfo(vehicleInfo);\n    }\n  }\n\n  protected initMarkerView(): void {\n    let markerView = this.getChildView(\"marker\") as MapCircleView | null;\n    if (!markerView && this._boundingBoxLink) {\n      const boundingBox = this._boundingBoxLink.get().toAny() as unknown as AgencyBoundingBox | undefined;\n      if (boundingBox) {\n        const lng = (boundingBox.minLng + boundingBox.maxLng) / 2;\n        const lat = (boundingBox.minLat + boundingBox.maxLat) / 2;\n        markerView = new MapCircleView();\n        markerView.center.setState(new LngLat(lng, lat));\n        markerView.radius.setState(Length.px(10));\n        markerView.fill.setState(this._view!.agencyMarkerColor.value!);\n        markerView.on(\"click\", this.onMarkerClick.bind(this));\n        this.setChildView(\"marker\", markerView);\n      }\n    }\n  }\n\n  protected onMarkerClick(event: MouseEvent): void {\n    event.stopPropagation();\n    if (!this._popoverView) {\n      this._popoverView = new PopoverView();\n      const popoverViewController = new AgencyPopoverViewController(this._info, this._nodeRef);\n      this._popoverView.setViewController(popoverViewController);\n      this._popoverView.hidePopover();\n    }\n    this._popoverView.setSource(this.getChildView(\"marker\"));\n    this.appView!.togglePopover(this._popoverView, {multi: event.altKey});\n  }\n\n  protected ripple(color: Color): void {\n    if (document.hidden || this.culled || !this._boundingBoxLink) {\n      return;\n    }\n    const boundingBox = this._boundingBoxLink.get().toAny() as unknown as AgencyBoundingBox;\n    const lng = (boundingBox.minLng + boundingBox.maxLng) / 2;\n    const lat = (boundingBox.minLat + boundingBox.maxLat) / 2;\n    const ripple = new MapCircleView()\n        .center(new LngLat(lng, lat))\n        .radius(0)\n        .fill(null)\n        .stroke(color.alpha(0.25))\n        .strokeWidth(1);\n    this.appendChildView(ripple);\n    const radius = Math.min(this.bounds.width, this.bounds.height) / 8;\n    const tween = Transition.duration<any>(2000);\n    ripple.stroke(color.alpha(0), tween)\n          .radius(radius, tween.onEnd(function () { ripple.remove(); }));\n  }\n\n  viewDidMount(view: AgencyMapView): void {\n    this.linkBoundingBox();\n  }\n\n  viewWillUnmount(view: AgencyMapView): void {\n    this.unlinkBoundingBox();\n    this.unlinkVehicles();\n  }\n\n  viewDidProject(viewContext: MapViewContext, view: AgencyMapView): void {\n    const boundingBox = this._boundingBoxLink!.get().toAny() as unknown as AgencyBoundingBox | undefined;\n    if (boundingBox) {\n      const [sw, ne] = viewContext.projection.bounds;\n      const culled = !(boundingBox.minLng <= ne.lng && sw.lng <= boundingBox.maxLng\n                    && boundingBox.minLat <= ne.lat && sw.lat <= boundingBox.maxLat);\n      view.setCulled(culled);\n    } else {\n      view.setCulled(true);\n    }\n    this.updateLevelOfDetail();\n  }\n\n  protected updateLevelOfDetail(): void {\n    if (this._reduced !== false && !this.culled && this.zoom >= VEHICLE_ZOOM) {\n      this._reduced = false;\n      this.removeAll();\n      this.linkVehicles();\n    } else if (this._reduced !== true && !this.culled && this.zoom < VEHICLE_ZOOM) {\n      this._reduced = true;\n      this.unlinkVehicles();\n      this.removeAll();\n      this.initMarkerView();\n    }\n  }\n\n  protected linkBoundingBox(): void {\n    if (!this._boundingBoxLink) {\n      this._boundingBoxLink = this._nodeRef.downlinkValue()\n          .laneUri(\"boundingBox\")\n          .didSet(this.didSetBoundingBox.bind(this))\n          .open();\n    }\n  }\n\n  protected unlinkBoundingBox(): void {\n    if (this._boundingBoxLink) {\n      this._boundingBoxLink.close();\n      this._boundingBoxLink = null;\n    }\n  }\n\n  protected linkVehicles(): void {\n    if (!this._vehiclesLink) {\n      //console.log(\"agency \" + this._info.id + \" linkVehicles\");\n      this._vehiclesLink = this._nodeRef.downlinkMap()\n          .laneUri(\"vehicles\")\n          .didUpdate(this.didUpdateVehicle.bind(this))\n          .open();\n    }\n  }\n\n  protected unlinkVehicles(): void {\n    if (this._vehiclesLink) {\n      //console.log(\"agency \" + this._info.id + \" unlinkVehicles\");\n      this._vehiclesLink.close();\n      this._vehiclesLink = null;\n    }\n  }\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {MapDownlink, NodeRef} from \"@swim/client\";\nimport {MapGraphicViewController} from \"@swim/map\";\nimport {TransitMapView} from \"./TransitMapView\";\nimport {AgencyInfo} from \"./AgencyModel\";\nimport {AgencyMapView} from \"./AgencyMapView\";\nimport {AgencyMapViewController} from \"./AgencyMapViewController\";\n\nexport class TransitMapViewController extends MapGraphicViewController<TransitMapView> {\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _agenciesLink: MapDownlink<Value, Value, AnyValue, AnyValue> | null;\n\n  constructor(nodeRef: NodeRef) {\n    super();\n    this._nodeRef = nodeRef;\n    this._agenciesLink = null;\n  }\n\n  viewDidMount(view: TransitMapView): void {\n    this.linkAgencies();\n  }\n\n  viewWillUnmount(view: TransitMapView): void {\n    this.unlinkAgencies();\n  }\n\n  protected linkAgencies(): void {\n    if (!this._agenciesLink) {\n      this._agenciesLink = this._nodeRef.downlinkMap()\n          .laneUri(\"agencies\")\n          .didUpdate(this.didUpdateAgency.bind(this))\n          .open();\n    }\n  }\n\n  protected unlinkAgencies(): void {\n    if (this._agenciesLink) {\n      this._agenciesLink.close();\n      this._agenciesLink = null;\n    }\n  }\n\n  protected didUpdateAgency(key: Value, value: Value): void {\n    const agencyInfo = value.toAny() as unknown as AgencyInfo;\n    const agencyId = \"\" + agencyInfo.id;\n    //console.log(\"didUpdateAgenc:\", agencyInfo);\n\n    let agencyMapView = this.getChildView(agencyId);\n    if (!agencyMapView) {\n      const agencyNodeUri = key.stringValue()!;\n      const agencyNodeRef = this._nodeRef.nodeRef(agencyNodeUri);\n\n      agencyMapView = new AgencyMapView();\n      const agencyMapViewController = new AgencyMapViewController(agencyInfo, agencyNodeRef);\n      agencyMapView.setViewController(agencyMapViewController);\n      this.setChildView(agencyId, agencyMapView);\n    }\n  }\n}\n","// Copyright 2015-2022 Swim.inc\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as mapboxgl from \"mapbox-gl\";\nimport {NodeRef} from \"@swim/client\";\nimport {Color} from \"@swim/color\";\nimport {SvgView, HtmlView, HtmlViewController, CanvasView} from \"@swim/view\";\nimport {MapboxView} from \"@swim/mapbox\";\nimport {TransitMapView} from \"./map/TransitMapView\";\nimport {TransitMapViewController} from \"./map/TransitMapViewController\";\nimport { Kpi1ViewController, Kpi2ViewController, Kpi3ViewController } from \"./kpi\";\n\nexport class TransitViewController extends HtmlViewController {\n  /** @hidden */\n  _nodeRef: NodeRef;\n  /** @hidden */\n  _map: mapboxgl.Map | null;\n  /** @hidden */\n  _canvasView: CanvasView | null;\n\n  constructor(nodeRef: NodeRef) {\n    super();\n    this._nodeRef = nodeRef;\n    this._map = null;\n    this._canvasView = null;\n  }\n\n  get canvasView(): CanvasView | null {\n    return this._canvasView;\n  }\n\n  didSetView(view: HtmlView): void {\n    this._map = new mapboxgl.Map({\n      container: view.node,\n      style: \"mapbox://styles/swimit/cjs5h20wh0fyf1gocidkpmcvm\",\n      center: {lng: -97.922211, lat: 39.381266},\n      pitch: 45,\n      zoom: 4,\n    });\n\n    const mapboxView = new MapboxView(this._map);\n    this._canvasView = mapboxView.overlayCanvas();\n\n    const transitMapView = new TransitMapView();\n    const transitMapViewController = new TransitMapViewController(this._nodeRef);\n    transitMapView.setViewController(transitMapViewController);\n    mapboxView.setChildView(\"map\", transitMapView);\n\n    const header = view.append(\"div\")\n        .key(\"header\")\n        .pointerEvents(\"none\")\n        .zIndex(10);\n\n    const logo = header.append(\"div\")\n        .key(\"logo\")\n        .position(\"absolute\")\n        .left(8)\n        .top(8)\n        .width(156)\n        .height(68);\n    logo.append(this.createLogo());\n\n    // view.append(this.createKpiStack(transitMapView));\n    // this.layoutKpiStack();\n  }\n\n  viewDidResize(): void {\n    // this.layoutKpiStack();\n  }\n\n  protected createKpiStack(transitMapView: TransitMapView): HtmlView {\n    const kpiStack = HtmlView.create(\"div\")\n        .key(\"kpiStack\")\n        .position(\"absolute\")\n        .right(0)\n        .top(0)\n        .bottom(0)\n        .zIndex(9)\n        .pointerEvents(\"none\");\n\n    const vehicleFlowKpi = kpiStack.append(\"div\")\n        .key(\"vehicleFlowKpi\")\n        .position(\"absolute\")\n        .borderRadius(8)\n        .boxSizing(\"border-box\")\n        .backgroundColor(Color.parse(\"#070813\").alpha(0.33))\n        .backdropFilter(\"blur(2px)\")\n        .pointerEvents(\"auto\");\n    const vehicleFlowKpiViewController = new Kpi1ViewController(this._nodeRef, transitMapView);\n    vehicleFlowKpi.setViewController(vehicleFlowKpiViewController);\n\n    const vehicleBackupKpi = kpiStack.append(\"div\")\n        .key(\"vehicleBackupKpi\")\n        .position(\"absolute\")\n        .borderRadius(8)\n        .boxSizing(\"border-box\")\n        .backgroundColor(Color.parse(\"#070813\").alpha(0.33))\n        .backdropFilter(\"blur(2px)\")\n        .pointerEvents(\"auto\");\n    const vehicleBackupKpiViewController = new Kpi2ViewController(this._nodeRef, transitMapView);\n    vehicleBackupKpi.setViewController(vehicleBackupKpiViewController);\n\n    const pedestrianBackupKpi = kpiStack.append(\"div\")\n        .key(\"pedestrianBackupKpi\")\n        .position(\"absolute\")\n        .borderRadius(8)\n        .boxSizing(\"border-box\")\n        .backgroundColor(Color.parse(\"#070813\").alpha(0.33))\n        .backdropFilter(\"blur(2px)\")\n        .pointerEvents(\"auto\");\n    const pedestrianBackupKpiViewController = new Kpi3ViewController(this._nodeRef, transitMapView);\n    pedestrianBackupKpi.setViewController(pedestrianBackupKpiViewController);\n\n    return kpiStack;\n  }\n\n  protected layoutKpiStack(): void {\n    const kpiMargin = 16;\n\n    const view = this._view!;\n    const kpiStack = view.getChildView(\"kpiStack\") as HtmlView;\n\n    const kpiViews = kpiStack.childViews;\n    const kpiViewCount = kpiViews.length;\n    const kpiViewHeight = (view.node.offsetHeight - kpiMargin * (kpiViewCount + 1)) / (kpiViewCount || 1);\n    const kpiViewWidth = 1.5 * kpiViewHeight;\n\n    const kpiStackWidth = kpiViewWidth + 2 * kpiMargin;\n    kpiStack.width(kpiStackWidth);\n    for (let i = 0; i < kpiViewCount; i += 1) {\n      const kpiView = kpiViews[i] as HtmlView;\n      kpiView.right(kpiMargin)\n             .top(kpiViewHeight * i + kpiMargin * (i + 1))\n             .width(kpiViewWidth)\n             .height(kpiViewHeight);\n    }\n\n    if (kpiStackWidth > 240 && view.node.offsetWidth >= 2 * kpiStackWidth) {\n      kpiStack.display(\"block\");\n    } else {\n      kpiStack.display(\"none\");\n    }\n  }\n\n  protected createLogo(): SvgView {\n    const logo = SvgView.create(\"svg\").width(156).height(68).viewBox(\"0 0 156 68\");\n    logo.append(\"polygon\").fill(\"#008ac5\").points(\"38.262415 60.577147 45.7497674 67.9446512 41.4336392 66.3395349\");\n    logo.append(\"polygon\").fill(\"#004868\").points(\"30.6320304 56.7525259 35.7395349 55.9824716 41.4304178 66.3390957\");\n    logo.append(\"polygon\").fill(\"#1db0ef\").points(\"45.8577521 43.5549215 35.7395349 55.9813953 30.895331 54.807418\");\n    logo.append(\"polygon\").fill(\"#008ac5\").points(\"45.8604651 43.5549215 41.760398 48.5902277 50.5169298 42.7788873\");\n    logo.append(\"polygon\").fill(\"#008ac5\").points(\"26.3271825 57.4036063 35.7395349 55.9813953 19.2251161 51.7639132\");\n    logo.append(\"polygon\").fill(\"#008ac5\").points(\"21.8522892 56.6610604 26.3302326 57.4059108 24.8674419 60.4330233\");\n    logo.append(\"polygon\").fill(\"#46c7ff\").points(\"25.8602519 50.1512126 21.9749543 52.4673682 26.296682 53.5765239\");\n    logo.append(\"polygon\").fill(\"#004868\").points(\"8.22304588 54.4 26.3302326 57.4046512 10.7431892 45.0311035\");\n    logo.append(\"polygon\").fill(\"#008ac5\").points(\"13.8293387 33.5634807 4.10372093 35.5972093 8.22325581 54.4\");\n    logo.append(\"polygon\").fill(\"#004868\").points(\"8.22099482 54.4011969 0.0941817913 35.6005706 4.10375191 35.6005706\");\n    logo.append(\"polygon\").fill(\"#004a6a\").points(\"29.0049687 26.1913296 29.4164365 29.8907151 13.8293023 33.5651163 4.10372093 35.5972093\");\n    logo.append(\"polygon\").fill(\"#46c7ff\").points(\"29.0062121 26.1911555 4.10372093 35.5972093 18.5813833 12.4933152\");\n    logo.append(\"polygon\").fill(\"#008ac5\").points(\"11.2792478 19.5948645 18.5832775 12.4930233 4.10372093 35.5972093\");\n    logo.append(\"polygon\").fill(\"#0076a9\").points(\"0.0976972893 35.6005706 11.6715695 18.9158345 4.10403655 35.6005706\");\n    logo.append(\"polygon\").fill(\"#46c7ff\").points(\"24.2487055 31.1058385 29.4139535 29.8876265 26.2195349 45.5916279\");\n    logo.append(\"polygon\").fill(\"#004868\").points(\"34.5718675 26.2202296 36.2830885 37.7346648 31.9099624 28.1109897\");\n    logo.append(\"polygon\").fill(\"#00557a\").points(\"29.0034364 26.1884581 42.3712871 20.6741037 29.4139535 29.8883721\");\n    logo.append(\"polygon\").fill(\"#008ac5\").points(\"26.68 13.7746077 29.0062121 26.1911555 18.5813953 12.4930233\");\n    logo.append(\"polygon\").fill(\"#004868\").points(\"11.6715695 2.42510699 18.5775948 12.4930233 11.083087 19.8858773\");\n    logo.append(\"polygon\").fill(\"#46c7ff\").points(\"9.61188076 0 26.6831512 13.7746077 18.5788496 12.4908901\");\n    logo.append(\"path\").fill(\"#0076a9\").d(\"M26.6778731,13.7746077 L38.8232486,18.8943879 L37.5870837,22.6477526 L29.0035088,26.187907 L26.6778731,13.7746077 Z M35.3244186,20.5976744 C35.7065226,20.5976744 36.0162791,20.2879179 36.0162791,19.905814 C36.0162791,19.52371 35.7065226,19.2139535 35.3244186,19.2139535 C34.9423146,19.2139535 34.6325581,19.52371 34.6325581,19.905814 C34.6325581,20.2879179 34.9423146,20.5976744 35.3244186,20.5976744 Z\");\n    logo.append(\"polygon\").fill(\"#46c7ff\").points(\"38.8232558 18.9003694 64.0007929 11.9315264 37.5863839 22.647813\");\n    const text = logo.append(\"text\").fill(\"#ffffff\").fontFamily(\"Orbitron\").fontSize(32);\n    text.append(\"tspan\").x(58).y(42).text(\"swim\");\n    return logo;\n  }\n}\n"],"names":["PieView","Length","TextRunView","HtmlViewController","Color","Transition","pie","SliceView","MemberAnimator","MapGraphicView","PopoverViewController","MapCircleView","ChartView","LineGraphView","LngLat","PopoverView","MapGraphicViewController","mapboxgl.Map","MapboxView","HtmlView","SvgView"],"mappings":"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"}